# AWS - CodeBuild Post Exploitation

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## CodeBuild

For more information, check:

{% content-ref url="../../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### Check Secrets

–Ø–∫—â–æ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –±—É–ª–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –≤ Codebuild –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ Github, Gitlab –∞–±–æ Bitbucket —É —Ñ–æ—Ä–º—ñ –æ—Å–æ–±–∏—Å—Ç–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤, –ø–∞—Ä–æ–ª—ñ–≤ –∞–±–æ –¥–æ—Å—Ç—É–ø—É —á–µ—Ä–µ–∑ OAuth, —Ü—ñ **–æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è —è–∫ —Å–µ–∫—Ä–µ—Ç–∏ –≤ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ —Å–µ–∫—Ä–µ—Ç—ñ–≤**.\
–û—Ç–∂–µ, —è–∫—â–æ —É –≤–∞—Å —î –¥–æ—Å—Ç—É–ø –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Å–µ–∫—Ä–µ—Ç—ñ–≤, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü—ñ —Å–µ–∫—Ä–µ—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ—ó –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

{% content-ref url="../../aws-privilege-escalation/aws-secrets-manager-privesc.md" %}
[aws-secrets-manager-privesc.md](../../aws-privilege-escalation/aws-secrets-manager-privesc.md)
{% endcontent-ref %}

### Abuse CodeBuild Repo Access

–©–æ–± –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ **CodeBuild**, –π–æ–º—É –±—É–¥–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω **–¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –∫–æ–¥—É**, —è–∫–∏–π –≤—ñ–Ω –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏. –ö—ñ–ª—å–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º –º–æ–∂—É—Ç—å —Ö–æ—Å—Ç–∏—Ç–∏ —Ü–µ–π –∫–æ–¥:

<figure><img src="../../../../.gitbook/assets/image (96).png" alt=""><figcaption></figcaption></figure>

**–ü—Ä–æ–µ–∫—Ç CodeBuild –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø** –¥–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ–≥–æ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ –¥–∂–µ—Ä–µ–ª, –∞–±–æ —á–µ—Ä–µ–∑ **IAM —Ä–æ–ª—å**, –∞–±–æ –∑ —Ç–æ–∫–µ–Ω–æ–º github/bitbucket **–∞–±–æ –¥–æ—Å—Ç—É–ø–æ–º —á–µ—Ä–µ–∑ OAuth**.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ **–ø—ñ–¥–≤–∏—â–µ–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏ –≤ CodeBuild** –º–æ–∂–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º, —â–æ–± –≤–∏—Ç—ñ–∫–∞—Ç–∏ –∫–æ–¥ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é —Ç–∞ —ñ–Ω—à–∏—Ö, –¥–æ —è–∫–∏—Ö –º–∞—é—Ç—å –¥–æ—Å—Ç—É–ø –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ.\
–©–æ–± —Ü–µ –∑—Ä–æ–±–∏—Ç–∏, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∑–º—ñ–Ω–∏—Ç–∏ URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –Ω–∞ –∫–æ–∂–µ–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π, –¥–æ —è–∫–æ–≥–æ –º–∞—é—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ** (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–µ–±-—Å–∞–π—Ç aws –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î –≤—Å—ñ –∑ –Ω–∏—Ö –¥–ª—è –≤–∞—Å):

<figure><img src="../../../../.gitbook/assets/image (107).png" alt=""><figcaption></figcaption></figure>

–Ü **–∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ Buildspec –¥–ª—è –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –∫–æ–∂–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é**.

{% hint style="warning" %}
–û–¥–Ω–∞–∫, —Ü–µ **–∑–∞–≤–¥–∞–Ω–Ω—è —î –ø–æ–≤—Ç–æ—Ä—é–≤–∞–ª—å–Ω–∏–º —ñ –Ω—É–¥–Ω–∏–º**, —ñ —è–∫—â–æ —Ç–æ–∫–µ–Ω github –±—É–≤ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –∑ **–ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ **–Ω–µ –∑–º–æ–∂–µ (–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏) —Ü–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏**, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–µ –º–∞—î –¥–æ—Å—Ç—É–ø—É –¥–æ —Ç–æ–∫–µ–Ω–∞.\
–ê–ª–µ —á–∏ –º–∞—î –≤—ñ–Ω? –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–¥—ñ–ª
{% endhint %}

### Leaking Access Tokens from AWS CodeBuild

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –¥–æ—Å—Ç—É–ø, –Ω–∞–¥–∞–Ω–∏–π —É CodeBuild –¥–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º, —Ç–∞–∫–∏—Ö —è–∫ Github. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –±—É–≤ –Ω–∞–¥–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
aws codebuild list-source-credentials
```
{% content-ref url="aws-codebuild-token-leakage.md" %}
[aws-codebuild-token-leakage.md](aws-codebuild-token-leakage.md)
{% endcontent-ref %}

### `codebuild:DeleteProject`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—ñ–ª–∏–π –ø—Ä–æ–µ–∫—Ç CodeBuild, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –≤—Ç—Ä–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ –≤–ø–ª–∏–Ω–µ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ —Ü–µ–π –ø—Ä–æ–µ–∫—Ç.
```bash
aws codebuild delete-project --name <value>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –í—Ç—Ä–∞—Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –¥–ª—è –¥–æ–¥–∞—Ç–∫—ñ–≤, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –≤–∏–¥–∞–ª–µ–Ω–∏–π –ø—Ä–æ–µ–∫—Ç.

### `codebuild:TagResource` , `codebuild:UntagResource`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –¥–æ–¥–∞–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ —Ç–µ–≥–∏ –∑ —Ä–µ—Å—É—Ä—Å—ñ–≤ CodeBuild, –ø–æ—Ä—É—à—É—é—á–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –≤–∏—Ç—Ä–∞—Ç, –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–µ–≥—ñ–≤.
```bash
aws codebuild tag-resource --resource-arn <value> --tags <value>
aws codebuild untag-resource --resource-arn <value> --tag-keys <value>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ü–æ—Ä—É—à–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –≤–∏—Ç—Ä–∞—Ç, –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –ø–æ–ª—ñ—Ç–∏–∫ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–µ–≥—ñ–≤.

### `codebuild:DeleteSourceCredentials`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é Git, —â–æ –≤–ø–ª–∏–Ω–µ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—ñ–≤, —è–∫—ñ –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π.
```sql
aws codebuild delete-source-credentials --arn <value>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ü–æ—Ä—É—à–µ–Ω–Ω—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è –¥–æ–¥–∞—Ç–∫—ñ–≤, —â–æ –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —É—Ä–∞–∂–µ–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é, —á–µ—Ä–µ–∑ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª–∞.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
