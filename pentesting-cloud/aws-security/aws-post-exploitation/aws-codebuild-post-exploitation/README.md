# AWS - CodeBuild Post Exploitation

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## CodeBuild

For more information, check:

{% content-ref url="../../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### Abuse CodeBuild Repo Access

**CodeBuild** рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ **рдХреЛрдб рд░реЗрдкреЛ** рддрдХ **рдкрд╣реБрдБрдЪ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдЬрд┐рд╕рдХрд╛ рдпрд╣ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдХрдИ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЗрд╕ рдХреЛрдб рдХреЛ рд╣реЛрд╕реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

<figure><img src="../../../../.gitbook/assets/image (96).png" alt=""><figcaption></figcaption></figure>

**CodeBuild рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╕реНрд░реЛрдд рдкреНрд░рджрд╛рддрд╛ рддрдХ рдкрд╣реБрдБрдЪ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**, рдпрд╛ рддреЛ **IAM рднреВрдорд┐рдХрд╛** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпрд╛ github/bitbucket **рдЯреЛрдХрди рдпрд╛ OAuth рдкрд╣реБрдБрдЪ** рдХреЗ рд╕рд╛рдеред

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ **CodeBuild рдореЗрдВ рдЙрдЪреНрдЪ рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реИрдВ, рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рдкрд╣реБрдБрдЪ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд░реЗрдкреЛ рдФрд░ рдЕрдиреНрдп рдХрд╛ рдХреЛрдб рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рд╕реЗрдЯ рдХреНрд░реЗрдбреНрд╕ рдХреЛ рдкрд╣реБрдБрдЪ рд╣реИред\
рдЗрд╕рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдмрд╕ **рд░реЗрдкреЛ URL рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд░реЗрдкреЛ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдЬрд┐рд╕рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдкрд╣реБрдБрдЪ рд╣реИ** (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ aws рд╡реЗрдм рдЖрдкрдХреЗ рд▓рд┐рдП рд╕рднреА рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдЧрд╛):

<figure><img src="../../../../.gitbook/assets/image (107).png" alt=""><figcaption></figcaption></figure>

рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рд░реЗрдкреЛ рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Buildspec рдХрдорд╛рдВрдб рдмрджрд▓реЗрдВ**ред

{% hint style="warning" %}
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ **рдХрд╛рд░реНрдп рджреЛрд╣рд░рд╛рд╡рджрд╛рд░ рдФрд░ рдердХрд╛рдК рд╣реИ** рдФрд░ рдпрджрд┐ рдПрдХ github рдЯреЛрдХрди рдХреЛ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ (рджреБрд░реБрдкрдпреЛрдЧ) рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛** рдХреНрдпреЛрдВрдХрд┐ рдЙрд╕рдХреЗ рдкрд╛рд╕ рдЯреЛрдХрди рддрдХ рдкрд╣реБрдБрдЪ рдирд╣реАрдВ рд╣реИред\
рдпрд╛ рдХреНрдпрд╛ рд╣реИ? рдЕрдЧрд▓реА рдЕрдиреБрднрд╛рдЧ рджреЗрдЦреЗрдВ
{% endhint %}

### Leaking Access Tokens from AWS CodeBuild

рдЖрдк CodeBuild рдореЗрдВ рджрд┐рдП рдЧрдП рдПрдХреНрд╕реЗрд╕ рдХреЛ Github рдЬреИрд╕реА рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдкрд░ рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХрд┐рд╕реА рдмрд╛рд╣рд░реА рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рджреА рдЧрдИ рдереА:
```bash
aws codebuild list-source-credentials
```
{% content-ref url="aws-codebuild-token-leakage.md" %}
[aws-codebuild-token-leakage.md](aws-codebuild-token-leakage.md)
{% endcontent-ref %}

### `codebuild:DeleteProject`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдкреВрд░реЗ CodeBuild рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдиреБрдХрд╕рд╛рди рд╣реЛрдЧрд╛ рдФрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдкрд░ рдирд┐рд░реНрднрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдкреНрд░рднрд╛рд╡ рдкрдбрд╝реЗрдЧрд╛ред
```bash
aws codebuild delete-project --name <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╣рдЯрд╛рдП рдЧрдП рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдиреБрдХрд╕рд╛рди рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЗрд╡рд╛ рдореЗрдВ рдмрд╛рдзрд╛ред

### `codebuild:TagResource` , `codebuild:UntagResource`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ CodeBuild рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдЯреИрдЧ рдЬреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ, рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреА рд╕рдВрдЧрдарди рдХреА рд▓рд╛рдЧрдд рдЖрд╡рдВрдЯрди, рд╕рдВрд╕рд╛рдзрди рдЯреНрд░реИрдХрд┐рдВрдЧ, рдФрд░ рдЯреИрдЧ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рдиреАрддрд┐рдпреЛрдВ рдореЗрдВ рдмрд╛рдзрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИред
```bash
aws codebuild tag-resource --resource-arn <value> --tags <value>
aws codebuild untag-resource --resource-arn <value> --tag-keys <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд▓рд╛рдЧрдд рдЖрд╡рдВрдЯрди, рд╕рдВрд╕рд╛рдзрди рдЯреНрд░реИрдХрд┐рдВрдЧ, рдФрд░ рдЯреИрдЧ-рдЖрдзрд╛рд░рд┐рдд рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рдиреАрддрд┐рдпреЛрдВ рдореЗрдВ рд╡рд┐рдШрдЯрдиред

### `codebuild:DeleteSourceCredentials`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ Git рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЗ рд▓рд┐рдП рд╕реНрд░реЛрдд рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред
```sql
aws codebuild delete-source-credentials --arn <value>
```
**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рдкреНрд░рднрд╛рд╡рд┐рдд рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдкрд░ рдирд┐рд░реНрднрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдореЗрдВ рдмрд╛рдзрд╛, рд╕реНрд░реЛрдд рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдХрд╛рд░рдгред

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
