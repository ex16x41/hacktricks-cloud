# AWS - CodeBuild Post Exploitation

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}

## CodeBuild

è©³ç´°ã«ã¤ã„ã¦ã¯ã€æ¬¡ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ç¢ºèª

GitHubã€GitLabã€ã¾ãŸã¯Bitbucketã«æ¥ç¶šã™ã‚‹ãŸã‚ã«CodeBuildã«è¨­å®šã•ã‚ŒãŸè³‡æ ¼æƒ…å ±ãŒã€å€‹äººãƒˆãƒ¼ã‚¯ãƒ³ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ã¾ãŸã¯OAuthãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ã‚¯ã‚»ã‚¹ã®å½¢å¼ã§ã‚ã‚‹å ´åˆã€ã“ã‚Œã‚‰ã®**è³‡æ ¼æƒ…å ±ã¯ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™**ã€‚\
ã—ãŸãŒã£ã¦ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’èª­ã¿å–ã‚‹ã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒã‚ã‚‹å ´åˆã€ã“ã‚Œã‚‰ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’å–å¾—ã—ã€æ¥ç¶šã•ã‚ŒãŸãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ”ãƒœãƒƒãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% content-ref url="../../aws-privilege-escalation/aws-secrets-manager-privesc.md" %}
[aws-secrets-manager-privesc.md](../../aws-privilege-escalation/aws-secrets-manager-privesc.md)
{% endcontent-ref %}

### CodeBuildãƒªãƒã‚¸ãƒˆãƒªã‚¢ã‚¯ã‚»ã‚¹ã®æ‚ªç”¨

**CodeBuild**ã‚’æ§‹æˆã™ã‚‹ã«ã¯ã€ä½¿ç”¨ã™ã‚‹ã‚³ãƒ¼ãƒ‰ãƒªãƒã‚¸ãƒˆãƒªã¸ã®**ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…è¦ã§ã™**ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒ›ã‚¹ãƒˆã—ã¦ã„ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ï¼š

<figure><img src="../../../../.gitbook/assets/image (96).png" alt=""><figcaption></figcaption></figure>

**CodeBuildãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€æ§‹æˆã•ã‚ŒãŸã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æŒã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ã€‚ã“ã‚Œã¯ã€**IAMãƒ­ãƒ¼ãƒ«**ã¾ãŸã¯GitHub/Bitbucketã®**ãƒˆãƒ¼ã‚¯ãƒ³ã¾ãŸã¯OAuthã‚¢ã‚¯ã‚»ã‚¹**ã‚’ä»‹ã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚

**CodeBuildã§æ¨©é™ãŒæ˜‡æ ¼ã—ãŸæ”»æ’ƒè€…**ã¯ã€ã“ã®æ§‹æˆã•ã‚ŒãŸã‚¢ã‚¯ã‚»ã‚¹ã‚’æ‚ªç”¨ã—ã¦ã€è¨­å®šã•ã‚ŒãŸè³‡æ ¼æƒ…å ±ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒ¼ãƒ‰ã‚’æ¼æ´©ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€æ”»æ’ƒè€…ã¯å˜ã«**æ§‹æˆè³‡æ ¼æƒ…å ±ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å„ãƒªãƒã‚¸ãƒˆãƒªã®ãƒªãƒã‚¸ãƒˆãƒªURLã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ï¼ˆAWSã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§ã¯ã€ã™ã¹ã¦ã®ãƒªãƒã‚¸ãƒˆãƒªãŒãƒªã‚¹ãƒˆã•ã‚Œã¾ã™ï¼‰ï¼š

<figure><img src="../../../../.gitbook/assets/image (107).png" alt=""><figcaption></figcaption></figure>

ãã—ã¦ã€**å„ãƒªãƒã‚¸ãƒˆãƒªã‚’å¤–éƒ¨æµå‡ºã•ã›ã‚‹ãŸã‚ã«Buildspecã‚³ãƒãƒ³ãƒ‰ã‚’å¤‰æ›´ã—ã¾ã™**ã€‚

{% hint style="warning" %}
ãŸã ã—ã€ã“ã®**ä½œæ¥­ã¯ç¹°ã‚Šè¿”ã—ã§é¢å€’ã§ã™**ã€‚ã‚‚ã—GitHubãƒˆãƒ¼ã‚¯ãƒ³ãŒ**æ›¸ãè¾¼ã¿æ¨©é™**ã§æ§‹æˆã•ã‚Œã¦ã„ã‚‹å ´åˆã€æ”»æ’ƒè€…ã¯**ãã®æ¨©é™ã‚’ï¼ˆæ‚ªç”¨ï¼‰ã§ãã¾ã›ã‚“**ã€‚ãªãœãªã‚‰ã€ãƒˆãƒ¼ã‚¯ãƒ³ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒãªã„ã‹ã‚‰ã§ã™ã€‚\
ãã‚Œã¨ã‚‚ã€ã‚ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿæ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
{% endhint %}

### AWS CodeBuildã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ã®æ¼æ´©

CodeBuildã§GitHubãªã©ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ä¸ãˆã‚‰ã‚ŒãŸã‚¢ã‚¯ã‚»ã‚¹ã‚’æ¼æ´©ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å¤–éƒ¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
```bash
aws codebuild list-source-credentials
```
{% content-ref url="aws-codebuild-token-leakage.md" %}
[aws-codebuild-token-leakage.md](aws-codebuild-token-leakage.md)
{% endcontent-ref %}

### `codebuild:DeleteProject`

æ”»æ’ƒè€…ã¯ã€CodeBuildãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ãŒã§ãã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šãŒå¤±ã‚ã‚Œã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ä¾å­˜ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```bash
aws codebuild delete-project --name <value>
```
**æ½œåœ¨çš„ãªå½±éŸ¿**: å‰Šé™¤ã•ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã®å–ªå¤±ã¨ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸­æ–­ã€‚

### `codebuild:TagResource` , `codebuild:UntagResource`

æ”»æ’ƒè€…ã¯CodeBuildãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚¿ã‚°ã‚’è¿½åŠ ã€å¤‰æ›´ã€ã¾ãŸã¯å‰Šé™¤ã™ã‚‹ã“ã¨ãŒã§ãã€ã‚¿ã‚°ã«åŸºã¥ãçµ„ç¹”ã®ã‚³ã‚¹ãƒˆé…åˆ†ã€ãƒªã‚½ãƒ¼ã‚¹è¿½è·¡ã€ãŠã‚ˆã³ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒãƒªã‚·ãƒ¼ã‚’æ··ä¹±ã•ã›ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```bash
aws codebuild tag-resource --resource-arn <value> --tags <value>
aws codebuild untag-resource --resource-arn <value> --tag-keys <value>
```
**æ½œåœ¨çš„ãªå½±éŸ¿**: ã‚³ã‚¹ãƒˆé…åˆ†ã€ãƒªã‚½ãƒ¼ã‚¹è¿½è·¡ã€ãŠã‚ˆã³ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒãƒªã‚·ãƒ¼ã®æ··ä¹±ã€‚

### `codebuild:DeleteSourceCredentials`

æ”»æ’ƒè€…ã¯Gitãƒªãƒã‚¸ãƒˆãƒªã®ã‚½ãƒ¼ã‚¹èªè¨¼æƒ…å ±ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ãŒã§ãã€ãƒªãƒã‚¸ãƒˆãƒªã«ä¾å­˜ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­£å¸¸ãªæ©Ÿèƒ½ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```sql
aws codebuild delete-source-credentials --arn <value>
```
**æ½œåœ¨çš„å½±éŸ¿**: ã‚½ãƒ¼ã‚¹èªè¨¼æƒ…å ±ã®å‰Šé™¤ã«ã‚ˆã‚Šã€å½±éŸ¿ã‚’å—ã‘ãŸãƒªãƒã‚¸ãƒˆãƒªã«ä¾å­˜ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­£å¸¸ãªæ©Ÿèƒ½ãŒå¦¨ã’ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
