# AWS - Post eksploatacija S3

{% hint style="success" %}
Nau캜ite i ve쬭ajte hakovanje AWS-a:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Nau캜ite i ve쬭ajte hakovanje GCP-a: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## S3

Za vi코e informacija pogledajte:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### Osetljive informacije

Ponekad 캖ete mo캖i prona캖i osetljive informacije 캜itljive u kantama. Na primer, tajne stanja terraforma.

### Pivoting

Razli캜ite platforme mogu koristiti S3 za skladi코tenje osetljivih resursa. Na primer, **airflow** bi mogao skladi코titi **DAGs** **kod** tamo, ili **veb stranice** bi mogle direktno biti poslu쬰ne iz S3. Napada캜 sa dozvolama za pisanje bi mogao **modifikovati kod** iz kante da bi **pre코ao** na druge platforme, ili **preuzeo naloge** modifikuju캖i JS fajlove.

### S3 Ransomware

U ovom scenariju, **napada캜 kreira KMS (Key Management Service) klju캜 u svom AWS nalogu** ili drugom kompromitovanom nalogu. Zatim ovaj **klju캜 캜ini dostupnim svima u svetu**, omogu캖avaju캖i bilo kom AWS korisniku, roli ili nalogu da enkriptuje objekte koriste캖i ovaj klju캜. Me캠utim, objekti ne mogu biti dekriptovani.

Napada캜 identifikuje ciljnu **S3 kantu i dobija pristup nivou pisanja** koriste캖i razli캜ite metode. To mo쬰 biti zbog lo코e konfiguracije kante koja je javno izlo쬰na ili napada캜 dobija pristup samom AWS okru쬰nju. Napada캜 obi캜no cilja kante koje sadr쬰 osetljive informacije kao 코to su li캜no prepoznatljive informacije (PII), za코ti캖ene zdravstvene informacije (PHI), logovi, rezervne kopije i vi코e.

Da bi utvrdio da li se kanta mo쬰 ciljati ransomware-om, napada캜 proverava njenu konfiguraciju. To uklju캜uje proveru da li je omogu캖eno **S3 verzionisanje objekata** i da li je omogu캖eno **brisanje vi코e faktora autentifikacije (MFA delete)**. Ako verzionisanje objekata nije omogu캖eno, napada캜 mo쬰 nastaviti. Ako je verzionisanje objekata omogu캖eno ali je MFA delete onemogu캖en, napada캜 mo쬰 **onemogu캖iti verzionisanje objekata**. Ako su i verzionisanje objekata i MFA delete omogu캖eni, postaje te쬰 za napada캜a da ransomware-uje tu specifi캜nu kantu.

Koriste캖i AWS API, napada캜 **zamenjuje svaki objekat u kanti enkriptovanom kopijom koriste캖i svoj KMS klju캜**. Ovo efikasno enkriptuje podatke u kanti, 캜ine캖i ih nedostupnim bez klju캜a.

Da bi dodao dodatan pritisak, napada캜 zakazuje brisanje KMS klju캜a kori코tenog u napadu. Ovo daje cilju prozor od 7 dana da povrati svoje podatke pre nego 코to klju캜 bude obrisan i podaci postanu trajno izgubljeni.

Na kraju, napada캜 bi mogao otpremiti kona캜ni fajl, obi캜no nazvan "ransom-note.txt," koji sadr쬴 instrukcije za cilj kako da povrati svoje fajlove. Ovaj fajl se otprema bez enkripcije, verovatno da bi privukao pa쬹ju cilja i obavestio ih o ransomware napadu.

**Za vi코e informacija** [**proverite originalno istra쬴vanje**](https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/)**.**

{% hint style="success" %}
Nau캜ite i ve쬭ajte hakovanje AWS-a:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Nau캜ite i ve쬭ajte hakovanje GCP-a: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
