# AWS - Step Functions Po Eksploatacji

{% hint style="success" %}
Ucz si i wicz Hacking AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Ucz si i wicz Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si trikami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
{% endhint %}

## Step Functions

Aby uzyska wicej informacji na temat tej usugi AWS, sprawd藕:

{% content-ref url="../aws-services/aws-stepfunctions-enum.md" %}
[aws-stepfunctions-enum.md](../aws-services/aws-stepfunctions-enum.md)
{% endcontent-ref %}

### `states:RevealSecrets`

To uprawnienie pozwala na **ujawnienie tajnych danych wewntrz wykonania**. W tym celu nale偶y ustawi poziom inspekcji na TRACE oraz parametr revealSecrets na true.

<figure><img src="../../../.gitbook/assets/image (348).png" alt=""><figcaption></figcaption></figure>

### `states:DeleteStateMachine`, `states:DeleteStateMachineVersion`, `states:DeleteStateMachineAlias`

Napastnik z tymi uprawnieniami m贸gby trwale usun maszyny stan贸w, ich wersje i aliasy. Mo偶e to zak贸ci krytyczne przepywy pracy, prowadzi do utraty danych i wymaga znacznego czasu na odzyskanie i przywr贸cenie dotknitych maszyn stan贸w. Ponadto pozwolioby to napastnikowi na zatarcie lad贸w, zak贸cenie dochodze kryminalistycznych i potencjalne sparali偶owanie operacji poprzez usunicie istotnych proces贸w automatyzacji i konfiguracji stan贸w.

{% hint style="info" %}
* Usuwajc maszyn stan贸w, usuwasz r贸wnie偶 wszystkie jej powizane wersje i aliasy.
* Usuwajc alias maszyny stan贸w, nie usuwasz wersji maszyny stan贸w odnoszcych si do tego aliasu.
* Nie mo偶na usun wersji maszyny stan贸w, kt贸ra jest obecnie odniesiona przez jeden lub wicej alias贸w.
{% endhint %}
```bash
# Delete state machine
aws stepfunctions delete-state-machine --state-machine-arn <value>
# Delete state machine version
aws stepfunctions delete-state-machine-version --state-machine-version-arn <value>
# Delete state machine alias
aws stepfunctions delete-state-machine-alias --state-machine-alias-arn <value>
```
* **Potencjalny wpyw**: Zak贸cenie krytycznych proces贸w, utrata danych i przestoje operacyjne.

### `states:UpdateMapRun`

Napastnik z tym uprawnieniem m贸gby manipulowa konfiguracj awarii Map Run oraz ustawieniem r贸wnolegym, majc mo偶liwo zwikszenia lub zmniejszenia maksymalnej liczby dozwolonych wykonania proces贸w podrzdnych, co bezporednio wpywa na wydajno usugi. Dodatkowo, napastnik m贸gby manipulowa tolerowanym procentem i liczb awarii, majc mo偶liwo zmniejszenia tej wartoci do 0, co spowodowaoby, 偶e za ka偶dym razem, gdy element zawiedzie, cae uruchomienie mapy zawiedzie, co bezporednio wpynoby na wykonanie maszyny stan贸w i potencjalnie zak贸cio krytyczne procesy. 

{% code overflow="wrap" %}
```bash
aws stepfunctions update-map-run --map-run-arn <value> [--max-concurrency <value>] [--tolerated-failure-percentage <value>] [--tolerated-failure-count <value>]
```
{% endcode %}

* **Potencjalny wpyw**: Degradacja wydajnoci i zak贸cenie krytycznych przepyw贸w pracy.

### `states:StopExecution`

Napastnik z tym uprawnieniem m贸gby by w stanie zatrzyma wykonanie dowolnej maszyny stan贸w, zak贸cajc trwajce przepywy pracy i procesy. Mo偶e to prowadzi do niekompletnych transakcji, wstrzymania operacji biznesowych i potencjalnej korupcji danych.

{% hint style="warning" %}
Ta akcja nie jest wspierana przez **maszyny stan贸w express**.
{% endhint %}

{% code overflow="wrap" %}
```bash
aws stepfunctions stop-execution --execution-arn <value> [--error <value>] [--cause <value>]
```
{% endcode %}

* **Potencjalny wpyw**: Zak贸cenie bie偶cych przepyw贸w pracy, przestoje operacyjne i potencjalna korupcja danych.

### `states:TagResource`, `states:UntagResource`

Napastnik m贸gby doda, zmodyfikowa lub usun tagi z zasob贸w Step Functions, zak贸cajc alokacj koszt贸w w organizacji, ledzenie zasob贸w i polityki kontroli dostpu oparte na tagach.
```bash
aws stepfunctions tag-resource --resource-arn <value> --tags Key=<key>,Value=<value>
aws stepfunctions untag-resource --resource-arn <value> --tag-keys <key>
```
**Potencjalny wpyw**: Zak贸cenie alokacji koszt贸w, ledzenia zasob贸w i polityk kontroli dostpu opartych na tagach.

{% hint style="success" %}
Ucz si i wicz AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Ucz si i wicz GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel si trikami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
{% endhint %}
