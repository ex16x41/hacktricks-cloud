# AWS - Step Functions åæœŸåˆ©ç”¨

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## Step Functions

æœ‰å…³æ­¤ AWS æœåŠ¡çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../aws-services/aws-stepfunctions-enum.md" %}
[aws-stepfunctions-enum.md](../aws-services/aws-stepfunctions-enum.md)
{% endcontent-ref %}

### `states:RevealSecrets`

æ­¤æƒé™å…è®¸**åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ­ç¤ºç§˜å¯†æ•°æ®**ã€‚ä¸ºæ­¤ï¼Œéœ€è¦å°†æ£€æŸ¥çº§åˆ«è®¾ç½®ä¸º TRACEï¼Œå¹¶å°† revealSecrets å‚æ•°è®¾ç½®ä¸º trueã€‚

<figure><img src="../../../.gitbook/assets/image (348).png" alt=""><figcaption></figcaption></figure>

### `states:DeleteStateMachine`, `states:DeleteStateMachineVersion`, `states:DeleteStateMachineAlias`

æ‹¥æœ‰è¿™äº›æƒé™çš„æ”»å‡»è€…å°†èƒ½å¤Ÿæ°¸ä¹…åˆ é™¤çŠ¶æ€æœºã€å…¶ç‰ˆæœ¬å’Œåˆ«åã€‚è¿™å¯èƒ½ä¼šä¸­æ–­å…³é”®å·¥ä½œæµç¨‹ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œå¹¶éœ€è¦å¤§é‡æ—¶é—´æ¥æ¢å¤å’Œæ¢å¤å—å½±å“çš„çŠ¶æ€æœºã€‚æ­¤å¤–ï¼Œè¿™å°†å…è®¸æ”»å‡»è€…æ©ç›–æ‰€ç”¨çš„ç—•è¿¹ï¼Œå¹²æ‰°å–è¯è°ƒæŸ¥ï¼Œå¹¶å¯èƒ½é€šè¿‡åˆ é™¤é‡è¦çš„è‡ªåŠ¨åŒ–æµç¨‹å’ŒçŠ¶æ€é…ç½®æ¥ç˜«ç—ªæ“ä½œã€‚

{% hint style="info" %}
* åˆ é™¤çŠ¶æ€æœºæ—¶ï¼Œæ‚¨ä¹Ÿä¼šåˆ é™¤å…¶æ‰€æœ‰å…³è”çš„ç‰ˆæœ¬å’Œåˆ«åã€‚
* åˆ é™¤çŠ¶æ€æœºåˆ«åæ—¶ï¼Œæ‚¨ä¸ä¼šåˆ é™¤å¼•ç”¨æ­¤åˆ«åçš„çŠ¶æ€æœºç‰ˆæœ¬ã€‚
* å½“å‰è¢«ä¸€ä¸ªæˆ–å¤šä¸ªåˆ«åå¼•ç”¨çš„çŠ¶æ€æœºç‰ˆæœ¬æ— æ³•åˆ é™¤ã€‚
{% endhint %}
```bash
# Delete state machine
aws stepfunctions delete-state-machine --state-machine-arn <value>
# Delete state machine version
aws stepfunctions delete-state-machine-version --state-machine-version-arn <value>
# Delete state machine alias
aws stepfunctions delete-state-machine-alias --state-machine-alias-arn <value>
```
* **æ½œåœ¨å½±å“**: å…³é”®å·¥ä½œæµä¸­æ–­ã€æ•°æ®ä¸¢å¤±å’Œæ“ä½œåœæœºã€‚

### `states:UpdateMapRun`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å°†èƒ½å¤Ÿæ“çºµ Map Run å¤±è´¥é…ç½®å’Œå¹¶è¡Œè®¾ç½®ï¼Œèƒ½å¤Ÿå¢åŠ æˆ–å‡å°‘å…è®¸çš„æœ€å¤§å­å·¥ä½œæµæ‰§è¡Œæ•°é‡ï¼Œç›´æ¥å½±å“æœåŠ¡çš„æ€§èƒ½ã€‚æ­¤å¤–ï¼Œæ”»å‡»è€…å¯ä»¥ç¯¡æ”¹å®¹å¿çš„å¤±è´¥ç™¾åˆ†æ¯”å’Œè®¡æ•°ï¼Œèƒ½å¤Ÿå°†æ­¤å€¼å‡å°‘åˆ° 0ï¼Œè¿™æ ·æ¯å½“ä¸€ä¸ªé¡¹ç›®å¤±è´¥æ—¶ï¼Œæ•´ä¸ª map run å°†å¤±è´¥ï¼Œç›´æ¥å½±å“çŠ¶æ€æœºæ‰§è¡Œï¼Œå¹¶å¯èƒ½ä¸­æ–­å…³é”®å·¥ä½œæµã€‚

{% code overflow="wrap" %}
```bash
aws stepfunctions update-map-run --map-run-arn <value> [--max-concurrency <value>] [--tolerated-failure-percentage <value>] [--tolerated-failure-count <value>]
```
{% endcode %}

* **æ½œåœ¨å½±å“**ï¼šæ€§èƒ½ä¸‹é™ï¼Œä»¥åŠå…³é”®å·¥ä½œæµç¨‹çš„ä¸­æ–­ã€‚

### `states:StopExecution`

æ‹¥æœ‰æ­¤æƒé™çš„æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿåœæ­¢ä»»ä½•çŠ¶æ€æœºçš„æ‰§è¡Œï¼Œä»è€Œä¸­æ–­æ­£åœ¨è¿›è¡Œçš„å·¥ä½œæµç¨‹å’Œè¿‡ç¨‹ã€‚è¿™å¯èƒ½å¯¼è‡´äº¤æ˜“ä¸å®Œæ•´ã€ä¸šåŠ¡æ“ä½œä¸­æ–­ä»¥åŠæ½œåœ¨çš„æ•°æ®æŸåã€‚

{% hint style="warning" %}
æ­¤æ“ä½œä¸æ”¯æŒ **express state machines**ã€‚
{% endhint %}

{% code overflow="wrap" %}
```bash
aws stepfunctions stop-execution --execution-arn <value> [--error <value>] [--cause <value>]
```
{% endcode %}

* **æ½œåœ¨å½±å“**ï¼šä¸­æ–­æ­£åœ¨è¿›è¡Œçš„å·¥ä½œæµç¨‹ã€æ“ä½œåœæœºå’Œæ½œåœ¨çš„æ•°æ®æŸåã€‚

### `states:TagResource`, `states:UntagResource`

æ”»å‡»è€…å¯ä»¥æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤ Step Functions èµ„æºçš„æ ‡ç­¾ï¼Œä»è€Œå¹²æ‰°æ‚¨ç»„ç»‡çš„æˆæœ¬åˆ†é…ã€èµ„æºè·Ÿè¸ªå’ŒåŸºäºæ ‡ç­¾çš„è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚
```bash
aws stepfunctions tag-resource --resource-arn <value> --tags Key=<key>,Value=<value>
aws stepfunctions untag-resource --resource-arn <value> --tag-keys <key>
```
**æ½œåœ¨å½±å“**ï¼šæˆæœ¬åˆ†é…ã€èµ„æºè·Ÿè¸ªå’ŒåŸºäºæ ‡ç­¾çš„è®¿é—®æ§åˆ¶ç­–ç•¥çš„ä¸­æ–­ã€‚

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
