# AWS - CodeBuild Unauthenticated Access

{% hint style="success" %}
Ucz si i wicz hakowanie AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Ucz si i wicz hakowanie GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wspieraj HackTricks</summary>

* Sprawd藕 [**plany subskrypcji**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel si trikami hakerskimi, przesyajc PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na githubie.

</details>
{% endhint %}

## CodeBuild

Wicej informacji znajdziesz na tej stronie:

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

Jeli uzyskasz dostp do zapisu w repozytorium zawierajcym plik o nazwie **`buildspec.yml`**, mo偶esz **zainfekowa** ten plik, kt贸ry okrela **polecenia, kt贸re bd wykonywane** w projekcie CodeBuild i wykrada tajemnice, kompromitowa wykonywane zadania oraz kompromitowa **powiadczenia roli IAM CodeBuild**.

Nale偶y zauwa偶y, 偶e nawet jeli nie ma 偶adnego pliku **`buildspec.yml`**, ale wiesz, 偶e Codebuild jest u偶ywany (lub inny CI/CD), **modyfikacja jakiego legalnego kodu**, kt贸ry bdzie wykonywany, mo偶e r贸wnie偶 da ci odwr贸con powok, na przykad.

Dla powizanych informacji mo偶esz sprawdzi stron o tym, jak atakowa Github Actions (podobne do tego):

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## Samodzielnie hostowane GitHub Actions runners w AWS CodeBuild <a href="#action-runner" id="action-runner"></a>

Jak [**wskazano w dokumentacji**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html), mo偶liwe jest skonfigurowanie **CodeBuild** do uruchamiania **samodzielnie hostowanych Github actions**, gdy workflow jest uruchamiany w skonfigurowanym repozytorium Github. Mo偶na to wykry, sprawdzajc konfiguracj projektu CodeBuild, poniewa偶 **`Event type`** musi zawiera: **`WORKFLOW_JOB_QUEUED`** oraz w workflow Github, poniewa偶 wybierze **samodzielnie hostowanego** runnera w ten spos贸b:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
Ten nowy zwizek midzy Github Actions a AWS tworzy kolejny spos贸b na skompromitowanie AWS z Github, poniewa偶 kod w Github bdzie uruchamiany w projekcie CodeBuild z doczon rol IAM.

{% hint style="success" %}
Ucz si i wicz hakowanie AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Ucz si i wicz hakowanie GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wspieraj HackTricks</summary>

* Sprawd藕 [**plany subskrypcji**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel si trikami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na githubie.

</details>
{% endhint %}
