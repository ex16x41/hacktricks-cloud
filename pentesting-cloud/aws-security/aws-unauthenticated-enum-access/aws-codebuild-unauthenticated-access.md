# AWS - CodeBuild 未认证访问

{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
学习与实践 GCP 黑客技术：<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub 仓库提交 PR 分享黑客技巧。

</details>
{% endhint %}

## CodeBuild

有关更多信息，请查看此页面：

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

如果您获得了对包含名为 **`buildspec.yml`** 文件的存储库的写入访问权限，您可以 **后门** 此文件，该文件指定将在 CodeBuild 项目中执行的 **命令**，并提取机密，妨碍执行的内容，并且还可能妨碍 **CodeBuild IAM 角色凭证**。

请注意，即使没有任何 **`buildspec.yml`** 文件，但您知道正在使用 Codebuild（或其他 CI/CD），**修改一些合法代码** 也可以让您获得反向 shell，例如。

有关一些相关信息，您可以查看关于如何攻击 Github Actions 的页面（与此类似）：

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## AWS CodeBuild 中的自托管 GitHub Actions 运行器 <a href="#action-runner" id="action-runner"></a>

正如 [**文档中所示**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html)，可以配置 **CodeBuild** 在配置的 Github 仓库中触发工作流时运行 **自托管的 Github actions**。这可以通过检查 CodeBuild 项目配置来检测，因为 **`事件类型`** 需要包含：**`WORKFLOW_JOB_QUEUED`**，并且在 Github 工作流中，因为它将选择一个 **自托管** 运行器，如下所示：
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
这种Github Actions与AWS之间的新关系为从Github入侵AWS提供了另一种方式，因为Github中的代码将在附加了IAM角色的CodeBuild项目中运行。

{% hint style="success" %}
学习和实践AWS黑客技术：<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks培训AWS红队专家(ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
学习和实践GCP黑客技术：<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks培训GCP红队专家(GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持HackTricks</summary>

* 查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f)或[**telegram群组**](https://t.me/peass)或**在** **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**上关注我们。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github库提交PR分享黑客技巧。

</details>
{% endhint %}
