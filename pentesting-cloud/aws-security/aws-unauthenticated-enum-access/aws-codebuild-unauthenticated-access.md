# AWS - CodeBuild Unauthenticated Access

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ã€‚**
* **PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹** [**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã€‚

</details>
{% endhint %}

## CodeBuild

è©³ç´°ã«ã¤ã„ã¦ã¯ã“ã®ãƒšãƒ¼ã‚¸ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„:

{% content-ref url="../aws-services/aws-codebuild-enum.md" %}
[aws-codebuild-enum.md](../aws-services/aws-codebuild-enum.md)
{% endcontent-ref %}

### buildspec.yml

**`buildspec.yml`**ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€ãƒªãƒã‚¸ãƒˆãƒªã¸ã®æ›¸ãè¾¼ã¿ã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ã—ãŸå ´åˆã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’**ãƒãƒƒã‚¯ãƒ‰ã‚¢**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯CodeBuildãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§å®Ÿè¡Œã•ã‚Œã‚‹**ã‚³ãƒãƒ³ãƒ‰ã‚’æŒ‡å®š**ã—ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’æµå‡ºã•ã›ãŸã‚Šã€å®Ÿè¡Œå†…å®¹ã‚’æ”¹ã–ã‚“ã—ãŸã‚Šã€**CodeBuild IAMãƒ­ãƒ¼ãƒ«ã®ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«**ã‚’ã‚‚å±é™ºã«ã•ã‚‰ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

**`buildspec.yml`**ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã§ã‚‚ã€CodeBuildï¼ˆã¾ãŸã¯åˆ¥ã®CI/CDï¼‰ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹å ´åˆã€**æ­£å½“ãªã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´**ã™ã‚‹ã“ã¨ã§ã€ä¾‹ãˆã°ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

é–¢é€£æƒ…å ±ã«ã¤ã„ã¦ã¯ã€Github Actionsã®æ”»æ’ƒæ–¹æ³•ã«é–¢ã™ã‚‹ãƒšãƒ¼ã‚¸ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼ˆã“ã‚Œã«ä¼¼ã¦ã„ã¾ã™ï¼‰:

{% content-ref url="../../../pentesting-ci-cd/github-security/abusing-github-actions/" %}
[abusing-github-actions](../../../pentesting-ci-cd/github-security/abusing-github-actions/)
{% endcontent-ref %}

## Self-hosted GitHub Actions runners in AWS CodeBuild <a href="#action-runner" id="action-runner"></a>

[**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«**](https://docs.aws.amazon.com/codebuild/latest/userguide/action-runner.html)ã€**CodeBuild**ã‚’è¨­å®šã—ã¦ã€Githubãƒªãƒã‚¸ãƒˆãƒªå†…ã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚ŒãŸã¨ãã«**ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆã®Githubã‚¢ã‚¯ã‚·ãƒ§ãƒ³**ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã“ã‚Œã¯ã€CodeBuildãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§æ¤œå‡ºã§ãã¾ã™ã€‚ãªãœãªã‚‰ã€**`Event type`**ã«**`WORKFLOW_JOB_QUEUED`**ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã€Githubãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ã¯æ¬¡ã®ã‚ˆã†ã«**ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆ**ãƒ©ãƒ³ãƒŠãƒ¼ã‚’é¸æŠã™ã‚‹ã‹ã‚‰ã§ã™:
```bash
runs-on: codebuild-<project-name>-${{ github.run_id }}-${{ github.run_attempt }}
```
ã“ã®æ–°ã—ã„Github Actionsã¨AWSã®é–¢ä¿‚ã¯ã€Githubã®ã‚³ãƒ¼ãƒ‰ãŒIAMãƒ­ãƒ¼ãƒ«ã‚’ä»˜ä¸ã•ã‚ŒãŸCodeBuildãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€Githubã‹ã‚‰AWSã‚’ä¾µå®³ã™ã‚‹åˆ¥ã®æ–¹æ³•ã‚’ä½œã‚Šå‡ºã—ã¾ã™ã€‚

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ï¼
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ã€‚
* **PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹** [**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«ã€‚

</details>
{% endhint %}
