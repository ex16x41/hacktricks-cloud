# AWS - S3 Unauthenticated Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## S3 Public Buckets

‡§è‡§ï ‡§¨‡§ï‡•á‡§ü ‡§ï‡•ã **"‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï"** ‡§Æ‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§Ø‡§¶‡§ø **‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§¨‡§ï‡•á‡§ü ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§∏‡•Ç‡§ö‡•Ä‡§¨‡§¶‡•ç‡§ß ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**, ‡§î‡§∞ **"‡§®‡§ø‡§ú‡•Ä"** ‡§Ø‡§¶‡§ø ‡§¨‡§ï‡•á‡§ü ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã **‡§ï‡•á‡§µ‡§≤ ‡§ï‡•Å‡§õ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡•Ç‡§ö‡•Ä‡§¨‡§¶‡•ç‡§ß ‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**‡•§

‡§ï‡§Ç‡§™‡§®‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§™‡§æ‡§∏ **‡§¨‡§ï‡•á‡§ü ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡§æ‡§Å ‡§ó‡§≤‡§§ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç** ‡§ú‡•ã ‡§Ø‡§æ ‡§§‡•ã ‡§∏‡§¨ ‡§ï‡•Å‡§õ ‡§Ø‡§æ AWS ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§ñ‡§æ‡§§‡•á ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§ø‡§§ ‡§∏‡§≠‡•Ä ‡§ï‡•ã ‡§™‡§π‡•Å‡§Å‡§ö ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡§Ç (‡§§‡•ã ‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•ã ‡§≠‡•Ä)‡•§ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç, ‡§ï‡§ø ‡§ê‡§∏‡•Ä ‡§ó‡§≤‡§§ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≠‡•Ä ‡§ï‡•Å‡§õ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§è‡§Å ‡§®‡§π‡•Ä‡§Ç ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§¨‡§ï‡•á‡§ü ‡§ï‡•Ä ‡§Ö‡§™‡§®‡•Ä ‡§™‡§π‡•Å‡§Å‡§ö ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§∏‡•Ç‡§ö‡§ø‡§Ø‡§æ‡§Å (ACLs) ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç‡•§

**AWS-S3 ‡§ó‡§≤‡§§ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Ø‡§π‡§æ‡§Å ‡§ú‡§æ‡§®‡•á‡§Ç:** [**http://flaws.cloud**](http://flaws.cloud/) **‡§î‡§∞** [**http://flaws2.cloud/**](http://flaws2.cloud)

### Finding AWS Buckets

‡§ú‡§¨ ‡§è‡§ï ‡§µ‡•á‡§¨‡§™‡•É‡§∑‡•ç‡§† ‡§ï‡•Å‡§õ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è AWS ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à, ‡§§‡•ã ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡•á ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§§‡§∞‡•Ä‡§ï‡•á:

#### Enumeration & OSINT:

* **wappalyzer** ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§™‡•ç‡§≤‡§ó‡§á‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ
* ‡§¨‡§∞‡•ç‡§™ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ (**‡§∏‡•ç‡§™‡§æ‡§á‡§°‡§∞‡§ø‡§Ç‡§ó** ‡§µ‡•á‡§¨) ‡§Ø‡§æ ‡§™‡•É‡§∑‡•ç‡§† ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§ü ‡§ï‡§∞‡§ï‡•á ‡§∏‡§≠‡•Ä **‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç** **‡§ï‡•ã ‡§≤‡•ã‡§°** ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ ‡§ú‡•ã ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡§π‡•á‡§ú‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á‡•§
*   **‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§Å‡§ö ‡§ï‡§∞‡•á‡§Ç** ‡§ú‡•à‡§∏‡•á ‡§°‡•ã‡§Æ‡•á‡§® ‡§Æ‡•á‡§Ç:

```
http://s3.amazonaws.com/[bucket_name]/
http://[bucket_name].s3.amazonaws.com/
```
* **CNAMES** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§Å‡§ö ‡§ï‡§∞‡•á‡§Ç ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø `resources.domain.com` ‡§Æ‡•á‡§Ç CNAME `bucket.s3.amazonaws.com` ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à
* [https://buckets.grayhatwarfare.com](https://buckets.grayhatwarfare.com/), ‡§è‡§ï ‡§µ‡•á‡§¨ ‡§ú‡•ã ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä **‡§ñ‡•Å‡§≤‡•á ‡§¨‡§ï‡•á‡§ü** ‡§ñ‡•ã‡§ú ‡§ö‡•Å‡§ï‡§æ ‡§π‡•à‡•§
* **‡§¨‡§ï‡•á‡§ü ‡§®‡§æ‡§Æ** ‡§î‡§∞ **‡§¨‡§ï‡•á‡§ü ‡§°‡•ã‡§Æ‡•á‡§® ‡§®‡§æ‡§Æ** ‡§ï‡•ã **‡§è‡§ï ‡§∏‡§Æ‡§æ‡§® ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§**
* **flaws.cloud** **IP** 52.92.181.107 ‡§™‡§∞ ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§µ‡§π‡§æ‡§Ç ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§Ø‡§π ‡§Ü‡§™‡§ï‡•ã [https://aws.amazon.com/s3/](https://aws.amazon.com/s3/) ‡§™‡§∞ ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, `dig -x 52.92.181.107` `s3-website-us-west-2.amazonaws.com` ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§
* ‡§Ø‡§π ‡§ú‡§æ‡§Å‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø ‡§Ø‡§π ‡§è‡§ï ‡§¨‡§ï‡•á‡§ü ‡§π‡•à, ‡§Ü‡§™ **‡§Ø‡§π‡§æ‡§Å ‡§≠‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç** [https://flaws.cloud.s3.amazonaws.com/](https://flaws.cloud.s3.amazonaws.com/)‡•§

#### Brute-Force

‡§Ü‡§™ ‡§¨‡§ï‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ã **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§®‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡•ç‡§∞‡•Ç‡§ü-‡§´‡•ã‡§∞‡•ç‡§∏ ‡§ï‡§∞‡§ï‡•á** ‡§ñ‡•ã‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

* [https://github.com/sa7mon/S3Scanner](https://github.com/sa7mon/S3Scanner)
* [https://github.com/clario-tech/s3-inspector](https://github.com/clario-tech/s3-inspector)
* [https://github.com/jordanpotti/AWSBucketDump](https://github.com/jordanpotti/AWSBucketDump) (‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§¨‡§ï‡•á‡§ü ‡§®‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•Ä ‡§è‡§ï ‡§∏‡•Ç‡§ö‡•Ä ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à)
* [https://github.com/fellchase/flumberboozle/tree/master/flumberbuckets](https://github.com/fellchase/flumberboozle/tree/master/flumberbuckets)
* [https://github.com/smaranchand/bucky](https://github.com/smaranchand/bucky)
* [https://github.com/tomdev/teh\_s3\_bucketeers](https://github.com/tomdev/teh\_s3\_bucketeers)
* [https://github.com/RhinoSecurityLabs/Security-Research/tree/master/tools/aws-pentest-tools/s3](https://github.com/RhinoSecurityLabs/Security-Research/tree/master/tools/aws-pentest-tools/s3)
* [https://github.com/Eilonh/s3crets\_scanner](https://github.com/Eilonh/s3crets\_scanner)
* [https://github.com/belane/CloudHunter](https://github.com/belane/CloudHunter)

<pre class="language-bash"><code class="lang-bash"># Generate a wordlist to create permutations
curl -s https://raw.githubusercontent.com/cujanovic/goaltdns/master/words.txt > /tmp/words-s3.txt.temp
curl -s https://raw.githubusercontent.com/jordanpotti/AWSBucketDump/master/BucketNames.txt >>/tmp/words-s3.txt.temp
cat /tmp/words-s3.txt.temp | sort -u > /tmp/words-s3.txt

# Generate a wordlist based on the domains and subdomains to test
## Write those domains and subdomains in subdomains.txt
cat subdomains.txt > /tmp/words-hosts-s3.txt
cat subdomains.txt | tr "." "-" >> /tmp/words-hosts-s3.txt
cat subdomains.txt | tr "." "\n" | sort -u >> /tmp/words-hosts-s3.txt

# Create permutations based in a list with the domains and subdomains to attack
goaltdns -l /tmp/words-hosts-s3.txt -w /tmp/words-s3.txt -o /tmp/final-words-s3.txt.temp
## The previous tool is specialized increating permutations for subdomains, lets filter that list
<strong>### Remove lines ending with "."
</strong>cat /tmp/final-words-s3.txt.temp | grep -Ev "\.$" > /tmp/final-words-s3.txt.temp2
### Create list without TLD
cat /tmp/final-words-s3.txt.temp2 | sed -E 's/\.[a-zA-Z0-9]+$//' > /tmp/final-words-s3.txt.temp3
### Create list without dots
cat /tmp/final-words-s3.txt.temp3 | tr -d "." > /tmp/final-words-s3.txt.temp4http://phantom.s3.amazonaws.com/
### Create list without hyphens
cat /tmp/final-words-s3.txt.temp3 | tr "." "-" > /tmp/final-words-s3.txt.temp5

## Generate the final wordlist
cat /tmp/final-words-s3.txt.temp2 /tmp/final-words-s3.txt.temp3 /tmp/final-words-s3.txt.temp4 /tmp/final-words-s3.txt.temp5 | grep -v -- "-\." | awk '{print tolower($0)}' | sort -u > /tmp/final-words-s3.txt

## Call s3scanner
s3scanner --threads 100 scan --buckets-file /tmp/final-words-s3.txt  | grep bucket_exists
</code></pre>

#### Loot S3 Buckets

‡§ñ‡•Å‡§≤‡•á S3 ‡§¨‡§ï‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ã ‡§¶‡•á‡§ñ‡§§‡•á ‡§π‡•Å‡§è, [**BucketLoot**](https://github.com/redhuntlabs/BucketLoot) ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á **‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä** ‡§ï‡•á ‡§≤‡§ø‡§è **‡§ñ‡•ã‡§ú ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**‡•§

### Find the Region

‡§Ü‡§™ [**https://docs.aws.amazon.com/general/latest/gr/s3.html**](https://docs.aws.amazon.com/general/latest/gr/s3.html) ‡§Æ‡•á‡§Ç AWS ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§∏‡§≠‡•Ä ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§ñ‡•ã‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

#### By DNS

‡§Ü‡§™ **`dig`** ‡§î‡§∞ **`nslookup`** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§¨‡§ï‡•á‡§ü ‡§ï‡•á ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ï‡•ã ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç **‡§ñ‡•ã‡§ú‡•á ‡§ó‡§è IP** ‡§ï‡§æ **DNS ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡§ï‡•á**:
```bash
dig flaws.cloud
;; ANSWER SECTION:
flaws.cloud.    5    IN    A    52.218.192.11

nslookup 52.218.192.11
Non-authoritative answer:
11.192.218.52.in-addr.arpa name = s3-website-us-west-2.amazonaws.com.
```
Check that the resolved domain have the word "website".\
You can access the static website going to: `flaws.cloud.s3-website-us-west-2.amazonaws.com`\
or you can access the bucket visiting: `flaws.cloud.s3-us-west-2.amazonaws.com`

#### By Trying

If you try to access a bucket, but in the **domain name you specify another region** (for example the bucket is in `bucket.s3.amazonaws.com` but you try to access `bucket.s3-website-us-west-2.amazonaws.com`, then you will be **indicated to the correct location**:

![](<../../../.gitbook/assets/image (106).png>)

### Enumerating the bucket

To test the openness of the bucket a user can just enter the URL in their web browser. A private bucket will respond with "Access Denied". A public bucket will list the first 1,000 objects that have been stored.

Open to everyone:

![](<../../../.gitbook/assets/image (201).png>)

Private:

![](<../../../.gitbook/assets/image (83).png>)

You can also check this with the cli:
```bash
#Use --no-sign-request for check Everyones permissions
#Use --profile <PROFILE_NAME> to indicate the AWS profile(keys) that youwant to use: Check for "Any Authenticated AWS User" permissions
#--recursive if you want list recursivelyls
#Opcionally you can select the region if you now it
aws s3 ls s3://flaws.cloud/ [--no-sign-request] [--profile <PROFILE_NAME>] [ --recursive] [--region us-west-2]
```
‡§Ø‡§¶‡§ø ‡§¨‡§ï‡•á‡§ü ‡§ï‡§æ ‡§°‡•ã‡§Æ‡•á‡§® ‡§®‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡•á ‡§∏‡•Ç‡§ö‡•Ä‡§¨‡§¶‡•ç‡§ß ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø, **‡§ï‡•á‡§µ‡§≤ ‡§¨‡§ï‡•á‡§ü ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§°‡§æ‡§≤‡•á‡§Ç** ‡§î‡§∞ ‡§™‡•Ç‡§∞‡•á AWSs3 ‡§°‡•ã‡§Æ‡•á‡§® ‡§ï‡•ã ‡§®‡§π‡•Ä‡§Ç‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£: `s3://<BUCKETNAME>`

### ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï URL ‡§ü‡•á‡§Æ‡•ç‡§™‡§≤‡•á‡§ü
```
https://{user_provided}.s3.amazonaws.com
```
### Get Account ID from public Bucket

‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§è‡§ï AWS ‡§ñ‡§æ‡§§‡§æ ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è **`S3:ResourceAccount`** **‡§®‡•Ä‡§§‡§ø ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•Å‡§Ç‡§ú‡•Ä** ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ‡§ï‡§∞‡•§ ‡§Ø‡§π ‡§∏‡•ç‡§•‡§ø‡§§‡§ø **‡§è‡§ï ‡§ñ‡§æ‡§§‡•á ‡§Æ‡•á‡§Ç S3 ‡§¨‡§ï‡•á‡§ü ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à** (‡§Ö‡§®‡•ç‡§Ø ‡§ñ‡§æ‡§§‡§æ-‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§®‡•Ä‡§§‡§ø‡§Ø‡§æ‡§Å ‡§â‡§∏ ‡§ñ‡§æ‡§§‡•á ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡§Ç ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§π‡•à)‡•§\
‡§î‡§∞ ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§®‡•Ä‡§§‡§ø ‡§Æ‡•á‡§Ç **‡§µ‡§æ‡§á‡§≤‡•ç‡§°‡§ï‡§æ‡§∞‡•ç‡§°** ‡§π‡•ã ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§á‡§∏‡§≤‡§ø‡§è ‡§ñ‡§æ‡§§‡§æ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ **‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§¨‡§æ‡§∞** ‡§™‡§æ‡§à ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

‡§Ø‡§π ‡§â‡§™‡§ï‡§∞‡§£ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à:
```bash
# Installation
pipx install s3-account-search
pip install s3-account-search
# With a bucket
s3-account-search arn:aws:iam::123456789012:role/s3_read s3://my-bucket
# With an object
s3-account-search arn:aws:iam::123456789012:role/s3_read s3://my-bucket/path/to/object.ext
```
‡§Ø‡§π ‡§§‡§ï‡§®‡•Ä‡§ï API ‡§ó‡•á‡§ü‡§µ‡•á URLs, Lambda URLs, ‡§°‡•á‡§ü‡§æ ‡§è‡§ï‡•ç‡§∏‡§ö‡•á‡§Ç‡§ú ‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§ü ‡§î‡§∞ ‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø ‡§ü‡•à‡§ó ‡§ï‡•á ‡§Æ‡§æ‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•Ä ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à (‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ü‡•à‡§ó ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç)‡•§ ‡§Ü‡§™ [**‡§Æ‡•Ç‡§≤ ‡§∂‡•ã‡§ß**](https://blog.plerion.com/conditional-love-for-aws-metadata-enumeration/) ‡§î‡§∞ ‡§á‡§∏ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡•ã ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§ï‡§∞‡§£ [**conditional-love**](https://github.com/plerionhq/conditional-love/) ‡§Æ‡•á‡§Ç ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

### ‡§è‡§ï ‡§¨‡§ï‡•á‡§ü ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡§®‡§æ ‡§ï‡§ø ‡§Ø‡§π AWS ‡§ñ‡§æ‡§§‡•á ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§π‡•à

‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø [**‡§á‡§∏ ‡§¨‡•ç‡§≤‡•â‡§ó ‡§™‡•ã‡§∏‡•ç‡§ü**](https://blog.plerion.com/things-you-wish-you-didnt-need-to-know-about-s3/) ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, **‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§è‡§ï ‡§¨‡§ï‡•á‡§ü ‡§ï‡•ã ‡§∏‡•Ç‡§ö‡•Ä‡§¨‡§¶‡•ç‡§ß ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§π‡•à** ‡§§‡•ã ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ ‡§â‡§∏ ‡§ñ‡§æ‡§§‡•á ‡§ï‡•Ä ID ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç ‡§ú‡§ø‡§∏‡§∏‡•á ‡§¨‡§ï‡•á‡§ü ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§π‡•à, ‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡§ï‡§∞ ‡§ú‡•à‡§∏‡•á:
```bash
curl -X GET "[bucketname].amazonaws.com/" \
-H "x-amz-expected-bucket-owner: [correct-account-id]"

<?xml version="1.0" encoding="UTF-8"?>
<ListBucketResult xmlns="http://s3.amazonaws.com/doc/2006-03-01/">...</ListBucketResult>
```
‡§Ø‡§¶‡§ø ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø "Access Denied" ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§ñ‡§æ‡§§‡§æ ‡§Ü‡§à‡§°‡•Ä ‡§ó‡§≤‡§§ ‡§•‡•Ä‡•§

### ‡§∞‡•Ç‡§ü ‡§ñ‡§æ‡§§‡§æ enumeration ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ó‡§è ‡§à‡§Æ‡•á‡§≤

‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø [**‡§á‡§∏ ‡§¨‡•ç‡§≤‡•â‡§ó ‡§™‡•ã‡§∏‡•ç‡§ü**](https://blog.plerion.com/things-you-wish-you-didnt-need-to-know-about-s3/) ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§Ø‡§π ‡§ú‡§æ‡§Ç‡§ö‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡•ã‡§à ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ ‡§ï‡§ø‡§∏‡•Ä AWS ‡§ñ‡§æ‡§§‡•á ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§π‡•à **S3 ‡§¨‡§ï‡•á‡§ü ‡§™‡§∞ ACLs ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§à‡§Æ‡•á‡§≤ ‡§ï‡•ã ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§ï‡•á**‡•§ ‡§Ø‡§¶‡§ø ‡§Ø‡§π ‡§ï‡•ã‡§à ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§à‡§Æ‡•á‡§≤ ‡§ï‡§ø‡§∏‡•Ä AWS ‡§ñ‡§æ‡§§‡•á ‡§ï‡§æ ‡§∞‡•Ç‡§ü ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§π‡•à:
```python
s3_client.put_bucket_acl(
Bucket=bucket_name,
AccessControlPolicy={
'Grants': [
{
'Grantee': {
'EmailAddress': 'some@emailtotest.com',
'Type': 'AmazonCustomerByEmail',
},
'Permission': 'READ'
},
],
'Owner': {
'DisplayName': 'Whatever',
'ID': 'c3d78ab5093a9ab8a5184de715d409c2ab5a0e2da66f08c2f6cc5c0bdeadbeef'
}
}
)
```
## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://www.youtube.com/watch?v=8ZXRw4Ry3mQ](https://www.youtube.com/watch?v=8ZXRw4Ry3mQ)
* [https://cloudar.be/awsblog/finding-the-account-id-of-any-public-s3-bucket/](https://cloudar.be/awsblog/finding-the-account-id-of-any-public-s3-bucket/)

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **‡§π‡§Æ‡§æ‡§∞‡•á** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**telegram ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‡§Ø‡§æ **Twitter** üê¶ ‡§™‡§∞ ‡§π‡§Æ‡•á‡§Ç **‡§´‡•â‡§≤‡•ã ‡§ï‡§∞‡•á‡§Ç** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PR ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}
