# AWS - –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –Ü—î—Ä–∞—Ä—Ö—ñ—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó

![](<../../../.gitbook/assets/image (151).png>)

### –û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏

–í AWS —î **–∫–æ—Ä–µ–Ω–µ–≤–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å,** —è–∫–∏–π —î **–±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –¥–ª—è –≤—Å—ñ—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤** –≤–∞—à–æ—ó **–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó**. –û–¥–Ω–∞–∫ –≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –¥–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤, –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **—ñ–Ω—à—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏, —â–æ–± —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ —Ä—ñ–∑–Ω—ñ AWS** —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –º—ñ–∂ –Ω–∏–º–∏.

–¶–µ –¥—É–∂–µ —Ü—ñ–∫–∞–≤–æ –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É **–±–µ–∑–ø–µ–∫–∏**, –æ—Å–∫—ñ–ª—å–∫–∏ **–æ–¥–∏–Ω –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –Ω–µ –∑–º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ —ñ–Ω—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É** (—è–∫—â–æ –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω—ñ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –º–æ—Å—Ç–∏), —Ç–æ–º—É —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ–∂—ñ –º—ñ–∂ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º–∏.

–û—Ç–∂–µ, –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó —î **–¥–≤–∞ —Ç–∏–ø–∏ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤** (–º–∏ –≥–æ–≤–æ—Ä–∏–º–æ –ø—Ä–æ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ AWS, –∞ –Ω–µ –ø—Ä–æ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤): –æ–¥–∏–Ω –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å, —è–∫–∏–π –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è, —ñ –æ–¥–∏–Ω –∞–±–æ –∫—ñ–ª—å–∫–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —É—á–∞—Å–Ω–∏–∫—ñ–≤.

*   **–û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è (–∫–æ—Ä–µ–Ω–µ–≤–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å)** - —Ü–µ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å, —è–∫–∏–π –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó. –ó –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–µ:

* –°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó
* –ó–∞–ø—Ä–æ—à—É–≤–∞—Ç–∏ —ñ–Ω—à—ñ —ñ—Å–Ω—É—é—á—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –¥–æ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó
* –í–∏–¥–∞–ª—è—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∑ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó
* –ö–µ—Ä—É–≤–∞—Ç–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è–º–∏
* –ó–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ —Å—É—Ç–Ω–æ—Å—Ç–µ–π (–∫–æ—Ä–µ–Ω—ñ, –û–£ –∞–±–æ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏) –≤ –º–µ–∂–∞—Ö –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó
* –£–≤—ñ–º–∫–Ω—É—Ç–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏–º–∏ AWS —Å–µ—Ä–≤—ñ—Å–∞–º–∏ –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ —Å–µ—Ä–≤—ñ—Å—É –¥–ª—è –≤—Å—ñ—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó.
* –ú–æ–∂–ª–∏–≤–æ —É–≤—ñ–π—Ç–∏ —è–∫ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É —Ç–∞ –ø–∞—Ä–æ–ª—å, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ü—å–æ–≥–æ –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É/–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó.

–û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–∞—î **–æ–±–æ–≤'—è–∑–∫–∏ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –ø–ª–∞—Ç–Ω–∏–∫–∞** —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –æ–ø–ª–∞—Ç—É –≤—Å—ñ—Ö –≤–∏—Ç—Ä–∞—Ç, —è–∫—ñ –Ω–∞–∫–æ–ø–∏—á—É—é—Ç—å—Å—è —É—á–∞—Å–Ω–∏–∫–∞–º–∏. –í–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó.
* **–û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ —É—á–∞—Å–Ω–∏–∫—ñ–≤** —Å–∫–ª–∞–¥–∞—é—Ç—å –≤—Å—ñ —ñ–Ω—à—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó. –û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –º–æ–∂–µ –±—É—Ç–∏ —É—á–∞—Å–Ω–∏–∫–æ–º –ª–∏—à–µ –æ–¥–Ω—ñ—î—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –æ–¥–Ω–æ—á–∞—Å–Ω–æ. –í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫—É –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É, —â–æ–± –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—ñ –ª–∏—à–µ –¥–æ —Ü—å–æ–≥–æ –æ–¥–Ω–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É.
* –û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ —É—á–∞—Å–Ω–∏–∫—ñ–≤ **–ø–æ–≤–∏–Ω–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥—ñ–π—Å–Ω—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É** —ñ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ **—ñ–º'—è**, –∑–∞–≥–∞–ª–æ–º –≤–æ–Ω–∏ –Ω–µ –∑–º–æ–∂—É—Ç—å –∫–µ—Ä—É–≤–∞—Ç–∏ –≤–∏—Å—Ç–∞–≤–ª–µ–Ω–Ω—è–º —Ä–∞—Ö—É–Ω–∫—ñ–≤ (–∞–ª–µ —ó–º –º–æ–∂—É—Ç—å –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—å–æ–≥–æ).
```
aws organizations create-account --account-name testingaccount --email testingaccount@lalala1233fr.com
```
### **–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ**

–û–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –º–æ–∂–Ω–∞ –≥—Ä—É–ø—É–≤–∞—Ç–∏ –≤ **–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ (OU)**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ **–ø–æ–ª—ñ—Ç–∏–∫–∏** –¥–ª—è –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–æ—ó –æ–¥–∏–Ω–∏—Ü—ñ, —è–∫—ñ –±—É–¥—É—Ç—å **–∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ –¥–æ –≤—Å—ñ—Ö –¥–æ—á—ñ—Ä–Ω—ñ—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ OU –º–æ–∂–µ –º–∞—Ç–∏ —ñ–Ω—à—ñ OU —è–∫ –¥–æ—á—ñ—Ä–Ω—ñ.
```bash
# You can get the root id from aws organizations list-roots
aws organizations create-organizational-unit --parent-id r-lalala --name TestOU
```
### Service Control Policy (SCP)

**–ü–æ–ª—ñ—Ç–∏–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –ø–æ—Å–ª—É–≥ (SCP)** - —Ü–µ –ø–æ–ª—ñ—Ç–∏–∫–∞, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î –ø–æ—Å–ª—É–≥–∏ —Ç–∞ –¥—ñ—ó, —è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ç–∞ —Ä–æ–ª—ñ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å–∞—Ö, –Ω–∞ —è–∫—ñ –≤–ø–ª–∏–≤–∞—î SCP. SCP —î **—Å—Ö–æ–∂–∏–º–∏ –Ω–∞ –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ–∑–≤–æ–ª—ñ–≤ IAM**, –∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º —Ç–æ–≥–æ, —â–æ –≤–æ–Ω–∏ **–Ω–µ –Ω–∞–¥–∞—é—Ç—å –∂–æ–¥–Ω–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤**. –ù–∞—Ç–æ–º—ñ—Å—Ç—å SCP –≤–∏–∑–Ω–∞—á–∞—é—Ç—å **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –¥–æ–∑–≤–æ–ª–∏** –¥–ª—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–æ—ó –æ–¥–∏–Ω–∏—Ü—ñ (OU) –∞–±–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É. –ö–æ–ª–∏ –≤–∏ –ø—Ä–∏–∫—Ä—ñ–ø–ª—é—î—Ç–µ SCP –¥–æ –∫–æ—Ä–µ–Ω—è –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –∞–±–æ OU, **SCP –æ–±–º–µ–∂—É—î –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è —Å—É–±'—î–∫—Ç—ñ–≤ —É —á–ª–µ–Ω—Å—å–∫–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å–∞—Ö**.

–¶–µ —î –Ñ–î–ò–ù–ò–ú —Å–ø–æ—Å–æ–±–æ–º, —è–∫–∏–º **–Ω–∞–≤—ñ—Ç—å –∫–æ—Ä–µ–Ω–µ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –±—É—Ç–∏ –∑—É–ø–∏–Ω–µ–Ω–∏–π** –≤—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ–≤–Ω–∏—Ö –¥—ñ–π. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, —â–æ–± –∑—É–ø–∏–Ω–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –≤—ñ–¥ –≤–∏–º–∫–Ω–µ–Ω–Ω—è CloudTrail –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–ø—ñ–π.\
–Ñ–¥–∏–Ω–∏–π —Å–ø–æ—Å—ñ–± –æ–±—ñ–π—Ç–∏ —Ü–µ - —Ç–∞–∫–æ–∂ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ **–º–∞–π—Å—Ç–µ—Ä-–æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å**, —è–∫–∏–π –Ω–∞–ª–∞—à—Ç–æ–≤—É—î SCP (–º–∞–π—Å—Ç–µ—Ä-–æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π).

{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **SCP –ª–∏—à–µ –æ–±–º–µ–∂—É—é—Ç—å —Å—É–±'—î–∫—Ç—ñ–≤ —É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ**, —Ç–æ–º—É —ñ–Ω—à—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –Ω–µ –ø—ñ–¥–ª—è–≥–∞—é—Ç—å –≤–ø–ª–∏–≤—É. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å SCP, —è–∫–∞ –∑–∞–±–æ—Ä–æ–Ω—è—î `s3:GetObject`, –Ω–µ –∑—É–ø–∏–Ω–∏—Ç—å –ª—é–¥–µ–π –≤—ñ–¥ **–¥–æ—Å—Ç—É–ø—É –¥–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ S3 –±–∞–∫–µ—Ç—É** —É –≤–∞—à–æ–º—É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ.
{% endhint %}

–ü—Ä–∏–∫–ª–∞–¥–∏ SCP:

* –ü–æ–≤–Ω–∞ –∑–∞–±–æ—Ä–æ–Ω–∞ –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É
* –î–æ–∑–≤–æ–ª–∏—Ç–∏ –ª–∏—à–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ä–µ–≥—ñ–æ–Ω–∏
* –î–æ–∑–≤–æ–ª–∏—Ç–∏ –ª–∏—à–µ —Å–µ—Ä–≤—ñ—Å–∏ –∑—ñ —Å–ø–∏—Å–∫—É –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö
*   –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–Ω—è GuardDuty, CloudTrail —Ç–∞ S3 Public Block Access
*   –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∞–±–æ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—é —Ä–æ–ª–µ–π –±–µ–∑–ø–µ–∫–∏/—Ä–µ–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç–∏.
* –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–ø—ñ–π.
* –ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ IAM —Ç–∞ –∫–ª—é—á—ñ–≤ –¥–æ—Å—Ç—É–ø—É

–ó–Ω–∞–π–¥—ñ—Ç—å **–ø—Ä–∏–∫–ª–∞–¥–∏ JSON** –∑–∞ –∞–¥—Ä–µ—Å–æ—é [https://docs.aws.amazon.com/organizations/latest/userguide/orgs\_manage\_policies\_scps\_examples.html](https://docs.aws.amazon.com/organizations/latest/userguide/orgs\_manage\_policies\_scps\_examples.html)

### ARN

**–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Ä–µ—Å—É—Ä—Å—É Amazon** - —Ü–µ **—É–Ω—ñ–∫–∞–ª—å–Ω–∞ –Ω–∞–∑–≤–∞**, —è–∫—É –º–∞—î –∫–æ–∂–µ–Ω —Ä–µ—Å—É—Ä—Å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ AWS, –≤–æ–Ω–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –æ—Å—å —Ç–∞–∫:
```
arn:partition:service:region:account-id:resource-type/resource-id
arn:aws:elasticbeanstalk:us-west-1:123456789098:environment/App/Env
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤ AWS —î 4 —Ä–æ–∑–¥—ñ–ª–∏, –∞–ª–µ –ª–∏—à–µ 3 —Å–ø–æ—Å–æ–±–∏ —ó—Ö –≤–∏–∫–ª–∏–∫—É:

* AWS Standard: `aws`
* AWS China: `aws-cn`
* AWS US public Internet (GovCloud): `aws-us-gov`
* AWS Secret (US Classified): `aws`

## IAM - –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é —Ç–∞ –¥–æ—Å—Ç—É–ø–æ–º

IAM - —Ü–µ —Å–µ—Ä–≤—ñ—Å, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –∫–µ—Ä—É–≤–∞—Ç–∏ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é**, **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—î—é** —Ç–∞ **–ö–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø—É** —É –≤–∞—à–æ–º—É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ AWS.

* **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** - –ü—Ä–æ—Ü–µ—Å –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –æ—Å–æ–±–∏ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ü—ñ—î—ó –æ—Å–æ–±–∏. –¶–µ–π –ø—Ä–æ—Ü–µ—Å –º–æ–∂–Ω–∞ –ø–æ–¥—ñ–ª–∏—Ç–∏ –Ω–∞: –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É.
* **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è** - –í–∏–∑–Ω–∞—á–∞—î, –¥–æ —á–æ–≥–æ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –æ—Å–æ–±–∞ –≤ —Å–∏—Å—Ç–µ–º—ñ –ø—ñ—Å–ª—è —ó—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.
* **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É** - –ú–µ—Ç–æ–¥ —ñ –ø—Ä–æ—Ü–µ—Å –Ω–∞–¥–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∑–∞—Ö–∏—â–µ–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É.

IAM –º–æ–∂–Ω–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑–∞ –π–æ–≥–æ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—é –∫–µ—Ä—É–≤–∞—Ç–∏, –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ç–∞ —Ä–µ–≥—É–ª—é–≤–∞—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –æ—Å–æ–±–∏—Å—Ç–æ—Å—Ç–µ–π –¥–æ –≤–∞—à–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ —É –≤–∞—à–æ–º—É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ AWS.

### [–ö–æ—Ä–µ–Ω–µ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É AWS](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_root-user.html) <a href="#id_root" id="id_root"></a>

–ö–æ–ª–∏ –≤–∏ –≤–ø–µ—Ä—à–µ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å Amazon Web Services (AWS), –≤–∏ –ø–æ—á–∏–Ω–∞—î—Ç–µ –∑ —î–¥–∏–Ω–æ—ó –æ—Å–æ–±–∏ –¥–ª—è –≤—Ö–æ–¥—É, —è–∫–∞ –º–∞—î **–ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö** —Å–µ—Ä–≤—ñ—Å—ñ–≤ —Ç–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ AWS –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ. –¶–µ _**–∫–æ—Ä–µ–Ω–µ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á**_ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É AWS, –¥–æ —è–∫–æ–≥–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –¥–æ—Å—Ç—É–ø, —É–≤—ñ–π—à–æ–≤—à–∏ –∑ **–µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—é –∞–¥—Ä–µ—Å–æ—é —Ç–∞ –ø–∞—Ä–æ–ª–µ–º, —è–∫—ñ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É**.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –Ω–æ–≤–∏–π **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä** –º–∞—Ç–∏–º–µ **–º–µ–Ω—à–µ –ø—Ä–∞–≤, –Ω—ñ–∂ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á**.

–ó —Ç–æ—á–∫–∏ –∑–æ—Ä—É –±–µ–∑–ø–µ–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —ñ —É–Ω–∏–∫–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ.

### [–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ IAM](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_users.html) <a href="#id_iam-users" id="id_iam-users"></a>

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á IAM - —Ü–µ —Å—É—Ç–Ω—ñ—Å—Ç—å, —è–∫—É –≤–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –≤ AWS, —â–æ–± **–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –æ—Å–æ–±—É –∞–±–æ –¥–æ–¥–∞—Ç–æ–∫**, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –π–æ–≥–æ –¥–ª—è **–≤–∑–∞—î–º–æ–¥—ñ—ó –∑ AWS**. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤ AWS —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ —ñ–º–µ–Ω—ñ —Ç–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö (–ø–∞—Ä–æ–ª—å —Ç–∞ –¥–æ –¥–≤–æ—Ö –∫–ª—é—á—ñ–≤ –¥–æ—Å—Ç—É–ø—É).

–ö–æ–ª–∏ –≤–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ IAM, –≤–∏ –Ω–∞–¥–∞—î—Ç–µ –π–æ–º—É **–¥–æ–∑–≤–æ–ª–∏**, —Ä–æ–±–ª—è—á–∏ –π–æ–≥–æ **—á–ª–µ–Ω–æ–º –≥—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**, –¥–æ —è–∫–æ—ó –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ–∑–≤–æ–ª—ñ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è), –∞–±–æ **–±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—Ä–∏–∫—Ä—ñ–ø–ª—é—é—á–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏** –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ **—É–≤—ñ–º–∫–Ω–µ–Ω–µ MFA –¥–ª—è –≤—Ö–æ–¥—É** —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å. API —Ç–æ–∫–µ–Ω–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ —É–≤—ñ–º–∫–Ω–µ–Ω–∏–º MFA –Ω–µ –∑–∞—Ö–∏—â–µ–Ω—ñ MFA. –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ **–æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –∫–ª—é—á—ñ–≤ API –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é MFA**, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –≤ –ø–æ–ª—ñ—Ç–∏—Ü—ñ, —â–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ–≤–Ω–∏—Ö –¥—ñ–π MFA –º–∞—î –±—É—Ç–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ–º (–ø—Ä–∏–∫–ª–∞–¥ [**—Ç—É—Ç**](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_credentials\_mfa\_configure-api-require.html)).

#### CLI

* **ID –∫–ª—é—á–∞ –¥–æ—Å—Ç—É–ø—É**: 20 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –≤–µ–ª–∏–∫–∏—Ö –∞–ª—Ñ–∞–≤—ñ—Ç–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ AKHDNAPO86BSHKDIRYT
* **ID —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–æ—Å—Ç—É–ø—É**: 40 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –≤–µ–ª–∏–∫–∏—Ö —ñ –º–∞–ª–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤: S836fh/J73yHSb64Ag3Rkdi/jaD6sPl6/antFtU (–Ω–µ–º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –≤—Ç—Ä–∞—á–µ–Ω—ñ ID —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–æ—Å—Ç—É–ø—É).

–ö–æ–ª–∏ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∑–º—ñ–Ω–∏—Ç–∏ –∫–ª—é—á –¥–æ—Å—Ç—É–ø—É**, —Ü–µ –ø—Ä–æ—Ü–µ—Å, —è–∫–∏–π –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤–∏–∫–æ–Ω–∞—Ç–∏:\
_–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø—É -> –ó–∞—Å—Ç–æ—Å—É–π—Ç–µ –Ω–æ–≤–∏–π –∫–ª—é—á –¥–æ —Å–∏—Å—Ç–µ–º–∏/–¥–æ–¥–∞—Ç–∫—É -> –ø–æ–∑–Ω–∞—á—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —è–∫ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏–π -> –¢–µ—Å—Ç—É–π—Ç–µ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –Ω–æ–≤–∏–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø—É –ø—Ä–∞—Ü—é—î -> –í–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞—Ä–∏–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø—É_

### MFA - –ë–∞–≥–∞—Ç–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è

–í–æ–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** –Ω–∞ –¥–æ–¥–∞—Ç–æ–∫ –¥–æ –≤–∞—à–∏—Ö —ñ—Å–Ω—É—é—á–∏—Ö –º–µ—Ç–æ–¥—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ –ø–∞—Ä–æ–ª—å, —Ç–∏–º —Å–∞–º–∏–º —Å—Ç–≤–æ—Ä—é—é—á–∏ –±–∞–≥–∞—Ç–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.\
–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫ –∞–±–æ —Ñ—ñ–∑–∏—á–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π**. –í–∏ –º–æ–∂–µ—Ç–µ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–∞–∫—ñ –¥–æ–¥–∞—Ç–∫–∏, —è–∫ Google Authenticator, —â–æ–± –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ MFA –≤ AWS.

–ü–æ–ª—ñ—Ç–∏–∫–∏ –∑ —É–º–æ–≤–∞–º–∏ MFA –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—ñ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ:

* –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –≥—Ä—É–ø–∏ IAM
* –†–µ—Å—É—Ä—Å—É, —Ç–∞–∫–æ–º—É —è–∫ –∫–æ—à–∏–∫ Amazon S3, —á–µ—Ä–≥–∞ Amazon SQS –∞–±–æ —Ç–µ–º–∞ Amazon SNS
* –ü–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ–≤—ñ—Ä–∏ —Ä–æ–ª—ñ IAM, —è–∫—É –º–æ–∂–µ –ø—Ä–∏–π–Ω—è—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ CLI** –¥–æ —Ä–µ—Å—É—Ä—Å—É, —è–∫–∏–π **–ø–µ—Ä–µ–≤—ñ—Ä—è—î MFA**, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ **`GetSessionToken`**. –¶–µ –Ω–∞–¥–∞—Å—Ç—å –≤–∞–º —Ç–æ–∫–µ–Ω –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ MFA.\
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **–æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ `AssumeRole` –Ω–µ –º—ñ—Å—Ç—è—Ç—å —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**.
```bash
aws sts get-session-token --serial-number <arn_device> --token-code <code>
```
–Ø–∫ [**–∑–∞–∑–Ω–∞—á–µ–Ω–æ —Ç—É—Ç**](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_credentials\_mfa\_configure-api-require.html), —ñ—Å–Ω—É—î –±–∞–≥–∞—Ç–æ —Ä—ñ–∑–Ω–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤, –∫–æ–ª–∏ **MFA –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ**.

### [IAM –≥—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_groups.html) <a href="#id_iam-groups" id="id_iam-groups"></a>

IAM [–≥—Ä—É–ø–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_groups.html) - —Ü–µ —Å–ø–æ—Å—ñ–± **–ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫ –¥–æ –∫—ñ–ª—å–∫–æ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** –æ–¥–Ω–æ—á–∞—Å–Ω–æ, —â–æ –º–æ–∂–µ —Å–ø—Ä–æ—Å—Ç–∏—Ç–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–æ–∑–≤–æ–ª–∞–º–∏ –¥–ª—è —Ü–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤. **–†–æ–ª—ñ —Ç–∞ –≥—Ä—É–ø–∏ –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —á–∞—Å—Ç–∏–Ω–æ—é –≥—Ä—É–ø–∏**.

–í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏ **–ø–æ–ª—ñ—Ç–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ –¥–æ –≥—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**, —â–æ–± –≤—Å—ñ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** –≤ –≥—Ä—É–ø—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ **–æ—Ç—Ä–∏–º–∞–ª–∏ –¥–æ–∑–≤–æ–ª–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏**. –í–∏ **–Ω–µ –º–æ–∂–µ—Ç–µ** —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ **–≥—Ä—É–ø—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** —è–∫ **`Principal`** —É **–ø–æ–ª—ñ—Ç–∏—Ü—ñ** (—Ç–∞–∫—ñ–π —è–∫ –ø–æ–ª—ñ—Ç–∏–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ—Å—É—Ä—Å—ñ–≤), –æ—Å–∫—ñ–ª—å–∫–∏ –≥—Ä—É–ø–∏ —Å—Ç–æ—Å—É—é—Ç—å—Å—è –¥–æ–∑–≤–æ–ª—ñ–≤, –∞ –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –∞ –ø—Ä–∏–Ω—Ü–∏–ø–∏ —î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º–∏ —Å—É—Ç–Ω–æ—Å—Ç—è–º–∏ IAM.

–û—Å—å –¥–µ—è–∫—ñ –≤–∞–∂–ª–∏–≤—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≥—Ä—É–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:

* –ì—Ä—É–ø–∞ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** –º–æ–∂–µ **–º—ñ—Å—Ç–∏—Ç–∏ –±–∞–≥–∞—Ç–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**, –∞ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á** –º–æ–∂–µ **–Ω–∞–ª–µ–∂–∞—Ç–∏ –¥–æ –∫—ñ–ª—å–∫–æ—Ö –≥—Ä—É–ø**.
* **–ì—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∫–ª–∞–¥–µ–Ω–∏–º–∏**; –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ª–∏—à–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∞ –Ω–µ —ñ–Ω—à—ñ –≥—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
* –Ü—Å–Ω—É—î **–∂–æ–¥–Ω–∞ –≥—Ä—É–ø–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, —è–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∫–ª—é—á–∞—î –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ AWS**. –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –º–∞—Ç–∏ —Ç–∞–∫—É –≥—Ä—É–ø—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ó—ó —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –∫–æ–∂–Ω–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –Ω–µ—ó.
* –ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ —Ä–æ–∑–º—ñ—Ä —Ä–µ—Å—É—Ä—Å—ñ–≤ IAM –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ AWS, —Ç–∞–∫–∏—Ö —è–∫ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥—Ä—É–ø, —ñ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥—Ä—É–ø, –¥–æ —è–∫–∏—Ö –º–æ–∂–µ –Ω–∞–ª–µ–∂–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –æ–±–º–µ–∂–µ–Ω—ñ. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –¥–∏–≤—ñ—Ç—å—Å—è [–∫–≤–æ—Ç–∏ IAM —Ç–∞ AWS STS](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference\_iam-quotas.html).

### [IAM —Ä–æ–ª—ñ](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_roles.html) <a href="#id_iam-roles" id="id_iam-roles"></a>

IAM **—Ä–æ–ª—å** –¥—É–∂–µ **—Å—Ö–æ–∂–∞** –Ω–∞ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑ –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏ –¥–æ–∑–≤–æ–ª—ñ–≤, —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å, —â–æ** –≤–æ–Ω–∞ –º–æ–∂–µ —ñ –Ω–µ –º–æ–∂–µ —Ä–æ–±–∏—Ç–∏ –≤ AWS. –û–¥–Ω–∞–∫ —Ä–æ–ª—å **–Ω–µ –º–∞—î –∂–æ–¥–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö** (–ø–∞—Ä–æ–ª—å –∞–±–æ –∫–ª—é—á—ñ –¥–æ—Å—Ç—É–ø—É), –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ –Ω–µ—é. –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–æ –ø–æ–≤'—è–∑–∞–Ω–æ—é –∑ –æ–¥–Ω—ñ—î—é –æ—Å–æ–±–æ—é, —Ä–æ–ª—å –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —ó—ó **–º–æ–≥–ª–∏ –ø—Ä–∏–π–º–∞—Ç–∏ –±—É–¥—å-—Ö—Ç–æ, —Ö—Ç–æ —ó—ó –ø–æ—Ç—Ä–µ–±—É—î (—ñ –º–∞—î –¥–æ—Å—Ç–∞—Ç–Ω—ñ –¥–æ–∑–≤–æ–ª–∏)**. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á IAM –º–æ–∂–µ –ø—Ä–∏–π–Ω—è—Ç–∏ —Ä–æ–ª—å, —â–æ–± —Ç–∏–º—á–∞—Å–æ–≤–æ** –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è. –†–æ–ª—å –º–æ–∂–µ –±—É—Ç–∏ **–ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞** [**—Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É**](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_roles\_providers.html), —è–∫–∏–π –≤—Ö–æ–¥–∏—Ç—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ –∑–∞–º—ñ—Å—Ç—å IAM.

IAM —Ä–æ–ª—å —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ **–¥–≤–æ—Ö —Ç–∏–ø—ñ–≤ –ø–æ–ª—ñ—Ç–∏–∫**: **–ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ–≤—ñ—Ä–∏**, —è–∫–∞ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—å–æ—é, —â–æ –≤–∏–∑–Ω–∞—á–∞—î **—Ö—Ç–æ –º–æ–∂–µ –ø—Ä–∏–π–Ω—è—Ç–∏** —Ä–æ–ª—å, —ñ **–ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ–∑–≤–æ–ª—ñ–≤**, —è–∫–∞ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—å–æ—é, —â–æ –≤–∏–∑–Ω–∞—á–∞—î **–¥–æ —á–æ–≥–æ –≤–æ–Ω–∞ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø**.

#### AWS –°–ª—É–∂–±–∞ –±–µ–∑–ø–µ—á–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤ (STS)

AWS –°–ª—É–∂–±–∞ –±–µ–∑–ø–µ—á–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤ (STS) - —Ü–µ –≤–µ–±-—Å–µ—Ä–≤—ñ—Å, —è–∫–∏–π –ø–æ–ª–µ–≥—à—É—î **–≤–∏–¥–∞—á—É —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö, –æ–±–º–µ–∂–µ–Ω–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**. –í—ñ–Ω —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –¥–ª—è:

### [–¢–∏–º—á–∞—Å–æ–≤—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –≤ IAM](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_credentials\_temp.html) <a href="#id_temp-creds" id="id_temp-creds"></a>

**–¢–∏–º—á–∞—Å–æ–≤—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –∑ IAM —Ä–æ–ª—è–º–∏**, –∞–ª–µ —î –π —ñ–Ω—à—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è. –í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, —è–∫—ñ –º–∞—é—Ç—å –±—ñ–ª—å—à –æ–±–º–µ–∂–µ–Ω–∏–π –Ω–∞–±—ñ—Ä –¥–æ–∑–≤–æ–ª—ñ–≤, –Ω—ñ–∂ –≤–∞—à —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á IAM. –¶–µ **–∑–∞–ø–æ–±—ñ–≥–∞—î** –≤–∞–º **–≤–∏–ø–∞–¥–∫–æ–≤–æ–º—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—é –∑–∞–≤–¥–∞–Ω—å, —è–∫—ñ –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ** –±—ñ–ª—å—à –æ–±–º–µ–∂–µ–Ω–∏–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏. –ü–µ—Ä–µ–≤–∞–≥–æ—é —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö —î —Ç–µ, —â–æ –≤–æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –ø–µ—Ä—ñ–æ–¥—É —á–∞—Å—É. –í–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–æ—ó –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —î –¥—ñ–π—Å–Ω–∏–º–∏.

### –ü–æ–ª—ñ—Ç–∏–∫–∏

#### –î–æ–∑–≤–æ–ª–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—ñ–≤. –Ñ 2 —Ç–∏–ø–∏:

* –ü–æ–ª—ñ—Ç–∏–∫–∏, –∫–µ—Ä–æ–≤–∞–Ω—ñ AWS (–ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ AWS)
* –ü–æ–ª—ñ—Ç–∏–∫–∏, –∫–µ—Ä–æ–≤–∞–Ω—ñ –∫–ª—ñ—î–Ω—Ç–æ–º: –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –≤–∞–º–∏. –í–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–ª—ñ—Ç–∏–∫, –∫–µ—Ä–æ–≤–∞–Ω–∏—Ö AWS (–º–æ–¥–∏—Ñ—ñ–∫—É—é—á–∏ –æ–¥–Ω—É –∑ –Ω–∏—Ö —ñ —Å—Ç–≤–æ—Ä—é—é—á–∏ —Å–≤–æ—é), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ–ª—ñ—Ç–∏–∫ (GUI, —â–æ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∞–º –Ω–∞–¥–∞–≤–∞—Ç–∏ —Ç–∞ –≤—ñ–¥–º–æ–≤–ª—è—Ç–∏ –≤ –¥–æ–∑–≤–æ–ª–∞—Ö) –∞–±–æ –Ω–∞–ø–∏—Å–∞–≤—à–∏ —Å–≤–æ—ó –≤–ª–∞—Å–Ω—ñ.

–ó–∞ **–∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–æ—Å—Ç—É–ø** —î **–∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–º**, –¥–æ—Å—Ç—É–ø –±—É–¥–µ –Ω–∞–¥–∞–Ω–æ, —è–∫—â–æ –±—É–ª–∞ –≤–∫–∞–∑–∞–Ω–∞ —è–≤–Ω–∞ —Ä–æ–ª—å.\
–Ø–∫—â–æ **—ñ—Å–Ω—É—î —î–¥–∏–Ω–µ "–ó–∞–ø–µ—Ä–µ—á–µ–Ω–Ω—è", –≤–æ–Ω–æ –ø–µ—Ä–µ–≤–∞–∂–∞—Ç–∏–º–µ "–î–æ–∑–≤–æ–ª–∏—Ç–∏"**, –∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º –∑–∞–ø–∏—Ç—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∫–æ—Ä–µ–Ω–µ–≤—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –±–µ–∑–ø–µ–∫–∏ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É AWS (—è–∫—ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–æ–∑–≤–æ–ª–µ–Ω—ñ).
```javascript
{
"Version": "2012-10-17",  //Version of the policy
"Statement": [  //Main element, there can be more than 1 entry in this array
{
"Sid": "Stmt32894y234276923" //Unique identifier (optional)
"Effect": "Allow", //Allow or deny
"Action": [  //Actions that will be allowed or denied
"ec2:AttachVolume",
"ec2:DetachVolume"
],
"Resource": [ //Resource the action and effect will be applied to
"arn:aws:ec2:*:*:volume/*",
"arn:aws:ec2:*:*:instance/*"
],
"Condition": { //Optional element that allow to control when the permission will be effective
"ArnEquals": {"ec2:SourceInstanceARN": "arn:aws:ec2:*:*:instance/instance-id"}
}
}
]
}
```
The [–≥–ª–æ–±–∞–ª—å–Ω—ñ –ø–æ–ª—è, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —É–º–æ–≤ —É –±—É–¥—å-—è–∫—ñ–π —Å–ª—É–∂–±—ñ, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ —Ç—É—Ç](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference\_policies\_condition-keys.html#condition-keys-resourceaccount).\
[–°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –ø–æ–ª—è, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —É–º–æ–≤ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–ª—É–∂–±–∏, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ —Ç—É—Ç](https://docs.aws.amazon.com/service-authorization/latest/reference/reference\_policies\_actions-resources-contextkeys.html).

#### –í–±—É–¥–æ–≤–∞–Ω—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏

–¶–µ–π –≤–∏–¥ –ø–æ–ª—ñ—Ç–∏–∫ **–±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—Ä–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É, –≥—Ä—É–ø—ñ –∞–±–æ —Ä–æ–ª—ñ. –¢–æ–¥—ñ –≤–æ–Ω–∏ –Ω–µ –∑'—è–≤–ª—è—é—Ç—å—Å—è —É —Å–ø–∏—Å–∫—É –ø–æ–ª—ñ—Ç–∏–∫, –æ—Å–∫—ñ–ª—å–∫–∏ —ñ–Ω—à—ñ –Ω–µ –º–æ–∂—É—Ç—å —ó—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏.\
–í–±—É–¥–æ–≤–∞–Ω—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏ –∫–æ—Ä–∏—Å–Ω—ñ, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ **–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å—Ç—Ä–æ–≥—ñ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ñ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∏ –º—ñ–∂ –ø–æ–ª—ñ—Ç–∏–∫–æ—é —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—é**, –¥–æ —è–∫–æ—ó –≤–æ–Ω–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏ —Ö–æ—á–µ—Ç–µ –±—É—Ç–∏ –≤–ø–µ–≤–Ω–µ–Ω–∏–º–∏, —â–æ –¥–æ–∑–≤–æ–ª–∏ –≤ –ø–æ–ª—ñ—Ç–∏—Ü—ñ –Ω–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ —ñ–Ω—à—ñ–π —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ, –æ–∫—Ä—ñ–º —Ç—ñ—î—ó, –¥–ª—è —è–∫–æ—ó –≤–æ–Ω–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ. –ö–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –≤–±—É–¥–æ–≤–∞–Ω—É –ø–æ–ª—ñ—Ç–∏–∫—É, –¥–æ–∑–≤–æ–ª–∏ –≤ –ø–æ–ª—ñ—Ç–∏—Ü—ñ –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—ñ –¥–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ. –ö—Ä—ñ–º —Ç–æ–≥–æ, –∫–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ AWS Management Console –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ü—ñ—î—ó —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ, –ø–æ–ª—ñ—Ç–∏–∫–∏, –≤–±—É–¥–æ–≤–∞–Ω—ñ –≤ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å, —Ç–∞–∫–æ–∂ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è. –¶–µ —Ç–æ–º—É, —â–æ –≤–æ–Ω–∏ —î —á–∞—Å—Ç–∏–Ω–æ—é –æ—Å–Ω–æ–≤–Ω–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ.

#### –ü–æ–ª—ñ—Ç–∏–∫–∏ —Ä–µ—Å—É—Ä—Å–Ω–∏—Ö –∫–æ—à–∏–∫—ñ–≤

–¶–µ **–ø–æ–ª—ñ—Ç–∏–∫–∏**, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤ **—Ä–µ—Å—É—Ä—Å–∞—Ö**. **–ù–µ –≤—Å—ñ —Ä–µ—Å—É—Ä—Å–∏ AWS –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å —ó—Ö**.

–Ø–∫—â–æ —É –æ—Å–Ω–æ–≤–Ω–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ –Ω–µ–º–∞—î —è–≤–Ω–æ–≥–æ –∑–∞–±–æ—Ä–æ–Ω–∏ –Ω–∞ –Ω–∏—Ö, —ñ –ø–æ–ª—ñ—Ç–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É –Ω–∞–¥–∞—î —ó–º –¥–æ—Å—Ç—É–ø, —Ç–æ–¥—ñ —ó–º –¥–æ–∑–≤–æ–ª–µ–Ω–æ.

### –ú–µ–∂—ñ IAM

–ú–µ–∂—ñ IAM –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **–æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—ñ–≤, –¥–æ —è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–±–æ —Ä–æ–ª—å –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —ñ–Ω—à–∏–π –Ω–∞–±—ñ—Ä –¥–æ–∑–≤–æ–ª—ñ–≤ –Ω–∞–¥–∞—î—Ç—å—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É **—ñ–Ω—à–æ—é –ø–æ–ª—ñ—Ç–∏–∫–æ—é**, –æ–ø–µ—Ä–∞—Ü—ñ—è **–Ω–µ –≤–¥–∞—Å—Ç—å—Å—è**, —è–∫—â–æ –≤—ñ–Ω —Å–ø—Ä–æ–±—É—î —ó—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏.

–ú–µ–∂–∞ - —Ü–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–ª—ñ—Ç–∏–∫–∞, –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–∞ –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∞ **–≤–∫–∞–∑—É—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –¥–æ–∑–≤–æ–ª—ñ–≤, —è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–±–æ —Ä–æ–ª—å –º–æ–∂—É—Ç—å –º–∞—Ç–∏**. –û—Ç–∂–µ, **–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —î –¥–æ—Å—Ç—É–ø –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞**, —è–∫—â–æ –º–µ–∂–∞ –≤–∫–∞–∑—É—î, —â–æ –≤—ñ–Ω –º–æ–∂–µ –ª–∏—à–µ —á–∏—Ç–∞—Ç–∏ S¬∑ –∫–æ—à–∏–∫–∏, —Ü–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ, —â–æ –≤—ñ–Ω –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏.

**–¶–µ**, **SCP** —Ç–∞ **–¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–∏–Ω—Ü–∏–ø—É –Ω–∞–π–º–µ–Ω—à–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤** - —Ü–µ —Å–ø–æ—Å–æ–±–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é, —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –Ω–µ –º–∞–ª–∏ –±—ñ–ª—å—à–µ –¥–æ–∑–≤–æ–ª—ñ–≤, –Ω—ñ–∂ —ó–º –ø–æ—Ç—Ä—ñ–±–Ω–æ.

### –ü–æ–ª—ñ—Ç–∏–∫–∏ —Å–µ—Å—ñ—ó

–ü–æ–ª—ñ—Ç–∏–∫–∞ —Å–µ—Å—ñ—ó - —Ü–µ **–ø–æ–ª—ñ—Ç–∏–∫–∞, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –∫–æ–ª–∏ —Ä–æ–ª—å –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è** —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º. –¶–µ –±—É–¥–µ —è–∫ **–º–µ–∂–∞ IAM –¥–ª—è —Ü—ñ—î—ó —Å–µ—Å—ñ—ó**: –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø–æ–ª—ñ—Ç–∏–∫–∞ —Å–µ—Å—ñ—ó –Ω–µ –Ω–∞–¥–∞—î –¥–æ–∑–≤–æ–ª—ñ–≤, –∞–ª–µ **–æ–±–º–µ–∂—É—î —ó—Ö –¥–æ —Ç–∏—Ö, —â–æ –≤–∫–∞–∑–∞–Ω—ñ –≤ –ø–æ–ª—ñ—Ç–∏—Ü—ñ** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ - —Ü–µ —Ç—ñ, —è–∫—ñ –º–∞—î —Ä–æ–ª—å).

–¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è **–∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏**: –ö–æ–ª–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–±–∏—Ä–∞—î—Ç—å—Å—è –ø—Ä–∏–π–Ω—è—Ç–∏ –¥—É–∂–µ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—É —Ä–æ–ª—å, –≤—ñ–Ω –º–æ–∂–µ –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ–∑–≤–æ–ª–∏ –ª–∏—à–µ —Ç–∏–º–∏, —â–æ –≤–∫–∞–∑–∞–Ω—ñ –≤ –ø–æ–ª—ñ—Ç–∏—Ü—ñ —Å–µ—Å—ñ—ó, —É —Ä–∞–∑—ñ, —è–∫—â–æ —Å–µ—Å—ñ—è –±—É–¥–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∞.
```bash
aws sts assume-role \
--role-arn <value> \
--role-session-name <value> \
[--policy-arns <arn_custom_policy1> <arn_custom_policy2>]
[--policy <file://policy.json>]
```
Note that by default **AWS might add session policies to sessions** that are going to be generated because of third reasons. For example, in [unauthenticated cognito assumed roles](../aws-services/aws-cognito-enum/cognito-identity-pools.md#accessing-iam-roles) by default (using enhanced authentication), AWS will generate **session credentials with a session policy** that limits the services that session can access [**to the following list**](https://docs.aws.amazon.com/cognito/latest/developerguide/iam-roles.html#access-policies-scope-down-services).

Therefore, if at some point you face the error "... because no session policy allows the ...", and the role has access to perform the action, it's because **there is a session policy preventing it**.

### Identity Federation

Identity federation **–¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –∑ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ, —è–∫—ñ —î –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏** –¥–ª—è AWS, –±–µ–∑–ø–µ—á–Ω–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ AWS –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –Ω–∞–¥–∞–≤–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ AWS –∑ –¥—ñ–π—Å–Ω–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É IAM.\
–ü—Ä–∏–∫–ª–∞–¥–æ–º –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∞—à –≤–ª–∞—Å–Ω–∏–π –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏–π **Microsoft Active Directory** (—á–µ—Ä–µ–∑ **SAML**) –∞–±–æ **OpenID** —Å–µ—Ä–≤—ñ—Å–∏ (—è–∫ **Google**). –§–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ–∑–≤–æ–ª–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω—å–æ–≥–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ AWS.

To configure this trust, an **IAM Identity Provider is generated (SAML or OAuth)** that will **trust** the **other platform**. Then, at least one **IAM role is assigned (trusting) to the Identity Provider**. If a user from the trusted platform access AWS, he will be accessing as the mentioned role.

However, you will usually want to give a **different role depending on the group of the user** in the third party platform. Then, several **IAM roles can trust** the third party Identity Provider and the third party platform will be the one allowing users to assume one role or the other.

<figure><img src="../../../.gitbook/assets/image (247).png" alt=""><figcaption></figcaption></figure>

### IAM Identity Center

AWS IAM Identity Center (successor to AWS Single Sign-On) expands the capabilities of AWS Identity and Access Management (IAM) to provide a **—Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –º—ñ—Å—Ü–µ**, —è–∫–µ –æ–±'—î–¥–Ω—É—î **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ —ó—Ö –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ AWS** —Ç–∞ —Ö–º–∞—Ä–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤.

The login domain is going to be something like `<user_input>.awsapps.com`.

To login users, there are 3 identity sources that can be used:

* Identity Center Directory: Regular AWS users
* Active Directory: Supports different connectors
* External Identity Provider: All users and groups come from an external Identity Provider (IdP)

<figure><img src="../../../.gitbook/assets/image (279).png" alt=""><figcaption></figcaption></figure>

In the simplest case of Identity Center directory, the **Identity Center will have a list of users & groups** and will be able to **assign policies** to them to **any of the accounts** of the organization.

In order to give access to a Identity Center user/group to an account a **SAML Identity Provider trusting the Identity Center will be created**, and a **role trusting the Identity Provider with the indicated policies will be created** in the destination account.

#### AwsSSOInlinePolicy

It's possible to **give permissions via inline policies to roles created via IAM Identity Center**. The roles created in the accounts being given **inline policies in AWS Identity Center** will have these permissions in an inline policy called **`AwsSSOInlinePolicy`**.

Therefore, even if you see 2 roles with an inline policy called **`AwsSSOInlinePolicy`**, it **doesn't mean it has the same permissions**.

### Cross Account Trusts and Roles

**–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á** (–¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω–∏–π) –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–æ–ª—å –º—ñ–∂ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏ –∑ –¥–µ—è–∫–∏–º–∏ –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏, –∞ –ø–æ—Ç—ñ–º **–¥–æ–∑–≤–æ–ª–∏—Ç–∏ —ñ–Ω—à–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É** (–¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω–æ–º—É) **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å–≤–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É**, –∞–ª–µ –ª–∏—à–µ **–º–∞—é—á–∏ –¥–æ—Å—Ç—É–ø, –≤–∫–∞–∑–∞–Ω–∏–π —É –Ω–æ–≤–∏—Ö –ø–æ–ª—ñ—Ç–∏–∫–∞—Ö —Ä–æ–ª—ñ**. To create this, just create a new Role and select Cross Account Role. Roles for Cross-Account Access offers two options. Providing access between AWS accounts that you own, and providing access between an account that you own and a third party AWS account.\
It's recommended to **–≤–∫–∞–∑–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —î –¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω–∏–º, –∞ –Ω–µ —Å—Ç–∞–≤–∏—Ç–∏ —â–æ—Å—å –∑–∞–≥–∞–ª—å–Ω–µ**, —Ç–æ–º—É —â–æ –≤ —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É —ñ–Ω—à—ñ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, —Ç–∞–∫—ñ —è–∫ —Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, —Ç–∞–∫–æ–∂ –∑–º–æ–∂—É—Ç—å –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü—ñ—î—é –¥–æ–≤—ñ—Ä–æ—é.

### AWS Simple AD

Not supported:

* Trust Relations
* AD Admin Center
* Full PS API support
* AD Recycle Bin
* Group Managed Service Accounts
* Schema Extensions
* No Direct access to OS or Instances

#### Web Federation or OpenID Authentication

The app uses the AssumeRoleWithWebIdentity to create temporary credentials. However, this doesn't grant access to the AWS console, just access to resources within AWS.

### Other IAM options

* You can **set a password policy setting** options like minimum length and password requirements.
* You can **download "Credential Report"** with information about current credentials (like user creation time, is password enabled...). You can generate a credential report as often as once every **four hours**.

AWS Identity and Access Management (IAM) provides **fine-grained access control** across all of AWS. With IAM, you can specify **who can access which services and resources**, and under which conditions. With IAM policies, you manage permissions to your workforce and systems to **ensure least-privilege permissions**.

### IAM ID Prefixes

In [**this page**](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference\_identifiers.html#identifiers-unique-ids) you can find the **IAM ID prefixe**d of keys depending on their nature:

| ABIA | [AWS STS service bearer token](https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_credentials\_bearer.html)                                                                                                         |
| ---- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ACCA | Context-specific credential                                                                                                                                                                                           |
| AGPA | User group                                                                                                                                                                                                            |
| AIDA | IAM user                                                                                                                                                                                                              |
| AIPA | Amazon EC2 instance profile                                                                                                                                                                                           |
| AKIA | Access key                                                                                                                                                                                                            |
| ANPA | Managed policy                                                                                                                                                                                                        |
| ANVA | Version in a managed policy                                                                                                                                                                                           |
| APKA | Public key                                                                                                                                                                                                            |
| AROA | Role                                                                                                                                                                                                                  |
| ASCA | Certificate                                                                                                                                                                                                           |
| ASIA | [Temporary (AWS STS) access key IDs](https://docs.aws.amazon.com/STS/latest/APIReference/API\_Credentials.html) use this prefix, but are unique only in combination with the secret access key and the session token. |

### Recommended permissions to audit accounts

The following privileges grant various read access of metadata:

* `arn:aws:iam::aws:policy/SecurityAudit`
* `arn:aws:iam::aws:policy/job-function/ViewOnlyAccess`
* `codebuild:ListProjects`
* `config:Describe*`
* `cloudformation:ListStacks`
* `logs:DescribeMetricFilters`
* `directconnect:DescribeConnections`
* `dynamodb:ListTables`

## Misc

### CLI Authentication

In order for a regular user authenticate to AWS via CLI you need to have **local credentials**. By default you can configure them **manually** in `~/.aws/credentials` or by **running** `aws configure`.\
In that file you can have more than one profile, if **no profile** is specified using the **aws cli**, the one called **`[default]`** in that file will be used.\
Example of credentials file with more than 1 profile:
```
[default]
aws_access_key_id = AKIA5ZDCUJHF83HDTYUT
aws_secret_access_key = uOcdhof683fbOUGFYEQug8fUGIf68greoihef

[Admin]
aws_access_key_id = AKIA8YDCu7TGTR356SHYT
aws_secret_access_key = uOcdhof683fbOUGFYEQuR2EIHG34UY987g6ff7
region = eu-west-2
```
–Ø–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **—Ä—ñ–∑–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ AWS** —ñ –≤–∞—à–æ–º—É –ø—Ä–æ—Ñ—ñ–ª—é –±—É–ª–æ –Ω–∞–¥–∞–Ω–æ –¥–æ—Å—Ç—É–ø –¥–æ **–ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä–æ–ª—ñ –≤ —Ü–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å–∞—Ö**, –≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Ä—É—á–Ω—É –≤–∏–∫–ª–∏–∫–∞—Ç–∏ STS —â–æ—Ä–∞–∑—É (`aws sts assume-role --role-arn <role-arn> --role-session-name sessname`) —ñ –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ.

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ–∞–π–ª `~/.aws/config`, —â–æ–± [**–≤–∫–∞–∑–∞—Ç–∏, —è–∫—ñ —Ä–æ–ª—ñ –ø—Ä–∏–π–º–∞—Ç–∏**](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html), –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `--profile` —è–∫ –∑–∞–∑–≤–∏—á–∞–π (–ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä–æ–ª—ñ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ –ø—Ä–æ–∑–æ—Ä–æ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞).\
–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É:
```
[profile acc2]
region=eu-west-2
role_arn=arn:aws:iam::<account-id>:role/<role-path>
role_session_name = <session_name>
source_profile = <profile_with_assume_role>
sts_regional_endpoints = regional
```
–ó —Ü–∏–º —Ñ–∞–π–ª–æ–º –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ aws cli, —è–∫:
```
aws --profile acc2 ...
```
–Ø–∫—â–æ –≤–∏ —à—É–∫–∞—î—Ç–µ —â–æ—Å—å **—Å—Ö–æ–∂–µ** –Ω–∞ —Ü–µ, –∞–ª–µ –¥–ª—è **–±—Ä–∞—É–∑–µ—Ä–∞**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** [**AWS Extend Switch Roles**](https://chrome.google.com/webstore/detail/aws-extend-switch-roles/jpmkfafbacpgapdghgdpembnojdlgkdl?hl=en).

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://docs.aws.amazon.com/organizations/latest/userguide/orgs\_getting-started\_concepts.html](https://docs.aws.amazon.com/organizations/latest/userguide/orgs\_getting-started\_concepts.html)
* [https://aws.amazon.com/iam/](https://aws.amazon.com/iam/)
* [https://docs.aws.amazon.com/singlesignon/latest/userguide/what-is.html](https://docs.aws.amazon.com/singlesignon/latest/userguide/what-is.html)

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
