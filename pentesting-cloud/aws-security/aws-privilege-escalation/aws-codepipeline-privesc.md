# AWS - Codepipeline Privesc

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## codepipeline

codepipelineì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤:

{% content-ref url="../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md" %}
[aws-datapipeline-codepipeline-codebuild-and-codecommit.md](../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md)
{% endcontent-ref %}

### `iam:PassRole`, `codepipeline:CreatePipeline`, `codebuild:CreateProject, codepipeline:StartPipelineExecution`

code pipelineì„ ìƒì„±í•  ë•Œ **ì‹¤í–‰í•  codepipeline IAM Role**ì„ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ì†ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì „ ê¶Œí•œ ì™¸ì—ë„ **ì½”ë“œê°€ ì €ì¥ëœ ìœ„ì¹˜ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤**(S3, ECR, github, bitbucket...)ê°€ í•„ìš”í•©ë‹ˆë‹¤.

ì›¹ í˜ì´ì§€ì—ì„œ ì´ ê³¼ì •ì„ ìˆ˜í–‰í•˜ë©´ì„œ í…ŒìŠ¤íŠ¸í–ˆìœ¼ë©°, ì´ì „ì— ì–¸ê¸‰í•œ ê¶Œí•œì€ codepipelineì„ ìƒì„±í•˜ëŠ” ë° í•„ìš”í•œ List/Get ê¶Œí•œì´ ì•„ë‹ˆì§€ë§Œ, ì›¹ì—ì„œ ìƒì„±í•˜ë ¤ë©´ ë‹¤ìŒ ê¶Œí•œë„ í•„ìš”í•©ë‹ˆë‹¤: `codebuild:ListCuratedEnvironmentImages, codebuild:ListProjects, codebuild:ListRepositories, codecommit:ListRepositories, events:PutTargets, codepipeline:ListPipelines, events:PutRule, codepipeline:ListActionTypes, cloudtrail:<several>`

**ë¹Œë“œ í”„ë¡œì íŠ¸ ìƒì„±** ì¤‘ì— **ì‹¤í–‰í•  ëª…ë ¹**(rev shell?)ê³¼ **íŠ¹ê¶Œ ì‚¬ìš©ìë¡œ ë¹Œë“œ ë‹¨ê³„ë¥¼ ì‹¤í–‰**í•˜ë„ë¡ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ê³µê²©ìê°€ ì†ìƒì‹œí‚¤ê¸° ìœ„í•´ í•„ìš”í•œ êµ¬ì„±ì…ë‹ˆë‹¤:

![](<../../../.gitbook/assets/image (276).png>)

![](<../../../.gitbook/assets/image (181).png>)

### ?`codebuild:UpdateProject, codepipeline:UpdatePipeline, codepipeline:StartPipelineExecution`

ì´ì „ ê¶Œí•œìœ¼ë¡œ codepipelineì—ì„œ ì‚¬ìš©ëœ ì—­í• ê³¼ ì‹¤í–‰ëœ ëª…ë ¹ì„ ìˆ˜ì •í•  ìˆ˜ ìˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.

### `codepipeline:pollforjobs`

[AWS ì–¸ê¸‰](https://docs.aws.amazon.com/codepipeline/latest/APIReference/API\_PollForJobs.html):

> ì´ APIê°€ í˜¸ì¶œë˜ë©´ CodePipelineì€ **íŒŒì´í”„ë¼ì¸ì˜ ì•„í‹°íŒ©íŠ¸ë¥¼ ì €ì¥í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” S3 ë²„í‚·ì— ëŒ€í•œ ì„ì‹œ ìê²© ì¦ëª…**ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì‘ì—…ì´ ì…ë ¥ ë˜ëŠ” ì¶œë ¥ ì•„í‹°íŒ©íŠ¸ì— ëŒ€í•´ í•´ë‹¹ S3 ë²„í‚·ì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•˜ëŠ” ê²½ìš° ì´ APIëŠ” ì‘ì—…ì— ëŒ€í•´ ì •ì˜ëœ **ë¹„ë°€ ê°’ë„ ë°˜í™˜**í•©ë‹ˆë‹¤.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
