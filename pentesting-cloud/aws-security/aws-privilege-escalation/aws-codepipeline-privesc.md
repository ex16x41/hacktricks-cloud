# AWS - Codepipeline Privesc

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

## codepipeline

codepipelineì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ëŠ” ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md" %}
[aws-datapipeline-codepipeline-codebuild-and-codecommit.md](../aws-services/aws-datapipeline-codepipeline-codebuild-and-codecommit.md)
{% endcontent-ref %}

### `iam:PassRole`, `codepipeline:CreatePipeline`, `codebuild:CreateProject, codepipeline:StartPipelineExecution`

ì½”ë“œ íŒŒì´í”„ë¼ì¸ì„ ìƒì„±í•  ë•Œ **ì‹¤í–‰í•  codepipeline IAM ì—­í• **ì„ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì´ë¥¼ í†µí•´ ê¶Œí•œì„ íƒˆì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì „ ê¶Œí•œ ì™¸ì—ë„ **ì½”ë“œê°€ ì €ì¥ëœ ìœ„ì¹˜ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œ**ì´ í•„ìš”í•©ë‹ˆë‹¤ (S3, ECR, github, bitbucket...)

ì›¹ í˜ì´ì§€ì—ì„œ ì´ ê³¼ì •ì„ í…ŒìŠ¤íŠ¸í–ˆìœ¼ë©°, ì´ì „ì— ì–¸ê¸‰í•œ ê¶Œí•œì€ ì½”ë“œ íŒŒì´í”„ë¼ì¸ì„ ìƒì„±í•˜ëŠ” ë° í•„ìš”í•œ List/Get ê¶Œí•œì´ ì•„ë‹ˆì§€ë§Œ, ì›¹ì—ì„œ ìƒì„±í•˜ë ¤ë©´ ë‹¤ìŒë„ í•„ìš”í•©ë‹ˆë‹¤: `codebuild:ListCuratedEnvironmentImages, codebuild:ListProjects, codebuild:ListRepositories, codecommit:ListRepositories, events:PutTargets, codepipeline:ListPipelines, events:PutRule, codepipeline:ListActionTypes, cloudtrail:<ì—¬ëŸ¬>`

**ë¹Œë“œ í”„ë¡œì íŠ¸ ìƒì„± ì¤‘**ì— **ì‹¤í–‰í•  ëª…ë ¹**(rev shell?)ì„ ì§€ì •í•˜ê³  ë¹Œë“œ ë‹¨ê³„ë¥¼ **íŠ¹ê¶Œ ì‚¬ìš©ì**ë¡œ ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ê³µê²©ìê°€ íƒˆì·¨í•˜ëŠ” ë° í•„ìš”í•œ êµ¬ì„±ì…ë‹ˆë‹¤:

![](<../../../.gitbook/assets/image (276).png>)

![](<../../../.gitbook/assets/image (181).png>)

### ?`codebuild:UpdateProject, codepipeline:UpdatePipeline, codepipeline:StartPipelineExecution`

ì´ì „ ê¶Œí•œìœ¼ë¡œ ì½”ë“œíŒŒì´í”„ë¼ì¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì—­í• ê³¼ ì‹¤í–‰ë˜ëŠ” ëª…ë ¹ì„ ìˆ˜ì •í•  ìˆ˜ ìˆì„ ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.

### `codepipeline:pollforjobs`

[AWSëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì–¸ê¸‰í•©ë‹ˆë‹¤](https://docs.aws.amazon.com/codepipeline/latest/APIReference/API\_PollForJobs.html):

> ì´ APIê°€ í˜¸ì¶œë˜ë©´, CodePipelineì€ **íŒŒì´í”„ë¼ì¸ì˜ ì•„í‹°íŒ©íŠ¸ë¥¼ ì €ì¥í•˜ëŠ” S3 ë²„í‚·ì— ëŒ€í•œ ì„ì‹œ ìê²© ì¦ëª…**ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì´ ì…ë ¥ ë˜ëŠ” ì¶œë ¥ ì•„í‹°íŒ©íŠ¸ì— ëŒ€í•´ í•´ë‹¹ S3 ë²„í‚·ì— ëŒ€í•œ ì ‘ê·¼ì„ ìš”êµ¬í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ì´ APIëŠ” ë˜í•œ **ì‘ì—…ì— ëŒ€í•´ ì •ì˜ëœ ëª¨ë“  ë¹„ë°€ ê°’**ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
