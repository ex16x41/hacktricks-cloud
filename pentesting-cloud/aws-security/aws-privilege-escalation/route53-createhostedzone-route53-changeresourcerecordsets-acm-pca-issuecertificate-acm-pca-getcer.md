# AWS - Route53 Privesc

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}

Route53ì— ëŒ€í•œ ë” ë§ì€ ì •ë³´ëŠ” ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../aws-services/aws-route53-enum.md" %}
[aws-route53-enum.md](../aws-services/aws-route53-enum.md)
{% endcontent-ref %}

### `route53:CreateHostedZone`, `route53:ChangeResourceRecordSets`, `acm-pca:IssueCertificate`, `acm-pca:GetCertificate`

{% hint style="info" %}
ì´ ê³µê²©ì„ ìˆ˜í–‰í•˜ë ¤ë©´ ëŒ€ìƒ ê³„ì •ì— ì´ë¯¸ [**AWS Certificate Manager Private Certificate Authority**](https://aws.amazon.com/certificate-manager/private-certificate-authority/) **(AWS-PCA)**ê°€ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•˜ë©°, VPCì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ëŠ” ì´ë¯¸ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì¸ì¦ì„œë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤. ì´ ì¸í”„ë¼ê°€ êµ¬ì¶•ë˜ë©´ AWS API íŠ¸ë˜í”½ì„ ê°€ë¡œì±„ê¸° ìœ„í•œ ë‹¤ìŒ ê³µê²©ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

ì—´ê±° ë¶€ë¶„ì— ëŒ€í•´ **ê¶Œì¥ë˜ì§€ë§Œ í•„ìˆ˜ëŠ” ì•„ë‹Œ** ë‹¤ë¥¸ ê¶Œí•œ: `route53:GetHostedZone`, `route53:ListHostedZones`, `acm-pca:ListCertificateAuthorities`, `ec2:DescribeVpcs`

AWS VPCì— ì—¬ëŸ¬ í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì„œë¡œ ë° AWS APIì™€ í†µì‹ í•˜ê³  ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ì˜ í†µì‹ ì€ ì¢…ì¢… TLSë¡œ ì•”í˜¸í™”ë˜ë¯€ë¡œ í•´ë‹¹ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ìœ íš¨í•œ ì¸ì¦ì„œë¥¼ ë°œê¸‰í•  ìˆ˜ ìˆëŠ” ê°œì¸ CAê°€ í•„ìš”í•©ë‹ˆë‹¤. **ACM-PCAê°€ ì‚¬ìš©ë˜ëŠ” ê²½ìš°** ì ëŒ€ìê°€ ìœ„ì— ì„¤ëª…ëœ ìµœì†Œ ê¶Œí•œ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ **route53ê³¼ acm-pca ê°œì¸ CAë¥¼ ëª¨ë‘ ì œì–´í•  ìˆ˜ ìˆëŠ” ì ‘ê·¼ ê¶Œí•œì„ ì–»ìœ¼ë©´**, **AWS APIì— ëŒ€í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ í˜¸ì¶œì„ ê°€ë¡œì±Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ê·¸ë“¤ì˜ IAM ê¶Œí•œì„ ì¥ì•…í•˜ê²Œ ë©ë‹ˆë‹¤.

ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ê°€ëŠ¥í•©ë‹ˆë‹¤:

* AWS SDKëŠ” [Certificate Pinning](https://www.digicert.com/blog/certificate-pinning-what-is-certificate-pinning)ì´ ì—†ìŠµë‹ˆë‹¤.
* Route53ì€ AWS API ë„ë©”ì¸ ì´ë¦„ì— ëŒ€í•œ ê°œì¸ í˜¸ìŠ¤íŒ… ì˜ì—­ ë° DNS ë ˆì½”ë“œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ACM-PCAì˜ ê°œì¸ CAëŠ” íŠ¹ì • ê³µí†µ ì´ë¦„ì— ëŒ€í•´ì„œë§Œ ì¸ì¦ì„œë¥¼ ì„œëª…í•˜ë„ë¡ ì œí•œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

**ì ì¬ì  ì˜í–¥:** íŠ¸ë˜í”½ì—ì„œ ë¯¼ê°í•œ ì •ë³´ë¥¼ ê°€ë¡œì±„ì–´ ê°„ì ‘ì ì¸ ê¶Œí•œ ìƒìŠ¹ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### Exploitation <a href="#discovery" id="discovery"></a>

ì›ë³¸ ì—°êµ¬ì—ì„œ ì·¨ì•½ì  ì´ìš© ë‹¨ê³„ë¥¼ ì°¾ìœ¼ì„¸ìš”: [**https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/**](https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
