# AWS - Route53 Privesc

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

Route53 hakkÄ±nda daha fazla bilgi iÃ§in kontrol edin:

{% content-ref url="../aws-services/aws-route53-enum.md" %}
[aws-route53-enum.md](../aws-services/aws-route53-enum.md)
{% endcontent-ref %}

### `route53:CreateHostedZone`, `route53:ChangeResourceRecordSets`, `acm-pca:IssueCertificate`, `acm-pca:GetCertificate`

{% hint style="info" %}
Bu saldÄ±rÄ±yÄ± gerÃ§ekleÅŸtirmek iÃ§in hedef hesabÄ±n zaten bir [**AWS Sertifika YÃ¶neticisi Ã–zel Sertifika Otoritesi**](https://aws.amazon.com/certificate-manager/private-certificate-authority/) **(AWS-PCA)** kurulumuna sahip olmasÄ± ve VPC'lerdeki EC2 Ã¶rneklerinin bu sertifikalarÄ± gÃ¼venilir hale getirmek iÃ§in iÃ§e aktarmÄ±ÅŸ olmasÄ± gerekir. Bu altyapÄ± mevcut olduÄŸunda, AWS API trafiÄŸini kesmek iÃ§in aÅŸaÄŸÄ±daki saldÄ±rÄ± gerÃ§ekleÅŸtirilebilir.
{% endhint %}

DiÄŸer izinler **enumeration** kÄ±smÄ± iÃ§in Ã¶nerilir ancak zorunlu deÄŸildir: `route53:GetHostedZone`, `route53:ListHostedZones`, `acm-pca:ListCertificateAuthorities`, `ec2:DescribeVpcs`

Birden fazla bulut yerel uygulamanÄ±n birbirleriyle ve AWS API ile iletiÅŸim kurduÄŸu bir AWS VPC'sinin olduÄŸunu varsayalÄ±m. Mikro hizmetler arasÄ±ndaki iletiÅŸim genellikle TLS ile ÅŸifreli olduÄŸundan, bu hizmetler iÃ§in geÃ§erli sertifikalarÄ± vermek Ã¼zere bir Ã¶zel CA'ya ihtiyaÃ§ vardÄ±r. **Bunun iÃ§in ACM-PCA kullanÄ±lÄ±yorsa** ve dÃ¼ÅŸman **yukarÄ±da tanÄ±mlanan minimum izin seti ile hem route53 hem de acm-pca Ã¶zel CA'sÄ±nÄ± kontrol etme eriÅŸimini elde ederse**, AWS API'ye yapÄ±lan uygulama Ã§aÄŸrÄ±larÄ±nÄ± **ele geÃ§irebilir** ve IAM izinlerini devralabilir.

Bu mÃ¼mkÃ¼ndÃ¼r Ã§Ã¼nkÃ¼:

* AWS SDK'larÄ± [Sertifika Pinleme](https://www.digicert.com/blog/certificate-pinning-what-is-certificate-pinning) Ã¶zelliÄŸine sahip deÄŸildir
* Route53, AWS API alan adlarÄ± iÃ§in Ã–zel BarÄ±ndÄ±rÄ±lan Alan ve DNS kayÄ±tlarÄ± oluÅŸturulmasÄ±na izin verir
* ACM-PCA'daki Ã–zel CA, yalnÄ±zca belirli Ortak Ä°simler iÃ§in sertifika imzalamakla kÄ±sÄ±tlanamaz

**OlasÄ± Etki:** Trafikteki hassas bilgileri keserek dolaylÄ± privesc.

#### Exploitation <a href="#discovery" id="discovery"></a>

SÃ¶mÃ¼rÃ¼ adÄ±mlarÄ±nÄ± orijinal araÅŸtÄ±rmada bulun: [**https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/**](https://niebardzo.github.io/2022-03-11-aws-hijacking-route53/)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
