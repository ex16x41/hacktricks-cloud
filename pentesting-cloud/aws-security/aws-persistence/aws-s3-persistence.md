# AWS - S3 Persistence

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** π’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## S3

λ” λ§μ€ μ •λ³΄λ” λ‹¤μμ„ ν™•μΈν•μ„Έμ”:

{% content-ref url="../aws-services/aws-s3-athena-and-glacier-enum.md" %}
[aws-s3-athena-and-glacier-enum.md](../aws-services/aws-s3-athena-and-glacier-enum.md)
{% endcontent-ref %}

### KMS Client-Side Encryption

μ•”νΈν™” κ³Όμ •μ΄ μ™„λ£λλ©΄ μ‚¬μ©μλ” KMS APIλ¥Ό μ‚¬μ©ν•μ—¬ μƒ ν‚¤λ¥Ό μƒμ„±ν•κ³  (`aws kms generate-data-key`) **μƒμ„±λ μ•”νΈν™”λ ν‚¤λ¥Ό νμΌμ λ©”νƒ€λ°μ΄ν„°μ— μ €μ¥**ν•©λ‹λ‹¤ ([python code example](https://aioboto3.readthedocs.io/en/latest/cse.html#how-it-works-kms-managed-keys)). λ”°λΌμ„ λ³µνΈν™”κ°€ λ°μƒν•  λ• KMSλ¥Ό λ‹¤μ‹ μ‚¬μ©ν•μ—¬ λ³µνΈν™”ν•  μ μμµλ‹λ‹¤:

<figure><img src="../../../.gitbook/assets/image (226).png" alt=""><figcaption></figcaption></figure>

λ”°λΌμ„ κ³µκ²©μλ” λ©”νƒ€λ°μ΄ν„°μ—μ„ μ΄ ν‚¤λ¥Ό κ°€μ Έμ™€ KMS (`aws kms decrypt`)λ΅ λ³µνΈν™”ν•μ—¬ μ •λ³΄λ¥Ό μ•”νΈν™”ν•λ” λ° μ‚¬μ©λ ν‚¤λ¥Ό μ–»μ„ μ μμµλ‹λ‹¤. μ΄ λ°©λ²•μΌλ΅ κ³µκ²©μλ” μ•”νΈν™” ν‚¤λ¥Ό κ°€μ§€κ² λλ©°, κ·Έ ν‚¤κ°€ λ‹¤λ¥Έ νμΌμ„ μ•”νΈν™”ν•λ” λ° μ¬μ‚¬μ©λλ©΄ μ΄λ¥Ό μ‚¬μ©ν•  μ μκ² λ©λ‹λ‹¤.

### Using S3 ACLs

λ³΄ν†µ λ²„ν‚·μ ACLμ€ λΉ„ν™μ„±ν™”λμ–΄ μμ§€λ§, μ¶©λ¶„ν• κ¶ν•μ„ κ°€μ§„ κ³µκ²©μλ” μ΄λ¥Ό μ•…μ©ν•  μ μμµλ‹λ‹¤ (ν™μ„±ν™”λ κ²½μ° λλ” κ³µκ²©μκ°€ μ΄λ¥Ό ν™μ„±ν™”ν•  μ μλ” κ²½μ°) S3 λ²„ν‚·μ— λ€ν• μ ‘κ·Όμ„ μ μ§€ν•κΈ° μ„ν•΄.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** π’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
