# AWS - Firewall Manager Enum

{% hint style="success" %}
Nau캜ite i ve쬭ajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Nau캜ite i ve쬭ajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Firewall Manager

**AWS Firewall Manager** pojednostavljuje upravljanje i odr쬬vanje **AWS WAF, AWS Shield Advanced, Amazon VPC sigurnosnih grupa i mre쬹ih kontrolnih lista pristupa (ACL-ova), i AWS Network Firewall, AWS Route 53 Resolver DNS Firewall i firewall-ova tre캖ih strana** preko vi코e naloga i resursa. Omogu캖ava vam da konfiguri코ete pravila za firewall, Shield Advanced za코tite, VPC sigurnosne grupe i Network Firewall postavke samo jednom, sa servisom koji **automatski primenjuje ova pravila i za코tite preko va코ih naloga i resursa**, uklju캜uju캖i i novododate.

Servis nudi mogu캖nost da **grupi코ete i za코titite specifi캜ne resurse zajedno**, kao 코to su oni koji dele zajedni캜ku oznaku ili sve va코e CloudFront distribucije. Zna캜ajna prednost Firewall Manager-a je njegova sposobnost da **automatski pro코iri za코titu na novododate resurse** u va코em nalogu.

**Grupa pravila** (kolekcija WAF pravila) mo쬰 biti uklju캜ena u AWS Firewall Manager Policy, koji je zatim povezan sa specifi캜nim AWS resursima kao 코to su CloudFront distribucije ili aplikacioni load balanceri.

AWS Firewall Manager pru쬬 **upravljane liste aplikacija i protokola** kako bi se pojednostavila konfiguracija i upravljanje politikama sigurnosnih grupa. Ove liste vam omogu캖avaju da defini코ete protokole i aplikacije koje va코e politike dozvoljavaju ili odbijaju. Postoje dve vrste upravljanih lista:

* **Firewall Manager upravljane liste**: Ove liste uklju캜uju **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** i **FMS-Default-Protocols-Allowed**. Njima upravlja Firewall Manager i uklju캜uju uobi캜ajeno kori코캖ene aplikacije i protokole koje bi trebalo dozvoliti ili odbiti javnosti. Nije mogu캖e ure캠ivati ili brisati ih, me캠utim, mo쬰te izabrati njihovu verziju.
* **Prilago캠ene upravljane liste**: Ove liste upravljate sami. Mo쬰te kreirati prilago캠ene liste aplikacija i protokola prilago캠ene potrebama va코e organizacije. Za razliku od Firewall Manager upravljanih lista, ove liste nemaju verzije, ali imate potpunu kontrolu nad prilago캠enim listama, omogu캖avaju캖i vam da ih kreirate, ure캠ujete i bri코ete po potrebi.

Va쬹o je napomenuti da **Firewall Manager politike dozvoljavaju samo "Block" ili "Count" akcije** za grupu pravila, bez opcije "Allow".

### Preduslovi

Slede캖i preduslovi moraju biti ispunjeni pre nego 코to nastavite sa konfiguracijom Firewall Manager-a kako biste efikasno za코titili resurse va코e organizacije. Ovi koraci pru쬬ju osnovnu postavku potrebnu za Firewall Manager da primenjuje sigurnosne politike i osigura uskla캠enost u va코em AWS okru쬰nju:

1. **Pridru쬴te se i konfiguri코ite AWS Organizations:** Osigurajte da je va코 AWS nalog deo AWS Organizations organizacije gde se planiraju primeniti AWS Firewall Manager politike. Ovo omogu캖ava centralizovano upravljanje resursima i politikama preko vi코e AWS naloga unutar organizacije.
2. **Kreirajte AWS Firewall Manager Default Administrator Account:** Uspostavite podrazumevani administratorski nalog specifi캜no za upravljanje Firewall Manager sigurnosnim politikama. Ovaj nalog 캖e biti odgovoran za konfiguraciju i primenu sigurnosnih politika preko organizacije. Samo upravlja캜ki nalog organizacije mo쬰 kreirati Firewall Manager podrazumevane administratorske naloge.
3. **Omogu캖ite AWS Config:** Aktivirajte AWS Config kako biste pru쬴li Firewall Manager-u potrebne podatke o konfiguraciji i uvide potrebne za efikasno sprovo캠enje sigurnosnih politika. AWS Config poma쬰 u analizi, reviziji, pra캖enju i reviziji konfiguracija resursa i promena, olak코avaju캖i bolje upravljanje sigurno코캖u.
4. **Za politike tre캖ih strana, pretplatite se na AWS Marketplace i konfiguri코ite postavke tre캖ih strana:** Ako planirate da koristite firewall politike tre캖ih strana, pretplatite se na njih u AWS Marketplace i konfiguri코ite potrebne postavke. Ovaj korak osigurava da Firewall Manager mo쬰 integrisati i primeniti politike od pouzdanih dobavlja캜a tre캖ih strana.
5. **Za Network Firewall i DNS Firewall politike, omogu캖ite deljenje resursa:** Omogu캖ite deljenje resursa specifi캜no za Network Firewall i DNS Firewall politike. Ovo omogu캖ava Firewall Manager-u da primeni firewall za코tite na VPC-ove i DNS rezoluciju va코e organizacije, pobolj코avaju캖i mre쬹u sigurnost.
6. **Za kori코캖enje AWS Firewall Manager-a u regionima koji su podrazumevano onemogu캖eni:** Ako nameravate da koristite Firewall Manager u AWS regionima koji su podrazumevano onemogu캖eni, osigurajte da preduzmete potrebne korake da omogu캖ite njegovu funkcionalnost u tim regionima. Ovo osigurava dosledno sprovo캠enje sigurnosti u svim regionima gde va코a organizacija posluje.

Za vi코e informacija, pogledajte:[Getting started with AWS Firewall Manager AWS WAF policies](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Tipovi politika za코tite

AWS Firewall Manager upravlja sa nekoliko tipova politika kako bi sproveo sigurnosne kontrole preko razli캜itih aspekata infrastrukture va코e organizacije:

1. **AWS WAF Policy:** Ovaj tip politike podr쬬va i AWS WAF i AWS WAF Classic. Mo쬰te definisati koji resursi su za코ti캖eni politikom. Za AWS WAF politike, mo쬰te specificirati setove grupa pravila koje 캖e se pokrenuti prve i poslednje u web ACL-u. Pored toga, vlasnici naloga mogu dodati pravila i grupe pravila koje 캖e se pokrenuti izme캠u ovih setova.
2. **Shield Advanced Policy:** Ova politika primenjuje Shield Advanced za코tite preko va코e organizacije za specificirane tipove resursa. Poma쬰 u za코titi od DDoS napada i drugih pretnji.
3. **Amazon VPC Security Group Policy:** Sa ovom politikom, mo쬰te upravljati sigurnosnim grupama koje se koriste 코irom va코e organizacije, primenjuju캖i osnovni set pravila preko va코eg AWS okru쬰nja za kontrolu mre쬹og pristupa.
4. **Amazon VPC Network Access Control List (ACL) Policy:** Ovaj tip politike vam daje kontrolu nad mre쬹im ACL-ovima koji se koriste u va코oj organizaciji, omogu캖avaju캖i vam da primenite osnovni set mre쬹ih ACL-ova preko va코eg AWS okru쬰nja.
5. **Network Firewall Policy:** Ova politika primenjuje AWS Network Firewall za코titu na VPC-ove va코e organizacije, pobolj코avaju캖i mre쬹u sigurnost filtriranjem saobra캖aja na osnovu unapred definisanih pravila.
6. **Amazon Route 53 Resolver DNS Firewall Policy:** Ova politika primenjuje DNS Firewall za코tite na VPC-ove va코e organizacije, poma쬿캖i u blokiranju zlonamernih poku코aja rezolucije domena i sprovo캠enju sigurnosnih politika za DNS saobra캖aj.
7. **Third-Party Firewall Policy:** Ovaj tip politike primenjuje za코tite od firewall-ova tre캖ih strana, koje su dostupne putem pretplate kroz AWS Marketplace konzolu. Omogu캖ava vam da integri코ete dodatne sigurnosne mere od pouzdanih dobavlja캜a u va코e AWS okru쬰nje.
1. **Palo Alto Networks Cloud NGFW Policy:** Ova politika primenjuje Palo Alto Networks Cloud Next Generation Firewall (NGFW) za코tite i rulestacks na VPC-ove va코e organizacije, pru쬬ju캖i naprednu prevenciju pretnji i sigurnosne kontrole na nivou aplikacija.
2. **Fortigate Cloud Native Firewall (CNF) as a Service Policy:** Ova politika primenjuje Fortigate Cloud Native Firewall (CNF) as a Service za코tite, nude캖i vode캖u industrijsku prevenciju pretnji, web application firewall (WAF) i API za코titu prilago캠enu za cloud infrastrukture.

### Administratorski nalozi

AWS Firewall Manager nudi fleksibilnost u upravljanju firewall resursima unutar va코e organizacije kroz svoj administrativni opseg i dve vrste administratorskih naloga.

**Administrativni opseg defini코e resurse kojima administrator Firewall Manager-a mo쬰 upravljati**. Nakon 코to AWS Organizations upravlja캜ki nalog uvede organizaciju u Firewall Manager, mo쬰 kreirati dodatne administratore sa razli캜itim administrativnim opsezima. Ovi opsezi mogu uklju캜ivati:

- Nalozi ili organizacione jedinice (OUs) na koje administrator mo쬰 primeniti politike.
- Regioni gde administrator mo쬰 obavljati akcije.
- Tipovi politika Firewall Manager-a kojima administrator mo쬰 upravljati.

Administrativni opseg mo쬰 biti ili **pun ili ograni캜en**. Pun opseg daje administratoru pristup **svim specificiranim tipovima resursa, regionima i tipovima politika**. Nasuprot tome, **ograni캜en opseg pru쬬 administrativnu dozvolu samo za podskup resursa, regiona ili tipova politika**. Preporu캜ljivo je da se administratorima dodeljuju samo dozvole koje su im potrebne za efikasno obavljanje svojih uloga. Mo쬰te primeniti bilo koju kombinaciju ovih uslova administrativnog opsega na administratora, osiguravaju캖i pridr쬬vanje principa najmanjih privilegija.

Postoje dve razli캜ite vrste administratorskih naloga, od kojih svaki slu쬴 specifi캜nim ulogama i odgovornostima:

- **Podrazumevani administrator:**
- Podrazumevani administratorski nalog kreira AWS Organizations upravlja캜ki nalog organizacije tokom procesa uvo캠enja u Firewall Manager.
- Ovaj nalog ima sposobnost da upravlja firewall-ovima tre캖ih strana i poseduje pun administrativni opseg.
- Slu쬴 kao primarni administratorski nalog za Firewall Manager, odgovoran za konfiguraciju i sprovo캠enje sigurnosnih politika preko organizacije.
- Dok podrazumevani administrator ima pun pristup svim tipovima resursa i administrativnim funkcionalnostima, on funkcioni코e na istom nivou kao i drugi administratori ako se koristi vi코e administratora unutar organizacije.
- **Firewall Manager administratori:**
- Ovi administratori mogu upravljati resursima unutar opsega koji je definisao AWS Organizations upravlja캜ki nalog, kako je definisano konfiguracijom administrativnog opsega.
- Firewall Manager administratori su kreirani da ispunjavaju specifi캜ne uloge unutar organizacije, omogu캖avaju캖i delegiranje odgovornosti dok se odr쬬vaju sigurnosni i uskla캠enost standardi.
- Prilikom kreiranja, Firewall Manager proverava sa AWS Organizations da li je nalog ve캖 delegirani administrator. Ako nije, Firewall Manager poziva Organizations da odredi nalog kao delegiranog administratora za Firewall Manager.

Upravljanje ovim administratorskim nalozima uklju캜uje njihovo kreiranje unutar Firewall Manager-a i definisanje njihovih administrativnih opsega u skladu sa sigurnosnim zahtevima organizacije i principom najmanjih privilegija. Dodeljivanjem odgovaraju캖ih administrativnih uloga, organizacije mogu osigurati efikasno upravljanje sigurno코캖u dok odr쬬vaju granularnu kontrolu nad pristupom osetljivim resursima.

Va쬹o je naglasiti da **samo jedan nalog unutar organizacije mo쬰 slu쬴ti kao podrazumevani administrator Firewall Manager-a**, pridr쬬vaju캖i se principa "**prvi unutra, poslednji napolje**". Da bi se odredio novi podrazumevani administrator, mora se slediti niz koraka:

- Prvo, svaki Firewall Administrator administratorski nalog mora opozvati svoj nalog.
- Zatim, postoje캖i podrazumevani administrator mo쬰 opozvati svoj nalog, efektivno isklju캜uju캖i organizaciju iz Firewall Manager-a. Ovaj proces rezultira brisanjem svih Firewall Manager politika koje je kreirao opozvani nalog.
- Na kraju, AWS Organizations upravlja캜ki nalog mora odrediti podrazumevanog administratora Firewall Manager-a.

## Enumeracija
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Exploitation / Bypass Detection

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)
Napada캜 sa **`fms:AssociateAdminAccount`** dozvolom bi mogao da postavi podrazumevani administratorski nalog za Firewall Manager. Sa **`fms:PutAdminAccount`** dozvolom, napada캜 bi mogao da kreira ili a쬿rira administratorski nalog za Firewall Manager, a sa **`fms:DisassociateAdminAccount`** dozvolom, potencijalni napada캜 bi mogao da ukloni trenutnu asocijaciju administratorskog naloga za Firewall Manager.

- Disasocijacija **podrazumevanog administratorskog naloga za Firewall Manager prati politiku prvi-u-poslednji-izlazi**. Svi administratori Firewall Manager-a moraju se disasocirati pre nego 코to podrazumevani administrator Firewall Manager-a mo쬰 disasocirati nalog.
- Da bi se kreirao administratorski nalog za Firewall Manager pomo캖u **PutAdminAccount**, nalog mora pripadati organizaciji koja je prethodno uklju캜ena u Firewall Manager koriste캖i **AssociateAdminAccount**.
- Kreiranje administratorskog naloga za Firewall Manager mo쬰 se izvr코iti samo od strane upravlja캜kog naloga organizacije.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potencijalni uticaj:** Gubitak centralizovanog upravljanja, izbegavanje politika, kr코enje uskla캠enosti i poreme캖aj sigurnosnih kontrola unutar okru쬰nja.

### `fms:PutPolicy`, `fms:DeletePolicy`

Napada캜 sa **`fms:PutPolicy`**, **`fms:DeletePolicy`** dozvolama bi mogao da kreira, modifikuje ili trajno obri코e AWS Firewall Manager politiku.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
```markdown
Primer permisivne politike kroz permisivnu security group, kako bi se zaobi코la detekcija, mo쬰 biti slede캖i:
```
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potencijalni uticaj:** Demonta쬬 sigurnosnih kontrola, izbegavanje politika, kr코enje uskla캠enosti, operativni poreme캖aji i potencijalni curenje podataka unutar okru쬰nja.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Napada캜 sa **`fms:BatchAssociateResource`** i **`fms:BatchDisassociateResource`** dozvolama bi mogao da pove쬰 ili odvoji resurse iz skupa resursa Firewall Manager-a. Pored toga, **`fms:PutResourceSet`** i **`fms:DeleteResourceSet`** dozvole bi omogu캖ile napada캜u da kreira, modifikuje ili bri코e ove skupove resursa iz AWS Firewall Manager-a.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potencijalni Uticaj:** Dodavanje nepotrebne koli캜ine stavki u skup resursa 캖e pove캖ati nivo 코uma u Servisu, potencijalno uzrokuju캖i DoS. Pored toga, promene u skupovima resursa mogu dovesti do prekida resursa, izbegavanja politika, kr코enja uskla캠enosti i prekida sigurnosnih kontrola unutar okru쬰nja.

### `fms:PutAppsList`, `fms:DeleteAppsList`

Napada캜 sa **`fms:PutAppsList`** i **`fms:DeleteAppsList`** dozvolama bi mogao da kreira, modifikuje ili bri코e liste aplikacija iz AWS Firewall Manager-a. Ovo mo쬰 biti kriti캜no, jer neovla코캖ene aplikacije mogu dobiti pristup javnosti, ili pristup ovla코캖enim aplikacijama mo쬰 biti odbijen, uzrokuju캖i DoS.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potencijalni uticaj:** Ovo bi moglo rezultirati pogre코nim konfiguracijama, izbegavanjem politika, kr코enjem uskla캠enosti i ometanjem bezbednosnih kontrola unutar okru쬰nja.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

Napada캜 sa **`fms:PutProtocolsList`** i **`fms:DeleteProtocolsList`** dozvolama bi mogao da kreira, modifikuje ili bri코e liste protokola iz AWS Firewall Manager-a. Sli캜no kao sa listama aplikacija, ovo bi moglo biti kriti캜no jer bi neovla코캖eni protokoli mogli biti kori코캖eni od strane 코ire javnosti, ili bi upotreba ovla코캖enih protokola mogla biti onemogu캖ena, uzrokuju캖i DoS.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Potencijalni uticaj:** Ovo mo쬰 rezultirati pogre코nim konfiguracijama, izbegavanjem politika, kr코enjem uskla캠enosti i ometanjem bezbednosnih kontrola unutar okru쬰nja.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

Napada캜 sa dozvolama **`fms:PutNotificationChannel`** i **`fms:DeleteNotificationChannel`** mogao bi da obri코e i odredi IAM ulogu i Amazon Simple Notification Service (SNS) temu koju Firewall Manager koristi za bele쬰nje SNS logova.

Da biste koristili **`fms:PutNotificationChannel`** van konzole, potrebno je da postavite pristupnu politiku za SNS temu, omogu캖avaju캖i navedenom **SnsRoleName** da objavljuje SNS logove. Ako je navedeni **SnsRoleName** uloga druga캜ija od **`AWSServiceRoleForFMS`**, potrebna je konfiguracija poverenja koja omogu캖ava Firewall Manager servisnom principu **fms.amazonaws.com** da preuzme ovu ulogu.

Za informacije o konfigurisanju pristupne politike za SNS:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potencijalni uticaj:** Ovo bi potencijalno moglo dovesti do propu코tanja bezbednosnih upozorenja, odlo쬰nog odgovora na incidente, potencijalnih curenja podataka i operativnih poreme캖aja unutar okru쬰nja.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`
Napada캜 sa **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** dozvolama bi mogao da pove쬰 ili razdvoji firewall-ove tre캖ih strana od centralnog upravljanja putem AWS Firewall Manager-a.
{% hint style="warning" %}
Samo podrazumevani administrator mo쬰 kreirati i upravljati firewall-ovima tre캖ih strana.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potencijalni uticaj:** Disasocijacija bi dovela do izbegavanja politike, kr코enja uskla캠enosti i naru코avanja bezbednosnih kontrola unutar okru쬰nja. Asocijacija, s druge strane, bi dovela do poreme캖aja tro코kova i raspodele bud쬰ta.

### `fms:TagResource`, `fms:UntagResource`

Napada캜 bi mogao da doda, izmeni ili ukloni oznake sa Firewall Manager resursa, naru코avaju캖i raspodelu tro코kova, pra캖enje resursa i politike kontrole pristupa zasnovane na oznakama va코e organizacije.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potencijalni uticaj**: Prekid raspodele tro코kova, pra캖enja resursa i politika kontrole pristupa zasnovanih na oznakama.

## Reference

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

{% hint style="success" %}
Nau캜ite i ve쬭ajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Nau캜ite i ve쬭ajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hacking trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
