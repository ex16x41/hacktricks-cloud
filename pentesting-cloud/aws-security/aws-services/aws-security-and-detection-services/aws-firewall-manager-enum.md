# AWS - Firewall Manager Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Firewall Manager

**AWS Firewall Manager** pojednostavljuje upravljanje i odr쬬vanje **AWS WAF, AWS Shield Advanced, Amazon VPC sigurnosnih grupa i mre쬹ih kontrolnih lista (ACL), kao i AWS Network Firewall, AWS Route 53 Resolver DNS Firewall i vatrozida tre캖ih strana** 코irom vi코e naloga i resursa. Omogu캖ava vam da konfiguri코ete pravila vatrozida, Shield Advanced za코tite, VPC sigurnosne grupe i postavke mre쬹og vatrozida samo jednom, uz to 코to **usluga automatski sprovodi ova pravila i za코tite 코irom va코ih naloga i resursa**, uklju캜uju캖i novododate.

Usluga nudi mogu캖nost da **grupisete i za코titite specifi캜ne resurse zajedno**, kao 코to su oni koji dele zajedni캜ku oznaku ili sve va코e CloudFront distribucije. Zna캜ajna prednost Firewall Manager-a je njegova sposobnost da **automatski pro코iri za코titu na novododate resurse** u va코em nalogu.

**Grupa pravila** (kolekcija WAF pravila) mo쬰 biti uklju캜ena u AWS Firewall Manager politiku, koja je zatim povezana sa specifi캜nim AWS resursima kao 코to su CloudFront distribucije ili aplikacijski balansatori optere캖enja.

AWS Firewall Manager pru쬬 **upravljane liste aplikacija i protokola** kako bi pojednostavio konfiguraciju i upravljanje politikama sigurnosnih grupa. Ove liste vam omogu캖avaju da defini코ete protokole i aplikacije koje su dozvoljene ili zabranjene va코im politikama. Postoje dve vrste upravljanih lista:

* **Upravljane liste Firewall Manager-a**: Ove liste uklju캜uju **FMS-Default-Public-Access-Apps-Allowed**, **FMS-Default-Protocols-Allowed** i **FMS-Default-Protocols-Allowed**. Njima upravlja Firewall Manager i uklju캜uju 캜esto kori코캖ene aplikacije i protokole koji bi trebali biti dozvoljeni ili zabranjeni 코iroj javnosti. Nije mogu캖e ure캠ivati ili brisati ove liste, me캠utim, mo쬰te odabrati njihovu verziju.
* **Prilago캠ene upravljane liste**: Ove liste upravljate sami. Mo쬰te kreirati prilago캠ene liste aplikacija i protokola prilago캠ene potrebama va코e organizacije. Za razliku od upravljanih lista Firewall Manager-a, ove liste nemaju verzije, ali imate potpunu kontrolu nad prilago캠enim listama, 코to vam omogu캖ava da ih kreirate, ure캠ujete i bri코ete prema potrebi.

Va쬹o je napomenuti da **Firewall Manager politike dozvoljavaju samo "Block" ili "Count" akcije** za grupu pravila, bez opcije "Allow".

### Prerequisites

Slede캖i koraci preduslova moraju biti zavr코eni pre nego 코to nastavite sa konfigurisanjem Firewall Manager-a kako biste efikasno za코titili resurse va코e organizacije. Ovi koraci pru쬬ju osnovnu postavku potrebnu za Firewall Manager da sprovodi sigurnosne politike i osigura uskla캠enost 코irom va코eg AWS okru쬰nja:

1. **Pridru쬴te se i konfiguri코ite AWS Organizations:** Osigurajte da je va코 AWS nalog deo AWS Organizations organizacije u kojoj su planirane AWS Firewall Manager politike. Ovo omogu캖ava centralizovano upravljanje resursima i politikama 코irom vi코e AWS naloga unutar organizacije.
2. **Kreirajte AWS Firewall Manager Default Administrator Account:** Uspostavite podrazumevani administratorski nalog posebno za upravljanje Firewall Manager sigurnosnim politikama. Ovaj nalog 캖e biti odgovoran za konfiguraciju i sprovo캠enje sigurnosnih politika 코irom organizacije. Samo upravlja캜ki nalog organizacije mo쬰 kreirati podrazumevane administratorske naloge Firewall Manager-a.
3. **Omogu캖ite AWS Config:** Aktivirajte AWS Config kako biste obezbedili Firewall Manager-u potrebne podatke o konfiguraciji i uvide potrebne za efikasno sprovo캠enje sigurnosnih politika. AWS Config poma쬰 u analizi, reviziji, pra캖enju i reviziji konfiguracija resursa i promena, olak코avaju캖i bolje upravljanje sigurno코캖u.
4. **Za politike tre캖ih strana, pretplatite se u AWS Marketplace i konfiguri코ite postavke tre캖ih strana:** Ako planirate da koristite politike vatrozida tre캖ih strana, pretplatite se na njih u AWS Marketplace-u i konfiguri코ite potrebne postavke. Ovaj korak osigurava da Firewall Manager mo쬰 integrisati i sprovoditi politike od pouzdanih dobavlja캜a tre캖ih strana.
5. **Za politike mre쬹og vatrozida i DNS vatrozida, omogu캖ite deljenje resursa:** Omogu캖ite deljenje resursa posebno za politike mre쬹og vatrozida i DNS vatrozida. Ovo omogu캖ava Firewall Manager-u da primeni za코titu vatrozida na VPC-ove i DNS rezoluciju va코e organizacije, pobolj코avaju캖i mre쬹u sigurnost.
6. **Da biste koristili AWS Firewall Manager u regionima koji su podrazumevano onemogu캖eni:** Ako nameravate da koristite Firewall Manager u AWS regionima koji su podrazumevano onemogu캖eni, osigurajte da preduzmete potrebne korake da omogu캖ite njegovu funkcionalnost u tim regionima. Ovo osigurava dosledno sprovo캠enje sigurnosti 코irom svih regiona u kojima va코a organizacija posluje.

Za vi코e informacija, pogledajte: [Getting started with AWS Firewall Manager AWS WAF policies](https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms.html).

### Types of protection policies

AWS Firewall Manager upravlja nekoliko vrsta politika za sprovo캠enje sigurnosnih kontrola 코irom razli캜itih aspekata infrastrukture va코e organizacije:

1. **AWS WAF Policy:** Ova vrsta politike podr쬬va i AWS WAF i AWS WAF Classic. Mo쬰te definisati koji resursi su za코ti캖eni politikom. Za AWS WAF politike, mo쬰te odrediti skupove grupa pravila koje 캖e se izvr코avati prve i poslednje u web ACL-u. Pored toga, vlasnici naloga mogu dodavati pravila i grupe pravila koja 캖e se izvr코avati izme캠u ovih skupova.
2. **Shield Advanced Policy:** Ova politika primenjuje Shield Advanced za코tite 코irom va코e organizacije za odre캠ene tipove resursa. Poma쬰 u za코titi od DDoS napada i drugih pretnji.
3. **Amazon VPC Security Group Policy:** Sa ovom politikom, mo쬰te upravljati sigurnosnim grupama koje se koriste 코irom va코e organizacije, sprovode캖i osnovni set pravila 코irom va코eg AWS okru쬰nja kako biste kontrolisali mre쬹i pristup.
4. **Amazon VPC Network Access Control List (ACL) Policy:** Ova vrsta politike daje vam kontrolu nad mre쬹im ACL-ima koji se koriste u va코oj organizaciji, omogu캖avaju캖i vam da sprovodite osnovni set mre쬹ih ACL-a 코irom va코eg AWS okru쬰nja.
5. **Network Firewall Policy:** Ova politika primenjuje AWS Network Firewall za코titu na VPC-ove va코e organizacije, pobolj코avaju캖i mre쬹u sigurnost filtriranjem saobra캖aja na osnovu unapred definisanih pravila.
6. **Amazon Route 53 Resolver DNS Firewall Policy:** Ova politika primenjuje DNS Firewall za코tite na VPC-ove va코e organizacije, poma쬿캖i u blokiranju poku코aja zlonamerne rezolucije domena i sprovo캠enju sigurnosnih politika za DNS saobra캖aj.
7. **Third-Party Firewall Policy:** Ova vrsta politike primenjuje za코tite iz vatrozida tre캖ih strana, koje su dostupne putem pretplate kroz AWS Marketplace konzolu. Omogu캖ava vam da integri코ete dodatne sigurnosne mere od pouzdanih dobavlja캜a u va코e AWS okru쬰nje.
1. **Palo Alto Networks Cloud NGFW Policy:** Ova politika primenjuje za코tite i pravila Palo Alto Networks Cloud Next Generation Firewall (NGFW) na VPC-ove va코e organizacije, pru쬬ju캖i naprednu prevenciju pretnji i kontrole sigurnosti na nivou aplikacija.
2. **Fortigate Cloud Native Firewall (CNF) as a Service Policy:** Ova politika primenjuje za코tite Fortigate Cloud Native Firewall (CNF) kao uslugu, nude캖i vode캖u prevenciju pretnji, vatrozid za web aplikacije (WAF) i za코titu API-ja prilago캠enu za cloud infrastrukture.

### Administrator accounts

AWS Firewall Manager nudi fleksibilnost u upravljanju resursima vatrozida unutar va코e organizacije kroz svoj administrativni opseg i dva tipa administratorskih naloga.

**Administrativni opseg defini코e resurse kojima administrator Firewall Manager-a mo쬰 upravljati**. Nakon 코to AWS Organizations upravlja캜ki nalog uklju캜i organizaciju u Firewall Manager, mo쬰 kreirati dodatne administratore sa razli캜itim administrativnim opsezima. Ovi opsezi mogu uklju캜ivati:

* Nalozi ili organizacione jedinice (OU) na koje administrator mo쬰 primeniti politike.
* Regioni u kojima administrator mo쬰 izvr코avati akcije.
* Tipovi politika Firewall Manager-a kojima administrator mo쬰 upravljati.

Administrativni opseg mo쬰 biti **potpun ili ograni캜en**. Potpuni opseg daje administratoru pristup **svim navedenim tipovima resursa, regionima i tipovima politika**. Nasuprot tome, **ograni캜eni opseg pru쬬 administrativna prava samo na podskup resursa, regiona ili tipova politika**. Preporu캜uje se da se administratorima dodele samo prava koja su im potrebna da efikasno obavljaju svoje uloge. Mo쬰te primeniti bilo koju kombinaciju ovih uslova administrativnog opsega na administratora, osiguravaju캖i pridr쬬vanje principa minimalnih privilegija.

Postoje dva razli캜ita tipa administratorskih naloga, svaki sa specifi캜nim ulogama i odgovornostima:

* **Default Administrator:**
* Podrazumevani administratorski nalog kreira upravlja캜ki nalog AWS Organizations organizacije tokom procesa uklju캜ivanja u Firewall Manager.
* Ovaj nalog ima sposobnost da upravlja vatrozidima tre캖ih strana i poseduje potpuni administrativni opseg.
* Slu쬴 kao primarni administratorski nalog za Firewall Manager, odgovoran za konfiguraciju i sprovo캠enje sigurnosnih politika 코irom organizacije.
* Dok podrazumevani administrator ima potpuni pristup svim tipovima resursa i administrativnim funkcionalnostima, deluje na istom nivou kao i drugi administratori ako se vi코e administratora koristi unutar organizacije.
* **Firewall Manager Administrators:**
* Ovi administratori mogu upravljati resursima unutar opsega koji je odredio upravlja캜ki nalog AWS Organizations, kako je definisano konfiguracijom administrativnog opsega.
* Administratori Firewall Manager-a se kreiraju kako bi ispunili specifi캜ne uloge unutar organizacije, omogu캖avaju캖i delegaciju odgovornosti dok se odr쬬vaju standardi sigurnosti i uskla캠enosti.
* Prilikom kreiranja, Firewall Manager proverava sa AWS Organizations da li je nalog ve캖 delegirani administrator. Ako nije, Firewall Manager poziva Organizations da odredi nalog kao delegiranog administratora za Firewall Manager.

Upravljanje ovim administratorskim nalozima uklju캜uje njihovo kreiranje unutar Firewall Manager-a i definisanje njihovih administrativnih opsega u skladu sa sigurnosnim zahtevima organizacije i principom minimalnih privilegija. Dodeljivanjem odgovaraju캖ih administrativnih uloga, organizacije mogu osigurati efikasno upravljanje sigurno코캖u dok odr쬬vaju granularnu kontrolu nad pristupom osetljivim resursima.

Va쬹o je naglasiti da **samo jedan nalog unutar organizacije mo쬰 slu쬴ti kao podrazumevani administrator Firewall Manager-a**, pridr쬬vaju캖i se principa "**prvi unutra, poslednji napolju**". Da biste odredili novog podrazumevanog administratora, mora se slediti niz koraka:

* Prvo, svaki Firewall Administrator administratorski nalog mora opozvati svoj nalog.
* Zatim, postoje캖i podrazumevani administrator mo쬰 opozvati svoj nalog, efektivno isklju캜uju캖i organizaciju iz Firewall Manager-a. Ovaj proces rezultira brisanjem svih Firewall Manager politika koje je kreirao opozvani nalog.
* Na kraju, upravlja캜ki nalog AWS Organizations mora odrediti podrazumevanog administratora Firewall Manager-a.

## Enumeration
```
# Users/Administrators

## Get the AWS Organizations account that is associated with AWS Firewall Manager as the AWS Firewall Manager default administrator
aws fms get-admin-account

## List of Firewall Manager administrators within the organization
aws fms list-admin-accounts-for-organization # ReadOnlyAccess policy is not enough for this

## Return a list of the member accounts in the FM administrator's AWS organization
aws fms list-member-accounts # Only a Firewall Manager administrator or the Organization's management account can make this request

## List the accounts that are managing the specified AWS Organizations member account
aws fms list-admins-managing-account # ReadOnlyAccess policy is not enough for this

# Resources

## Get the resources that a Firewall Manager administrator can manage
aws fms get-admin-scope --admin-account <value> # ReadOnlyAccess policy is not enough for this

## Returns the summary of the resource sets used
aws fms list-resource-sets # ReadOnlyAccess policy is not enough for this

## Get information about a specific resource set
aws fms get-resource-set --identifier <value>  # ReadOnlyAccess policy is not enough for this

## Retrieve the list of tags for a given resource
aws fms list-tags-for-resource --resource-arn <value>

## List of the resources in the AWS Organization's accounts that are available to be associated with a FM resource set. Only one account is supported per request.
aws fms list-compliance-status --member-account-ids <value> --resource-type <value> # ReadOnlyAccess policy is not enough for this

## List the resources that are currently associated to a resource set
aws fms list-resource-set-resources --identifier <value> # ReadOnlyAccess policy is not enough for this

# Policies

## Returns the list of policies
aws fms list-policies

## Get information about the specified AWS Firewall Manager policy
aws fms get-policy --policy-id <value>

## List all of the third-party firewall policies that are associated with the third-party firewall administrator's account
aws fms list-third-party-firewall-firewall-policies --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

# AppsList

## Return a list of apps list
aws fms list-apps-lists --max-results [1-100]

## Get information about the specified AWS Firewall Manager applications list
aws fms get-apps-list --list-id <value>

# Protocols

## Get the details of the Firewall Manager protocols list.
aws fms list-protocols-lists

## Get information about the specified AWS Firewall Manager Protocols list
aws fms get-protocols-list --list-id <value>

# Compliance

## Return a summary of which member accounts are protected by the specified policy
aws fms list-compliance-status --policy-id <policy-id>

## Get detailed compliance information about the specified member account (resources that are in and out of compliance with the specified policy)
aws fms get-compliance-detail --policy-id <value> --member-account <value>

# Other useful info

## Get information about the SNS topic that is used to record AWS Firewall Manager SNS logs (if any)
aws fms get-notification-channel

## Get policy-level attack summary information in the event of a potential DDoS attack
aws fms get-protection-status --policy-id <value> # Just for Shield Advanced policy

## Get the onboarding status of a Firewall Manager admin account to third-party firewall vendor tenant.
aws fms get-third-party-firewall-association-status --third-party-firewall <PALO_ALTO_NETWORKS_CLOUD_NGFW|FORTIGATE_CLOUD_NATIVE_FIREWALL> # ReadOnlyAccess policy is not enough for this

## Get violations' details for a resource based on the specified AWS Firewall Manager policy and AWS account.
aws fms get-violation-details --policy-id <value> --member-account <value> --resource-id <value> --resource-type <value>
```
## Post Exploitation / Bypass Detection

### `organizations:DescribeOrganization` & (`fms:AssociateAdminAccount`, `fms:DisassociateAdminAccount`, `fms:PutAdminAccount`)

Napada캜 sa **`fms:AssociateAdminAccount`** dozvolom bi mogao da postavi podrazumevani administratorski nalog Firewall Manager-a. Sa **`fms:PutAdminAccount`** dozvolom, napada캜 bi mogao da kreira ili a쬿rira administratorski nalog Firewall Manager-a, a sa **`fms:DisassociateAdminAccount`** dozvolom, potencijalni napada캜 bi mogao da ukloni trenutnu asocijaciju administratorskog naloga Firewall Manager-a.

* Uklanjanje asocijacije **podrazumevanog administratora Firewall Manager-a prati politiku prvi unutra, poslednji napolje**. Svi administratori Firewall Manager-a moraju da se odjave pre nego 코to podrazumevani administrator Firewall Manager-a mo쬰 da ukloni nalog.
* Da bi se kreirao administrator Firewall Manager-a putem **PutAdminAccount**, nalog mora pripadati organizaciji koja je prethodno onboardovana na Firewall Manager koriste캖i **AssociateAdminAccount**.
* Kreiranje administratorskog naloga Firewall Manager-a mo쬰 se izvr코iti samo od strane upravlja캜kog naloga organizacije.
```bash
aws fms associate-admin-account --admin-account <value>
aws fms disassociate-admin-account
aws fms put-admin-account --admin-account <value>
```
**Potencijalni uticaj:** Gubitak centralizovanog upravljanja, izbegavanje politika, kr코enje uskla캠enosti i prekid bezbednosnih kontrola unutar okru쬰nja.

### `fms:PutPolicy`, `fms:DeletePolicy`

Napada캜 sa **`fms:PutPolicy`**, **`fms:DeletePolicy`** dozvolama mogao bi da kreira, menja ili trajno obri코e AWS Firewall Manager politiku.
```bash
aws fms put-policy --policy <value> | --cli-input-json file://<policy.json> [--tag-list <value>]
aws fms delete-policy --policy-id <value> [--delete-all-policy-resources | --no-delete-all-policy-resources]
```
Primer permisivne politike kroz permisivnu sigurnosnu grupu, kako bi se zaobi코la detekcija, mogao bi biti slede캖i:
```json
{
"Policy": {
"PolicyName": "permisive_policy",
"SecurityServicePolicyData": {
"Type": "SECURITY_GROUPS_COMMON",
"ManagedServiceData": "{\"type\":\"SECURITY_GROUPS_COMMON\",\"securityGroups\":[{\"id\":\"<permisive_security_group_id>\"}], \"applyToAllEC2InstanceENIs\":\"true\",\"IncludeSharedVPC\":\"true\"}"
},
"ResourceTypeList": ["AWS::EC2::Instance", "AWS::EC2::NetworkInterface", "AWS::EC2::SecurityGroup", "AWS::ElasticLoadBalancingV2::LoadBalancer", "AWS::ElasticLoadBalancing::LoadBalancer"],
"ResourceType": "AWS::EC2::SecurityGroup",
"ExcludeResourceTags": false,
"ResourceTags": [],
"RemediationEnabled": true
},
"TagList": []
}
```
**Potencijalni uticaj:** Demontiranje bezbednosnih kontrola, izbegavanje politika, kr코enje uskla캠enosti, operativne smetnje i potencijalni curenja podataka unutar okru쬰nja.

### `fms:BatchAssociateResource`, `fms:BatchDisassociateResource`, `fms:PutResourceSet`, `fms:DeleteResourceSet`

Napada캜 sa **`fms:BatchAssociateResource`** i **`fms:BatchDisassociateResource`** dozvolama mogao bi da pove쬰 ili odvoji resurse iz skupa resursa Firewall Manager-a. Pored toga, **`fms:PutResourceSet`** i **`fms:DeleteResourceSet`** dozvole bi omogu캖ile napada캜u da kreira, menja ili bri코e ove skupove resursa iz AWS Firewall Manager-a.
```bash
# Associate/Disassociate resources from a resource set
aws fms batch-associate-resource --resource-set-identifier <value> --items <value>
aws fms batch-disassociate-resource --resource-set-identifier <value> --items <value>

# Create, modify or delete a resource set
aws fms put-resource-set --resource-set <value> [--tag-list <value>]
aws fms delete-resource-set --identifier <value>
```
**Potencijalni Uticaj:** Dodavanje nepotrebne koli캜ine stavki u skup resursa pove캖a캖e nivo 코uma u Servisu, potencijalno uzrokuju캖i DoS. Pored toga, promene u skupovima resursa mogle bi dovesti do prekida resursa, izbegavanja politika, kr코enja uskla캠enosti i prekida bezbednosnih kontrola unutar okru쬰nja.

### `fms:PutAppsList`, `fms:DeleteAppsList`

Napada캜 sa **`fms:PutAppsList`** i **`fms:DeleteAppsList`** dozvolama mogao bi da kreira, menja ili bri코e liste aplikacija iz AWS Firewall Manager-a. Ovo bi moglo biti kriti캜no, jer bi neovla코캖ene aplikacije mogle dobiti pristup javnosti, ili bi pristup ovla코캖enim aplikacijama mogao biti odbijen, uzrokuju캖i DoS.
```bash
aws fms put-apps-list --apps-list <value> [--tag-list <value>]
aws fms delete-apps-list --list-id <value>
```
**Potencijalni uticaj:** Ovo bi moglo rezultirati pogre코nim konfiguracijama, izbegavanjem politika, kr코enjem uskla캠enosti i prekidom bezbednosnih kontrola unutar okru쬰nja.

### `fms:PutProtocolsList`, `fms:DeleteProtocolsList`

Napada캜 sa **`fms:PutProtocolsList`** i **`fms:DeleteProtocolsList`** dozvolama mogao bi da kreira, menja ili bri코e liste protokola iz AWS Firewall Manager-a. Sli캜no kao sa listama aplikacija, ovo bi moglo biti kriti캜no jer bi neovla코캖eni protokoli mogli biti kori코캖eni od strane 코ire javnosti, ili bi kori코캖enje ovla코캖enih protokola moglo biti onemogu캖eno, uzrokuju캖i DoS.
```bash
aws fms put-protocols-list --apps-list <value> [--tag-list <value>]
aws fms delete-protocols-list --list-id <value>
```
**Potencijalni uticaj:** Ovo mo쬰 rezultirati pogre코nim konfiguracijama, izbegavanjem politika, kr코enjem uskla캠enosti i prekidom bezbednosnih kontrola unutar okru쬰nja.

### `fms:PutNotificationChannel`, `fms:DeleteNotificationChannel`

Napada캜 sa **`fms:PutNotificationChannel`** i **`fms:DeleteNotificationChannel`** dozvolama mogao bi da obri코e i odredi IAM ulogu i Amazon Simple Notification Service (SNS) temu koju Firewall Manager koristi za snimanje SNS logova.

Da biste koristili **`fms:PutNotificationChannel`** van konzole, potrebno je da postavite pristupnu politiku za SNS temu, omogu캖avaju캖i specificiranoj **SnsRoleName** da objavljuje SNS logove. Ako je navedena **SnsRoleName** uloga druga캜ija od **`AWSServiceRoleForFMS`**, zahteva odnos poverenja konfigurisan da dozvoli Firewall Manager servisnom principalu **fms.amazonaws.com** da preuzme ovu ulogu.

Za informacije o konfigurisanju pristupne politike za SNS:

{% content-ref url="../aws-services/aws-sns-enum.md" %}
[aws-sns-enum.md](../aws-services/aws-sns-enum.md)
{% endcontent-ref %}
```bash
aws fms put-notification-channel --sns-topic-arn <value> --sns-role-name <value>
aws fms delete-notification-channel
```
**Potencijalni Uticaj:** Ovo bi potencijalno moglo dovesti do propu코tenih bezbednosnih upozorenja, ka코njenja u odgovoru na incidente, potencijalnih provala podataka i operativnih prekida unutar okru쬰nja.

### `fms:AssociateThirdPartyFirewall`, `fms:DisssociateThirdPartyFirewall`

Napada캜 sa **`fms:AssociateThirdPartyFirewall`**, **`fms:DisssociateThirdPartyFirewall`** dozvolama mogao bi da pove쬰 ili odvoji tre캖e strane vatrozidove od centralnog upravljanja putem AWS Firewall Manager-a.

{% hint style="warning" %}
Samo podrazumevani administrator mo쬰 da kreira i upravlja vatrozidovima tre캖ih strana.
{% endhint %}
```bash
aws fms associate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
aws fms disassociate-third-party-firewall --third-party-firewall [PALO_ALTO_NETWORKS_CLOUD_NGFW | FORTIGATE_CLOUD_NATIVE_FIREWALL]
```
**Potencijalni Uticaj:** Disocijacija bi dovela do izbegavanja politike, kr코enja uskla캠enosti i prekida bezbednosnih kontrola unutar okru쬰nja. Asocijacija, s druge strane, bi dovela do prekida raspodele tro코kova i bud쬰ta.

### `fms:TagResource`, `fms:UntagResource`

Napada캜 bi mogao da doda, izmeni ili ukloni oznake sa resursa Firewall Manager-a, ometaju캖i raspodelu tro코kova va코e organizacije, pra캖enje resursa i politike kontrole pristupa zasnovane na oznakama.
```bash
aws fms tag-resource --resource-arn <value> --tag-list <value>
aws fms untag-resource --resource-arn <value> --tag-keys <value>
```
**Potencijalni uticaj**: Poreme캖aj u alokaciji tro코kova, pra캖enju resursa i politikama kontrole pristupa zasnovanim na oznakama.

## Reference

* [https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html](https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/govcloud-fms.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awsfirewallmanager.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awsfirewallmanager.html)
* [https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html](https://docs.aws.amazon.com/waf/latest/developerguide/fms-chapter.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
