# AWS - Config Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## AWS Config

AWS Config **rejestruje zmiany zasobÃ³w**, wiÄ™c kaÅ¼da zmiana zasobu obsÅ‚ugiwanego przez Config moÅ¼e byÄ‡ zarejestrowana, co **zarejestruje, co siÄ™ zmieniÅ‚o wraz z innymi przydatnymi metadanymi, wszystko przechowywane w pliku znanym jako element konfiguracji**, CI. Ta usÅ‚uga jest **specyficzna dla regionu**.

Element konfiguracji lub **CI**, jak jest znany, jest kluczowym komponentem AWS Config. SkÅ‚ada siÄ™ z pliku JSON, ktÃ³ry **zawiera informacje o konfiguracji, informacje o relacjach i inne metadane jako migawkowy widok zasobu w danym momencie**. Wszystkie informacje, ktÃ³re AWS Config moÅ¼e zarejestrowaÄ‡ dla zasobu, sÄ… przechwytywane w CI. CI jest tworzony **za kaÅ¼dym razem**, gdy zasÃ³b obsÅ‚ugiwany ma jakÄ…kolwiek zmianÄ™ w konfiguracji. OprÃ³cz rejestrowania szczegÃ³Å‚Ã³w dotyczÄ…cych zmienionego zasobu, AWS Config zarejestruje rÃ³wnieÅ¼ CI dla wszelkich bezpoÅ›rednio powiÄ…zanych zasobÃ³w, aby upewniÄ‡ siÄ™, Å¼e zmiana nie wpÅ‚ynÄ™Å‚a rÃ³wnieÅ¼ na te zasoby.

* **Metadane**: Zawiera szczegÃ³Å‚y dotyczÄ…ce samego elementu konfiguracji. Identyfikator wersji i identyfikator konfiguracji, ktÃ³re jednoznacznie identyfikujÄ… CI. Inne informacje mogÄ… obejmowaÄ‡ MD5Hash, ktÃ³ry pozwala porÃ³wnaÄ‡ inne CI juÅ¼ zarejestrowane dla tego samego zasobu.
* **Atrybuty**: Zawiera wspÃ³lne **informacje o atrybutach dotyczÄ…ce rzeczywistego zasobu**. W tej sekcji mamy rÃ³wnieÅ¼ unikalny identyfikator zasobu i wszelkie tagi klucz-wartoÅ›Ä‡ powiÄ…zane z zasobem. Typ zasobu jest rÃ³wnieÅ¼ wymieniony. Na przykÅ‚ad, jeÅ›li byÅ‚by to CI dla instancji EC2, wymienione typy zasobÃ³w mogÄ… obejmowaÄ‡ interfejs sieciowy lub elastyczny adres IP dla tej instancji EC2.
* **Relacje**: Zawiera informacje o wszelkich powiÄ…zanych **relacjach, jakie moÅ¼e mieÄ‡ zasÃ³b**. W tej sekcji znajdzie siÄ™ jasny opis wszelkich relacji z innymi zasobami, jakie miaÅ‚ ten zasÃ³b. Na przykÅ‚ad, jeÅ›li CI dotyczyÅ‚by instancji EC2, sekcja relacji moÅ¼e pokazywaÄ‡ poÅ‚Ä…czenie z VPC wraz z podsieciÄ…, w ktÃ³rej znajduje siÄ™ instancja EC2.
* **BieÅ¼Ä…ca konfiguracja:** WyÅ›wietli te same informacje, ktÃ³re byÅ‚yby generowane, gdybyÅ› wykonaÅ‚ wywoÅ‚anie API describe lub list za pomocÄ… AWS CLI. AWS Config uÅ¼ywa tych samych wywoÅ‚aÅ„ API, aby uzyskaÄ‡ te same informacje.
* **PowiÄ…zane zdarzenia**: Dotyczy AWS CloudTrail. WyÅ›wietli **identyfikator zdarzenia AWS CloudTrail, ktÃ³ry jest zwiÄ…zany ze zmianÄ…, ktÃ³ra spowodowaÅ‚a utworzenie tego CI**. Nowy CI jest tworzony za kaÅ¼dÄ… zmianÄ™ dokonanÄ… w zasobie. W rezultacie zostanÄ… utworzone rÃ³Å¼ne identyfikatory zdarzeÅ„ CloudTrail.

**Historia konfiguracji**: MoÅ¼liwe jest uzyskanie historii konfiguracji zasobÃ³w dziÄ™ki elementom konfiguracji. Historia konfiguracji jest dostarczana co 6 godzin i zawiera wszystkie CI dla okreÅ›lonego typu zasobu.

**Strumienie konfiguracji**: Elementy konfiguracji sÄ… wysyÅ‚ane do tematu SNS, aby umoÅ¼liwiÄ‡ analizÄ™ danych.

**Migawki konfiguracji**: Elementy konfiguracji sÄ… uÅ¼ywane do tworzenia migawki wszystkich obsÅ‚ugiwanych zasobÃ³w w danym momencie.

**S3 jest uÅ¼ywany do przechowywania** plikÃ³w historii konfiguracji i wszelkich migawek konfiguracji danych w jednym wiadrze, ktÃ³re jest zdefiniowane w rejestratorze konfiguracji. JeÅ›li masz wiele kont AWS, moÅ¼esz chcieÄ‡ zintegrowaÄ‡ pliki historii konfiguracji w tym samym wiadrze S3 dla swojego gÅ‚Ã³wnego konta. Jednak bÄ™dziesz musiaÅ‚ przyznaÄ‡ dostÄ™p do zapisu dla tego serwisu, config.amazonaws.com, oraz swoim kontom wtÃ³rnym z dostÄ™pem do zapisu do wiadra S3 na swoim gÅ‚Ã³wnym koncie.

### Funkcjonowanie

* Kiedy dokonujesz zmian, na przykÅ‚ad w grupie zabezpieczeÅ„ lub liÅ›cie kontroli dostÄ™pu do wiadra â€”> uruchamia siÄ™ jako zdarzenie przechwycone przez AWS Config
* Wszystko jest przechowywane w wiadrze S3
* W zaleÅ¼noÅ›ci od konfiguracji, gdy coÅ› siÄ™ zmienia, moÅ¼e to uruchomiÄ‡ funkcjÄ™ lambda LUB zaplanowaÄ‡ funkcjÄ™ lambda, aby okresowo przeglÄ…daÅ‚a ustawienia AWS Config
* Lambda przekazuje informacje z powrotem do Config
* JeÅ›li zasada zostaÅ‚a zÅ‚amana, Config uruchamia SNS

![](<../../../../.gitbook/assets/image (126).png>)

### Zasady Config

Zasady Config to Å›wietny sposÃ³b na **wymuszanie okreÅ›lonych kontroli zgodnoÅ›ci** **i kontroli w zasobach**, i pozwala na przyjÄ™cie idealnej specyfikacji wdroÅ¼enia dla kaÅ¼dego typu zasobu. KaÅ¼da zasada **jest w zasadzie funkcjÄ… lambda**, ktÃ³ra po wywoÅ‚aniu ocenia zasÃ³b i wykonuje prostÄ… logikÄ™, aby okreÅ›liÄ‡ wynik zgodnoÅ›ci z zasadÄ…. **Za kaÅ¼dym razem, gdy dokonywana jest zmiana** w jednym z obsÅ‚ugiwanych zasobÃ³w, **AWS Config sprawdzi zgodnoÅ›Ä‡ z wszelkimi zasadami config, ktÃ³re masz w miejscu**.\
AWS ma wiele **zdefiniowanych zasad**, ktÃ³re sÄ… gotowe do uÅ¼ycia. Na przykÅ‚ad, Rds-storage-encrypted. Sprawdza, czy szyfrowanie pamiÄ™ci masowej jest aktywowane przez twoje instancje bazy danych RDS. Encrypted-volumes. Sprawdza, czy jakiekolwiek woluminy EBS, ktÃ³re majÄ… stan doÅ‚Ä…czony, sÄ… zaszyfrowane.

* **Zasady zarzÄ…dzane przez AWS**: Zestaw zdefiniowanych zasad, ktÃ³re obejmujÄ… wiele najlepszych praktyk, wiÄ™c zawsze warto przeglÄ…daÄ‡ te zasady najpierw przed ustawieniem wÅ‚asnych, poniewaÅ¼ istnieje szansa, Å¼e zasada juÅ¼ istnieje.
* **Zasady niestandardowe**: MoÅ¼esz tworzyÄ‡ wÅ‚asne zasady, aby sprawdzaÄ‡ okreÅ›lone niestandardowe konfiguracje.

Limit 50 zasad config na region, zanim bÄ™dziesz musiaÅ‚ skontaktowaÄ‡ siÄ™ z AWS w celu zwiÄ™kszenia limitu.\
Wyniki niezgodne nie sÄ… usuwane.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
