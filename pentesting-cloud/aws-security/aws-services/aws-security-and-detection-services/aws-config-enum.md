# AWS - Config Enum

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}

## AWS Config

AWS Config **capture les changements de ressources**, donc tout changement apport√© √† une ressource prise en charge par Config peut √™tre enregistr√©, ce qui **enregistrera ce qui a chang√© ainsi que d'autres m√©tadonn√©es utiles, le tout conserv√© dans un fichier connu sous le nom d'√©l√©ment de configuration**, un CI. Ce service est **sp√©cifique √† la r√©gion**.

Un √©l√©ment de configuration ou **CI** comme on l'appelle, est un composant cl√© d'AWS Config. Il est compos√© d'un fichier JSON qui **contient les informations de configuration, les informations de relation et d'autres m√©tadonn√©es sous forme de vue instantan√©e √† un moment donn√© d'une ressource prise en charge**. Toutes les informations qu'AWS Config peut enregistrer pour une ressource sont captur√©es dans le CI. Un CI est cr√©√© **chaque fois** qu'une ressource prise en charge a un changement apport√© √† sa configuration de quelque mani√®re que ce soit. En plus d'enregistrer les d√©tails de la ressource affect√©e, AWS Config enregistrera √©galement des CIs pour toutes les ressources directement li√©es afin de s'assurer que le changement n'a pas √©galement affect√© ces ressources.

* **M√©tadonn√©es** : Contient des d√©tails sur l'√©l√©ment de configuration lui-m√™me. Un ID de version et un ID de configuration, qui identifient de mani√®re unique le CI. D'autres informations peuvent inclure un MD5Hash qui vous permet de comparer d'autres CIs d√©j√† enregistr√©s contre la m√™me ressource.
* **Attributs** : Cela contient des informations d'**attributs communs par rapport √† la ressource r√©elle**. Dans cette section, nous avons √©galement un ID de ressource unique, et toutes les balises de valeur cl√© qui sont associ√©es √† la ressource. Le type de ressource est √©galement r√©pertori√©. Par exemple, si c'√©tait un CI pour une instance EC2, les types de ressources r√©pertori√©s pourraient √™tre l'interface r√©seau, ou l'adresse IP √©lastique pour cette instance EC2.
* **Relations** : Cela contient des informations sur toute **relation connect√©e que la ressource peut avoir**. Donc, dans cette section, il montrerait une description claire de toute relation avec d'autres ressources que cette ressource avait. Par exemple, si le CI √©tait pour une instance EC2, la section des relations pourrait montrer la connexion √† un VPC ainsi que le sous-r√©seau dans lequel l'instance EC2 r√©side.
* **Configuration actuelle :** Cela affichera les m√™mes informations qui seraient g√©n√©r√©es si vous deviez effectuer un appel API de description ou de liste effectu√© par l'AWS CLI. AWS Config utilise les m√™mes appels API pour obtenir les m√™mes informations.
* **√âv√©nements li√©s** : Cela concerne AWS CloudTrail. Cela affichera l'**ID d'√©v√©nement AWS CloudTrail qui est li√© au changement qui a d√©clench√© la cr√©ation de ce CI**. Un nouveau CI est cr√©√© pour chaque changement apport√© √† une ressource. En cons√©quence, diff√©rents IDs d'√©v√©nements CloudTrail seront cr√©√©s.

**Historique de configuration** : Il est possible d'obtenir l'historique de configuration des ressources gr√¢ce aux √©l√©ments de configuration. Un historique de configuration est livr√© toutes les 6 heures et contient tous les CI pour un type de ressource particulier.

**Flux de configuration** : Les √©l√©ments de configuration sont envoy√©s √† un sujet SNS pour permettre l'analyse des donn√©es.

**Instantan√©s de configuration** : Les √©l√©ments de configuration sont utilis√©s pour cr√©er un instantan√© √† un moment donn√© de toutes les ressources prises en charge.

**S3 est utilis√© pour stocker** les fichiers d'historique de configuration et tous les instantan√©s de configuration de vos donn√©es dans un seul bucket, qui est d√©fini dans l'enregistreur de configuration. Si vous avez plusieurs comptes AWS, vous voudrez peut-√™tre agr√©ger vos fichiers d'historique de configuration dans le m√™me bucket S3 pour votre compte principal. Cependant, vous devrez accorder un acc√®s en √©criture pour ce principe de service, config.amazonaws.com, et vos comptes secondaires avec un acc√®s en √©criture au bucket S3 dans votre compte principal.

### Fonctionnement

* Lorsque des changements sont effectu√©s, par exemple sur un groupe de s√©curit√© ou une liste de contr√¥le d'acc√®s de bucket ‚Äî> d√©clenche un √©v√©nement capt√© par AWS Config
* Stocke tout dans un bucket S3
* En fonction de la configuration, d√®s qu'un changement se produit, cela pourrait d√©clencher une fonction lambda OU planifier une fonction lambda pour examiner p√©riodiquement les param√®tres AWS Config
* Lambda renvoie √† Config
* Si une r√®gle a √©t√© enfreinte, Config d√©clenche un SNS

![](<../../../../.gitbook/assets/image (126).png>)

### R√®gles de configuration

Les r√®gles de configuration sont un excellent moyen de vous **aider √† appliquer des contr√¥les et des v√©rifications de conformit√© sp√©cifiques** **sur vos ressources**, et vous permettent d'adopter une sp√©cification de d√©ploiement id√©ale pour chacun de vos types de ressources. Chaque r√®gle **est essentiellement une fonction lambda** qui, lorsqu'elle est appel√©e, √©value la ressource et effectue une logique simple pour d√©terminer le r√©sultat de conformit√© avec la r√®gle. **Chaque fois qu'un changement est apport√©** √† l'une de vos ressources prises en charge, **AWS Config v√©rifiera la conformit√© par rapport √† toutes les r√®gles de configuration que vous avez en place**.\
AWS a un certain nombre de **r√®gles pr√©d√©finies** qui rel√®vent du domaine de la s√©curit√© et qui sont pr√™tes √† l'emploi. Par exemple, Rds-storage-encrypted. Cela v√©rifie si le chiffrement de stockage est activ√© par vos instances de base de donn√©es RDS. Encrypted-volumes. Cela v√©rifie si des volumes EBS qui ont un √©tat attach√© sont chiffr√©s.

* **R√®gles g√©r√©es par AWS** : Ensemble de r√®gles pr√©d√©finies qui couvrent de nombreuses meilleures pratiques, donc il vaut toujours la peine de parcourir ces r√®gles d'abord avant de configurer les v√¥tres car il y a une chance que la r√®gle existe d√©j√†.
* **R√®gles personnalis√©es** : Vous pouvez cr√©er vos propres r√®gles pour v√©rifier des configurations personnalis√©es sp√©cifiques.

Limite de 50 r√®gles de configuration par r√©gion avant de devoir contacter AWS pour une augmentation.\
Les r√©sultats non conformes ne sont PAS supprim√©s.

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
