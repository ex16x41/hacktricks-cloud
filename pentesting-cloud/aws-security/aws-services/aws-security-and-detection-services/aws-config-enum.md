# AWS - Config Enum

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}

## AWS Config

AWS Config **captura cambios en los recursos**, por lo que cualquier cambio en un recurso soportado por Config puede ser registrado, lo que **registrar√° lo que cambi√≥ junto con otra metadata √∫til, todo contenido en un archivo conocido como un elemento de configuraci√≥n**, un CI. Este servicio es **espec√≠fico de la regi√≥n**.

Un elemento de configuraci√≥n o **CI** como se le conoce, es un componente clave de AWS Config. Est√° compuesto por un archivo JSON que **contiene la informaci√≥n de configuraci√≥n, informaci√≥n de relaci√≥n y otra metadata como una vista instant√°nea de un recurso soportado en un momento dado**. Toda la informaci√≥n que AWS Config puede registrar para un recurso se captura dentro del CI. Un CI se crea **cada vez que** un recurso soportado tiene un cambio en su configuraci√≥n de cualquier manera. Adem√°s de registrar los detalles del recurso afectado, AWS Config tambi√©n registrar√° CIs para cualquier recurso directamente relacionado para asegurar que el cambio no afect√≥ a esos recursos tambi√©n.

* **Metadata**: Contiene detalles sobre el elemento de configuraci√≥n en s√≠. Un ID de versi√≥n y un ID de configuraci√≥n, que identifican de manera √∫nica el CI. Otra informaci√≥n puede incluir un MD5Hash que te permite comparar otros CIs ya registrados contra el mismo recurso.
* **Atributos**: Esto contiene informaci√≥n com√∫n de **atributos contra el recurso real**. Dentro de esta secci√≥n, tambi√©n tenemos un ID de recurso √∫nico, y cualquier etiqueta de valor clave que est√© asociada al recurso. El tipo de recurso tambi√©n se lista. Por ejemplo, si este fuera un CI para una instancia EC2, los tipos de recursos listados podr√≠an ser la interfaz de red, o la direcci√≥n IP el√°stica para esa instancia EC2.
* **Relaciones**: Esto contiene informaci√≥n sobre cualquier **relaci√≥n conectada que el recurso pueda tener**. As√≠ que dentro de esta secci√≥n, mostrar√≠a una descripci√≥n clara de cualquier relaci√≥n con otros recursos que este recurso tuviera. Por ejemplo, si el CI fuera para una instancia EC2, la secci√≥n de relaciones podr√≠a mostrar la conexi√≥n a un VPC junto con la subred en la que reside la instancia EC2.
* **Configuraci√≥n actual:** Esto mostrar√° la misma informaci√≥n que se generar√≠a si realizaras una llamada API de descripci√≥n o lista hecha por el AWS CLI. AWS Config utiliza las mismas llamadas API para obtener la misma informaci√≥n.
* **Eventos relacionados**: Esto se relaciona con AWS CloudTrail. Esto mostrar√° el **ID de evento de AWS CloudTrail que est√° relacionado con el cambio que activ√≥ la creaci√≥n de este CI**. Se crea un nuevo CI por cada cambio realizado contra un recurso. Como resultado, se crear√°n diferentes IDs de eventos de CloudTrail.

**Historial de Configuraci√≥n**: Es posible obtener el historial de configuraci√≥n de los recursos gracias a los elementos de configuraci√≥n. Un historial de configuraci√≥n se entrega cada 6 horas y contiene todos los CIs para un tipo de recurso particular.

**Flujos de Configuraci√≥n**: Los elementos de configuraci√≥n se env√≠an a un tema SNS para habilitar el an√°lisis de los datos.

**Instant√°neas de Configuraci√≥n**: Los elementos de configuraci√≥n se utilizan para crear una instant√°nea en el tiempo de todos los recursos soportados.

**S3 se utiliza para almacenar** los archivos de Historial de Configuraci√≥n y cualquier instant√°nea de Configuraci√≥n de tus datos dentro de un solo bucket, que se define dentro del grabador de configuraci√≥n. Si tienes m√∫ltiples cuentas de AWS, es posible que desees agregar tus archivos de historial de configuraci√≥n en el mismo bucket S3 para tu cuenta principal. Sin embargo, necesitar√°s otorgar acceso de escritura para este principio de servicio, config.amazonaws.com, y tus cuentas secundarias con acceso de escritura al bucket S3 en tu cuenta principal.

### Funcionamiento

* Cuando se realizan cambios, por ejemplo, en el grupo de seguridad o en la lista de control de acceso del bucket ‚Äî> se dispara como un Evento recogido por AWS Config
* Almacena todo en el bucket S3
* Dependiendo de la configuraci√≥n, tan pronto como algo cambie podr√≠a activar una funci√≥n lambda O programar una funci√≥n lambda para revisar peri√≥dicamente la configuraci√≥n de AWS Config
* Lambda retroalimenta a Config
* Si se ha roto una regla, Config activa un SNS

![](<../../../../.gitbook/assets/image (126).png>)

### Reglas de Config

Las reglas de Config son una excelente manera de ayudarte a **hacer cumplir verificaciones de cumplimiento espec√≠ficas** **y controles a trav√©s de tus recursos**, y te permiten adoptar una especificaci√≥n de implementaci√≥n ideal para cada uno de tus tipos de recursos. Cada regla **es esencialmente una funci√≥n lambda** que, cuando se invoca, eval√∫a el recurso y lleva a cabo alguna l√≥gica simple para determinar el resultado de cumplimiento con la regla. **Cada vez que se realiza un cambio** en uno de tus recursos soportados, **AWS Config verificar√° el cumplimiento contra cualquier regla de configuraci√≥n que tengas en su lugar**.\
AWS tiene una serie de **reglas predefinidas** que caen bajo el paraguas de seguridad que est√°n listas para usar. Por ejemplo, Rds-storage-encrypted. Esto verifica si la encriptaci√≥n de almacenamiento est√° activada por tus instancias de base de datos RDS. Encrypted-volumes. Esto verifica si alg√∫n volumen EBS que tiene un estado adjunto est√° encriptado.

* **Reglas gestionadas por AWS**: Conjunto de reglas predefinidas que cubren muchas de las mejores pr√°cticas, por lo que siempre vale la pena revisar estas reglas primero antes de configurar las tuyas, ya que existe la posibilidad de que la regla ya exista.
* **Reglas personalizadas**: Puedes crear tus propias reglas para verificar configuraciones personalizadas espec√≠ficas.

L√≠mite de 50 reglas de configuraci√≥n por regi√≥n antes de que necesites contactar a AWS para un aumento.\
Los resultados no conformes NO se eliminan.

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}
