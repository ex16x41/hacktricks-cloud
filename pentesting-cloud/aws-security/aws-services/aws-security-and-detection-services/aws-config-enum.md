# AWS - Config Enum

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

## AWS Config

AWS Config **rejestruje zmiany zasobÃ³w**, wiÄ™c kaÅ¼da zmiana w zasobie obsÅ‚ugiwanym przez Config moÅ¼e byÄ‡ zarejestrowana, co **zarejestruje, co siÄ™ zmieniÅ‚o wraz z innymi przydatnymi metadanymi, wszystko przechowywane w pliku znanym jako element konfiguracji**, CI. Ta usÅ‚uga jest **specyficzna dla regionu**.

Element konfiguracji lub **CI**, jak to siÄ™ nazywa, jest kluczowym komponentem AWS Config. SkÅ‚ada siÄ™ z pliku JSON, ktÃ³ry **przechowuje informacje o konfiguracji, informacje o relacjach i inne metadane jako widok migawki w danym momencie obsÅ‚ugiwanego zasobu**. Wszystkie informacje, ktÃ³re AWS Config moÅ¼e zarejestrowaÄ‡ dla zasobu, sÄ… przechwytywane w CI. CI jest tworzony **za kaÅ¼dym razem**, gdy w obsÅ‚ugiwanym zasobie dokonano jakiejkolwiek zmiany w jego konfiguracji. OprÃ³cz rejestrowania szczegÃ³Å‚Ã³w dotyczÄ…cych dotkniÄ™tego zasobu, AWS Config zarejestruje rÃ³wnieÅ¼ CI dla wszelkich bezpoÅ›rednio powiÄ…zanych zasobÃ³w, aby upewniÄ‡ siÄ™, Å¼e zmiana nie wpÅ‚ynÄ™Å‚a rÃ³wnieÅ¼ na te zasoby.

* **Metadane**: Zawiera szczegÃ³Å‚y dotyczÄ…ce samego elementu konfiguracji. Identyfikator wersji i identyfikator konfiguracji, ktÃ³ry unikalnie identyfikuje CI. Inne informacje mogÄ… obejmowaÄ‡ MD5Hash, ktÃ³ry pozwala porÃ³wnywaÄ‡ inne CI juÅ¼ zarejestrowane w odniesieniu do tego samego zasobu.
* **Atrybuty**: Zawiera wspÃ³lne **informacje o atrybutach w odniesieniu do rzeczywistego zasobu**. W tej sekcji mamy rÃ³wnieÅ¼ unikalny identyfikator zasobu oraz wszelkie tagi klucz-wartoÅ›Ä‡, ktÃ³re sÄ… zwiÄ…zane z zasobem. Typ zasobu jest rÃ³wnieÅ¼ wymieniony. Na przykÅ‚ad, jeÅ›li byÅ‚by to CI dla instancji EC2, typy zasobÃ³w wymienione mogÅ‚yby obejmowaÄ‡ interfejs sieciowy lub elastyczny adres IP dla tej instancji EC2.
* **Relacje**: Zawiera informacje o wszelkich poÅ‚Ä…czeniach **relacji, ktÃ³re zasÃ³b moÅ¼e mieÄ‡**. W tej sekcji wyÅ›wietli jasny opis wszelkich relacji z innymi zasobami, ktÃ³re ten zasÃ³b miaÅ‚. Na przykÅ‚ad, jeÅ›li CI dotyczyÅ‚a instancji EC2, sekcja relacji mogÅ‚aby pokazaÄ‡ poÅ‚Ä…czenie z VPC wraz z podsieciÄ…, w ktÃ³rej znajduje siÄ™ instancja EC2.
* **BieÅ¼Ä…ca konfiguracja:** WyÅ›wietli te same informacje, ktÃ³re byÅ‚yby generowane, gdybyÅ› wykonaÅ‚ wywoÅ‚anie API describe lub list za pomocÄ… AWS CLI. AWS Config uÅ¼ywa tych samych wywoÅ‚aÅ„ API, aby uzyskaÄ‡ te same informacje.
* **PowiÄ…zane zdarzenia**: To odnosi siÄ™ do AWS CloudTrail. WyÅ›wietli **identyfikator zdarzenia AWS CloudTrail, ktÃ³ry jest zwiÄ…zany ze zmianÄ…, ktÃ³ra wywoÅ‚aÅ‚a utworzenie tego CI**. Dla kaÅ¼dej zmiany dokonanej w zasobie tworzony jest nowy CI. W rezultacie bÄ™dÄ… tworzone rÃ³Å¼ne identyfikatory zdarzeÅ„ CloudTrail.

**Historia konfiguracji**: MoÅ¼liwe jest uzyskanie historii konfiguracji zasobÃ³w dziÄ™ki elementom konfiguracji. Historia konfiguracji jest dostarczana co 6 godzin i zawiera wszystkie CI dla danego typu zasobu.

**Strumienie konfiguracji**: Elementy konfiguracji sÄ… wysyÅ‚ane do tematu SNS, aby umoÅ¼liwiÄ‡ analizÄ™ danych.

**Migawki konfiguracji**: Elementy konfiguracji sÄ… uÅ¼ywane do tworzenia migawki w danym momencie wszystkich obsÅ‚ugiwanych zasobÃ³w.

**S3 jest uÅ¼ywane do przechowywania** plikÃ³w historii konfiguracji i wszelkich migawek konfiguracji twoich danych w jednym koszyku, ktÃ³ry jest definiowany w rejestratorze konfiguracji. JeÅ›li masz wiele kont AWS, moÅ¼esz chcieÄ‡ zgrupowaÄ‡ swoje pliki historii konfiguracji w tym samym koszyku S3 dla swojego gÅ‚Ã³wnego konta. Jednak bÄ™dziesz musiaÅ‚ przyznaÄ‡ dostÄ™p do zapisu dla tego zasady usÅ‚ugi, config.amazonaws.com, oraz twoich drugorzÄ™dnych kont z dostÄ™pem do zapisu do koszyka S3 w twoim gÅ‚Ã³wnym koncie.

### DziaÅ‚anie

* Gdy dokonujesz zmian, na przykÅ‚ad w grupie zabezpieczeÅ„ lub liÅ›cie kontroli dostÄ™pu do koszyka â€”> wywoÅ‚aj jako zdarzenie przechwycone przez AWS Config
* Przechowuje wszystko w koszyku S3
* W zaleÅ¼noÅ›ci od konfiguracji, gdy coÅ› siÄ™ zmienia, moÅ¼e to wywoÅ‚aÄ‡ funkcjÄ™ lambda LUB zaplanowaÄ‡ funkcjÄ™ lambda, aby okresowo przeszukiwaÄ‡ ustawienia AWS Config
* Lambda przekazuje informacje z powrotem do Config
* JeÅ›li zasada zostaÅ‚a naruszona, Config uruchamia SNS

![](<../../../../.gitbook/assets/image (126).png>)

### ReguÅ‚y Config

ReguÅ‚y Config to Å›wietny sposÃ³b, aby pomÃ³c ci **egzekwowaÄ‡ konkretne kontrole zgodnoÅ›ci** **i kontrole w caÅ‚ych zasobach**, i pozwala ci przyjÄ…Ä‡ idealnÄ… specyfikacjÄ™ wdroÅ¼enia dla kaÅ¼dego z typÃ³w zasobÃ³w. KaÅ¼da reguÅ‚a **jest zasadniczo funkcjÄ… lambda**, ktÃ³ra po wywoÅ‚aniu ocenia zasÃ³b i wykonuje prostÄ… logikÄ™, aby okreÅ›liÄ‡ wynik zgodnoÅ›ci z reguÅ‚Ä…. **Za kaÅ¼dym razem, gdy dokonuje siÄ™ zmiany** w jednym z twoich obsÅ‚ugiwanych zasobÃ³w, **AWS Config sprawdzi zgodnoÅ›Ä‡ z wszelkimi reguÅ‚ami konfiguracji, ktÃ³re masz w miejscu**.\
AWS ma szereg **zdefiniowanych reguÅ‚**, ktÃ³re mieszczÄ… siÄ™ w ramach bezpieczeÅ„stwa i sÄ… gotowe do uÅ¼ycia. Na przykÅ‚ad, Rds-storage-encrypted. To sprawdza, czy szyfrowanie pamiÄ™ci masowej jest aktywowane przez twoje instancje bazy danych RDS. Encrypted-volumes. To sprawdza, czy jakiekolwiek wolumeny EBS, ktÃ³re majÄ… stan podÅ‚Ä…czenia, sÄ… szyfrowane.

* **ZarzÄ…dzane reguÅ‚y AWS**: Zestaw zdefiniowanych reguÅ‚, ktÃ³re obejmujÄ… wiele najlepszych praktyk, wiÄ™c zawsze warto najpierw przeszukaÄ‡ te reguÅ‚y, zanim utworzysz wÅ‚asne, poniewaÅ¼ istnieje szansa, Å¼e reguÅ‚a moÅ¼e juÅ¼ istnieÄ‡.
* **ReguÅ‚y niestandardowe**: MoÅ¼esz tworzyÄ‡ wÅ‚asne reguÅ‚y, aby sprawdziÄ‡ konkretne niestandardowe konfiguracje.

Limit 50 reguÅ‚ konfiguracji na region, zanim bÄ™dziesz musiaÅ‚ skontaktowaÄ‡ siÄ™ z AWS w celu zwiÄ™kszenia.\
Wyniki niezgodne nie sÄ… USUWANE.

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
