# AWS - Config Enum

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

## AWS Config

AWS Config **erfasst √Ñnderungen an Ressourcen**, sodass jede √Ñnderung an einer von Config unterst√ºtzten Ressource aufgezeichnet werden kann, was **aufzeichnet, was sich ge√§ndert hat, zusammen mit anderen n√ºtzlichen Metadaten, die alle in einer Datei bekannt als Konfigurationselement, einem CI, gespeichert sind**. Dieser Dienst ist **regionsspezifisch**.

Ein Konfigurationselement oder **CI**, wie es bekannt ist, ist ein Schl√ºsselkomponente von AWS Config. Es besteht aus einer JSON-Datei, die **die Konfigurationsinformationen, Beziehungsinformationen und andere Metadaten als Momentaufnahme eines unterst√ºtzten Ressourcenstatus enth√§lt**. Alle Informationen, die AWS Config f√ºr eine Ressource aufzeichnen kann, sind im CI erfasst. Ein CI wird **jedes Mal** erstellt, wenn eine unterst√ºtzte Ressource in irgendeiner Weise eine √Ñnderung an ihrer Konfiguration erf√§hrt. Neben der Aufzeichnung der Details der betroffenen Ressource wird AWS Config auch CIs f√ºr alle direkt verwandten Ressourcen aufzeichnen, um sicherzustellen, dass die √Ñnderung diese Ressourcen nicht ebenfalls betroffen hat.

* **Metadaten**: Enth√§lt Details √ºber das Konfigurationselement selbst. Eine Versions-ID und eine Konfigurations-ID, die das CI eindeutig identifiziert. Weitere Informationen k√∂nnen einen MD5Hash umfassen, der es erm√∂glicht, andere bereits aufgezeichnete CIs gegen dieselbe Ressource zu vergleichen.
* **Attribute**: Dies enth√§lt allgemeine **Attributinformationen zur tats√§chlichen Ressource**. In diesem Abschnitt haben wir auch eine eindeutige Ressourcen-ID und alle Schl√ºsselwert-Tags, die mit der Ressource verbunden sind. Der Ressourcentyp wird ebenfalls aufgef√ºhrt. Wenn dies beispielsweise ein CI f√ºr eine EC2-Instanz war, k√∂nnten die aufgef√ºhrten Ressourcentypen das Netzwerkinterface oder die elastische IP-Adresse f√ºr diese EC2-Instanz sein.
* **Beziehungen**: Dies enth√§lt Informationen zu jeder verbundenen **Beziehung, die die Ressource haben kann**. In diesem Abschnitt w√ºrde eine klare Beschreibung jeder Beziehung zu anderen Ressourcen angezeigt, die diese Ressource hatte. Wenn das CI beispielsweise f√ºr eine EC2-Instanz war, k√∂nnte der Beziehungsabschnitt die Verbindung zu einem VPC zusammen mit dem Subnetz anzeigen, in dem sich die EC2-Instanz befindet.
* **Aktuelle Konfiguration:** Dies zeigt die gleichen Informationen an, die generiert w√ºrden, wenn du einen Describe- oder List-API-Aufruf mit der AWS CLI durchf√ºhren w√ºrdest. AWS Config verwendet die gleichen API-Aufrufe, um die gleichen Informationen zu erhalten.
* **Verwandte Ereignisse**: Dies bezieht sich auf AWS CloudTrail. Dies zeigt die **AWS CloudTrail-Ereignis-ID an, die mit der √Ñnderung verbunden ist, die die Erstellung dieses CI ausgel√∂st hat**. F√ºr jede √Ñnderung, die an einer Ressource vorgenommen wird, wird ein neues CI erstellt. Infolgedessen werden unterschiedliche CloudTrail-Ereignis-IDs erstellt.

**Konfigurationshistorie**: Es ist m√∂glich, die Konfigurationshistorie von Ressourcen dank der Konfigurationselemente zu erhalten. Eine Konfigurationshistorie wird alle 6 Stunden geliefert und enth√§lt alle CIs f√ºr einen bestimmten Ressourcentyp.

**Konfigurationsstr√∂me**: Konfigurationselemente werden an ein SNS-Thema gesendet, um die Analyse der Daten zu erm√∂glichen.

**Konfigurationsschnappsch√ºsse**: Konfigurationselemente werden verwendet, um eine Momentaufnahme aller unterst√ºtzten Ressourcen zu erstellen.

**S3 wird verwendet, um** die Konfigurationshistorie-Dateien und alle Konfigurationsschnappsch√ºsse deiner Daten innerhalb eines einzelnen Buckets zu speichern, der im Konfigurationsrekorder definiert ist. Wenn du mehrere AWS-Konten hast, m√∂chtest du m√∂glicherweise deine Konfigurationshistorie-Dateien in denselben S3-Bucket f√ºr dein prim√§res Konto aggregieren. Du musst jedoch diesem Dienstprinzip, config.amazonaws.com, und deinen sekund√§ren Konten Schreibzugriff auf den S3-Bucket in deinem prim√§ren Konto gew√§hren.

### Funktionsweise

* Wenn √Ñnderungen vorgenommen werden, zum Beispiel an der Sicherheitsgruppe oder der Zugriffssteuerungsliste f√ºr Buckets ‚Äî> wird als ein Ereignis ausgel√∂st, das von AWS Config erfasst wird
* Speichert alles in einem S3-Bucket
* Je nach Einrichtung k√∂nnte es, sobald sich etwas √§ndert, eine Lambda-Funktion ausl√∂sen ODER eine geplante Lambda-Funktion, die regelm√§√üig die AWS Config-Einstellungen √ºberpr√ºft
* Lambda gibt Feedback an Config
* Wenn eine Regel verletzt wurde, wird Config ein SNS ausl√∂sen

![](<../../../../.gitbook/assets/image (126).png>)

### Config-Regeln

Config-Regeln sind eine gro√üartige M√∂glichkeit, um **spezifische Compliance-Pr√ºfungen** **und Kontrollen √ºber deine Ressourcen durchzusetzen** und erm√∂glichen es dir, eine ideale Bereitstellungsspezifikation f√ºr jeden deiner Ressourcentypen zu √ºbernehmen. Jede Regel **ist im Wesentlichen eine Lambda-Funktion**, die, wenn sie aufgerufen wird, die Ressource bewertet und eine einfache Logik anwendet, um das Compliance-Ergebnis mit der Regel zu bestimmen. **Jedes Mal, wenn eine √Ñnderung an** einer deiner unterst√ºtzten Ressourcen vorgenommen wird, **√ºberpr√ºft AWS Config die Compliance gegen alle Config-Regeln, die du implementiert hast**.\
AWS hat eine Reihe von **vordefinierten Regeln**, die unter dem Sicherheitsbereich fallen und bereit zur Verwendung sind. Zum Beispiel, Rds-storage-encrypted. Dies √ºberpr√ºft, ob die Speicherungverschl√ºsselung von deinen RDS-Datenbankinstanzen aktiviert ist. Encrypted-volumes. Dies √ºberpr√ºft, ob EBS-Volumes, die einen angeh√§ngten Zustand haben, verschl√ºsselt sind.

* **AWS-verwaltete Regeln**: Eine Reihe von vordefinierten Regeln, die viele Best Practices abdecken, daher ist es immer sinnvoll, diese Regeln zuerst zu durchsuchen, bevor du deine eigenen einrichtest, da die Regel m√∂glicherweise bereits existiert.
* **Benutzerdefinierte Regeln**: Du kannst deine eigenen Regeln erstellen, um spezifische benutzerdefinierte Konfigurationen zu √ºberpr√ºfen.

Limit von 50 Config-Regeln pro Region, bevor du AWS f√ºr eine Erh√∂hung kontaktieren musst.\
Nicht konforme Ergebnisse werden NICHT gel√∂scht.

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
