# AWS - Config Enum

{% hint style="success" %}
Impara e pratica AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Impara e pratica GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supporta HackTricks</summary>

* Controlla i [**piani di abbonamento**](https://github.com/sponsors/carlospolop)!
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Condividi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository su github.

</details>
{% endhint %}

## AWS Config

AWS Config **cattura i cambiamenti delle risorse**, quindi qualsiasi cambiamento a una risorsa supportata da Config pu√≤ essere registrato, il che **registrer√† cosa √® cambiato insieme ad altri metadati utili, tutti contenuti in un file noto come elemento di configurazione**, un CI. Questo servizio √® **specifico per regione**.

Un elemento di configurazione o **CI**, come √® noto, √® un componente chiave di AWS Config. √à composto da un file JSON che **contiene le informazioni di configurazione, le informazioni sulle relazioni e altri metadati come una vista snapshot puntuale di una risorsa supportata**. Tutte le informazioni che AWS Config pu√≤ registrare per una risorsa sono catturate all'interno del CI. Un CI viene creato **ogni volta** che una risorsa supportata subisce una modifica alla sua configurazione in qualsiasi modo. Oltre a registrare i dettagli della risorsa interessata, AWS Config registrer√† anche i CI per qualsiasi risorsa direttamente correlata per garantire che il cambiamento non abbia influenzato anche quelle risorse.

* **Metadati**: Contiene dettagli sull'elemento di configurazione stesso. Un ID di versione e un ID di configurazione, che identificano univocamente il CI. Altre informazioni possono includere un MD5Hash che consente di confrontare altri CI gi√† registrati contro la stessa risorsa.
* **Attributi**: Questo contiene informazioni comuni sugli **attributi della risorsa effettiva**. All'interno di questa sezione, abbiamo anche un ID risorsa univoco e qualsiasi tag di valore chiave associato alla risorsa. Viene anche elencato il tipo di risorsa. Ad esempio, se questo fosse un CI per un'istanza EC2, i tipi di risorsa elencati potrebbero essere l'interfaccia di rete o l'indirizzo IP elastico per quell'istanza EC2.
* **Relazioni**: Questo contiene informazioni per qualsiasi **relazione connessa che la risorsa potrebbe avere**. Quindi, all'interno di questa sezione, mostrerebbe una chiara descrizione di qualsiasi relazione con altre risorse che questa risorsa aveva. Ad esempio, se il CI fosse per un'istanza EC2, la sezione delle relazioni potrebbe mostrare la connessione a una VPC insieme alla subnet in cui risiede l'istanza EC2.
* **Configurazione attuale:** Questo mostrer√† le stesse informazioni che verrebbero generate se si eseguisse una chiamata API di descrizione o elenco effettuata dall'AWS CLI. AWS Config utilizza le stesse chiamate API per ottenere le stesse informazioni.
* **Eventi correlati**: Questo si riferisce ad AWS CloudTrail. Questo mostrer√† l'**ID evento di AWS CloudTrail correlato al cambiamento che ha innescato la creazione di questo CI**. Viene creato un nuovo CI per ogni cambiamento effettuato su una risorsa. Di conseguenza, verranno creati diversi ID evento CloudTrail.

**Storia della configurazione**: √à possibile ottenere la storia della configurazione delle risorse grazie agli elementi di configurazione. Una storia della configurazione viene consegnata ogni 6 ore e contiene tutti i CI per un particolare tipo di risorsa.

**Stream di configurazione**: Gli elementi di configurazione vengono inviati a un argomento SNS per consentire l'analisi dei dati.

**Snapshot di configurazione**: Gli elementi di configurazione vengono utilizzati per creare uno snapshot puntuale di tutte le risorse supportate.

**S3 viene utilizzato per memorizzare** i file della storia della configurazione e qualsiasi snapshot di configurazione dei tuoi dati all'interno di un singolo bucket, che √® definito all'interno del registratore di configurazione. Se hai pi√π account AWS, potresti voler aggregare i tuoi file della storia della configurazione nello stesso bucket S3 per il tuo account principale. Tuttavia, dovrai concedere l'accesso in scrittura a questo principio di servizio, config.amazonaws.com, e ai tuoi account secondari con accesso in scrittura al bucket S3 nel tuo account principale.

### Funzionamento

* Quando si apportano modifiche, ad esempio al gruppo di sicurezza o alla lista di controllo degli accessi del bucket ‚Äî> viene attivato come un Evento rilevato da AWS Config
* Memorizza tutto nel bucket S3
* A seconda della configurazione, non appena qualcosa cambia potrebbe attivare una funzione lambda O programmare una funzione lambda per esaminare periodicamente le impostazioni di AWS Config
* Lambda restituisce a Config
* Se una regola √® stata violata, Config attiva un SNS

![](<../../../../.gitbook/assets/image (126).png>)

### Regole di Config

Le regole di Config sono un ottimo modo per aiutarti a **far rispettare controlli e verifiche di conformit√† specifici** **attraverso le tue risorse**, e ti consente di adottare una specifica di distribuzione ideale per ciascuno dei tuoi tipi di risorse. Ogni regola **√® essenzialmente una funzione lambda** che, quando chiamata, valuta la risorsa ed esegue una semplice logica per determinare il risultato di conformit√† con la regola. **Ogni volta che viene apportata una modifica** a una delle tue risorse supportate, **AWS Config verificher√† la conformit√† rispetto a qualsiasi regola di configurazione che hai in atto**.\
AWS ha un numero di **regole predefinite** che rientrano nell'ambito della sicurezza pronte per l'uso. Ad esempio, Rds-storage-encrypted. Questo verifica se la crittografia dello storage √® attivata dalle tue istanze di database RDS. Encrypted-volumes. Questo verifica se i volumi EBS che hanno uno stato allegato sono crittografati.

* **Regole gestite da AWS**: Set di regole predefinite che coprono molte delle migliori pratiche, quindi vale sempre la pena esaminare queste regole prima di impostare le proprie poich√© c'√® la possibilit√† che la regola esista gi√†.
* **Regole personalizzate**: Puoi creare le tue regole per verificare configurazioni specifiche personalizzate.

Limite di 50 regole di configurazione per regione prima di dover contattare AWS per un aumento.\
I risultati non conformi NON vengono eliminati.

{% hint style="success" %}
Impara e pratica AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Impara e pratica GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supporta HackTricks</summary>

* Controlla i [**piani di abbonamento**](https://github.com/sponsors/carlospolop)!
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Condividi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository su github.

</details>
{% endhint %}
