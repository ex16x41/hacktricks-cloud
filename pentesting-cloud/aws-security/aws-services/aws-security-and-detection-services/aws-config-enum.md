# AWS - Config Enum

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

## AWS Config

AWS Config **erfasst Ressourcen√§nderungen**, sodass jede √Ñnderung an einer von Config unterst√ºtzten Ressource aufgezeichnet werden kann, was **aufzeichnet, was sich ge√§ndert hat, zusammen mit anderen n√ºtzlichen Metadaten, die alle in einer Datei namens Konfigurationselement (CI) gespeichert sind**. Dieser Dienst ist **regionsspezifisch**.

Ein Konfigurationselement oder **CI**, wie es bekannt ist, ist ein Schl√ºsselelement von AWS Config. Es besteht aus einer JSON-Datei, die **die Konfigurationsinformationen, Beziehungsinformationen und andere Metadaten als Momentaufnahme einer unterst√ºtzten Ressource enth√§lt**. Alle Informationen, die AWS Config f√ºr eine Ressource aufzeichnen kann, werden im CI erfasst. Ein CI wird **jedes Mal** erstellt, wenn eine unterst√ºtzte Ressource in irgendeiner Weise eine √Ñnderung an ihrer Konfiguration erf√§hrt. Zus√§tzlich zur Aufzeichnung der Details der betroffenen Ressource wird AWS Config auch CIs f√ºr alle direkt verwandten Ressourcen aufzeichnen, um sicherzustellen, dass die √Ñnderung diese Ressourcen nicht ebenfalls beeinflusst hat.

* **Metadaten**: Enth√§lt Details √ºber das Konfigurationselement selbst. Eine Versions-ID und eine Konfigurations-ID, die das CI eindeutig identifizieren. Weitere Informationen k√∂nnen einen MD5Hash enthalten, der es erm√∂glicht, andere bereits aufgezeichnete CIs mit derselben Ressource zu vergleichen.
* **Attribute**: Dies enth√§lt allgemeine **Attributinformationen zur tats√§chlichen Ressource**. In diesem Abschnitt haben wir auch eine eindeutige Ressourcen-ID und alle Schl√ºsselwert-Tags, die der Ressource zugeordnet sind. Der Ressourcentyp wird ebenfalls aufgef√ºhrt. Wenn es sich beispielsweise um ein CI f√ºr eine EC2-Instanz handelt, k√∂nnten die aufgef√ºhrten Ressourcentypen die Netzwerkschnittstelle oder die elastische IP-Adresse f√ºr diese EC2-Instanz sein.
* **Beziehungen**: Dies enth√§lt Informationen zu jeder verbundenen **Beziehung, die die Ressource haben k√∂nnte**. In diesem Abschnitt w√ºrde also eine klare Beschreibung jeder Beziehung zu anderen Ressourcen angezeigt, die diese Ressource hatte. Wenn das CI beispielsweise f√ºr eine EC2-Instanz war, k√∂nnte der Beziehungsabschnitt die Verbindung zu einem VPC zusammen mit dem Subnetz anzeigen, in dem sich die EC2-Instanz befindet.
* **Aktuelle Konfiguration**: Dies zeigt dieselben Informationen an, die generiert w√ºrden, wenn Sie einen Describe- oder List-API-Aufruf √ºber die AWS CLI durchf√ºhren w√ºrden. AWS Config verwendet dieselben API-Aufrufe, um dieselben Informationen zu erhalten.
* **Verwandte Ereignisse**: Dies bezieht sich auf AWS CloudTrail. Dies zeigt die **AWS CloudTrail-Ereignis-ID an, die mit der √Ñnderung zusammenh√§ngt, die die Erstellung dieses CI ausgel√∂st hat**. F√ºr jede √Ñnderung an einer Ressource wird ein neues CI erstellt. Infolgedessen werden unterschiedliche CloudTrail-Ereignis-IDs erstellt.

**Konfigurationshistorie**: Es ist m√∂glich, die Konfigurationshistorie von Ressourcen dank der Konfigurationselemente zu erhalten. Eine Konfigurationshistorie wird alle 6 Stunden geliefert und enth√§lt alle CIs f√ºr einen bestimmten Ressourcentyp.

**Konfigurationsstreams**: Konfigurationselemente werden an ein SNS-Thema gesendet, um die Analyse der Daten zu erm√∂glichen.

**Konfigurations-Snapshots**: Konfigurationselemente werden verwendet, um eine Momentaufnahme aller unterst√ºtzten Ressourcen zu erstellen.

**S3 wird verwendet, um** die Konfigurationshistorie-Dateien und alle Konfigurations-Snapshots Ihrer Daten in einem einzigen Bucket zu speichern, der im Konfigurationsrekorder definiert ist. Wenn Sie mehrere AWS-Konten haben, m√∂chten Sie m√∂glicherweise Ihre Konfigurationshistorie-Dateien in demselben S3-Bucket f√ºr Ihr prim√§res Konto zusammenf√ºhren. Sie m√ºssen jedoch Schreibzugriff f√ºr dieses Dienstprinzipal, config.amazonaws.com, und Ihre sekund√§ren Konten mit Schreibzugriff auf den S3-Bucket in Ihrem prim√§ren Konto gew√§hren.

### Funktionsweise

* Wenn √Ñnderungen vorgenommen werden, z.B. an der Sicherheitsgruppe oder der Bucket-Zugriffskontrollliste ‚Äî> wird als Ereignis ausgel√∂st, das von AWS Config erfasst wird
* Speichert alles im S3-Bucket
* Je nach Einrichtung k√∂nnte eine Lambda-Funktion ausgel√∂st werden, sobald sich etwas √§ndert, ODER eine Lambda-Funktion planen, die regelm√§√üig die AWS Config-Einstellungen durchsucht
* Lambda gibt Feedback an Config
* Wenn eine Regel gebrochen wurde, startet Config ein SNS

![](<../../../../.gitbook/assets/image (126).png>)

### Config-Regeln

Config-Regeln sind eine gro√üartige M√∂glichkeit, um **spezifische Compliance-Pr√ºfungen** **und Kontrollen √ºber Ihre Ressourcen durchzusetzen** und Ihnen zu erm√∂glichen, eine ideale Bereitstellungsspezifikation f√ºr jeden Ihrer Ressourcentypen zu √ºbernehmen. Jede Regel **ist im Wesentlichen eine Lambda-Funktion**, die bei Aufruf die Ressource bewertet und eine einfache Logik ausf√ºhrt, um das Compliance-Ergebnis mit der Regel zu bestimmen. **Jedes Mal, wenn eine √Ñnderung** an einer Ihrer unterst√ºtzten Ressourcen vorgenommen wird, **√ºberpr√ºft AWS Config die Compliance gegen alle Config-Regeln, die Sie eingerichtet haben**.\
AWS hat eine Reihe von **vordefinierten Regeln**, die unter das Sicherheitsdach fallen und einsatzbereit sind. Zum Beispiel Rds-storage-encrypted. Dies √ºberpr√ºft, ob die Speicher-Verschl√ºsselung durch Ihre RDS-Datenbankinstanzen aktiviert ist. Encrypted-volumes. Dies √ºberpr√ºft, ob alle EBS-Volumes, die einen angeh√§ngten Zustand haben, verschl√ºsselt sind.

* **AWS Managed Rules**: Satz vordefinierter Regeln, die viele Best Practices abdecken, daher lohnt es sich immer, diese Regeln zuerst zu durchsuchen, bevor Sie Ihre eigenen einrichten, da die Regel m√∂glicherweise bereits existiert.
* **Benutzerdefinierte Regeln**: Sie k√∂nnen Ihre eigenen Regeln erstellen, um spezifische benutzerdefinierte Konfigurationen zu √ºberpr√ºfen.

Limit von 50 Config-Regeln pro Region, bevor Sie AWS f√ºr eine Erh√∂hung kontaktieren m√ºssen.\
Nicht konforme Ergebnisse werden NICHT gel√∂scht.

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
