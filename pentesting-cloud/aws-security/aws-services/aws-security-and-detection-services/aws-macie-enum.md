# AWS - Macie Enum

## AWS - Macie Enum

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## Macie

Amazon Macie æ˜¯ä¸€é¡¹æ—¨åœ¨ **è‡ªåŠ¨æ£€æµ‹ã€åˆ†ç±»å’Œè¯†åˆ« AWS è´¦æˆ·å†…æ•°æ®** çš„æœåŠ¡ã€‚å®ƒåˆ©ç”¨ **æœºå™¨å­¦ä¹ ** æŒç»­ç›‘æ§å’Œåˆ†ææ•°æ®ï¼Œä¸»è¦å…³æ³¨é€šè¿‡æ£€æŸ¥ **äº‘è·Ÿè¸ªäº‹ä»¶** æ•°æ®å’Œç”¨æˆ·è¡Œä¸ºæ¨¡å¼æ¥æ£€æµ‹å’Œè­¦æŠ¥å¼‚å¸¸æˆ–å¯ç–‘æ´»åŠ¨ã€‚

Amazon Macie çš„ä¸»è¦åŠŸèƒ½ï¼š

1. **ä¸»åŠ¨æ•°æ®å®¡æŸ¥**ï¼šåˆ©ç”¨æœºå™¨å­¦ä¹ åœ¨ AWS è´¦æˆ·å†…å„ç§æ“ä½œå‘ç”Ÿæ—¶ä¸»åŠ¨å®¡æŸ¥æ•°æ®ã€‚
2. **å¼‚å¸¸æ£€æµ‹**ï¼šè¯†åˆ«ä¸è§„åˆ™æ´»åŠ¨æˆ–è®¿é—®æ¨¡å¼ï¼Œç”Ÿæˆè­¦æŠ¥ä»¥å‡è½»æ½œåœ¨çš„æ•°æ®æš´éœ²é£é™©ã€‚
3. **æŒç»­ç›‘æ§**ï¼šè‡ªåŠ¨ç›‘æ§å’Œæ£€æµ‹ Amazon S3 ä¸­çš„æ–°æ•°æ®ï¼Œåˆ©ç”¨æœºå™¨å­¦ä¹ å’Œäººå·¥æ™ºèƒ½éšç€æ—¶é—´çš„æ¨ç§»é€‚åº”æ•°æ®è®¿é—®æ¨¡å¼ã€‚
4. **ä½¿ç”¨ NLP è¿›è¡Œæ•°æ®åˆ†ç±»**ï¼šåˆ©ç”¨è‡ªç„¶è¯­è¨€å¤„ç† (NLP) å¯¹ä¸åŒæ•°æ®ç±»å‹è¿›è¡Œåˆ†ç±»å’Œè§£é‡Šï¼Œåˆ†é…é£é™©è¯„åˆ†ä»¥ä¼˜å…ˆå¤„ç†å‘ç°ã€‚
5. **å®‰å…¨ç›‘æ§**ï¼šè¯†åˆ«å®‰å…¨æ•æ„Ÿæ•°æ®ï¼ŒåŒ…æ‹¬ API å¯†é’¥ã€ç§˜å¯†å¯†é’¥å’Œä¸ªäººä¿¡æ¯ï¼Œå¸®åŠ©é˜²æ­¢æ•°æ®æ³„éœ²ã€‚

Amazon Macie æ˜¯ä¸€é¡¹ **åŒºåŸŸæ€§æœåŠ¡**ï¼Œéœ€è¦ 'AWSMacieServiceCustomerSetupRole' IAM è§’è‰²å’Œå¯ç”¨çš„ AWS CloudTrail æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚

### è­¦æŠ¥ç³»ç»Ÿ

Macie å°†è­¦æŠ¥åˆ†ç±»ä¸ºé¢„å®šä¹‰ç±»åˆ«ï¼Œå¦‚ï¼š

* åŒ¿åè®¿é—®
* æ•°æ®åˆè§„
* å‡­è¯ä¸¢å¤±
* æƒé™æå‡
* å‹’ç´¢è½¯ä»¶
* å¯ç–‘è®¿é—®ç­‰ã€‚

è¿™äº›è­¦æŠ¥æä¾›è¯¦ç»†æè¿°å’Œç»“æœç»†åˆ†ï¼Œä»¥ä¾¿æœ‰æ•ˆå“åº”å’Œè§£å†³ã€‚

### ä»ªè¡¨æ¿åŠŸèƒ½

ä»ªè¡¨æ¿å°†æ•°æ®åˆ†ç±»ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼ŒåŒ…æ‹¬ï¼š

* S3 å¯¹è±¡ï¼ˆæŒ‰æ—¶é—´èŒƒå›´ã€ACLã€PIIï¼‰
* é«˜é£é™© CloudTrail äº‹ä»¶/ç”¨æˆ·
* æ´»åŠ¨ä½ç½®
* CloudTrail ç”¨æˆ·èº«ä»½ç±»å‹ç­‰ã€‚

### ç”¨æˆ·åˆ†ç±»

ç”¨æˆ·æ ¹æ®å…¶ API è°ƒç”¨çš„é£é™©çº§åˆ«åˆ†ä¸ºä¸åŒå±‚çº§ï¼š

* **é“‚é‡‘**ï¼šé«˜é£é™© API è°ƒç”¨ï¼Œé€šå¸¸å…·æœ‰ç®¡ç†å‘˜æƒé™ã€‚
* **é»„é‡‘**ï¼šä¸åŸºç¡€è®¾æ–½ç›¸å…³çš„ API è°ƒç”¨ã€‚
* **ç™½é“¶**ï¼šä¸­é£é™© API è°ƒç”¨ã€‚
* **é’é“œ**ï¼šä½é£é™© API è°ƒç”¨ã€‚

### èº«ä»½ç±»å‹

èº«ä»½ç±»å‹åŒ…æ‹¬ Rootã€IAM ç”¨æˆ·ã€å‡è®¾è§’è‰²ã€è”åˆç”¨æˆ·ã€AWS è´¦æˆ·å’Œ AWS æœåŠ¡ï¼ŒæŒ‡ç¤ºè¯·æ±‚çš„æ¥æºã€‚

### æ•°æ®åˆ†ç±»

æ•°æ®åˆ†ç±»åŒ…æ‹¬ï¼š

* å†…å®¹ç±»å‹ï¼šåŸºäºæ£€æµ‹åˆ°çš„å†…å®¹ç±»å‹ã€‚
* æ–‡ä»¶æ‰©å±•åï¼šåŸºäºæ–‡ä»¶æ‰©å±•åã€‚
* ä¸»é¢˜ï¼šæ ¹æ®æ–‡ä»¶ä¸­çš„å…³é”®è¯è¿›è¡Œåˆ†ç±»ã€‚
* æ­£åˆ™è¡¨è¾¾å¼ï¼šæ ¹æ®ç‰¹å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼è¿›è¡Œåˆ†ç±»ã€‚

è¿™äº›ç±»åˆ«ä¸­æœ€é«˜çš„é£é™©å†³å®šæ–‡ä»¶çš„æœ€ç»ˆé£é™©çº§åˆ«ã€‚

### ç ”ç©¶ä¸åˆ†æ

Amazon Macie çš„ç ”ç©¶åŠŸèƒ½å…è®¸å¯¹æ‰€æœ‰ Macie æ•°æ®è¿›è¡Œè‡ªå®šä¹‰æŸ¥è¯¢ä»¥è¿›è¡Œæ·±å…¥åˆ†æã€‚è¿‡æ»¤å™¨åŒ…æ‹¬ CloudTrail æ•°æ®ã€S3 å­˜å‚¨æ¡¶å±æ€§å’Œ S3 å¯¹è±¡ã€‚æ­¤å¤–ï¼Œå®ƒæ”¯æŒé‚€è¯·å…¶ä»–è´¦æˆ·å…±äº« Amazon Macieï¼Œä¿ƒè¿›åä½œæ•°æ®ç®¡ç†å’Œå®‰å…¨ç›‘æ§ã€‚

### æšä¸¾
```
# Get buckets
aws macie2 describe-buckets

# Org config
aws macie2 describe-organization-configuration

# Get admin account (if any)
aws macie2 get-administrator-account
aws macie2 list-organization-admin-accounts # Run from the management account of the org

# Get macie account members (run this form the admin account)
aws macie2 list-members

# Check if automated sensitive data discovey is enabled
aws macie2 get-automated-discovery-configuration

# Get findings
aws macie2 list-findings
aws macie2 get-findings --finding-ids <ids>
aws macie2 list-findings-filters
aws macie2 get -findings-filters --id <id>

# Get allow lists
aws macie2 list-allow-lists
aws macie2 get-allow-list --id <id>

# Get different info
aws macie2 list-classification-jobs
aws macie2 list-classification-scopes
aws macie2 list-custom-data-identifiers
```
#### åæœŸåˆ©ç”¨

{% hint style="success" %}
ä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œè¿™é¡¹æœåŠ¡å¹¶ä¸æ˜¯ä¸ºäº†æ£€æµ‹æ”»å‡»è€…ï¼Œè€Œæ˜¯ä¸ºäº†æ£€æµ‹å­˜å‚¨æ–‡ä»¶ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚å› æ­¤ï¼Œè¿™é¡¹æœåŠ¡å¯èƒ½**å¸®åŠ©æ”»å‡»è€…åœ¨å­˜å‚¨æ¡¶ä¸­æ‰¾åˆ°æ•æ„Ÿä¿¡æ¯**ã€‚\
ç„¶è€Œï¼Œæ”»å‡»è€…ä¹Ÿå¯èƒ½å¯¹å¹²æ‰°è¯¥æœåŠ¡æ„Ÿå…´è¶£ï¼Œä»¥é˜²æ­¢å—å®³è€…æ”¶åˆ°è­¦æŠ¥ï¼Œä»è€Œæ›´å®¹æ˜“çªƒå–è¯¥ä¿¡æ¯ã€‚
{% endhint %}

TODO: æ¬¢è¿æäº¤PRï¼

## å‚è€ƒæ–‡çŒ®

* [https://cloudacademy.com/blog/introducing-aws-security-hub/](https://cloudacademy.com/blog/introducing-aws-security-hub/)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
