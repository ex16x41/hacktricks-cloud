# AWS - CloudWatch Enum

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## CloudWatch

**CloudWatch**, **AWS kaynaklarÄ±**, uygulamalarÄ± ve hizmetleri iÃ§in **birleÅŸik bir gÃ¶rÃ¼nÃ¼m** saÄŸlayarak gÃ¼nlÃ¼kler/Ã¶lÃ§Ã¼mler/olaylar biÃ§iminde izleme ve operasyonel **veri toplar**.\
CloudWatch Log OlaylarÄ±nÄ±n **her gÃ¼nlÃ¼k satÄ±rÄ± iÃ§in 256KB boyut sÄ±nÄ±rlamasÄ±** vardÄ±r.\
YÃ¼ksek Ã§Ã¶zÃ¼nÃ¼rlÃ¼klÃ¼ alarmlar ayarlayabilir, **gÃ¼nlÃ¼kleri** ve **Ã¶lÃ§Ã¼mleri** yan yana gÃ¶rselleÅŸtirebilir, otomatik eylemler alabilir, sorunlarÄ± giderebilir ve uygulamalarÄ± optimize etmek iÃ§in iÃ§gÃ¶rÃ¼ler keÅŸfedebilirsiniz.

Ã–rneÄŸin CloudTrail'den gÃ¼nlÃ¼kleri izleyebilirsiniz. Ä°zlenen olaylar:

* GÃ¼venlik GruplarÄ± ve NACL'lerdeki deÄŸiÅŸiklikler
* EC2 Ã¶rneklerini baÅŸlatma, durdurma, yeniden baÅŸlatma ve sonlandÄ±rma
* IAM ve S3 iÃ§indeki GÃ¼venlik PolitikalarÄ±ndaki deÄŸiÅŸiklikler
* AWS YÃ¶netim Konsolu'na yapÄ±lan baÅŸarÄ±sÄ±z giriÅŸim denemeleri
* BaÅŸarÄ±sÄ±z yetkilendirme ile sonuÃ§lanan API Ã§aÄŸrÄ±larÄ±
* CloudWatch'ta arama yapmak iÃ§in filtreler: [https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html)

## Anahtar kavramlar

### Ad AlanlarÄ±

Bir ad alanÄ±, CloudWatch Ã¶lÃ§Ã¼mleri iÃ§in bir konteynÄ±rdÄ±r. Ã–lÃ§Ã¼mleri kategorize etmeye ve izole etmeye yardÄ±mcÄ± olur, bÃ¶ylece yÃ¶netim ve analiz daha kolay hale gelir.

* **Ã–rnekler**: EC2 ile ilgili Ã¶lÃ§Ã¼mler iÃ§in AWS/EC2, RDS Ã¶lÃ§Ã¼mleri iÃ§in AWS/RDS.

### Ã–lÃ§Ã¼mler

Ã–lÃ§Ã¼mler, AWS kaynaklarÄ±nÄ±n performansÄ±nÄ± veya kullanÄ±mÄ±nÄ± temsil eden zaman iÃ§inde toplanan veri noktalarÄ±dÄ±r. Ã–lÃ§Ã¼mler, AWS hizmetlerinden, Ã¶zel uygulamalardan veya Ã¼Ã§Ã¼ncÃ¼ taraf entegrasyonlardan toplanabilir.

* **Ã–rnek**: CPUUtilization, NetworkIn, DiskReadOps.

### Boyutlar

Boyutlar, Ã¶lÃ§Ã¼mlerin bir parÃ§asÄ± olan anahtar-deÄŸer Ã§iftleridir. Bir Ã¶lÃ§Ã¼mÃ¼ benzersiz bir ÅŸekilde tanÄ±mlamaya yardÄ±mcÄ± olur ve ek baÄŸlam saÄŸlar; bir Ã¶lÃ§Ã¼mle iliÅŸkilendirilebilecek en fazla boyut sayÄ±sÄ± 30'dur. Boyutlar ayrÄ±ca belirli Ã¶zelliklere dayalÄ± olarak Ã¶lÃ§Ã¼mleri filtrelemeye ve birleÅŸtirmeye olanak tanÄ±r.

* **Ã–rnek**: EC2 Ã¶rnekleri iÃ§in boyutlar InstanceId, InstanceType ve AvailabilityZone'u iÃ§erebilir.

### Ä°statistikler

Ä°statistikler, zaman iÃ§inde Ã¶lÃ§Ã¼m verileri Ã¼zerinde yapÄ±lan matematiksel hesaplamalardÄ±r. YaygÄ±n istatistikler arasÄ±nda Ortalama, Toplam, Minimum, Maksimum ve Ã–rnek SayÄ±sÄ± bulunur.

* **Ã–rnek**: Bir saatlik bir sÃ¼re boyunca ortalama CPU kullanÄ±mÄ±nÄ± hesaplama.

### Birimler

Birimler, bir Ã¶lÃ§Ã¼mle iliÅŸkili Ã¶lÃ§Ã¼m tÃ¼rÃ¼dÃ¼r. Birimler, Ã¶lÃ§Ã¼m verilerine baÄŸlam ve anlam saÄŸlamaya yardÄ±mcÄ± olur. YaygÄ±n birimler arasÄ±nda YÃ¼zde, Bayt, Saniye, SayÄ±m bulunur.

* **Ã–rnek**: CPUUtilization YÃ¼zde olarak Ã¶lÃ§Ã¼lÃ¼rken, NetworkIn Bayt olarak Ã¶lÃ§Ã¼lebilir.

## CloudWatch Ã–zellikleri

### GÃ¶sterge Paneli

**CloudWatch GÃ¶sterge Panelleri**, AWS CloudWatch Ã¶lÃ§Ã¼mlerinizi Ã¶zelleÅŸtirilebilir **gÃ¶rÃ¼nÃ¼mler** saÄŸlar. FarklÄ± AWS hizmetlerinden Ã§eÅŸitli Ã¶lÃ§Ã¼mleri birleÅŸtirerek verileri gÃ¶rselleÅŸtirmek ve kaynaklarÄ± tek bir gÃ¶rÃ¼nÃ¼mde izlemek iÃ§in gÃ¶sterge panelleri oluÅŸturup yapÄ±landÄ±rmak mÃ¼mkÃ¼ndÃ¼r.

**Ana Ã–zellikler**:

* **Widget'lar**: Grafikler, metinler, alarmlar ve daha fazlasÄ±nÄ± iÃ§eren gÃ¶sterge panellerinin yapÄ± taÅŸlarÄ±.
* **Ã–zelleÅŸtirme**: DÃ¼zen ve iÃ§erik, belirli izleme ihtiyaÃ§larÄ±na gÃ¶re Ã¶zelleÅŸtirilebilir.

**Ã–rnek KullanÄ±m Durumu**:

* EC2 Ã¶rnekleri, RDS veritabanlarÄ± ve S3 kovalarÄ± dahil olmak Ã¼zere tÃ¼m AWS ortamÄ±nÄ±z iÃ§in anahtar Ã¶lÃ§Ã¼mleri gÃ¶steren tek bir gÃ¶sterge paneli.

### Ã–lÃ§Ã¼m AkÄ±ÅŸÄ± ve Ã–lÃ§Ã¼m Verisi

AWS CloudWatch'taki **Ã–lÃ§Ã¼m AkÄ±ÅŸlarÄ±**, CloudWatch Ã¶lÃ§Ã¼mlerinizi seÃ§tiÄŸiniz bir hedefe sÃ¼rekli olarak akÄ±tmanÄ±za olanak tanÄ±r. Bu, AWS dÄ±ÅŸÄ±ndaki araÃ§lar kullanarak geliÅŸmiÅŸ izleme, analiz ve Ã¶zel gÃ¶sterge panelleri iÃ§in Ã¶zellikle yararlÄ±dÄ±r.

**Ã–lÃ§Ã¼m Verisi**, Ã–lÃ§Ã¼m AkÄ±ÅŸlarÄ± iÃ§indeki gerÃ§ek Ã¶lÃ§Ã¼mler veya akÄ±tÄ±lan veri noktalarÄ±nÄ± ifade eder. Bu veri noktalarÄ±, AWS kaynaklarÄ± iÃ§in CPU kullanÄ±mÄ±, bellek kullanÄ±mÄ± vb. gibi Ã§eÅŸitli Ã¶lÃ§Ã¼mleri temsil eder.

**Ã–rnek KullanÄ±m Durumu**:

* GeliÅŸmiÅŸ analiz iÃ§in gerÃ§ek zamanlÄ± Ã¶lÃ§Ã¼mleri Ã¼Ã§Ã¼ncÃ¼ taraf bir izleme hizmetine gÃ¶nderme.
* Uzun vadeli depolama ve uyumluluk iÃ§in bir Amazon S3 kovasÄ±nda Ã¶lÃ§Ã¼mleri arÅŸivleme.

### Alarm

**CloudWatch AlarmlarÄ±**, Ã¶lÃ§Ã¼mlerinizi izler ve Ã¶nceden tanÄ±mlanmÄ±ÅŸ eÅŸiklere dayalÄ± olarak eylemler gerÃ§ekleÅŸtirir. Bir Ã¶lÃ§Ã¼m bir eÅŸiÄŸi aÅŸarsa, alarm bir veya daha fazla eylem gerÃ§ekleÅŸtirebilir, Ã¶rneÄŸin SNS aracÄ±lÄ±ÄŸÄ±yla bildirim gÃ¶ndermek, otomatik Ã¶lÃ§eklendirme politikasÄ±nÄ± tetiklemek veya bir AWS Lambda iÅŸlevi Ã§alÄ±ÅŸtÄ±rmak.

**Ana BileÅŸenler**:

* **EÅŸik**: AlarmÄ±n tetiklendiÄŸi deÄŸer.
* **DeÄŸerlendirme DÃ¶nemleri**: Verilerin deÄŸerlendirildiÄŸi dÃ¶nem sayÄ±sÄ±.
* **Alarm iÃ§in Veri NoktalarÄ±**: AlarmÄ± tetiklemek iÃ§in gereken ulaÅŸÄ±lmÄ±ÅŸ eÅŸik sayÄ±sÄ±.
* **Eylemler**: Bir alarm durumu tetiklendiÄŸinde ne olacaÄŸÄ± (Ã¶rneÄŸin, SNS aracÄ±lÄ±ÄŸÄ±yla bildirim gÃ¶nderme).

**Ã–rnek KullanÄ±m Durumu**:

* EC2 Ã¶rneÄŸi CPU kullanÄ±mÄ±nÄ± izleme ve 5 ardÄ±ÅŸÄ±k dakika boyunca %80'i aÅŸarsa SNS aracÄ±lÄ±ÄŸÄ±yla bildirim gÃ¶nderme.

### Anomali Tespit CihazlarÄ±

**Anomali Tespit CihazlarÄ±**, Ã¶lÃ§Ã¼mlerinizde otomatik olarak anormallikleri tespit etmek iÃ§in makine Ã¶ÄŸrenimini kullanÄ±r. Anomali tespiti, sorunlarÄ± gÃ¶sterebilecek normal desenlerden sapmalarÄ± tanÄ±mlamak iÃ§in herhangi bir CloudWatch Ã¶lÃ§Ã¼mÃ¼ne uygulanabilir.

**Ana BileÅŸenler**:

* **Model EÄŸitimi**: CloudWatch, normal davranÄ±ÅŸÄ±n neye benzediÄŸini belirlemek iÃ§in geÃ§miÅŸ verileri kullanarak bir model eÄŸitir.
* **Anomali Tespit BandÄ±**: Bir Ã¶lÃ§Ã¼m iÃ§in beklenen deÄŸer aralÄ±ÄŸÄ±nÄ± gÃ¶rsel olarak temsil eder.

**Ã–rnek KullanÄ±m Durumu**:

* Bir EC2 Ã¶rneÄŸinde gÃ¼venlik ihlali veya uygulama sorunu gÃ¶sterebilecek olaÄŸandÄ±ÅŸÄ± CPU kullanÄ±m desenlerini tespit etme.

### Ä°Ã§gÃ¶rÃ¼ KurallarÄ± ve YÃ¶netilen Ä°Ã§gÃ¶rÃ¼ KurallarÄ±

**Ä°Ã§gÃ¶rÃ¼ KurallarÄ±**, Ã¶lÃ§Ã¼m verilerinizdeki eÄŸilimleri tanÄ±mlamanÄ±za, zirveleri tespit etmenize veya ilgi Ã§ekici diÄŸer desenleri belirlemenize olanak tanÄ±r; bu, eylemlerin alÄ±nmasÄ± gereken koÅŸullarÄ± tanÄ±mlamak iÃ§in **gÃ¼Ã§lÃ¼ matematiksel ifadeler** kullanÄ±r. Bu kurallar, kaynak performansÄ±nÄ±zda ve kullanÄ±mÄ±nÄ±zda anormallikleri veya olaÄŸandÄ±ÅŸÄ± davranÄ±ÅŸlarÄ± tanÄ±mlamanÄ±za yardÄ±mcÄ± olabilir.

**YÃ¶netilen Ä°Ã§gÃ¶rÃ¼ KurallarÄ±**, AWS tarafÄ±ndan saÄŸlanan Ã¶nceden yapÄ±landÄ±rÄ±lmÄ±ÅŸ **iÃ§gÃ¶rÃ¼ kurallarÄ±dÄ±r**. Belirli AWS hizmetlerini veya yaygÄ±n kullanÄ±m durumlarÄ±nÄ± izlemek iÃ§in tasarlanmÄ±ÅŸtÄ±r ve ayrÄ±ntÄ±lÄ± yapÄ±landÄ±rma gerektirmeden etkinleÅŸtirilebilir.

**Ã–rnek KullanÄ±m Durumu**:

* RDS PerformansÄ±nÄ± Ä°zleme: CPU kullanÄ±mÄ±, bellek kullanÄ±mÄ± ve disk I/O gibi anahtar performans gÃ¶stergelerini izleyen Amazon RDS iÃ§in yÃ¶netilen bir iÃ§gÃ¶rÃ¼ kuralÄ±nÄ± etkinleÅŸtirme. Bu Ã¶lÃ§Ã¼mlerden herhangi biri gÃ¼venli operasyonel eÅŸikleri aÅŸarsa, kural bir uyarÄ± veya otomatik hafifletme eylemi tetikleyebilir.

### CloudWatch GÃ¼nlÃ¼kleri <a href="#cloudwatch-logs" id="cloudwatch-logs"></a>

**Uygulamalardan** ve **sistemlerden** (CloudTrail dahil) **AWS hizmetlerinden** gÃ¼nlÃ¼kleri **toplayÄ±p izlemeye** olanak tanÄ±r ve **uygulamalar/sistemler** (CloudWatch Agent bir hosta kurulabilir). GÃ¼nlÃ¼kler **sÃ¼resiz olarak saklanabilir** (GÃ¼nlÃ¼k Grubu ayarlarÄ±na baÄŸlÄ± olarak) ve dÄ±ÅŸa aktarÄ±labilir.

**Ã–ÄŸeler**:

| **GÃ¼nlÃ¼k Grubu**        | AynÄ± saklama, izleme ve eriÅŸim kontrol ayarlarÄ±nÄ± paylaÅŸan bir **gÃ¼nlÃ¼k akÄ±ÅŸlarÄ± koleksiyonu**                                                      |
| ------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GÃ¼nlÃ¼k AkÄ±ÅŸÄ±**        | **aynÄ± kaynaktan** gelen **gÃ¼nlÃ¼k olaylarÄ±** dizisi                                                                                                   |
| **Abonelik Filtreleri** | Belirli bir gÃ¼nlÃ¼k grubundaki olaylarÄ± eÅŸleÅŸtiren bir **filtre deseni tanÄ±mlar**, bunlarÄ± Kinesis Data Firehose akÄ±ÅŸÄ±na, Kinesis akÄ±ÅŸÄ±na veya bir Lambda iÅŸlevine gÃ¶nderir |

### CloudWatch Ä°zleme & Olaylar

CloudWatch **temel** verileri **her 5 dakikada** toplar (**detaylÄ±** olanÄ± **her 1 dakikada** yapar). Toplamadan sonra, bir alarmÄ± tetiklemek iÃ§in eÅŸikleri **kontrol eder**.\
Bu durumda, CloudWatch bir olayÄ± gÃ¶ndermeye ve bazÄ± otomatik eylemleri gerÃ§ekleÅŸtirmeye (AWS lambda iÅŸlevleri, SNS konularÄ±, SQS kuyruklarÄ±, Kinesis AkÄ±ÅŸlarÄ±) hazÄ±rlanabilir.

### Agent Kurulumu

GÃ¼nlÃ¼kleri otomatik olarak CloudWatch'a geri gÃ¶ndermek iÃ§in makinelerinizde/konteynerlerinizde ajanlar kurabilirsiniz.

* **Bir** **rol oluÅŸturun** ve **Ã¶rneÄŸi** CloudWatch'un Ã¶rneklerden veri toplamasÄ±na izin veren izinlerle **baÄŸlayÄ±n**; ayrÄ±ca AWS sistem yÃ¶neticisi SSM ile etkileÅŸimde bulunma (CloudWatchAgentAdminPolicy & AmazonEC2RoleforSSM)
* **AjanÄ±** EC2 Ã¶rneÄŸine **indirin** ve **kurun** ([https://s3.amazonaws.com/amazoncloudwatch-agent/linux/amd64/latest/AmazonCloudWatchAgent.zip](https://s3.amazonaws.com/amazoncloudwatch-agent/linux/amd64/latest/AmazonCloudWatchAgent.zip)). Bunu EC2 iÃ§inden indirebilir veya AWS Sistem YÃ¶neticisi kullanarak otomatik olarak AWS-ConfigureAWSPackage paketini seÃ§erek kurabilirsiniz.
* CloudWatch Agent'Ä± **yapÄ±landÄ±rÄ±n** ve **baÅŸlatÄ±n**.

Bir gÃ¼nlÃ¼k grubunun birÃ§ok akÄ±ÅŸÄ± vardÄ±r. Bir akÄ±ÅŸÄ±n birÃ§ok olayÄ± vardÄ±r. Ve her akÄ±ÅŸÄ±n iÃ§inde, olaylarÄ±n sÄ±ralÄ± olmasÄ± garanti edilir.

## Enumeration
```bash
# Dashboards #

## Returns a list of the dashboards of your account
aws cloudwatch list-dashboards

## Retrieves the details of the specified dashboard
aws cloudwatch get-dashboard --dashboard-name <value>

# Metrics #

## Returns a list of the specified metric
aws cloudwatch list-metrics [--namespace <value>] [--metric-name <value>] [--dimensions <value>] [--include-linked-accounts | --no-include-linked-accounts]

## Retrieves metric data (this operation can include a CloudWatch Metrics Insights query, and one or more metric math functions)
aws cloudwatch get-metric-data --metric-data-queries <value> --start-time <value> --end-time <value>

## Retrieves statistics for the specified metric and namespace over a range of time
aws cloudwatch get-metric-statistics --namespace <value> --metric-name <value> [--dimensions <value>] --start-time <value> --end-time <value> --period <value>

## Returns a list of the metric streams of your account
aws cloudwatch list-metric-streams

## Retrieves information about the specified metric stream
aws cloudwatch get-metric-stream --name <value>

## Retrieve snapshots of the specified metric widgets
aws cloudwatch get-metric-widget-image --metric-widget <value>

# Alarms #

## Retrieves the specified alarm
aws cloudwatch describe-alarms [--alarm-names <value>] [--alarm-name-prefix <value>] [--alarm-types <value>] [--state-value <value>]

## Retrieves the alarms history, even for deleted alarms
aws cloudwatch describe-alarm-history [--alarm-name <value>] [--alarm-types <value>] [--history-item-type <ConfigurationUpdate | StateUpdate | Action>] [--start-date <value>] [--end-date <value>]

## Retrieves standard alarms based on the specified metric
aws cloudwatch escribe-alarms-for-metric --metric-name <value> --namespace <value> [--dimensions <value>]

# Anomaly Detections #

## Lists the anomaly detection models that you have created in your account
aws cloudwatch describe-anomaly-detectors [--namespace <value>] [--metric-name <value>] [--dimensions <value>]

## Lists all the Contributor Insight rules in your account
aws cloudwatch describe-insight-rules

## Retrieves the data collected over a time range for a given Contributor Insight rule
aws cloudwatch get-insight-rule-report --rule-name <value> --start-time <value> --end-time <value> --period <value>

## Lists managed Contributor Insights rules in your account for a specified resource
aws cloudwatch list-managed-insight-rules --resource-arn <value>

# Tags #

## Lists the tags associated with the specified CloudWatch resources
aws cloudwatch list-tags-for-resource --resource-arn <value>

# CloudWatch Logs #
aws logs tail "<log_group_name>" --followaws logs get-log-events --log-group-name "<log_group_name>" --log-stream-name "<log_stream_name>" --output text > <output_file>

# CloudWatch Events #
aws events list-rules
aws events describe-rule --name <name>aws events list-targets-by-rule --rule <name>aws events list-archives
aws events describe-archive --archive-name <name>aws events list-connections
aws events describe-connection --name <name>aws events list-endpoints
aws events describe-endpoint --name <name>aws events list-event-sources
aws events describe-event-source --name <name>aws events list-replays
aws events list-api-destinations
aws events list-event-buses
```
## Post-Exploitation / Bypass

### **`cloudwatch:DeleteAlarms`,`cloudwatch:PutMetricAlarm` , `cloudwatch:PutCompositeAlarm`**

Bu izinlere sahip bir saldÄ±rgan, bir organizasyonun izleme ve uyarÄ± altyapÄ±sÄ±nÄ± Ã¶nemli Ã¶lÃ§Ã¼de zayÄ±flatabilir. Mevcut alarmlarÄ± silerek, bir saldÄ±rgan kritik performans sorunlarÄ±, gÃ¼venlik ihlalleri veya operasyonel hatalar hakkÄ±nda yÃ¶neticileri bilgilendiren Ã¶nemli uyarÄ±larÄ± devre dÄ±ÅŸÄ± bÄ±rakabilir. AyrÄ±ca, metrik alarmlarÄ±nÄ± oluÅŸturarak veya deÄŸiÅŸtirerek, saldÄ±rgan yÃ¶neticileri yanlÄ±ÅŸ uyarÄ±larla yanÄ±ltabilir veya meÅŸru alarmlarÄ± susturarak, kÃ¶tÃ¼ niyetli faaliyetleri etkili bir ÅŸekilde gizleyebilir ve gerÃ§ek olaylara zamanÄ±nda yanÄ±t verilmesini engelleyebilir.

AyrÄ±ca, **`cloudwatch:PutCompositeAlarm`** izni ile, bir saldÄ±rgan, bileÅŸik alarm A'nÄ±n bileÅŸik alarm B'ye, bileÅŸik alarm B'nin de bileÅŸik alarm A'ya baÄŸlÄ± olduÄŸu bir dÃ¶ngÃ¼ veya dÃ¶ngÃ¼ oluÅŸturma yeteneÄŸine sahip olacaktÄ±r. Bu senaryoda, dÃ¶ngÃ¼nÃ¼n bir parÃ§asÄ± olan herhangi bir bileÅŸik alarmÄ± silmek mÃ¼mkÃ¼n deÄŸildir Ã§Ã¼nkÃ¼ silmek istediÄŸiniz alarmla her zaman baÄŸlÄ± olan bir bileÅŸik alarm vardÄ±r.
```bash
aws cloudwatch put-metric-alarm --cli-input-json <value> | --alarm-name <value> --comparison-operator <value> --evaluation-periods <value> [--datapoints-to-alarm <value>] [--threshold <value>] [--alarm-description <value>] [--alarm-actions <value>] [--metric-name <value>] [--namespace <value>] [--statistic <value>] [--dimensions <value>] [--period <value>]
aws cloudwatch delete-alarms --alarm-names <value>
aws cloudwatch put-composite-alarm --alarm-name <value> --alarm-rule <value> [--no-actions-enabled | --actions-enabled [--alarm-actions <value>] [--insufficient-data-actions <value>] [--ok-actions <value>] ]
```
AÅŸaÄŸÄ±daki Ã¶rnek, bir metrik alarmÄ±nÄ± etkisiz hale getirmenin nasÄ±l yapÄ±lacaÄŸÄ±nÄ± gÃ¶stermektedir:

* Bu metrik alarmÄ±, belirli bir EC2 Ã¶rneÄŸinin ortalama CPU kullanÄ±mÄ±nÄ± izler, metriÄŸi her 300 saniyede bir deÄŸerlendirir ve 6 deÄŸerlendirme dÃ¶nemi gerektirir (toplam 30 dakika). EÄŸer ortalama CPU kullanÄ±mÄ± bu dÃ¶nemlerin en az 4'Ã¼nde %60'Ä± aÅŸarsa, alarm tetiklenecek ve belirtilen SNS konusuna bir bildirim gÃ¶nderecektir.
* EÅŸiÄŸi %99'dan fazla olacak ÅŸekilde deÄŸiÅŸtirerek, Periyodu 10 saniye, DeÄŸerlendirme DÃ¶nemlerini 8640 (Ã§Ã¼nkÃ¼ 8640 dÃ¶nem 10 saniye, 1 gÃ¼ne eÅŸittir) ve Alarm iÃ§in Veri NoktalarÄ±nÄ± da 8640 olarak ayarlayarak, CPU kullanÄ±mÄ±nÄ±n alarmÄ± tetiklemek iÃ§in 24 saat boyunca her 10 saniyede bir %99'un Ã¼zerinde olmasÄ± gerekecektir.

{% tabs %}
{% tab title="Original Metric Alarm" %}
```json
{
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-01234567890123456"
}
],
"AlarmActions": [
"arn:aws:sns:us-east-1:123456789012:example_sns"
],
"ComparisonOperator": "GreaterThanThreshold",
"DatapointsToAlarm": 4,
"EvaluationPeriods": 6,
"Period": 300,
"Statistic": "Average",
"Threshold": 60,
"AlarmDescription": "CPU Utilization of i-01234567890123456 over 60%",
"AlarmName": "EC2 instance i-01234567890123456 CPU Utilization"
}
```
{% endtab %}

{% tab title="DeÄŸiÅŸtirilmiÅŸ Metri AlarmÄ±" %}
```json
{
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-0645d6d414dadf9f8"
}
],
"AlarmActions": [],
"ComparisonOperator": "GreaterThanThreshold",
"DatapointsToAlarm": 8640,
"EvaluationPeriods": 8640,
"Period": 10,
"Statistic": "Average",
"Threshold": 99,
"AlarmDescription": "CPU Utilization of i-01234567890123456 with 60% as threshold",
"AlarmName": "Instance i-0645d6d414dadf9f8 CPU Utilization"
}

```
{% endtab %}
{% endtabs %}

**Potansiyel Etki**: Kritik olaylar iÃ§in bildirim eksikliÄŸi, potansiyel olarak tespit edilemeyen sorunlar, yanlÄ±ÅŸ alarmlar, gerÃ§ek alarmlarÄ± bastÄ±rma ve gerÃ§ek olaylarÄ±n tespit edilmesinin potansiyel olarak kaÃ§Ä±rÄ±lmasÄ±.

### **`cloudwatch:DeleteAlarmActions`, `cloudwatch:EnableAlarmActions` , `cloudwatch:SetAlarmState`**

Alarm eylemlerini silerek, saldÄ±rgan kritik uyarÄ±larÄ±n ve otomatik yanÄ±tlarÄ±n tetiklenmesini engelleyebilir; bu, bir alarm durumu ulaÅŸÄ±ldÄ±ÄŸÄ±nda yÃ¶neticileri bilgilendirmek veya otomatik Ã¶lÃ§eklendirme faaliyetlerini baÅŸlatmak gibi durumlarÄ± iÃ§erir. Alarm eylemlerini uygunsuz bir ÅŸekilde etkinleÅŸtirmek veya yeniden etkinleÅŸtirmek, daha Ã¶nce devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸ eylemleri yeniden etkinleÅŸtirerek veya hangi eylemlerin tetiklendiÄŸini deÄŸiÅŸtirerek beklenmedik davranÄ±ÅŸlara yol aÃ§abilir; bu da olay yanÄ±tÄ±nda kafa karÄ±ÅŸÄ±klÄ±ÄŸÄ± ve yanlÄ±ÅŸ yÃ¶nlendirmeye neden olabilir.

AyrÄ±ca, bu izne sahip bir saldÄ±rgan alarm durumlarÄ±nÄ± manipÃ¼le edebilir, yÃ¶neticileri oyalamak ve kafa karÄ±ÅŸtÄ±rmak iÃ§in sahte alarmlar oluÅŸturabilir veya devam eden kÃ¶tÃ¼ niyetli faaliyetleri veya kritik sistem arÄ±zalarÄ±nÄ± gizlemek iÃ§in gerÃ§ek alarmlarÄ± susturabilir.

* EÄŸer bir bileÅŸik alarmda **`SetAlarmState`** kullanÄ±rsanÄ±z, bileÅŸik alarmÄ±n gerÃ§ek durumuna geri dÃ¶nmesi garanti edilmez. GerÃ§ek durumuna yalnÄ±zca Ã§ocuk alarmlarÄ±ndan herhangi biri durum deÄŸiÅŸtirirse geri dÃ¶ner. AyrÄ±ca, yapÄ±landÄ±rmasÄ±nÄ± gÃ¼ncellediÄŸinizde yeniden deÄŸerlendirilir.
```bash
aws cloudwatch disable-alarm-actions --alarm-names <value>
aws cloudwatch enable-alarm-actions --alarm-names <value>
aws cloudwatch set-alarm-state --alarm-name <value> --state-value <OK | ALARM | INSUFFICIENT_DATA> --state-reason <value> [--state-reason-data <value>]
```
**Potansiyel Etki**: Kritik olaylar iÃ§in bildirim eksikliÄŸi, potansiyel olarak tespit edilemeyen sorunlar, yanlÄ±ÅŸ alarmlar, gerÃ§ek alarmlarÄ± bastÄ±rma ve gerÃ§ek olaylarÄ±n tespit edilmesinin potansiyel olarak kaÃ§Ä±rÄ±lmasÄ±.

### **`cloudwatch:DeleteAnomalyDetector`, `cloudwatch:PutAnomalyDetector`**

Bir saldÄ±rgan, metrik verilerdeki olaÄŸandÄ±ÅŸÄ± desenleri veya anormallikleri tespit etme ve bunlara yanÄ±t verme yeteneÄŸini tehlikeye atabilir. Mevcut anomali dedektÃ¶rlerini silerek, bir saldÄ±rgan kritik uyarÄ± mekanizmalarÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakabilir; ve bunlarÄ± oluÅŸturarak veya deÄŸiÅŸtirerek, izlemeyi dikkatini daÄŸÄ±tmak veya aÅŸÄ±rÄ± yÃ¼klemek amacÄ±yla yanlÄ±ÅŸ yapÄ±landÄ±rabilir veya yanlÄ±ÅŸ pozitifler oluÅŸturabilir.
```bash
aws cloudwatch delete-anomaly-detector [--cli-input-json <value> | --namespace <value> --metric-name <value> --dimensions <value> --stat <value>]
aws cloudwatch put-anomaly-detector [--cli-input-json <value> | --namespace <value> --metric-name <value> --dimensions <value> --stat <value> --configuration <value> --metric-characteristics <value>]
```
AÅŸaÄŸÄ±daki Ã¶rnek, bir metrik anomali dedektÃ¶rÃ¼nÃ¼ etkisiz hale getirmenin nasÄ±l yapÄ±lacaÄŸÄ±nÄ± gÃ¶stermektedir. Bu metrik anomali dedektÃ¶rÃ¼, belirli bir EC2 Ã¶rneÄŸinin ortalama CPU kullanÄ±mÄ±nÄ± izler ve yalnÄ±zca istenen zaman aralÄ±ÄŸÄ± ile â€œExcludedTimeRangesâ€ parametresini eklemek, anomali dedektÃ¶rÃ¼nÃ¼n o sÃ¼re zarfÄ±nda ilgili verileri analiz etmemesini veya uyarÄ± vermemesini saÄŸlamak iÃ§in yeterlidir.

{% tabs %}
{% tab title="Orijinal Metrik Anomali DedektÃ¶rÃ¼" %}
```json
{
"SingleMetricAnomalyDetector": {
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Stat": "Average",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-0123456789abcdefg"
}
]
}
}
```
{% endtab %}

{% tab title="DeÄŸiÅŸtirilmiÅŸ MetriÌ‡k AnomaliÌ‡ TespitÃ§iÌ‡siÌ‡" %}
```json
{
"SingleMetricAnomalyDetector": {
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Stat": "Average",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-0123456789abcdefg"
}
]
},
"Configuration": {
"ExcludedTimeRanges": [
{
"StartTime": "2023-01-01T00:00:00Z",
"EndTime": "2053-01-01T23:59:59Z"
}
],
"Timezone": "Europe/Madrid"
}
}
```
{% endtab %}
{% endtabs %}

**OlasÄ± Etki**: SÄ±radÄ±ÅŸÄ± desenlerin veya gÃ¼venlik tehditlerinin tespitinde doÄŸrudan etki.

### **`cloudwatch:DeleteDashboards`, `cloudwatch:PutDashboard`**

Bir saldÄ±rgan, organizasyonun izleme ve gÃ¶rselleÅŸtirme yeteneklerini, panolarÄ±nÄ± oluÅŸturarak, deÄŸiÅŸtirerek veya silerek tehlikeye atabilir. Bu izinler, sistemlerin performansÄ± ve saÄŸlÄ±ÄŸÄ± hakkÄ±nda kritik gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼ kaldÄ±rmak, panolarÄ± yanlÄ±ÅŸ veriler gÃ¶sterecek ÅŸekilde deÄŸiÅŸtirmek veya kÃ¶tÃ¼ niyetli faaliyetleri gizlemek iÃ§in kullanÄ±labilir.
```bash
aws cloudwatch delete-dashboards --dashboard-names <value>
aws cloudwatch put-dashboard --dashboard-name <value> --dashboard-body <value>
```
**Potansiyel Etki**: Ä°zleme gÃ¶rÃ¼nÃ¼rlÃ¼ÄŸÃ¼nÃ¼n kaybÄ± ve yanÄ±ltÄ±cÄ± bilgiler.

### **`cloudwatch:DeleteInsightRules`, `cloudwatch:PutInsightRule` ,`cloudwatch:PutManagedInsightRule`**

Insight kurallarÄ± anormallikleri tespit etmek, performansÄ± optimize etmek ve kaynaklarÄ± etkili bir ÅŸekilde yÃ¶netmek iÃ§in kullanÄ±lÄ±r. Mevcut insight kurallarÄ±nÄ± silerek, bir saldÄ±rgan kritik izleme yeteneklerini ortadan kaldÄ±rabilir ve sistemi performans sorunlarÄ± ve gÃ¼venlik tehditlerine karÅŸÄ± kÃ¶r bÄ±rakabilir. AyrÄ±ca, bir saldÄ±rgan yanÄ±ltÄ±cÄ± veriler oluÅŸturmak veya kÃ¶tÃ¼ niyetli faaliyetleri gizlemek iÃ§in insight kurallarÄ±nÄ± oluÅŸturabilir veya deÄŸiÅŸtirebilir, bu da yanlÄ±ÅŸ tanÄ±lara ve operasyon ekibinden uygunsuz tepkilere yol aÃ§abilir.
```bash
aws cloudwatch delete-insight-rules --rule-names <value>
aws cloudwatch put-insight-rule --rule-name <value> --rule-definition <value> [--rule-state <value>]
aws cloudwatch put-managed-insight-rules --managed-rules <value>
```
**Potansiyel Etki**: Performans sorunlarÄ±nÄ± ve anormallikleri tespit etme ve bunlara yanÄ±t verme zorluÄŸu, yanlÄ±ÅŸ bilgilendirilmiÅŸ karar verme ve potansiyel olarak kÃ¶tÃ¼ niyetli faaliyetleri veya sistem arÄ±zalarÄ±nÄ± gizleme.

### **`cloudwatch:DisableInsightRules`, `cloudwatch:EnableInsightRules`**

Kritik iÃ§gÃ¶rÃ¼ kurallarÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakarak, bir saldÄ±rgan organizasyonu ana performans ve gÃ¼venlik metriklerine karÅŸÄ± etkili bir ÅŸekilde kÃ¶r edebilir. Tersine, yanÄ±ltÄ±cÄ± kurallarÄ± etkinleÅŸtirerek veya yapÄ±landÄ±rarak, yanlÄ±ÅŸ veriler oluÅŸturmak, gÃ¼rÃ¼ltÃ¼ yaratmak veya kÃ¶tÃ¼ niyetli faaliyetleri gizlemek mÃ¼mkÃ¼n olabilir.
```bash
aws cloudwatch disable-insight-rules --rule-names <value>
aws cloudwatch enable-insight-rules --rule-names <value>
```
**Potansiyel Etki**: Operasyon ekibi arasÄ±nda kafa karÄ±ÅŸÄ±klÄ±ÄŸÄ±na yol aÃ§arak, gerÃ§ek sorunlara gecikmiÅŸ yanÄ±tlar ve yanlÄ±ÅŸ uyarÄ±lara dayalÄ± gereksiz eylemlere neden olabilir.

### **`cloudwatch:DeleteMetricStream` , `cloudwatch:PutMetricStream` , `cloudwatch:PutMetricData`**

**`cloudwatch:DeleteMetricStream`** , **`cloudwatch:PutMetricStream`** izinlerine sahip bir saldÄ±rgan, metrik veri akÄ±ÅŸlarÄ±nÄ± oluÅŸturup silerek gÃ¼venlik, izleme ve veri bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ tehlikeye atabilir:

* **KÃ¶tÃ¼ niyetli akÄ±ÅŸlar oluÅŸturma**: Hassas verileri yetkisiz hedeflere gÃ¶ndermek iÃ§in metrik akÄ±ÅŸlarÄ± oluÅŸturma.
* **Kaynak manipÃ¼lasyonu**: AÅŸÄ±rÄ± veri ile yeni metrik akÄ±ÅŸlarÄ±nÄ±n oluÅŸturulmasÄ±, Ã§ok fazla gÃ¼rÃ¼ltÃ¼ Ã¼retebilir ve yanlÄ±ÅŸ uyarÄ±lara neden olarak gerÃ§ek sorunlarÄ± gizleyebilir.
* **Ä°zleme kesintisi**: Metrik akÄ±ÅŸlarÄ±nÄ± silerek, saldÄ±rganlar izleme verilerinin sÃ¼rekli akÄ±ÅŸÄ±nÄ± kesintiye uÄŸratÄ±r. Bu ÅŸekilde, kÃ¶tÃ¼ niyetli faaliyetleri etkili bir ÅŸekilde gizlenir.

Benzer ÅŸekilde, **`cloudwatch:PutMetricData`** izni ile bir metrik akÄ±ÅŸÄ±na veri eklemek mÃ¼mkÃ¼n olacaktÄ±r. Bu, eklenen uygunsuz veri miktarÄ± nedeniyle bir DoS'a yol aÃ§abilir ve tamamen iÅŸe yaramaz hale getirebilir.
```bash
aws cloudwatch delete-metric-stream --name <value>
aws cloudwatch put-metric-stream --name <value> [--include-filters <value>] [--exclude-filters <value>] --firehose-arn <value> --role-arn <value> --output-format <value>
aws cloudwatch put-metric-data --namespace <value> [--metric-data <value>] [--metric-name <value>] [--timestamp <value>] [--unit <value>] [--value <value>] [--dimensions <value>]
```
EC2 Ã¶rneÄŸine karÅŸÄ±lÄ±k gelen %70 CPU kullanÄ±mÄ±na ait veri ekleme Ã¶rneÄŸi:
```bash
aws cloudwatch put-metric-data --namespace "AWS/EC2" --metric-name "CPUUtilization" --value 70 --unit "Percent" --dimensions "InstanceId=i-0123456789abcdefg"
```
**OlasÄ± Etki**: Ä°zleme verilerinin akÄ±ÅŸÄ±nda kesinti, anormalliklerin ve olaylarÄ±n tespitini etkileyerek, kaynak manipÃ¼lasyonu ve aÅŸÄ±rÄ± metrik akÄ±ÅŸlarÄ±nÄ±n oluÅŸturulmasÄ± nedeniyle maliyetlerin artmasÄ±na neden olur.

### **`cloudwatch:StopMetricStreams`, `cloudwatch:StartMetricStreams`**

Bir saldÄ±rgan, etkilenen metrik veri akÄ±ÅŸlarÄ±nÄ±n akÄ±ÅŸÄ±nÄ± kontrol edebilir (kaynak kÄ±sÄ±tlamasÄ± yoksa her veri akÄ±ÅŸÄ±). **`cloudwatch:StopMetricStreams`** izni ile, saldÄ±rganlar kritik metrik akÄ±ÅŸlarÄ±nÄ± durdurarak kÃ¶tÃ¼ niyetli faaliyetlerini gizleyebilir.
```bash
aws cloudwatch stop-metric-streams --names <value>
aws cloudwatch start-metric-streams --names <value>
```
**OlasÄ± Etki**: Ä°zleme verilerinin akÄ±ÅŸÄ±nda kesinti, anormalliklerin ve olaylarÄ±n tespitini etkileyebilir.

### **`cloudwatch:TagResource`, `cloudwatch:UntagResource`**

Bir saldÄ±rgan, CloudWatch kaynaklarÄ±ndan (ÅŸu anda yalnÄ±zca alarmlar ve KatkÄ±da Bulunan Ä°Ã§gÃ¶rÃ¼ler kurallarÄ±) etiket ekleyebilir, deÄŸiÅŸtirebilir veya kaldÄ±rabilir. Bu, etiketlere dayalÄ± olarak kuruluÅŸunuzun eriÅŸim kontrol politikalarÄ±nÄ± etkileyebilir.
```bash
aws cloudwatch tag-resource --resource-arn <value> --tags <value>
aws cloudwatch untag-resource --resource-arn <value> --tag-keys <value>
```
**Potansiyel Etki**: Etiket tabanlÄ± eriÅŸim kontrol politikalarÄ±nÄ±n kesintiye uÄŸramasÄ±.

## Referanslar

* [https://cloudsecdocs.com/aws/services/logging/cloudwatch/](https://cloudsecdocs.com/aws/services/logging/cloudwatch/#general-info)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoncloudwatch.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoncloudwatch.html)
* [https://docs.aws.amazon.com/es\_es/AmazonCloudWatch/latest/monitoring/cloudwatch\_concepts.html#Metric](https://docs.aws.amazon.com/es\_es/AmazonCloudWatch/latest/monitoring/cloudwatch\_concepts.html#Metric)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
