# AWS - CloudWatch Enum

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## CloudWatch

**CloudWatch** **æ”¶é›†** ç›‘æ§å’Œæ“ä½œ **æ•°æ®**ï¼Œä»¥æ—¥å¿—/æŒ‡æ ‡/äº‹ä»¶çš„å½¢å¼æä¾› **AWS èµ„æº**ã€åº”ç”¨ç¨‹åºå’ŒæœåŠ¡çš„ **ç»Ÿä¸€è§†å›¾**ã€‚\
CloudWatch æ—¥å¿—äº‹ä»¶çš„ **æ¯è¡Œæ—¥å¿—å¤§å°é™åˆ¶ä¸º 256KB**ã€‚\
å®ƒå¯ä»¥è®¾ç½® **é«˜åˆ†è¾¨ç‡è­¦æŠ¥**ï¼Œå¹¶å¹¶æ’å¯è§†åŒ– **æ—¥å¿—** å’Œ **æŒ‡æ ‡**ï¼Œé‡‡å–è‡ªåŠ¨åŒ–è¡ŒåŠ¨ï¼Œæ’é™¤æ•…éšœï¼Œå¹¶å‘ç°æ´å¯Ÿä»¥ä¼˜åŒ–åº”ç”¨ç¨‹åºã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ç›‘æ§æ¥è‡ª CloudTrail çš„æ—¥å¿—ã€‚ç›‘æ§çš„äº‹ä»¶åŒ…æ‹¬ï¼š

* å¯¹å®‰å…¨ç»„å’Œ NACL çš„æ›´æ”¹
* å¯åŠ¨ã€åœæ­¢ã€é‡å¯å’Œç»ˆæ­¢ EC2 å®ä¾‹
* IAM å’Œ S3 ä¸­å®‰å…¨ç­–ç•¥çš„æ›´æ”¹
* å¯¹ AWS ç®¡ç†æ§åˆ¶å°çš„ç™»å½•å¤±è´¥å°è¯•
* å¯¼è‡´æˆæƒå¤±è´¥çš„ API è°ƒç”¨
* åœ¨ CloudWatch ä¸­æœç´¢çš„è¿‡æ»¤å™¨ï¼š[https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html)

## å…³é”®æ¦‚å¿µ

### å‘½åç©ºé—´

å‘½åç©ºé—´æ˜¯ CloudWatch æŒ‡æ ‡çš„å®¹å™¨ã€‚å®ƒæœ‰åŠ©äºå¯¹æŒ‡æ ‡è¿›è¡Œåˆ†ç±»å’Œéš”ç¦»ï¼Œä½¿ç®¡ç†å’Œåˆ†æå˜å¾—æ›´å®¹æ˜“ã€‚

* **ç¤ºä¾‹**ï¼šAWS/EC2 ç”¨äºä¸ EC2 ç›¸å…³çš„æŒ‡æ ‡ï¼ŒAWS/RDS ç”¨äº RDS æŒ‡æ ‡ã€‚

### æŒ‡æ ‡

æŒ‡æ ‡æ˜¯éšæ—¶é—´æ”¶é›†çš„æ•°æ®ç‚¹ï¼Œä»£è¡¨ AWS èµ„æºçš„æ€§èƒ½æˆ–åˆ©ç”¨ç‡ã€‚æŒ‡æ ‡å¯ä»¥ä» AWS æœåŠ¡ã€è‡ªå®šä¹‰åº”ç”¨ç¨‹åºæˆ–ç¬¬ä¸‰æ–¹é›†æˆä¸­æ”¶é›†ã€‚

* **ç¤ºä¾‹**ï¼šCPUUtilizationã€NetworkInã€DiskReadOpsã€‚

### ç»´åº¦

ç»´åº¦æ˜¯æŒ‡æ ‡çš„ä¸€éƒ¨åˆ†çš„é”®å€¼å¯¹ã€‚å®ƒä»¬æœ‰åŠ©äºå”¯ä¸€æ ‡è¯†æŒ‡æ ‡å¹¶æä¾›é¢å¤–çš„ä¸Šä¸‹æ–‡ï¼Œæœ€å¤šå¯ä»¥ä¸ä¸€ä¸ªæŒ‡æ ‡å…³è” 30 ä¸ªç»´åº¦ã€‚ç»´åº¦è¿˜å…è®¸æ ¹æ®ç‰¹å®šå±æ€§è¿‡æ»¤å’ŒèšåˆæŒ‡æ ‡ã€‚

* **ç¤ºä¾‹**ï¼šå¯¹äº EC2 å®ä¾‹ï¼Œç»´åº¦å¯èƒ½åŒ…æ‹¬ InstanceIdã€InstanceType å’Œ AvailabilityZoneã€‚

### ç»Ÿè®¡ä¿¡æ¯

ç»Ÿè®¡ä¿¡æ¯æ˜¯å¯¹æŒ‡æ ‡æ•°æ®è¿›è¡Œçš„æ•°å­¦è®¡ç®—ï¼Œä»¥ä¾¿éšæ—¶é—´å¯¹å…¶è¿›è¡Œæ€»ç»“ã€‚å¸¸è§çš„ç»Ÿè®¡ä¿¡æ¯åŒ…æ‹¬å¹³å‡å€¼ã€æ€»å’Œã€æœ€å°å€¼ã€æœ€å¤§å€¼å’Œæ ·æœ¬è®¡æ•°ã€‚

* **ç¤ºä¾‹**ï¼šè®¡ç®—ä¸€å°æ—¶å†…çš„å¹³å‡ CPU åˆ©ç”¨ç‡ã€‚

### å•ä½

å•ä½æ˜¯ä¸æŒ‡æ ‡ç›¸å…³çš„æµ‹é‡ç±»å‹ã€‚å•ä½æœ‰åŠ©äºä¸ºæŒ‡æ ‡æ•°æ®æä¾›ä¸Šä¸‹æ–‡å’Œæ„ä¹‰ã€‚å¸¸è§å•ä½åŒ…æ‹¬ç™¾åˆ†æ¯”ã€å­—èŠ‚ã€ç§’ã€è®¡æ•°ã€‚

* **ç¤ºä¾‹**ï¼šCPUUtilization å¯èƒ½ä»¥ç™¾åˆ†æ¯”ä¸ºå•ä½ï¼Œè€Œ NetworkIn å¯èƒ½ä»¥å­—èŠ‚ä¸ºå•ä½ã€‚

## CloudWatch ç‰¹æ€§

### ä»ªè¡¨æ¿

**CloudWatch ä»ªè¡¨æ¿** æä¾›å¯è‡ªå®šä¹‰çš„ **AWS CloudWatch æŒ‡æ ‡è§†å›¾**ã€‚å¯ä»¥åˆ›å»ºå’Œé…ç½®ä»ªè¡¨æ¿ä»¥å¯è§†åŒ–æ•°æ®å¹¶åœ¨å•ä¸€è§†å›¾ä¸­ç›‘æ§èµ„æºï¼Œç»“åˆæ¥è‡ªå„ç§ AWS æœåŠ¡çš„ä¸åŒæŒ‡æ ‡ã€‚

**å…³é”®ç‰¹æ€§**ï¼š

* **å°éƒ¨ä»¶**ï¼šä»ªè¡¨æ¿çš„æ„å»ºå—ï¼ŒåŒ…æ‹¬å›¾è¡¨ã€æ–‡æœ¬ã€è­¦æŠ¥ç­‰ã€‚
* **è‡ªå®šä¹‰**ï¼šå¸ƒå±€å’Œå†…å®¹å¯ä»¥æ ¹æ®ç‰¹å®šç›‘æ§éœ€æ±‚è¿›è¡Œè‡ªå®šä¹‰ã€‚

**ç¤ºä¾‹ç”¨ä¾‹**ï¼š

* ä¸€ä¸ªä»ªè¡¨æ¿æ˜¾ç¤ºæ‚¨æ•´ä¸ª AWS ç¯å¢ƒçš„å…³é”®æŒ‡æ ‡ï¼ŒåŒ…æ‹¬ EC2 å®ä¾‹ã€RDS æ•°æ®åº“å’Œ S3 å­˜å‚¨æ¡¶ã€‚

### æŒ‡æ ‡æµå’ŒæŒ‡æ ‡æ•°æ®

**æŒ‡æ ‡æµ** åœ¨ AWS CloudWatch ä¸­ä½¿æ‚¨èƒ½å¤Ÿè¿‘ä¹å®æ—¶åœ°æŒç»­æµå¼ä¼ è¾“ CloudWatch æŒ‡æ ‡åˆ°æ‚¨é€‰æ‹©çš„ç›®æ ‡ã€‚è¿™å¯¹äºé«˜çº§ç›‘æ§ã€åˆ†æå’Œä½¿ç”¨ AWS ä¹‹å¤–çš„å·¥å…·åˆ›å»ºè‡ªå®šä¹‰ä»ªè¡¨æ¿ç‰¹åˆ«æœ‰ç”¨ã€‚

**æŒ‡æ ‡æ•°æ®** åœ¨æŒ‡æ ‡æµä¸­æŒ‡çš„æ˜¯æ­£åœ¨æµå¼ä¼ è¾“çš„å®é™…æµ‹é‡æˆ–æ•°æ®ç‚¹ã€‚è¿™äº›æ•°æ®ç‚¹ä»£è¡¨ AWS èµ„æºçš„å„ç§æŒ‡æ ‡ï¼Œå¦‚ CPU åˆ©ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç­‰ã€‚

**ç¤ºä¾‹ç”¨ä¾‹**ï¼š

* å°†å®æ—¶æŒ‡æ ‡å‘é€åˆ°ç¬¬ä¸‰æ–¹ç›‘æ§æœåŠ¡ä»¥è¿›è¡Œé«˜çº§åˆ†æã€‚
* å°†æŒ‡æ ‡å­˜æ¡£åˆ° Amazon S3 å­˜å‚¨æ¡¶ä¸­ä»¥è¿›è¡Œé•¿æœŸå­˜å‚¨å’Œåˆè§„æ€§ã€‚

### è­¦æŠ¥

**CloudWatch è­¦æŠ¥** ç›‘æ§æ‚¨çš„æŒ‡æ ‡å¹¶æ ¹æ®é¢„å®šä¹‰çš„é˜ˆå€¼æ‰§è¡Œæ“ä½œã€‚å½“æŒ‡æ ‡çªç ´é˜ˆå€¼æ—¶ï¼Œè­¦æŠ¥å¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œï¼Œä¾‹å¦‚é€šè¿‡ SNS å‘é€é€šçŸ¥ã€è§¦å‘è‡ªåŠ¨æ‰©å±•ç­–ç•¥æˆ–è¿è¡Œ AWS Lambda å‡½æ•°ã€‚

**å…³é”®ç»„ä»¶**ï¼š

* **é˜ˆå€¼**ï¼šè§¦å‘è­¦æŠ¥çš„å€¼ã€‚
* **è¯„ä¼°å‘¨æœŸ**ï¼šè¯„ä¼°æ•°æ®çš„å‘¨æœŸæ•°ã€‚
* **è§¦å‘è­¦æŠ¥çš„æ•°æ®ç‚¹**ï¼šè§¦å‘è­¦æŠ¥æ‰€éœ€è¾¾åˆ°é˜ˆå€¼çš„å‘¨æœŸæ•°ã€‚
* **æ“ä½œ**ï¼šå½“è­¦æŠ¥çŠ¶æ€è¢«è§¦å‘æ—¶å‘ç”Ÿçš„äº‹æƒ…ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ SNS é€šçŸ¥ï¼‰ã€‚

**ç¤ºä¾‹ç”¨ä¾‹**ï¼š

* ç›‘æ§ EC2 å®ä¾‹çš„ CPU åˆ©ç”¨ç‡ï¼Œå¦‚æœè¶…è¿‡ 80% æŒç»­ 5 åˆ†é’Ÿï¼Œåˆ™é€šè¿‡ SNS å‘é€é€šçŸ¥ã€‚

### å¼‚å¸¸æ£€æµ‹å™¨

**å¼‚å¸¸æ£€æµ‹å™¨** ä½¿ç”¨æœºå™¨å­¦ä¹ è‡ªåŠ¨æ£€æµ‹æ‚¨çš„æŒ‡æ ‡ä¸­çš„å¼‚å¸¸ã€‚æ‚¨å¯ä»¥å°†å¼‚å¸¸æ£€æµ‹åº”ç”¨äºä»»ä½• CloudWatch æŒ‡æ ‡ï¼Œä»¥è¯†åˆ«å¯èƒ½æŒ‡ç¤ºé—®é¢˜çš„æ­£å¸¸æ¨¡å¼çš„åå·®ã€‚

**å…³é”®ç»„ä»¶**ï¼š

* **æ¨¡å‹è®­ç»ƒ**ï¼šCloudWatch ä½¿ç”¨å†å²æ•°æ®è®­ç»ƒæ¨¡å‹å¹¶å»ºç«‹æ­£å¸¸è¡Œä¸ºçš„æ ‡å‡†ã€‚
* **å¼‚å¸¸æ£€æµ‹å¸¦**ï¼šæŒ‡æ ‡é¢„æœŸå€¼èŒƒå›´çš„å¯è§†åŒ–è¡¨ç¤ºã€‚

**ç¤ºä¾‹ç”¨ä¾‹**ï¼š

* æ£€æµ‹ EC2 å®ä¾‹ä¸­å¼‚å¸¸çš„ CPU åˆ©ç”¨ç‡æ¨¡å¼ï¼Œè¿™å¯èƒ½è¡¨æ˜å®‰å…¨æ¼æ´æˆ–åº”ç”¨ç¨‹åºé—®é¢˜ã€‚

### æ´å¯Ÿè§„åˆ™å’Œæ‰˜ç®¡æ´å¯Ÿè§„åˆ™

**æ´å¯Ÿè§„åˆ™** å…è®¸æ‚¨ä½¿ç”¨ **å¼ºå¤§çš„æ•°å­¦è¡¨è¾¾å¼** æ¥å®šä¹‰åº”é‡‡å–è¡ŒåŠ¨çš„æ¡ä»¶ï¼Œä»¥è¯†åˆ«è¶‹åŠ¿ã€æ£€æµ‹å³°å€¼æˆ–å…¶ä»–æ„Ÿå…´è¶£çš„æ¨¡å¼ã€‚è¿™äº›è§„åˆ™å¯ä»¥å¸®åŠ©æ‚¨è¯†åˆ«èµ„æºæ€§èƒ½å’Œåˆ©ç”¨ç‡ä¸­çš„å¼‚å¸¸æˆ–ä¸å¯»å¸¸è¡Œä¸ºã€‚

**æ‰˜ç®¡æ´å¯Ÿè§„åˆ™** æ˜¯ AWS æä¾›çš„é¢„é…ç½® **æ´å¯Ÿè§„åˆ™**ã€‚å®ƒä»¬æ—¨åœ¨ç›‘æ§ç‰¹å®šçš„ AWS æœåŠ¡æˆ–å¸¸è§ç”¨ä¾‹ï¼Œå¯ä»¥åœ¨æ— éœ€è¯¦ç»†é…ç½®çš„æƒ…å†µä¸‹å¯ç”¨ã€‚

**ç¤ºä¾‹ç”¨ä¾‹**ï¼š

* ç›‘æ§ RDS æ€§èƒ½ï¼šå¯ç”¨ä¸€ä¸ªé’ˆå¯¹ Amazon RDS çš„æ‰˜ç®¡æ´å¯Ÿè§„åˆ™ï¼Œç›‘æ§å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ CPU åˆ©ç”¨ç‡ã€å†…å­˜ä½¿ç”¨å’Œç£ç›˜ I/Oã€‚å¦‚æœè¿™äº›æŒ‡æ ‡ä¸­çš„ä»»ä½•ä¸€ä¸ªè¶…è¿‡å®‰å…¨æ“ä½œé˜ˆå€¼ï¼Œè¯¥è§„åˆ™å¯ä»¥è§¦å‘è­¦æŠ¥æˆ–è‡ªåŠ¨ç¼“è§£æªæ–½ã€‚

### CloudWatch æ—¥å¿— <a href="#cloudwatch-logs" id="cloudwatch-logs"></a>

å…è®¸ **èšåˆå’Œç›‘æ§æ¥è‡ªåº”ç”¨ç¨‹åº** å’Œç³»ç»Ÿçš„æ—¥å¿—ï¼Œæ¥è‡ª **AWS æœåŠ¡**ï¼ˆåŒ…æ‹¬ CloudTrailï¼‰å’Œ **æ¥è‡ªåº”ç”¨ç¨‹åº/ç³»ç»Ÿ**ï¼ˆ**CloudWatch Agent** å¯ä»¥å®‰è£…åœ¨ä¸»æœºä¸Šï¼‰ã€‚æ—¥å¿—å¯ä»¥ **æ— é™æœŸå­˜å‚¨**ï¼ˆå–å†³äºæ—¥å¿—ç»„è®¾ç½®ï¼‰å¹¶å¯ä»¥å¯¼å‡ºã€‚

**å…ƒç´ **ï¼š

| **æ—¥å¿—ç»„**            | ä¸€ç»„å…±äº«ç›¸åŒä¿ç•™ã€ç›‘æ§å’Œè®¿é—®æ§åˆ¶è®¾ç½®çš„ **æ—¥å¿—æµ**                                                     |
| ------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **æ—¥å¿—æµ**           | ä¸€ç³»åˆ—å…±äº« **ç›¸åŒæ¥æº** çš„ **æ—¥å¿—äº‹ä»¶**                                                                                                |
| **è®¢é˜…è¿‡æ»¤å™¨** | å®šä¹‰ä¸€ä¸ª **è¿‡æ»¤æ¨¡å¼ä»¥åŒ¹é…ç‰¹å®šæ—¥å¿—ç»„ä¸­çš„äº‹ä»¶**ï¼Œå°†å…¶å‘é€åˆ° Kinesis Data Firehose æµã€Kinesis æµæˆ– Lambda å‡½æ•° |

### CloudWatch ç›‘æ§ä¸äº‹ä»¶

CloudWatch **åŸºæœ¬** æ¯ 5 åˆ†é’Ÿèšåˆæ•°æ®ï¼ˆ**è¯¦ç»†** æ¯ 1 åˆ†é’Ÿèšåˆï¼‰ã€‚åœ¨èšåˆåï¼Œå®ƒ **æ£€æŸ¥è­¦æŠ¥çš„é˜ˆå€¼** ä»¥ç¡®å®šæ˜¯å¦éœ€è¦è§¦å‘ä¸€ä¸ªã€‚\
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCloudWatch å¯ä»¥å‡†å¤‡å‘é€äº‹ä»¶å¹¶æ‰§è¡Œä¸€äº›è‡ªåŠ¨æ“ä½œï¼ˆAWS Lambda å‡½æ•°ã€SNS ä¸»é¢˜ã€SQS é˜Ÿåˆ—ã€Kinesis æµï¼‰ã€‚

### ä»£ç†å®‰è£…

æ‚¨å¯ä»¥åœ¨æœºå™¨/å®¹å™¨å†…éƒ¨å®‰è£…ä»£ç†ï¼Œä»¥è‡ªåŠ¨å°†æ—¥å¿—å‘é€å› CloudWatchã€‚

* **åˆ›å»º** ä¸€ä¸ª **è§’è‰²** å¹¶ **é™„åŠ ** åˆ°å…·æœ‰å…è®¸ CloudWatch ä»å®ä¾‹æ”¶é›†æ•°æ®çš„æƒé™çš„ **å®ä¾‹**ï¼Œä»¥åŠä¸ AWS ç³»ç»Ÿç®¡ç†å™¨ SSM äº¤äº’çš„æƒé™ï¼ˆCloudWatchAgentAdminPolicy & AmazonEC2RoleforSSMï¼‰
* **ä¸‹è½½** å¹¶ **å®‰è£…** **ä»£ç†** åˆ° EC2 å®ä¾‹ä¸Šï¼ˆ[https://s3.amazonaws.com/amazoncloudwatch-agent/linux/amd64/latest/AmazonCloudWatchAgent.zip](https://s3.amazonaws.com/amazoncloudwatch-agent/linux/amd64/latest/AmazonCloudWatchAgent.zip)ï¼‰ã€‚æ‚¨å¯ä»¥ä» EC2 å†…éƒ¨ä¸‹è½½å®ƒï¼Œæˆ–ä½¿ç”¨ AWS ç³»ç»Ÿç®¡ç†å™¨è‡ªåŠ¨å®‰è£…ï¼Œé€‰æ‹©åŒ… AWS-ConfigureAWSPackage
* **é…ç½®** å¹¶ **å¯åŠ¨** CloudWatch Agent

ä¸€ä¸ªæ—¥å¿—ç»„æœ‰å¤šä¸ªæµã€‚ä¸€ä¸ªæµæœ‰å¤šä¸ªäº‹ä»¶ã€‚åœ¨æ¯ä¸ªæµå†…ï¼Œäº‹ä»¶ä¿è¯æ˜¯æœ‰åºçš„ã€‚

## æšä¸¾
```bash
# Dashboards #

## Returns a list of the dashboards of your account
aws cloudwatch list-dashboards

## Retrieves the details of the specified dashboard
aws cloudwatch get-dashboard --dashboard-name <value>

# Metrics #

## Returns a list of the specified metric
aws cloudwatch list-metrics [--namespace <value>] [--metric-name <value>] [--dimensions <value>] [--include-linked-accounts | --no-include-linked-accounts]

## Retrieves metric data (this operation can include a CloudWatch Metrics Insights query, and one or more metric math functions)
aws cloudwatch get-metric-data --metric-data-queries <value> --start-time <value> --end-time <value>

## Retrieves statistics for the specified metric and namespace over a range of time
aws cloudwatch get-metric-statistics --namespace <value> --metric-name <value> [--dimensions <value>] --start-time <value> --end-time <value> --period <value>

## Returns a list of the metric streams of your account
aws cloudwatch list-metric-streams

## Retrieves information about the specified metric stream
aws cloudwatch get-metric-stream --name <value>

## Retrieve snapshots of the specified metric widgets
aws cloudwatch get-metric-widget-image --metric-widget <value>

# Alarms #

## Retrieves the specified alarm
aws cloudwatch describe-alarms [--alarm-names <value>] [--alarm-name-prefix <value>] [--alarm-types <value>] [--state-value <value>]

## Retrieves the alarms history, even for deleted alarms
aws cloudwatch describe-alarm-history [--alarm-name <value>] [--alarm-types <value>] [--history-item-type <ConfigurationUpdate | StateUpdate | Action>] [--start-date <value>] [--end-date <value>]

## Retrieves standard alarms based on the specified metric
aws cloudwatch escribe-alarms-for-metric --metric-name <value> --namespace <value> [--dimensions <value>]

# Anomaly Detections #

## Lists the anomaly detection models that you have created in your account
aws cloudwatch describe-anomaly-detectors [--namespace <value>] [--metric-name <value>] [--dimensions <value>]

## Lists all the Contributor Insight rules in your account
aws cloudwatch describe-insight-rules

## Retrieves the data collected over a time range for a given Contributor Insight rule
aws cloudwatch get-insight-rule-report --rule-name <value> --start-time <value> --end-time <value> --period <value>

## Lists managed Contributor Insights rules in your account for a specified resource
aws cloudwatch list-managed-insight-rules --resource-arn <value>

# Tags #

## Lists the tags associated with the specified CloudWatch resources
aws cloudwatch list-tags-for-resource --resource-arn <value>

# CloudWatch Logs #
aws logs tail "<log_group_name>" --followaws logs get-log-events --log-group-name "<log_group_name>" --log-stream-name "<log_stream_name>" --output text > <output_file>

# CloudWatch Events #
aws events list-rules
aws events describe-rule --name <name>aws events list-targets-by-rule --rule <name>aws events list-archives
aws events describe-archive --archive-name <name>aws events list-connections
aws events describe-connection --name <name>aws events list-endpoints
aws events describe-endpoint --name <name>aws events list-event-sources
aws events describe-event-source --name <name>aws events list-replays
aws events list-api-destinations
aws events list-event-buses
```
## Post-Exploitation / Bypass

### **`cloudwatch:DeleteAlarms`,`cloudwatch:PutMetricAlarm` , `cloudwatch:PutCompositeAlarm`**

æ‹¥æœ‰è¿™äº›æƒé™çš„æ”»å‡»è€…å¯èƒ½ä¼šä¸¥é‡å‰Šå¼±ç»„ç»‡çš„ç›‘æ§å’Œè­¦æŠ¥åŸºç¡€è®¾æ–½ã€‚é€šè¿‡åˆ é™¤ç°æœ‰çš„è­¦æŠ¥ï¼Œæ”»å‡»è€…å¯ä»¥ç¦ç”¨å…³é”®çš„è­¦æŠ¥ï¼Œè¿™äº›è­¦æŠ¥é€šçŸ¥ç®¡ç†å‘˜å…³é”®çš„æ€§èƒ½é—®é¢˜ã€å®‰å…¨æ¼æ´æˆ–æ“ä½œæ•…éšœã€‚æ­¤å¤–ï¼Œé€šè¿‡åˆ›å»ºæˆ–ä¿®æ”¹æŒ‡æ ‡è­¦æŠ¥ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥ç”¨è™šå‡çš„è­¦æŠ¥è¯¯å¯¼ç®¡ç†å‘˜æˆ–ä½¿åˆæ³•è­¦æŠ¥å¤±æ•ˆï¼Œæœ‰æ•ˆæ©ç›–æ¶æ„æ´»åŠ¨å¹¶é˜»æ­¢å¯¹å®é™…äº‹ä»¶çš„åŠæ—¶å“åº”ã€‚

æ­¤å¤–ï¼Œæ‹¥æœ‰ **`cloudwatch:PutCompositeAlarm`** æƒé™çš„æ”»å‡»è€…å°†èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªå¤åˆè­¦æŠ¥çš„å¾ªç¯æˆ–å‘¨æœŸï¼Œå…¶ä¸­å¤åˆè­¦æŠ¥ A ä¾èµ–äºå¤åˆè­¦æŠ¥ Bï¼Œè€Œå¤åˆè­¦æŠ¥ B ä¹Ÿä¾èµ–äºå¤åˆè­¦æŠ¥ Aã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ— æ³•åˆ é™¤ä»»ä½•å±äºè¯¥å¾ªç¯çš„å¤åˆè­¦æŠ¥ï¼Œå› ä¸ºæ€»æ˜¯è¿˜æœ‰ä¸€ä¸ªä¾èµ–äºæ‚¨æƒ³è¦åˆ é™¤çš„è­¦æŠ¥çš„å¤åˆè­¦æŠ¥ã€‚
```bash
aws cloudwatch put-metric-alarm --cli-input-json <value> | --alarm-name <value> --comparison-operator <value> --evaluation-periods <value> [--datapoints-to-alarm <value>] [--threshold <value>] [--alarm-description <value>] [--alarm-actions <value>] [--metric-name <value>] [--namespace <value>] [--statistic <value>] [--dimensions <value>] [--period <value>]
aws cloudwatch delete-alarms --alarm-names <value>
aws cloudwatch put-composite-alarm --alarm-name <value> --alarm-rule <value> [--no-actions-enabled | --actions-enabled [--alarm-actions <value>] [--insufficient-data-actions <value>] [--ok-actions <value>] ]
```
ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿æŒ‡æ ‡è­¦æŠ¥å¤±æ•ˆï¼š

* è¯¥æŒ‡æ ‡è­¦æŠ¥ç›‘æ§ç‰¹å®š EC2 å®ä¾‹çš„å¹³å‡ CPU åˆ©ç”¨ç‡ï¼Œæ¯ 300 ç§’è¯„ä¼°ä¸€æ¬¡æŒ‡æ ‡ï¼Œå¹¶éœ€è¦ 6 ä¸ªè¯„ä¼°å‘¨æœŸï¼ˆæ€»å…± 30 åˆ†é’Ÿï¼‰ã€‚å¦‚æœå¹³å‡ CPU åˆ©ç”¨ç‡åœ¨è¿™ 4 ä¸ªå‘¨æœŸä¸­çš„è‡³å°‘ 4 ä¸ªå‘¨æœŸå†…è¶…è¿‡ 60%ï¼Œåˆ™è­¦æŠ¥å°†è§¦å‘å¹¶å‘æŒ‡å®šçš„ SNS ä¸»é¢˜å‘é€é€šçŸ¥ã€‚
* é€šè¿‡å°†é˜ˆå€¼ä¿®æ”¹ä¸ºè¶…è¿‡ 99%ï¼Œå°†å‘¨æœŸè®¾ç½®ä¸º 10 ç§’ï¼Œå°†è¯„ä¼°å‘¨æœŸè®¾ç½®ä¸º 8640ï¼ˆå› ä¸º 8640 ä¸ª 10 ç§’çš„å‘¨æœŸç­‰äº 1 å¤©ï¼‰ï¼Œå¹¶å°†æ•°æ®ç‚¹è®¾ç½®ä¸ºè­¦æŠ¥ä¹Ÿä¸º 8640ï¼Œåˆ™ CPU åˆ©ç”¨ç‡å¿…é¡»åœ¨æ•´ä¸ª 24 å°æ—¶å†…æ¯ 10 ç§’è¶…è¿‡ 99% æ‰èƒ½è§¦å‘è­¦æŠ¥ã€‚

{% tabs %}
{% tab title="Original Metric Alarm" %}
```json
{
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-01234567890123456"
}
],
"AlarmActions": [
"arn:aws:sns:us-east-1:123456789012:example_sns"
],
"ComparisonOperator": "GreaterThanThreshold",
"DatapointsToAlarm": 4,
"EvaluationPeriods": 6,
"Period": 300,
"Statistic": "Average",
"Threshold": 60,
"AlarmDescription": "CPU Utilization of i-01234567890123456 over 60%",
"AlarmName": "EC2 instance i-01234567890123456 CPU Utilization"
}
```
{% endtab %}

{% tab title="ä¿®æ”¹åçš„æŒ‡æ ‡è­¦æŠ¥" %}
```json
{
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-0645d6d414dadf9f8"
}
],
"AlarmActions": [],
"ComparisonOperator": "GreaterThanThreshold",
"DatapointsToAlarm": 8640,
"EvaluationPeriods": 8640,
"Period": 10,
"Statistic": "Average",
"Threshold": 99,
"AlarmDescription": "CPU Utilization of i-01234567890123456 with 60% as threshold",
"AlarmName": "Instance i-0645d6d414dadf9f8 CPU Utilization"
}

```
{% endtab %}
{% endtabs %}

**æ½œåœ¨å½±å“**ï¼šç¼ºä¹å¯¹å…³é”®äº‹ä»¶çš„é€šçŸ¥ï¼Œå¯èƒ½æœªè¢«æ£€æµ‹åˆ°çš„é—®é¢˜ï¼Œè™šå‡è­¦æŠ¥ï¼ŒæŠ‘åˆ¶çœŸå®è­¦æŠ¥ï¼Œå¯èƒ½é”™è¿‡å¯¹çœŸå®äº‹ä»¶çš„æ£€æµ‹ã€‚

### **`cloudwatch:DeleteAlarmActions`, `cloudwatch:EnableAlarmActions` , `cloudwatch:SetAlarmState`**

é€šè¿‡åˆ é™¤è­¦æŠ¥æ“ä½œï¼Œæ”»å‡»è€…å¯ä»¥é˜²æ­¢åœ¨è¾¾åˆ°è­¦æŠ¥çŠ¶æ€æ—¶è§¦å‘å…³é”®è­¦æŠ¥å’Œè‡ªåŠ¨å“åº”ï¼Œä¾‹å¦‚é€šçŸ¥ç®¡ç†å‘˜æˆ–è§¦å‘è‡ªåŠ¨æ‰©å±•æ´»åŠ¨ã€‚ä¸å½“å¯ç”¨æˆ–é‡æ–°å¯ç”¨è­¦æŠ¥æ“ä½œä¹Ÿå¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºï¼Œå¯èƒ½é€šè¿‡é‡æ–°æ¿€æ´»å…ˆå‰ç¦ç”¨çš„æ“ä½œæˆ–ä¿®æ”¹è§¦å‘çš„æ“ä½œï¼Œå¯¼è‡´äº‹ä»¶å“åº”ä¸­çš„æ··æ·†å’Œè¯¯å¯¼ã€‚

æ­¤å¤–ï¼Œæ‹¥æœ‰æƒé™çš„æ”»å‡»è€…å¯ä»¥æ“çºµè­¦æŠ¥çŠ¶æ€ï¼Œèƒ½å¤Ÿåˆ›å»ºè™šå‡è­¦æŠ¥ä»¥åˆ†æ•£å’Œæ··æ·†ç®¡ç†å‘˜ï¼Œæˆ–ä½¿çœŸå®è­¦æŠ¥é™éŸ³ä»¥æ©ç›–æ­£åœ¨è¿›è¡Œçš„æ¶æ„æ´»åŠ¨æˆ–å…³é”®ç³»ç»Ÿæ•…éšœã€‚

* å¦‚æœæ‚¨åœ¨å¤åˆè­¦æŠ¥ä¸Šä½¿ç”¨ **`SetAlarmState`**ï¼Œåˆ™å¤åˆè­¦æŠ¥ä¸ä¿è¯è¿”å›å…¶å®é™…çŠ¶æ€ã€‚åªæœ‰åœ¨å…¶å­è­¦æŠ¥çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒæ‰ä¼šè¿”å›åˆ°å…¶å®é™…çŠ¶æ€ã€‚å¦‚æœæ‚¨æ›´æ–°å…¶é…ç½®ï¼Œå®ƒä¹Ÿä¼šè¢«é‡æ–°è¯„ä¼°ã€‚
```bash
aws cloudwatch disable-alarm-actions --alarm-names <value>
aws cloudwatch enable-alarm-actions --alarm-names <value>
aws cloudwatch set-alarm-state --alarm-name <value> --state-value <OK | ALARM | INSUFFICIENT_DATA> --state-reason <value> [--state-reason-data <value>]
```
**æ½œåœ¨å½±å“**ï¼šç¼ºä¹å¯¹å…³é”®äº‹ä»¶çš„é€šçŸ¥ï¼Œå¯èƒ½æœªè¢«æ£€æµ‹åˆ°çš„é—®é¢˜ï¼Œé”™è¯¯è­¦æŠ¥ï¼ŒæŠ‘åˆ¶çœŸå®è­¦æŠ¥ï¼Œå¹¶å¯èƒ½é”™è¿‡å¯¹çœŸå®äº‹ä»¶çš„æ£€æµ‹ã€‚

### **`cloudwatch:DeleteAnomalyDetector`, `cloudwatch:PutAnomalyDetector`**

æ”»å‡»è€…å°†èƒ½å¤Ÿç ´åæ£€æµ‹å’Œå“åº”æŒ‡æ ‡æ•°æ®ä¸­å¼‚å¸¸æ¨¡å¼æˆ–å¼‚å¸¸çš„èƒ½åŠ›ã€‚é€šè¿‡åˆ é™¤ç°æœ‰çš„å¼‚å¸¸æ£€æµ‹å™¨ï¼Œæ”»å‡»è€…å¯ä»¥ç¦ç”¨å…³é”®çš„è­¦æŠ¥æœºåˆ¶ï¼›é€šè¿‡åˆ›å»ºæˆ–ä¿®æ”¹å®ƒä»¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé”™è¯¯é…ç½®æˆ–åˆ¶é€ è¯¯æŠ¥ï¼Œä»¥åˆ†æ•£æˆ–å‹å€’ç›‘æ§ã€‚
```bash
aws cloudwatch delete-anomaly-detector [--cli-input-json <value> | --namespace <value> --metric-name <value> --dimensions <value> --stat <value>]
aws cloudwatch put-anomaly-detector [--cli-input-json <value> | --namespace <value> --metric-name <value> --dimensions <value> --stat <value> --configuration <value> --metric-characteristics <value>]
```
ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿æŒ‡æ ‡å¼‚å¸¸æ£€æµ‹å™¨å¤±æ•ˆã€‚è¯¥æŒ‡æ ‡å¼‚å¸¸æ£€æµ‹å™¨ç›‘æ§ç‰¹å®š EC2 å®ä¾‹çš„å¹³å‡ CPU åˆ©ç”¨ç‡ï¼Œåªéœ€æ·»åŠ â€œExcludedTimeRangesâ€å‚æ•°å’Œæ‰€éœ€çš„æ—¶é—´èŒƒå›´ï¼Œå°±è¶³ä»¥ç¡®ä¿å¼‚å¸¸æ£€æµ‹å™¨åœ¨è¯¥æœŸé—´å†…ä¸åˆ†ææˆ–è­¦æŠ¥ä»»ä½•ç›¸å…³æ•°æ®ã€‚

{% tabs %}
{% tab title="Original Metric Anomaly Detector" %}
```json
{
"SingleMetricAnomalyDetector": {
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Stat": "Average",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-0123456789abcdefg"
}
]
}
}
```
{% endtab %}

{% tab title="ä¿®æ”¹åçš„æŒ‡æ ‡å¼‚å¸¸æ£€æµ‹å™¨" %}
```json
{
"SingleMetricAnomalyDetector": {
"Namespace": "AWS/EC2",
"MetricName": "CPUUtilization",
"Stat": "Average",
"Dimensions": [
{
"Name": "InstanceId",
"Value": "i-0123456789abcdefg"
}
]
},
"Configuration": {
"ExcludedTimeRanges": [
{
"StartTime": "2023-01-01T00:00:00Z",
"EndTime": "2053-01-01T23:59:59Z"
}
],
"Timezone": "Europe/Madrid"
}
}
```
{% endtab %}
{% endtabs %}

**æ½œåœ¨å½±å“**ï¼šç›´æ¥å½±å“æ£€æµ‹å¼‚å¸¸æ¨¡å¼æˆ–å®‰å…¨å¨èƒã€‚

### **`cloudwatch:DeleteDashboards`, `cloudwatch:PutDashboard`**

æ”»å‡»è€…å°†èƒ½å¤Ÿé€šè¿‡åˆ›å»ºã€ä¿®æ”¹æˆ–åˆ é™¤ä»ªè¡¨æ¿æ¥ç ´åç»„ç»‡çš„ç›‘æ§å’Œå¯è§†åŒ–èƒ½åŠ›ã€‚è¿™äº›æƒé™å¯ä»¥è¢«åˆ©ç”¨æ¥ç§»é™¤å¯¹ç³»ç»Ÿæ€§èƒ½å’Œå¥åº·çŠ¶å†µçš„å…³é”®å¯è§æ€§ï¼Œä¿®æ”¹ä»ªè¡¨æ¿ä»¥æ˜¾ç¤ºä¸æ­£ç¡®çš„æ•°æ®æˆ–éšè—æ¶æ„æ´»åŠ¨ã€‚
```bash
aws cloudwatch delete-dashboards --dashboard-names <value>
aws cloudwatch put-dashboard --dashboard-name <value> --dashboard-body <value>
```
**æ½œåœ¨å½±å“**ï¼šå¤±å»ç›‘æ§å¯è§æ€§å’Œè¯¯å¯¼æ€§ä¿¡æ¯ã€‚

### **`cloudwatch:DeleteInsightRules`, `cloudwatch:PutInsightRule` ,`cloudwatch:PutManagedInsightRule`**

Insight è§„åˆ™ç”¨äºæ£€æµ‹å¼‚å¸¸ã€ä¼˜åŒ–æ€§èƒ½å’Œæœ‰æ•ˆç®¡ç†èµ„æºã€‚é€šè¿‡åˆ é™¤ç°æœ‰çš„ insight è§„åˆ™ï¼Œæ”»å‡»è€…å¯ä»¥ç§»é™¤å…³é”®çš„ç›‘æ§èƒ½åŠ›ï¼Œä½¿ç³»ç»Ÿå¯¹æ€§èƒ½é—®é¢˜å’Œå®‰å…¨å¨èƒå¤±å»æ„ŸçŸ¥ã€‚æ­¤å¤–ï¼Œæ”»å‡»è€…å¯ä»¥åˆ›å»ºæˆ–ä¿®æ”¹ insight è§„åˆ™ï¼Œä»¥ç”Ÿæˆè¯¯å¯¼æ€§æ•°æ®æˆ–éšè—æ¶æ„æ´»åŠ¨ï¼Œä»è€Œå¯¼è‡´é”™è¯¯çš„è¯Šæ–­å’Œè¿è¥å›¢é˜Ÿçš„ä¸å½“å“åº”ã€‚
```bash
aws cloudwatch delete-insight-rules --rule-names <value>
aws cloudwatch put-insight-rule --rule-name <value> --rule-definition <value> [--rule-state <value>]
aws cloudwatch put-managed-insight-rules --managed-rules <value>
```
**æ½œåœ¨å½±å“**ï¼šéš¾ä»¥æ£€æµ‹å’Œå“åº”æ€§èƒ½é—®é¢˜å’Œå¼‚å¸¸ï¼Œé”™è¯¯çš„ä¿¡æ¯å†³ç­–ï¼Œå¯èƒ½æ©ç›–æ¶æ„æ´»åŠ¨æˆ–ç³»ç»Ÿæ•…éšœã€‚

### **`cloudwatch:DisableInsightRules`, `cloudwatch:EnableInsightRules`**

é€šè¿‡ç¦ç”¨å…³é”®çš„æ´å¯Ÿè§„åˆ™ï¼Œæ”»å‡»è€…å¯ä»¥æœ‰æ•ˆåœ°ä½¿ç»„ç»‡å¯¹å…³é”®æ€§èƒ½å’Œå®‰å…¨æŒ‡æ ‡å¤±å»è­¦è§‰ã€‚ç›¸åï¼Œé€šè¿‡å¯ç”¨æˆ–é…ç½®è¯¯å¯¼æ€§çš„è§„åˆ™ï¼Œå¯èƒ½ä¼šç”Ÿæˆè™šå‡æ•°æ®ï¼Œåˆ¶é€ å™ªéŸ³ï¼Œæˆ–æ©ç›–æ¶æ„æ´»åŠ¨ã€‚
```bash
aws cloudwatch disable-insight-rules --rule-names <value>
aws cloudwatch enable-insight-rules --rule-names <value>
```
**æ½œåœ¨å½±å“**ï¼šæ“ä½œå›¢é˜Ÿä¹‹é—´çš„æ··æ·†ï¼Œå¯¼è‡´å¯¹å®é™…é—®é¢˜çš„å“åº”å»¶è¿Ÿï¼Œä»¥åŠåŸºäºé”™è¯¯è­¦æŠ¥çš„ä¸å¿…è¦è¡ŒåŠ¨ã€‚

### **`cloudwatch:DeleteMetricStream` , `cloudwatch:PutMetricStream` , `cloudwatch:PutMetricData`**

æ‹¥æœ‰ **`cloudwatch:DeleteMetricStream`** å’Œ **`cloudwatch:PutMetricStream`** æƒé™çš„æ”»å‡»è€…å°†èƒ½å¤Ÿåˆ›å»ºå’Œåˆ é™¤æŒ‡æ ‡æ•°æ®æµï¼Œä»è€Œå±å®³å®‰å…¨æ€§ã€ç›‘æ§å’Œæ•°æ®å®Œæ•´æ€§ï¼š

* **åˆ›å»ºæ¶æ„æµ**ï¼šåˆ›å»ºæŒ‡æ ‡æµï¼Œå°†æ•æ„Ÿæ•°æ®å‘é€åˆ°æœªç»æˆæƒçš„ç›®çš„åœ°ã€‚
* **èµ„æºæ“æ§**ï¼šåˆ›å»ºè¿‡å¤šæ•°æ®çš„æ–°æŒ‡æ ‡æµå¯èƒ½ä¼šäº§ç”Ÿå¤§é‡å™ªéŸ³ï¼Œå¯¼è‡´é”™è¯¯è­¦æŠ¥ï¼Œæ©ç›–çœŸå®é—®é¢˜ã€‚
* **ç›‘æ§ä¸­æ–­**ï¼šåˆ é™¤æŒ‡æ ‡æµï¼Œæ”»å‡»è€…å°†ä¸­æ–­ç›‘æ§æ•°æ®çš„æŒç»­æµåŠ¨ã€‚è¿™æ ·ï¼Œä»–ä»¬çš„æ¶æ„æ´»åŠ¨å°†æœ‰æ•ˆéšè—ã€‚

åŒæ ·ï¼Œæ‹¥æœ‰ **`cloudwatch:PutMetricData`** æƒé™ï¼Œå¯ä»¥å‘æŒ‡æ ‡æµæ·»åŠ æ•°æ®ã€‚è¿™å¯èƒ½å¯¼è‡´ç”±äºæ·»åŠ äº†å¤§é‡ä¸å½“æ•°æ®è€Œé€ æˆçš„æ‹’ç»æœåŠ¡ï¼Œä½¿å…¶å®Œå…¨æ— ç”¨ã€‚
```bash
aws cloudwatch delete-metric-stream --name <value>
aws cloudwatch put-metric-stream --name <value> [--include-filters <value>] [--exclude-filters <value>] --firehose-arn <value> --role-arn <value> --output-format <value>
aws cloudwatch put-metric-data --namespace <value> [--metric-data <value>] [--metric-name <value>] [--timestamp <value>] [--unit <value>] [--value <value>] [--dimensions <value>]
```
åœ¨ç»™å®šçš„ EC2 å®ä¾‹ä¸Šæ·»åŠ ä¸ 70% CPU åˆ©ç”¨ç‡ç›¸å¯¹åº”çš„æ•°æ®çš„ç¤ºä¾‹ï¼š
```bash
aws cloudwatch put-metric-data --namespace "AWS/EC2" --metric-name "CPUUtilization" --value 70 --unit "Percent" --dimensions "InstanceId=i-0123456789abcdefg"
```
**æ½œåœ¨å½±å“**ï¼šç›‘æ§æ•°æ®æµçš„ä¸­æ–­ï¼Œå½±å“å¼‚å¸¸å’Œäº‹ä»¶çš„æ£€æµ‹ï¼Œèµ„æºæ“æ§ä»¥åŠç”±äºåˆ›å»ºè¿‡å¤šçš„æŒ‡æ ‡æµè€Œå¯¼è‡´çš„æˆæœ¬å¢åŠ ã€‚

### **`cloudwatch:StopMetricStreams`, `cloudwatch:StartMetricStreams`**

æ”»å‡»è€…å°†æ§åˆ¶å—å½±å“çš„æŒ‡æ ‡æ•°æ®æµçš„æµåŠ¨ï¼ˆå¦‚æœæ²¡æœ‰èµ„æºé™åˆ¶ï¼Œåˆ™æ¯ä¸ªæ•°æ®æµï¼‰ã€‚é€šè¿‡æƒé™ **`cloudwatch:StopMetricStreams`**ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœæ­¢å…³é”®æŒ‡æ ‡æµæ¥éšè—å…¶æ¶æ„æ´»åŠ¨ã€‚
```bash
aws cloudwatch stop-metric-streams --names <value>
aws cloudwatch start-metric-streams --names <value>
```
**æ½œåœ¨å½±å“**ï¼šç›‘æ§æ•°æ®æµçš„ä¸­æ–­ï¼Œå½±å“å¼‚å¸¸å’Œäº‹ä»¶çš„æ£€æµ‹ã€‚

### **`cloudwatch:TagResource`, `cloudwatch:UntagResource`**

æ”»å‡»è€…å°†èƒ½å¤Ÿæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤CloudWatchèµ„æºçš„æ ‡ç­¾ï¼ˆç›®å‰ä»…é™äºè­¦æŠ¥å’Œè´¡çŒ®è€…æ´å¯Ÿè§„åˆ™ï¼‰ã€‚è¿™å¯èƒ½ä¼šå¹²æ‰°æ‚¨ç»„ç»‡åŸºäºæ ‡ç­¾çš„è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚
```bash
aws cloudwatch tag-resource --resource-arn <value> --tags <value>
aws cloudwatch untag-resource --resource-arn <value> --tag-keys <value>
```
**æ½œåœ¨å½±å“**ï¼šä¸­æ–­åŸºäºæ ‡ç­¾çš„è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://cloudsecdocs.com/aws/services/logging/cloudwatch/](https://cloudsecdocs.com/aws/services/logging/cloudwatch/#general-info)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoncloudwatch.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list\_amazoncloudwatch.html)
* [https://docs.aws.amazon.com/es\_es/AmazonCloudWatch/latest/monitoring/cloudwatch\_concepts.html#Metric](https://docs.aws.amazon.com/es\_es/AmazonCloudWatch/latest/monitoring/cloudwatch\_concepts.html#Metric)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
