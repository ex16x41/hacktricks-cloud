# AWS - WAF Enum

## AWS - WAF Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## AWS WAF

AWS WAF - —Ü–µ **—Ñ–∞—î—Ä–≤–æ–ª –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤**, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è **–∑–∞—Ö–∏—Å—Ç—É –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤ –∞–±–æ API** –≤—ñ–¥ —Ä—ñ–∑–Ω–∏—Ö –≤–µ–±-–µ–∫—Å–ø–ª–æ–π—Ç—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–ø–ª–∏–Ω—É—Ç–∏ –Ω–∞ —ó—Ö –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å, –±–µ–∑–ø–µ–∫—É –∞–±–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤. –í—ñ–Ω –Ω–∞–¥–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤—Ö—ñ–¥–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫, –Ω–∞–ª–∞—à—Ç–æ–≤—É—é—á–∏ **–ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏**, —è–∫—ñ –∑–º–µ–Ω—à—É—é—Ç—å —Ç–∏–ø–æ–≤—ñ –≤–µ–∫—Ç–æ—Ä–∏ –∞—Ç–∞–∫, —Ç–∞–∫—ñ —è–∫ SQL-—ñ–Ω'—î–∫—Ü—ñ—ó –∞–±–æ –º—ñ–∂—Å–∞–π—Ç–æ–≤–µ —Å–∫—Ä–∏–ø—Ç—É–≤–∞–Ω–Ω—è, –∞ —Ç–∞–∫–æ–∂ –≤–∏–∑–Ω–∞—á–∞—é—á–∏ –≤–ª–∞—Å–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó.

### –ö–ª—é—á–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó

#### Web ACL (–°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É)

Web ACL - —Ü–µ –∫–æ–ª–µ–∫—Ü—ñ—è –ø—Ä–∞–≤–∏–ª, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –¥–æ —Å–≤–æ—ó—Ö –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤ –∞–±–æ API. –ö–æ–ª–∏ –≤–∏ –∞—Å–æ—Ü—ñ—é—î—Ç–µ Web ACL –∑ —Ä–µ—Å—É—Ä—Å–æ–º, AWS WAF –ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø—Ä–∞–≤–∏–ª, –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö —É Web ACL, —ñ –≤–∏–∫–æ–Ω—É—î –≤–∫–∞–∑–∞–Ω—ñ –¥—ñ—ó.

#### –ì—Ä—É–ø–∞ –ø—Ä–∞–≤–∏–ª

–ì—Ä—É–ø–∞ –ø—Ä–∞–≤–∏–ª - —Ü–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∞ –∫–æ–ª–µ–∫—Ü—ñ—è –ø—Ä–∞–≤–∏–ª, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –¥–æ –∫—ñ–ª—å–∫–æ—Ö Web ACL. –ì—Ä—É–ø–∏ –ø—Ä–∞–≤–∏–ª –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å —É–ø—Ä–∞–≤–ª—è—Ç–∏ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –Ω–∞–±–æ—Ä–∏ –ø—Ä–∞–≤–∏–ª –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤ –∞–±–æ API.

–ö–æ–∂–Ω–∞ –≥—Ä—É–ø–∞ –ø—Ä–∞–≤–∏–ª –º–∞—î —Å–≤–æ—é –∞—Å–æ—Ü—ñ–π–æ–≤–∞–Ω—É **—î–º–Ω—ñ—Å—Ç—å**, —è–∫–∞ –¥–æ–ø–æ–º–∞–≥–∞—î —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∞—à–∏—Ö –ø—Ä–∞–≤–∏–ª, –≥—Ä—É–ø –ø—Ä–∞–≤–∏–ª —ñ –≤–µ–± ACL. –ü—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –ø—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –π–æ–≥–æ –Ω–µ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏.

#### –ü—Ä–∞–≤–∏–ª–æ

–ü—Ä–∞–≤–∏–ª–æ –≤–∏–∑–Ω–∞—á–∞—î –Ω–∞–±—ñ—Ä —É–º–æ–≤, —è–∫—ñ AWS WAF –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—Ö—ñ–¥–Ω–∏—Ö –≤–µ–±-–∑–∞–ø–∏—Ç—ñ–≤. –Ü—Å–Ω—É—î –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ç–∏–ø–∏ –ø—Ä–∞–≤–∏–ª:

1. **–ó–≤–∏—á–∞–π–Ω–µ –ø—Ä–∞–≤–∏–ª–æ**: –¶–µ–π —Ç–∏–ø –ø—Ä–∞–≤–∏–ª–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–∫–∞–∑–∞–Ω—ñ —É–º–æ–≤–∏, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —á–∏ –¥–æ–∑–≤–æ–ª–∏—Ç–∏, –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –∞–±–æ –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤–µ–±-–∑–∞–ø–∏—Ç–∏.
2. **–ü—Ä–∞–≤–∏–ª–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ**: –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∑–∞–ø–∏—Ç–∏ –∑ –ø–µ–≤–Ω–æ—ó IP-–∞–¥—Ä–µ—Å–∏ –ø—Ä–æ—Ç—è–≥–æ–º –ø'—è—Ç–∏ —Ö–≤–∏–ª–∏–Ω. –¢—É—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –ø–æ—Ä—ñ–≥, —ñ —è–∫—â–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ –∑ IP –ø–µ—Ä–µ–≤–∏—â—É—î —Ü–µ–π –ª—ñ–º—ñ—Ç –ø—Ä–æ—Ç—è–≥–æ–º –ø'—è—Ç–∏ —Ö–≤–∏–ª–∏–Ω, –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏ –∑ —Ü—ñ—î—ó IP –±–ª–æ–∫—É—é—Ç—å—Å—è, –ø–æ–∫–∏ —à–≤–∏–¥–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ –Ω–µ –∑–Ω–∏–∑–∏—Ç—å—Å—è –Ω–∏–∂—á–µ –ø–æ—Ä–æ–≥—É. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ø–æ—Ä—ñ–≥ –¥–ª—è –ø—Ä–∞–≤–∏–ª –Ω–∞ –æ—Å–Ω–æ–≤—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å **2000 –∑–∞–ø–∏—Ç—ñ–≤**.

#### –ö–µ—Ä–æ–≤–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞

AWS WAF –ø—Ä–æ–ø–æ–Ω—É—î –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ, –∫–µ—Ä–æ–≤–∞–Ω—ñ –Ω–∞–±–æ—Ä–∏ –ø—Ä–∞–≤–∏–ª, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è AWS —Ç–∞ –ø—Ä–æ–¥–∞–≤—Ü—è–º–∏ AWS Marketplace. –¶—ñ –Ω–∞–±–æ—Ä–∏ –ø—Ä–∞–≤–∏–ª –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –∑–∞–≥—Ä–æ–∑ —ñ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è –¥–ª—è —É—Å—É–Ω–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π.

#### –ù–∞–±—ñ—Ä IP

–ù–∞–±—ñ—Ä IP - —Ü–µ —Å–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ IP-–∞–¥—Ä–µ—Å, —è–∫—ñ –≤–∏ —Ö–æ—á–µ—Ç–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∞–±–æ –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏. –ù–∞–±–æ—Ä–∏ IP —Å–ø—Ä–æ—â—É—é—Ç—å –ø—Ä–æ—Ü–µ—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ IP.

#### –ù–∞–±—ñ—Ä —à–∞–±–ª–æ–Ω—ñ–≤ Regex

–ù–∞–±—ñ—Ä —à–∞–±–ª–æ–Ω—ñ–≤ Regex –º—ñ—Å—Ç–∏—Ç—å –æ–¥–∏–Ω –∞–±–æ –∫—ñ–ª—å–∫–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤ (regex), —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —à–∞–±–ª–æ–Ω–∏ –¥–ª—è –ø–æ—à—É–∫—É —É –≤–µ–±-–∑–∞–ø–∏—Ç–∞—Ö. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ, —Ç–∞–∫–∏—Ö —è–∫ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π —Å–∏–º–≤–æ–ª—ñ–≤.

#### –¢–æ–∫–µ–Ω –±–ª–æ–∫—É–≤–∞–Ω–Ω—è

–¢–æ–∫–µ–Ω –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º—É –ø—ñ–¥ —á–∞—Å –≤–Ω–µ—Å–µ–Ω–Ω—è –∑–º—ñ–Ω –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ WAF. –í—ñ–Ω –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ–± –∑–º—ñ–Ω–∏ –Ω–µ –±—É–ª–∏ –≤–∏–ø–∞–¥–∫–æ–≤–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ñ –∫—ñ–ª—å–∫–æ–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –∞–±–æ –ø—Ä–æ—Ü–µ—Å–∞–º–∏, —è–∫—ñ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –æ–Ω–æ–≤–∏—Ç–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ —Ä–µ—Å—É—Ä—Å –æ–¥–Ω–æ—á–∞—Å–Ω–æ.

#### API –∫–ª—é—á—ñ

API –∫–ª—é—á—ñ –≤ AWS WAF –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ –ø–µ–≤–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π API. –¶—ñ –∫–ª—é—á—ñ —à–∏—Ñ—Ä—É—é—Ç—å—Å—è —Ç–∞ —É–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –±–µ–∑–ø–µ—á–Ω–æ, —â–æ–± –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø —ñ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ–± –ª–∏—à–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–≥–ª–∏ –≤–Ω–æ—Å–∏—Ç–∏ –∑–º—ñ–Ω–∏ –¥–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π WAF.

* **–ü—Ä–∏–∫–ª–∞–¥**: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è API CAPTCHA.

#### –ü–æ–ª—ñ—Ç–∏–∫–∞ –¥–æ–∑–≤–æ–ª—ñ–≤

–ü–æ–ª—ñ—Ç–∏–∫–∞ –¥–æ–∑–≤–æ–ª—ñ–≤ - —Ü–µ –ø–æ–ª—ñ—Ç–∏–∫–∞ IAM, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î, —Ö—Ç–æ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó –∑ —Ä–µ—Å—É—Ä—Å–∞–º–∏ AWS WAF. –í–∏–∑–Ω–∞—á–∞—é—á–∏ –¥–æ–∑–≤–æ–ª–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ WAF —ñ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ–± –ª–∏—à–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–≥–ª–∏ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

#### –û–±–ª–∞—Å—Ç—å

–ü–∞—Ä–∞–º–µ—Ç—Ä –æ–±–ª–∞—Å—Ç—ñ –≤ AWS WAF –≤–∏–∑–Ω–∞—á–∞—î, —á–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª–∞ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó WAF –¥–æ —Ä–µ–≥—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É –∞–±–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É Amazon CloudFront.

* **–†–ï–ì–Ü–û–ù–ê–õ–¨–ù–ò–ô**: –ó–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ —Ä–µ–≥—ñ–æ–Ω–∞–ª—å–Ω–∏—Ö –ø–æ—Å–ª—É–≥, —Ç–∞–∫–∏—Ö —è–∫ Application Load Balancers (ALB), Amazon API Gateway REST API, AWS AppSync GraphQL API, –ø—É–ª –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ Amazon Cognito, —Å–ª—É–∂–±–∞ AWS App Runner —Ç–∞ –µ–∫–∑–µ–º–ø–ª—è—Ä AWS Verified Access. –í–∏ –≤–∫–∞–∑—É—î—Ç–µ —Ä–µ–≥—ñ–æ–Ω AWS, –¥–µ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ —Ü—ñ —Ä–µ—Å—É—Ä—Å–∏.
* **CLOUDFRONT**: –ó–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤ Amazon CloudFront, —è–∫—ñ —î –≥–ª–æ–±–∞–ª—å–Ω–∏–º–∏. –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó WAF –¥–ª—è CloudFront —É–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ä–µ–≥—ñ–æ–Ω `us-east-1`, –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, –¥–µ –ø–æ–¥–∞—î—Ç—å—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç.

### –ö–ª—é—á–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

#### –ö—Ä–∏—Ç–µ—Ä—ñ—ó –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É (–£–º–æ–≤–∏)

**–£–º–æ–≤–∏** –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∏ –≤—Ö—ñ–¥–Ω–∏—Ö HTTP/HTTPS –∑–∞–ø–∏—Ç—ñ–≤, —è–∫—ñ –º–æ–Ω—ñ—Ç–æ—Ä–∏—Ç—å AWS WAF, –¥–æ —è–∫–∏—Ö –≤—ñ–¥–Ω–æ—Å—è—Ç—å—Å—è XSS, –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–µ –ø–æ–ª–æ–∂–µ–Ω–Ω—è (GEO), IP-–∞–¥—Ä–µ—Å–∏, –æ–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É, SQL-—ñ–Ω'—î–∫—Ü—ñ—ó —Ç–∞ —à–∞–±–ª–æ–Ω–∏ (—Ä—è–¥–∫–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å regex). –í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ **–∑–∞–ø–∏—Ç–∏, –æ–±–º–µ–∂–µ–Ω—ñ –Ω–∞ —Ä—ñ–≤–Ω—ñ CloudFront –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫—Ä–∞—ó–Ω–∏, –Ω–µ –¥–æ—Å—è–≥–Ω—É—Ç—å WAF**.

–ö–æ–∂–µ–Ω –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å AWS –º–æ–∂–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏:

* **100 —É–º–æ–≤** –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É (–∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º Regex, –¥–µ –¥–æ–∑–≤–æ–ª–µ–Ω–æ –ª–∏—à–µ **10 —É–º–æ–≤**, –∞–ª–µ —Ü–µ–π –ª—ñ–º—ñ—Ç –º–æ–∂–Ω–∞ –∑–±—ñ–ª—å—à–∏—Ç–∏).
* **100 –ø—Ä–∞–≤–∏–ª** —Ç–∞ **50 Web ACL**.
* –ú–∞–∫—Å–∏–º—É–º **5 –ø—Ä–∞–≤–∏–ª –Ω–∞ –æ—Å–Ω–æ–≤—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ**.
* –ü—Ä–æ–ø—É—Å–∫–Ω—É –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å **10,000 –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ —Å–µ–∫—É–Ω–¥—É**, –∫–æ–ª–∏ WAF —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∑ –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–æ–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—ñ–≤.

#### –î—ñ—ó –ø—Ä–∞–≤–∏–ª

–î—ñ—ó –ø—Ä–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –∫–æ–∂–Ω–æ–º—É –ø—Ä–∞–≤–∏–ª—É, –∑ —Ç–∞–∫–∏–º–∏ –≤–∞—Ä—ñ–∞–Ω—Ç–∞–º–∏:

* **–î–æ–∑–≤–æ–ª–∏—Ç–∏**: –ó–∞–ø–∏—Ç –ø–µ—Ä–µ—Å–∏–ª–∞—î—Ç—å—Å—è –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É CloudFront –∞–±–æ –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—ñ–≤.
* **–ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏**: –ó–∞–ø–∏—Ç —Ç–µ—Ä–º—ñ–Ω–æ–≤–æ –ø—Ä–∏–ø–∏–Ω—è—î—Ç—å—Å—è.
* **–ü—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏**: –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∑–∞–ø–∏—Ç–∏, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —É–º–æ–≤–∞–º –ø—Ä–∞–≤–∏–ª–∞. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∞–≤–∏–ª, –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—á–∏ —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–¥ –π–æ–≥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è–º –Ω–∞ –î–æ–∑–≤–æ–ª–∏—Ç–∏ –∞–±–æ –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏.
* **CAPTCHA —Ç–∞ –í–∏–∫–ª–∏–∫:** –ü–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è, —â–æ –∑–∞–ø–∏—Ç –Ω–µ –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –≤—ñ–¥ –±–æ—Ç–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ CAPTCHA —Ç–∞ —Ç–∏—Ö—ñ –≤–∏–∫–ª–∏–∫–∏.

–Ø–∫—â–æ –∑–∞–ø–∏—Ç –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∂–æ–¥–Ω–æ–º—É –ø—Ä–∞–≤–∏–ª—É –≤ Web ACL, –≤—ñ–Ω –ø—ñ–¥–ª—è–≥–∞—î **–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥—ñ—ó** (–î–æ–∑–≤–æ–ª–∏—Ç–∏ –∞–±–æ –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏). –ü–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–∞–≤–∏–ª, –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π —É Web ACL, —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º —ñ –∑–∞–∑–≤–∏—á–∞–π —Å–ª—ñ–¥—É—î —Ü—ñ–π –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ:

1. –î–æ–∑–≤–æ–ª–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å–∏ –∑—ñ —Å–ø–∏—Å–∫—É –±—ñ–ª–∏—Ö.
2. –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å–∏ –∑—ñ —Å–ø–∏—Å–∫—É —á–æ—Ä–Ω–∏—Ö.
3. –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –±—É–¥—å-—è–∫–∏–º —à–∫—ñ–¥–ª–∏–≤–∏–º –ø—ñ–¥–ø–∏—Å–∞–º.

#### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ CloudWatch

AWS WAF —ñ–Ω—Ç–µ–≥—Ä—É—î—Ç—å—Å—è –∑ CloudWatch –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –º–µ—Ç—Ä–∏–∫–∏, —Ç–∞–∫—ñ —è–∫ AllowedRequests, BlockedRequests, CountedRequests —Ç–∞ PassedRequests. –¶—ñ –º–µ—Ç—Ä–∏–∫–∏ –∑–≤—ñ—Ç—É—é—Ç—å—Å—è —â–æ—Ö–≤–∏–ª–∏–Ω–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø—Ä–æ—Ç—è–≥–æ–º –¥–≤–æ—Ö —Ç–∏–∂–Ω—ñ–≤.

### –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

–©–æ–± –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ —Ä–æ–∑–ø–æ–¥—ñ–ª–∞–º–∏ CloudFront, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤–∫–∞–∑–∞—Ç–∏ —Ä–µ–≥—ñ–æ–Ω US East (N. Virginia):

* CLI - –í–∫–∞–∂—ñ—Ç—å —Ä–µ–≥—ñ–æ–Ω US East, –∫–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –æ–±–ª–∞—Å—Ç—å CloudFront: `--scope CLOUDFRONT --region=us-east-1`.
* API —Ç–∞ SDK - –î–ª—è –≤—Å—ñ—Ö –≤–∏–∫–ª–∏–∫—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ä–µ–≥—ñ–æ–Ω–∞–ª—å–Ω–∏–π –∫—ñ–Ω—Ü–µ–≤–∏–π –ø—É–Ω–∫—Ç us-east-1.

–©–æ–± –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ —Ä–µ–≥—ñ–æ–Ω–∞–ª—å–Ω–∏–º–∏ –ø–æ—Å–ª—É–≥–∞–º–∏, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤–∫–∞–∑–∞—Ç–∏ —Ä–µ–≥—ñ–æ–Ω:

* –ü—Ä–∏–∫–ª–∞–¥ –∑ —Ä–µ–≥—ñ–æ–Ω–æ–º –Ñ–≤—Ä–æ–ø–∞ (–Ü—Å–ø–∞–Ω—ñ—è): `--scope REGIONAL --region=eu-south-2`
```bash
# Web ACLs #

## Retrieve a list of web access control lists (Web ACLs) available in your AWS account
aws wafv2 list-web-acls --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve details about the specified Web ACL
aws wafv2 get-web-acl --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

## Retrieve a list of resources associated with a specific web access control list (Web ACL)
aws wafv2 list-resources-for-web-acl --web-acl-arn <value> # Additional permissions needed depending on the protected resource type: cognito-idp:ListResourcesForWebACL, ec2:DescribeVerifiedAccessInstanceWebAclAssociations or apprunner:ListAssociatedServicesForWebAcl
## Retrieve the Web ACL associated with the specified AWS resource
aws wafv2 get-web-acl-for-resource --resource-arn <arn> # Additional permissions needed depending on the protected resource type: cognito-idp:GetWebACLForResource, ec2:GetVerifiedAccessInstanceWebAcl, wafv2:GetWebACL or apprunner:DescribeWebAclForService

# Rule groups #

## List of the rule groups available in your AWS account
aws wafv2 list-rule-groups --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the details of a specific rule group
aws wafv2 get-rule-group [--name <value>] [--id <value>] [--arn <value>] [--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>]
## Retrieve the IAM policy attached to the specified rule group
aws wafv2 get-permission-policy --resource-arn <rule-group-arn> # Just the owner of the Rule Group can do this operation

# Managed rule groups (by AWS or by a third-party) #

## List the managed rule groups that are available
aws wafv2 list-available-managed-rule-groups --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## List the available versions of the specified managed rule group
aws wafv2 list-available-managed-rule-group-versions --vendor-name <value> --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve high-level information about a specific managed rule group
aws wafv2 describe-managed-rule-group --vendor-name <value> --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--version-name <value>]
## Retrieve high-level information about all managed rule groups
aws wafv2 describe-all-managed-products --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve high-level information about all managed rule groups from a specific vendor
aws wafv2 describe-managed-products-by-vendor --vendor-name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

# IP sets #

## List the IP sets that are available in your AWS account
aws wafv2 list-ip-sets --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the specific IP set
aws wafv2 get-ip-set --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the keys that are currently being managed by a rate-based rule.
aws wafv2 get-rate-based-statement-managed-keys --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>\
--web-acl-name <value> --web-acl-id <value> --rule-name <value> [--rule-group-rule-name <value>]

# Regex pattern sets #

## List all the regex pattern sets that you manage
aws wafv2 list-regex-pattern-sets --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieves the specified regex pattern sets
aws wafv2 get-regex-pattern-set --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

# API Keys #

## List API keys for the specified scope
aws wafv2 list-api-keys --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve decrypted API key
aws wafv2 get-decrypted-api-key --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --api-key <value>

# Logs #

## List of logging configurations (storage location of the logs)
aws wafv2 list-logging-configurations --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--log-scope <value>]
## Retrieve the logging configuration settings associated with a specific web ACL
aws wafv2 get-logging-configuration --resource-arn <value> [--log-scope <CUSTOMER | SECURITY_LAKE>] [--log-type <value>]

# Miscelaneous #

## Retrieve a list of the tags associated to the specified resource
aws wafv2 list-tags-for-resource resource-arn <value>

## Retrieve a sample of web requests that match a specified rule within a WebACL during a specified time range
aws wafv2 get-sampled-requests --web-acl-arn <value> --rule-metric-name <value> --time-window <value> --max-items <1-500> --scope <value>

## Obtains the web ACL capacity unit (WCU) requirements for a specified scope and ruleset
aws wafv2 check-capacity --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --rules <value>

## List of available releases for the AWS WAFv2 mobile SDK
aws wafv2 list-mobile-sdk-releases --platform <IOS | ANDROID>
## Retrieves information for the specified mobile SDK release
aws wafv2 get-mobile-sdk-release --platform <value> --release-version <value>

```
### Post Exploitation / Bypass

{% hint style="success" %}
–ó —Ç–æ—á–∫–∏ –∑–æ—Ä—É –∞—Ç–∞–∫—É—é—á–æ–≥–æ, —Ü–µ–π —Å–µ—Ä–≤—ñ—Å –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –∞—Ç–∞–∫—É—é—á–æ–º—É –≤–∏—è–≤–∏—Ç–∏ –∑–∞—Ö–∏—Å—Ç–∏ WAF —Ç–∞ –º–µ—Ä–µ–∂–µ–≤—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —è–∫—ñ –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ –π–æ–º—É —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ —ñ–Ω—à—ñ –≤–µ–±-—Å–∞–π—Ç–∏.

–û–¥–Ω–∞–∫ –∞—Ç–∞–∫—É—é—á–∏–π —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –∑–∞—Ü—ñ–∫–∞–≤–ª–µ–Ω–∏–π —É –ø–æ—Ä—É—à–µ–Ω–Ω—ñ —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É, —â–æ–± –≤–µ–±-—Å–∞–π—Ç–∏ –Ω–µ –±—É–ª–∏ –∑–∞—Ö–∏—â–µ–Ω—ñ WAF.
{% endhint %}

–£ –±–∞–≥–∞—Ç—å–æ—Ö –æ–ø–µ—Ä–∞—Ü—ñ—è—Ö –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±—É–¥–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –Ω–∞–¥–∞—Ç–∏ **lock token**. –¶–µ–π —Ç–æ–∫–µ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –∑–∞ –æ–¥–Ω–æ—á–∞—Å–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏, —â–æ–± –∑–º—ñ–Ω–∏ –Ω–µ –±—É–ª–∏ –≤–∏–ø–∞–¥–∫–æ–≤–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ñ –∫—ñ–ª—å–∫–æ–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –∞–±–æ –ø—Ä–æ—Ü–µ—Å–∞–º–∏, —è–∫—ñ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –æ–Ω–æ–≤–∏—Ç–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ —Ä–µ—Å—É—Ä—Å –æ–¥–Ω–æ—á–∞—Å–Ω–æ. –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü–µ–π —Ç–æ–∫–µ–Ω, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ **list** –∞–±–æ **get** –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º —Ä–µ—Å—É—Ä—Å–æ–º.

#### **`wafv2:CreateRuleGroup`, `wafv2:UpdateRuleGroup`, `wafv2:DeleteRuleGroup`**

–ê—Ç–∞–∫—É—é—á–∏–π –∑–º–æ–∂–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –±–µ–∑–ø–µ–∫—É —É—Ä–∞–∂–µ–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É, –≤–∏–∫–æ–Ω—É—é—á–∏:

* –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä—É–ø –ø—Ä–∞–≤–∏–ª, —è–∫—ñ –º–æ–∂—É—Ç—å, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –±–ª–æ–∫—É–≤–∞—Ç–∏ –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ –∑ –ª–µ–≥—ñ—Ç–∏–º–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å, –≤–∏–∫–ª–∏–∫–∞—é—á–∏ –≤—ñ–¥–º–æ–≤—É –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ.
* –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≥—Ä—É–ø –ø—Ä–∞–≤–∏–ª, –º–∞—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —ó—Ö –¥—ñ—ó, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑ **Block** –Ω–∞ **Allow**.
* –í–∏–¥–∞–ª–µ–Ω–Ω—è –≥—Ä—É–ø –ø—Ä–∞–≤–∏–ª, —è–∫—ñ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤—ñ –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏.
```bash
# Create Rule Group
aws wafv2 create-rule-group --name <value> --capacity <value> --visibility-config <value> \
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--description <value>]
# Update Rule Group
aws wafv2 update-rule-group --name <value> --id <value> --visibility-config <value> --lock-token <value>\
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--description <value>]
# Delete Rule Group
aws wafv2 delete-rule-group --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
–ù–∞—Å—Ç—É–ø–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –ø–æ–∫–∞–∑—É—é—Ç—å –≥—Ä—É–ø—É –ø—Ä–∞–≤–∏–ª, —è–∫–∞ –±–ª–æ–∫—É—î –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å:
```bash
aws wafv2 create-rule-group --name BlockLegitimateIPsRuleGroup --capacity 1 --visibility-config SampledRequestsEnabled=false,CloudWatchMetricsEnabled=false,MetricName=BlockLegitimateIPsRuleGroup --scope CLOUDFRONT --region us-east-1 --rules file://rule.json
```
–§–∞–π–ª **rule.json** –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ —Ç–∞–∫:
```json
[
{
"Name":"BlockLegitimateIPsRule",
"Priority":0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:global/ipset/legitIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action":{
"Block":{}
},
"VisibilityConfig":{
"SampledRequestsEnabled":false,
"CloudWatchMetricsEnabled":false,
"MetricName":"BlockLegitimateIPsRule"
}
}
]
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ù–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø, –≤–∏—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –∞—Ç–∞–∫–∏ DoS.

#### **`wafv2:CreateWebACL`, `wafv2:UpdateWebACL`, `wafv2:DeleteWebACL`**

–ó —Ü–∏–º–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ:

* –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π Web ACL, –≤–≤–æ–¥—è—á–∏ –ø—Ä–∞–≤–∏–ª–∞, —è–∫—ñ –∞–±–æ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —à–∫—ñ–¥–ª–∏–≤–∏–π —Ç—Ä–∞—Ñ—ñ–∫, –∞–±–æ –±–ª–æ–∫—É—é—Ç—å –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫, —Ñ–∞–∫—Ç–∏—á–Ω–æ —Ä–æ–±–ª—è—á–∏ WAF –±–µ–∑–∫–æ—Ä–∏—Å–Ω–∏–º –∞–±–æ –≤–∏–∫–ª–∏–∫–∞—é—á–∏ –≤—ñ–¥–º–æ–≤—É –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ.
* –û–Ω–æ–≤–∏—Ç–∏ —ñ—Å–Ω—É—é—á—ñ Web ACL, –º–∞—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –¥–æ–∑–≤–æ–ª—É –∞—Ç–∞–∫, —Ç–∞–∫–∏—Ö —è–∫ SQL-—ñ–Ω'—î–∫—Ü—ñ—ó –∞–±–æ –º—ñ–∂—Å–∞–π—Ç–æ–≤–µ —Å–∫—Ä–∏–ø—Ç—É–≤–∞–Ω–Ω—è, —è–∫—ñ —Ä–∞–Ω—ñ—à–µ –±—É–ª–∏ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω—ñ, –∞–±–æ –ø–æ—Ä—É—à–∏—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π –ø–æ—Ç—ñ–∫ —Ç—Ä–∞—Ñ—ñ–∫—É, –±–ª–æ–∫—É—é—á–∏ –¥—ñ–π—Å–Ω—ñ –∑–∞–ø–∏—Ç–∏.
* –í–∏–¥–∞–ª–∏—Ç–∏ Web ACL, –∑–∞–ª–∏—à–∞—é—á–∏ —É—Ä–∞–∂–µ–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–∑–∞—Ö–∏—â–µ–Ω–∏–º–∏, –ø—ñ–¥–¥–∞—é—á–∏ —ó—Ö —à–∏—Ä–æ–∫–æ–º—É —Å–ø–µ–∫—Ç—Ä—É –≤–µ–±-–∞—Ç–∞–∫.

{% hint style="info" %}
–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –≤–∫–∞–∑–∞–Ω–∏–π **WebACL** –ª–∏—à–µ —è–∫—â–æ **ManagedByFirewallManager** —î false.
{% endhint %}
```bash
# Create Web ACL
aws wafv2 create-web-acl --name <value> --default-action <value> --visibility-config <value> \
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--captcha-config <value>] [--description <value>]
# Update Web ACL
aws wafv2 update-web-acl --name <value> --id <value> --default-action <value> --visibility-config <value> --lock-token <value>\
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--captcha-config <value>] [--description <value>]
# Delete Web ACL
aws wafv2 delete-web-acl --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
–ù–∞—Å—Ç—É–ø–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –ø–æ–∫–∞–∑—É—é—Ç—å, —è–∫ –æ–Ω–æ–≤–∏—Ç–∏ Web ACL, —â–æ–± –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É IP. –Ø–∫—â–æ –≤–∏—Ö—ñ–¥–Ω–∏–π IP –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∂–æ–¥–Ω–æ–º—É –∑ —Ü–∏—Ö IP, —Ç–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ç–∞–∫–æ–∂ –±—É–¥–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ DoS.

**–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π Web ACL**:
```json
{
"WebACL": {
"Name": "AllowLegitimateIPsWebACL",
"Id": "1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f",
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/webacl/AllowLegitimateIPsWebACL/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f",
"DefaultAction": {
"Allow": {}
},
"Description": "",
"Rules": [
{
"Name": "AllowLegitimateIPsRule",
"Priority": 0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/ipset/LegitimateIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action": {
"Allow": {}
},
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "AllowLegitimateIPsRule"
}
}
],
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "AllowLegitimateIPsWebACL"
},
"Capacity": 1,
"ManagedByFirewallManager": false,
"LabelNamespace": "awswaf:123456789012:webacl:AllowLegitimateIPsWebACL:"
},
"LockToken": "1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}

```
–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è Web ACL:
```json
aws wafv2 update-web-acl --name AllowLegitimateIPsWebACL --scope REGIONAL --id 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --lock-token 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --default-action Block={} --visibility-config SampledRequestsEnabled=false,CloudWatchMetricsEnabled=false,MetricName=AllowLegitimateIPsWebACL --rules file://rule.json --region us-east-1
```
–§–∞–π–ª **rule.json** –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ —Ç–∞–∫:
```json
[
{
"Name": "BlockLegitimateIPsRule",
"Priority": 0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/ipset/LegitimateIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action": {
"Block": {}
},
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "BlockLegitimateIPRule"
}
}
]
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø, –≤–∏—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –∞—Ç–∞–∫–∏ DoS.

#### **`wafv2:AssociateWebACL`, `wafv2:DisassociateWebACL`**

–î–æ–∑–≤—ñ–ª **`wafv2:AssociateWebACL`** –¥–æ–∑–≤–æ–ª–∏–≤ –±–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –∞—Å–æ—Ü—ñ—é–≤–∞—Ç–∏ –≤–µ–± ACL (–°–ø–∏—Å–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É) –∑ —Ä–µ—Å—É—Ä—Å–∞–º–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î –æ–±—ñ–π—Ç–∏ –∑–∞—Å–æ–±–∏ –±–µ–∑–ø–µ–∫–∏, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ–º—É —Ç—Ä–∞—Ñ—ñ–∫—É –¥–æ—Å—è–≥–∞—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ–π, —Ç–∞–∫–∏—Ö —è–∫ SQL-—ñ–Ω'—î–∫—Ü—ñ—è –∞–±–æ –º—ñ–∂—Å–∞–π—Ç–æ–≤–µ —Å–∫—Ä–∏–ø—Ç—É–≤–∞–Ω–Ω—è (XSS). –£ —Å–≤–æ—é —á–µ—Ä–≥—É, –∑ –¥–æ–∑–≤–æ–ª–æ–º **`wafv2:DisassociateWebACL`** –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º—ñ–≥ –±–∏ —Ç–∏–º—á–∞—Å–æ–≤–æ –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∑–∞—Å–æ–±–∏ –±–µ–∑–ø–µ–∫–∏, –ø—ñ–¥–¥–∞—é—á–∏ —Ä–µ—Å—É—Ä—Å–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º –±–µ–∑ –≤–∏—è–≤–ª–µ–Ω–Ω—è.

–î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–æ–∑–≤–æ–ª–∏ –∑–Ω–∞–¥–æ–±–ª—è—Ç—å—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–∏–ø—É –∑–∞—Ö–∏—â–µ–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É:

* **–ê—Å–æ—Ü—ñ—é–≤–∞—Ç–∏**
* apigateway:SetWebACL
* apprunner:AssociateWebAcl
* appsync:SetWebACL
* cognito-idp:AssociateWebACL
* ec2:AssociateVerifiedAccessInstanceWebAcl
* elasticloadbalancing:SetWebAcl
* **–í—ñ–¥'—î–¥–Ω–∞—Ç–∏**
* apigateway:SetWebACL
* apprunner:DisassociateWebAcl
* appsync:SetWebACL
* cognito-idp:DisassociateWebACL
* ec2:DisassociateVerifiedAccessInstanceWebAcl
* elasticloadbalancing:SetWebAcl
```bash
# Associate
aws wafv2 associate-web-acl --web-acl-arn <value> --resource-arn <value>
# Disassociate
aws wafv2 disassociate-web-acl --resource-arn <value>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∞ –±–µ–∑–ø–µ–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤, –ø—ñ–¥–≤–∏—â–µ–Ω–∏–π —Ä–∏–∑–∏–∫ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –∑–±–æ—ó –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö AWS, –∑–∞—Ö–∏—â–µ–Ω–∏—Ö AWS WAF.

#### **`wafv2:CreateIPSet` , `wafv2:UpdateIPSet`, `wafv2:DeleteIPSet`**

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ç–∞ –≤–∏–¥–∞–ª—è—Ç–∏ –Ω–∞–±–æ—Ä–∏ IP, —è–∫—ñ –∫–µ—Ä—É—é—Ç—å—Å—è AWS WAF. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—ñ –Ω–∞–±–æ—Ä–∏ IP –¥–ª—è –¥–æ–∑–≤–æ–ª—É —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É, –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞–±–æ—Ä–∏ IP –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –ª–µ–≥—ñ—Ç–∏–º–Ω–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É, –æ–Ω–æ–≤–∏—Ç–∏ —ñ—Å–Ω—É—é—á—ñ –Ω–∞–±–æ—Ä–∏ IP, —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ —à–∫—ñ–¥–ª–∏–≤—ñ IP-–∞–¥—Ä–µ—Å–∏, –≤–∏–¥–∞–ª–∏—Ç–∏ –¥–æ–≤—ñ—Ä–µ–Ω—ñ IP-–∞–¥—Ä–µ—Å–∏ –∞–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤—ñ –Ω–∞–±–æ—Ä–∏ IP, —è–∫—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤.
```bash
# Create IP set
aws wafv2 create-ip-set --name <value> --ip-address-version <IPV4 | IPV6> --addresses <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Update IP set
aws wafv2 update-ip-set --name <value> --id <value> --addresses <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Delete IP set
aws wafv2 delete-ip-set --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
–ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –ø–æ–∫–∞–∑—É—î, —è–∫ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π –Ω–∞–±—ñ—Ä IP –Ω–∞ –±–∞–∂–∞–Ω–∏–π –Ω–∞–±—ñ—Ä IP**:
```bash
aws wafv2 update-ip-set --name LegitimateIPv4Set --id 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --addresses 99.99.99.99/32 --lock-token 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --scope CLOUDFRONT --region us-east-1
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ù–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø —Ç–∞ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –ª–µ–≥—ñ—Ç–∏–º–Ω–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É.

#### **`wafv2:CreateRegexPatternSet`** , **`wafv2:UpdateRegexPatternSet`**, **`wafv2:DeleteRegexPatternSet`**

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ —Ü–∏–º–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏ –∑–º–æ–∂–µ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –Ω–∞–±–æ—Ä–∞–º–∏ —à–∞–±–ª–æ–Ω—ñ–≤ —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è AWS WAF –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –≤—Ö—ñ–¥–Ω–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤.

* –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤ —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤ –¥–æ–ø–æ–º–æ–∂–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –¥–æ–∑–≤–æ–ª–∏—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
* –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –æ–±—ñ–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏
* –í–∏–¥–∞–ª–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—ñ–≤, —è–∫—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–∏—Ö –¥—ñ–π, –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —à–∫—ñ–¥–ª–∏–≤—ñ –¥–∞–Ω—ñ —Ç–∞ –æ–±—ñ–π—Ç–∏ –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏.
```bash
# Create regex pattern set
aws wafv2 create-regex-pattern-set --name <value> --regular-expression-list <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--description <value>]
# Update regex pattern set
aws wafv2 update-regex-pattern-set --name <value> --id <value> --regular-expression-list <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Delete regex pattern set
aws wafv2 delete-regex-pattern-set --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --id <value> --lock-token <value>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –û–±—Ö—ñ–¥ –∑–∞—Å–æ–±—ñ–≤ –±–µ–∑–ø–µ–∫–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î —à–∫—ñ–¥–ª–∏–≤–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É —ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–∏–∫—Ä–∏–≤–∞—î —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ –∞–±–æ –ø–æ—Ä—É—à—É—î —Ä–æ–±–æ—Ç—É —Å–µ—Ä–≤—ñ—Å—ñ–≤ —ñ —Ä–µ—Å—É—Ä—Å—ñ–≤, –∑–∞—Ö–∏—â–µ–Ω–∏—Ö AWS WAF.

#### **(`wavf2:PutLoggingConfiguration` &** `iam:CreateServiceLinkedRole`), **`wafv2:DeleteLoggingConfiguration`**

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ **`wafv2:DeleteLoggingConfiguration`** –∑–º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∂—É—Ä–Ω–∞–ª—é–≤–∞–Ω–Ω—è –∑ –≤–∫–∞–∑–∞–Ω–æ–≥–æ Web ACL. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ, –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ **`wavf2:PutLoggingConfiguration`** —Ç–∞ **`iam:CreateServiceLinkedRole`**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∞–±–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∂—É—Ä–Ω–∞–ª—é–≤–∞–Ω–Ω—è (–ø—ñ—Å–ª—è —ó—Ö –≤–∏–¥–∞–ª–µ–Ω–Ω—è), —â–æ–± –∞–±–æ –∑–æ–≤—Å—ñ–º –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –∂—É—Ä–Ω–∞–ª—é–≤–∞–Ω–Ω—é, –∞–±–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –∂—É—Ä–Ω–∞–ª–∏ –¥–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏—Ö –º—ñ—Å—Ü—å –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–∞–∫–∏—Ö —è–∫ –∫–æ—à–∏–∫–∏ Amazon S3, –≥—Ä—É–ø–∏ –∂—É—Ä–Ω–∞–ª—ñ–≤ Amazon CloudWatch Logs –∞–±–æ Amazon Kinesis Data Firehose –ø—ñ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º.

–ü—ñ–¥ —á–∞—Å –ø—Ä–æ—Ü–µ—Å—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–µ—Ä–≤—ñ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏, —â–æ–± –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–∞–ø–∏—Å –∂—É—Ä–Ω–∞–ª—ñ–≤ –¥–æ –≤–∫–∞–∑–∞–Ω–æ–≥–æ –º—ñ—Å—Ü—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∂—É—Ä–Ω–∞–ª—é–≤–∞–Ω–Ω—è:

* **Amazon CloudWatch Logs:** AWS WAF —Å—Ç–≤–æ—Ä—é—î –ø–æ–ª—ñ—Ç–∏–∫—É —Ä–µ—Å—É—Ä—Å—É –Ω–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ–π –≥—Ä—É–ø—ñ –∂—É—Ä–Ω–∞–ª—ñ–≤ CloudWatch Logs. –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ AWS WAF –º–∞—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è –∑–∞–ø–∏—Å—É –∂—É—Ä–Ω–∞–ª—ñ–≤ –¥–æ –≥—Ä—É–ø–∏ –∂—É—Ä–Ω–∞–ª—ñ–≤.
* **Amazon S3 Bucket:** AWS WAF —Å—Ç–≤–æ—Ä—é—î –ø–æ–ª—ñ—Ç–∏–∫—É –∫–æ—à–∏–∫–∞ –Ω–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ–º—É –∫–æ—à–∏–∫—É S3. –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –Ω–∞–¥–∞—î AWS WAF –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∂—É—Ä–Ω–∞–ª—ñ–≤ –¥–æ –≤–∫–∞–∑–∞–Ω–æ–≥–æ –∫–æ—à–∏–∫–∞.
* **Amazon Kinesis Data Firehose:** AWS WAF —Å—Ç–≤–æ—Ä—é—î —Ä–æ–ª—å, –ø–æ–≤'—è–∑–∞–Ω—É –∑ —Å–µ—Ä–≤—ñ—Å–æ–º, —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ Kinesis Data Firehose. –¶—è —Ä–æ–ª—å –¥–æ–∑–≤–æ–ª—è—î AWS WAF –¥–æ—Å—Ç–∞–≤–ª—è—Ç–∏ –∂—É—Ä–Ω–∞–ª–∏ –¥–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É Firehose.

{% hint style="info" %}
–ú–æ–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –ª–∏—à–µ –æ–¥–Ω–µ –º—ñ—Å—Ü–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∂—É—Ä–Ω–∞–ª—é–≤–∞–Ω–Ω—è –Ω–∞ –≤–µ–± ACL.
{% endhint %}
```bash
# Put logging configuration
aws wafv2 put-logging-configuration --logging-configuration <value>
# Delete logging configuration
aws wafv2 delete-logging-configuration --resource-arn <value> [--log-scope <CUSTOMER | SECURITY_LAKE>] [--log-type <value>]
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤:** –ù–µ–ø—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å —É –±–µ–∑–ø–µ–∫–æ–≤–∏—Ö –ø–æ–¥—ñ—è—Ö, —É—Å–∫–ª–∞–¥–Ω–µ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—É —Ä–µ–∞–≥—É–≤–∞–Ω–Ω—è –Ω–∞ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç–∏ —Ç–∞ —Å–ø—Ä–∏—è–Ω–Ω—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–º –∑–ª–æ—á–∏–Ω–Ω–∏–º –¥—ñ—è–º —É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö, –∑–∞—Ö–∏—â–µ–Ω–∏—Ö AWS WAF.

#### **`wafv2:DeleteAPIKey`**

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑ —Ü–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏ –∑–º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —ñ—Å–Ω—É—é—á—ñ API-–∫–ª—é—á—ñ, —â–æ –∑—Ä–æ–±–∏—Ç—å CAPTCHA –Ω–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º —ñ –ø–æ—Ä—É—à–∏—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ –Ω–∞ –Ω—å–æ–º—É –±–∞–∑—É—î—Ç—å—Å—è, —Ç–∞–∫—É —è–∫ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Ñ–æ—Ä–º —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É. –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ü—å–æ–≥–æ CAPTCHA, —Ü–µ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –∞–±–æ –¥–æ –æ–±—Ö–æ–¥—É CAPTCHA, –∞–±–æ –¥–æ DoS, —è–∫—â–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∞–º–∏ –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–µ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º —É —Ä–µ—Å—É—Ä—Å—ñ.
```bash
# Delete API key
aws wafv2 delete-api-key --api-key <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –í–∏–º–∫–Ω–µ–Ω–Ω—è –∑–∞—Ö–∏—Å—Ç—É CAPTCHA –∞–±–æ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –ø—Ä–æ–≥—Ä–∞–º–∏, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ—Ä—É—à–µ–Ω—å –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ—ó –∫—Ä–∞–¥—ñ–∂–∫–∏ –¥–∞–Ω–∏—Ö.

#### **`wafv2:TagResource`, `wafv2:UntagResource`**

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –¥–æ–¥–∞–≤–∞—Ç–∏, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ —Ç–µ–≥–∏ –∑ —Ä–µ—Å—É—Ä—Å—ñ–≤ AWS WAFv2, —Ç–∞–∫–∏—Ö —è–∫ Web ACL, –≥—Ä—É–ø–∏ –ø—Ä–∞–≤–∏–ª, –Ω–∞–±–æ—Ä–∏ IP, –Ω–∞–±–æ—Ä–∏ —à–∞–±–ª–æ–Ω—ñ–≤ regex —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∂—É—Ä–Ω–∞–ª—é–≤–∞–Ω–Ω—è.
```bash
# Tag
aws wafv2 tag-resource --resource-arn <value> --tags <value>
# Untag
aws wafv2 untag-resource --resource-arn <value> --tag-keys <value>
```
**–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –≤–ø–ª–∏–≤**: –ü—ñ–¥—Ä–æ–±–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤, –≤–∏—Ç—ñ–∫ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—è –≤–∏—Ç—Ä–∞—Ç–∞–º–∏ —Ç–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó –¥—ñ—è–ª—å–Ω–æ—Å—Ç—ñ.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://www.citrusconsulting.com/aws-web-application-firewall-waf/#:\~:text=Conditions%20allow%20you%20to%20specify,user%20via%20a%20web%20application](https://www.citrusconsulting.com/aws-web-application-firewall-waf/)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awswafv2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awswafv2.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
