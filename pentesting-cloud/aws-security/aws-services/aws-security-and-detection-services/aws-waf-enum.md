# AWS - WAF Enum

## AWS - WAF Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## AWS WAF

AWS WAFëŠ” **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°©í™”ë²½**ìœ¼ë¡œ, **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ API**ë¥¼ ë‹¤ì–‘í•œ ì›¹ ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìëŠ” SQL ì¸ì ì…˜ì´ë‚˜ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…ê³¼ ê°™ì€ ì¼ë°˜ì ì¸ ê³µê²© ë²¡í„°ë¥¼ ì™„í™”í•˜ëŠ” **ë³´ì•ˆ ê·œì¹™**ì„ ì„¤ì •í•˜ì—¬ ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì‚¬ìš©ì ì •ì˜ í•„í„°ë§ ê·œì¹™ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì£¼ìš” ê°œë…

#### ì›¹ ACL (Access Control List)

ì›¹ ACLì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ APIì— ì ìš©í•  ìˆ˜ ìˆëŠ” ê·œì¹™ì˜ ëª¨ìŒì…ë‹ˆë‹¤. ì›¹ ACLì„ ë¦¬ì†ŒìŠ¤ì™€ ì—°ê²°í•˜ë©´ AWS WAFëŠ” ì›¹ ACLì— ì •ì˜ëœ ê·œì¹™ì— ë”°ë¼ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ê²€ì‚¬í•˜ê³  ì§€ì •ëœ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

#### ê·œì¹™ ê·¸ë£¹

ê·œì¹™ ê·¸ë£¹ì€ ì—¬ëŸ¬ ì›¹ ACLì— ì ìš©í•  ìˆ˜ ìˆëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê·œì¹™ ëª¨ìŒì…ë‹ˆë‹¤. ê·œì¹™ ê·¸ë£¹ì€ ë‹¤ì–‘í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ APIì—ì„œ ì¼ê´€ëœ ê·œì¹™ ì„¸íŠ¸ë¥¼ ê´€ë¦¬í•˜ê³  ìœ ì§€í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.

ê° ê·œì¹™ ê·¸ë£¹ì—ëŠ” ê´€ë ¨ëœ **ìš©ëŸ‰**ì´ ìˆìœ¼ë©°, ì´ëŠ” ê·œì¹™, ê·œì¹™ ê·¸ë£¹ ë° ì›¹ ACLì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ìš´ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ê³„ì‚°í•˜ê³  ì œì–´í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ìƒì„± ì¤‘ì— ê°’ì´ ì„¤ì •ë˜ë©´ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

#### ê·œì¹™

ê·œì¹™ì€ AWS WAFê°€ ë“¤ì–´ì˜¤ëŠ” ì›¹ ìš”ì²­ì„ ê²€ì‚¬í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ì¡°ê±´ ì§‘í•©ì„ ì •ì˜í•©ë‹ˆë‹¤. ê·œì¹™ì˜ ë‘ ê°€ì§€ ì£¼ìš” ìœ í˜•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

1. **ì •ê·œ ê·œì¹™**: ì´ ê·œì¹™ ìœ í˜•ì€ ì§€ì •ëœ ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬ ì›¹ ìš”ì²­ì„ í—ˆìš©, ì°¨ë‹¨ ë˜ëŠ” ê³„ì‚°í• ì§€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.
2. **ë¹„ìœ¨ ê¸°ë°˜ ê·œì¹™**: íŠ¹ì • IP ì£¼ì†Œì—ì„œ 5ë¶„ ë™ì•ˆì˜ ìš”ì²­ ìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì‚¬ìš©ìëŠ” ì„ê³„ê°’ì„ ì •ì˜í•˜ë©°, IPì—ì„œì˜ ìš”ì²­ ìˆ˜ê°€ 5ë¶„ ì´ë‚´ì— ì´ í•œë„ë¥¼ ì´ˆê³¼í•˜ë©´ í•´ë‹¹ IPì—ì„œì˜ í›„ì† ìš”ì²­ì€ ì„ê³„ê°’ì´ í•˜ë½í•  ë•Œê¹Œì§€ ì°¨ë‹¨ë©ë‹ˆë‹¤. ë¹„ìœ¨ ê¸°ë°˜ ê·œì¹™ì˜ ìµœì†Œ ì„ê³„ê°’ì€ **2000 ìš”ì²­**ì…ë‹ˆë‹¤.

#### ê´€ë¦¬ ê·œì¹™

AWS WAFëŠ” AWS ë° AWS Marketplace íŒë§¤ìê°€ ìœ ì§€ ê´€ë¦¬í•˜ëŠ” ì‚¬ì „ êµ¬ì„±ëœ ê´€ë¦¬ ê·œì¹™ ì„¸íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê·œì¹™ ì„¸íŠ¸ëŠ” ì¼ë°˜ì ì¸ ìœ„í˜‘ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ë©°, ìƒˆë¡œìš´ ì·¨ì•½ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.

#### IP ì„¸íŠ¸

IP ì„¸íŠ¸ëŠ” í—ˆìš©í•˜ê±°ë‚˜ ì°¨ë‹¨í•˜ë ¤ëŠ” IP ì£¼ì†Œ ë˜ëŠ” IP ì£¼ì†Œ ë²”ìœ„ì˜ ëª©ë¡ì…ë‹ˆë‹¤. IP ì„¸íŠ¸ëŠ” IP ê¸°ë°˜ ê·œì¹™ ê´€ë¦¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‹¨ìˆœí™”í•©ë‹ˆë‹¤.

#### ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ ì„¸íŠ¸

ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ ì„¸íŠ¸ëŠ” ì›¹ ìš”ì²­ì—ì„œ ê²€ìƒ‰í•  íŒ¨í„´ì„ ì •ì˜í•˜ëŠ” í•˜ë‚˜ ì´ìƒì˜ ì •ê·œ í‘œí˜„ì‹(ì •ê·œì‹)ì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ëŠ” íŠ¹ì • ë¬¸ì ì‹œí€€ìŠ¤ë¥¼ í•„í„°ë§í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë” ë³µì¡í•œ ë§¤ì¹­ ì‹œë‚˜ë¦¬ì˜¤ì— ìœ ìš©í•©ë‹ˆë‹¤.

#### ì ê¸ˆ í† í°

ì ê¸ˆ í† í°ì€ WAF ë¦¬ì†ŒìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ë™ì‹œì„± ì œì–´ì— ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŠ” ì—¬ëŸ¬ ì‚¬ìš©ìë‚˜ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ê³  í•  ë•Œ ë³€ê²½ ì‚¬í•­ì´ ìš°ì—°íˆ ë®ì–´ì“°ì—¬ì§€ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.

#### API í‚¤

AWS WAFì˜ API í‚¤ëŠ” íŠ¹ì • API ì‘ì—…ì— ëŒ€í•œ ìš”ì²­ì„ ì¸ì¦í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í‚¤ëŠ” ì•”í˜¸í™”ë˜ì–´ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë˜ë©°, ì ‘ê·¼ì„ ì œì–´í•˜ê³  ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë§Œ WAF êµ¬ì„±ì„ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.

* **ì˜ˆì‹œ**: CAPTCHA API í†µí•©.

#### ê¶Œí•œ ì •ì±…

ê¶Œí•œ ì •ì±…ì€ AWS WAF ë¦¬ì†ŒìŠ¤ì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì„ ì§€ì •í•˜ëŠ” IAM ì •ì±…ì…ë‹ˆë‹¤. ê¶Œí•œì„ ì •ì˜í•¨ìœ¼ë¡œì¨ WAF ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œì–´í•˜ê³  ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë§Œ êµ¬ì„±ì„ ìƒì„±, ì—…ë°ì´íŠ¸ ë˜ëŠ” ì‚­ì œí•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ë²”ìœ„

AWS WAFì˜ ë²”ìœ„ ë§¤ê°œë³€ìˆ˜ëŠ” WAF ê·œì¹™ ë° êµ¬ì„±ì´ ì§€ì—­ ì• í”Œë¦¬ì¼€ì´ì…˜ ë˜ëŠ” Amazon CloudFront ë°°í¬ì— ì ìš©ë˜ëŠ”ì§€ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.

* **REGIONAL**: Application Load Balancers (ALB), Amazon API Gateway REST API, AWS AppSync GraphQL API, Amazon Cognito ì‚¬ìš©ì í’€, AWS App Runner ì„œë¹„ìŠ¤ ë° AWS Verified Access ì¸ìŠ¤í„´ìŠ¤ì™€ ê°™ì€ ì§€ì—­ ì„œë¹„ìŠ¤ì— ì ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¦¬ì†ŒìŠ¤ê°€ ìœ„ì¹˜í•œ AWS ë¦¬ì „ì„ ì§€ì •í•©ë‹ˆë‹¤.
* **CLOUDFRONT**: Amazon CloudFront ë°°í¬ì— ì ìš©ë˜ë©°, ì´ëŠ” ì „ ì„¸ê³„ì ì…ë‹ˆë‹¤. CloudFrontì— ëŒ€í•œ WAF êµ¬ì„±ì€ ì½˜í…ì¸ ê°€ ì œê³µë˜ëŠ” ìœ„ì¹˜ì™€ ê´€ê³„ì—†ì´ `us-east-1` ë¦¬ì „ì„ í†µí•´ ê´€ë¦¬ë©ë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥

#### ëª¨ë‹ˆí„°ë§ ê¸°ì¤€ (ì¡°ê±´)

**ì¡°ê±´**ì€ AWS WAFê°€ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë“¤ì–´ì˜¤ëŠ” HTTP/HTTPS ìš”ì²­ì˜ ìš”ì†Œë¥¼ ì§€ì •í•˜ë©°, ì—¬ê¸°ì—ëŠ” XSS, ì§€ë¦¬ì  ìœ„ì¹˜(GEO), IP ì£¼ì†Œ, í¬ê¸° ì œì•½, SQL ì¸ì ì…˜ ë° íŒ¨í„´(ë¬¸ìì—´ ë° ì •ê·œì‹ ë§¤ì¹­)ì´ í¬í•¨ë©ë‹ˆë‹¤. **êµ­ê°€ì— ë”°ë¼ CloudFront ìˆ˜ì¤€ì—ì„œ ì œí•œëœ ìš”ì²­ì€ WAFì— ë„ë‹¬í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.**

ê° AWS ê³„ì •ì€ ë‹¤ìŒì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* ê° ìœ í˜•ì— ëŒ€í•´ **100 ì¡°ê±´** (ì •ê·œì‹ì˜ ê²½ìš° **10 ì¡°ê±´**ë§Œ í—ˆìš©ë˜ì§€ë§Œ ì´ í•œë„ëŠ” ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).
* **100 ê·œì¹™** ë° **50 ì›¹ ACL**.
* ìµœëŒ€ **5ê°œì˜ ë¹„ìœ¨ ê¸°ë°˜ ê·œì¹™**.
* ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë“œ ë°¸ëŸ°ì„œì™€ í•¨ê»˜ WAFê°€ êµ¬í˜„ë  ë•Œ **ì´ˆë‹¹ 10,000 ìš”ì²­**ì˜ ì²˜ë¦¬ëŸ‰.

#### ê·œì¹™ ì‘ì—…

ì‘ì—…ì€ ê° ê·œì¹™ì— í• ë‹¹ë˜ë©°, ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* **í—ˆìš©**: ìš”ì²­ì´ ì ì ˆí•œ CloudFront ë°°í¬ ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë“œ ë°¸ëŸ°ì„œë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.
* **ì°¨ë‹¨**: ìš”ì²­ì´ ì¦‰ì‹œ ì¢…ë£Œë©ë‹ˆë‹¤.
* **ê³„ì‚°**: ê·œì¹™ì˜ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ìš”ì²­ì„ ì§‘ê³„í•©ë‹ˆë‹¤. ì´ëŠ” ê·œì¹™ í…ŒìŠ¤íŠ¸ì— ìœ ìš©í•˜ë©°, í—ˆìš© ë˜ëŠ” ì°¨ë‹¨ìœ¼ë¡œ ì„¤ì •í•˜ê¸° ì „ì— ê·œì¹™ì˜ ì •í™•ì„±ì„ í™•ì¸í•©ë‹ˆë‹¤.
* **CAPTCHA ë° ì±Œë¦°ì§€**: CAPTCHA í¼ì¦ ë° ì¹¨ë¬µ ì±Œë¦°ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ì´ ë´‡ì—ì„œ ì˜¤ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

ì›¹ ACL ë‚´ì˜ ì–´ë–¤ ê·œì¹™ê³¼ë„ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ìš”ì²­ì€ **ê¸°ë³¸ ì‘ì—…**(í—ˆìš© ë˜ëŠ” ì°¨ë‹¨)ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì›¹ ACL ë‚´ì—ì„œ ì •ì˜ëœ ê·œì¹™ ì‹¤í–‰ ìˆœì„œëŠ” ì¤‘ìš”í•˜ë©° ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒ ìˆœì„œë¥¼ ë”°ë¦…ë‹ˆë‹¤:

1. í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” IP í—ˆìš©.
2. ë¸”ë™ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” IP ì°¨ë‹¨.
3. í•´ë¡œìš´ ì„œëª…ê³¼ ì¼ì¹˜í•˜ëŠ” ìš”ì²­ ì°¨ë‹¨.

#### CloudWatch í†µí•©

AWS WAFëŠ” ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ CloudWatchì™€ í†µí•©ë˜ì–´ ìˆìœ¼ë©°, í—ˆìš©ëœ ìš”ì²­, ì°¨ë‹¨ëœ ìš”ì²­, ê³„ì‚°ëœ ìš”ì²­ ë° í†µê³¼ëœ ìš”ì²­ê³¼ ê°™ì€ ë©”íŠ¸ë¦­ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë©”íŠ¸ë¦­ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë§¤ë¶„ ë³´ê³ ë˜ë©°, 2ì£¼ ë™ì•ˆ ë³´ì¡´ë©ë‹ˆë‹¤.

### ì—´ê±°

CloudFront ë°°í¬ì™€ ìƒí˜¸ì‘ìš©í•˜ë ¤ë©´ US East (N. Virginia) ë¦¬ì „ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤:

* CLI - CloudFront ë²”ìœ„ë¥¼ ì‚¬ìš©í•  ë•Œ US East ë¦¬ì „ì„ ì§€ì •í•©ë‹ˆë‹¤: `--scope CLOUDFRONT --region=us-east-1` .
* API ë° SDK - ëª¨ë“  í˜¸ì¶œì— ëŒ€í•´ ë¦¬ì „ ì—”ë“œí¬ì¸íŠ¸ us-east-1ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì§€ì—­ ì„œë¹„ìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•˜ë ¤ë©´ ë¦¬ì „ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤:

* ìœ ëŸ½(ìŠ¤í˜ì¸) ë¦¬ì „ì˜ ì˜ˆ: `--scope REGIONAL --region=eu-south-2`
```bash
# Web ACLs #

## Retrieve a list of web access control lists (Web ACLs) available in your AWS account
aws wafv2 list-web-acls --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve details about the specified Web ACL
aws wafv2 get-web-acl --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

## Retrieve a list of resources associated with a specific web access control list (Web ACL)
aws wafv2 list-resources-for-web-acl --web-acl-arn <value> # Additional permissions needed depending on the protected resource type: cognito-idp:ListResourcesForWebACL, ec2:DescribeVerifiedAccessInstanceWebAclAssociations or apprunner:ListAssociatedServicesForWebAcl
## Retrieve the Web ACL associated with the specified AWS resource
aws wafv2 get-web-acl-for-resource --resource-arn <arn> # Additional permissions needed depending on the protected resource type: cognito-idp:GetWebACLForResource, ec2:GetVerifiedAccessInstanceWebAcl, wafv2:GetWebACL or apprunner:DescribeWebAclForService

# Rule groups #

## List of the rule groups available in your AWS account
aws wafv2 list-rule-groups --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the details of a specific rule group
aws wafv2 get-rule-group [--name <value>] [--id <value>] [--arn <value>] [--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>]
## Retrieve the IAM policy attached to the specified rule group
aws wafv2 get-permission-policy --resource-arn <rule-group-arn> # Just the owner of the Rule Group can do this operation

# Managed rule groups (by AWS or by a third-party) #

## List the managed rule groups that are available
aws wafv2 list-available-managed-rule-groups --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## List the available versions of the specified managed rule group
aws wafv2 list-available-managed-rule-group-versions --vendor-name <value> --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve high-level information about a specific managed rule group
aws wafv2 describe-managed-rule-group --vendor-name <value> --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--version-name <value>]
## Retrieve high-level information about all managed rule groups
aws wafv2 describe-all-managed-products --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve high-level information about all managed rule groups from a specific vendor
aws wafv2 describe-managed-products-by-vendor --vendor-name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

# IP sets #

## List the IP sets that are available in your AWS account
aws wafv2 list-ip-sets --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the specific IP set
aws wafv2 get-ip-set --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the keys that are currently being managed by a rate-based rule.
aws wafv2 get-rate-based-statement-managed-keys --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>\
--web-acl-name <value> --web-acl-id <value> --rule-name <value> [--rule-group-rule-name <value>]

# Regex pattern sets #

## List all the regex pattern sets that you manage
aws wafv2 list-regex-pattern-sets --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieves the specified regex pattern sets
aws wafv2 get-regex-pattern-set --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

# API Keys #

## List API keys for the specified scope
aws wafv2 list-api-keys --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve decrypted API key
aws wafv2 get-decrypted-api-key --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --api-key <value>

# Logs #

## List of logging configurations (storage location of the logs)
aws wafv2 list-logging-configurations --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--log-scope <value>]
## Retrieve the logging configuration settings associated with a specific web ACL
aws wafv2 get-logging-configuration --resource-arn <value> [--log-scope <CUSTOMER | SECURITY_LAKE>] [--log-type <value>]

# Miscelaneous #

## Retrieve a list of the tags associated to the specified resource
aws wafv2 list-tags-for-resource resource-arn <value>

## Retrieve a sample of web requests that match a specified rule within a WebACL during a specified time range
aws wafv2 get-sampled-requests --web-acl-arn <value> --rule-metric-name <value> --time-window <value> --max-items <1-500> --scope <value>

## Obtains the web ACL capacity unit (WCU) requirements for a specified scope and ruleset
aws wafv2 check-capacity --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --rules <value>

## List of available releases for the AWS WAFv2 mobile SDK
aws wafv2 list-mobile-sdk-releases --platform <IOS | ANDROID>
## Retrieves information for the specified mobile SDK release
aws wafv2 get-mobile-sdk-release --platform <value> --release-version <value>

```
### Post Exploitation / Bypass

{% hint style="success" %}
ê³µê²©ìì˜ ê´€ì ì—ì„œ ì´ ì„œë¹„ìŠ¤ëŠ” ê³µê²©ìê°€ WAF ë³´í˜¸ ë° ë‹¤ë¥¸ ì›¹ì„ ì†ìƒì‹œí‚¤ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ ë…¸ì¶œì„ ì‹ë³„í•˜ëŠ” ë° ë„ì›€ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ê³µê²©ìëŠ” ì´ ì„œë¹„ìŠ¤ë¥¼ ë°©í•´í•˜ì—¬ ì›¹ì´ WAFì— ì˜í•´ ë³´í˜¸ë˜ì§€ ì•Šë„ë¡ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

ë§ì€ Delete ë° Update ì‘ì—…ì—ì„œ **lock token**ì„ ì œê³µí•´ì•¼ í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ í† í°ì€ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ë™ì‹œì„± ì œì–´ì— ì‚¬ìš©ë˜ë©°, ì—¬ëŸ¬ ì‚¬ìš©ì ë˜ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ê³  í•  ë•Œ ë³€ê²½ ì‚¬í•­ì´ ìš°ì—°íˆ ë®ì–´ì“°ì—¬ì§€ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì´ í† í°ì„ ì–»ê¸° ìœ„í•´ íŠ¹ì • ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ í•´ë‹¹ **list** ë˜ëŠ” **get** ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### **`wafv2:CreateRuleGroup`, `wafv2:UpdateRuleGroup`, `wafv2:DeleteRuleGroup`**

ê³µê²©ìëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì˜í–¥ì„ ë°›ëŠ” ë¦¬ì†ŒìŠ¤ì˜ ë³´ì•ˆì„ ì†ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* í•©ë²•ì ì¸ IP ì£¼ì†Œì—ì„œ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•  ìˆ˜ ìˆëŠ” ê·œì¹™ ê·¸ë£¹ì„ ìƒì„±í•˜ì—¬ ì„œë¹„ìŠ¤ ê±°ë¶€ë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ê·œì¹™ ê·¸ë£¹ì„ ì—…ë°ì´íŠ¸í•˜ì—¬ ì˜ˆë¥¼ ë“¤ì–´ **Block**ì—ì„œ **Allow**ë¡œ ê·¸ í–‰ë™ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ì¤‘ìš”í•œ ë³´ì•ˆ ì¡°ì¹˜ë¥¼ ì œê³µí•˜ëŠ” ê·œì¹™ ê·¸ë£¹ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Create Rule Group
aws wafv2 create-rule-group --name <value> --capacity <value> --visibility-config <value> \
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--description <value>]
# Update Rule Group
aws wafv2 update-rule-group --name <value> --id <value> --visibility-config <value> --lock-token <value>\
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--description <value>]
# Delete Rule Group
aws wafv2 delete-rule-group --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
ë‹¤ìŒ ì˜ˆì‹œëŠ” íŠ¹ì • IP ì£¼ì†Œì—ì„œ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ëŠ” ê·œì¹™ ê·¸ë£¹ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:
```bash
aws wafv2 create-rule-group --name BlockLegitimateIPsRuleGroup --capacity 1 --visibility-config SampledRequestsEnabled=false,CloudWatchMetricsEnabled=false,MetricName=BlockLegitimateIPsRuleGroup --scope CLOUDFRONT --region us-east-1 --rules file://rule.json
```
**rule.json** íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì…ë‹ˆë‹¤:
```json
[
{
"Name":"BlockLegitimateIPsRule",
"Priority":0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:global/ipset/legitIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action":{
"Block":{}
},
"VisibilityConfig":{
"SampledRequestsEnabled":false,
"CloudWatchMetricsEnabled":false,
"MetricName":"BlockLegitimateIPsRule"
}
}
]
```
**ì ì¬ì  ì˜í–¥**: ë¬´ë‹¨ ì ‘ê·¼, ë°ì´í„° ìœ ì¶œ, ë° ì ì¬ì ì¸ DoS ê³µê²©.

#### **`wafv2:CreateWebACL`, `wafv2:UpdateWebACL`, `wafv2:DeleteWebACL`**

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* ìƒˆë¡œìš´ Web ACLì„ ìƒì„±í•˜ì—¬ ì•…ì˜ì ì¸ íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ê±°ë‚˜ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ëŠ” ê·œì¹™ì„ ë„ì…í•˜ì—¬ WAFë¥¼ ë¬´ìš©ì§€ë¬¼ë¡œ ë§Œë“¤ê±°ë‚˜ ì„œë¹„ìŠ¤ ê±°ë¶€ë¥¼ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ê¸°ì¡´ Web ACLì„ ì—…ë°ì´íŠ¸í•˜ì—¬ ì´ì „ì— ì°¨ë‹¨ëœ SQL ì¸ì ì…˜ ë˜ëŠ” í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…ê³¼ ê°™ì€ ê³µê²©ì„ í—ˆìš©í•˜ë„ë¡ ê·œì¹™ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ìœ íš¨í•œ ìš”ì²­ì„ ì°¨ë‹¨í•˜ì—¬ ì •ìƒì ì¸ íŠ¸ë˜í”½ íë¦„ì„ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* Web ACLì„ ì‚­ì œí•˜ì—¬ ì˜í–¥ì„ ë°›ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì™„ì „íˆ ë³´í˜¸ë°›ì§€ ëª»í•˜ê²Œ í•˜ì—¬ ë‹¤ì–‘í•œ ì›¹ ê³µê²©ì— ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="info" %}
**ManagedByFirewallManager**ê°€ falseì¸ ê²½ìš°ì—ë§Œ ì§€ì •ëœ **WebACL**ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}
```bash
# Create Web ACL
aws wafv2 create-web-acl --name <value> --default-action <value> --visibility-config <value> \
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--captcha-config <value>] [--description <value>]
# Update Web ACL
aws wafv2 update-web-acl --name <value> --id <value> --default-action <value> --visibility-config <value> --lock-token <value>\
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--captcha-config <value>] [--description <value>]
# Delete Web ACL
aws wafv2 delete-web-acl --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
ë‹¤ìŒ ì˜ˆì œëŠ” íŠ¹ì • IP ì§‘í•©ì—ì„œ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•´ Web ACLì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì›ë³¸ IPê°€ í•´ë‹¹ IP ì¤‘ ì–´ëŠ ê²ƒê³¼ë„ ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ ë™ì‘ë„ ì°¨ë‹¨ì´ ë˜ì–´ DoSë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì›ë³¸ Web ACL**:
```json
{
"WebACL": {
"Name": "AllowLegitimateIPsWebACL",
"Id": "1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f",
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/webacl/AllowLegitimateIPsWebACL/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f",
"DefaultAction": {
"Allow": {}
},
"Description": "",
"Rules": [
{
"Name": "AllowLegitimateIPsRule",
"Priority": 0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/ipset/LegitimateIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action": {
"Allow": {}
},
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "AllowLegitimateIPsRule"
}
}
],
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "AllowLegitimateIPsWebACL"
},
"Capacity": 1,
"ManagedByFirewallManager": false,
"LabelNamespace": "awswaf:123456789012:webacl:AllowLegitimateIPsWebACL:"
},
"LockToken": "1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}

```
ì›¹ ACLì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ëª…ë ¹:
```json
aws wafv2 update-web-acl --name AllowLegitimateIPsWebACL --scope REGIONAL --id 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --lock-token 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --default-action Block={} --visibility-config SampledRequestsEnabled=false,CloudWatchMetricsEnabled=false,MetricName=AllowLegitimateIPsWebACL --rules file://rule.json --region us-east-1
```
**rule.json** íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì¼ ê²ƒì…ë‹ˆë‹¤:
```json
[
{
"Name": "BlockLegitimateIPsRule",
"Priority": 0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/ipset/LegitimateIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action": {
"Block": {}
},
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "BlockLegitimateIPRule"
}
}
]
```
**ì ì¬ì  ì˜í–¥**: ë¬´ë‹¨ ì ‘ê·¼, ë°ì´í„° ìœ ì¶œ, ë° ì ì¬ì ì¸ DoS ê³µê²©.

#### **`wafv2:AssociateWebACL`, `wafv2:DisassociateWebACL`**

**`wafv2:AssociateWebACL`** ê¶Œí•œì€ ê³µê²©ìê°€ ì›¹ ACL(ì•¡ì„¸ìŠ¤ ì œì–´ ëª©ë¡)ì„ ë¦¬ì†ŒìŠ¤ì™€ ì—°ê²°í•  ìˆ˜ ìˆê²Œ í•˜ì—¬ ë³´ì•ˆ ì œì–´ë¥¼ ìš°íšŒí•˜ê³  ë¬´ë‹¨ íŠ¸ë˜í”½ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë„ë‹¬í•˜ë„ë¡ í—ˆìš©í•˜ì—¬ SQL ì¸ì ì…˜ ë˜ëŠ” êµì°¨ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…(XSS)ê³¼ ê°™ì€ ì·¨ì•½ì ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ëŒ€ë¡œ, **`wafv2:DisassociateWebACL`** ê¶Œí•œì„ í†µí•´ ê³µê²©ìëŠ” ë³´ì•ˆ ë³´í˜¸ ê¸°ëŠ¥ì„ ì¼ì‹œì ìœ¼ë¡œ ë¹„í™œì„±í™”í•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ íƒì§€ ì—†ì´ ì·¨ì•½ì ì— ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë³´í˜¸ë˜ëŠ” ë¦¬ì†ŒìŠ¤ ìœ í˜•ì— ë”°ë¼ ì¶”ê°€ ê¶Œí•œì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* **ì—°ê²°**
* apigateway:SetWebACL
* apprunner:AssociateWebAcl
* appsync:SetWebACL
* cognito-idp:AssociateWebACL
* ec2:AssociateVerifiedAccessInstanceWebAcl
* elasticloadbalancing:SetWebAcl
* **ì—°ê²° í•´ì œ**
* apigateway:SetWebACL
* apprunner:DisassociateWebAcl
* appsync:SetWebACL
* cognito-idp:DisassociateWebACL
* ec2:DisassociateVerifiedAccessInstanceWebAcl
* elasticloadbalancing:SetWebAcl
```bash
# Associate
aws wafv2 associate-web-acl --web-acl-arn <value> --resource-arn <value>
# Disassociate
aws wafv2 disassociate-web-acl --resource-arn <value>
```
**ì ì¬ì  ì˜í–¥**: AWS WAFë¡œ ë³´í˜¸ë˜ëŠ” AWS í™˜ê²½ ë‚´ì—ì„œ ìì› ë³´ì•ˆì´ ì†ìƒë˜ê³ , ì•…ìš© ìœ„í—˜ì´ ì¦ê°€í•˜ë©°, ì„œë¹„ìŠ¤ ì¤‘ë‹¨ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### **`wafv2:CreateIPSet` , `wafv2:UpdateIPSet`, `wafv2:DeleteIPSet`**

ê³µê²©ìëŠ” AWS WAFì—ì„œ ê´€ë¦¬í•˜ëŠ” IP ì„¸íŠ¸ë¥¼ ìƒì„±, ì—…ë°ì´íŠ¸ ë° ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì•…ì„± íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ê¸° ìœ„í•´ ìƒˆë¡œìš´ IP ì„¸íŠ¸ë¥¼ ìƒì„±í•˜ê±°ë‚˜, í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•´ IP ì„¸íŠ¸ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜, ì•…ì„± IP ì£¼ì†Œë¥¼ í¬í•¨í•˜ë„ë¡ ê¸°ì¡´ IP ì„¸íŠ¸ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜, ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” IP ì£¼ì†Œë¥¼ ì œê±°í•˜ê±°ë‚˜, ì¤‘ìš”í•œ ìì›ì„ ë³´í˜¸í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ ì¤‘ìš”í•œ IP ì„¸íŠ¸ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìœ„í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Create IP set
aws wafv2 create-ip-set --name <value> --ip-address-version <IPV4 | IPV6> --addresses <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Update IP set
aws wafv2 update-ip-set --name <value> --id <value> --addresses <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Delete IP set
aws wafv2 delete-ip-set --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
ë‹¤ìŒ ì˜ˆì œëŠ” **ì›í•˜ëŠ” IP ì„¸íŠ¸ë¡œ ê¸°ì¡´ IP ì„¸íŠ¸ë¥¼ ë®ì–´ì“°ëŠ” ë°©ë²•**ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:
```bash
aws wafv2 update-ip-set --name LegitimateIPv4Set --id 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --addresses 99.99.99.99/32 --lock-token 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --scope CLOUDFRONT --region us-east-1
```
**ì ì¬ì  ì˜í–¥**: ë¬´ë‹¨ ì ‘ê·¼ ë° í•©ë²•ì ì¸ íŠ¸ë˜í”½ ì°¨ë‹¨.

#### **`wafv2:CreateRegexPatternSet`** , **`wafv2:UpdateRegexPatternSet`**, **`wafv2:DeleteRegexPatternSet`**

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” AWS WAFì—ì„œ íŠ¹ì • íŒ¨í„´ì— ë”°ë¼ ìˆ˜ì‹  íŠ¸ë˜í”½ì„ ì œì–´í•˜ê³  í•„í„°ë§í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ ì„¸íŠ¸ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* ìƒˆë¡œìš´ ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ì„ ìƒì„±í•˜ë©´ ê³µê²©ìê°€ ìœ í•´í•œ ì½˜í…ì¸ ë¥¼ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ê¸°ì¡´ íŒ¨í„´ì„ ì—…ë°ì´íŠ¸í•˜ë©´ ê³µê²©ìê°€ ë³´ì•ˆ ê·œì¹™ì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ì•…ì˜ì ì¸ í™œë™ì„ ì°¨ë‹¨í•˜ë„ë¡ ì„¤ê³„ëœ íŒ¨í„´ì„ ì‚­ì œí•˜ë©´ ê³µê²©ìê°€ ì•…ì„± í˜ì´ë¡œë“œë¥¼ ì „ì†¡í•˜ê³  ë³´ì•ˆ ì¡°ì¹˜ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Create regex pattern set
aws wafv2 create-regex-pattern-set --name <value> --regular-expression-list <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--description <value>]
# Update regex pattern set
aws wafv2 update-regex-pattern-set --name <value> --id <value> --regular-expression-list <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Delete regex pattern set
aws wafv2 delete-regex-pattern-set --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --id <value> --lock-token <value>
```
**ì ì¬ì  ì˜í–¥**: ë³´ì•ˆ í†µì œë¥¼ ìš°íšŒí•˜ì—¬ ì•…ì„± ì½˜í…ì¸ ë¥¼ í—ˆìš©í•˜ê³ , ì ì¬ì ìœ¼ë¡œ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ë…¸ì¶œì‹œí‚¤ê±°ë‚˜ AWS WAFë¡œ ë³´í˜¸ë˜ëŠ” ì„œë¹„ìŠ¤ ë° ë¦¬ì†ŒìŠ¤ë¥¼ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### **(`wavf2:PutLoggingConfiguration` &** `iam:CreateServiceLinkedRole`), **`wafv2:DeleteLoggingConfiguration`**

**`wafv2:DeleteLoggingConfiguration`** ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” ì§€ì •ëœ Web ACLì—ì„œ ë¡œê¹… êµ¬ì„±ì„ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´í›„ **`wavf2:PutLoggingConfiguration`** ë° **`iam:CreateServiceLinkedRole`** ê¶Œí•œì„ í†µí•´ ê³µê²©ìëŠ” ë¡œê¹… êµ¬ì„±ì„ ìƒì„±í•˜ê±°ë‚˜ êµì²´í•  ìˆ˜ ìˆìœ¼ë©°(ì‚­ì œí•œ í›„), ë¡œê¹…ì„ ì™„ì „íˆ ë°©ì§€í•˜ê±°ë‚˜ Amazon S3 ë²„í‚·, Amazon CloudWatch Logs ë¡œê·¸ ê·¸ë£¹ ë˜ëŠ” ì œì–´í•˜ì— ìˆëŠ” Amazon Kinesis Data Firehoseì™€ ê°™ì€ ë¬´ë‹¨ ëª©ì ì§€ë¡œ ë¡œê·¸ë¥¼ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìƒì„± ê³¼ì •ì—ì„œ ì„œë¹„ìŠ¤ëŠ” ì§€ì •ëœ ë¡œê¹… ëª©ì ì§€ì— ë¡œê·¸ë¥¼ ê¸°ë¡í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ê¶Œí•œì„ ìë™ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤:

* **Amazon CloudWatch Logs:** AWS WAFëŠ” ì§€ì •ëœ CloudWatch Logs ë¡œê·¸ ê·¸ë£¹ì— ë¦¬ì†ŒìŠ¤ ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ì •ì±…ì€ AWS WAFê°€ ë¡œê·¸ ê·¸ë£¹ì— ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ëŠ” ë° í•„ìš”í•œ ê¶Œí•œì„ ê°–ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.
* **Amazon S3 Bucket:** AWS WAFëŠ” ì§€ì •ëœ S3 ë²„í‚·ì— ë²„í‚· ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ì •ì±…ì€ AWS WAFê°€ ì§€ì •ëœ ë²„í‚·ì— ë¡œê·¸ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ë° í•„ìš”í•œ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.
* **Amazon Kinesis Data Firehose:** AWS WAFëŠ” Kinesis Data Firehoseì™€ ìƒí˜¸ì‘ìš©í•˜ê¸° ìœ„í•´ íŠ¹ë³„íˆ ì„œë¹„ìŠ¤ ì—°ê²° ì—­í• ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ì—­í• ì€ AWS WAFê°€ êµ¬ì„±ëœ Firehose ìŠ¤íŠ¸ë¦¼ì— ë¡œê·¸ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

{% hint style="info" %}
ì›¹ ACLë‹¹ í•˜ë‚˜ì˜ ë¡œê¹… ëª©ì ì§€ë§Œ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}
```bash
# Put logging configuration
aws wafv2 put-logging-configuration --logging-configuration <value>
# Delete logging configuration
aws wafv2 delete-logging-configuration --resource-arn <value> [--log-scope <CUSTOMER | SECURITY_LAKE>] [--log-type <value>]
```
**ì ì¬ì  ì˜í–¥:** ë³´ì•ˆ ì´ë²¤íŠ¸ì— ëŒ€í•œ ê°€ì‹œì„±ì„ ëª¨í˜¸í•˜ê²Œ í•˜ê³ , ì‚¬ê³  ëŒ€ì‘ í”„ë¡œì„¸ìŠ¤ë¥¼ ì–´ë µê²Œ í•˜ë©°, AWS WAFë¡œ ë³´í˜¸ëœ í™˜ê²½ ë‚´ì—ì„œ ì€ë°€í•œ ì•…ì˜ì  í™œë™ì„ ì´‰ì§„í•©ë‹ˆë‹¤.

#### **`wafv2:DeleteAPIKey`**

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” ê¸°ì¡´ API í‚¤ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆì–´ CAPTCHAë¥¼ ë¬´íš¨í™”í•˜ê³ , ì–‘ì‹ ì œì¶œ ë° ì ‘ê·¼ ì œì–´ì™€ ê°™ì€ ê¸°ëŠ¥ì— ì§€ì¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ CAPTCHAì˜ êµ¬í˜„ì— ë”°ë¼, ì´ëŠ” CAPTCHA ìš°íšŒë¡œ ì´ì–´ì§€ê±°ë‚˜ ìì›ì´ ì˜¤ë¥˜ ê´€ë¦¬ê°€ ì œëŒ€ë¡œ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš° DoSë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Delete API key
aws wafv2 delete-api-key --api-key <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
**ì ì¬ì  ì˜í–¥**: CAPTCHA ë³´í˜¸ë¥¼ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ëŠ¥ì„ ë°©í•´í•˜ì—¬ ë³´ì•ˆ ìœ„ë°˜ ë° ì ì¬ì ì¸ ë°ì´í„° ë„ë‚œìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### **`wafv2:TagResource`, `wafv2:UntagResource`**

ê³µê²©ìëŠ” Web ACL, ê·œì¹™ ê·¸ë£¹, IP ì„¸íŠ¸, ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ ì„¸íŠ¸ ë° ë¡œê¹… êµ¬ì„±ê³¼ ê°™ì€ AWS WAFv2 ë¦¬ì†ŒìŠ¤ì—ì„œ íƒœê·¸ë¥¼ ì¶”ê°€, ìˆ˜ì • ë˜ëŠ” ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Tag
aws wafv2 tag-resource --resource-arn <value> --tags <value>
# Untag
aws wafv2 untag-resource --resource-arn <value> --tag-keys <value>
```
**ì ì¬ì  ì˜í–¥**: ë¦¬ì†ŒìŠ¤ ë³€ì¡°, ì •ë³´ ìœ ì¶œ, ë¹„ìš© ì¡°ì‘ ë° ìš´ì˜ ì¤‘ë‹¨.

## ì°¸ê³ ë¬¸í—Œ

* [https://www.citrusconsulting.com/aws-web-application-firewall-waf/#:\~:text=Conditions%20allow%20you%20to%20specify,user%20via%20a%20web%20application](https://www.citrusconsulting.com/aws-web-application-firewall-waf/)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awswafv2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awswafv2.html)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
