# AWS - WAF Enum

{% hint style="success" %}
AWS í•´í‚¹ì„ ë°°ìš°ê³  ì‹¤ìŠµí•˜ì„¸ìš”:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ì„ ë°°ìš°ê³  ì‹¤ìŠµí•˜ì„¸ìš”: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ ìš”ë ¹ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}

# AWS WAF

AWS WAFì€ **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°©í™”ë²½**ìœ¼ë¡œ, ì›¹ ì‘ìš© í”„ë¡œê·¸ë¨ì´ë‚˜ APIë¥¼ ë‹¤ì–‘í•œ ì›¹ ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì‚¬ìš©ìëŠ” SQL ì¸ì ì…˜ì´ë‚˜ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…ê³¼ ê°™ì€ ì „í˜•ì ì¸ ê³µê²© ë²¡í„°ë¥¼ ì™„í™”í•˜ëŠ” **ë³´ì•ˆ ê·œì¹™**ì„ ì„¤ì •í•˜ê³  ì‚¬ìš©ì ì •ì˜ í•„í„°ë§ ê·œì¹™ì„ ì •ì˜í•˜ì—¬ ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì£¼ìš” ê°œë…

### ì›¹ ACL (ì ‘ê·¼ ì œì–´ ëª©ë¡)

ì›¹ ACLì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ APIì— ì ìš©í•  ìˆ˜ ìˆëŠ” ê·œì¹™ ëª¨ìŒì…ë‹ˆë‹¤. ì›¹ ACLì„ ë¦¬ì†ŒìŠ¤ì™€ ì—°ê²°í•˜ë©´ AWS WAFëŠ” ì›¹ ACLì— ì •ì˜ëœ ê·œì¹™ì„ ê¸°ë°˜ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ê²€ì‚¬í•˜ê³  ì§€ì •ëœ ì¡°ì¹˜ë¥¼ ì·¨í•©ë‹ˆë‹¤.

### ê·œì¹™ ê·¸ë£¹

ê·œì¹™ ê·¸ë£¹ì€ ì—¬ëŸ¬ ì›¹ ACLì— ì ìš©í•  ìˆ˜ ìˆëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê·œì¹™ ëª¨ìŒì…ë‹ˆë‹¤. ê·œì¹™ ê·¸ë£¹ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ API ê°„ì— ì¼ê´€ëœ ê·œì¹™ ì„¸íŠ¸ë¥¼ ê´€ë¦¬í•˜ê³  ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê° ê·œì¹™ ê·¸ë£¹ì—ëŠ” ì‹¤í–‰ ì¤‘ì¸ ê·œì¹™, ê·œì¹™ ê·¸ë£¹ ë° ì›¹ ACLì— ì‚¬ìš©ë˜ëŠ” ìš´ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ê³„ì‚°í•˜ê³  ì œì–´í•˜ëŠ” **ìš©ëŸ‰**ì´ ìˆìŠµë‹ˆë‹¤. ìƒì„± ì¤‘ì— ê°’ì„ ì„¤ì •í•˜ë©´ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### ê·œì¹™

ê·œì¹™ì€ AWS WAFê°€ ë“¤ì–´ì˜¤ëŠ” ì›¹ ìš”ì²­ì„ ê²€ì‚¬í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ì¡°ê±´ ì§‘í•©ì„ ì •ì˜í•©ë‹ˆë‹¤. ì£¼ìš” ê·œì¹™ ìœ í˜•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

1. **ì¼ë°˜ ê·œì¹™**: ì§€ì •ëœ ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬ ì›¹ ìš”ì²­ì„ í—ˆìš©, ì°¨ë‹¨ ë˜ëŠ” ê³„ì‚°í• ì§€ ì—¬ë¶€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.
2. **ìš”ì²­ë¥  ê¸°ë°˜ ê·œì¹™**: íŠ¹ì • IP ì£¼ì†Œì—ì„œ 5ë¶„ ë™ì•ˆì˜ ìš”ì²­ ìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì‚¬ìš©ìëŠ” ì„ê³„ê°’ì„ ì •ì˜í•˜ê³  IPì—ì„œ ì´ í•œë„ë¥¼ ì´ˆê³¼í•˜ëŠ” ìš”ì²­ ìˆ˜ê°€ 5ë¶„ ë‚´ì— ë°œìƒí•˜ë©´ í•´ë‹¹ IPì—ì„œì˜ í›„ì† ìš”ì²­ì´ ì„ê³„ê°’ ì•„ë˜ë¡œ ë–¨ì–´ì§ˆ ë•Œê¹Œì§€ ì°¨ë‹¨ë©ë‹ˆë‹¤. ìš”ì²­ë¥  ê¸°ë°˜ ê·œì¹™ì˜ ìµœì†Œ ì„ê³„ê°’ì€ **2000ê°œì˜ ìš”ì²­**ì…ë‹ˆë‹¤.

### ê´€ë¦¬í˜• ê·œì¹™

AWS WAFëŠ” AWS ë° AWS Marketplace íŒë§¤ìê°€ ìœ ì§€ ê´€ë¦¬í•˜ëŠ” ì‚¬ì „ êµ¬ì„±ëœ ê´€ë¦¬í˜• ê·œì¹™ ì„¸íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê·œì¹™ ì„¸íŠ¸ëŠ” ì¼ë°˜ì ì¸ ìœ„í˜‘ì— ëŒ€í•œ ë³´í˜¸ë¥¼ ì œê³µí•˜ë©° ìƒˆë¡œìš´ ì·¨ì•½ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì •ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.

### IP ì„¸íŠ¸

IP ì„¸íŠ¸ëŠ” í—ˆìš©í•˜ê±°ë‚˜ ì°¨ë‹¨í•˜ë ¤ëŠ” IP ì£¼ì†Œ ë˜ëŠ” IP ì£¼ì†Œ ë²”ìœ„ì˜ ëª©ë¡ì…ë‹ˆë‹¤. IP ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ IP ê¸°ë°˜ ê·œì¹™ì„ ê´€ë¦¬í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ê°„ì†Œí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì •ê·œì‹ íŒ¨í„´ ì„¸íŠ¸

ì •ê·œì‹ íŒ¨í„´ ì„¸íŠ¸ì—ëŠ” ì›¹ ìš”ì²­ì—ì„œ ê²€ìƒ‰í•  íŒ¨í„´ì„ ì •ì˜í•˜ëŠ” í•˜ë‚˜ ì´ìƒì˜ ì •ê·œì‹ì´ í¬í•¨ë©ë‹ˆë‹¤. ì´ëŠ” íŠ¹ì • ë¬¸ì ì‹œí€€ìŠ¤ë¥¼ í•„í„°ë§í•˜ëŠ” ë“± ë” ë³µì¡í•œ ì¼ì¹˜ ì‹œë‚˜ë¦¬ì˜¤ì— ìœ ìš©í•©ë‹ˆë‹¤.

### ì ê¸ˆ í† í°

ì ê¸ˆ í† í°ì€ WAF ë¦¬ì†ŒìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ë™ì‹œì„± ì œì–´ì— ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì—¬ëŸ¬ ì‚¬ìš©ìë‚˜ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ë ¤ê³  ì‹œë„í•  ë•Œ ë³€ê²½ ì‚¬í•­ì´ ì‹¤ìˆ˜ë¡œ ë®ì–´ì“°ì´ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.

### API í‚¤

AWS WAFì˜ API í‚¤ëŠ” íŠ¹ì • API ì‘ì—…ì— ëŒ€í•œ ìš”ì²­ì„ ì¸ì¦í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í‚¤ëŠ” ì•”í˜¸í™”ë˜ì–´ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë˜ì–´ WAF êµ¬ì„±ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë§Œì´ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥ë©ë‹ˆë‹¤.

- **ì˜ˆì‹œ**: CAPTCHA API í†µí•©.

### ê¶Œí•œ ì •ì±…

ê¶Œí•œ ì •ì±…ì€ AWS WAF ë¦¬ì†ŒìŠ¤ì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ìë¥¼ ì§€ì •í•˜ëŠ” IAM ì •ì±…ì…ë‹ˆë‹¤. ê¶Œí•œì„ ì •ì˜í•¨ìœ¼ë¡œì¨ WAF ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œì–´í•˜ê³  ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë§Œì´ êµ¬ì„±ì„ ë§Œë“¤ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë²”ìœ„

AWS WAFì˜ ë²”ìœ„ ë§¤ê°œë³€ìˆ˜ëŠ” WAF ê·œì¹™ê³¼ êµ¬ì„±ì´ ì§€ì—­ ì‘ìš© í”„ë¡œê·¸ë¨ ë˜ëŠ” Amazon CloudFront ë°°í¬ì— ì ìš©ë˜ëŠ”ì§€ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.

- **REGIONAL**: Application Load Balancers (ALB), Amazon API Gateway REST API, AWS AppSync GraphQL API, Amazon Cognito ì‚¬ìš©ì í’€, AWS App Runner ì„œë¹„ìŠ¤ ë° AWS Verified Access ì¸ìŠ¤í„´ìŠ¤ì™€ ê°™ì€ ì§€ì—­ ì„œë¹„ìŠ¤ì— ì ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¦¬ì†ŒìŠ¤ê°€ ìœ„ì¹˜í•œ AWS ì§€ì—­ì„ ì§€ì •í•©ë‹ˆë‹¤.
- **CLOUDFRONT**: ê¸€ë¡œë²Œì¸ Amazon CloudFront ë°°í¬ì— ì ìš©ë©ë‹ˆë‹¤. CloudFrontì— ëŒ€í•œ WAF êµ¬ì„±ì€ ì½˜í…ì¸ ê°€ ì œê³µë˜ëŠ” ìœ„ì¹˜ì™€ ê´€ê³„ì—†ì´ `us-east-1` ì§€ì—­ì„ í†µí•´ ê´€ë¦¬ë©ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

### ëª¨ë‹ˆí„°ë§ ê¸°ì¤€ (ì¡°ê±´)

**ì¡°ê±´**ì€ AWS WAFê°€ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë“¤ì–´ì˜¤ëŠ” HTTP/HTTPS ìš”ì²­ì˜ ìš”ì†Œë¥¼ ì§€ì •í•©ë‹ˆë‹¤. ì´ëŠ” XSS, ì§€ë¦¬ì  ìœ„ì¹˜ (GEO), IP ì£¼ì†Œ, í¬ê¸° ì œì•½, SQL ì¸ì ì…˜ ë° íŒ¨í„´ (ë¬¸ìì—´ ë° ì •ê·œì‹ ì¼ì¹˜)ì„ í¬í•¨í•©ë‹ˆë‹¤. **êµ­ê°€ë³„ë¡œ CloudFront ìˆ˜ì¤€ì—ì„œ ì œí•œëœ ìš”ì²­ì€ WAFì— ë„ë‹¬í•˜ì§€ ì•ŠìŒ**ì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

ê° AWS ê³„ì •ì€ ë‹¤ìŒì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- ê° ìœ í˜•ë‹¹ **100ê°œì˜ ì¡°ê±´** (ì •ê·œì‹ì˜ ê²½ìš° **10ê°œì˜ ì¡°ê±´**ë§Œ í—ˆìš©ë˜ì§€ë§Œ ì´ ì œí•œì€ ì¦ê°€í•  ìˆ˜ ìˆìŒ).
- **100ê°œì˜ ê·œì¹™** ë° **50ê°œì˜ ì›¹ ACL**.
- ìµœëŒ€ **5ê°œì˜ ìš”ì²­ë¥  ê¸°ë°˜ ê·œì¹™**.
- ì‘ìš© í”„ë¡œê·¸ë¨ ë¡œë“œ ë°¸ëŸ°ì„œì— WAFë¥¼ êµ¬í˜„í•  ë•Œ **ì´ˆë‹¹ 10,000ê°œì˜ ìš”ì²­** ì²˜ë¦¬ëŸ‰.

### ê·œì¹™ ì¡°ì¹˜

ê° ê·œì¹™ì—ëŠ” ë‹¤ìŒ ì˜µì…˜ ì¤‘ í•˜ë‚˜ê°€ í• ë‹¹ë©ë‹ˆë‹¤:

- **í—ˆìš©**: ìš”ì²­ì´ ì ì ˆí•œ CloudFront ë°°í¬ ë˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ ë¡œë“œ ë°¸ëŸ°ì„œë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.
- **ì°¨ë‹¨**: ìš”ì²­ì´ ì¦‰ì‹œ ì¢…ë£Œë©ë‹ˆë‹¤.
- **ê³„ì‚°**: ê·œì¹™ì˜ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ìš”ì²­ì„ ê³„ì‚°í•©ë‹ˆë‹¤. ì´ëŠ” ê·œì¹™ í…ŒìŠ¤íŠ¸ì— ìœ ìš©í•˜ë©° í—ˆìš© ë˜ëŠ” ì°¨ë‹¨ìœ¼ë¡œ ì„¤ì •í•˜ê¸° ì „ì— ê·œì¹™ì˜ ì •í™•ì„±ì„ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
- **CAPTCHA ë° Challenge**: CAPTCHA í¼ì¦ ë° ìŒì„± ì±Œë¦°ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ì´ ë´‡ì—ì„œ ì˜¤ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

ì›¹ ACL ë‚´ì—ì„œ ê·œì¹™ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ìš”ì²­ì€ **ê¸°ë³¸ ì¡°ì¹˜** (í—ˆìš© ë˜ëŠ” ì°¨ë‹¨)ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì›¹ ACL ë‚´ì—ì„œ ì •ì˜ëœ ê·œì¹™ ì‹¤í–‰ ìˆœì„œëŠ” ì¤‘ìš”í•˜ë©° ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒ ìˆœì„œë¥¼ ë”°ë¦…ë‹ˆë‹¤:

1. í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IP í—ˆìš©.
2. ë¸”ë™ë¦¬ìŠ¤íŠ¸ IP ì°¨ë‹¨.
3. í•´ë¡œìš´ ì‹œê·¸ë‹ˆì²˜ì™€ ì¼ì¹˜í•˜ëŠ” ìš”ì²­ ì°¨ë‹¨.

### CloudWatch í†µí•©

AWS WAFëŠ” ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ CloudWatchì™€ í†µí•©ë˜ì–´ ìˆìœ¼ë©° AllowedRequests, BlockedRequests, CountedRequests, PassedRequestsì™€ ê°™ì€ ë©”íŠ¸ë¦­ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë©”íŠ¸ë¦­ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë§¤ ë¶„ë§ˆë‹¤ ë³´ê³ ë˜ë©° ë‘ ì£¼ ë™ì•ˆ ë³´ê´€ë©ë‹ˆë‹¤.

## ì—´ê±°

CloudFront ë°°í¬ì™€ ìƒí˜¸ ì‘ìš©í•˜ë ¤ë©´ ë¯¸êµ­ ë™ë¶€ (ë²„ì§€ë‹ˆì•„ ë¶ë¶€) ì§€ì—­ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤:

- CLI - CloudFront ë²”ìœ„ë¥¼ ì‚¬ìš©í•  ë•Œ ë¯¸êµ­ ë™ë¶€ ì§€ì—­ì„ ì§€ì •í•˜ì„¸ìš”: `--scope CLOUDFRONT --region=us-east-1`.
- API ë° SDK - ëª¨ë“  í˜¸ì¶œì— ëŒ€í•´ ì§€ì—­ ì—”ë“œí¬ì¸íŠ¸ us-east-1ì„ ì‚¬ìš©í•˜ì„¸ìš”.

ì§€ì—­ ì„œë¹„ìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•˜ë ¤ë©´ ì§€ì—­ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤:

- ì˜ˆì‹œ: ìœ ëŸ½ (ìŠ¤í˜ì¸) ì§€ì—­ì„ ì‚¬ìš©í•œ ì˜ˆì‹œ: `--scope REGIONAL --region=eu-south-2`
```bash
# Web ACLs #

## Retrieve a list of web access control lists (Web ACLs) available in your AWS account
aws wafv2 list-web-acls --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve details about the specified Web ACL
aws wafv2 get-web-acl --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

## Retrieve a list of resources associated with a specific web access control list (Web ACL)
aws wafv2 list-resources-for-web-acl --web-acl-arn <value> # Additional permissions needed depending on the protected resource type: cognito-idp:ListResourcesForWebACL, ec2:DescribeVerifiedAccessInstanceWebAclAssociations or apprunner:ListAssociatedServicesForWebAcl
## Retrieve the Web ACL associated with the specified AWS resource
aws wafv2 get-web-acl-for-resource --resource-arn <arn> # Additional permissions needed depending on the protected resource type: cognito-idp:GetWebACLForResource, ec2:GetVerifiedAccessInstanceWebAcl, wafv2:GetWebACL or apprunner:DescribeWebAclForService

# Rule groups #

## List of the rule groups available in your AWS account
aws wafv2 list-rule-groups --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the details of a specific rule group
aws wafv2 get-rule-group [--name <value>] [--id <value>] [--arn <value>] [--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>]
## Retrieve the IAM policy attached to the specified rule group
aws wafv2 get-permission-policy --resource-arn <rule-group-arn> # Just the owner of the Rule Group can do this operation

# Managed rule groups (by AWS or by a third-party) #

## List the managed rule groups that are available
aws wafv2 list-available-managed-rule-groups --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## List the available versions of the specified managed rule group
aws wafv2 list-available-managed-rule-group-versions --vendor-name <value> --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve high-level information about a specific managed rule group
aws wafv2 describe-managed-rule-group --vendor-name <value> --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--version-name <value>]
## Retrieve high-level information about all managed rule groups
aws wafv2 describe-all-managed-products --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve high-level information about all managed rule groups from a specific vendor
aws wafv2 describe-managed-products-by-vendor --vendor-name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

# IP sets #

## List the IP sets that are available in your AWS account
aws wafv2 list-ip-sets --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the specific IP set
aws wafv2 get-ip-set --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve the keys that are currently being managed by a rate-based rule.
aws wafv2 get-rate-based-statement-managed-keys --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>\
--web-acl-name <value> --web-acl-id <value> --rule-name <value> [--rule-group-rule-name <value>]

# Regex pattern sets #

## List all the regex pattern sets that you manage
aws wafv2 list-regex-pattern-sets --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieves the specified regex pattern sets
aws wafv2 get-regex-pattern-set --name <value> --id <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>

# API Keys #

## List API keys for the specified scope
aws wafv2 list-api-keys --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
## Retrieve decrypted API key
aws wafv2 get-decrypted-api-key --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --api-key <value>

# Logs #

## List of logging configurations (storage location of the logs)
aws wafv2 list-logging-configurations --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--log-scope <value>]
## Retrieve the logging configuration settings associated with a specific web ACL
aws wafv2 get-logging-configuration --resource-arn <value> [--log-scope <CUSTOMER | SECURITY_LAKE>] [--log-type <value>]

# Miscelaneous #

## Retrieve a list of the tags associated to the specified resource
aws wafv2 list-tags-for-resource resource-arn <value>

## Retrieve a sample of web requests that match a specified rule within a WebACL during a specified time range
aws wafv2 get-sampled-requests --web-acl-arn <value> --rule-metric-name <value> --time-window <value> --max-items <1-500> --scope <value>

## Obtains the web ACL capacity unit (WCU) requirements for a specified scope and ruleset
aws wafv2 check-capacity --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --rules <value>

## List of available releases for the AWS WAFv2 mobile SDK
aws wafv2 list-mobile-sdk-releases --platform <IOS | ANDROID>
## Retrieves information for the specified mobile SDK release
aws wafv2 get-mobile-sdk-release --platform <value> --release-version <value>

```
## í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì‡ / ìš°íšŒ

{% hint style="success" %}
ê³µê²©ìì˜ ê´€ì ì—ì„œ ì´ ì„œë¹„ìŠ¤ëŠ” ê³µê²©ìê°€ WAF ë³´í˜¸ ë° ë„¤íŠ¸ì›Œí¬ ë…¸ì¶œì„ ì‹ë³„í•˜ì—¬ ë‹¤ë¥¸ ì›¹ì„ ì¹¨í•´í•˜ëŠ” ë° ë„ì›€ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ê³µê²©ìëŠ” ë˜í•œ ì´ ì„œë¹„ìŠ¤ë¥¼ ë°©í•´í•˜ì—¬ ì›¹ì´ WAFë¡œ ë³´í˜¸ë˜ì§€ ì•Šë„ë¡ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

ë§ì€ ì‚­ì œ ë° ì—…ë°ì´íŠ¸ ì‘ì—…ì—ì„œëŠ” **ì ê¸ˆ í† í°**ì„ ì œê³µí•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í† í°ì€ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ë™ì‹œì„± ì œì–´ì— ì‚¬ìš©ë˜ë©°, ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ë™ì‹œì— ì—…ë°ì´íŠ¸í•˜ë ¤ëŠ” ì—¬ëŸ¬ ì‚¬ìš©ì ë˜ëŠ” í”„ë¡œì„¸ìŠ¤ì— ì˜í•´ ë³€ê²½ì´ ì‹¤ìˆ˜ë¡œ ë®ì–´ì“°ì—¬ì§€ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì´ í† í°ì„ ì–»ê¸° ìœ„í•´ íŠ¹ì • ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ í•´ë‹¹ **ëª©ë¡** ë˜ëŠ” **ê°€ì ¸ì˜¤ê¸°** ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **`wafv2:CreateRuleGroup`, `wafv2:UpdateRuleGroup`, `wafv2:DeleteRuleGroup`**

ê³µê²©ìëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì˜í–¥ì„ ë°›ëŠ” ë¦¬ì†ŒìŠ¤ì˜ ë³´ì•ˆì„ ì¹¨í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- ì˜ˆë¥¼ ë“¤ì–´, í•©ë²•ì ì¸ IP ì£¼ì†Œì—ì„œì˜ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•  ìˆ˜ ìˆëŠ” ê·œì¹™ ê·¸ë£¹ì„ ìƒì„±í•˜ì—¬ ì„œë¹„ìŠ¤ ê±°ë¶€ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·œì¹™ ê·¸ë£¹ì„ ì—…ë°ì´íŠ¸í•˜ì—¬, ì˜ˆë¥¼ ë“¤ì–´ **ì°¨ë‹¨**ì—ì„œ **í—ˆìš©**ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì¤‘ìš”í•œ ë³´ì•ˆ ì¡°ì¹˜ë¥¼ ì œê³µí•˜ëŠ” ê·œì¹™ ê·¸ë£¹ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Create Rule Group
aws wafv2 create-rule-group --name <value> --capacity <value> --visibility-config <value> \
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--description <value>]
# Update Rule Group
aws wafv2 update-rule-group --name <value> --id <value> --visibility-config <value> --lock-token <value>\
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--description <value>]
# Delete Rule Group
aws wafv2 delete-rule-group --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
ë‹¤ìŒ ì˜ˆì œëŠ” íŠ¹ì • IP ì£¼ì†Œì—ì„œì˜ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ëŠ” ê·œì¹™ ê·¸ë£¹ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:
```bash
aws wafv2 create-rule-group --name BlockLegitimateIPsRuleGroup --capacity 1 --visibility-config SampledRequestsEnabled=false,CloudWatchMetricsEnabled=false,MetricName=BlockLegitimateIPsRuleGroup --scope CLOUDFRONT --region us-east-1 --rules file://rule.json
```
**rule.json** íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì…ë‹ˆë‹¤:
```json
[
{
"Name":"BlockLegitimateIPsRule",
"Priority":0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:global/ipset/legitIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action":{
"Block":{}
},
"VisibilityConfig":{
"SampledRequestsEnabled":false,
"CloudWatchMetricsEnabled":false,
"MetricName":"BlockLegitimateIPsRule"
}
}
]
```
**ì ì¬ì  ì˜í–¥**: ë¬´ë‹¨ ì ‘ê·¼, ë°ì´í„° ìœ ì¶œ ë° ì ì¬ì  DoS ê³µê²©.

### **`wafv2:CreateWebACL`, `wafv2:UpdateWebACL`, `wafv2:DeleteWebACL`**

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- ì•…ì˜ì ì¸ íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ê±°ë‚˜ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ëŠ” ê·œì¹™ì„ ë„ì…í•˜ì—¬ ìƒˆë¡œìš´ Web ACLì„ ìƒì„±í•˜ì—¬ WAFë¥¼ ë¬´ë ¥í™”í•˜ê±°ë‚˜ ì„œë¹„ìŠ¤ ê±°ë¶€ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê¸°ì¡´ Web ACLì„ ì—…ë°ì´íŠ¸í•˜ì—¬ ì´ì „ì— ì°¨ë‹¨ëœ SQL ì¸ì ì…˜ ë˜ëŠ” í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…ê³¼ ê°™ì€ ê³µê²©ì„ í—ˆìš©í•˜ë„ë¡ ê·œì¹™ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ìœ íš¨í•œ ìš”ì²­ì„ ì°¨ë‹¨í•˜ì—¬ ì •ìƒì ì¸ íŠ¸ë˜í”½ íë¦„ì„ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Web ACLì„ ì‚­ì œí•˜ì—¬ ì˜í–¥ì„ ë°›ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì™„ì „íˆ ë¬´ë°©í˜¸ ìƒíƒœë¡œ ë‚¨ê²¨ ë‹¤ì–‘í•œ ì›¹ ê³µê²©ì— ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="info" %}

**ManagedByFirewallManager**ê°€ falseì¸ ê²½ìš°ì—ë§Œ ì§€ì •ëœ **WebACL**ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% endhint %}
```bash
# Create Web ACL
aws wafv2 create-web-acl --name <value> --default-action <value> --visibility-config <value> \
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--captcha-config <value>] [--description <value>]
# Update Web ACL
aws wafv2 update-web-acl --name <value> --id <value> --default-action <value> --visibility-config <value> --lock-token <value>\
--scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--rules <value>] [--captcha-config <value>] [--description <value>]
# Delete Web ACL
aws wafv2 delete-web-acl --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
ë‹¤ìŒ ì˜ˆì œëŠ” íŠ¹ì • IP ì„¸íŠ¸ì—ì„œì˜ í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•´ ì›¹ ACLì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì›ë³¸ IPê°€ í•´ë‹¹ IP ì¤‘ í•˜ë‚˜ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° ê¸°ë³¸ ì¡°ì¹˜ë„ ì°¨ë‹¨ë˜ì–´ DoSê°€ ë°œìƒí•©ë‹ˆë‹¤.

**ì›ë³¸ ì›¹ ACL**:
```json
{
"WebACL": {
"Name": "AllowLegitimateIPsWebACL",
"Id": "1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f",
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/webacl/AllowLegitimateIPsWebACL/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f",
"DefaultAction": {
"Allow": {}
},
"Description": "",
"Rules": [
{
"Name": "AllowLegitimateIPsRule",
"Priority": 0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/ipset/LegitimateIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action": {
"Allow": {}
},
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "AllowLegitimateIPsRule"
}
}
],
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "AllowLegitimateIPsWebACL"
},
"Capacity": 1,
"ManagedByFirewallManager": false,
"LabelNamespace": "awswaf:123456789012:webacl:AllowLegitimateIPsWebACL:"
},
"LockToken": "1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}

```
ì›¹ ACLì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ëª…ë ¹ì–´:
```json
aws wafv2 update-web-acl --name AllowLegitimateIPsWebACL --scope REGIONAL --id 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --lock-token 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --default-action Block={} --visibility-config SampledRequestsEnabled=false,CloudWatchMetricsEnabled=false,MetricName=AllowLegitimateIPsWebACL --rules file://rule.json --region us-east-1
```
**rule.json** íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì…ë‹ˆë‹¤:
```json
[
{
"Name": "BlockLegitimateIPsRule",
"Priority": 0,
"Statement": {
"IPSetReferenceStatement": {
"ARN": "arn:aws:wafv2:us-east-1:123456789012:regional/ipset/LegitimateIPv4/1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f"
}
},
"Action": {
"Block": {}
},
"VisibilityConfig": {
"SampledRequestsEnabled": false,
"CloudWatchMetricsEnabled": false,
"MetricName": "BlockLegitimateIPRule"
}
}
]
```
**ì ì¬ì  ì˜í–¥**: ë¬´ë‹¨ ì ‘ê·¼, ë°ì´í„° ìœ ì¶œ ë° ì ì¬ì  DoS ê³µê²©.

### **`wafv2:AssociateWebACL`, `wafv2:DisassociateWebACL`**

**`wafv2:AssociateWebACL`** ê¶Œí•œì€ ê³µê²©ìê°€ ì›¹ ACL(ì•¡ì„¸ìŠ¤ ì œì–´ ëª©ë¡)ì„ ë¦¬ì†ŒìŠ¤ì— ì—°ê²°í•˜ì—¬ ë³´ì•ˆ ì œì–´ë¥¼ ìš°íšŒí•˜ê³  ë¬´ë‹¨ íŠ¸ë˜í”½ì´ ì‘ìš© í”„ë¡œê·¸ë¨ì— ë„ë‹¬í•˜ë„ë¡ í—ˆìš©í•¨ìœ¼ë¡œì¨ SQL ì¸ì ì…˜ ë˜ëŠ” í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…(XSS)ê³¼ ê°™ì€ ì·¨ì•½ì ì„ í†µí•œ ê³µê²©ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë©´ **`wafv2:DisassociateWebACL`** ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” ë³´ì•ˆ ë³´í˜¸ ê¸°ëŠ¥ì„ ì¼ì‹œì ìœ¼ë¡œ ë¹„í™œì„±í™”í•˜ì—¬ ê°ì§€ ì—†ì´ ë¦¬ì†ŒìŠ¤ë¥¼ ì·¨ì•½ì ì— ë…¸ì¶œì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë³´í˜¸ëœ ë¦¬ì†ŒìŠ¤ ìœ í˜•ì— ë”°ë¼ ì¶”ê°€ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤:

- **ì—°ê²°**
- apigateway:SetWebACL
- apprunner:AssociateWebAcl
- appsync:SetWebACL
- cognito-idp:AssociateWebACL
- ec2:AssociateVerifiedAccessInstanceWebAcl
- elasticloadbalancing:SetWebAcl
- **ì—°ê²° í•´ì œ**
- apigateway:SetWebACL
- apprunner:DisassociateWebAcl
- appsync:SetWebACL
- cognito-idp:DisassociateWebACL
- ec2:DisassociateVerifiedAccessInstanceWebAcl
- elasticloadbalancing:SetWebAcl
```bash
# Associate
aws wafv2 associate-web-acl --web-acl-arn <value> --resource-arn <value>
# Disassociate
aws wafv2 disassociate-web-acl --resource-arn <value>
```
**ì ì¬ì  ì˜í–¥**: AWS WAFë¡œ ë³´í˜¸ë˜ëŠ” AWS í™˜ê²½ ë‚´ì—ì„œ ìì› ë³´ì•ˆì´ ì¹¨í•´ë˜ê³  ì•…ìš© ìœ„í—˜ì´ ì¦ê°€í•˜ë©° ì ì¬ì ì¸ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **`wafv2:CreateIPSet` , `wafv2:UpdateIPSet`, `wafv2:DeleteIPSet`**

ê³µê²©ìëŠ” AWS WAFì—ì„œ ê´€ë¦¬í•˜ëŠ” IP ì„¸íŠ¸ë¥¼ ìƒì„±, ì—…ë°ì´íŠ¸ ë° ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì•…ì˜ì ì¸ íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ìƒˆë¡œìš´ IP ì„¸íŠ¸ë¥¼ ìƒì„±í•˜ê±°ë‚˜, í•©ë²•ì ì¸ íŠ¸ë˜í”½ì„ ì°¨ë‹¨í•˜ê¸° ìœ„í•´ IP ì„¸íŠ¸ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜, ì•…ì˜ì ì¸ IP ì£¼ì†Œë¥¼ í¬í•¨í•˜ë„ë¡ ê¸°ì¡´ IP ì„¸íŠ¸ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜, ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” IP ì£¼ì†Œë¥¼ ì œê±°í•˜ê±°ë‚˜, ì¤‘ìš”í•œ ìì›ì„ ë³´í˜¸í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ì¤‘ìš”í•œ IP ì„¸íŠ¸ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆì–´ ìœ„í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Create IP set
aws wafv2 create-ip-set --name <value> --ip-address-version <IPV4 | IPV6> --addresses <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Update IP set
aws wafv2 update-ip-set --name <value> --id <value> --addresses <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Delete IP set
aws wafv2 delete-ip-set --name <value> --id <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
ë‹¤ìŒ ì˜ˆì œëŠ” ì›í•˜ëŠ” IP ì„¸íŠ¸ë¡œ ê¸°ì¡´ IP ì„¸íŠ¸ë¥¼ ë®ì–´ì“°ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:
```bash
aws wafv2 update-ip-set --name LegitimateIPv4Set --id 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --addresses 99.99.99.99/32 --lock-token 1a2b3c4d-1a2b-1a2b-1a2b-1a2b3c4d5e6f --scope CLOUDFRONT --region us-east-1
```
**ì ì¬ì  ì˜í–¥**: ë¬´ë‹¨ ì•¡ì„¸ìŠ¤ ë° ì ì ˆí•œ íŠ¸ë˜í”½ ì°¨ë‹¨.

### **`wafv2:CreateRegexPatternSet`**, **`wafv2:UpdateRegexPatternSet`**, **`wafv2:DeleteRegexPatternSet`**

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” AWS WAFì—ì„œ ì‚¬ìš©ë˜ëŠ” ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ ì„¸íŠ¸ë¥¼ ì¡°ì‘í•˜ì—¬ íŠ¹ì • íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½ì„ ì œì–´í•˜ê³  í•„í„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ìƒˆë¡œìš´ ì •ê·œ í‘œí˜„ì‹ íŒ¨í„´ì„ ìƒì„±í•˜ë©´ ê³µê²©ìê°€ ìœ í•´í•œ ì½˜í…ì¸ ë¥¼ í—ˆìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê¸°ì¡´ íŒ¨í„´ì„ ì—…ë°ì´íŠ¸í•˜ë©´ ê³µê²©ìê°€ ë³´ì•ˆ ê·œì¹™ì„ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì•…ì„± í™œë™ì„ ì°¨ë‹¨í•˜ëŠ” íŒ¨í„´ì„ ì‚­ì œí•˜ë©´ ê³µê²©ìê°€ ì•…ì˜ì ì¸ í˜ì´ë¡œë“œë¥¼ ë³´ë‚´ê³  ë³´ì•ˆ ì¡°ì¹˜ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Create regex pattern set
aws wafv2 create-regex-pattern-set --name <value> --regular-expression-list <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> [--description <value>]
# Update regex pattern set
aws wafv2 update-regex-pattern-set --name <value> --id <value> --regular-expression-list <value> --lock-token <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
# Delete regex pattern set
aws wafv2 delete-regex-pattern-set --name <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1> --id <value> --lock-token <value>
```
**ì ì¬ì  ì˜í–¥**: ë³´ì•ˆ ì œì–´ ìš°íšŒë¡œ ì•…ì„± ì½˜í…ì¸ ë¥¼ í—ˆìš©í•˜ê³  AWS WAFë¡œ ë³´í˜¸ë˜ëŠ” ì„œë¹„ìŠ¤ ë° ë¦¬ì†ŒìŠ¤ë¥¼ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ ë…¸ì¶œì‹œí‚¤ê±°ë‚˜ ë°©í•´í•  ìˆ˜ ìˆìŒ.

### **(`wavf2:PutLoggingConfiguration` &** `iam:CreateServiceLinkedRole`), **`wafv2:DeleteLoggingConfiguration`**

**`wafv2:DeleteLoggingConfiguration`**ì„ ê°€ì§„ ê³µê²©ìëŠ” ì§€ì •ëœ ì›¹ ACLì—ì„œ ë¡œê¹… êµ¬ì„±ì„ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´í›„ **`wavf2:PutLoggingConfiguration`** ë° **`iam:CreateServiceLinkedRole`** ê¶Œí•œì„ ê°€ì§€ê³  ìˆëŠ” ê³µê²©ìëŠ” ë¡œê¹… êµ¬ì„±ì„ ìƒì„±í•˜ê±°ë‚˜ êµì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ì‚­ì œí•œ í›„), ë¡œê¹…ì„ ì™„ì „íˆ ë°©ì§€í•˜ê±°ë‚˜ Amazon S3 ë²„í‚·, Amazon CloudWatch Logs ë¡œê·¸ ê·¸ë£¹ ë˜ëŠ” Amazon Kinesis Data Firehoseì™€ ê°™ì€ ê¶Œí•œì´ ì—†ëŠ” ëŒ€ìƒìœ¼ë¡œ ë¡œê·¸ë¥¼ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìƒì„± í”„ë¡œì„¸ìŠ¤ ì¤‘ì— ì„œë¹„ìŠ¤ëŠ” ì§€ì •ëœ ë¡œê¹… ëŒ€ìƒì— ë¡œê·¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ê¶Œí•œì„ ìë™ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤:

- **Amazon CloudWatch Logs:** AWS WAFëŠ” ì§€ì •ëœ CloudWatch Logs ë¡œê·¸ ê·¸ë£¹ì— ë¦¬ì†ŒìŠ¤ ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ì •ì±…ì€ AWS WAFê°€ ë¡œê·¸ë¥¼ ë¡œê·¸ ê·¸ë£¹ì— ì‘ì„±í•˜ëŠ” ë° í•„ìš”í•œ ê¶Œí•œì„ ë³´ì¥í•©ë‹ˆë‹¤.
- **Amazon S3 ë²„í‚·:** AWS WAFëŠ” ì§€ì •ëœ S3 ë²„í‚·ì— ë²„í‚· ì •ì±…ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ì •ì±…ì€ AWS WAFê°€ ì§€ì •ëœ ë²„í‚·ì— ë¡œê·¸ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ë° í•„ìš”í•œ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.
- **Amazon Kinesis Data Firehose:** AWS WAFëŠ” Kinesis Data Firehoseì™€ ìƒí˜¸ ì‘ìš©í•˜ê¸° ìœ„í•´ íŠ¹ë³„íˆ ìƒì„±ëœ ì„œë¹„ìŠ¤ ë§í¬ë“œ ì—­í• ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ì—­í• ì€ AWS WAFê°€ êµ¬ì„±ëœ Firehose ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë¡œê·¸ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

{% hint style="info" %}

ì›¹ ACL ë‹¹ ë¡œê¹… ëŒ€ìƒì„ í•˜ë‚˜ë§Œ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% endhint %}
```bash
# Put logging configuration
aws wafv2 put-logging-configuration --logging-configuration <value>
# Delete logging configuration
aws wafv2 delete-logging-configuration --resource-arn <value> [--log-scope <CUSTOMER | SECURITY_LAKE>] [--log-type <value>]
```
**ì ì¬ì  ì˜í–¥:** ë³´ì•ˆ ì´ë²¤íŠ¸ì— ëŒ€í•œ ê°€ì‹œì„±ì„ íë¦¬ê²Œ í•˜ê³  ì‚¬ê±´ ëŒ€ì‘ í”„ë¡œì„¸ìŠ¤ë¥¼ ì–´ë µê²Œ ë§Œë“¤ë©° AWS WAFë¡œ ë³´í˜¸ëœ í™˜ê²½ ë‚´ì—ì„œ ì€ë°€í•œ ì•…ì˜ì  í™œë™ì„ ìš©ì´í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **`wafv2:DeleteAPIKey`**

ì´ ê¶Œí•œì„ ê°€ì§„ ê³µê²©ìëŠ” ê¸°ì¡´ API í‚¤ë¥¼ ì‚­ì œí•˜ì—¬ CAPTCHAë¥¼ íš¨ê³¼ ì—†ê²Œ ë§Œë“¤ê³ , ì–‘ì‹ ì œì¶œ ë° ì•¡ì„¸ìŠ¤ ì œì–´ì— ì˜ì¡´í•˜ëŠ” ê¸°ëŠ¥ì„ ë°©í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ CAPTCHAì˜ êµ¬í˜„ì— ë”°ë¼ CAPTCHA ìš°íšŒ ë˜ëŠ” ë¦¬ì†ŒìŠ¤ì—ì„œ ì˜¤ë¥˜ ê´€ë¦¬ê°€ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš° DoSë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Delete API key
aws wafv2 delete-api-key --api-key <value> --scope <REGIONAL --region=<value> | CLOUDFRONT --region=us-east-1>
```
**ì ì¬ì  ì˜í–¥**: CAPTCHA ë³´í˜¸ë¥¼ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì‘ìš© í”„ë¡œê·¸ë¨ ê¸°ëŠ¥ì„ ë°©í•´í•˜ì—¬ ë³´ì•ˆ ì¹¨í•´ ë° ì ì¬ì  ë°ì´í„° ë„ë‚œ ë°œìƒ ê°€ëŠ¥.

### **`wafv2:TagResource`,Â `wafv2:UntagResource`**

ê³µê²©ìëŠ” AWS WAFv2 ë¦¬ì†ŒìŠ¤ì¸ Web ACL, ê·œì¹™ ê·¸ë£¹, IP ì„¸íŠ¸, ì •ê·œì‹ íŒ¨í„´ ì„¸íŠ¸ ë° ë¡œê¹… êµ¬ì„±ì—ì„œ íƒœê·¸ë¥¼ ì¶”ê°€, ìˆ˜ì • ë˜ëŠ” ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
# Tag
aws wafv2 tag-resource --resource-arn <value> --tags <value>
# Untag
aws wafv2 untag-resource --resource-arn <value> --tag-keys <value>
```
**ì ì¬ì  ì˜í–¥**: ë¦¬ì†ŒìŠ¤ ì¡°ì‘, ì •ë³´ ëˆ„ì¶œ, ë¹„ìš© ì¡°ì‘ ë° ìš´ì˜ ë°©í•´.

# ì°¸ê³  ìë£Œ
* [https://www.citrusconsulting.com/aws-web-application-firewall-waf/#:~:text=Conditions%20allow%20you%20to%20specify,user%20via%20a%20web%20application](https://www.citrusconsulting.com/aws-web-application-firewall-waf/#:~:text=Conditions%20allow%20you%20to%20specify,user%20via%20a%20web%20application)
* [https://docs.aws.amazon.com/service-authorization/latest/reference/list_awswafv2.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list_awswafv2.html)

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ë ˆí¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ ìš”ë ¹ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
