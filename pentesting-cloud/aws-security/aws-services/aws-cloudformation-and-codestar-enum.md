# AWS - CloudFormation & Codestar Enum

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## CloudFormation

AWS CloudFormation æ˜¯ä¸€é¡¹æ—¨åœ¨ **ç®€åŒ– AWS èµ„æºç®¡ç†** çš„æœåŠ¡ã€‚å®ƒä½¿ç”¨æˆ·èƒ½å¤Ÿæ›´ä¸“æ³¨äºåœ¨ AWS ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºï¼Œé€šè¿‡ **å‡å°‘åœ¨èµ„æºç®¡ç†ä¸ŠèŠ±è´¹çš„æ—¶é—´**ã€‚è¯¥æœåŠ¡çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ **æ¨¡æ¿**â€”â€”æ‰€éœ€ AWS èµ„æºçš„æè¿°æ¨¡å‹ã€‚ä¸€æ—¦æä¾›äº†æ­¤æ¨¡æ¿ï¼ŒCloudFormation è´Ÿè´£æŒ‡å®šèµ„æºçš„ **ä¾›åº”å’Œé…ç½®**ã€‚è¿™ç§è‡ªåŠ¨åŒ–ä¿ƒè¿›äº† AWS åŸºç¡€è®¾æ–½çš„æ›´é«˜æ•ˆå’Œæ— é”™è¯¯ç®¡ç†ã€‚

### Enumeration
```bash
# Stacks
aws cloudformation list-stacks
aws cloudformation describe-stacks # You could find sensitive information here
aws cloudformation list-stack-resources --stack-name <name>
aws cloudformation get-template --stack-name cloudformationStack
aws cloudformation describe-stack-events --stack-name cloudformationStack

## Show params and outputs
aws cloudformation describe-stacks | jq ".Stacks[] | .StackId, .StackName, .Parameters, .Outputs"

# Export
aws cloudformation list-exports
aws cloudformation list-imports --export-name <x_name>

# Stack Sets
aws cloudformation list-stack-sets
aws cloudformation describe-stack-set --stack-set-name <name>
aws cloudformation list-stack-instances --stack-set-name <name>
aws cloudformation list-stack-set-operations --stack-set-name <name>
aws cloudformation list-stack-set-operation-results --stack-set-name <name> --operation-id <id>
```
### Privesc

åœ¨ä»¥ä¸‹é¡µé¢ä¸­ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥å¦‚ä½•**æ»¥ç”¨cloudformationæƒé™ä»¥æå‡ç‰¹æƒ**ï¼š

{% content-ref url="../aws-privilege-escalation/aws-cloudformation-privesc/" %}
[aws-cloudformation-privesc](../aws-privilege-escalation/aws-cloudformation-privesc/)
{% endcontent-ref %}

### Post-Exploitation

æ£€æŸ¥æ¯ä¸ªCloudFormationçš„**æ¨¡æ¿ã€å‚æ•°å’Œè¾“å‡º**ä¸­çš„**ç§˜å¯†**æˆ–æ•æ„Ÿä¿¡æ¯

## Codestar

AWS CodeStaræ˜¯ä¸€ä¸ªç”¨äºåœ¨AWSä¸Šåˆ›å»ºã€ç®¡ç†å’Œå¤„ç†è½¯ä»¶å¼€å‘é¡¹ç›®çš„æœåŠ¡ã€‚æ‚¨å¯ä»¥é€šè¿‡AWS CodeStaré¡¹ç›®å¿«é€Ÿå¼€å‘ã€æ„å»ºå’Œéƒ¨ç½²åº”ç”¨ç¨‹åºã€‚AWS CodeStaré¡¹ç›®ä¸ºæ‚¨çš„é¡¹ç›®å¼€å‘å·¥å…·é“¾åˆ›å»ºå¹¶**é›†æˆAWSæœåŠ¡**ã€‚æ ¹æ®æ‚¨é€‰æ‹©çš„AWS CodeStaré¡¹ç›®æ¨¡æ¿ï¼Œè¯¥å·¥å…·é“¾å¯èƒ½åŒ…æ‹¬æºæ§åˆ¶ã€æ„å»ºã€éƒ¨ç½²ã€è™šæ‹ŸæœåŠ¡å™¨æˆ–æ— æœåŠ¡å™¨èµ„æºç­‰ã€‚AWS CodeStarè¿˜**ç®¡ç†é¡¹ç›®ç”¨æˆ·**ï¼ˆç§°ä¸ºå›¢é˜Ÿæˆå‘˜ï¼‰æ‰€éœ€çš„æƒé™ã€‚

### Enumeration
```bash
# Get projects information
aws codestar list-projects
aws codestar describe-project --id <project_id>
aws codestar list-resources --project-id <project_id>
aws codestar list-team-members --project-id <project_id>

aws codestar list-user-profiles
aws codestar describe-user-profile --user-arn <arn>
```
### Privesc

åœ¨ä»¥ä¸‹é¡µé¢ä¸­ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å¦‚ä½•**æ»¥ç”¨codestaræƒé™ä»¥æå‡ç‰¹æƒ**ï¼š

{% content-ref url="../aws-privilege-escalation/aws-codestar-privesc/" %}
[aws-codestar-privesc](../aws-privilege-escalation/aws-codestar-privesc/)
{% endcontent-ref %}

## References

* [https://docs.aws.amazon.com/cloudformation/](https://docs.aws.amazon.com/cloudformation/)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubåº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
