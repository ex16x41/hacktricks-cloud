# AWS - CloudFormation & Codestar Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## CloudFormation

AWS CloudFormation ‚Äî —Ü–µ —Å–µ—Ä–≤—ñ—Å, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è **—Å–ø—Ä–æ—â–µ–Ω–Ω—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏ AWS**. –í—ñ–Ω –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –±—ñ–ª—å—à–µ –∑–æ—Å–µ—Ä–µ–¥–∂—É–≤–∞—Ç–∏—Å—è –Ω–∞ —Å–≤–æ—ó—Ö –¥–æ–¥–∞—Ç–∫–∞—Ö, —â–æ –ø—Ä–∞—Ü—é—é—Ç—å –≤ AWS, **–º—ñ–Ω—ñ–º—ñ–∑—É—é—á–∏ —á–∞—Å, –≤–∏—Ç—Ä–∞—á–µ–Ω–∏–π –Ω–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏**. –û—Å–Ω–æ–≤–Ω–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É —î **—à–∞–±–ª–æ–Ω** ‚Äî –æ–ø–∏—Å–æ–≤–∞ –º–æ–¥–µ–ª—å –±–∞–∂–∞–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ AWS. –ü—ñ—Å–ª—è –Ω–∞–¥–∞–Ω–Ω—è —Ü—å–æ–≥–æ —à–∞–±–ª–æ–Ω—É CloudFormation –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ **–ø–æ—Å—Ç–∞—á–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è** –≤–∫–∞–∑–∞–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤. –¶—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Å–ø—Ä–∏—è—î –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É —Ç–∞ –±–µ–∑–ø–æ–º–∏–ª–∫–æ–≤–æ–º—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—é —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é AWS.

### Enumeration
```bash
# Stacks
aws cloudformation list-stacks
aws cloudformation describe-stacks # You could find sensitive information here
aws cloudformation list-stack-resources --stack-name <name>

## Show params and outputs
aws cloudformation describe-stacks | jq ".Stacks[] | .StackId, .StackName, .Parameters, .Outputs"

# Export
aws cloudformation list-exports
aws cloudformation list-imports --export-name <x_name>

# Stack Sets
aws cloudformation list-stack-sets
aws cloudformation describe-stack-set --stack-set-name <name>
aws cloudformation list-stack-instances --stack-set-name <name>
aws cloudformation list-stack-set-operations --stack-set-name <name>
aws cloudformation list-stack-set-operation-results --stack-set-name <name> --operation-id <id>
```
### Privesc

In the following page you can check how to **abuse cloudformation permissions to escalate privileges**:

{% content-ref url="../aws-privilege-escalation/aws-cloudformation-privesc/" %}
[aws-cloudformation-privesc](../aws-privilege-escalation/aws-cloudformation-privesc/)
{% endcontent-ref %}

### Post-Exploitation

Check for **secrets** or sensitive information in the **template, parameters & output** of each CloudFormation

## Codestar

AWS CodeStar - —Ü–µ —Å–µ—Ä–≤—ñ—Å –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–∞ —Ä–æ–±–æ—Ç–∏ –∑ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —Ä–æ–∑—Ä–æ–±–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –Ω–∞ AWS. –í–∏ –º–æ–∂–µ—Ç–µ —à–≤–∏–¥–∫–æ —Ä–æ–∑—Ä–æ–±–ª—è—Ç–∏, –∑–±–∏—Ä–∞—Ç–∏ —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–∏ –Ω–∞ AWS –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ–µ–∫—Ç—É AWS CodeStar. –ü—Ä–æ–µ–∫—Ç AWS CodeStar —Å—Ç–≤–æ—Ä—é—î —Ç–∞ **—ñ–Ω—Ç–µ–≥—Ä—É—î AWS services** –¥–ª—è –≤–∞—à–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ª–∞–Ω—Ü—é–≥–∞ —Ä–æ–∑—Ä–æ–±–∫–∏ –ø—Ä–æ–µ–∫—Ç—É. –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –≤–∞—à–æ–≥–æ –≤–∏–±–æ—Ä—É —à–∞–±–ª–æ–Ω—É –ø—Ä–æ–µ–∫—Ç—É AWS CodeStar, —Ü–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∏–π –ª–∞–Ω—Ü—é–≥ –º–æ–∂–µ –≤–∫–ª—é—á–∞—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å—ñ–π, –∑–±—ñ—Ä–∫—É, —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è, –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ –∞–±–æ –±–µ–∑—Å–µ—Ä–≤–µ—Ä–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ —Ç–∞ —ñ–Ω—à–µ. AWS CodeStar —Ç–∞–∫–æ–∂ **—É–ø—Ä–∞–≤–ª—è—î –¥–æ–∑–≤–æ–ª–∞–º–∏, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–º–∏ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø—Ä–æ–µ–∫—Ç—É** (—è–∫—ñ –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è —á–ª–µ–Ω–∞–º–∏ –∫–æ–º–∞–Ω–¥–∏).

### Enumeration
```bash
# Get projects information
aws codestar list-projects
aws codestar describe-project --id <project_id>
aws codestar list-resources --project-id <project_id>
aws codestar list-team-members --project-id <project_id>

aws codestar list-user-profiles
aws codestar describe-user-profile --user-arn <arn>
```
### Privesc

–ù–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —è–∫ **–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏ codestar –¥–ª—è –µ—Å–∫–∞–ª–∞—Ü—ñ—ó –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**:

{% content-ref url="../aws-privilege-escalation/aws-codestar-privesc/" %}
[aws-codestar-privesc](../aws-privilege-escalation/aws-codestar-privesc/)
{% endcontent-ref %}

## References

* [https://docs.aws.amazon.com/cloudformation/](https://docs.aws.amazon.com/cloudformation/)

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
