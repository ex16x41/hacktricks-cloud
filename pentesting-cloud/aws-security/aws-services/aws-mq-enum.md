# AWS - MQ Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Amazon MQ

### Introduction to Message Brokers

**메시지 브로커**는 서로 다른 소프트웨어 시스템 간의 통신을 촉진하는 중개자 역할을 합니다. 이러한 시스템은 다양한 플랫폼에서 구축되고 서로 다른 언어로 프로그래밍될 수 있습니다. **Amazon MQ**는 AWS에서 메시지 브로커의 배포, 운영 및 유지 관리를 간소화합니다. **Apache ActiveMQ** 및 **RabbitMQ**에 대한 관리형 서비스를 제공하여 원활한 프로비저닝과 자동 소프트웨어 버전 업데이트를 보장합니다.

### AWS - RabbitMQ

RabbitMQ는 저명한 **메시지 큐잉 소프트웨어**로, _메시지 브로커_ 또는 _큐 관리자_로도 알려져 있습니다. 본질적으로 큐가 구성된 시스템입니다. 애플리케이션은 이러한 큐와 인터페이스하여 **메시지를 전송하고 수신**합니다. 이 맥락에서 메시지는 다른 애플리케이션(잠재적으로 다른 서버에서)의 프로세스를 시작하는 명령에서 간단한 텍스트 메시지에 이르기까지 다양한 정보를 담을 수 있습니다. 메시지는 수신 애플리케이션에 의해 검색되고 처리될 때까지 큐 관리자 소프트웨어에 의해 보관됩니다. AWS는 RabbitMQ 서버를 호스팅하고 관리하기 위한 사용하기 쉬운 솔루션을 제공합니다.

### AWS - ActiveMQ

Apache ActiveMQ®는 다재다능함으로 유명한 선도적인 오픈 소스 Java 기반 **메시지 브로커**입니다. 여러 산업 표준 프로토콜을 지원하여 다양한 언어와 플랫폼에서 광범위한 클라이언트 호환성을 제공합니다. 사용자는:

* JavaScript, C, C++, Python, .Net 등으로 작성된 클라이언트와 연결할 수 있습니다.
* **AMQP** 프로토콜을 활용하여 서로 다른 플랫폼의 애플리케이션을 통합할 수 있습니다.
* 웹 애플리케이션 메시지 교환을 위해 웹소켓을 통한 **STOMP**를 사용할 수 있습니다.
* **MQTT**로 IoT 장치를 관리할 수 있습니다.
* 기존 **JMS** 인프라를 유지하고 그 기능을 확장할 수 있습니다.

ActiveMQ의 강력함과 유연성은 다양한 메시징 요구 사항에 적합하게 만듭니다.

## Enumeration
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
{% hint style="warning" %}
TODO: RabbitMQ와 ActiveMQ를 내부적으로 열거하는 방법과 모든 큐를 수신하고 데이터를 전송하는 방법을 표시하십시오 (방법을 아는 경우 PR을 보내십시오)
{% endhint %}

## Privesc

{% content-ref url="../aws-privilege-escalation/aws-mq-privesc.md" %}
[aws-mq-privesc.md](../aws-privilege-escalation/aws-mq-privesc.md)
{% endcontent-ref %}

## 인증되지 않은 접근

{% content-ref url="../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md" %}
[aws-mq-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md)
{% endcontent-ref %}

## 지속성

RabbitMQ 웹 콘솔에 접근할 수 있는 자격 증명이 있는 경우, 관리자 권한을 가진 새로운 사용자를 생성할 수 있습니다.

## 참고자료

* [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
* [https://activemq.apache.org/](https://activemq.apache.org/)

{% hint style="success" %}
AWS 해킹 배우기 및 연습하기:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP 해킹 배우기 및 연습하기: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks 지원하기</summary>

* [**구독 계획**](https://github.com/sponsors/carlospolop) 확인하기!
* **💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 참여하거나 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**를 팔로우하세요.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) 깃허브 리포지토리에 PR을 제출하여 해킹 팁을 공유하세요.**

</details>
{% endhint %}
