# AWS - MQ Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Amazon MQ

### Introduction to Message Brokers

**Message brokers** hutumikia kama wapatanishi, wakirahisisha mawasiliano kati ya mifumo tofauti ya programu, ambayo inaweza kujengwa kwenye majukwaa tofauti na kuandikwa kwa lugha tofauti. **Amazon MQ** inarahisisha uwekaji, uendeshaji, na matengenezo ya wapatanishi wa ujumbe kwenye AWS. Inatoa huduma zinazodhibitiwa kwa **Apache ActiveMQ** na **RabbitMQ**, kuhakikisha upatikanaji usio na mshono na masasisho ya toleo la programu kiotomatiki.

### AWS - RabbitMQ

RabbitMQ ni programu maarufu ya **message-queueing software**, pia inajulikana kama _message broker_ au _queue manager_. Kimsingi ni mfumo ambapo foleni zinawekwa. Programu zinawasiliana na hizi foleni ili **kutuma na kupokea ujumbe**. Ujumbe katika muktadha huu unaweza kubeba aina mbalimbali za taarifa, kuanzia amri za kuanzisha michakato kwenye programu nyingine (labda kwenye seva tofauti) hadi ujumbe wa maandiko rahisi. Ujumbe unashikiliwa na programu ya queue-manager hadi unapopatikana na kusindika na programu inayopokea. AWS inatoa suluhisho rahisi la kutumia kwa kuhost na kusimamia seva za RabbitMQ.

### AWS - ActiveMQ

Apache ActiveMQ¬Æ ni **message broker** inayoongoza ya chanzo wazi, inayotegemea Java, inayojulikana kwa ufanisi wake. Inasaidia protokali nyingi za viwango vya tasnia, ikitoa ulinganifu mpana wa wateja katika lugha na majukwaa mbalimbali. Watumiaji wanaweza:

* Kuunganisha na wateja waliandikwa kwa JavaScript, C, C++, Python, .Net, na zaidi.
* Kutumia protokali ya **AMQP** kuunganisha programu kutoka majukwaa tofauti.
* Kutumia **STOMP** kupitia websockets kwa ubadilishanaji wa ujumbe wa programu za wavuti.
* Kusimamia vifaa vya IoT kwa **MQTT**.
* Kudumisha miundombinu ya **JMS** iliyopo na kupanua uwezo wake.

Uwezo na kubadilika kwa ActiveMQ hufanya iweze kutumika kwa mahitaji mengi ya ujumbe.

## Enumeration
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
{% hint style="warning" %}
TODO: Onyesha jinsi ya kuhesabu RabbitMQ na ActiveMQ ndani na jinsi ya kusikiliza katika foleni zote na kutuma data (tuma PR ikiwa unajua jinsi ya kufanya hivi)
{% endhint %}

## Privesc

{% content-ref url="../aws-privilege-escalation/aws-mq-privesc.md" %}
[aws-mq-privesc.md](../aws-privilege-escalation/aws-mq-privesc.md)
{% endcontent-ref %}

## Unauthenticated Access

{% content-ref url="../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md" %}
[aws-mq-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md)
{% endcontent-ref %}

## Persistence

Ikiwa unajua taarifa za kuingia kwenye konsoli ya wavuti ya RabbitMQ, unaweza kuunda mtumiaji mpya mwenye mamlaka ya admin.

## References

* [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
* [https://activemq.apache.org/](https://activemq.apache.org/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
