# AWS - MQ Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Amazon MQ

### Introduction aux courtiers de messages

**Les courtiers de messages** servent d'interm√©diaires, facilitant la communication entre diff√©rents syst√®mes logiciels, qui peuvent √™tre construits sur des plateformes vari√©es et programm√©s dans diff√©rents langages. **Amazon MQ** simplifie le d√©ploiement, l'exploitation et la maintenance des courtiers de messages sur AWS. Il fournit des services g√©r√©s pour **Apache ActiveMQ** et **RabbitMQ**, garantissant un approvisionnement sans faille et des mises √† jour automatiques des versions logicielles.

### AWS - RabbitMQ

RabbitMQ est un logiciel de **file d'attente de messages** de premier plan, √©galement connu sous le nom de _courtier de messages_ ou _gestionnaire de files d'attente_. C'est fondamentalement un syst√®me o√π des files d'attente sont configur√©es. Les applications interagissent avec ces files d'attente pour **envoyer et recevoir des messages**. Les messages dans ce contexte peuvent transporter une vari√©t√© d'informations, allant des commandes pour initier des processus sur d'autres applications (potentiellement sur diff√©rents serveurs) √† de simples messages texte. Les messages sont conserv√©s par le logiciel de gestionnaire de files d'attente jusqu'√† ce qu'ils soient r√©cup√©r√©s et trait√©s par une application r√©ceptrice. AWS fournit une solution facile √† utiliser pour h√©berger et g√©rer des serveurs RabbitMQ.

### AWS - ActiveMQ

Apache ActiveMQ¬Æ est un **courtier de messages** open-source bas√© sur Java, reconnu pour sa polyvalence. Il prend en charge plusieurs protocoles standard de l'industrie, offrant une compatibilit√© client √©tendue √† travers un large √©ventail de langages et de plateformes. Les utilisateurs peuvent :

* Se connecter avec des clients √©crits en JavaScript, C, C++, Python, .Net, et plus encore.
* Tirer parti du protocole **AMQP** pour int√©grer des applications de diff√©rentes plateformes.
* Utiliser **STOMP** sur websockets pour les √©changes de messages d'applications web.
* G√©rer des appareils IoT avec **MQTT**.
* Maintenir l'infrastructure **JMS** existante et √©tendre ses capacit√©s.

La robustesse et la flexibilit√© d'ActiveMQ le rendent adapt√© √† une multitude de besoins en mati√®re de messagerie.

## Enumeration
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
{% hint style="warning" %}
TODO : Indiquer comment √©num√©rer RabbitMQ et ActiveMQ en interne et comment √©couter toutes les files d'attente et envoyer des donn√©es (envoyez une PR si vous savez comment faire cela)
{% endhint %}

## Privesc

{% content-ref url="../aws-privilege-escalation/aws-mq-privesc.md" %}
[aws-mq-privesc.md](../aws-privilege-escalation/aws-mq-privesc.md)
{% endcontent-ref %}

## Acc√®s non authentifi√©

{% content-ref url="../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md" %}
[aws-mq-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md)
{% endcontent-ref %}

## Persistance

Si vous connaissez les identifiants pour acc√©der √† la console web RabbitMQ, vous pouvez cr√©er un nouvel utilisateur avec des privil√®ges d'administrateur.

## R√©f√©rences

* [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
* [https://activemq.apache.org/](https://activemq.apache.org/)

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
