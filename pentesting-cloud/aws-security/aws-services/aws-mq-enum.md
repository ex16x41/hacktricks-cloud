# AWS - MQ Enum

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## Amazon MQ

### æ¶ˆæ¯ä»£ç†ç®€ä»‹

**æ¶ˆæ¯ä»£ç†**ä½œä¸ºä¸­ä»‹ï¼Œä¿ƒè¿›ä¸åŒè½¯ä»¶ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡ï¼Œè¿™äº›ç³»ç»Ÿå¯èƒ½å»ºç«‹åœ¨ä¸åŒçš„å¹³å°ä¸Šï¼Œå¹¶ç”¨ä¸åŒçš„è¯­è¨€ç¼–å†™ã€‚**Amazon MQ** ç®€åŒ–äº†åœ¨ AWS ä¸Šæ¶ˆæ¯ä»£ç†çš„éƒ¨ç½²ã€æ“ä½œå’Œç»´æŠ¤ã€‚å®ƒä¸º **Apache ActiveMQ** å’Œ **RabbitMQ** æä¾›æ‰˜ç®¡æœåŠ¡ï¼Œç¡®ä¿æ— ç¼çš„èµ„æºé…ç½®å’Œè‡ªåŠ¨è½¯ä»¶ç‰ˆæœ¬æ›´æ–°ã€‚

### AWS - RabbitMQ

RabbitMQ æ˜¯ä¸€ç§è‘—åçš„ **æ¶ˆæ¯é˜Ÿåˆ—è½¯ä»¶**ï¼Œä¹Ÿè¢«ç§°ä¸º _æ¶ˆæ¯ä»£ç†_ æˆ– _é˜Ÿåˆ—ç®¡ç†å™¨_ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé…ç½®é˜Ÿåˆ—çš„ç³»ç»Ÿã€‚åº”ç”¨ç¨‹åºé€šè¿‡è¿™äº›é˜Ÿåˆ— **å‘é€å’Œæ¥æ”¶æ¶ˆæ¯**ã€‚åœ¨æ­¤ä¸Šä¸‹æ–‡ä¸­ï¼Œæ¶ˆæ¯å¯ä»¥æºå¸¦å„ç§ä¿¡æ¯ï¼Œä»å¯åŠ¨å…¶ä»–åº”ç”¨ç¨‹åºï¼ˆå¯èƒ½åœ¨ä¸åŒæœåŠ¡å™¨ä¸Šï¼‰è¿›ç¨‹çš„å‘½ä»¤åˆ°ç®€å•çš„æ–‡æœ¬æ¶ˆæ¯ã€‚è¿™äº›æ¶ˆæ¯ç”±é˜Ÿåˆ—ç®¡ç†è½¯ä»¶ä¿å­˜ï¼Œç›´åˆ°è¢«æ¥æ”¶åº”ç”¨ç¨‹åºæ£€ç´¢å’Œå¤„ç†ã€‚AWS æä¾›äº†ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„è§£å†³æ–¹æ¡ˆæ¥æ‰˜ç®¡å’Œç®¡ç† RabbitMQ æœåŠ¡å™¨ã€‚

### AWS - ActiveMQ

Apache ActiveMQÂ® æ˜¯ä¸€ç§é¢†å…ˆçš„å¼€æºã€åŸºäº Java çš„ **æ¶ˆæ¯ä»£ç†**ï¼Œä»¥å…¶å¤šåŠŸèƒ½æ€§è€Œé—»åã€‚å®ƒæ”¯æŒå¤šç§è¡Œä¸šæ ‡å‡†åè®®ï¼Œæä¾›å¹¿æ³›çš„å®¢æˆ·ç«¯å…¼å®¹æ€§ï¼Œé€‚ç”¨äºå„ç§è¯­è¨€å’Œå¹³å°ã€‚ç”¨æˆ·å¯ä»¥ï¼š

* è¿æ¥ç”¨ JavaScriptã€Cã€C++ã€Pythonã€.Net ç­‰ç¼–å†™çš„å®¢æˆ·ç«¯ã€‚
* åˆ©ç”¨ **AMQP** åè®®é›†æˆæ¥è‡ªä¸åŒå¹³å°çš„åº”ç”¨ç¨‹åºã€‚
* ä½¿ç”¨ **STOMP** é€šè¿‡ WebSockets è¿›è¡Œ Web åº”ç”¨ç¨‹åºæ¶ˆæ¯äº¤æ¢ã€‚
* ä½¿ç”¨ **MQTT** ç®¡ç†ç‰©è”ç½‘è®¾å¤‡ã€‚
* ç»´æŠ¤ç°æœ‰çš„ **JMS** åŸºç¡€è®¾æ–½å¹¶æ‰©å±•å…¶åŠŸèƒ½ã€‚

ActiveMQ çš„å¼ºå¤§å’Œçµæ´»æ€§ä½¿å…¶é€‚ç”¨äºå¤šç§æ¶ˆæ¯ä¼ é€’éœ€æ±‚ã€‚

## æšä¸¾
```bash
# List brokers
aws mq list-brokers

# Get broker info
aws mq describe-broker --broker-id <broker-id>
## Find endpoints in .BrokerInstances
## Find if public accessible in .PubliclyAccessible

# List usernames (only for ActiveMQ)
aws mq list-users --broker-id <broker-id>

# Get user info (PASSWORD NOT INCLUDED)
aws mq describe-user --broker-id <broker-id> --username <username>

# Lits configurations (only for ActiveMQ)
aws mq list-configurations
## Here you can find if simple or LDAP authentication is used

# Creacte Active MQ user
aws mq create-user --broker-id <value> --password <value> --username <value> --console-access
```
{% hint style="warning" %}
TODO: æŒ‡ç¤ºå¦‚ä½•åœ¨å†…éƒ¨æšä¸¾ RabbitMQ å’Œ ActiveMQï¼Œä»¥åŠå¦‚ä½•ç›‘å¬æ‰€æœ‰é˜Ÿåˆ—å¹¶å‘é€æ•°æ®ï¼ˆå¦‚æœä½ çŸ¥é“å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¯·å‘é€ PRï¼‰
{% endhint %}

## Privesc

{% content-ref url="../aws-privilege-escalation/aws-mq-privesc.md" %}
[aws-mq-privesc.md](../aws-privilege-escalation/aws-mq-privesc.md)
{% endcontent-ref %}

## Unauthenticated Access

{% content-ref url="../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md" %}
[aws-mq-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-mq-unauthenticated-enum.md)
{% endcontent-ref %}

## Persistence

å¦‚æœä½ çŸ¥é“è®¿é—® RabbitMQ ç½‘ç»œæ§åˆ¶å°çš„å‡­æ®ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚

## References

* [https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html](https://www.cloudamqp.com/blog/part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
* [https://activemq.apache.org/](https://activemq.apache.org/)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
