# AWS - Elastic Beanstalk Enum

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PRs åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}

## Elastic Beanstalk

Amazon Elastic Beanstalk æä¾›äº†ä¸€ä¸ªç®€åŒ–çš„å¹³å°ï¼Œç”¨äº**éƒ¨ç½²ã€ç®¡ç†å’Œæ‰©å±• Web åº”ç”¨ç¨‹åºå’ŒæœåŠ¡**ã€‚å®ƒæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ï¼Œå¦‚ Javaã€.NETã€PHPã€Node.jsã€Pythonã€Ruby å’Œ Goï¼Œä»¥åŠ Docker å®¹å™¨ã€‚è¯¥æœåŠ¡å…¼å®¹å¹¿æ³›ä½¿ç”¨çš„æœåŠ¡å™¨ï¼ŒåŒ…æ‹¬ Apacheã€Nginxã€Passenger å’Œ IISã€‚

Elastic Beanstalk æä¾›äº†ä¸€ç§ç®€å•è€Œçµæ´»çš„æ–¹å¼å°†**åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° AWS äº‘**ï¼Œæ— éœ€æ‹…å¿ƒåº•å±‚åŸºç¡€è®¾æ–½ã€‚å®ƒ**è‡ªåŠ¨**å¤„ç†å®¹é‡**é…ç½®**ã€è´Ÿè½½**å‡è¡¡**ã€**æ‰©å±•**å’Œåº”ç”¨ç¨‹åºå¥åº·**ç›‘æ§**çš„ç»†èŠ‚ï¼Œè®©æ‚¨ä¸“æ³¨äºç¼–å†™å’Œéƒ¨ç½²ä»£ç ã€‚

Elastic Beanstalk åˆ›å»ºçš„åŸºç¡€è®¾æ–½ç”± **EC2** ä¸­çš„ **Autoscaling** ç»„ç®¡ç†ï¼ˆå¸¦æœ‰è´Ÿè½½å‡è¡¡å™¨ï¼‰ã€‚è¿™æ„å‘³ç€æœ€ç»ˆï¼Œå¦‚æœæ‚¨**æ”»ç ´ä¸»æœº**ï¼Œæ‚¨åº”è¯¥äº†è§£ EC2ï¼š

{% content-ref url="aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

æ­¤å¤–ï¼Œå¦‚æœä½¿ç”¨ Dockerï¼Œå¯ä»¥ä½¿ç”¨ **ECS**ã€‚

{% content-ref url="aws-eks-enum.md" %}
[aws-eks-enum.md](aws-eks-enum.md)
{% endcontent-ref %}

### Application & Environments

åœ¨ AWS Elastic Beanstalk ä¸­ï¼Œâ€œåº”ç”¨ç¨‹åºâ€å’Œâ€œç¯å¢ƒâ€çš„æ¦‚å¿µåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­å…·æœ‰ä¸åŒçš„ç›®çš„å’Œè§’è‰²ã€‚

#### Application

* Elastic Beanstalk ä¸­çš„åº”ç”¨ç¨‹åºæ˜¯**åº”ç”¨ç¨‹åºæºä»£ç ã€ç¯å¢ƒå’Œé…ç½®çš„é€»è¾‘å®¹å™¨**ã€‚å®ƒå°†åº”ç”¨ç¨‹åºä»£ç çš„ä¸åŒç‰ˆæœ¬ç»„åˆåœ¨ä¸€èµ·ï¼Œå…è®¸æ‚¨å°†å®ƒä»¬ä½œä¸ºä¸€ä¸ªå®ä½“è¿›è¡Œç®¡ç†ã€‚
* å½“æ‚¨åˆ›å»ºåº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨æä¾›ä¸€ä¸ªåç§°å’Œæè¿°ï¼Œä½†æ­¤é˜¶æ®µä¸ä¼šé…ç½®ä»»ä½•èµ„æºã€‚å®ƒåªæ˜¯ç»„ç»‡å’Œç®¡ç†ä»£ç åŠç›¸å…³èµ„æºçš„ä¸€ç§æ–¹å¼ã€‚
* æ‚¨å¯ä»¥åœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­æ‹¥æœ‰**å¤šä¸ªåº”ç”¨ç¨‹åºç‰ˆæœ¬**ã€‚æ¯ä¸ªç‰ˆæœ¬å¯¹åº”äºä»£ç çš„ç‰¹å®šå‘å¸ƒï¼Œå¯ä»¥éƒ¨ç½²åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªç¯å¢ƒä¸­ã€‚

#### Environment

* ç¯å¢ƒæ˜¯**åœ¨ AWS åŸºç¡€è®¾æ–½ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºçš„é…ç½®å®ä¾‹**ã€‚å®ƒæ˜¯**åº”ç”¨ç¨‹åºä»£ç éƒ¨ç½²å’Œæ‰§è¡Œçš„åœ°æ–¹**ã€‚Elastic Beanstalk æ ¹æ®ç¯å¢ƒé…ç½®é…ç½®æ‰€éœ€çš„èµ„æºï¼ˆä¾‹å¦‚ï¼ŒEC2 å®ä¾‹ã€è´Ÿè½½å‡è¡¡å™¨ã€è‡ªåŠ¨æ‰©å±•ç»„ã€æ•°æ®åº“ï¼‰ã€‚
* **æ¯ä¸ªç¯å¢ƒè¿è¡Œåº”ç”¨ç¨‹åºçš„å•ä¸ªç‰ˆæœ¬**ï¼Œæ‚¨å¯ä»¥ä¸ºä¸åŒç›®çš„ï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•ã€é¢„å‘å¸ƒå’Œç”Ÿäº§ï¼‰åˆ›å»ºå¤šä¸ªç¯å¢ƒã€‚
* å½“æ‚¨åˆ›å»ºç¯å¢ƒæ—¶ï¼Œæ‚¨é€‰æ‹©ä¸€ä¸ªå¹³å°ï¼ˆä¾‹å¦‚ï¼ŒJavaã€.NETã€Node.js ç­‰ï¼‰å’Œä¸€ä¸ªç¯å¢ƒç±»å‹ï¼ˆä¾‹å¦‚ï¼ŒWeb æœåŠ¡å™¨æˆ–å·¥ä½œè€…ï¼‰ã€‚æ‚¨è¿˜å¯ä»¥è‡ªå®šä¹‰ç¯å¢ƒé…ç½®ï¼Œä»¥æ§åˆ¶åŸºç¡€è®¾æ–½å’Œåº”ç”¨ç¨‹åºè®¾ç½®çš„å„ä¸ªæ–¹é¢ã€‚

### 2 types of Environments

1. **Web Server Environment**: è®¾è®¡ç”¨äº**æ‰˜ç®¡å’ŒæœåŠ¡ Web åº”ç”¨ç¨‹åºå’Œ API**ã€‚è¿™äº›åº”ç”¨ç¨‹åºé€šå¸¸å¤„ç†ä¼ å…¥çš„ HTTP/HTTPS è¯·æ±‚ã€‚Web æœåŠ¡å™¨ç¯å¢ƒé…ç½®èµ„æºï¼Œå¦‚ **EC2 å®ä¾‹ã€è´Ÿè½½å‡è¡¡å™¨å’Œè‡ªåŠ¨æ‰©å±•**ç»„ï¼Œä»¥å¤„ç†ä¼ å…¥æµé‡ã€ç®¡ç†å®¹é‡å¹¶ç¡®ä¿åº”ç”¨ç¨‹åºçš„é«˜å¯ç”¨æ€§ã€‚
2. **Worker Environment**: è®¾è®¡ç”¨äºå¤„ç†**åå°ä»»åŠ¡**ï¼Œè¿™äº›ä»»åŠ¡é€šå¸¸æ˜¯è€—æ—¶æˆ–èµ„æºå¯†é›†å‹æ“ä½œï¼Œä¸éœ€è¦ç«‹å³å“åº”å®¢æˆ·ç«¯ã€‚å·¥ä½œè€…ç¯å¢ƒé…ç½®èµ„æºï¼Œå¦‚ **EC2 å®ä¾‹å’Œè‡ªåŠ¨æ‰©å±•ç»„**ï¼Œä½†**æ²¡æœ‰è´Ÿè½½å‡è¡¡å™¨**ï¼Œå› ä¸ºå®ƒä¸ç›´æ¥å¤„ç† HTTP/HTTPS è¯·æ±‚ã€‚ç›¸åï¼Œå®ƒä» **Amazon Simple Queue Service (SQS) é˜Ÿåˆ—**ä¸­è·å–ä»»åŠ¡ï¼Œè¯¥é˜Ÿåˆ—å……å½“å·¥ä½œè€…ç¯å¢ƒå’Œå…¶å¤„ç†ä»»åŠ¡ä¹‹é—´çš„ç¼“å†²åŒºã€‚

### Security

åœ¨ Beanstalk ä¸­åˆ›å»ºåº”ç”¨ç¨‹åºæ—¶ï¼Œæœ‰ä¸‰ä¸ªéå¸¸é‡è¦çš„å®‰å…¨é€‰é¡¹å¯ä¾›é€‰æ‹©ï¼š

* **EC2 å¯†é’¥å¯¹**: è¿™å°†æ˜¯èƒ½å¤Ÿè®¿é—®è¿è¡Œåº”ç”¨ç¨‹åºçš„ EC2 å®ä¾‹çš„ **SSH å¯†é’¥**
* **IAM å®ä¾‹é…ç½®æ–‡ä»¶**: è¿™æ˜¯å®ä¾‹å°†æ‹¥æœ‰çš„**å®ä¾‹é…ç½®æ–‡ä»¶**ï¼ˆ**IAM æƒé™**ï¼‰
* è‡ªåŠ¨ç”Ÿæˆçš„è§’è‰²ç§°ä¸º **`aws-elasticbeanstalk-ec2-role`**ï¼Œå¹¶é€šè¿‡ AWS ç®¡ç†çš„ç­–ç•¥å¯¹æ‰€æœ‰ ECSã€æ‰€æœ‰ SQSã€DynamoDB elasticbeanstalk å’Œ elasticbeanstalk S3 å…·æœ‰ä¸€äº›æœ‰è¶£çš„è®¿é—®æƒé™ï¼š[AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **æœåŠ¡è§’è‰²**: è¿™æ˜¯ **AWS æœåŠ¡**å°†ç”¨äºæ‰§è¡Œæ‰€æœ‰æ‰€éœ€æ“ä½œçš„**è§’è‰²**ã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œå¸¸è§„ AWS ç”¨æˆ·æ— æ³•è®¿é—®è¯¥è§’è‰²ã€‚
* ç”± AWS ç”Ÿæˆçš„æ­¤è§’è‰²ç§°ä¸º **`aws-elasticbeanstalk-service-role`**ï¼Œå¹¶ä½¿ç”¨ AWS ç®¡ç†çš„ç­–ç•¥ [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) å’Œ [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

é»˜è®¤æƒ…å†µä¸‹ï¼Œ**å…ƒæ•°æ®ç‰ˆæœ¬ 1 è¢«ç¦ç”¨**ï¼š

<figure><img src="../../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>

### Exposure

Beanstalk æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ª **S3 bucket** ä¸­ï¼Œåç§°ä¸ºï¼š**`elasticbeanstalk-<region>-<acc-id>`**ï¼ˆå¦‚æœæ˜¯åœ¨ AWS æ§åˆ¶å°ä¸­åˆ›å»ºçš„ï¼‰ã€‚åœ¨è¿™ä¸ª bucket ä¸­ï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸Šä¼ çš„**åº”ç”¨ç¨‹åºæºä»£ç **ã€‚

åˆ›å»ºçš„ç½‘é¡µçš„ **URL** æ˜¯ **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
å¦‚æœæ‚¨è·å¾—äº† bucket çš„**è¯»å–è®¿é—®æƒé™**ï¼Œæ‚¨å¯ä»¥**è¯»å–æºä»£ç **ï¼Œç”šè‡³æ‰¾åˆ°**æ•æ„Ÿå‡­è¯**

å¦‚æœæ‚¨è·å¾—äº† bucket çš„**å†™å…¥è®¿é—®æƒé™**ï¼Œæ‚¨å¯ä»¥**ä¿®æ”¹æºä»£ç **ï¼Œä»¥åœ¨ä¸‹æ¬¡æ‰§è¡Œæ—¶**æ”»ç ´**åº”ç”¨ç¨‹åºä½¿ç”¨çš„**IAM è§’è‰²**ã€‚
{% endhint %}

### Enumeration

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### æœªç»èº«ä»½éªŒè¯çš„è®¿é—®

{% content-ref url="../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### æŒä¹…æ€§

{% content-ref url="../aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### æƒé™æå‡

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### åæœŸåˆ©ç”¨

{% content-ref url="../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hackingï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hackingï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PRs åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}
