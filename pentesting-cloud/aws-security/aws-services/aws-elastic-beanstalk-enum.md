# AWS - Elastic Beanstalk Enum

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr코ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Elastic Beanstalk

Amazon Elastic Beanstalk pru쬬 pojednostavljenu platformu za **implementaciju, upravljanje i skaliranje web aplikacija i usluga**. Podr쬬va razne programske jezike i okvire, kao 코to su Java, .NET, PHP, Node.js, Python, Ruby i Go, kao i Docker kontejnere. Usluga je kompatibilna sa 코iroko kori코캖enim serverima uklju캜uju캖i Apache, Nginx, Passenger i IIS.

Elastic Beanstalk pru쬬 jednostavan i fleksibilan na캜in za **implementaciju va코ih aplikacija u AWS cloud**, bez potrebe da brinete o osnovnoj infrastrukturi. Ona **automatski** upravlja detaljima kapaciteta **provisioning**, optere캖enja **balansiranja**, **skaliranja** i zdravlja aplikacije **monitoring**, omogu캖avaju캖i vam da se fokusirate na pisanje i implementaciju va코eg koda.

Infrastruktura koju kreira Elastic Beanstalk upravlja **Autoscaling** grupama u **EC2** (sa load balancer-om). 맚o zna캜i da na kraju dana, ako **kompromitujete host**, trebali biste znati o EC2:

{% content-ref url="aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Pored toga, ako se koristi Docker, mogu캖e je koristiti **ECS**.

{% content-ref url="aws-eks-enum.md" %}
[aws-eks-enum.md](aws-eks-enum.md)
{% endcontent-ref %}

### Aplikacija i Okru쬰nja

U AWS Elastic Beanstalk, koncepti "aplikacije" i "okru쬰nja" slu쬰 razli캜itim svrhama i imaju razli캜ite uloge u procesu implementacije.

#### Aplikacija

* Aplikacija u Elastic Beanstalk je **logi캜ki kontejner za izvorni kod va코e aplikacije, okru쬰nja i konfiguracije**. Grupira razli캜ite verzije va코eg aplikacionog koda i omogu캖ava vam da njima upravljate kao jednom celinom.
* Kada kreirate aplikaciju, pru쬬te ime i **opis, ali resursi se ne provisioniraju** u ovoj fazi. To je jednostavno na캜in da organizujete i upravljate svojim kodom i povezanim resursima.
* Mo쬰te imati **vi코e verzija aplikacije** unutar jedne aplikacije. Svaka verzija odgovara specifi캜nom izdanju va코eg koda, koje mo쬰 biti implementirano u jedno ili vi코e okru쬰nja.

#### Okru쬰nje

* Okru쬰nje je **provisionirana instanca va코e aplikacije** koja radi na AWS infrastrukturi. To je **gde se va코 aplikacioni kod implementira i izvr코ava**. Elastic Beanstalk provisionira potrebne resurse (npr. EC2 instance, load balancere, auto-scaling grupe, baze podataka) na osnovu konfiguracije okru쬰nja.
* **Svako okru쬰nje pokre캖e jednu verziju va코e aplikacije**, i mo쬰te imati vi코e okru쬰nja za razli캜ite svrhe, kao 코to su razvoj, testiranje, staging i produkcija.
* Kada kreirate okru쬰nje, birate platformu (npr. Java, .NET, Node.js, itd.) i tip okru쬰nja (npr. web server ili worker). Tako캠e mo쬰te prilagoditi konfiguraciju okru쬰nja kako biste kontrolisali razli캜ite aspekte infrastrukture i postavki aplikacije.

### 2 tipa Okru쬰nja

1. **Web Server Okru쬰nje**: Dizajnirano je da **hostuje i servira web aplikacije i API-je**. Ove aplikacije obi캜no obra캠uju dolazne HTTP/HTTPS zahteve. Web server okru쬰nje provisionira resurse kao 코to su **EC2 instance, load balanceri i auto-scaling** grupe za upravljanje dolaznim saobra캖ajem, upravljanje kapacitetom i osiguranje visoke dostupnosti aplikacije.
2. **Worker Okru쬰nje**: Dizajnirano je za obradu **pozadinskih zadataka**, koji su 캜esto dugotrajne ili resursno intenzivne operacije koje ne zahtevaju trenutne odgovore klijentima. Worker okru쬰nje provisionira resurse kao 코to su **EC2 instance i auto-scaling grupe**, ali **nema load balancer** jer ne obra캠uje HTTP/HTTPS zahteve direktno. Umesto toga, konzumira zadatke iz **Amazon Simple Queue Service (SQS)** reda, koji deluje kao me캠uspremnik izme캠u worker okru쬰nja i zadataka koje obra캠uje.

### Bezbednost

Kada kreirate aplikaciju u Beanstalk-u, postoje 3 veoma va쬹a bezbednosna opcija za izbor:

* **EC2 klju캜ni par**: Ovo 캖e biti **SSH klju캜** koji 캖e mo캖i da pristupi EC2 instancama koje pokre캖u aplikaciju.
* **IAM instancni profil**: Ovo je **instancni profil** koji 캖e instance imati (**IAM privilegije**).
* Autogenerisana uloga se zove **`aws-elasticbeanstalk-ec2-role`** i ima zanimljiv pristup svim ECS, svim SQS, DynamoDB elasticbeanstalk i elasticbeanstalk S3 koriste캖i AWS upravljane politike: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Uloga usluge**: Ovo je **uloga koju 캖e AWS usluga** koristiti za izvr코avanje svih potrebnih akcija. Koliko znam, obi캜an AWS korisnik ne mo쬰 pristupiti toj ulozi.
* Ova uloga generisana od strane AWS-a se zove **`aws-elasticbeanstalk-service-role`** i koristi AWS upravljane politike [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) i [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions)

Podrazumevano je **metadata verzija 1 onemogu캖ena**:

<figure><img src="../../../.gitbook/assets/image (103).png" alt=""><figcaption></figcaption></figure>

### Izlo쬰nost

Podaci Beanstalk-a se 캜uvaju u **S3 bucket-u** sa slede캖im imenom: **`elasticbeanstalk-<region>-<acc-id>`**(ako je kreiran u AWS konzoli). Unutar ovog bucket-a na캖i 캖ete u캜itani **izvorni kod aplikacije**.

**URL** kreirane web stranice je **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Ako dobijete **pristup za 캜itanje** nad bucket-om, mo쬰te **pro캜itati izvorni kod** i 캜ak prona캖i **osetljive akreditive** u njemu.

Ako dobijete **pristup za pisanje** nad bucket-om, mogli biste **modifikovati izvorni kod** da **kompromitujete** **IAM ulogu** koju aplikacija koristi slede캖i put kada se izvr코i.
{% endhint %}

### Enumeracija

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Neautentifikovani pristup

{% content-ref url="../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Postojanost

{% content-ref url="../aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Eskalacija privilegija

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Post-eksploatacija

{% content-ref url="../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr코ka HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
