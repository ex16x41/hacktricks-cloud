# AWS - Relational Database (RDS) Enum

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na.

</details>
{% endhint %}

## Temel Bilgiler

AWS tarafÄ±ndan sunulan **Relational Database Service (RDS)**, **bulutta iliÅŸkisel bir veritabanÄ±nÄ±n** daÄŸÄ±tÄ±mÄ±nÄ±, iÅŸletimini ve Ã¶lÃ§eklendirilmesini kolaylaÅŸtÄ±rmak iÃ§in tasarlanmÄ±ÅŸtÄ±r. Bu hizmet, donanÄ±m saÄŸlama, veritabanÄ± yapÄ±landÄ±rma, yamalama ve yedekleme gibi emek yoÄŸun gÃ¶revleri otomatikleÅŸtirirken maliyet etkinliÄŸi ve Ã¶lÃ§eklenebilirlik avantajlarÄ± sunar.

AWS RDS, MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server ve Amazon Aurora gibi Ã§eÅŸitli yaygÄ±n olarak kullanÄ±lan iliÅŸkisel veritabanÄ± motorlarÄ±nÄ± destekler ve hem MySQL hem de PostgreSQL ile uyumludur.

RDS'nin ana Ã¶zellikleri ÅŸunlardÄ±r:

* **VeritabanÄ± Ã¶rneklerinin yÃ¶netimi** basitleÅŸtirilmiÅŸtir.
* Okuma performansÄ±nÄ± artÄ±rmak iÃ§in **okuma replikalarÄ±** oluÅŸturma.
* YÃ¼ksek kullanÄ±labilirlik ve hata toleransÄ± saÄŸlamak iÃ§in **Ã§oklu-Availability Zone (AZ) daÄŸÄ±tÄ±mlarÄ±** yapÄ±landÄ±rma.
* DiÄŸer AWS hizmetleri ile **entegrasyon**, Ã¶rneÄŸin:
* GÃ¼Ã§lÃ¼ eriÅŸim kontrolÃ¼ iÃ§in AWS Kimlik ve EriÅŸim YÃ¶netimi (**IAM**).
* KapsamlÄ± izleme ve metrikler iÃ§in AWS **CloudWatch**.
* Dinlenme halinde ÅŸifreleme saÄŸlamak iÃ§in AWS Anahtar YÃ¶netim Hizmeti (**KMS**).

## Kimlik Bilgileri

DB kÃ¼mesini oluÅŸtururken ana **kullanÄ±cÄ± adÄ±** yapÄ±landÄ±rÄ±labilir (**`admin`** varsayÄ±lan olarak). Bu kullanÄ±cÄ±nÄ±n ÅŸifresini oluÅŸturmak iÃ§in ÅŸunlarÄ± yapabilirsiniz:

* Kendiniz bir **ÅŸifre** belirleyin
* RDS'ye **otomatik olarak oluÅŸturmasÄ±nÄ±** sÃ¶yleyin
* RDS'ye bir KMS anahtarÄ± ile ÅŸifrelenmiÅŸ **AWS Secret Manager**'da yÃ¶netmesini sÃ¶yleyin

<figure><img src="../../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

### Kimlik DoÄŸrulama

3 tÃ¼r kimlik doÄŸrulama seÃ§eneÄŸi vardÄ±r, ancak **ana ÅŸifreyi kullanmak her zaman mÃ¼mkÃ¼ndÃ¼r**:

<figure><img src="../../../.gitbook/assets/image (227).png" alt=""><figcaption></figcaption></figure>

### Genel EriÅŸim & VPC

VarsayÄ±lan olarak **veritabanlarÄ±na genel eriÅŸim verilmez**, ancak **verilebilir**. Bu nedenle, varsayÄ±lan olarak yalnÄ±zca aynÄ± VPC'den makineler, seÃ§ilen **gÃ¼venlik grubu** (EC2 SG'de saklanÄ±r) izin veriyorsa eriÅŸebilir.

Bir DB Ã¶rneÄŸini aÃ§Ä±ÄŸa Ã§Ä±karmak yerine, DB kÃ¼mesinin **Ã¶lÃ§eklenebilirliÄŸini** ve **kullanÄ±labilirliÄŸini** artÄ±ran bir **RDS Proxy** oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r.

AyrÄ±ca, **veritabanÄ± portu da deÄŸiÅŸtirilebilir**.

### Åifreleme

**Åifreleme varsayÄ±lan olarak etkinleÅŸtirilmiÅŸtir** ve AWS yÃ¶netilen bir anahtar kullanÄ±r (bunun yerine bir CMK seÃ§ilebilir).

Åifrelemeyi etkinleÅŸtirerek, **depolama, anlÄ±k gÃ¶rÃ¼ntÃ¼ler, okuma replikalarÄ± ve yedekleriniz iÃ§in dinlenme halinde ÅŸifrelemeyi** etkinleÅŸtiriyorsunuz. Bu ÅŸifrelemeyi yÃ¶netmek iÃ§in anahtarlar **KMS** kullanÄ±larak saÄŸlanabilir.\
VeritabanÄ±nÄ±z oluÅŸturulduktan sonra bu seviyede ÅŸifreleme eklemek mÃ¼mkÃ¼n deÄŸildir. **OluÅŸturma sÄ±rasÄ±nda yapÄ±lmasÄ± gerekir**.

Ancak, ÅŸifrelenmemiÅŸ bir veritabanÄ±nÄ± ÅŸifrelemenize olanak tanÄ±yan bir **geÃ§ici Ã§Ã¶zÃ¼m** vardÄ±r. ÅifrelenmemiÅŸ veritabanÄ±nÄ±zÄ±n bir anlÄ±k gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ oluÅŸturabilir, bu anlÄ±k gÃ¶rÃ¼ntÃ¼nÃ¼n ÅŸifrelenmiÅŸ bir kopyasÄ±nÄ± oluÅŸturabilir, bu ÅŸifrelenmiÅŸ anlÄ±k gÃ¶rÃ¼ntÃ¼yÃ¼ kullanarak yeni bir veritabanÄ± oluÅŸturabilir ve sonunda veritabanÄ±nÄ±z ÅŸifrelenmiÅŸ olur.

#### Åeffaf Veri Åifreleme (TDE)

RDS'nin uygulama dÃ¼zeyinde yerleÅŸik ÅŸifreleme yeteneklerinin yanÄ± sÄ±ra, RDS ayrÄ±ca dinlenme halindeki verileri korumak iÃ§in **ek platform dÃ¼zeyinde ÅŸifreleme mekanizmalarÄ±nÄ±** destekler. Bu, Oracle ve SQL Server iÃ§in **Åeffaf Veri Åifreleme (TDE)**'yi iÃ§erir. Ancak, TDE'nin dinlenme halindeki verileri ÅŸifreleyerek gÃ¼venliÄŸi artÄ±rÄ±rken, aynÄ± zamanda **veritabanÄ± performansÄ±nÄ± etkileyebileceÄŸini** unutmamak Ã¶nemlidir. Bu performans etkisi, Ã¶zellikle MySQL kriptografik iÅŸlevleri veya Microsoft Transact-SQL kriptografik iÅŸlevleri ile birlikte kullanÄ±ldÄ±ÄŸÄ±nda belirgindir.

TDE'yi kullanmak iÃ§in belirli Ã¶n adÄ±mlar gereklidir:

1. **SeÃ§enek Grubu Ä°liÅŸkilendirmesi**:
* VeritabanÄ± bir seÃ§enek grubuyla iliÅŸkilendirilmelidir. SeÃ§enek gruplarÄ±, veritabanÄ± yÃ¶netimini, gÃ¼venlik iyileÅŸtirmeleri de dahil olmak Ã¼zere kolaylaÅŸtÄ±ran ayar ve Ã¶zellikler iÃ§in konteynerler olarak hizmet eder.
* Ancak, seÃ§enek gruplarÄ±nÄ±n yalnÄ±zca belirli veritabanÄ± motorlarÄ± ve sÃ¼rÃ¼mleri iÃ§in mevcut olduÄŸunu unutmamak Ã¶nemlidir.
2. **TDE'nin SeÃ§enek Grubuna Dahil Edilmesi**:
* Bir seÃ§enek grubuyla iliÅŸkilendirildikten sonra, Oracle Åeffaf Veri Åifreleme seÃ§eneÄŸi o gruba dahil edilmelidir.
* TDE seÃ§eneÄŸi bir seÃ§enek grubuna eklendikten sonra, kalÄ±cÄ± bir Ã¶zellik haline gelir ve kaldÄ±rÄ±lamaz.
3. **TDE Åifreleme ModlarÄ±**:
* TDE iki farklÄ± ÅŸifreleme modu sunar:
* **TDE Tablespace Åifreleme**: Bu mod, daha geniÅŸ bir veri koruma kapsamÄ± saÄŸlayarak tÃ¼m tablolarÄ± ÅŸifreler.
* **TDE SÃ¼tun Åifreleme**: Bu mod, veritabanÄ±ndaki belirli, bireysel Ã¶ÄŸeleri ÅŸifrelemeye odaklanarak daha ayrÄ±ntÄ±lÄ± kontrol saÄŸlar.

TDE'nin bu Ã¶n koÅŸullarÄ±nÄ± ve operasyonel ayrÄ±ntÄ±larÄ±nÄ± anlamak, RDS iÃ§inde ÅŸifrelemeyi etkili bir ÅŸekilde uygulamak ve yÃ¶netmek iÃ§in kritik Ã¶neme sahiptir, hem veri gÃ¼venliÄŸini saÄŸlamak hem de gerekli standartlara uyumu saÄŸlamak iÃ§in.

### Enumeration

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Kimlik DoÄŸrulamasÄ± Olmayan EriÅŸim

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Yetki YÃ¼kseltme

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### SÃ¶mÃ¼rÃ¼ SonrasÄ±

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### KalÄ±cÄ±lÄ±k

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Enjeksiyonu

**SQL sÃ¶zdizimi** ile DynamoDB verilerine eriÅŸmenin yollarÄ± vardÄ±r, bu nedenle, tipik **SQL enjeksiyonlarÄ± da mÃ¼mkÃ¼ndÃ¼r**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Discord grubuna** ğŸ’¬ [**katÄ±lÄ±n**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live) **bizi takip edin.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na.

</details>
{% endhint %}
