# AWS - Relational Database (RDS) Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

AWSì—ì„œ ì œê³µí•˜ëŠ” **Relational Database Service (RDS)**ëŠ” **í´ë¼ìš°ë“œì—ì„œ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤**ì˜ ë°°í¬, ìš´ì˜ ë° í™•ì¥ì„ ê°„ì†Œí™”í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” í•˜ë“œì›¨ì–´ í”„ë¡œë¹„ì €ë‹, ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì„±, íŒ¨ì¹˜ ë° ë°±ì—…ê³¼ ê°™ì€ ë…¸ë™ ì§‘ì•½ì ì¸ ì‘ì—…ì„ ìë™í™”í•˜ë©´ì„œ ë¹„ìš© íš¨ìœ¨ì„±ê³¼ í™•ì¥ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.

AWS RDSëŠ” MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server ë° MySQLê³¼ PostgreSQLê³¼ í˜¸í™˜ë˜ëŠ” Amazon Auroraë¥¼ í¬í•¨í•œ ë‹¤ì–‘í•œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ì—”ì§„ì„ ì§€ì›í•©ë‹ˆë‹¤.

RDSì˜ ì£¼ìš” ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* **ë°ì´í„°ë² ì´ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬**ê°€ ê°„ì†Œí™”ë©ë‹ˆë‹¤.
* ì½ê¸° ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ **ì½ê¸° ë³µì œë³¸**ì„ ìƒì„±í•©ë‹ˆë‹¤.
* ê³ ê°€ìš©ì„±ê³¼ ì¥ì•  ì¡°ì¹˜ ë©”ì»¤ë‹ˆì¦˜ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ **ë‹¤ì¤‘ ê°€ìš© ì˜ì—­(AZ) ë°°í¬**ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
* ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ì™€ì˜ **í†µí•©**:
* ê°•ë ¥í•œ ì•¡ì„¸ìŠ¤ ì œì–´ë¥¼ ìœ„í•œ AWS Identity and Access Management (**IAM**).
* í¬ê´„ì ì¸ ëª¨ë‹ˆí„°ë§ ë° ë©”íŠ¸ë¦­ì„ ìœ„í•œ AWS **CloudWatch**.
* ì €ì¥ ì‹œ ì•”í˜¸í™”ë¥¼ ë³´ì¥í•˜ê¸° ìœ„í•œ AWS Key Management Service (**KMS**).

## Credentials

DB í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•  ë•Œ ê¸°ë³¸ **ì‚¬ìš©ì ì´ë¦„**ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ê¸°ë³¸ê°’ì€ **`admin`**). ì´ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìƒì„±í•˜ë ¤ë©´:

* **ì§ì ‘ ë¹„ë°€ë²ˆí˜¸**ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
* RDSì— **ìë™ ìƒì„±**ì„ ìš”ì²­í•©ë‹ˆë‹¤.
* KMS í‚¤ë¡œ ì•”í˜¸í™”ëœ **AWS Secret Manager**ì—ì„œ ê´€ë¦¬í•˜ë„ë¡ RDSì— ìš”ì²­í•©ë‹ˆë‹¤.

<figure><img src="../../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

### Authentication

3ê°€ì§€ ìœ í˜•ì˜ ì¸ì¦ ì˜µì…˜ì´ ìˆì§€ë§Œ **ë§ˆìŠ¤í„° ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš©ì€ í•­ìƒ í—ˆìš©**ë©ë‹ˆë‹¤:

<figure><img src="../../../.gitbook/assets/image (227).png" alt=""><figcaption></figcaption></figure>

### Public Access & VPC

ê¸°ë³¸ì ìœ¼ë¡œ **ê³µê°œ ì•¡ì„¸ìŠ¤ëŠ” í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**, ê·¸ëŸ¬ë‚˜ **í—ˆìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ë”°ë¼ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ë™ì¼í•œ VPCì˜ ë¨¸ì‹ ë§Œ ì„ íƒëœ **ë³´ì•ˆ ê·¸ë£¹**(EC2 SGì— ì €ì¥ë¨)ì´ í—ˆìš©í•˜ëŠ” ê²½ìš° ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

DB ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë…¸ì¶œí•˜ëŠ” ëŒ€ì‹ , **RDS Proxy**ë¥¼ ìƒì„±í•˜ì—¬ DB í´ëŸ¬ìŠ¤í„°ì˜ **í™•ì¥ì„±** ë° **ê°€ìš©ì„±**ì„ **í–¥ìƒ**ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ, **ë°ì´í„°ë² ì´ìŠ¤ í¬íŠ¸ë¥¼ ìˆ˜ì •**í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

### Encryption

**ì•”í˜¸í™”ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”**ë˜ì–´ ìˆìœ¼ë©° AWS ê´€ë¦¬ í‚¤(CMKë¥¼ ëŒ€ì‹  ì„ íƒí•  ìˆ˜ ìˆìŒ)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì•”í˜¸í™”ë¥¼ í™œì„±í™”í•˜ë©´ **ì €ì¥ì†Œ, ìŠ¤ëƒ…ìƒ·, ì½ê¸° ë³µì œë³¸ ë° ë°±ì—…ì— ëŒ€í•œ ì €ì¥ ì‹œ ì•”í˜¸í™”**ê°€ í™œì„±í™”ë©ë‹ˆë‹¤. ì´ ì•”í˜¸í™”ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ í‚¤ëŠ” **KMS**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°œê¸‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë°ì´í„°ë² ì´ìŠ¤ê°€ ìƒì„±ëœ í›„ì—ëŠ” ì´ ìˆ˜ì¤€ì˜ ì•”í˜¸í™”ë¥¼ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. **ìƒì„± ì‹œì—ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤**.

ê·¸ëŸ¬ë‚˜ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì•”í˜¸í™”í•  ìˆ˜ ìˆëŠ” **í•´ê²° ë°©ë²•**ì´ ìˆìŠµë‹ˆë‹¤. ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìŠ¤ëƒ…ìƒ·ì„ ìƒì„±í•˜ê³ , í•´ë‹¹ ìŠ¤ëƒ…ìƒ·ì˜ ì•”í˜¸í™”ëœ ë³µì‚¬ë³¸ì„ ìƒì„±í•œ ë‹¤ìŒ, ê·¸ ì•”í˜¸í™”ëœ ìŠ¤ëƒ…ìƒ·ì„ ì‚¬ìš©í•˜ì—¬ ìƒˆ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ë©´ ìµœì¢…ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ê°€ ì•”í˜¸í™”ë©ë‹ˆë‹¤.

#### Transparent Data Encryption (TDE)

RDSì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ ì•”í˜¸í™” ê¸°ëŠ¥ê³¼ í•¨ê»˜, RDSëŠ” ì €ì¥ëœ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ **ì¶”ê°€ì ì¸ í”Œë«í¼ ìˆ˜ì¤€ ì•”í˜¸í™” ë©”ì»¤ë‹ˆì¦˜**ë„ ì§€ì›í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” Oracle ë° SQL Serverìš© **Transparent Data Encryption (TDE)**ì´ í¬í•¨ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ TDEëŠ” ì €ì¥ëœ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•˜ì—¬ ë³´ì•ˆì„ ê°•í™”í•˜ì§€ë§Œ, MySQL ì•”í˜¸í™” í•¨ìˆ˜ë‚˜ Microsoft Transact-SQL ì•”í˜¸í™” í•¨ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ **ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

TDEë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ëª‡ ê°€ì§€ ì‚¬ì „ ë‹¨ê³„ê°€ í•„ìš”í•©ë‹ˆë‹¤:

1. **ì˜µì…˜ ê·¸ë£¹ ì—°ê²°**:
* ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì˜µì…˜ ê·¸ë£¹ê³¼ ì—°ê²°ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì˜µì…˜ ê·¸ë£¹ì€ ì„¤ì • ë° ê¸°ëŠ¥ì„ í¬í•¨í•˜ëŠ” ì»¨í…Œì´ë„ˆë¡œ, ë³´ì•ˆ í–¥ìƒì„ í¬í•¨í•œ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ë¥¼ ìš©ì´í•˜ê²Œ í•©ë‹ˆë‹¤.
* ê·¸ëŸ¬ë‚˜ ì˜µì…˜ ê·¸ë£¹ì€ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ ì—”ì§„ ë° ë²„ì „ì—ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2. **ì˜µì…˜ ê·¸ë£¹ì— TDE í¬í•¨**:
* ì˜µì…˜ ê·¸ë£¹ê³¼ ì—°ê²°ëœ í›„, Oracle Transparent Data Encryption ì˜µì…˜ì„ í•´ë‹¹ ê·¸ë£¹ì— í¬í•¨ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.
* TDE ì˜µì…˜ì´ ì˜µì…˜ ê·¸ë£¹ì— ì¶”ê°€ë˜ë©´ ì˜êµ¬ì ìœ¼ë¡œ ê³ ì •ë˜ë©° ì œê±°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
3. **TDE ì•”í˜¸í™” ëª¨ë“œ**:
* TDEëŠ” ë‘ ê°€ì§€ ë‹¤ë¥¸ ì•”í˜¸í™” ëª¨ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤:
* **TDE í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ì•”í˜¸í™”**: ì´ ëª¨ë“œëŠ” ì „ì²´ í…Œì´ë¸”ì„ ì•”í˜¸í™”í•˜ì—¬ ë” ë„“ì€ ë²”ìœ„ì˜ ë°ì´í„° ë³´í˜¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
* **TDE ì—´ ì•”í˜¸í™”**: ì´ ëª¨ë“œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì˜ íŠ¹ì • ê°œë³„ ìš”ì†Œë¥¼ ì•”í˜¸í™”í•˜ì—¬ ë” ì„¸ë°€í•œ ì œì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ì‚¬ì „ ìš”êµ¬ ì‚¬í•­ê³¼ TDEì˜ ìš´ì˜ì  ë³µì¡ì„±ì„ ì´í•´í•˜ëŠ” ê²ƒì€ RDS ë‚´ì—ì„œ ì•”í˜¸í™”ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ êµ¬í˜„í•˜ê³  ê´€ë¦¬í•˜ì—¬ ë°ì´í„° ë³´ì•ˆê³¼ í•„ìš”í•œ í‘œì¤€ ì¤€ìˆ˜ë¥¼ ë³´ì¥í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.

### Enumeration

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Unauthenticated Access

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Persistence

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injection

**SQL êµ¬ë¬¸**ì„ ì‚¬ìš©í•˜ì—¬ DynamoDB ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆìœ¼ë©°, ë”°ë¼ì„œ ì¼ë°˜ì ì¸ **SQL ì¸ì ì…˜ë„ ê°€ëŠ¥**í•©ë‹ˆë‹¤.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì—°ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì—°ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… í”Œëœ**](https://github.com/sponsors/carlospolop)ì„ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**telegram ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ì„ íŒ”ë¡œìš°í•˜ì„¸ìš”.
* **PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”:** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œ.

</details>
{% endhint %}
