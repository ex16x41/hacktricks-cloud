# AWS - Relational Database (RDS) Enum

{% hint style="success" %}
AWS ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks μ§€μ›ν•κΈ°</summary>

* [**κµ¬λ… κ³„ν**](https://github.com/sponsors/carlospolop) ν™•μΈν•κΈ°!
* **π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— μ°Έμ—¬ν•κ±°λ‚ **Twitter**μ—μ„ **ν”λ΅μ°**ν•μ„Έμ”** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) λ° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) κΉƒν—λΈ λ¦¬ν¬μ§€ν† λ¦¬μ— PRμ„ μ μ¶ν•μ—¬ ν•΄ν‚Ή νμ„ κ³µμ ν•μ„Έμ”.**

</details>
{% endhint %}

## κΈ°λ³Έ μ •λ³΄

AWSμ—μ„ μ κ³µν•λ” **κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ„λΉ„μ¤(RDS)**λ” **ν΄λΌμ°λ“μ—μ„ κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤μ λ°°ν¬, μ΄μ λ° ν™•μ¥μ„ κ°„μ†ν™”**ν•λ„λ΅ μ„¤κ³„λμ—μµλ‹λ‹¤. μ΄ μ„λΉ„μ¤λ” ν•λ“μ›¨μ–΄ ν”„λ΅λΉ„μ €λ‹, λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ„±, ν¨μΉ λ° λ°±μ—…κ³Ό κ°™μ€ λ…Έλ™ μ§‘μ•½μ μΈ μ‘μ—…μ„ μλ™ν™”ν•λ©΄μ„ λΉ„μ© ν¨μ¨μ„±κ³Ό ν™•μ¥μ„±μ μ΄μ μ„ μ κ³µν•©λ‹λ‹¤.

AWS RDSλ” MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server λ° Amazon Auroraλ¥Ό ν¬ν•¨ν• λ‹¤μ–‘ν• λ„λ¦¬ μ‚¬μ©λλ” κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„μ„ μ§€μ›ν•λ©°, MySQL λ° PostgreSQLκ³Όμ νΈν™μ„±μ„ μ κ³µν•©λ‹λ‹¤.

RDSμ μ£Όμ” κΈ°λ¥μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

* **λ°μ΄ν„°λ² μ΄μ¤ μΈμ¤ν„΄μ¤ κ΄€λ¦¬**κ°€ κ°„μ†ν™”λ©λ‹λ‹¤.
* μ½κΈ° μ„±λ¥μ„ ν–¥μƒμ‹ν‚¤κΈ° μ„ν• **μ½κΈ° λ³µμ λ³Έ** μƒμ„±.
* κ³ κ°€μ©μ„±κ³Ό μ¥μ•  μ΅°μΉ λ©”μ»¤λ‹μ¦μ„ λ³΄μ¥ν•κΈ° μ„ν• **λ‹¤μ¤‘ κ°€μ© μμ—­(AZ) λ°°ν¬** κµ¬μ„±.
* λ‹¤μκ³Ό κ°™μ€ λ‹¤λ¥Έ AWS μ„λΉ„μ¤μ™€μ **ν†µν•©**:
* κ°•λ ¥ν• μ•΅μ„Έμ¤ μ μ–΄λ¥Ό μ„ν• AWS Identity and Access Management (**IAM**).
* ν¬κ΄„μ μΈ λ¨λ‹ν„°λ§ λ° λ©”νΈλ¦­μ„ μ„ν• AWS **CloudWatch**.
* KMS ν‚¤λ΅ μ•”νΈν™”λ AWS Key Management Service (**KMS**)λ¥Ό ν†µν• μ•”νΈν™” λ³΄μ¥.

## μκ²© μ¦λ…

DB ν΄λ¬μ¤ν„°λ¥Ό μƒμ„±ν•  λ• λ§μ¤ν„° **μ‚¬μ©μ μ΄λ¦„**μ„ κµ¬μ„±ν•  μ μμµλ‹λ‹¤ (**κΈ°λ³Έκ°’μ€ `admin`**). μ΄ μ‚¬μ©μμ λΉ„λ°€λ²νΈλ¥Ό μƒμ„±ν•λ ¤λ©΄ λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤:

* **λΉ„λ°€λ²νΈ**λ¥Ό μ§μ ‘ μ§€μ •
* RDSμ— **μλ™ μƒμ„±**ν•λ„λ΅ μ§€μ‹
* RDSμ— **AWS Secret Manager**μ—μ„ KMS ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ κ΄€λ¦¬ν•λ„λ΅ μ§€μ‹

<figure><img src="../../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

### μΈμ¦

3κ°€μ§€ μ ν•μ μΈμ¦ μµμ…μ΄ μμ§€λ§ **λ§μ¤ν„° λΉ„λ°€λ²νΈ μ‚¬μ©μ€ ν•­μƒ ν—μ©λ©λ‹λ‹¤**:

<figure><img src="../../../.gitbook/assets/image (227).png" alt=""><figcaption></figcaption></figure>

### κ³µμ© μ•΅μ„Έμ¤ λ° VPC

κΈ°λ³Έμ μΌλ΅ λ°μ΄ν„°λ² μ΄μ¤μ— **κ³µμ© μ•΅μ„Έμ¤κ°€ λ¶€μ—¬λμ§€ μ•μµλ‹λ‹¤**, κ·Έλ¬λ‚ **λ¶€μ—¬λ  μ μμµλ‹λ‹¤**. λ”°λΌμ„ κΈ°λ³Έμ μΌλ΅ μ„ νƒλ **λ³΄μ• κ·Έλ£Ή**(EC2 SGμ— μ €μ¥λ¨)μ΄ ν—μ©ν•λ” κ²½μ°μ—λ§ λ™μΌν• VPCμ λ¨Έμ‹ λ§ μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤.

DB μΈμ¤ν„΄μ¤λ¥Ό λ…Έμ¶ν•λ” λ€μ‹  **RDS Proxy**λ¥Ό μƒμ„±ν•μ—¬ DB ν΄λ¬μ¤ν„°μ **ν™•μ¥μ„±** λ° **κ°€μ©μ„±**μ„ **ν–¥μƒ**μ‹ν‚¬ μ μμµλ‹λ‹¤.

λν• **λ°μ΄ν„°λ² μ΄μ¤ ν¬νΈλ„ μμ •ν•  μ μμµλ‹λ‹¤**.

### μ•”νΈν™”

**μ•”νΈν™”λ” κΈ°λ³Έμ μΌλ΅ ν™μ„±ν™”λμ–΄ μμµλ‹λ‹¤** AWS κ΄€λ¦¬ ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ (λ€μ‹  CMKλ¥Ό μ„ νƒν•  μ μμµλ‹λ‹¤).

μ•”νΈν™”λ¥Ό ν™μ„±ν™”ν•λ©΄ **μ €μ¥μ†, μ¤λƒ…μƒ·, μ½κΈ° λ³µμ λ³Έ λ° λ°±μ—…μ— λ€ν• μ•”νΈν™”κ°€ ν™μ„±ν™”λ©λ‹λ‹¤**. μ΄ μ•”νΈν™”λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν• ν‚¤λ” **KMS**λ¥Ό μ‚¬μ©ν•μ—¬ λ°κΈ‰ν•  μ μμµλ‹λ‹¤.\
λ°μ΄ν„°λ² μ΄μ¤κ°€ μƒμ„±λ ν›„μ—λ” μ΄ μμ¤€μ μ•”νΈν™”λ¥Ό μ¶”κ°€ν•  μ μ—†μµλ‹λ‹¤. **μƒμ„± μ¤‘μ— μν–‰ν•΄μ•Ό ν•©λ‹λ‹¤**.

κ·Έλ¬λ‚ **μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ•”νΈν™”ν•  μ μλ” μ°ν λ°©λ²•μ΄ μμµλ‹λ‹¤**. μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤μ μ¤λƒ…μƒ·μ„ μƒμ„±ν•κ³ , ν•΄λ‹Ή μ¤λƒ…μƒ·μ μ•”νΈν™”λ λ³µμ‚¬λ³Έμ„ μƒμ„±ν•κ³ , κ·Έ μ•”νΈν™”λ μ¤λƒ…μƒ·μ„ μ‚¬μ©ν•μ—¬ μƒ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μƒμ„±ν• λ‹¤μ, λ§μ§€λ§‰μΌλ΅ λ°μ΄ν„°λ² μ΄μ¤κ°€ μ•”νΈν™”λ©λ‹λ‹¤.

#### ν¬λ… λ°μ΄ν„° μ•”νΈν™”(TDE)

RDSμ μ• ν”λ¦¬μΌ€μ΄μ… μμ¤€μ μ•”νΈν™” κΈ°λ¥κ³Ό ν•¨κ», RDSλ” **λ°μ΄ν„°λ¥Ό μ•μ „ν•κ² λ³΄νΈν•κΈ° μ„ν• μ¶”κ°€ ν”λ«νΌ μμ¤€μ μ•”νΈν™” λ©”μ»¤λ‹μ¦**λ„ μ§€μ›ν•©λ‹λ‹¤. μ—¬κΈ°μ—λ” Oracle λ° SQL Serverμ— λ€ν• **ν¬λ… λ°μ΄ν„° μ•”νΈν™”(TDE)**κ°€ ν¬ν•¨λ©λ‹λ‹¤. κ·Έλ¬λ‚ TDEκ°€ λ°μ΄ν„°λ¥Ό μ•μ „ν•κ² λ³΄νΈν•λ” λ° λ„μ›€μ΄ λμ§€λ§, **λ°μ΄ν„°λ² μ΄μ¤ μ„±λ¥μ— μν–¥μ„ λ―ΈμΉ  μ μμµλ‹λ‹¤**. μ΄ μ„±λ¥ μν–¥μ€ MySQL μ•”νΈν™” κΈ°λ¥μ΄λ‚ Microsoft Transact-SQL μ•”νΈν™” κΈ°λ¥κ³Ό ν•¨κ» μ‚¬μ©ν•  λ• νΉν λ‘λ“λ¬μ§‘λ‹λ‹¤.

TDEλ¥Ό μ‚¬μ©ν•λ ¤λ©΄ λ‡ κ°€μ§€ μ‚¬μ „ λ‹¨κ³„κ°€ ν•„μ”ν•©λ‹λ‹¤:

1. **μµμ… κ·Έλ£Ή μ—°κ΄€**:
* λ°μ΄ν„°λ² μ΄μ¤λ” μµμ… κ·Έλ£Ήκ³Ό μ—°κ΄€λμ–΄μ•Ό ν•©λ‹λ‹¤. μµμ… κ·Έλ£Ήμ€ μ„¤μ • λ° κΈ°λ¥μ„ μ„ν• μ»¨ν…μ΄λ„ μ—­ν• μ„ ν•μ—¬ λ³΄μ• ν–¥μƒμ„ ν¬ν•¨ν• λ°μ΄ν„°λ² μ΄μ¤ κ΄€λ¦¬λ¥Ό μ©μ΄ν•κ² ν•©λ‹λ‹¤.
* κ·Έλ¬λ‚ μµμ… κ·Έλ£Ήμ€ νΉμ • λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„ λ° λ²„μ „μ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤λ” μ μ— μ μν•΄μ•Ό ν•©λ‹λ‹¤.
2. **μµμ… κ·Έλ£Ήμ— TDE ν¬ν•¨**:
* μµμ… κ·Έλ£Ήκ³Ό μ—°κ΄€λ ν›„, Oracle ν¬λ… λ°μ΄ν„° μ•”νΈν™” μµμ…μ„ ν•΄λ‹Ή κ·Έλ£Ήμ— ν¬ν•¨ν•΄μ•Ό ν•©λ‹λ‹¤.
* TDE μµμ…μ΄ μµμ… κ·Έλ£Ήμ— μ¶”κ°€λλ©΄ μκµ¬μ μΈ μ”μ†κ°€ λλ©° μ κ±°ν•  μ μ—†λ‹¤λ” μ μ„ μΈμ‹ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.
3. **TDE μ•”νΈν™” λ¨λ“**:
* TDEλ” λ‘ κ°€μ§€ κ³ μ ν• μ•”νΈν™” λ¨λ“λ¥Ό μ κ³µν•©λ‹λ‹¤:
* **TDE ν…μ΄λΈ”μ¤νμ΄μ¤ μ•”νΈν™”**: μ΄ λ¨λ“λ” μ „μ²΄ ν…μ΄λΈ”μ„ μ•”νΈν™”ν•μ—¬ λ” λ„“μ€ λ²”μ„μ λ°μ΄ν„° λ³΄νΈλ¥Ό μ κ³µν•©λ‹λ‹¤.
* **TDE μ—΄ μ•”νΈν™”**: μ΄ λ¨λ“λ” λ°μ΄ν„°λ² μ΄μ¤ λ‚΄μ νΉμ • κ°λ³„ μ”μ†λ¥Ό μ•”νΈν™”ν•λ” λ° μ¤‘μ μ„ λ‘μ–΄ μ•”νΈν™”ν•  λ°μ΄ν„°μ— λ€ν• λ³΄λ‹¤ μ„Έλ°€ν• μ μ–΄λ¥Ό ν—μ©ν•©λ‹λ‹¤.

μ΄λ¬ν• μ „μ  μ΅°κ±΄κ³Ό TDEμ μ΄μ λ³µμ΅μ„±μ„ μ΄ν•΄ν•λ” κ²ƒμ€ RDS λ‚΄μ—μ„ μ•”νΈν™”λ¥Ό ν¨κ³Όμ μΌλ΅ κµ¬ν„ν•κ³  κ΄€λ¦¬ν•μ—¬ λ°μ΄ν„° λ³΄μ•κ³Ό ν•„μ”ν• ν‘μ¤€ μ¤€μλ¥Ό λ³΄μ¥ν•λ” λ° μ¤‘μ”ν•©λ‹λ‹¤.

### μ—΄κ±°

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### μΈμ¦λμ§€ μ•μ€ μ ‘κ·Ό

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### κ¶ν• μƒμΉ

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### ν¬μ¤νΈ μµμ¤ν”λ΅μ‡

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### μ§€μ†μ„±

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL μΈμ μ…

DynamoDB λ°μ΄ν„°μ— **SQL κµ¬λ¬Έ**μΌλ΅ μ ‘κ·Όν•  μ μλ” λ°©λ²•μ΄ μμΌλ©°, λ”°λΌμ„ μΌλ°μ μΈ **SQL μΈμ μ…λ„ κ°€λ¥ν•©λ‹λ‹¤**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
AWS ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks μ§€μ›ν•κΈ°</summary>

* [**κµ¬λ… κ³„ν**](https://github.com/sponsors/carlospolop) ν™•μΈν•κΈ°!
* **π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— μ°Έμ—¬ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**λ¥Ό ν”λ΅μ°ν•μ„Έμ”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) λ° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) κΉƒν—λΈ λ¦¬ν¬μ§€ν† λ¦¬μ— PRμ„ μ μ¶ν•μ—¬ ν•΄ν‚Ή νμ„ κ³µμ ν•μ„Έμ”.**

</details>
{% endhint %}
