# AWS - Relational Database (RDS) Enum

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**intekenplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basiese Inligting

Die **Relational Database Service (RDS)** wat deur AWS aangebied word, is ontwerp om die ontplooiing, werking en skaal van 'n **relasionele databasis in die wolk** te vereenvoudig. Hierdie diens bied die voordele van koste-effektiwiteit en skaalbaarheid terwyl dit arbeidsintensiewe take soos hardewarevoorsiening, databasisopstelling, pleisterwerk en rugsteun outomatiseer.

AWS RDS ondersteun verskeie wydgebruikte relasionele databasis-enjins insluitend MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server, en Amazon Aurora, met verenigbaarheid vir beide MySQL en PostgreSQL.

Sleutelfunksies van RDS sluit in:

* **Bestuur van databasis-instansies** word vereenvoudig.
* Skep van **lees-replikas** om leesprestasie te verbeter.
* Konfigurasie van **multi-Availability Zone (AZ) ontplooiings** om ho√´ beskikbaarheid en oorskakeling meganismes te verseker.
* **Integrasie** met ander AWS-dienste, soos:
* AWS Identity and Access Management (**IAM**) vir robuuste toegangsbeheer.
* AWS **CloudWatch** vir omvattende monitering en metrieke.
* AWS Key Management Service (**KMS**) vir die verseker van enkripsie in rus.

## Geloofsbriewe

Wanneer die DB-kluster geskep word, kan die meester **gebruikersnaam** gekonfigureer word (**`admin`** by verstek). Om die wagwoord van hierdie gebruiker te genereer kan jy:

* **Dui** 'n **wagwoord** self aan
* S√™ vir RDS om dit **outomaties te genereer**
* S√™ vir RDS om dit te bestuur in **AWS Secret Manager** ge√´nkripteer met 'n KMS-sleutel

<figure><img src="../../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

### Verifikasie

Daar is 3 tipes verifikasie-opsies, maar die gebruik van die **meester-wagwoord is altyd toegelaat**:

<figure><img src="../../../.gitbook/assets/image (227).png" alt=""><figcaption></figcaption></figure>

### Publieke Toegang & VPC

By verstek word **geen publieke toegang verleen** aan die databasisse nie, maar dit **kan verleen word**. Daarom, by verstek sal slegs masjiene van dieselfde VPC toegang daartoe h√™ as die geselekteerde **sekuriteitsgroep** (word gestoor in EC2 SG) dit toelaat.

In plaas daarvan om 'n DB-instansie bloot te stel, is dit moontlik om 'n **RDS Proxy** te skep wat die **skaalbaarheid** & **beskikbaarheid** van die DB-kluster **verbeter**.

Boonop kan die **databasispoort ook verander word**.

### Enkripsie

**Enkripsie is by verstek geaktiveer** met 'n AWS-bestuurde sleutel (‚Äôn CMK kan in plaas daarvan gekies word).

Deur jou enkripsie te aktiveer, aktiveer jy **enkripsie in rus vir jou stoorplek, momentopnames, lees-replikas en jou rugsteun**. Sleutels om hierdie enkripsie te bestuur kan uitgereik word deur **KMS** te gebruik.\
Dit is nie moontlik om hierdie vlak van enkripsie by te voeg nadat jou databasis geskep is nie. **Dit moet tydens die skepping gedoen word**.

Daar is egter 'n **omweg wat jou toelaat om 'n onge√´nkripteerde databasis soos volg te enkripteer**. Jy kan 'n momentopname van jou onge√´nkripteerde databasis skep, 'n ge√´nkripteerde kopie van daardie momentopname skep, daardie ge√´nkripteerde momentopname gebruik om 'n nuwe databasis te skep, en dan, uiteindelik, sal jou databasis dan ge√´nkripteer wees.

#### Deursigtige Data Enkripsie (TDE)

Saam met die enkripsievermo√´ns inherent aan RDS op die toepassingsvlak, ondersteun RDS ook **bykomende platformvlak enkripsie-meganismes** om data in rus te beskerm. Dit sluit in **Deursigtige Data Enkripsie (TDE)** vir Oracle en SQL Server. Dit is egter belangrik om daarop te let dat hoewel TDE sekuriteit verbeter deur data in rus te enkripteer, dit ook die **databasisprestasie kan be√Ønvloed**. Hierdie prestasie-impak is veral merkbaar wanneer dit saam met MySQL-kriptografiese funksies of Microsoft Transact-SQL-kriptografiese funksies gebruik word.

Om TDE te gebruik, is sekere voorlopige stappe nodig:

1. **Opsiegroepassosiasie**:
* Die databasis moet geassosieer word met 'n opsiegroep. Opsiegroepe dien as houers vir instellings en kenmerke, wat databasisbestuur, insluitend sekuriteitsverbeterings, vergemaklik.
* Dit is egter belangrik om daarop te let dat opsiegroepe slegs beskikbaar is vir spesifieke databasis-enjins en weergawes.
2. **Insluiting van TDE in Opsiegroep**:
* Sodra dit geassosieer is met 'n opsiegroep, moet die Oracle Deursigtige Data Enkripsie-opsie in daardie groep ingesluit word.
* Dit is noodsaaklik om te erken dat sodra die TDE-opsie by 'n opsiegroep gevoeg is, dit 'n permanente kenmerk word en nie verwyder kan word nie.
3. **TDE Enkripsiemodusse**:
* TDE bied twee verskillende enkripsiemodusse:
* **TDE Tabelruimte Enkripsie**: Hierdie modus enkripteer hele tabelle, wat 'n bre√´r omvang van databeskerming bied.
* **TDE Kolom Enkripsie**: Hierdie modus fokus op die enkripsie van spesifieke, individuele elemente binne die databasis, wat meer fynbeheer oor wat ge√´nkripteer word, toelaat.

Om hierdie vereistes en die operasionele ingewikkeldhede van TDE te verstaan, is noodsaaklik vir die effektiewe implementering en bestuur van enkripsie binne RDS, wat beide databeskerming en nakoming van nodige standaarde verseker.

### Enumerasie

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Onauthentiseerde Toegang

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Post Eksploitasie

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Volharding

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injeksie

Daar is maniere om toegang tot DynamoDB-data te kry met **SQL-sintaksis**, daarom is tipiese **SQL-injeksies ook moontlik**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**intekenplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repo's.

</details>
{% endhint %}
