# AWS - Ä°liÅŸkisel VeritabanÄ± (RDS) Enum

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi takip edin** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Temel Bilgiler

AWS tarafÄ±ndan sunulan **Ä°liÅŸkisel VeritabanÄ± Servisi (RDS)**, **bulutta bir iliÅŸkisel veritabanÄ±nÄ±n** daÄŸÄ±tÄ±mÄ±nÄ±, iÅŸletimini ve Ã¶lÃ§eklenmesini kolaylaÅŸtÄ±rmak iÃ§in tasarlanmÄ±ÅŸtÄ±r. Bu hizmet, donanÄ±m saÄŸlama, veritabanÄ± yapÄ±landÄ±rmasÄ±, yamanma ve yedekleme gibi iÅŸ gÃ¼cÃ¼ yoÄŸun gÃ¶revleri otomatikleÅŸtirirken maliyet verimliliÄŸi ve Ã¶lÃ§eklenebilirlik avantajlarÄ± sunar.

AWS RDS, MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server ve Amazon Aurora dahil olmak Ã¼zere yaygÄ±n olarak kullanÄ±lan Ã§eÅŸitli iliÅŸkisel veritabanÄ± motorlarÄ±nÄ± destekler ve hem MySQL hem de PostgreSQL ile uyumludur.

RDS'nin ana Ã¶zellikleri ÅŸunlardÄ±r:

* **VeritabanÄ± Ã¶rneklerinin yÃ¶netimi** basitleÅŸtirilmiÅŸtir.
* Okuma performansÄ±nÄ± artÄ±rmak iÃ§in **okuma kopyalarÄ±** oluÅŸturma.
* YÃ¼ksek kullanÄ±labilirlik ve failover mekanizmalarÄ±nÄ± saÄŸlamak iÃ§in **Ã§oklu EriÅŸim AlanÄ± (AZ) daÄŸÄ±tÄ±mlarÄ±** yapÄ±landÄ±rma.
* DiÄŸer AWS hizmetleri ile **entegrasyon**, Ã¶rneÄŸin:
* GÃ¼Ã§lÃ¼ eriÅŸim kontrolÃ¼ iÃ§in AWS Kimlik ve EriÅŸim YÃ¶netimi (**IAM**).
* KapsamlÄ± izleme ve metrikler iÃ§in AWS **CloudWatch**.
* Dinlenme sÄ±rasÄ±nda ÅŸifrelemeyi saÄŸlamak iÃ§in AWS Anahtar YÃ¶netim Servisi (**KMS**).

## Kimlik Bilgileri

DB kÃ¼mesi oluÅŸturulurken ana **kullanÄ±cÄ± adÄ±** yapÄ±landÄ±rÄ±labilir (**varsayÄ±lan olarak `admin`**). Bu kullanÄ±cÄ±nÄ±n ÅŸifresini oluÅŸturmak iÃ§in:

* **Kendiniz bir ÅŸifre belirtin**
* RDS'ye **otomatik olarak oluÅŸturmasÄ±nÄ±** sÃ¶yleyin
* RDS'ye **AWS Secret Manager**'da KMS anahtarÄ± ile ÅŸifreli olarak yÃ¶netmesini sÃ¶yleyin

<figure><img src="../../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

### Kimlik DoÄŸrulama

3 tÃ¼r kimlik doÄŸrulama seÃ§eneÄŸi vardÄ±r, ancak **ana ÅŸifre her zaman kullanÄ±labilir**:

<figure><img src="../../../.gitbook/assets/image (227).png" alt=""><figcaption></figcaption></figure>

### Genel EriÅŸim & VPC

VarsayÄ±lan olarak veritabanlarÄ±na **herhangi bir genel eriÅŸim verilmez**, ancak **verilebilir**. Bu nedenle, varsayÄ±lan olarak yalnÄ±zca aynÄ± VPC'den makineler, seÃ§ilen **gÃ¼venlik grubu** (EC2 SG'de saklanÄ±r) izin veriyorsa buna eriÅŸebilecektir.

Bir DB Ã¶rneÄŸini aÃ§Ä±ÄŸa Ã§Ä±karmak yerine, DB kÃ¼mesinin **Ã¶lÃ§eklenebilirliÄŸini** ve **kullanÄ±labilirliÄŸini** artÄ±ran bir **RDS Proxy** oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r.

AyrÄ±ca, **veritabanÄ± portu da deÄŸiÅŸtirilebilir**.

### Åifreleme

**Åifreleme varsayÄ±lan olarak etkindir** ve AWS yÃ¶netilen bir anahtar kullanÄ±r (bir CMK yerine seÃ§ilebilir).

Åifrelemenizi etkinleÅŸtirerek, **depolamanÄ±z, anlÄ±k gÃ¶rÃ¼ntÃ¼leriniz, okuma kopyalarÄ±nÄ±z ve yedekleriniz iÃ§in dinlenme sÄ±rasÄ±nda ÅŸifrelemeyi** etkinleÅŸtiriyorsunuz. Bu ÅŸifrelemeyi yÃ¶netmek iÃ§in anahtarlar **KMS** kullanÄ±larak verilebilir.\
VeritabanÄ±nÄ±z oluÅŸturulduktan sonra bu dÃ¼zeyde ÅŸifreleme eklemek mÃ¼mkÃ¼n deÄŸildir. **Bu, oluÅŸturulmasÄ± sÄ±rasÄ±nda yapÄ±lmalÄ±dÄ±r**.

Ancak, **ÅŸifresiz bir veritabanÄ±nÄ± ÅŸifrelemenizi saÄŸlayan bir Ã§Ã¶zÃ¼m yolu vardÄ±r**. Åifresiz veritabanÄ±nÄ±zÄ±n bir anlÄ±k gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ oluÅŸturabilir, o anlÄ±k gÃ¶rÃ¼ntÃ¼nÃ¼n ÅŸifreli bir kopyasÄ±nÄ± oluÅŸturabilir, o ÅŸifreli anlÄ±k gÃ¶rÃ¼ntÃ¼yÃ¼ kullanarak yeni bir veritabanÄ± oluÅŸturabilir ve sonunda veritabanÄ±nÄ±z ÅŸifrelenmiÅŸ olur.

#### Åeffaf Veri Åifrelemesi (TDE)

RDS'nin uygulama dÃ¼zeyindeki yerleÅŸik ÅŸifreleme yeteneklerine ek olarak, RDS ayrÄ±ca dinlenme halindeki verileri korumak iÃ§in **ek platform dÃ¼zeyi ÅŸifreleme mekanizmalarÄ±nÄ±** destekler. Bu, Oracle ve SQL Server iÃ§in **Åeffaf Veri Åifrelemesi (TDE)**'yi iÃ§erir. Ancak, TDE'nin dinlenme halindeki verileri ÅŸifreleyerek gÃ¼venliÄŸi artÄ±rdÄ±ÄŸÄ±na dikkat etmek Ã¶nemlidir, bu aynÄ± zamanda **veritabanÄ± performansÄ±nÄ± etkileyebilir**. Bu performans etkisi, MySQL kriptografik iÅŸlevleri veya Microsoft Transact-SQL kriptografik iÅŸlevleri ile birlikte kullanÄ±ldÄ±ÄŸÄ±nda Ã¶zellikle belirgindir.

TDE'yi kullanmak iÃ§in belirli Ã¶n adÄ±mlar gereklidir:

1. **SeÃ§enek Grubu Ä°liÅŸkilendirmesi**:
* VeritabanÄ± bir seÃ§enek grubuna iliÅŸkilendirilmelidir. SeÃ§enek gruplarÄ±, ayarlarÄ± ve Ã¶zellikleri iÃ§eren konteynerler olarak hizmet eder ve gÃ¼venlik iyileÅŸtirmeleri de dahil olmak Ã¼zere veritabanÄ± yÃ¶netimini kolaylaÅŸtÄ±rÄ±r.
* Ancak, seÃ§enek gruplÄ±nÄ±n yalnÄ±zca belirli veritabanÄ± motorlarÄ± ve sÃ¼rÃ¼mleri iÃ§in mevcut olduÄŸunu belirtmek Ã¶nemlidir.
2. **SeÃ§enek Grubunda TDE'nin Dahil Edilmesi**:
* Bir seÃ§enek grubuna iliÅŸkilendirildikten sonra, Oracle Åeffaf Veri Åifreleme seÃ§eneÄŸi o gruba dahil edilmelidir.
* TDE seÃ§eneÄŸi bir seÃ§enek grubuna eklendikten sonra, kalÄ±cÄ± bir parÃ§a haline gelir ve kaldÄ±rÄ±lmasÄ± mÃ¼mkÃ¼n deÄŸildir.
3. **TDE Åifreleme ModlarÄ±**:
* TDE, iki farklÄ± ÅŸifreleme modu sunar:
* **TDE Tablosu AlanÄ± Åifrelemesi**: Bu mod, tÃ¼m tablolarÄ± ÅŸifreler ve daha geniÅŸ bir veri koruma kapsamÄ± saÄŸlar.
* **TDE SÃ¼tun Åifrelemesi**: Bu mod, veritabanÄ±ndaki belirli, bireysel Ã¶ÄŸeleri ÅŸifrelemeye odaklanÄ±r ve hangi verilerin ÅŸifreleneceÄŸi Ã¼zerinde daha ayrÄ±ntÄ±lÄ± kontrol saÄŸlar.

Bu Ã¶n koÅŸullarÄ± ve TDE'nin operasyonel karmaÅŸÄ±klÄ±klarÄ±nÄ± anlamak, RDS iÃ§inde ÅŸifrelemeyi etkili bir ÅŸekilde uygulamak ve yÃ¶netmek iÃ§in kritik Ã¶neme sahiptir ve hem veri gÃ¼venliÄŸini hem de gerekli standartlara uyumu saÄŸlar.

### SayÄ±m

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Kimlik DoÄŸrulamasÄ±z EriÅŸim

{% content-ref url="../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Yetki YÃ¼kseltme

{% content-ref url="../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Ä°stismar SonrasÄ±

{% content-ref url="../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### SÃ¼reklilik

{% content-ref url="../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Enjeksiyonu

DynamoDB verilerine **SQL sÃ¶zdizimi** ile eriÅŸim yollarÄ± vardÄ±r, bu nedenle tipik **SQL enjeksiyonlarÄ± da mÃ¼mkÃ¼ndÃ¼r**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
