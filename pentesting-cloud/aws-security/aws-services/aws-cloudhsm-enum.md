# AWS - CloudHSM Enum

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## HSM - DonanÄ±m GÃ¼venlik ModÃ¼lÃ¼

Cloud HSM, gÃ¼venli kriptografik anahtar depolama iÃ§in FIPS 140 seviye iki onaylÄ± **donanÄ±m cihazÄ±dÄ±r** (CloudHSM'nin bir donanÄ±m cihazÄ± olduÄŸunu unutmayÄ±n, sanallaÅŸtÄ±rÄ±lmÄ±ÅŸ bir hizmet deÄŸildir). 5.3.13 Ã¶nceden yÃ¼klenmiÅŸ SafeNetLuna 7000 cihazÄ±dÄ±r. Ä°ki yazÄ±lÄ±m sÃ¼rÃ¼mÃ¼ vardÄ±r ve hangisini seÃ§eceÄŸiniz tam ihtiyaÃ§larÄ±nÄ±za baÄŸlÄ±dÄ±r. Biri FIPS 140-2 uyumluluÄŸu iÃ§indir ve kullanÄ±labilecek daha yeni bir sÃ¼rÃ¼m vardÄ±r.

CloudHSM'nin alÄ±ÅŸÄ±lmadÄ±k Ã¶zelliÄŸi, fiziksel bir cihaz olmasÄ±dÄ±r ve bu nedenle **diÄŸer mÃ¼ÅŸterilerle paylaÅŸÄ±lmaz**, ya da yaygÄ±n olarak ifade edildiÄŸi gibi, Ã§ok kiracÄ±lÄ± deÄŸildir. Sadece sizin iÅŸ yÃ¼klerinize Ã¶zel olarak sunulan tek kiracÄ±lÄ± bir cihazdÄ±r.

Genellikle, bir cihazÄ±n kapasite varsa 15 dakika iÃ§inde mevcut olmasÄ± beklenir, ancak bazÄ± bÃ¶lgelerde bu mÃ¼mkÃ¼n olmayabilir.

Bu, size Ã¶zel bir fiziksel cihaz olduÄŸundan, **anahtarlar cihazda depolanÄ±r**. Anahtarlar ya **baÅŸka bir cihaza kopyalanmalÄ±**, Ã§evrimdÄ±ÅŸÄ± depolama alanÄ±na yedeklenmeli veya bir yedek cihazÄ±na aktarÄ±lmalÄ±dÄ±r. **Bu cihaz, S3 veya AWS'deki KMS gibi baÅŸka bir hizmetle desteklenmez.**

**CloudHSM'de**, hizmeti **kendiniz Ã¶lÃ§eklendirmeniz gerekir**. Ã‡Ã¶zÃ¼mÃ¼nÃ¼z iÃ§in uygulamak istediÄŸiniz ÅŸifreleme algoritmalarÄ±na dayalÄ± olarak, ÅŸifreleme ihtiyaÃ§larÄ±nÄ±zÄ± karÅŸÄ±lamak iÃ§in yeterli CloudHSM cihazÄ± saÄŸlamanÄ±z gerekir.\
Anahtar YÃ¶netim Hizmeti Ã¶lÃ§eklendirmesi AWS tarafÄ±ndan gerÃ§ekleÅŸtirilir ve talep Ã¼zerine otomatik olarak Ã¶lÃ§eklenir, bu nedenle kullanÄ±mÄ±nÄ±z arttÄ±kÃ§a, gereken CloudHSM cihazlarÄ±nÄ±n sayÄ±sÄ± da artabilir. Ã‡Ã¶zÃ¼mÃ¼nÃ¼zÃ¼ Ã¶lÃ§eklendirirken bunu aklÄ±nÄ±zda bulundurun ve Ã§Ã¶zÃ¼mÃ¼nÃ¼z otomatik Ã¶lÃ§eklendirme iÃ§eriyorsa, maksimum Ã¶lÃ§eÄŸinizin yeterli CloudHSM cihazlarÄ± ile karÅŸÄ±landÄ±ÄŸÄ±ndan emin olun.

Ã–lÃ§eklendirme gibi, **performans CloudHSM ile size baÄŸlÄ±dÄ±r**. Performans, hangi ÅŸifreleme algoritmasÄ±nÄ±n kullanÄ±ldÄ±ÄŸÄ±na ve anahtarlarÄ± ÅŸifrelemek iÃ§in ne sÄ±klÄ±kla eriÅŸmeniz gerektiÄŸine baÄŸlÄ± olarak deÄŸiÅŸir. Anahtar yÃ¶netim hizmetinin performansÄ± Amazon tarafÄ±ndan yÃ¶netilir ve talep gerektikÃ§e otomatik olarak Ã¶lÃ§eklenir. CloudHSM'nin performansÄ± daha fazla cihaz ekleyerek saÄŸlanÄ±r ve daha fazla performansa ihtiyacÄ±nÄ±z varsa ya cihaz eklemelisiniz ya da daha hÄ±zlÄ± bir algoritmaya ÅŸifreleme yÃ¶ntemini deÄŸiÅŸtirmelisiniz.

Ã‡Ã¶zÃ¼mÃ¼nÃ¼z **Ã§ok bÃ¶lgeli** ise, ikinci bÃ¶lgede birkaÃ§ **CloudHSM cihazÄ± eklemeli ve baÄŸlantÄ±nÄ±n her katmanÄ±nda trafiÄŸin her zaman korunduÄŸundan emin olmak iÃ§in Ã¶zel bir VPN baÄŸlantÄ±sÄ±** veya baÅŸka bir yÃ¶ntemle bÃ¶lge arasÄ± baÄŸlantÄ±yÄ± saÄŸlamalÄ±sÄ±nÄ±z. Ã‡ok bÃ¶lgeli bir Ã§Ã¶zÃ¼mÃ¼nÃ¼z varsa, **anahtarlarÄ± nasÄ±l Ã§oÄŸaltacaÄŸÄ±nÄ±zÄ± ve faaliyet gÃ¶sterdiÄŸiniz bÃ¶lgelerde ek CloudHSM cihazlarÄ± kurmayÄ± dÃ¼ÅŸÃ¼nmelisiniz**. Ã‡ok hÄ±zlÄ± bir ÅŸekilde, ÅŸifreleme anahtarlarÄ±nÄ±zÄ±n tam yedekliliÄŸini saÄŸlamak iÃ§in birden fazla bÃ¶lgede altÄ± veya sekiz cihazÄ±nÄ±zÄ±n olduÄŸu bir senaryoya girebilirsiniz.

**CloudHSM**, gÃ¼venli anahtar depolama iÃ§in kurumsal sÄ±nÄ±f bir hizmettir ve **bir iÅŸletme iÃ§in gÃ¼venilirlik kÃ¶kÃ¼** olarak kullanÄ±labilir. PKI'de Ã¶zel anahtarlarÄ± ve X509 uygulamalarÄ±nda sertifika otoritesi anahtarlarÄ±nÄ± depolayabilir. AES gibi simetrik algoritmalarda kullanÄ±lan simetrik anahtarlarÄ±n yanÄ± sÄ±ra, **KMS yalnÄ±zca simetrik anahtarlarÄ± depolar ve fiziksel olarak korur (sertifika otoritesi olarak hareket edemez)**, bu nedenle PKI ve CA anahtarlarÄ±nÄ± depolamanÄ±z gerekiyorsa bir veya iki CloudHSM Ã§Ã¶zÃ¼mÃ¼nÃ¼z olabilir.

**CloudHSM, Anahtar YÃ¶netim Hizmetinden Ã¶nemli Ã¶lÃ§Ã¼de daha pahalÄ±dÄ±r.** CloudHSM bir donanÄ±m cihazÄ±dÄ±r, bu nedenle CloudHSM cihazÄ±nÄ± saÄŸlamak iÃ§in sabit maliyetleriniz vardÄ±r, ardÄ±ndan cihazÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in saatlik bir maliyet vardÄ±r. Maliyet, belirli gereksinimlerinizi karÅŸÄ±lamak iÃ§in gereken CloudHSM cihazlarÄ±nÄ±n sayÄ±sÄ± ile Ã§arpÄ±lÄ±r.\
AyrÄ±ca, SafeNet ProtectV yazÄ±lÄ±m paketleri gibi Ã¼Ã§Ã¼ncÃ¼ taraf yazÄ±lÄ±mlarÄ±n satÄ±n alÄ±nmasÄ±nda ve entegrasyon sÃ¼resi ve Ã§abasÄ±nda Ã§apraz deÄŸerlendirme yapÄ±lmalÄ±dÄ±r. Anahtar YÃ¶netim Hizmeti, kullanÄ±m bazlÄ±dÄ±r ve sahip olduÄŸunuz anahtar sayÄ±sÄ±na ve giriÅŸ-Ã§Ä±kÄ±ÅŸ iÅŸlemlerine baÄŸlÄ±dÄ±r. Anahtar yÃ¶netimi, birÃ§ok AWS hizmeti ile sorunsuz entegrasyon saÄŸladÄ±ÄŸÄ±ndan, entegrasyon maliyetleri Ã¶nemli Ã¶lÃ§Ã¼de daha dÃ¼ÅŸÃ¼k olmalÄ±dÄ±r. Maliyetler, ÅŸifreleme Ã§Ã¶zÃ¼mlerinde ikincil bir faktÃ¶r olarak dÃ¼ÅŸÃ¼nÃ¼lmelidir. Åifreleme genellikle gÃ¼venlik ve uyumluluk iÃ§in kullanÄ±lÄ±r.

**CloudHSM ile yalnÄ±zca siz anahtarlara eriÅŸirsiniz** ve fazla detaya girmeden, CloudHSM ile kendi anahtarlarÄ±nÄ±zÄ± yÃ¶netirsiniz. **KMS ile, anahtarlarÄ±nÄ±zÄ± Amazon ile birlikte yÃ¶netirsiniz.** AWS, kÃ¶tÃ¼ye kullanÄ±ma karÅŸÄ± birÃ§ok politika korumasÄ±na sahiptir ve **her iki Ã§Ã¶zÃ¼mde de anahtarlarÄ±nÄ±za eriÅŸemez.** Anahtar sahipliÄŸi ve yÃ¶netimi ile ilgili uyumluluk aÃ§Ä±sÄ±ndan ana ayrÄ±m, CloudHSM'nin sizin ve yalnÄ±zca sizin eriÅŸiminiz olan bir donanÄ±m cihazÄ± olmasÄ±dÄ±r.

### CloudHSM Ã–nerileri

1. CloudHSM'yi her zaman en az iki cihazla **HA yapÄ±landÄ±rmasÄ±nda** daÄŸÄ±tÄ±n ve mÃ¼mkÃ¼nse, AWS'de baÅŸka bir bÃ¶lgede ya da yerel olarak Ã¼Ã§Ã¼ncÃ¼ bir cihaz daÄŸÄ±tÄ±n.
2. **CloudHSM'yi baÅŸlatÄ±rken dikkatli olun.** Bu iÅŸlem **anahtarlarÄ± yok edecektir**, bu nedenle ya anahtarlarÄ±n baÅŸka bir kopyasÄ±na sahip olun ya da bu anahtarlara herhangi bir veriyi ÅŸifrelemek iÃ§in ihtiyaÃ§ duymayacaÄŸÄ±nÄ±zdan kesinlikle emin olun.
3. CloudHSM yalnÄ±zca **belirli yazÄ±lÄ±m sÃ¼rÃ¼mlerini** ve yazÄ±lÄ±mlarÄ± destekler. Herhangi bir gÃ¼ncelleme yapmadan Ã¶nce, yazÄ±lÄ±mÄ±n ve/veya yazÄ±lÄ±mÄ±n AWS tarafÄ±ndan desteklendiÄŸinden emin olun. GÃ¼ncelleme kÄ±lavuzu belirsizse her zaman AWS desteÄŸi ile iletiÅŸime geÃ§ebilirsiniz.
4. **AÄŸ yapÄ±landÄ±rmasÄ± asla deÄŸiÅŸtirilmemelidir.** UnutmayÄ±n, bu bir AWS veri merkezindedir ve AWS sizin iÃ§in temel donanÄ±mÄ± izlemektedir. Bu, donanÄ±m arÄ±zalanÄ±rsa, yalnÄ±zca arÄ±zalandÄ±ÄŸÄ±nÄ± bildiklerinde sizin iÃ§in deÄŸiÅŸtirecekleri anlamÄ±na gelir.
5. **SysLog yÃ¶nlendirmesi kaldÄ±rÄ±lmamalÄ± veya deÄŸiÅŸtirilmemelidir.** Her zaman **kendi toplama aracÄ±nÄ±za** yÃ¶nlendirmek iÃ§in bir SysLog yÃ¶nlendirici ekleyebilirsiniz.
6. **SNMP** yapÄ±landÄ±rmasÄ±, aÄŸ ve SysLog klasÃ¶rÃ¼ ile aynÄ± temel kÄ±sÄ±tlamalara sahiptir. Bu **deÄŸiÅŸtirilmemeli veya kaldÄ±rÄ±lmamalÄ±dÄ±r.** Ek bir SNMP yapÄ±landÄ±rmasÄ± uygundur, yalnÄ±zca cihazda zaten bulunanÄ± deÄŸiÅŸtirmediÄŸinizden emin olun.
7. AWS'den baÅŸka bir ilginÃ§ en iyi uygulama, **NTP yapÄ±landÄ±rmasÄ±nÄ± deÄŸiÅŸtirmemektir.** Ne olacaÄŸÄ± belirsizdir, bu nedenle Ã§Ã¶zÃ¼mÃ¼nÃ¼zÃ¼n geri kalanÄ±nda aynÄ± NTP yapÄ±landÄ±rmasÄ±nÄ± kullanmazsanÄ±z iki zaman kaynaÄŸÄ±nÄ±z olabileceÄŸini unutmayÄ±n. Bunu aklÄ±nÄ±zda bulundurun ve CloudHSM'nin mevcut NTP kaynaÄŸÄ± ile kalmasÄ± gerektiÄŸini bilin.

CloudHSM iÃ§in baÅŸlangÄ±Ã§ta donanÄ±m cihazÄ±nÄ± tahsis etmek iÃ§in 5,000 $ Ã¼cret alÄ±nÄ±r, ardÄ±ndan CloudHSM'yi Ã§alÄ±ÅŸtÄ±rmak iÃ§in saatlik bir Ã¼cret vardÄ±r ve bu ÅŸu anda saatte 1.88 $ veya aylÄ±k yaklaÅŸÄ±k 1,373 $'dÄ±r.

CloudHSM'yi kullanmanÄ±n en yaygÄ±n nedeni, karÅŸÄ±lamanÄ±z gereken uyumluluk standartlarÄ±dÄ±r. **KMS, asimetrik anahtarlar iÃ§in veri desteÄŸi sunmaz. CloudHSM, asimetrik anahtarlarÄ± gÃ¼venli bir ÅŸekilde depolamanÄ±za izin verir.**

**AÃ§Ä±k anahtar, CloudHSM Ã¶rneÄŸi saÄŸlanÄ±rken HSM cihazÄ±na yÃ¼klenir** bÃ¶ylece CloudHSM Ã¶rneÄŸine SSH ile eriÅŸebilirsiniz.

### DonanÄ±m GÃ¼venlik ModÃ¼lÃ¼ Nedir

DonanÄ±m gÃ¼venlik modÃ¼lÃ¼ (HSM), kriptografik anahtarlarÄ± oluÅŸturmak, depolamak ve yÃ¶netmek ve hassas verileri korumak iÃ§in kullanÄ±lan Ã¶zel bir kriptografik cihazdÄ±r. Kriptografik iÅŸlevleri sistemin geri kalanÄ±ndan fiziksel ve elektronik olarak izole ederek yÃ¼ksek dÃ¼zeyde gÃ¼venlik saÄŸlamak iÃ§in tasarlanmÄ±ÅŸtÄ±r.

Bir HSM'nin Ã§alÄ±ÅŸma ÅŸekli, belirli model ve Ã¼reticiye baÄŸlÄ± olarak deÄŸiÅŸebilir, ancak genel olarak aÅŸaÄŸÄ±daki adÄ±mlar gerÃ§ekleÅŸir:

1. **Anahtar oluÅŸturma**: HSM, gÃ¼venli bir rastgele sayÄ± Ã¼reteci kullanarak rastgele bir kriptografik anahtar oluÅŸturur.
2. **Anahtar depolama**: Anahtar, **yalnÄ±zca yetkili kullanÄ±cÄ±lar veya sÃ¼reÃ§ler tarafÄ±ndan eriÅŸilebilen HSM iÃ§inde gÃ¼venli bir ÅŸekilde depolanÄ±r**.
3. **Anahtar yÃ¶netimi**: HSM, anahtar dÃ¶ngÃ¼sÃ¼, yedekleme ve iptal gibi bir dizi anahtar yÃ¶netim iÅŸlevi saÄŸlar.
4. **Kriptografik iÅŸlemler**: HSM, ÅŸifreleme, ÅŸifre Ã§Ã¶zme, dijital imza ve anahtar deÄŸiÅŸimi gibi bir dizi kriptografik iÅŸlem gerÃ§ekleÅŸtirir. Bu iÅŸlemler, **HSM'nin gÃ¼venli ortamÄ±nda gerÃ§ekleÅŸtirilir**, bu da yetkisiz eriÅŸim ve mÃ¼dahaleye karÅŸÄ± koruma saÄŸlar.
5. **Denetim gÃ¼nlÃ¼ÄŸÃ¼**: HSM, tÃ¼m kriptografik iÅŸlemleri ve eriÅŸim giriÅŸimlerini kaydeder, bu da uyumluluk ve gÃ¼venlik denetimi amaÃ§larÄ± iÃ§in kullanÄ±labilir.

HSM'ler, gÃ¼venli Ã§evrimiÃ§i iÅŸlemler, dijital sertifikalar, gÃ¼venli iletiÅŸim ve veri ÅŸifreleme gibi Ã§ok Ã§eÅŸitli uygulamalar iÃ§in kullanÄ±labilir. Genellikle finans, saÄŸlÄ±k ve hÃ¼kÃ¼met gibi yÃ¼ksek gÃ¼venlik gerektiren endÃ¼strilerde kullanÄ±lÄ±r.

Genel olarak, HSM'lerin saÄŸladÄ±ÄŸÄ± yÃ¼ksek gÃ¼venlik seviyesi, **ham anahtarlarÄ±n Ã§Ä±karÄ±lmasÄ±nÄ± Ã§ok zor hale getirir ve bunu denemek genellikle bir gÃ¼venlik ihlali olarak kabul edilir.** Ancak, belirli **senaryolar** olabilir ki **ham bir anahtar, belirli amaÃ§lar iÃ§in yetkili personel tarafÄ±ndan Ã§Ä±karÄ±labilir**, Ã¶rneÄŸin bir anahtar kurtarma prosedÃ¼rÃ¼ durumunda.

### SayÄ±m
```
TODO
```
{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
