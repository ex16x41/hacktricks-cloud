# AWS - EMR Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## EMR

O servi√ßo Elastic MapReduce (EMR) da AWS, a partir da vers√£o 4.8.0, introduziu um recurso de **configura√ß√£o de seguran√ßa** que melhora a prote√ß√£o de dados ao permitir que os usu√°rios especifiquem configura√ß√µes de criptografia para dados em repouso e em tr√¢nsito dentro dos clusters EMR, que s√£o grupos escal√°veis de inst√¢ncias EC2 projetadas para processar estruturas de big data como Apache Hadoop e Spark.

As principais caracter√≠sticas incluem:

* **Criptografia de Cluster Padr√£o**: Por padr√£o, os dados em repouso dentro de um cluster n√£o s√£o criptografados. No entanto, habilitar a criptografia fornece acesso a v√°rios recursos:
* **Configura√ß√£o Unificada de Chaves do Linux**: Criptografa volumes de cluster EBS. Os usu√°rios podem optar pelo AWS Key Management Service (KMS) ou um provedor de chave personalizado.
* **Criptografia HDFS de C√≥digo Aberto**: Oferece duas op√ß√µes de criptografia para Hadoop:
* RPC (Chamada de Procedimento Remoto) Hadoop Seguro, configurado para privacidade, aproveitando a Camada de Seguran√ßa de Autentica√ß√£o Simples.
* Criptografia de transfer√™ncia de bloco HDFS, configurada como verdadeira, utiliza o algoritmo AES-256.
* **Criptografia em Tr√¢nsito**: Foca em proteger dados durante a transfer√™ncia. As op√ß√µes incluem:
* **Criptografia de Camada de Transporte de C√≥digo Aberto (TLS)**: A criptografia pode ser habilitada escolhendo um provedor de certificado:
* **PEM**: Requer a cria√ß√£o manual e a compacta√ß√£o de certificados PEM em um arquivo zip, referenciado a partir de um bucket S3.
* **Personalizado**: Envolve adicionar uma classe Java personalizada como provedor de certificado que fornece artefatos de criptografia.

Uma vez que um provedor de certificado TLS √© integrado √† configura√ß√£o de seguran√ßa, os seguintes recursos de criptografia espec√≠ficos da aplica√ß√£o podem ser ativados, variando com base na vers√£o do EMR:

* **Hadoop**:
* Pode reduzir o embaralhamento criptografado usando TLS.
* RPC Hadoop Seguro com Camada de Seguran√ßa de Autentica√ß√£o Simples e Transfer√™ncia de Bloco HDFS com AES-256 s√£o ativados com criptografia em repouso.
* **Presto** (vers√£o EMR 5.6.0+):
* A comunica√ß√£o interna entre os n√≥s Presto √© protegida usando SSL e TLS.
* **Tez Shuffle Handler**:
* Utiliza TLS para criptografia.
* **Spark**:
* Emprega TLS para o protocolo Akka.
* Usa Camada de Seguran√ßa de Autentica√ß√£o Simples e 3DES para o Servi√ßo de Transfer√™ncia de Bloco.
* O servi√ßo de embaralhamento externo √© protegido com a Camada de Seguran√ßa de Autentica√ß√£o Simples.

Esses recursos, coletivamente, melhoram a postura de seguran√ßa dos clusters EMR, especialmente em rela√ß√£o √† prote√ß√£o de dados durante as fases de armazenamento e transmiss√£o.

#### Enumeration
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
#### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

## Refer√™ncias

* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
