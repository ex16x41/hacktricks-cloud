# AWS - EMR Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## EMR

Η υπηρεσία Elastic MapReduce (EMR) της AWS, ξεκινώντας από την έκδοση 4.8.0, εισήγαγε μια **ρύθμιση ασφαλείας** που ενισχύει την προστασία των δεδομένων επιτρέποντας στους χρήστες να καθορίζουν ρυθμίσεις κρυπτογράφησης για δεδομένα σε κατάσταση ηρεμίας και σε μεταφορά εντός των κλάσεων EMR, οι οποίες είναι κλιμακωτές ομάδες EC2 instances σχεδιασμένες να επεξεργάζονται μεγάλα δεδομένα όπως το Apache Hadoop και το Spark.

Τα κύρια χαρακτηριστικά περιλαμβάνουν:

* **Προεπιλεγμένη Κρυπτογράφηση Κλάσης**: Από προεπιλογή, τα δεδομένα σε κατάσταση ηρεμίας εντός μιας κλάσης δεν είναι κρυπτογραφημένα. Ωστόσο, η ενεργοποίηση της κρυπτογράφησης παρέχει πρόσβαση σε πολλές δυνατότητες:
* **Ενοποιημένη Ρύθμιση Κλειδιών Linux**: Κρυπτογραφεί τους όγκους EBS της κλάσης. Οι χρήστες μπορούν να επιλέξουν την Υπηρεσία Διαχείρισης Κλειδιών AWS (KMS) ή έναν προμηθευτή κλειδιών προσαρμοσμένου.
* **Κρυπτογράφηση HDFS Ανοιχτού Κώδικα**: Προσφέρει δύο επιλογές κρυπτογράφησης για το Hadoop:
* Ασφαλής Hadoop RPC (Remote Procedure Call), ρυθμισμένο σε ιδιωτικότητα, εκμεταλλευόμενο το Simple Authentication Security Layer.
* Κρυπτογράφηση μεταφοράς μπλοκ HDFS, ρυθμισμένο σε true, χρησιμοποιεί τον αλγόριθμο AES-256.
* **Κρυπτογράφηση σε Μεταφορά**: Επικεντρώνεται στην ασφάλεια των δεδομένων κατά τη μεταφορά. Οι επιλογές περιλαμβάνουν:
* **Ανοιχτού Κώδικα Ασφάλεια Μεταφοράς (TLS)**: Η κρυπτογράφηση μπορεί να ενεργοποιηθεί επιλέγοντας έναν προμηθευτή πιστοποιητικών:
* **PEM**: Απαιτεί χειροκίνητη δημιουργία και συσκευασία των πιστοποιητικών PEM σε ένα αρχείο zip, αναφερόμενο από έναν κάδο S3.
* **Προσαρμοσμένο**: Περιλαμβάνει την προσθήκη μιας προσαρμοσμένης κλάσης Java ως προμηθευτή πιστοποιητικών που παρέχει κρυπτογραφικά στοιχεία.

Μόλις ενσωματωθεί ένας προμηθευτής πιστοποιητικών TLS στη ρύθμιση ασφαλείας, οι παρακάτω δυνατότητες κρυπτογράφησης συγκεκριμένων εφαρμογών μπορούν να ενεργοποιηθούν, ποικίλλοντας ανάλογα με την έκδοση EMR:

* **Hadoop**:
* Μπορεί να μειώσει την κρυπτογραφημένη αναδιάταξη χρησιμοποιώντας TLS.
* Ασφαλής Hadoop RPC με Simple Authentication Security Layer και HDFS Block Transfer με AES-256 ενεργοποιούνται με κρυπτογράφηση σε κατάσταση ηρεμίας.
* **Presto** (έκδοση EMR 5.6.0+):
* Η εσωτερική επικοινωνία μεταξύ των κόμβων Presto είναι ασφαλής χρησιμοποιώντας SSL και TLS.
* **Tez Shuffle Handler**:
* Χρησιμοποιεί TLS για κρυπτογράφηση.
* **Spark**:
* Χρησιμοποιεί TLS για το πρωτόκολλο Akka.
* Χρησιμοποιεί Simple Authentication Security Layer και 3DES για την Υπηρεσία Μεταφοράς Μπλοκ.
* Η εξωτερική υπηρεσία αναδιάταξης είναι ασφαλής με το Simple Authentication Security Layer.

Αυτές οι δυνατότητες συλλογικά ενισχύουν τη θέση ασφάλειας των κλάσεων EMR, ειδικά όσον αφορά την προστασία των δεδομένων κατά τη διάρκεια των φάσεων αποθήκευσης και μετάδοσης.

#### Enumeration
```bash
aws emr list-clusters
aws emr describe-cluster --cluster-id <id>
aws emr list-instances --cluster-id <id>
aws emr list-instance-fleets --cluster-id <id>
aws emr list-steps --cluster-id <id>
aws emr list-notebook-executions
aws emr list-security-configurations
aws emr list-studios #Get studio URLs
```
#### Privesc

{% content-ref url="../aws-privilege-escalation/aws-emr-privesc.md" %}
[aws-emr-privesc.md](../aws-privilege-escalation/aws-emr-privesc.md)
{% endcontent-ref %}

## Αναφορές

* [https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/](https://cloudacademy.com/course/domain-three-designing-secure-applications-and-architectures/elastic-mapreduce-emr-encryption-1/)

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξη HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε κόλπα hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
