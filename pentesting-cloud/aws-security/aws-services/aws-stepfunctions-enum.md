# AWS - Step Functions Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Step Functions

AWS Step Functions - —Ü–µ —Å–µ—Ä–≤—ñ—Å —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –∫–æ–æ—Ä–¥–∏–Ω—É–≤–∞—Ç–∏ —Ç–∞ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤ AWS —É –±–µ–∑—Å–µ—Ä–≤–µ—Ä–Ω—ñ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ AWS Step Functions, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏, —è–∫—ñ –∑'—î–¥–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ AWS, —Ç–∞–∫—ñ —è–∫ AWS Lambda, Amazon S3, Amazon DynamoDB —Ç–∞ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–∏—Ö, —É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –∫—Ä–æ–∫—ñ–≤. –¶–µ–π —Å–µ—Ä–≤—ñ—Å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—ó –Ω–∞–¥–∞—î –≤—ñ–∑—É–∞–ª—å–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É —Ç–∞ –ø—Ä–æ–ø–æ–Ω—É—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ **–º–∞—à–∏–Ω–∏ —Å—Ç–∞–Ω—ñ–≤**, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –≤–∏–∑–Ω–∞—á–∞—Ç–∏ –∫–æ–∂–µ–Ω –∫—Ä–æ–∫ —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∏–º —á–∏–Ω–æ–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ JSON-—Ñ–æ—Ä–º–∞—Ç **Amazon States Language** (ASL).

## Key concepts

### Standard vs. Express Workflows

AWS Step Functions –ø—Ä–æ–ø–æ–Ω—É—î –¥–≤–∞ —Ç–∏–ø–∏ **—Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ –º–∞—à–∏–Ω–∏ —Å—Ç–∞–Ω—ñ–≤**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ç–∞ –ï–∫—Å–ø—Ä–µ—Å.

* **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å**: –¶–µ–π —Ç–∏–ø —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Ç—Ä–∏–≤–∞–ª–∏—Ö, –Ω–∞–¥—ñ–π–Ω–∏—Ö —Ç–∞ –∞—É–¥–∏—Ç–æ—Ä—Å—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤. –í—ñ–Ω –ø—ñ–¥—Ç—Ä–∏–º—É—î **—Ç–æ—á–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–¥–∏–Ω —Ä–∞–∑**, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑, —è–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω—ñ –ø–æ–≤—Ç–æ—Ä–Ω—ñ —Å–ø—Ä–æ–±–∏. –Ü–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, —è–∫—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, —ñ –º–æ–∂–µ —Ç—Ä–∏–≤–∞—Ç–∏ –¥–æ –æ–¥–Ω–æ–≥–æ —Ä–æ–∫—É.
* **–ï–∫—Å–ø—Ä–µ—Å —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å**: –¶–µ–π —Ç–∏–ø —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –∑–∞–≤–¥–∞–Ω—å –∑ –≤–∏—Å–æ–∫–∏–º –æ–±—Å—è–≥–æ–º —Ç–∞ –∫–æ—Ä–æ—Ç–∫–æ—é —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é, —â–æ —Ç—Ä–∏–≤–∞—é—Ç—å –¥–æ –ø'—è—Ç–∏ —Ö–≤–∏–ª–∏–Ω. –í–æ–Ω–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å **–ø—Ä–∏–Ω–∞–π–º–Ω—ñ –æ–¥–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**, —â–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å, —Ç–∞–∫–∏—Ö —è–∫ –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö. –¶—ñ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –¥–ª—è –≤–∏—Ç—Ä–∞—Ç —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, —Å—Ç—è–≥—É—é—á–∏ –ø–ª–∞—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–∫–æ–Ω–∞–Ω—å, —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ.

### States

–°—Ç–∞–Ω —î –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –æ–¥–∏–Ω–∏—Ü—è–º–∏ –º–∞—à–∏–Ω —Å—Ç–∞–Ω—ñ–≤. –í–æ–Ω–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –æ–∫—Ä–µ–º—ñ –∫—Ä–æ–∫–∏ –≤ —Ä–æ–±–æ—á–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ, –∑–¥–∞—Ç–Ω—ñ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —ó—Ö —Ç–∏–ø—É:

* **–ó–∞–≤–¥–∞–Ω–Ω—è:** –í–∏–∫–æ–Ω—É—î —Ä–æ–±–æ—Ç—É, —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–µ—Ä–≤—ñ—Å AWS, —Ç–∞–∫–∏–π —è–∫ Lambda.
* **–í–∏–±—ñ—Ä:** –ü—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–Ω—è.
* **–ü–æ–º–∏–ª–∫–∞/–£—Å–ø—ñ—Ö:** –ó–∞–≤–µ—Ä—à—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑ –ø–æ–º–∏–ª–∫–æ—é –∞–±–æ —É—Å–ø—ñ—Ö–æ–º.
* **–ü—Ä–æ–ø—É—Å–∫:** –ü–µ—Ä–µ–¥–∞—î –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–∞ –≤–∏—Ö—ñ–¥ –∞–±–æ –≤–≤–æ–¥–∏—Ç—å –¥–∞–Ω—ñ.
* **–û—á—ñ–∫—É–≤–∞–Ω–Ω—è:** –ó–∞—Ç—Ä–∏–º—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π —á–∞—Å.
* **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π:** –Ü–Ω—ñ—Ü—ñ—é—î –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –≥—ñ–ª–∫–∏.
* **–ö–∞—Ä—Ç–∞:** –î–∏–Ω–∞–º—ñ—á–Ω–æ —ñ—Ç–µ—Ä—É—î –∫—Ä–æ–∫–∏ –Ω–∞–¥ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏.

### Task

–°—Ç–∞–Ω **–ó–∞–≤–¥–∞–Ω–Ω—è** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Å–æ–±–æ—é –æ–¥–∏–Ω–∏—á–Ω—É –æ–¥–∏–Ω–∏—Ü—é —Ä–æ–±–æ—Ç–∏, –≤–∏–∫–æ–Ω—É–≤–∞–Ω—É –º–∞—à–∏–Ω–æ—é —Å—Ç–∞–Ω—ñ–≤. –ó–∞–≤–¥–∞–Ω–Ω—è –º–æ–∂—É—Ç—å –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏, –≤–∫–ª—é—á–∞—é—á–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, —Ñ—É–Ω–∫—Ü—ñ—ó Lambda, —Å–µ—Ä–≤—ñ—Å–∏ AWS –∞–±–æ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ API.

* **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ**: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏, —è–∫—ñ –≤–∏ –∫–µ—Ä—É—î—Ç–µ, –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è —Ç—Ä–∏–≤–∞–ª–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤.
* –†–µ—Å—É—Ä—Å: **`arn:aws:states:region:account:activity:name`**.
* **–§—É–Ω–∫—Ü—ñ—ó Lambda**: –í–∏–∫–æ–Ω—É—î —Ñ—É–Ω–∫—Ü—ñ—ó AWS Lambda.
* –†–µ—Å—É—Ä—Å: **`arn:aws:lambda:region:account:function:function-name`**.
* **–°–µ—Ä–≤—ñ—Å–∏ AWS**: –Ü–Ω—Ç–µ–≥—Ä—É—î—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ AWS, —Ç–∞–∫–∏–º–∏ —è–∫ DynamoDB –∞–±–æ S3.
* –†–µ—Å—É—Ä—Å: **`arn:partition:states:region:account:servicename:APIname`**.
* **HTTP –ó–∞–≤–¥–∞–Ω–Ω—è**: –í–∏–∫–ª–∏–∫–∞—î —Å—Ç–æ—Ä–æ–Ω–Ω—ñ API.
* –ü–æ–ª–µ —Ä–µ—Å—É—Ä—Å—É: **`arn:aws:states:::http:invoke`**. –ü–æ—Ç—ñ–º –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –Ω–∞–¥–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏ API, —Ç–∞–∫—ñ —è–∫ URL API, –º–µ—Ç–æ–¥ —Ç–∞ –¥–µ—Ç–∞–ª—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

–ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –ø–æ–∫–∞–∑—É—î –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –ó–∞–≤–¥–∞–Ω–Ω—è, —è–∫–µ –≤–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ—é Lambda –ø—ñ–¥ –Ω–∞–∑–≤–æ—é HelloWorld:
```json
"HelloWorld": {
"Type": "Task",
"Resource": "arn:aws:states:::lambda:invoke",
"Parameters": {
"Payload.$": "$",
"FunctionName": "arn:aws:lambda:<region>:<account-id>:function:HelloWorld"
},
"End": true
}
```
### Choice

–°—Ç–∞–Ω **Choice** –¥–æ–¥–∞—î —É–º–æ–≤–Ω—É –ª–æ–≥—ñ–∫—É –¥–æ —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏–π–º–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –í—ñ–Ω –æ—Ü—ñ–Ω—é—î –≤–∫–∞–∑–∞–Ω—ñ —É–º–æ–≤–∏ —Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Å—Ç–∞–Ω—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.

* **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è**: –ö–æ–∂–Ω–µ –ø—Ä–∞–≤–∏–ª–æ –≤–∏–±–æ—Ä—É –≤–∫–ª—é—á–∞—î –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **`NumericEquals`**, **`StringEquals`**), —è–∫–∏–π –ø–æ—Ä—ñ–≤–Ω—é—î –∑–º—ñ–Ω–Ω—É –≤–≤–µ–¥–µ–Ω–Ω—è –∑ –≤–∫–∞–∑–∞–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º –∞–±–æ —ñ–Ω—à–æ—é –∑–º—ñ–Ω–Ω–æ—é.
* **–ü–æ–ª–µ Next**: –°—Ç–∞–Ω –≤–∏–±–æ—Ä—É –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ–ª–µ **`End`**, –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –≤–æ–Ω–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —Å—Ç–∞–Ω **`Next`** –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É, —è–∫—â–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —î —ñ—Å—Ç–∏–Ω–Ω–∏–º.

–ü—Ä–∏–∫–ª–∞–¥ —Å—Ç–∞–Ω—É **Choice**:
```json
{
"Variable": "$.timeStamp",
"TimestampEquals": "2000-01-01T00:00:00Z",
"Next": "TimeState"
}
```
### Fail/Succeed

–°—Ç–∞–Ω **`Fail`** –∑—É–ø–∏–Ω—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º–∞—à–∏–Ω–∏ —Å—Ç–∞–Ω—ñ–≤ —ñ –ø–æ–∑–Ω–∞—á–∞—î –π–æ–≥–æ —è–∫ –Ω–µ–≤–¥–∞–ª–µ. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ –Ω–∞–∑–≤–∏ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –ø—Ä–∏—á–∏–Ω–∏, –Ω–∞–¥–∞—é—á–∏ –¥–µ—Ç–∞–ª—ñ –ø—Ä–æ –Ω–µ–≤–¥–∞—á—É. –¶–µ–π —Å—Ç–∞–Ω —î —Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω–∏–º, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤—ñ–Ω –∑–∞–≤–µ—Ä—à—É—î –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

–°—Ç–∞–Ω **`Succeed`** –∑—É–ø–∏–Ω—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ. –í—ñ–Ω –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, –∫–æ–ª–∏ –≤—ñ–Ω —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è. –¶–µ–π —Å—Ç–∞–Ω –Ω–µ –≤–∏–º–∞–≥–∞—î –ø–æ–ª—è **`Next`**.

{% tabs %}
{% tab title="Fail example" %}
```json
"FailState": {
"Type": "Fail",
"Error": "ErrorName",
"Cause": "Error details"
}
```
{% endtab %}

{% tab title="–ü—Ä–∏–∫–ª–∞–¥ —É—Å–ø—ñ—Ö—É" %}
```json
"SuccessState": {
"Type": "Succeed"
}
```
{% endtab %}
{% endtabs %}

### Pass

–°—Ç–∞–Ω **Pass** –ø–µ—Ä–µ–¥–∞—î —Å–≤—ñ–π –≤—Ö—ñ–¥–Ω–∏–π —Å–∏–≥–Ω–∞–ª –Ω–∞ –≤–∏—Ö—ñ–¥ –∞–±–æ –±–µ–∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—É–¥—å-—è–∫–æ—ó —Ä–æ–±–æ—Ç–∏, –∞–±–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ –≤—Ö—ñ–¥–Ω–∏–π JSON —Å—Ç–∞–Ω –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—ñ–ª—å—Ç—Ä—ñ–≤, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–¥–∞—é—á–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—ñ –¥–∞–Ω—ñ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∞–Ω—É. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–æ–±—É–¥–æ–≤–∏ —Å—Ç–∞–Ω—ñ–≤ –º–∞—à–∏–Ω, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –≤–∞–º –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —ó—Ö.
```json
"PassState": {
"Type": "Pass",
"Result": {"key": "value"},
"ResultPath": "$.newField",
"Next": "NextState"
}
```
### Wait

–°—Ç–∞–Ω **Wait** –∑–∞—Ç—Ä–∏–º—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º–∞—à–∏–Ω–∏ —Å—Ç–∞–Ω—ñ–≤ –Ω–∞ –≤–∫–∞–∑–∞–Ω–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫ —á–∞—Å—É. –Ü—Å–Ω—É—î —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è:

*   **X Seconds**: –§—ñ–∫—Å–æ–≤–∞–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—É–Ω–¥ –¥–ª—è –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è.

```json
"WaitState": {
"Type": "Wait",
"Seconds": 10,
"Next": "NextState"
}
```
*   **Absolute Timestamp**: –¢–æ—á–Ω–∏–π —á–∞—Å, –¥–æ —è–∫–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —á–µ–∫–∞—Ç–∏.

```json
"WaitState": {
"Type": "Wait",
"Timestamp": "2024-03-14T01:59:00Z",
"Next": "NextState"
}
```
*   **Dynamic Wait**: –ù–∞ –æ—Å–Ω–æ–≤—ñ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **`SecondsPath`** –∞–±–æ **`TimestampPath`**.

```json
jsonCopiar c√≥digo
"WaitState": {
"Type": "Wait",
"TimestampPath": "$.expirydate",
"Next": "NextState"
}
```

### Parallel

–°—Ç–∞–Ω **Parallel** –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –≥—ñ–ª–æ–∫ –∑–∞–≤–¥–∞–Ω—å –æ–¥–Ω–æ—á–∞—Å–Ω–æ —É –≤–∞—à–æ–º—É —Ä–æ–±–æ—á–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ. –ö–æ–∂–Ω–∞ –≥—ñ–ª–∫–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ —Ç–∞ –æ–±—Ä–æ–±–ª—è—î —Å–≤–æ—é –≤–ª–∞—Å–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Å—Ç–∞–Ω—ñ–≤. –í–∏–∫–æ–Ω–∞–Ω–Ω—è —á–µ–∫–∞—î, –ø–æ–∫–∏ –≤—Å—ñ –≥—ñ–ª–∫–∏ –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è, –ø–µ—Ä—à –Ω—ñ–∂ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∞–Ω—É. –ô–æ–≥–æ –∫–ª—é—á–æ–≤—ñ –ø–æ–ª—è:

* **Branches**: –ú–∞—Å–∏–≤, —â–æ –≤–∏–∑–Ω–∞—á–∞—î –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ —à–ª—è—Ö–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è. –ö–æ–∂–Ω–∞ –≥—ñ–ª–∫–∞ —î –æ–∫—Ä–µ–º–æ—é –º–∞—à–∏–Ω–æ—é —Å—Ç–∞–Ω—ñ–≤.
* **ResultPath**: –í–∏–∑–Ω–∞—á–∞—î, –¥–µ (–≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö) —Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ –æ–±'—î–¥–Ω–∞–Ω–∏–π –≤–∏—Ö—ñ–¥ –≥—ñ–ª–æ–∫.
* **Retry and Catch**: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É.
```json
"ParallelState": {
"Type": "Parallel",
"Branches": [
{
"StartAt": "Task1",
"States": { ... }
},
{
"StartAt": "Task2",
"States": { ... }
}
],
"Next": "NextState"
}
```
### Map

–°—Ç–∞–Ω **Map** –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞–±–æ—Ä—É –∫—Ä–æ–∫—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö. –í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ –≤–∏ —Ö–æ—á–µ—Ç–µ –æ–±—Ä–æ–±–ª—è—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö, Step Functions –Ω–∞–¥–∞—î —Ç–∞–∫—ñ —Ä–µ–∂–∏–º–∏:

*   **Inline Mode**: –í–∏–∫–æ–Ω—É—î –ø—ñ–¥–º–Ω–æ–∂–∏–Ω—É —Å—Ç–∞–Ω—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ JSON –º–∞—Å–∏–≤—É. –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –º–∞–ª–æ–º–∞—Å—à—Ç–∞–±–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å –∑ –º–µ–Ω—à–µ –Ω—ñ–∂ 40 –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–º–∏ —ñ—Ç–µ—Ä–∞—Ü—ñ—è–º–∏, –≤–∏–∫–æ–Ω—É—é—á–∏ –∫–æ–∂–Ω—É –∑ –Ω–∏—Ö —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ä–æ–±–æ—á–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Å—Ç–∞–Ω **`Map`**.

```json
"MapState": {
"Type": "Map",
"ItemsPath": "$.arrayItems",
"ItemProcessor": {
"ProcessorConfig": {
"Mode": "INLINE"
},
"StartAt": "AddState",
"States": {
"AddState": {
"Type": "Task",
"Resource": "arn:aws:states:::lambda:invoke",
"OutputPath": "$.Payload",
"Parameters": {
"FunctionName": "arn:aws:lambda:<region>:<account-id>:function:add-function"
},
"End": true
}
}
},
"End": true
"ResultPath": "$.detail.added",
"ItemsPath": "$.added"
}
```
*   **Distributed Mode**: –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–µ–ª–∏–∫–æ–º–∞—Å—à—Ç–∞–±–Ω–æ—ó –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∑ –≤–∏—Å–æ–∫–æ—é –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ñ—Å—Ç—é. –ü—ñ–¥—Ç—Ä–∏–º—É—î –æ–±—Ä–æ–±–∫—É –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ —Ç—ñ, —â–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ Amazon S3, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏—Å–æ–∫—ñ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—ñ –¥–æ 10,000 –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –≤–∏–∫–æ–Ω–∞–Ω—å –¥–æ—á—ñ—Ä–Ω—ñ—Ö —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, –≤–∏–∫–æ–Ω—É—é—á–∏ —Ü—ñ –¥–æ—á—ñ—Ä–Ω—ñ —è–∫ –æ–∫—Ä–µ–º–µ –¥–æ—á—ñ—Ä–Ω—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

```json
"DistributedMapState": {
"Type": "Map",
"ItemReader": {
"Resource": "arn:aws:states:::s3:getObject",
"Parameters": {
"Bucket": "my-bucket",
"Key": "data.csv"
}
},
"ItemProcessor": {
"ProcessorConfig": {
"Mode": "DISTRIBUTED",
"ExecutionType": "EXPRESS"
},
"StartAt": "ProcessItem",
"States": {
"ProcessItem": {
"Type": "Task",
"Resource": "arn:aws:lambda:region:account-id:function:my-function",
"End": true
}
}
},
"End": true
"ResultWriter": {
"Resource": "arn:aws:states:::s3:putObject",
"Parameters": {
"Bucket": "myOutputBucket",
"Prefix": "csvProcessJobs"
}
}
}
```

### Versions and aliases

Step Functions —Ç–∞–∫–æ–∂ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –∫–µ—Ä—É–≤–∞—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º–∏ —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ —á–µ—Ä–µ–∑ **–≤–µ—Ä—Å—ñ—ó** —Ç–∞ **–ø—Å–µ–≤–¥–æ–Ω—ñ–º–∏** —Å—Ç–∞–Ω—ñ–≤ –º–∞—à–∏–Ω. –í–µ—Ä—Å—ñ—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –∑–Ω—ñ–º–æ–∫ —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–∏–π. –ü—Å–µ–≤–¥–æ–Ω—ñ–º–∏ —Å–ª—É–∂–∞—Ç—å –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞–º–∏ –Ω–∞ –¥–æ –¥–≤–æ—Ö –≤–µ—Ä—Å—ñ–π —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏.

* **Versions**: –¶—ñ –Ω–µ–∑–º—ñ–Ω–Ω—ñ –∑–Ω—ñ–º–∫–∏ —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –∑ –Ω–∞–π–æ—Å—Ç–∞–Ω–Ω—ñ—à–æ—ó —Ä–µ–≤—ñ–∑—ñ—ó —Ü—ñ—î—ó —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏. –ö–æ–∂–Ω–∞ –≤–µ—Ä—Å—ñ—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º ARN, —è–∫–∏–π –ø–æ—î–¥–Ω—É—î ARN —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ –∑ –Ω–æ–º–µ—Ä–æ–º –≤–µ—Ä—Å—ñ—ó, —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏–º –¥–≤–æ–∫—Ä–∞–ø–∫–æ—é (**`arn:aws:states:region:account-id:stateMachine:StateMachineName:version-number`**). –í–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω—ñ, –∞–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∏ —Ç–∞ –æ–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–∞–∂–∞–Ω—É –≤–µ—Ä—Å—ñ—é —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏.
* **Aliases**: –¶—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞ –¥–æ –¥–≤–æ—Ö –≤–µ—Ä—Å—ñ–π –æ–¥–Ω—ñ—î—ó –π —Ç—ñ—î—ó –∂ —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏. –ú–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –ø—Å–µ–≤–¥–æ–Ω—ñ–º—ñ–≤ –¥–ª—è –æ–¥–Ω—ñ—î—ó —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º ARN, –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–º —à–ª—è—Ö–æ–º –ø–æ—î–¥–Ω–∞–Ω–Ω—è ARN —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ –∑ –Ω–∞–∑–≤–æ—é –ø—Å–µ–≤–¥–æ–Ω—ñ–º–∞, —Ä–æ–∑–¥—ñ–ª–µ–Ω–æ—é –¥–≤–æ–∫—Ä–∞–ø–∫–æ—é (**`arn:aws:states:region:account-id:stateMachine:StateMachineName:aliasName`**). –ü—Å–µ–≤–¥–æ–Ω—ñ–º–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—é —Ç—Ä–∞—Ñ—ñ–∫—É –º—ñ–∂ –æ–¥–Ω—ñ—î—é –∑ –¥–≤–æ—Ö –≤–µ—Ä—Å—ñ–π —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ, –ø—Å–µ–≤–¥–æ–Ω—ñ–º –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –æ–¥–Ω—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –≤–µ—Ä—Å—ñ—é —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏, –∞–ª–µ –Ω–µ –Ω–∞ —ñ–Ω—à—ñ –ø—Å–µ–≤–¥–æ–Ω—ñ–º–∏. –á—Ö –º–æ–∂–Ω–∞ –æ–Ω–æ–≤–∏—Ç–∏, —â–æ–± –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ —ñ–Ω—à—É –≤–µ—Ä—Å—ñ—é —Å—Ç–∞–Ω—É –º–∞—à–∏–Ω–∏ –∑–∞ –ø–æ—Ç—Ä–µ–±–∏, —â–æ –ø–æ–ª–µ–≥—à—É—î –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω—ñ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–æ–±–æ—á–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ **ASL** –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ: [**Amazon States Language**](https://states-language.net/spec.html).

## IAM Roles for State machines

AWS Step Functions –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ä–æ–ª—ñ AWS Identity and Access Management (IAM) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ —ñ –¥—ñ–π —É —Å—Ç–∞–Ω–∞—Ö –º–∞—à–∏–Ω. –û—Å—å –∫–ª—é—á–æ–≤—ñ –∞—Å–ø–µ–∫—Ç–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ –±–µ–∑–ø–µ–∫–æ—é —Ç–∞ —Ä–æ–ª—è–º–∏ IAM —É AWS Step Functions:

* **Execution Role**: –ö–æ–∂–Ω–∞ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –≤ AWS Step Functions –∞—Å–æ—Ü—ñ–π–æ–≤–∞–Ω–∞ –∑ —Ä–æ–ª–ª—é –≤–∏–∫–æ–Ω–∞–Ω–Ω—è IAM. –¶—è —Ä–æ–ª—å –≤–∏–∑–Ω–∞—á–∞—î, —è–∫—ñ –¥—ñ—ó —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ. –ö–æ–ª–∏ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –º—ñ–∂ —Å—Ç–∞–Ω–∞–º–∏, —è–∫—ñ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å –∑ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ AWS (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ–π Lambda, –¥–æ—Å—Ç—É–ø –¥–æ DynamoDB —Ç–æ—â–æ), –≤–æ–Ω–∞ –ø—Ä–∏–π–º–∞—î —Ü—é —Ä–æ–ª—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü–∏—Ö –¥—ñ–π.
* **Permissions**: –†–æ–ª—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è IAM –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥—ñ—ó –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ AWS. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∞—à–∞ —Å—Ç–∞–Ω –º–∞—à–∏–Ω–∞ –ø–æ–≤–∏–Ω–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó AWS Lambda, —Ä–æ–ª—å IAM –ø–æ–≤–∏–Ω–Ω–∞ –º–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–∏ **`lambda:InvokeFunction`**. –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, —è–∫—â–æ —ó–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –≤ DynamoDB, –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –Ω–∞–¥–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ (**`dynamodb:PutItem`**, **`dynamodb:UpdateItem`** —Ç–æ—â–æ).

## Enumeration

–ü–æ–ª—ñ—Ç–∏–∫–∞ ReadOnlyAccess –¥–æ—Å—Ç–∞—Ç–Ω—è –¥–ª—è –≤—Å—ñ—Ö –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –¥—ñ–π –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è.
```bash
# State machines #

## List state machines
aws stepfunctions list-state-machines
## Retrieve informatio about the specified state machine
aws stepfunctions describe-state-machine --state-machine-arn <value>

## List versions for the specified state machine
aws stepfunctions list-state-machine-versions --state-machine-arn <value>
## List aliases for the specified state machine
aws stepfunctions list-state-machine-aliases --state-machine-arn <value>
## Retrieve information about the specified state machine alias
aws stepfunctions describe-state-machine-alias --state-machine-alias-arn <value>

## List executions of a state machine
aws stepfunctions list-executions --state-machine-arn <value> [--status-filter <RUNNING | SUCCEEDED | FAILED | TIMED_OUT | ABORTED | PENDING_REDRIVE>] [--redrive-filter <REDRIVEN | NOT_REDRIVEN>]
## Retrieve information and relevant metadata about a state machine execution (output included)
aws stepfunctions describe-execution --execution-arn <value>
## Retrieve information about the state machine associated to the specified execution
aws stepfunctions describe-state-machine-for-execution --execution-arn <value>
## Retrieve the history of the specified execution as a list of events
aws stepfunctions get-execution-history --execution-arn <value> [--reverse-order | --no-reverse-order] [--include-execution-data | --no-include-execution-data]

## List tags for the specified step Functions resource
aws stepfunctions list-tags-for-resource --resource-arn <value>

## Validate the definition of a state machine without creating the resource
aws stepfunctions validate-state-machine-definition --definition <value> [--type <STANDARD | EXPRESS>]

# Activities #

## List existing activities
aws stepfunctions list-activities
## Retrieve information about the specified activity
aws stepfunctions describe-activity --activity-arn <value>

# Map Runs #

## List map runs of an execution
aws stepfunctions list-map-runs --execution-arn <value>
## Provide information about the configuration, progress and results of a Map Run
aws stepfunctions describe-map-run --map-run-arn <value>
## Lists executions of a Map Run
aws stepfunctions list-executions --map-run-arn <value> [--status-filter <RUNNING | SUCCEEDED | FAILED | TIMED_OUT | ABORTED | PENDING_REDRIVE>] [--redrive-filter <REDRIVEN | NOT_REDRIVEN>]
```
## Privesc

–ù–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —è–∫ **–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏ Step Functions –¥–ª—è –µ—Å–∫–∞–ª–∞—Ü—ñ—ó –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**:

{% content-ref url="../aws-privilege-escalation/aws-stepfunctions-privesc.md" %}
[aws-stepfunctions-privesc.md](../aws-privilege-escalation/aws-stepfunctions-privesc.md)
{% endcontent-ref %}

## Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-stepfunctions-post-exploitation.md" %}
[aws-stepfunctions-post-exploitation.md](../aws-post-exploitation/aws-stepfunctions-post-exploitation.md)
{% endcontent-ref %}

## Persistence

{% content-ref url="../aws-persistence/aws-step-functions-persistence.md" %}
[aws-step-functions-persistence.md](../aws-persistence/aws-step-functions-persistence.md)
{% endcontent-ref %}

## References

* [https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awsstepfunctions.html](https://docs.aws.amazon.com/service-authorization/latest/reference/list\_awsstepfunctions.html)
* [https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html](https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html)
* [https://states-language.net/spec.html](https://states-language.net/spec.html)

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
