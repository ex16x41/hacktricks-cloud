# AWS - Ä°liÅŸkisel VeritabanÄ± (RDS) Enum

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin**.
* **HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸÄ±n.

</details>
{% endhint %}

## Temel Bilgiler

AWS tarafÄ±ndan sunulan **Ä°liÅŸkisel VeritabanÄ± Hizmeti (RDS)**, bir **iliÅŸkisel veritabanÄ±nÄ±n bulut** Ã¼zerinde daÄŸÄ±tÄ±mÄ±nÄ±, iÅŸletimini ve Ã¶lÃ§eklendirilmesini kolaylaÅŸtÄ±rmak Ã¼zere tasarlanmÄ±ÅŸtÄ±r. Bu hizmet, maliyet verimliliÄŸi ve Ã¶lÃ§eklenebilirlik avantajlarÄ±nÄ± sunarken donanÄ±m saÄŸlama, veritabanÄ± yapÄ±landÄ±rma, yamalama ve yedekleme gibi iÅŸgÃ¼cÃ¼ yoÄŸun gÃ¶revleri otomatikleÅŸtirir.

AWS RDS, MySQL, PostgreSQL, MariaDB, Oracle VeritabanÄ±, Microsoft SQL Server ve Amazon Aurora da dahil olmak Ã¼zere Ã§eÅŸitli yaygÄ±n olarak kullanÄ±lan iliÅŸkisel veritabanÄ± motorlarÄ±nÄ± destekler ve hem MySQL hem de PostgreSQL iÃ§in uyumluluk saÄŸlar.

RDS'nin temel Ã¶zellikleri ÅŸunlardÄ±r:

- **VeritabanÄ± Ã¶rneklerinin yÃ¶netimi** basitleÅŸtirilmiÅŸtir.
- Okuma performansÄ±nÄ± artÄ±rmak iÃ§in **okuma kopyalarÄ±** oluÅŸturulabilir.
- YÃ¼ksek kullanÄ±labilirlik ve otomatik geÃ§iÅŸ mekanizmalarÄ±nÄ± saÄŸlamak iÃ§in **Ã§oklu EriÅŸilebilirlik BÃ¶lgesi (AZ) daÄŸÄ±tÄ±mlarÄ±** yapÄ±landÄ±rÄ±labilir.
- DiÄŸer AWS hizmetleriyle **entegrasyon** saÄŸlar, Ã¶rneÄŸin:
- SaÄŸlam eriÅŸim kontrolÃ¼ iÃ§in AWS Kimlik ve EriÅŸim YÃ¶netimi (**IAM**).
- KapsamlÄ± izleme ve metrikler iÃ§in AWS **CloudWatch**.
- Dinlenme sÄ±rasÄ±nda ÅŸifreleme saÄŸlamak iÃ§in AWS Anahtar YÃ¶netimi Servisi (**KMS**).

## Kimlik Bilgileri

DB kÃ¼mesi oluÅŸturulurken ana **kullanÄ±cÄ± adÄ± yapÄ±landÄ±rÄ±labilir** (**varsayÄ±lan olarak `admin`**). Bu kullanÄ±cÄ±nÄ±n ÅŸifresini oluÅŸturmak iÃ§in ÅŸunlarÄ± yapabilirsiniz:

* Kendiniz bir **ÅŸifre belirtin**
* RDS'ye **otomatik oluÅŸturmasÄ±nÄ±** sÃ¶yleyin
* RDS'ye bunu bir KMS anahtarÄ± ile ÅŸifrelenmiÅŸ olarak **AWS Secret Manager**'Ä± yÃ¶netmesini sÃ¶yleyin

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Kimlik DoÄŸrulama

3 tÃ¼r kimlik doÄŸrulama seÃ§eneÄŸi bulunmaktadÄ±r, ancak **ana ÅŸifre** kullanÄ±mÄ± her zaman **izinlidir**:

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Genel EriÅŸim ve VPC

VarsayÄ±lan olarak veritabanlarÄ±na **genel eriÅŸim verilmez**, ancak **verilebilir**. Bu nedenle, varsayÄ±lan olarak yalnÄ±zca aynÄ± VPC'den makineler eriÅŸebilir, seÃ§ilen **gÃ¼venlik grubu** (EC2 SG'de saklanÄ±r) bunu izin veriyorsa.

Bir DB Ã¶rneÄŸini aÃ§Ä±ÄŸa Ã§Ä±karmak yerine, DB kÃ¼mesinin **Ã¶lÃ§eklenebilirliÄŸini** ve **yayÄ±labilirliÄŸini artÄ±ran** bir **RDS Proxy** oluÅŸturmak mÃ¼mkÃ¼ndÃ¼r.

AyrÄ±ca, **veritabanÄ± baÄŸlantÄ± noktasÄ± da deÄŸiÅŸtirilebilir**.

### Åifreleme

AWS yÃ¶netilen bir anahtar kullanÄ±larak varsayÄ±lan olarak **ÅŸifreleme etkinleÅŸtirilir** (bunun yerine bir CMK seÃ§ilebilir).

Åifrelemenizi etkinleÅŸtirerek, depolama, anlÄ±k gÃ¶rÃ¼ntÃ¼ler, okuma kopyalarÄ± ve yedekleriniz iÃ§in **dinlenme sÄ±rasÄ±nda ÅŸifrelemeyi etkinleÅŸtirirsiniz**. Bu ÅŸifrelemeyi yÃ¶netmek iÃ§in anahtarlar, **KMS** kullanÄ±larak verilebilir.\
Bu dÃ¼zeyde ÅŸifrelemeyi veritabanÄ±nÄ±z oluÅŸturulduktan sonra eklemek mÃ¼mkÃ¼n deÄŸildir. **OluÅŸturulurken yapÄ±lmasÄ± gerekir**.

Ancak, aÅŸaÄŸÄ±daki gibi bir **ÅŸifrelenmemiÅŸ veritabanÄ±nÄ± ÅŸifrelemeye izin veren bir Ã§Ã¶zÃ¼m vardÄ±r**. ÅifrelenmemiÅŸ veritabanÄ±nÄ±zÄ±n bir anlÄ±k gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ oluÅŸturabilir, bu anlÄ±k gÃ¶rÃ¼ntÃ¼nÃ¼n ÅŸifrelenmiÅŸ bir kopyasÄ±nÄ± oluÅŸturabilir, bu ÅŸifrelenmiÅŸ anlÄ±k gÃ¶rÃ¼ntÃ¼yÃ¼ kullanarak yeni bir veritabanÄ± oluÅŸturabilir ve ardÄ±ndan veritabanÄ±nÄ±z ÅŸifrelenmiÅŸ olacaktÄ±r.

#### Åeffaf Veri Åifreleme (TDE)

Uygulama dÃ¼zeyinde RDS'nin sahip olduÄŸu ÅŸifreleme yeteneklerinin yanÄ± sÄ±ra, RDS ayrÄ±ca verileri dinlenme sÄ±rasÄ±nda korumak iÃ§in **ek platform dÃ¼zeyinde ÅŸifreleme mekanizmalarÄ±nÄ±** destekler. Bu, Oracle ve SQL Server iÃ§in **Åeffaf Veri Åifreleme (TDE)**'yi iÃ§erir. Ancak, TDE, verileri dinlenme sÄ±rasÄ±nda ÅŸifreleyerek gÃ¼venliÄŸi artÄ±rÄ±rken aynÄ± zamanda **veritabanÄ± performansÄ±nÄ± etkileyebileceÄŸini** Ã¶nemli bir ÅŸekilde belirtmek Ã¶nemlidir. Bu performans etkisi Ã¶zellikle MySQL ÅŸifreleme iÅŸlevleri veya Microsoft Transact-SQL ÅŸifreleme iÅŸlevleri ile birlikte kullanÄ±ldÄ±ÄŸÄ±nda fark edilir.

TDE'yi kullanmak iÃ§in belirli Ã¶n adÄ±mlar gereklidir:

1. **SeÃ§enek Grubu Ä°liÅŸkilendirme**:
- VeritabanÄ± bir seÃ§enek grubu ile iliÅŸkilendirilmelidir. SeÃ§enek gruplarÄ±, ayarlar ve Ã¶zellikler iÃ§in konteynerler olarak hizmet verir, gÃ¼venlik geliÅŸtirmeleri de dahil olmak Ã¼zere veritabanÄ± yÃ¶netimini kolaylaÅŸtÄ±rÄ±r.
- Ancak, seÃ§enek gruplarÄ±nÄ±n yalnÄ±zca belirli veritabanÄ± motorlarÄ± ve sÃ¼rÃ¼mleri iÃ§in mevcut olduÄŸunu unutmamak Ã¶nemlidir.

2. **SeÃ§enek Grubuna TDE Dahil Etme**:
- Bir seÃ§enek grubu ile iliÅŸkilendirildikten sonra, Oracle Åeffaf Veri Åifreleme seÃ§eneÄŸi o gruba dahil edilmelidir.
- TDE seÃ§eneÄŸi bir seÃ§enek grubuna eklendikten sonra, kalÄ±cÄ± bir Ã¶zellik haline gelir ve kaldÄ±rÄ±lamaz.

3. **TDE Åifreleme ModlarÄ±**:
- TDE iki farklÄ± ÅŸifreleme modu sunar:
- **TDE Tablespace Åifrelemesi**: Bu mod, tÃ¼m tablolarÄ± ÅŸifreler ve daha geniÅŸ bir veri koruma kapsamÄ± saÄŸlar.
- **TDE SÃ¼tun Åifrelemesi**: Bu mod, veritabanÄ± iÃ§inde belirli, bireysel Ã¶ÄŸeleri ÅŸifrelemeye odaklanarak hangi verilerin ÅŸifreleneceÄŸi konusunda daha ayrÄ±ntÄ±lÄ± kontrol saÄŸlar.

Bu Ã¶n koÅŸullarÄ± ve TDE'nin iÅŸletimsel inceliklerini anlamak, RDS iÃ§inde ÅŸifreleme etkin bir ÅŸekilde uygulamak ve yÃ¶netmek iÃ§in kritik Ã¶neme sahiptir, veri gÃ¼venliÄŸini saÄŸlamak ve gerekli standartlara uygunluÄŸu saÄŸlamak iÃ§in. 

### NumaralandÄ±rma

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Kimlik DoÄŸrulamasÄ±z EriÅŸim

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Ä°zin YÃ¼kseltme

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### SaldÄ±rÄ± SonrasÄ± Ä°ÅŸlemler

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### KalÄ±cÄ±lÄ±k

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Enjeksiyonu

DynamoDB verilerine **SQL sÃ¶zdizimi** ile eriÅŸmenin yollarÄ± vardÄ±r, bu nedenle tipik **SQL enjeksiyonlarÄ± da mÃ¼mkÃ¼ndÃ¼r**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi Twitter'da takip edin ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR'ler gÃ¶ndererek [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}
