# AWS - κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ (RDS) Enum

{% hint style="success" %}
AWS ν•΄ν‚Ή ν•™μµ λ° μ‹¤μµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP ν•΄ν‚Ή ν•™μµ λ° μ‹¤μµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks μ§€μ›</summary>

* [**κµ¬λ… μ”κΈμ **](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* **π’¬ [λ””μ¤μ½”λ“ κ·Έλ£Ή](https://discord.gg/hRep4RUj7f)** λλ” [ν…”λ κ·Έλ¨ κ·Έλ£Ή](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **νΈμ„ν„°** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**λ¥Ό ν”λ΅μ°**ν•μ„Έμ”.
* **HackTricks** λ° **HackTricks Cloud** κΉƒν—λΈ μ €μ¥μ†μ— PRμ„ μ μ¶ν•μ—¬ ν•΄ν‚Ή νΈλ¦­μ„ κ³µμ ν•μ„Έμ”.

</details>
{% endhint %}

## κΈ°λ³Έ μ •λ³΄

AWSμ—μ„ μ κ³µν•λ” **κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ„λΉ„μ¤ (RDS)**λ” **ν΄λΌμ°λ“μ—μ„ κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤μ λ°°ν¬, μ΄μ λ° ν™•μ¥μ„ κ°„μ†ν™”**ν•κΈ° μ„ν•΄ μ„¤κ³„λμ—μµλ‹λ‹¤. μ΄ μ„λΉ„μ¤λ” λΉ„μ© ν¨μ¨μ„±κ³Ό ν™•μ¥μ„±μ μ¥μ μ„ μ κ³µν•λ©΄μ„ ν•λ“μ›¨μ–΄ ν”„λ΅λΉ„μ €λ‹, λ°μ΄ν„°λ² μ΄μ¤ κµ¬μ„±, ν¨μΉ λ° λ°±μ—…κ³Ό κ°™μ€ λ…Έλ™ μ§‘μ•½μ  μ‘μ—…μ„ μλ™ν™”ν•©λ‹λ‹¤.

AWS RDSλ” MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server λ° Amazon Auroraλ¥Ό ν¬ν•¨ν• λ‹¤μ–‘ν• λ„λ¦¬ μ‚¬μ©λλ” κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„μ„ μ§€μ›ν•λ©° MySQL λ° PostgreSQL λ¨λ‘μ™€ νΈν™λ©λ‹λ‹¤.

RDSμ μ£Όμ” κΈ°λ¥μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

- **λ°μ΄ν„°λ² μ΄μ¤ μΈμ¤ν„΄μ¤ κ΄€λ¦¬**κ°€ κ°„μ†ν™”λ©λ‹λ‹¤.
- μ½κΈ° μ„±λ¥μ„ ν–¥μƒμ‹ν‚¤κΈ° μ„ν•΄ **μ½κΈ° μ „μ© λ³µμ λ³Έ**μ„ μƒμ„±ν•  μ μμµλ‹λ‹¤.
- κ³ κ°€μ©μ„± λ° μ¥μ•  μ΅°μΉ λ©”μ»¤λ‹μ¦μ„ λ³΄μ¥ν•κΈ° μ„ν•΄ **λ‹¤μ¤‘ κ°€μ© μμ—­ (AZ) λ°°ν¬**λ¥Ό κµ¬μ„±ν•  μ μμµλ‹λ‹¤.
- λ‹¤λ¥Έ AWS μ„λΉ„μ¤μ™€μ **ν†µν•©**, μλ¥Ό λ“¤μ–΄:
- κ²¬κ³ ν• μ•΅μ„Έμ¤ μ μ–΄λ¥Ό μ„ν• AWS Identity and Access Management (**IAM**).
- ν¬κ΄„μ μΈ λ¨λ‹ν„°λ§ λ° λ©”νΈλ¦­μ„ μ„ν• AWS **CloudWatch**.
- μ•μ •μ μΈ μ•”νΈν™”λ¥Ό μ„ν• AWS Key Management Service (**KMS**).

## μκ²© μ¦λ…

DB ν΄λ¬μ¤ν„°λ¥Ό μƒμ„±ν•  λ• λ§μ¤ν„° **μ‚¬μ©μ μ΄λ¦„**μ„ κµ¬μ„±ν•  μ μμµλ‹λ‹¤ (κΈ°λ³Έκ°’μ€ **`admin`**). μ΄ μ‚¬μ©μμ μ•”νΈλ¥Ό μƒμ„±ν•λ ¤λ©΄ λ‹¤μμ„ μν–‰ν•  μ μμµλ‹λ‹¤:

* μ§μ ‘ **μ•”νΈ**λ¥Ό μ§€μ •
* RDSμ—κ² **μλ™ μƒμ„±**ν•λ„λ΅ μ§€μ‹
* RDSμ—κ² KMS ν‚¤λ΅ μ•”νΈν™”λ **AWS Secret Manager**μ—μ„ κ΄€λ¦¬ν•λ„λ΅ μ§€μ‹

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### μΈμ¦

3κ°€μ§€ μ ν•μ μΈμ¦ μµμ…μ΄ μμ§€λ§ **λ§μ¤ν„° μ•”νΈλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ ν•­μƒ ν—μ©**λ©λ‹λ‹¤:

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### κ³µκ° μ•΅μ„Έμ¤ λ° VPC

κΈ°λ³Έμ μΌλ΅ λ°μ΄ν„°λ² μ΄μ¤μ—λ” **κ³µκ° μ•΅μ„Έμ¤κ°€ ν—μ©λμ§€ μ•μµλ‹λ‹¤**. κ·Έλ¬λ‚ **ν—μ©λ  μ μμµλ‹λ‹¤**. λ”°λΌμ„ κΈ°λ³Έμ μΌλ΅ λ™μΌν• VPCμ κΈ°κΈ°λ§ μ•΅μ„Έμ¤ν•  μ μμµλ‹λ‹¤. μ„ νƒν• **λ³΄μ• κ·Έλ£Ή** (EC2 SGμ— μ €μ¥λ¨)μ΄ ν—μ©ν•λ” κ²½μ°.

DB μΈμ¤ν„΄μ¤λ¥Ό λ…Έμ¶ν•λ” λ€μ‹  **RDS Proxy**λ¥Ό μƒμ„±ν•μ—¬ DB ν΄λ¬μ¤ν„°μ **ν™•μ¥μ„±** λ° **κ°€μ©μ„±**μ„ ν–¥μƒμ‹ν‚¬ μ μμµλ‹λ‹¤.

λν• **λ°μ΄ν„°λ² μ΄μ¤ ν¬νΈλ¥Ό μμ •**ν•  μλ„ μμµλ‹λ‹¤.

### μ•”νΈν™”

**μ•”νΈν™”λ” κΈ°λ³Έμ μΌλ΅ ν™μ„±ν™”**λμ–΄ μμΌλ©° AWS κ΄€λ¦¬ν• ν‚¤ (λ€μ‹  CMKλ¥Ό μ„ νƒν•  μ μμ)λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

μ•”νΈν™”λ¥Ό ν™μ„±ν™”ν•λ©΄ μ €μ¥μ†, μ¤λƒ…μƒ·, μ½κΈ° μ „μ© λ³µμ λ³Έ λ° λ°±μ—…μ— λ€ν• **μ•μ • μƒνƒμ μ•”νΈν™”κ°€ ν™μ„±ν™”**λ©λ‹λ‹¤. μ΄ μ•”νΈν™”λ¥Ό κ΄€λ¦¬ν•κΈ° μ„ν• ν‚¤λ” **KMS**λ¥Ό μ‚¬μ©ν•μ—¬ λ°κΈ‰ν•  μ μμµλ‹λ‹¤.\
μ΄ μμ¤€μ μ•”νΈν™”λ¥Ό λ°μ΄ν„°λ² μ΄μ¤κ°€ μƒμ„±λ ν›„μ— μ¶”κ°€ν•  μ μ—†μµλ‹λ‹¤. **μƒμ„± μ¤‘μ— μν–‰**ν•΄μ•Ό ν•©λ‹λ‹¤.

κ·Έλ¬λ‚ λ‹¤μκ³Ό κ°™μ΄ **μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ•”νΈν™”**ν•  μ μλ” ν•΄κ²°μ±…μ΄ μμµλ‹λ‹¤. μ•”νΈν™”λμ§€ μ•μ€ λ°μ΄ν„°λ² μ΄μ¤μ μ¤λƒ…μƒ·μ„ μƒμ„±ν•κ³  ν•΄λ‹Ή μ¤λƒ…μƒ·μ μ•”νΈν™”λ μ‚¬λ³Έμ„ μƒμ„±ν• λ‹¤μ ν•΄λ‹Ή μ•”νΈν™”λ μ¤λƒν”„μƒ·μ„ μ‚¬μ©ν•μ—¬ μƒ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μƒμ„±ν• ν›„, λ§μ§€λ§‰μΌλ΅ λ°μ΄ν„°λ² μ΄μ¤κ°€ μ•”νΈν™”λ©λ‹λ‹¤.

#### ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” (TDE)

RDSμ μ‘μ© ν”„λ΅κ·Έλ¨ μμ¤€μ—μ„ μ κ³µλλ” μ•”νΈν™” κΈ°λ¥κ³Ό ν•¨κ», RDSλ” Oracle λ° SQL Serverμ— λ€ν• **μ¶”κ°€ ν”λ«νΌ μμ¤€μ μ•”νΈν™” λ©”μ»¤λ‹μ¦**μ„ μ§€μ›ν•μ—¬ λ°μ΄ν„°λ¥Ό μ•μ •μ μΌλ΅ λ³΄νΈν•©λ‹λ‹¤. μ΄λ” Oracle λ° SQL Serverμ— λ€ν• **ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” (TDE)**λ¥Ό ν¬ν•¨ν•©λ‹λ‹¤. κ·Έλ¬λ‚ λ°μ΄ν„°λ¥Ό μ•μ •μ μΌλ΅ μ•”νΈν™”ν•μ—¬ λ³΄μ•μ„ κ°•ν™”ν•μ§€λ§ MySQL μ•”νΈν™” ν•¨μ λλ” Microsoft Transact-SQL μ•”νΈν™” ν•¨μμ™€ ν•¨κ» μ‚¬μ©ν•  λ• **λ°μ΄ν„°λ² μ΄μ¤ μ„±λ¥μ— μν–¥**μ„ μ¤„ μ μμµλ‹λ‹¤.

TDEλ¥Ό ν™μ©ν•λ ¤λ©΄ λ‹¤μκ³Ό κ°™μ€ μ΄κΈ° λ‹¨κ³„κ°€ ν•„μ”ν•©λ‹λ‹¤:

1. **μµμ… κ·Έλ£Ή μ—°κ²°**:
- λ°μ΄ν„°λ² μ΄μ¤λ” μµμ… κ·Έλ£Ήκ³Ό μ—°κ²°λμ–΄μ•Ό ν•©λ‹λ‹¤. μµμ… κ·Έλ£Ήμ€ λ³΄μ• ν–¥μƒμ„ ν¬ν•¨ν• λ°μ΄ν„°λ² μ΄μ¤ κ΄€λ¦¬λ¥Ό μ©μ΄ν•κ² ν•λ” μ„¤μ • λ° κΈ°λ¥μ μ»¨ν…μ΄λ„λ΅ μ‘μ©ν•©λ‹λ‹¤.
- κ·Έλ¬λ‚ μµμ… κ·Έλ£Ήμ€ νΉμ • λ°μ΄ν„°λ² μ΄μ¤ μ—”μ§„ λ° λ²„μ „μ—λ§ μ‚¬μ©ν•  μ μλ‹¤λ” μ μ„ μΈμ‹ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

2. **μµμ… κ·Έλ£Ήμ— TDE ν¬ν•¨**:
- μµμ… κ·Έλ£Ήκ³Ό μ—°κ²°λ ν›„, Oracle ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™” μµμ…μ„ ν•΄λ‹Ή κ·Έλ£Ήμ— ν¬ν•¨ν•΄μ•Ό ν•©λ‹λ‹¤.
- TDE μµμ…μ΄ μµμ… κ·Έλ£Ήμ— μ¶”κ°€λλ©΄ μκµ¬μ μΈ κµ¬μ„± μ”μ†κ°€ λμ–΄ μ κ±°ν•  μ μ—†μμ„ μΈμ‹ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤.

3. **TDE μ•”νΈν™” λ¨λ“**:
- TDEμ—λ” λ‘ κ°€μ§€ λ‹¤λ¥Έ μ•”νΈν™” λ¨λ“κ°€ μμµλ‹λ‹¤:
- **TDE ν…μ΄λΈ”μ¤νμ΄μ¤ μ•”νΈν™”**: μ΄ λ¨λ“λ” μ „μ²΄ ν…μ΄λΈ”μ„ μ•”νΈν™”ν•μ—¬ λ°μ΄ν„° λ³΄νΈ λ²”μ„λ¥Ό ν™•λ€ν•©λ‹λ‹¤.
- **TDE μ—΄ μ•”νΈν™”**: μ΄ λ¨λ“λ” λ°μ΄ν„°λ² μ΄μ¤ λ‚΄μ—μ„ νΉμ • κ°λ³„ μ”μ†λ¥Ό μ•”νΈν™”ν•μ—¬ μ–΄λ–¤ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν• μ§€μ— λ€ν• λ” μ„Έλ°€ν• μ μ–΄λ¥Ό μ κ³µν•©λ‹λ‹¤.

μ΄λ¬ν• μ„ ν–‰ μ΅°κ±΄κ³Ό TDEμ μ΄μμ  λ³µμ΅μ„±μ„ μ΄ν•΄ν•λ” κ²ƒμ€ RDS λ‚΄μ—μ„ μ•”νΈν™”λ¥Ό ν¨κ³Όμ μΌλ΅ κµ¬ν„ν•κ³  κ΄€λ¦¬ν•μ—¬ λ°μ΄ν„° λ³΄μ•κ³Ό ν•„μ”ν• ν‘μ¤€ μ¤€μλ¥Ό λ³΄μ¥ν•λ” λ° μ¤‘μ”ν•©λ‹λ‹¤.

### μ—΄κ±°

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### μΈμ¦λμ§€ μ•μ€ μ•΅μ„Έμ¤

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### κ¶ν• μƒμΉ

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### ν›„μ† κ³µκ²©

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### μ§€μ†μ„±

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injection

**SQL κµ¬λ¬Έ**μ„ μ‚¬μ©ν•μ—¬ DynamoDB λ°μ΄ν„°μ— μ•΅μ„Έμ¤ν•λ” λ°©λ²•μ΄ μμΌλ―€λ΅ μ „ν•μ μΈ **SQL μΈμ μ…λ„ κ°€λ¥**ν•©λ‹λ‹¤.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
AWS ν•΄ν‚Ή ν•™μµ λ° μ‹¤μµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP ν•΄ν‚Ή ν•™μµ λ° μ‹¤μµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks μ§€μ›</summary>

* [**κµ¬λ… μ”κΈμ **](https://github.com/sponsors/carlospolop)λ¥Ό ν™•μΈν•μ„Έμ”!
* π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— **μ°Έμ—¬**ν•κ±°λ‚ **νΈμ„ν„°** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**λ¥Ό ν”λ΅μ°**ν•μ„Έμ”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) λ° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) κΉƒν—™ λ ν¬μ§€ν† λ¦¬μ— PRμ„ μ μ¶ν•μ—¬ ν•΄ν‚Ή νΈλ¦­μ„ κ³µμ ν•μ„Έμ”.

</details>
{% endhint %}
