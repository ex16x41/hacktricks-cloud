# AWS - Relacijska baza podataka (RDS) Enum

{% hint style="success" %}
NauÄite i veÅ¾bajte hakovanje AWS-a:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
NauÄite i veÅ¾bajte hakovanje GCP-a: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Osnovne informacije

**Relacijska baza podataka (RDS)** koju nudi AWS dizajnirana je da olakÅ¡a implementaciju, operaciju i skaliranje **relacione baze podataka u oblaku**. Ova usluga nudi prednosti u pogledu efikasnosti troÅ¡kova i skalabilnosti dok automatizuje zadatke koji zahtevaju puno rada, poput obezbeÄ‘ivanja hardvera, konfiguracije baze podataka, zakrpa i rezervnih kopija.

AWS RDS podrÅ¾ava razliÄite Å¡iroko koriÅ¡Ä‡ene motore relacijskih baza podataka, ukljuÄujuÄ‡i MySQL, PostgreSQL, MariaDB, Oracle Database, Microsoft SQL Server i Amazon Aurora, sa kompatibilnoÅ¡Ä‡u za MySQL i PostgreSQL.

KljuÄne karakteristike RDS-a ukljuÄuju:

- Pojednostavljenje **upravljanja instancama baze podataka**.
- Kreiranje **read replika** radi poboljÅ¡anja performansi Äitanja.
- Konfiguracija **multi-Availability Zone (AZ) implementacija** radi obezbeÄ‘ivanja visoke dostupnosti i mehanizama preusmeravanja.
- **Integracija** sa drugim AWS uslugama, kao Å¡to su:
- AWS Identity and Access Management (**IAM**) za snaÅ¾nu kontrolu pristupa.
- AWS **CloudWatch** za sveobuhvatno praÄ‡enje i metrike.
- AWS Key Management Service (**KMS**) za obezbeÄ‘ivanje Å¡ifrovanja u mirovanju.

## Kredencijali

Prilikom kreiranja DB klastera, glavno **korisniÄko ime** moÅ¾e se konfigurisati (podrazumevano je **`admin`**). Da biste generisali lozinku ovog korisnika, moÅ¾ete:

* **Navesti** lozinku sami
* Recite RDS-u da je **automatski generiÅ¡e**
* Recite RDS-u da je upravlja u **AWS Secret Manageru** Å¡ifrovano sa KMS kljuÄem

<figure><img src="../../../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

### Autentikacija

Postoje 3 vrste opcija za autentikaciju, ali koriÅ¡Ä‡enje **glavne lozinke je uvek dozvoljeno**:

<figure><img src="../../../../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

### Javni pristup & VPC

Podrazumevano **nema javnog pristupa** bazama podataka, meÄ‘utim, **moÅ¾e se omoguÄ‡iti**. Stoga, podrazumevano samo maÅ¡ine iz iste VPC Ä‡e moÄ‡i da joj pristupe ako odabrana **sigurnosna grupa** (koje se Äuvaju u EC2 SG) to dozvoljava.

Umesto izlaganja DB instance, moguÄ‡e je kreirati **RDS Proxy** koji **unapreÄ‘uje** **skalabilnost** i **dostupnost** DB klastera.

TakoÄ‘e, **port baze podataka se moÅ¾e izmeniti**.

### Å ifrovanje

**Å ifrovanje je podrazumevano omoguÄ‡eno** koriÅ¡Ä‡enjem AWS upravljanih kljuÄeva (umesto toga moÅ¾e se izabrati CMK).

OmoguÄ‡avanjem Å¡ifrovanja, omoguÄ‡avate **Å¡ifrovanje u mirovanju za vaÅ¡e skladiÅ¡te, snimke, read replike i rezervne kopije**. KljuÄevi za upravljanje ovim Å¡ifrovanjem mogu se izdati koriÅ¡Ä‡enjem **KMS**-a.\
Nije moguÄ‡e dodati ovaj nivo Å¡ifrovanja nakon Å¡to je vaÅ¡a baza podataka kreirana. **To se mora uraditi tokom njenog kreiranja**.

MeÄ‘utim, postoji **obilaÅ¾enje koje vam omoguÄ‡ava da Å¡ifrujete neÅ¡ifrovanu bazu podataka na sledeÄ‡i naÄin**. MoÅ¾ete kreirati snimak vaÅ¡e neÅ¡ifrovane baze podataka, kreirati Å¡ifrovanu kopiju tog snimka, koristiti taj Å¡ifrovani snimak da kreirate novu bazu podataka, a zatim, na kraju, vaÅ¡a baza podataka biÄ‡e Å¡ifrovana.

#### Transparentno Å¡ifrovanje podataka (TDE)

Pored sposobnosti Å¡ifrovanja inherentnih RDS-u na nivou aplikacije, RDS takoÄ‘e podrÅ¾ava **dodatne mehanizme Å¡ifrovanja na platformi** radi zaÅ¡tite podataka u mirovanju. To ukljuÄuje **Transparentno Å¡ifrovanje podataka (TDE)** za Oracle i SQL Server. MeÄ‘utim, vaÅ¾no je napomenuti da dok TDE unapreÄ‘uje bezbednost Å¡ifrovanjem podataka u mirovanju, moÅ¾e takoÄ‘e **uticati na performanse baze podataka**. Ovaj uticaj na performanse posebno je primetan kada se koristi u kombinaciji sa MySQL kriptografskim funkcijama ili Microsoft Transact-SQL kriptografskim funkcijama.

Da biste koristili TDE, potrebni su odreÄ‘eni preliminarni koraci:

1. **Asocijacija grupe opcija**:
- Baza podataka mora biti povezana sa grupom opcija. Grupe opcija sluÅ¾e kao kontejneri za podeÅ¡avanja i funkcije, olakÅ¡avajuÄ‡i upravljanje bazom podataka, ukljuÄujuÄ‡i bezbednosna unapreÄ‘enja.
- MeÄ‘utim, vaÅ¾no je napomenuti da su grupe opcija dostupne samo za odreÄ‘ene motore baza podataka i verzije.

2. **UkljuÄivanje TDE-a u grupu opcija**:
- Jednom kada je povezan sa grupom opcija, opcija Transparentnog Å¡ifrovanja podataka za Oracle mora biti ukljuÄena u tu grupu.
- VaÅ¾no je prepoznati da kada se TDE opcija doda grupi opcija, postaje trajni element i ne moÅ¾e se ukloniti.

3. **TDE reÅ¾imi Å¡ifrovanja**:
- TDE nudi dva razliÄita reÅ¾ima Å¡ifrovanja:
- **Å ifrovanje tabele TDE**: Ovaj reÅ¾im Å¡ifruje cele tabele, pruÅ¾ajuÄ‡i Å¡iri opseg zaÅ¡tite podataka.
- **Å ifrovanje kolone TDE**: Ovaj reÅ¾im se fokusira na Å¡ifrovanje odreÄ‘enih, pojedinaÄnih elemenata unutar baze podataka, omoguÄ‡avajuÄ‡i precizniju kontrolu nad tim koje podatke su Å¡ifrovani.

Razumevanje ovih preduslova i operativnih sloÅ¾enosti TDE-a kljuÄno je za efikasnu implementaciju i upravljanje Å¡ifrovanjem unutar RDS-a, obezbeÄ‘ujuÄ‡i kako bezbednost podataka, tako i usklaÄ‘enost sa neophodnim standardima.

### Enumeracija

{% code overflow="wrap" %}
```bash
# Clusters info
## Get Endpoints, username, port, iam auth enabled, attached roles, SG
aws rds describe-db-clusters
aws rds describe-db-cluster-endpoints #Cluster URLs
aws rds describe-db-cluster-backtracks --db-cluster-identifier <cluster-name>

## Cluster snapshots
aws rds describe-db-cluster-snapshots

# Get DB instances info
aws rds describe-db-instances #username, url, port, vpc, SG, is public?
aws rds describe-db-security-groups

## Find automated backups
aws rds describe-db-instance-automated-backups

## Find snapshots
aws rds describe-db-snapshots
aws rds describe-db-snapshots --include-public --snapshot-type public
## Restore snapshot as new instance
aws rds restore-db-instance-from-db-snapshot --db-instance-identifier <ID> --db-snapshot-identifier <ID> --availability-zone us-west-2a

# Any public snapshot in the account
aws rds describe-db-snapshots --snapshot-type public

# Proxies
aws rds describe-db-proxy-endpoints
aws rds describe-db-proxy-target-groups
aws rds describe-db-proxy-targets

## reset credentials of MasterUsername
aws rds modify-db-instance --db-instance-identifier <ID> --master-user-password <NewPassword> --apply-immediately
```
{% endcode %}

### Neautentifikovan pristup

{% content-ref url="../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md" %}
[aws-rds-unauthenticated-enum.md](../../aws-unauthenticated-enum-access/aws-rds-unauthenticated-enum.md)
{% endcontent-ref %}

### Privesc

{% content-ref url="../../aws-privilege-escalation/aws-rds-privesc.md" %}
[aws-rds-privesc.md](../../aws-privilege-escalation/aws-rds-privesc.md)
{% endcontent-ref %}

### Post Eksploatacija

{% content-ref url="../../aws-post-exploitation/aws-rds-post-exploitation.md" %}
[aws-rds-post-exploitation.md](../../aws-post-exploitation/aws-rds-post-exploitation.md)
{% endcontent-ref %}

### Upornost

{% content-ref url="../../aws-persistence/aws-rds-persistence.md" %}
[aws-rds-persistence.md](../../aws-persistence/aws-rds-persistence.md)
{% endcontent-ref %}

### SQL Injection

Postoje naÄini za pristup podacima DynamoDB-a sa **SQL sintaksom**, stoga su moguÄ‡i i tipiÄni **SQL injection napadi**.

{% embed url="https://book.hacktricks.xyz/pentesting-web/sql-injection" %}

{% hint style="success" %}
NauÄite i veÅ¾bajte hakovanje AWS-a:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
NauÄite i veÅ¾bajte hakovanje GCP-a: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili **telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
