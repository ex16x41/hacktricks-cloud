# AWS - ECR Enum

## AWS - ECR Enum

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╕реЗ рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

### ECR

#### рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

Amazon **Elastic Container Registry** (Amazon ECR) рдПрдХ **рдкреНрд░рдмрдВрдзрд┐рдд рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗрд╡рд╛** рд╣реИред рдЗрд╕реЗ рдПрдХ рдРрд╕рд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдЧреНрд░рд╛рд╣рдХ рдЕрдкрдиреЗ рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рдХреЗ рд╕рд╛рде рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЬреНрдЮрд╛рдд рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рддрдЪреАрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, Docker CLI рдпрд╛ рдХрд┐рд╕реА рднреА рдкрд╕рдВрджреАрджрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдорд░реНрдерд┐рдд рд╣реИ, рдЬреЛ рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рдХреЛ рдкреБрд╢, рдкреБрд▓ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдЬреИрд╕реА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИред

ECR 2 рдкреНрд░рдХрд╛рд░ рдХреА рд╡рд╕реНрддреБрдУрдВ рд╕реЗ рдмрдирд╛ рд╣реИ: **рд░рдЬрд┐рд╕реНрдЯреНрд░реА** рдФрд░ **рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА**ред

**рд░рдЬрд┐рд╕реНрдЯреНрд░реА**

рд╣рд░ AWS рдЦрд╛рддреЗ рдореЗрдВ 2 рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╣реЛрддреА рд╣реИрдВ: **рдирд┐рдЬреА** рдФрд░ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ**ред

1. **рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА**:

* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рдЬреА**: Amazon ECR рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ **рдХреЗрд╡рд▓ рдЕрдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ** рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЗ AWS рдЦрд╛рддреЗ рдХреЗ рднреАрддрд░ рд╣реИрдВ рдпрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рд╣реИред
* рдПрдХ **рдирд┐рдЬреА рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА** рдХрд╛ URI рдЗрд╕ рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддрд╛ рд╣реИ `<account_id>.dkr.ecr.<region>.amazonaws.com/<repo-name>`
* **рдПрдХреНрд╕реЗрд╕ рдирд┐рдпрдВрддреНрд░рдг**: рдЖрдк **IAM рдиреАрддрд┐рдпреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреА рдирд┐рдЬреА рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ рддрдХ рдкрд╣реБрдБрдЪ рдХреЛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдпрд╛ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдмрд╛рд░реАрдХ рдЕрдиреБрдорддрд┐ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **AWS рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг**: Amazon ECR рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЛ рдЕрдиреНрдп AWS рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЖрд╕рд╛рдиреА рд╕реЗ **рдПрдХреАрдХреГрдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ EKS, ECS...
* **рдЕрдиреНрдп рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╡рд┐рдХрд▓реНрдк**:
* рдЯреИрдЧ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдпрддрд╛ рдХреЙрд▓рдо рдЗрд╕рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдЯреИрдЧ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдпрддрд╛ рд╕рдХреНрд╖рдо рд╣реИ рддреЛ рдпрд╣ **рдкреВрд░реНрд╡-рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдЯреИрдЧ** рдХреЗ рд╕рд╛рде рдЗрдореЗрдЬ **рдкреБрд╢** рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рд╕реЗ **рд░реЛрдХ рджреЗрдЧрд╛**ред
* **рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдкреНрд░рдХрд╛рд░** рдХреЙрд▓рдо рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдХреА рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдкреНрд░рдХрд╛рд░ рдЬреИрд╕реЗ AES-256 рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рдпрд╛ **KMS** рд╕рдХреНрд╖рдо рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рд╣реИред
* **рдкреБрд▓ рдереНрд░реВ рдХреИрд╢** рдХреЙрд▓рдо рдЗрд╕рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдкреБрд▓ рдереНрд░реВ рдХреИрд╢ рд╕реНрдерд┐рддрд┐ рд╕рдХреНрд░рд┐рдп рд╣реИ рддреЛ рдпрд╣ **рдЖрдкрдХреА рдирд┐рдЬреА рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ рдПрдХ рдмрд╛рд╣рд░реА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдХреЛ рдХреИрд╢ рдХрд░реЗрдЧрд╛**ред
* рд╡рд┐рд╢рд┐рд╖реНрдЯ **IAM рдиреАрддрд┐рдпреЛрдВ** рдХреЛ рд╡рд┐рднрд┐рдиреНрди **рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреЛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рдЗрдореЗрдЬ рдореЗрдВ рднреЗрджреНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдХреЗ рдЕрдВрджрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВред

2. **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА**:

* **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкрд╣реБрдВрдЪ**: ECR рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬ **рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрд▓рдмреНрдз рд╣реИрдВред**
* рдПрдХ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА** рдХрд╛ URI рдЗрд╕ рддрд░рд╣ рд╣реИ `public.ecr.aws/<random>/<name>`ред рд╣рд╛рд▓рд╛рдВрдХрд┐ `<random>` рднрд╛рдЧ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рджреНрд╡рд╛рд░рд╛ рдпрд╛рдж рд░рдЦрдиреЗ рдореЗрдВ рдЖрд╕рд╛рди рдХрд┐рд╕реА рдЕрдиреНрдп рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА**

рдпреЗ **рдЗрдореЗрдЬ** рд╣реИрдВ рдЬреЛ **рдирд┐рдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА** рдореЗрдВ рдпрд╛ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ** рдореЗрдВ рд╣реИрдВред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ рдЗрдореЗрдЬ рдХреЛ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **ECR рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдХрд╛ рдирд╛рдо рдЗрдореЗрдЬ рдХреЗ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП**ред
{% endhint %}

#### рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдФрд░ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдиреАрддрд┐рдпрд╛рдБ

**рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдФрд░ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА** рдХреЗ рдкрд╛рд╕ **рдЕрдиреНрдп рдкреНрд░рд┐рдВрд╕рд┐рдкрд▓/рдЦрд╛рддреЛрдВ рдХреЛ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдиреАрддрд┐рдпрд╛рдБ** рднреА рд╣реЛрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдиреАрддрд┐ рдЫрд╡рд┐ рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рд╕рдВрдЧрдарди рдХреЗ рдкреВрд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдореЗрдЬ рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВрдЧреЗ:

<figure><img src="../../../.gitbook/assets/image (280).png" alt=""><figcaption></figcaption></figure>

#### рдЧрдгрдирд╛

{% code overflow="wrap" %}
```bash
# Get repos
aws ecr describe-repositories
aws ecr describe-registry

# Get image metadata
aws ecr list-images --repository-name <repo_name>
aws ecr describe-images --repository-name <repo_name>
aws ecr describe-image-replication-status --repository-name <repo_name> --image-id <image_id>
aws ecr describe-image-scan-findings --repository-name <repo_name> --image-id <image_id>
aws ecr describe-pull-through-cache-rules --repository-name <repo_name> --image-id <image_id>

# Get public repositories
aws ecr-public describe-repositories

# Get policies
aws ecr get-registry-policy
aws ecr get-repository-policy --repository-name <repo_name>
```
{% endcode %}

#### рдЕрдирдзрд┐рдХреГрдд Enum

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md" %}
[aws-ecr-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md)
{% endcontent-ref %}

#### рдкреНрд░рд┐рд╡реЗрд╕реНрдХ

рдЕрдЧрд▓реА рдкреГрд╖реНрда рдкрд░ рдЖрдк **ECR рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдиреЗ** рдХреЗ рддрд░реАрдХреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="../aws-privilege-escalation/aws-ecr-privesc.md" %}
[aws-ecr-privesc.md](../aws-privilege-escalation/aws-ecr-privesc.md)
{% endcontent-ref %}

#### рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

{% content-ref url="../aws-post-exploitation/aws-ecr-post-exploitation.md" %}
[aws-ecr-post-exploitation.md](../aws-post-exploitation/aws-ecr-post-exploitation.md)
{% endcontent-ref %}

#### рд╕реНрдерд┐рд░рддрд╛

{% content-ref url="../aws-persistence/aws-ecr-persistence.md" %}
[aws-ecr-persistence.md](../aws-persistence/aws-ecr-persistence.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html](https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html)

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks_live)** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред**

</details>
{% endhint %}
