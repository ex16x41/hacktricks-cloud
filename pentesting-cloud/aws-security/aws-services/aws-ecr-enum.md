# AWS - ECR Enum

## AWS - ECR Enum

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter**ì—ì„œ **íŒ”ë¡œìš°**í•˜ì„¸ìš”** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **HackTricks** ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}

### ECR

#### ê¸°ë³¸ ì •ë³´

Amazon **Elastic Container Registry** (Amazon ECR)ëŠ” **ê´€ë¦¬í˜• ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ê³ ê°ì´ ì˜ ì•Œë ¤ì§„ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì œê³µí•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ, Docker CLI ë˜ëŠ” ì„ í˜¸í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ í‘¸ì‹œ, í’€ ë° ê´€ë¦¬í•˜ëŠ” í™œë™ì„ ì§€ì›í•©ë‹ˆë‹¤.

ECRì€ **ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì™€ **ë¦¬í¬ì§€í† ë¦¬**ì˜ 2ê°€ì§€ ìœ í˜•ì˜ ê°ì²´ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

**ë ˆì§€ìŠ¤íŠ¸ë¦¬**

ëª¨ë“  AWS ê³„ì •ì—ëŠ” 2ê°œì˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤: **í”„ë¼ì´ë¹—** ë° **í¼ë¸”ë¦­**.

1. **í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬**:

* **ê¸°ë³¸ì ìœ¼ë¡œ í”„ë¼ì´ë¹—**: Amazon ECR í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ëŠ” **ê·€í•˜ì˜ AWS ê³„ì • ë‚´ì—ì„œ ê¶Œí•œì´ ë¶€ì—¬ëœ ì‚¬ìš©ì**ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **í”„ë¼ì´ë¹— ë¦¬í¬ì§€í† ë¦¬**ì˜ URIëŠ” `<account_id>.dkr.ecr.<region>.amazonaws.com/<repo-name>` í˜•ì‹ì„ ë”°ë¦…ë‹ˆë‹¤.
* **ì ‘ê·¼ ì œì–´**: **IAM ì •ì±…**ì„ ì‚¬ìš©í•˜ì—¬ í”„ë¼ì´ë¹— ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì— ëŒ€í•œ **ì ‘ê·¼ì„ ì œì–´**í•  ìˆ˜ ìˆìœ¼ë©°, ì‚¬ìš©ì ë˜ëŠ” ì—­í• ì— ë”°ë¼ ì„¸ë¶„í™”ëœ ê¶Œí•œì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **AWS ì„œë¹„ìŠ¤ì™€ì˜ í†µí•©**: Amazon ECR í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ëŠ” EKS, ECS ë“±ê³¼ ê°™ì€ ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ì™€ ì‰½ê²Œ **í†µí•©**ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ê¸°íƒ€ í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì˜µì…˜**:
* íƒœê·¸ ë¶ˆë³€ì„± ì—´ì€ ìƒíƒœë¥¼ ë‚˜ì—´í•˜ë©°, íƒœê·¸ ë¶ˆë³€ì„±ì´ í™œì„±í™”ë˜ë©´ **ê¸°ì¡´ íƒœê·¸**ë¡œ ì´ë¯¸ì§€ **í‘¸ì‹œ**ê°€ ì´ë¯¸ì§€ë¥¼ ë®ì–´ì“°ëŠ” ê²ƒì„ **ë°©ì§€**í•©ë‹ˆë‹¤.
* **ì•”í˜¸í™” ìœ í˜•** ì—´ì€ ë¦¬í¬ì§€í† ë¦¬ì˜ ì•”í˜¸í™” ì†ì„±ì„ ë‚˜ì—´í•˜ë©°, AES-256ê³¼ ê°™ì€ ê¸°ë³¸ ì•”í˜¸í™” ìœ í˜•ì„ ë³´ì—¬ì£¼ê±°ë‚˜ **KMS**ê°€ í™œì„±í™”ëœ ì•”í˜¸í™”ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **í’€ ìŠ¤ë£¨ ìºì‹œ** ì—´ì€ ìƒíƒœë¥¼ ë‚˜ì—´í•˜ë©°, í’€ ìŠ¤ë£¨ ìºì‹œ ìƒíƒœê°€ í™œì„±í™”ë˜ë©´ **ì™¸ë¶€ í¼ë¸”ë¦­ ë¦¬í¬ì§€í† ë¦¬ì˜ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ê·€í•˜ì˜ í”„ë¼ì´ë¹— ë¦¬í¬ì§€í† ë¦¬ì— ìºì‹œ**í•©ë‹ˆë‹¤.
* íŠ¹ì • **IAM ì •ì±…**ì„ êµ¬ì„±í•˜ì—¬ ë‹¤ì–‘í•œ **ê¶Œí•œ**ì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ìŠ¤ìºë‹ êµ¬ì„±**ì€ ë¦¬í¬ì§€í† ë¦¬ì— ì €ì¥ëœ ì´ë¯¸ì§€ì˜ ì·¨ì•½ì ì„ ìŠ¤ìº”í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

2. **í¼ë¸”ë¦­ ë ˆì§€ìŠ¤íŠ¸ë¦¬**:

* **í¼ë¸”ë¦­ ì ‘ê·¼ì„±**: ECR í¼ë¸”ë¦­ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ëœ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ëŠ” **ì¸í„°ë„·ì˜ ëˆ„êµ¬ë‚˜ ì¸ì¦ ì—†ì´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**
* **í¼ë¸”ë¦­ ë¦¬í¬ì§€í† ë¦¬**ì˜ URIëŠ” `public.ecr.aws/<random>/<name>`ê³¼ ê°™ìŠµë‹ˆë‹¤. `<random>` ë¶€ë¶„ì€ ê´€ë¦¬ìê°€ ê¸°ì–µí•˜ê¸° ì‰¬ìš´ ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë¦¬í¬ì§€í† ë¦¬**

ì´ê²ƒë“¤ì€ **í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬** ë˜ëŠ” **í¼ë¸”ë¦­**ì— ìˆëŠ” **ì´ë¯¸ì§€**ì…ë‹ˆë‹¤.

{% hint style="info" %}
ë¦¬í¬ì§€í† ë¦¬ì— ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë ¤ë©´ **ECR ë¦¬í¬ì§€í† ë¦¬ê°€ ì´ë¯¸ì§€ì™€ ë™ì¼í•œ ì´ë¦„ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤**.
{% endhint %}

#### ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë° ë¦¬í¬ì§€í† ë¦¬ ì •ì±…

**ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë° ë¦¬í¬ì§€í† ë¦¬**ëŠ” **ë‹¤ë¥¸ ì£¼ì²´/ê³„ì •ì— ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì •ì±…**ë„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒ ë¦¬í¬ì§€í† ë¦¬ ì •ì±… ì´ë¯¸ì§€ì—ì„œ ì „ì²´ ì¡°ì§ì˜ ëª¨ë“  ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ë¥¼ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../../.gitbook/assets/image (280).png" alt=""><figcaption></figcaption></figure>

#### ì—´ê±°

{% code overflow="wrap" %}
```bash
# Get repos
aws ecr describe-repositories
aws ecr describe-registry

# Get image metadata
aws ecr list-images --repository-name <repo_name>
aws ecr describe-images --repository-name <repo_name>
aws ecr describe-image-replication-status --repository-name <repo_name> --image-id <image_id>
aws ecr describe-image-scan-findings --repository-name <repo_name> --image-id <image_id>
aws ecr describe-pull-through-cache-rules --repository-name <repo_name> --image-id <image_id>

# Get public repositories
aws ecr-public describe-repositories

# Get policies
aws ecr get-registry-policy
aws ecr get-repository-policy --repository-name <repo_name>
```
{% endcode %}

#### ì¸ì¦ë˜ì§€ ì•Šì€ ì—´ê±°

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md" %}
[aws-ecr-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md)
{% endcontent-ref %}

#### ê¶Œí•œ ìƒìŠ¹

ë‹¤ìŒ í˜ì´ì§€ì—ì„œ **ECR ê¶Œí•œì„ ì•…ìš©í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¤ëŠ” ë°©ë²•**ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../aws-privilege-escalation/aws-ecr-privesc.md" %}
[aws-ecr-privesc.md](../aws-privilege-escalation/aws-ecr-privesc.md)
{% endcontent-ref %}

#### í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì‡

{% content-ref url="../aws-post-exploitation/aws-ecr-post-exploitation.md" %}
[aws-ecr-post-exploitation.md](../aws-post-exploitation/aws-ecr-post-exploitation.md)
{% endcontent-ref %}

#### ì§€ì†ì„±

{% content-ref url="../aws-persistence/aws-ecr-persistence.md" %}
[aws-ecr-persistence.md](../aws-persistence/aws-ecr-persistence.md)
{% endcontent-ref %}

## ì°¸ê³ ìë£Œ

* [https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html](https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html)

{% hint style="success" %}
AWS í•´í‚¹ì„ ë°°ìš°ê³  ì—°ìŠµí•˜ì„¸ìš”:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ì„ ë°°ìš°ê³  ì—°ìŠµí•˜ì„¸ìš”: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
