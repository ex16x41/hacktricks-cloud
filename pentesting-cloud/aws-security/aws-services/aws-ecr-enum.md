# AWS - ECR Enum

## AWS - ECR Enum

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)** takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n,** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶ndererek.

</details>
{% endhint %}

### ECR

#### Temel Bilgiler

Amazon **Elastic Container Registry** (Amazon ECR), **yÃ¶netilen bir konteyner gÃ¶rÃ¼ntÃ¼ kayÄ±t hizmetidir**. MÃ¼ÅŸterilerin konteyner gÃ¶rÃ¼ntÃ¼leriyle tanÄ±nmÄ±ÅŸ arayÃ¼zler kullanarak etkileÅŸimde bulunabilecekleri bir ortam saÄŸlamak iÃ§in tasarlanmÄ±ÅŸtÄ±r. Ã–zellikle, Docker CLI veya tercih edilen herhangi bir istemcinin kullanÄ±mÄ± desteklenir ve bu, gÃ¶rÃ¼ntÃ¼leri itme, Ã§ekme ve yÃ¶netme gibi etkinlikleri mÃ¼mkÃ¼n kÄ±lar.

ECR, 2 tÃ¼r nesneden oluÅŸur: **KayÄ±tlar** ve **Depolar**.

**KayÄ±tlar**

Her AWS hesabÄ±nÄ±n 2 kaydÄ± vardÄ±r: **Ã–zel** ve **Halka AÃ§Ä±k**.

1. **Ã–zel KayÄ±tlar**:

* **VarsayÄ±lan olarak Ã¶zel**: Amazon ECR Ã¶zel kaydÄ±nda depolanan konteyner gÃ¶rÃ¼ntÃ¼leri, yalnÄ±zca AWS hesabÄ±nÄ±zdaki yetkili kullanÄ±cÄ±lar veya izin verilmiÅŸ olanlar tarafÄ±ndan **eriÅŸilebilir**.
* Bir **Ã¶zel depo** URI'si `<account_id>.dkr.ecr.<region>.amazonaws.com/<repo-name>` formatÄ±nÄ± takip eder.
* **EriÅŸim kontrolÃ¼**: Ã–zel konteyner gÃ¶rÃ¼ntÃ¼lerinize eriÅŸimi **IAM politikalarÄ±** kullanarak **kontrol edebilirsiniz** ve kullanÄ±cÄ±lar veya roller bazÄ±nda ince ayar izinleri yapÄ±landÄ±rabilirsiniz.
* **AWS hizmetleriyle entegrasyon**: Amazon ECR Ã¶zel kayÄ±tlarÄ±, EKS, ECS gibi diÄŸer AWS hizmetleriyle kolayca **entegrasyon** saÄŸlayabilir.
* **DiÄŸer Ã¶zel kayÄ±t seÃ§enekleri**:
* Etiket deÄŸiÅŸmezliÄŸi sÃ¼tunu, etiket deÄŸiÅŸmezliÄŸi etkinleÅŸtirildiÄŸinde, **Ã¶nceden var olan etiketlerle** gÃ¶rÃ¼ntÃ¼ **itmelerinin** Ã¼zerine yazÄ±lmasÄ±nÄ± **Ã¶nleyecektir**.
* **Åifreleme tÃ¼rÃ¼** sÃ¼tunu, deponun ÅŸifreleme Ã¶zelliklerini listeler, varsayÄ±lan ÅŸifreleme tÃ¼rleri olarak AES-256 gibi veya **KMS** etkin ÅŸifrelemeleri gÃ¶sterir.
* **Ã–nbellek Ã¼zerinden Ã§ekme** sÃ¼tunu, durumunu listeler, Ã–nbellek Ã¼zerinden Ã§ekme durumu Aktif ise, **dÄ±ÅŸ bir halka aÃ§Ä±k depodaki depolarÄ± Ã¶zel deponuza Ã¶nbelleÄŸe alÄ±r**.
* FarklÄ± **izinler** vermek iÃ§in belirli **IAM politikalarÄ±** yapÄ±landÄ±rÄ±labilir.
* **Tarama yapÄ±landÄ±rmasÄ±**, depoda saklanan gÃ¶rÃ¼ntÃ¼lerdeki gÃ¼venlik aÃ§Ä±klarÄ±nÄ± taramak iÃ§in olanak tanÄ±r.

2. **Halka AÃ§Ä±k KayÄ±tlar**:

* **Halka aÃ§Ä±k eriÅŸim**: ECR Halka AÃ§Ä±k kaydÄ±nda depolanan konteyner gÃ¶rÃ¼ntÃ¼leri, **kimlik doÄŸrulama olmaksÄ±zÄ±n internetteki herkes tarafÄ±ndan eriÅŸilebilir.**
* Bir **halka aÃ§Ä±k depo** URI'si `public.ecr.aws/<random>/<name>` gibidir. `<random>` kÄ±smÄ±, yÃ¶netici tarafÄ±ndan hatÄ±rlanmasÄ± daha kolay baÅŸka bir dize ile deÄŸiÅŸtirilebilir.

**Depolar**

Bunlar, **Ã¶zel kayÄ±tta** veya **halka aÃ§Ä±k** olan **gÃ¶rÃ¼ntÃ¼lerdir**.

{% hint style="info" %}
Bir gÃ¶rÃ¼ntÃ¼yÃ¼ bir depoya yÃ¼klemek iÃ§in, **ECR deposunun gÃ¶rÃ¼ntÃ¼yle aynÄ± adÄ± taÅŸÄ±masÄ± gerektiÄŸini** unutmayÄ±n.
{% endhint %}

#### KayÄ±t & Depo PolitikalarÄ±

**KayÄ±tlar ve depolar**, diÄŸer ilkeler/hesaplar iÃ§in izin vermek amacÄ±yla kullanÄ±labilecek **politikalar** da taÅŸÄ±r. Ã–rneÄŸin, aÅŸaÄŸÄ±daki depo politikasÄ± gÃ¶rÃ¼ntÃ¼sÃ¼nde, tÃ¼m organizasyondan herhangi bir kullanÄ±cÄ±nÄ±n gÃ¶rÃ¼ntÃ¼ye eriÅŸebileceÄŸini gÃ¶rebilirsiniz:

<figure><img src="../../../.gitbook/assets/image (280).png" alt=""><figcaption></figcaption></figure>

#### SayÄ±m

{% code overflow="wrap" %}
```bash
# Get repos
aws ecr describe-repositories
aws ecr describe-registry

# Get image metadata
aws ecr list-images --repository-name <repo_name>
aws ecr describe-images --repository-name <repo_name>
aws ecr describe-image-replication-status --repository-name <repo_name> --image-id <image_id>
aws ecr describe-image-scan-findings --repository-name <repo_name> --image-id <image_id>
aws ecr describe-pull-through-cache-rules --repository-name <repo_name> --image-id <image_id>

# Get public repositories
aws ecr-public describe-repositories

# Get policies
aws ecr get-registry-policy
aws ecr get-repository-policy --repository-name <repo_name>
```
{% endcode %}

#### Kimlik DoÄŸrulamasÄ±z Enum

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md" %}
[aws-ecr-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecr-unauthenticated-enum.md)
{% endcontent-ref %}

#### Privesc

AÅŸaÄŸÄ±daki sayfada **ECR izinlerini kÃ¶tÃ¼ye kullanarak ayrÄ±calÄ±klarÄ± artÄ±rma** yÃ¶ntemini kontrol edebilirsiniz:

{% content-ref url="../aws-privilege-escalation/aws-ecr-privesc.md" %}
[aws-ecr-privesc.md](../aws-privilege-escalation/aws-ecr-privesc.md)
{% endcontent-ref %}

#### Ä°stismar SonrasÄ±

{% content-ref url="../aws-post-exploitation/aws-ecr-post-exploitation.md" %}
[aws-ecr-post-exploitation.md](../aws-post-exploitation/aws-ecr-post-exploitation.md)
{% endcontent-ref %}

#### SÃ¼reklilik

{% content-ref url="../aws-persistence/aws-ecr-persistence.md" %}
[aws-ecr-persistence.md](../aws-persistence/aws-ecr-persistence.md)
{% endcontent-ref %}

## Referanslar

* [https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html](https://docs.aws.amazon.com/AmazonECR/latest/APIReference/Welcome.html)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
