# AWS - ECS Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## ECS

### Basic Information

Amazon **Elastic Container Services** ë˜ëŠ” ECSëŠ” **í´ë¼ìš°ë“œì—ì„œ ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í˜¸ìŠ¤íŒ…í•˜ëŠ” í”Œë«í¼**ì„ ì œê³µí•©ë‹ˆë‹¤. ECSëŠ” **EC2** ì¸ìŠ¤í„´ìŠ¤ ìœ í˜•ê³¼ **ì„œë²„ë¦¬ìŠ¤** ì˜µì…˜ì¸ **Fargate**ì˜ ë‘ ê°€ì§€ **ë°°í¬** ë°©ë²•ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” **í´ë¼ìš°ë“œì—ì„œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ ë§¤ìš° ì‰½ê³  ê³ í†µ ì—†ì´ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤**.

ECSëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ êµ¬ì„± ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ìš´ì˜ë©ë‹ˆë‹¤: **í´ëŸ¬ìŠ¤í„°**, **ì„œë¹„ìŠ¤**, ë° **ì‘ì—… ì •ì˜**.

* **í´ëŸ¬ìŠ¤í„°**ëŠ” **í´ë¼ìš°ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ê·¸ë£¹**ì…ë‹ˆë‹¤. ì•ì„œ ì–¸ê¸‰í–ˆë“¯ì´, ì»¨í…Œì´ë„ˆì—ëŠ” EC2ì™€ Fargateì˜ ë‘ ê°€ì§€ ì‹œì‘ ìœ í˜•ì´ ìˆìŠµë‹ˆë‹¤. AWSëŠ” **EC2** ì‹œì‘ ìœ í˜•ì„ ê³ ê°ì´ â€œ\[ê·¸ë“¤ì˜\] ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ Amazon EC2 ì¸ìŠ¤í„´ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ \[ê·¸ë“¤ì´\] **ê´€ë¦¬**í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒâ€ìœ¼ë¡œ ì •ì˜í•©ë‹ˆë‹¤. **Fargate**ëŠ” ìœ ì‚¬í•˜ë©° â€œ\[ë‹¹ì‹ ì´\] ë°±ì—”ë“œ ì¸í”„ë¼ë¥¼ í”„ë¡œë¹„ì €ë‹í•˜ê³  ê´€ë¦¬í•  í•„ìš” ì—†ì´ **ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒ**â€ìœ¼ë¡œ ì •ì˜ë©ë‹ˆë‹¤.
* **ì„œë¹„ìŠ¤**ëŠ” í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ìƒì„±ë˜ë©° **ì‘ì—…ì„ ì‹¤í–‰í•˜ëŠ”** ì—­í• ì„ í•©ë‹ˆë‹¤. ì„œë¹„ìŠ¤ ì •ì˜ ë‚´ì—ì„œ **ì‹¤í–‰í•  ì‘ì—… ìˆ˜, ìë™ í™•ì¥, ìš©ëŸ‰ ì œê³µì(Fargate/EC2/External),** **ë„¤íŠ¸ì›Œí‚¹** ì •ë³´(ì˜ˆ: VPC, ì„œë¸Œë„·, ë³´ì•ˆ ê·¸ë£¹)ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
* **2ê°€ì§€ ìœ í˜•ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜**ì´ ìˆìŠµë‹ˆë‹¤:
* **ì„œë¹„ìŠ¤**: ì¤‘ë‹¨ ë° ì¬ì‹œì‘í•  ìˆ˜ ìˆëŠ” ì¥ê¸° ì‹¤í–‰ ì»´í“¨íŒ… ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ì‘ì—… ê·¸ë£¹ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.
* **ì‘ì—…**: ì‹¤í–‰ë˜ê³  ì¢…ë£Œë˜ëŠ” ë…ë¦½í˜• ì‘ì—…ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë°°ì¹˜ ì‘ì—…ì…ë‹ˆë‹¤.
* ì„œë¹„ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ì—ëŠ” **2ê°€ì§€ ìœ í˜•ì˜ ì„œë¹„ìŠ¤ ìŠ¤ì¼€ì¤„ëŸ¬**ê°€ ìˆìŠµë‹ˆë‹¤:
* [**REPLICA**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html): ë³µì œ ìŠ¤ì¼€ì¤„ë§ ì „ëµì€ í´ëŸ¬ìŠ¤í„° ì „ë°˜ì— ê±¸ì³ **ì›í•˜ëŠ” ìˆ˜ì˜** ì‘ì—…ì„ ë°°ì¹˜í•˜ê³  **ìœ ì§€**í•©ë‹ˆë‹¤. ì–´ë–¤ ì´ìœ ë¡œ ì‘ì—…ì´ ì¢…ë£Œë˜ë©´, ë™ì¼í•œ ë˜ëŠ” ë‹¤ë¥¸ ë…¸ë“œì—ì„œ ìƒˆë¡œìš´ ì‘ì—…ì´ ì‹œì‘ë©ë‹ˆë‹¤.
* [**DAEMON**](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs_services.html): í•„ìš”í•œ ìš”êµ¬ ì‚¬í•­ì´ ìˆëŠ” ê° í™œì„± ì»¨í…Œì´ë„ˆ ì¸ìŠ¤í„´ìŠ¤ì— ì •í™•íˆ í•˜ë‚˜ì˜ ì‘ì—…ì„ ë°°í¬í•©ë‹ˆë‹¤. ì›í•˜ëŠ” ì‘ì—… ìˆ˜, ì‘ì—… ë°°ì¹˜ ì „ëµ ë˜ëŠ” ì„œë¹„ìŠ¤ ìë™ í™•ì¥ ì •ì±…ì„ ì§€ì •í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
* **ì‘ì—… ì •ì˜**ëŠ” **ì–´ë–¤ ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë ì§€ë¥¼ ì •ì˜**í•˜ê³ , **í¬íŠ¸ ë§¤í•‘**(í˜¸ìŠ¤íŠ¸ì™€ì˜), **í™˜ê²½ ë³€ìˆ˜**, Docker **entrypoint** ë“±ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ë§¤ê°œë³€ìˆ˜ë¥¼ êµ¬ì„±í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.
* **ë¯¼ê°í•œ ì •ë³´ì— ëŒ€í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ í™•ì¸í•˜ì„¸ìš”**!

### Sensitive Data In Task Definitions

ì‘ì—… ì •ì˜ëŠ” **ECSì—ì„œ ì‹¤í–‰ë  ì‹¤ì œ ì»¨í…Œì´ë„ˆë¥¼ êµ¬ì„±í•˜ëŠ”** ì—­í• ì„ í•©ë‹ˆë‹¤. ì‘ì—… ì •ì˜ëŠ” ì»¨í…Œì´ë„ˆê°€ ì–´ë–»ê²Œ ì‹¤í–‰ë ì§€ë¥¼ ì •ì˜í•˜ë¯€ë¡œ, ê·¸ ì•ˆì—ëŠ” ë§ì€ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

PacuëŠ” ECSë¥¼ ì—´ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ë¦¬ìŠ¤íŠ¸ í´ëŸ¬ìŠ¤í„°, ë¦¬ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ ì¸ìŠ¤í„´ìŠ¤, ë¦¬ìŠ¤íŠ¸ ì„œë¹„ìŠ¤, ë¦¬ìŠ¤íŠ¸ ì‘ì—… ì •ì˜), ë˜í•œ ì‘ì—… ì •ì˜ë¥¼ ë¤í”„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Enumeration
```bash
# Clusters info
aws ecs list-clusters
aws ecs describe-clusters --clusters <cluster>

# Container instances
## An Amazon ECS container instance is an Amazon EC2 instance that is running the Amazon ECS container agent and has been registered into an Amazon ECS cluster.
aws ecs list-container-instances --cluster <cluster>
aws ecs describe-container-instances --cluster <cluster> --container-instances <container_instance_arn>

# Services info
aws ecs list-services --cluster <cluster>
aws ecs describe-services --cluster <cluster> --services <services>
aws ecs describe-task-sets --cluster <cluster> --service <service>

# Task definitions
aws ecs list-task-definition-families
aws ecs list-task-definitions
aws ecs list-tasks --cluster <cluster>
aws ecs describe-tasks --cluster <cluster> --tasks <tasks>
## Look for env vars and secrets used from the task definition
aws ecs describe-task-definition --task-definition <TASK_NAME>:<VERSION>
```
### ì¸ì¦ë˜ì§€ ì•Šì€ ì ‘ê·¼

{% content-ref url="../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md" %}
[aws-ecs-unauthenticated-enum.md](../aws-unauthenticated-enum-access/aws-ecs-unauthenticated-enum.md)
{% endcontent-ref %}

### ê¶Œí•œ ìƒìŠ¹

ë‹¤ìŒ í˜ì´ì§€ì—ì„œ **ECS ê¶Œí•œì„ ì•…ìš©í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¤ëŠ” ë°©ë²•**ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../aws-privilege-escalation/aws-ecs-privesc.md" %}
[aws-ecs-privesc.md](../aws-privilege-escalation/aws-ecs-privesc.md)
{% endcontent-ref %}

### í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì‡

{% content-ref url="../aws-post-exploitation/aws-ecs-post-exploitation.md" %}
[aws-ecs-post-exploitation.md](../aws-post-exploitation/aws-ecs-post-exploitation.md)
{% endcontent-ref %}

### ì§€ì†ì„±

{% content-ref url="../aws-persistence/aws-ecs-persistence.md" %}
[aws-ecs-persistence.md](../aws-persistence/aws-ecs-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
