# AWS - Enumera√ß√£o do EventBridge Scheduler

## EventBridge Scheduler

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte ao HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## EventBridge Scheduler

**Amazon EventBridge Scheduler** √© um **agendador totalmente gerenciado e sem servidor projetado para criar, executar e gerenciar tarefas** em grande escala. Ele permite agendar milh√µes de tarefas em mais de 270 servi√ßos AWS e mais de 6.000 opera√ß√µes de API, tudo a partir de um servi√ßo central. Com confiabilidade embutida e sem infraestrutura para gerenciar, o EventBridge Scheduler simplifica o agendamento, reduz os custos de manuten√ß√£o e escala automaticamente para atender √† demanda. Voc√™ pode configurar express√µes cron ou de taxa para agendamentos recorrentes, definir invoca√ß√µes √∫nicas e definir janelas de entrega flex√≠veis com op√ß√µes de reexecu√ß√£o, garantindo que as tarefas sejam entregues de forma confi√°vel com base na disponibilidade dos alvos downstream. Algumas caracter√≠sticas principais do EventBridge Scheduler s√£o:

1. **Alvos com modelo** ‚Äì Suporta opera√ß√µes de API comuns para Amazon SQS, SNS, Lambda e EventBridge, permitindo que voc√™ configure agendamentos rapidamente usando o console, SDK ou CLI.
2. **Alvos universais (UTP)** ‚Äì Crie gatilhos personalizados para mais de 270 servi√ßos AWS e mais de 6.000 opera√ß√µes de API usando UTP atrav√©s do console, SDK ou CLI.
3. **Janelas de tempo flex√≠veis** ‚Äì Permite agendamento disperso para melhorar a confiabilidade quando o tempo preciso n√£o √© necess√°rio.
4. **Reexecu√ß√µes** ‚Äì Fornece entrega de pelo menos uma vez, com op√ß√µes para reexecutar tarefas falhadas para garantir a disponibilidade do alvo.

H√° um limite inicial de 1.000.000 de agendamentos por regi√£o por conta. Mesmo a p√°gina oficial de cotas sugere: "√â recomendado excluir agendamentos √∫nicos uma vez que tenham sido conclu√≠dos." Infelizmente, atualmente n√£o h√° um recurso para exclus√£o autom√°tica, o que √© um pouco uma desvantagem.

### Tipos de Agendamentos
Tipos de Agendamentos no EventBridge Scheduler:

1. **Agendamentos √∫nicos** ‚Äì Execute uma tarefa em um hor√°rio espec√≠fico, por exemplo, 21 de dezembro √†s 7 AM UTC.
2. **Agendamentos baseados em taxa** ‚Äì Defina tarefas recorrentes com base em uma frequ√™ncia, por exemplo, a cada 2 horas.
3. **Agendamentos baseados em cron** ‚Äì Defina tarefas recorrentes usando uma express√£o cron, por exemplo, toda sexta-feira √†s 4 PM.

Dois Mecanismos para Lidar com Eventos Falhados:
1. **Pol√≠tica de Reexecu√ß√£o** ‚Äì Define o n√∫mero de tentativas de reexecu√ß√£o para um evento falhado e quanto tempo mant√™-lo n√£o processado antes de consider√°-lo uma falha.
2. **Fila de Mensagens Mortas (DLQ)** ‚Äì Uma fila padr√£o do Amazon SQS onde eventos falhados s√£o entregues ap√≥s as tentativas de reexecu√ß√£o serem esgotadas. DLQs ajudam na solu√ß√£o de problemas com seu agendamento ou seu alvo downstream.

### Enumera√ß√£o
```bash
# List all EventBridge Scheduler schedules
aws scheduler list-schedules

# List all EventBridge Scheduler schedule groups
aws scheduler list-schedule-groups

# Describe a specific schedule to retrieve more details
aws scheduler get-schedule --name <schedule_name>

# Describe a specific schedule group
aws scheduler get-schedule-group --name <group_name>

# List tags for a specific schedule (helpful in identifying any custom tags or permissions)
aws scheduler list-tags-for-resource --resource-arn <schedule_group_arn>
```
### Privesc

Na p√°gina a seguir, voc√™ pode verificar como **abusar das permiss√µes do eventbridge scheduler para escalar privil√©gios**:

{% content-ref url="../aws-privilege-escalation/eventbridgescheduler-privesc.md" %}
[eventbridgescheduler-privesc.md](../aws-privilege-escalation/eventbridgescheduler-privesc.md)
{% endcontent-ref %}


## Refer√™ncias

* [https://docs.aws.amazon.com/scheduler/latest/UserGuide/what-is-scheduler.html]https://docs.aws.amazon.com/scheduler/latest/UserGuide/what-is-scheduler.html)

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
