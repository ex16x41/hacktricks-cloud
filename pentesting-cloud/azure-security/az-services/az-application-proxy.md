# Az - Application Proxy

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

[From the docs:](https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy)

Azure Active Directoryì˜ Application ProxyëŠ” **ì˜¨í”„ë ˆë¯¸ìŠ¤ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ì•ˆì „í•œ ì›ê²© ì•¡ì„¸ìŠ¤**ë¥¼ ì œê³µí•©ë‹ˆë‹¤. **Azure ADì— ë‹¨ì¼ ë¡œê·¸ì¸** í›„, ì‚¬ìš©ìëŠ” **ì™¸ë¶€ URL** ë˜ëŠ” ë‚´ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ í¬í„¸ì„ í†µí•´ **í´ë¼ìš°ë“œ** ë° **ì˜¨í”„ë ˆë¯¸ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜**ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‘ë™ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

<figure><img src="../../../.gitbook/assets/image (186).png" alt=""><figcaption></figcaption></figure>

1. ì‚¬ìš©ìê°€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì•¡ì„¸ìŠ¤í•œ í›„, ì‚¬ìš©ìëŠ” **Azure AD ë¡œê·¸ì¸ í˜ì´ì§€**ë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.
2. **ì„±ê³µì ì¸ ë¡œê·¸ì¸** í›„, Azure ADëŠ” **í† í°**ì„ ì‚¬ìš©ìì˜ í´ë¼ì´ì–¸íŠ¸ ì¥ì¹˜ë¡œ ë³´ëƒ…ë‹ˆë‹¤.
3. í´ë¼ì´ì–¸íŠ¸ëŠ” í† í°ì„ **Application Proxy ì„œë¹„ìŠ¤**ë¡œ ë³´ë‚´ê³ , ì„œë¹„ìŠ¤ëŠ” í† í°ì—ì„œ ì‚¬ìš©ì ì£¼ì²´ ì´ë¦„(UPN)ê³¼ ë³´ì•ˆ ì£¼ì²´ ì´ë¦„(SPN)ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. **Application ProxyëŠ” ìš”ì²­ì„ Application Proxy ì»¤ë„¥í„°ë¡œ ë³´ëƒ…ë‹ˆë‹¤**.
4. ë‹¨ì¼ ë¡œê·¸ì¸ì„ êµ¬ì„±í•œ ê²½ìš°, ì»¤ë„¥í„°ëŠ” ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ í•„ìš”í•œ **ì¶”ê°€ ì¸ì¦**ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
5. ì»¤ë„¥í„°ëŠ” ìš”ì²­ì„ **ì˜¨í”„ë ˆë¯¸ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜**ìœ¼ë¡œ ë³´ëƒ…ë‹ˆë‹¤.
6. **ì‘ë‹µ**ì€ ì»¤ë„¥í„°ì™€ Application Proxy ì„œë¹„ìŠ¤ë¥¼ í†µí•´ **ì‚¬ìš©ìì—ê²Œ** ì „ì†¡ë©ë‹ˆë‹¤.

## Enumeration
```powershell
# Enumerate applications with application proxy configured
Get-AzureADApplication | %{try{Get-AzureADApplicationProxyApplication -ObjectId $_.ObjectID;$_.DisplayName;$_.ObjectID}catch{}}

# Get applications service principal
Get-AzureADServicePrincipal -All $true | ?{$_.DisplayName -eq "Name"}

# Use the following ps1 script from https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/scripts/powershell-display-users-group-of-app
# to find users and groups assigned to the application. Pass the ObjectID of the Service Principal to it
Get-ApplicationProxyAssignedUsersAndGroups -ObjectId <object-id>
```
## ì°¸ê³  ìë£Œ

* [https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy](https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy)

{% hint style="success" %}
AWS Hacking í•™ìŠµ ë° ì—°ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking í•™ìŠµ ë° ì—°ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… í”Œëœ**](https://github.com/sponsors/carlospolop)ì„ í™•ì¸í•˜ì„¸ìš”!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**telegram ê·¸ë£¹**](https://t.me/peass)ì— ê°€ì…í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ì„ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **PRì„ ì œì¶œí•˜ì—¬** [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ì €ì¥ì†Œì— í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
