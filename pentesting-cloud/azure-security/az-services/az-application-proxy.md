# Az - Application Proxy

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

[From the docs:](https://learn.microsoft.com/en-us/entra/identity/app-proxy/application-proxy)

Azure Active Directoryì˜ Application ProxyëŠ” **ì˜¨í”„ë ˆë¯¸ìŠ¤ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ì•ˆì „í•œ ì›ê²© ì•¡ì„¸ìŠ¤**ë¥¼ ì œê³µí•©ë‹ˆë‹¤. **Azure ADì— ëŒ€í•œ ë‹¨ì¼ ë¡œê·¸ì¸** í›„, ì‚¬ìš©ìëŠ” **í´ë¼ìš°ë“œ** ë° **ì˜¨í”„ë ˆë¯¸ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜**ì— **ì™¸ë¶€ URL** ë˜ëŠ” ë‚´ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ í¬í„¸ì„ í†µí•´ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‘ë™ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

<figure><img src="../../../.gitbook/assets/image (186).png" alt=""><figcaption></figcaption></figure>

1. ì‚¬ìš©ìê°€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì•¡ì„¸ìŠ¤í•œ í›„, ì‚¬ìš©ìëŠ” **Azure AD ë¡œê·¸ì¸ í˜ì´ì§€**ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. **ë¡œê·¸ì¸ ì„±ê³µ** í›„, Azure ADëŠ” ì‚¬ìš©ìì˜ í´ë¼ì´ì–¸íŠ¸ ì¥ì¹˜ì— **í† í°**ì„ ë³´ëƒ…ë‹ˆë‹¤.
3. í´ë¼ì´ì–¸íŠ¸ëŠ” í† í°ì„ **Application Proxy ì„œë¹„ìŠ¤**ì— ì „ì†¡í•˜ë©°, ì´ ì„œë¹„ìŠ¤ëŠ” í† í°ì—ì„œ ì‚¬ìš©ì ì£¼ì²´ ì´ë¦„(UPN)ê³¼ ë³´ì•ˆ ì£¼ì²´ ì´ë¦„(SPN)ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤. **Application ProxyëŠ” ìš”ì²­ì„ Application Proxy ì»¤ë„¥í„°ë¡œ ì „ì†¡í•©ë‹ˆë‹¤**.
4. ë‹¨ì¼ ë¡œê·¸ì¸ì„ êµ¬ì„±í•œ ê²½ìš°, ì»¤ë„¥í„°ëŠ” ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ í•„ìš”í•œ **ì¶”ê°€ ì¸ì¦**ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
5. ì»¤ë„¥í„°ëŠ” ìš”ì²­ì„ **ì˜¨í”„ë ˆë¯¸ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜**ì— ì „ì†¡í•©ë‹ˆë‹¤.
6. **ì‘ë‹µ**ì€ ì»¤ë„¥í„°ì™€ Application Proxy ì„œë¹„ìŠ¤ë¥¼ í†µí•´ **ì‚¬ìš©ìì—ê²Œ** ì „ì†¡ë©ë‹ˆë‹¤.

## Enumeration
```powershell
# Enumerate applications with application proxy configured
Get-AzureADApplication | %{try{Get-AzureADApplicationProxyApplication -ObjectId $_.ObjectID;$_.DisplayName;$_.ObjectID}catch{}}

# Get applications service principal
Get-AzureADServicePrincipal -All $true | ?{$_.DisplayName -eq "Name"}

# Use the following ps1 script from https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/scripts/powershell-display-users-group-of-app
# to find users and groups assigned to the application. Pass the ObjectID of the Service Principal to it
Get-ApplicationProxyAssignedUsersAndGroups -ObjectId <object-id>
```
## References

* [https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy](https://learn.microsoft.com/en-us/azure/active-directory/app-proxy/application-proxy)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
