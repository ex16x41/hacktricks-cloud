# Az - Azure App Service & Function Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## App Service Basic Information

[Î‘Ï€ÏŒ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î±:](https://learn.microsoft.com/en-us/azure/app-service/overview) _Azure App Service_ ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î· ÏƒÎµ HTTP Î³Î¹Î± Ï„Î· Ï†Î¹Î»Î¿Î¾ÎµÎ½Î¯Î± Î´Î¹Î±Î´Î¹ÎºÏ„Ï…Î±ÎºÏÎ½ ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½, REST APIs ÎºÎ±Î¹ ÎºÎ¹Î½Î·Ï„ÏÎ½ back ends. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÏ„Îµ ÏƒÏ„Î· Î³Î»ÏÏƒÏƒÎ± Ï€Î¿Ï… Ï€ÏÎ¿Ï„Î¹Î¼Î¬Ï„Îµ, ÎµÎ¯Ï„Îµ ÎµÎ¯Î½Î±Î¹ .NET, .NET Core, Java, Ruby, Node.js, PHP Î® Python. ÎŸÎ¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Î¹ ÎºÎ»Î¹Î¼Î±ÎºÏÎ½Î¿Î½Ï„Î±Î¹ ÎµÏÎºÎ¿Î»Î± ÏƒÎµ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î± Windows ÎºÎ±Î¹ Linux.

ÎšÎ¬Î¸Îµ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± sandbox, Î±Î»Î»Î¬ Î· Î±Ï€Î¿Î¼ÏŒÎ½Ï‰ÏƒÎ· ÎµÎ¾Î±ÏÏ„Î¬Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î± ÏƒÏ‡Î­Î´Î¹Î± App Service

* ÎŸÎ¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÏƒÎµ Î´Ï‰ÏÎµÎ¬Î½ ÎºÎ±Î¹ ÎºÎ¿Î¹Î½Î¬ ÎµÏ€Î¯Ï€ÎµÎ´Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ ÎºÎ¿Î¹Î½Î­Ï‚ VM
* ÎŸÎ¹ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÏƒÎµ Ï„Ï…Ï€Î¹ÎºÎ¬ ÎºÎ±Î¹ premium ÎµÏ€Î¯Ï€ÎµÎ´Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ­Ï‚ VM

{% hint style="warning" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ **ÎºÎ±Î½Î­Î½Î±** Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Ï„Î± ÎµÏ€Î¯Ï€ÎµÎ´Î± Î±Ï€Î¿Î¼ÏŒÎ½Ï‰ÏƒÎ·Ï‚ **Î´ÎµÎ½ Î±Ï€Î¿Ï„ÏÎ­Ï€ÎµÎ¹** Î¬Î»Î»ÎµÏ‚ ÎºÎ¿Î¹Î½Î­Ï‚ **ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î¹ÏƒÏ„Î¿Ï** (ÏŒÏ€Ï‰Ï‚ Î· Î¼ÎµÏ„Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î® Î¿Î¹ ÎµÎ¹ÏƒÎ²Î¿Î»Î­Ï‚). ÎšÎ±Î¹ Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¼Î¹Î± **Ï„Î±Ï…Ï„ÏŒÏ„Î·Ï„Î± Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚**, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î± **ÏƒÏ…Î¼Î²Î¹Î²Î¬ÏƒÎµÎ¹ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹Î­Ï‚ Ï„Î·Ï‚**.
{% endhint %}

### Enumeration

{% tabs %}
{% tab title="az" %}
{% code overflow="wrap" %}
```bash
# List webapps
az webapp list

## Less information
az webapp list --query "[].{hostName: defaultHostName, state: state, name: name, resourcegroup: resourceGroup}"

# Get access restrictions
az webapp config access-restriction show --resource-group <res-group> -n <name>

# Remove access restrictions
az webapp config access-restriction remove --resource-group <res-group> -n <name> --rule-name <rule-name>

# Get snapshots
az webapp config snapshot list --resource-group <res-group> -n <name>

# Restore snapshot
az webapp config snapshot restore -g <res-group> -n <name> --time 2018-12-11T23:34:16.8388367

# Restart webapp
az webapp restart --name <name> --resource-group <res-group>
```
{% endcode %}
{% endtab %}

{% tab title="Az Powershell" %}
```powershell
# Get App Services and Function Apps
Get-AzWebApp
# Get only App Services
Get-AzWebApp | ?{$_.Kind -notmatch "functionapp"}
```
{% endtab %}

{% tab title="az get all" %}
{% code overflow="wrap" %}
```bash
#!/bin/bash

# Get all App Service and Function Apps

# Define Azure subscription ID
azure_subscription="your_subscription_id"

# Log in to Azure
az login

# Select Azure subscription
az account set --subscription $azure_subscription

# Get all App Services in the specified subscription
list_app_services=$(az appservice list --query "[].{appServiceName: name, group: resourceGroup}" -o tsv)

# Iterate over each App Service
echo "$list_app_services" | while IFS=$'\t' read -r appServiceName group; do
# Get the type of the App Service
service_type=$(az appservice show --name $appServiceName --resource-group $group --query "kind" -o tsv)

# Check if it is a Function App and print its name
if [ "$service_type" == "functionapp" ]; then
echo "Function App Name: $appServiceName"
fi
done
```
{% endcode %}
{% endtab %}
{% endtabs %}

#### Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± & Î±Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ Î¹ÏƒÏ„Î¿Ï
```bash
# Get connection strings that could contain credentials (with DBs for example)
az webapp config connection-string list --name <name> --resource-group <res-group>
## Check how to use the DBs connection strings in the SQL page

# Get credentials to access the code and DB credentials if configured.
az webapp deployment list-publishing-profiles --resource-group <res-group> -n <name>


# Get git URL to access the code
az webapp deployment source config-local-git --resource-group <res-group> -n <name>

# Access/Modify the code via git
git clone 'https://<username>:<password>@name.scm.azurewebsites.net/repo-name.git'
## In my case the username was: $nameofthewebapp and the password some random chars
## If you change the code and do a push, the app is automatically redeployed
```
#### Î ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ Docker container Î¼Îµ Ï„Î·Î½ webapp Î¼Î­ÏƒÏ‰ ssh:
```bash
# Get ssh session
az webapp create-remote-connection --subscription <SUBSCRIPTION-ID> --resource-group <RG-NAME> -n <APP-SERVICE-NAME>

## If successfull you will get a message such as:
#Verifying if app is running....
#App is running. Trying to establish tunnel connection...
#Opening tunnel on port: 39895
#SSH is available { username: root, password: Docker! }

## So from that machine ssh into that port (you might need generate a new ssh session to the jump host)
ssh root@127.0.0.1 -p 39895
```
## Function Apps Basic Information

Azure Functions ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± **serverless** Î»ÏÏƒÎ· Ï€Î¿Ï… ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³ÏÎ¬Ï†ÎµÏ„Îµ Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ ÎºÏÎ´Î¹ÎºÎ±, Î½Î± Î´Î¹Î±Ï„Î·ÏÎµÎ¯Ï„Îµ Î»Î¹Î³ÏŒÏ„ÎµÏÎ· Ï…Ï€Î¿Î´Î¿Î¼Î® ÎºÎ±Î¹ Î½Î± ÎµÎ¾Î¿Î¹ÎºÎ¿Î½Î¿Î¼ÎµÎ¯Ï„Îµ ÎºÏŒÏƒÏ„Î¿Ï‚. Î‘Î½Ï„Î¯ Î½Î± Î±Î½Î·ÏƒÏ…Ï‡ÎµÎ¯Ï„Îµ Î³Î¹Î± Ï„Î·Î½ Î±Î½Î¬Ï€Ï„Ï…Î¾Î· ÎºÎ±Î¹ Ï„Î· ÏƒÏ…Î½Ï„Î®ÏÎ·ÏƒÎ· Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„ÏÎ½, Î· Ï…Ï€Î¿Î´Î¿Î¼Î® Ï„Î¿Ï… cloud Ï€Î±ÏÎ­Ï‡ÎµÎ¹ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ ÎµÎ½Î·Î¼ÎµÏÏ‰Î¼Î­Î½Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ Î³Î¹Î± Î½Î± Î´Î¹Î±Ï„Î·ÏÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ ÏƒÎ±Ï‚ ÏƒÎµ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±.

Î£Ï„Î¿ Azure portal, Î· ÎµÎ½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· Î¼ÎµÏ„Î±Î¾Ï Azure Functions ÎºÎ±Î¹ Azure API Management Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½ÎµÏ„Î±Î¹, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ **HTTP trigger function endpoints Î½Î± ÎµÎºÏ„Î¯Î¸ÎµÎ½Ï„Î±Î¹ Ï‰Ï‚ REST APIs**. ÎŸÎ¹ APIs Ï€Î¿Ï… ÎµÎºÏ„Î¯Î¸ÎµÎ½Ï„Î±Î¹ Î¼Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï„ÏÏŒÏ€Î¿ Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î­Î½Î±Î½ Î¿ÏÎ¹ÏƒÎ¼ÏŒ OpenAPI, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± Ï„Ï…Ï€Î¹ÎºÎ®, Î³Î»ÏÏƒÏƒÎ±-Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Î· Î´Î¹ÎµÏ€Î±Ï†Î® Î³Î¹Î± RESTful APIs.

**Function Apps Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Ï…Î½ Managed Identities.**

Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Ï„Î¿ Function App Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± endpoints Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„Î¿ÏÎ½ Î­Î½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ ÎµÏ€Î¯Ï€ÎµÎ´Î¿ Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚, ÏŒÏ€Ï‰Ï‚ "admin" Î® "anonymous".\
ÎˆÎ½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î± **anonymous allowed endpoints** Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Ï„Î¿Ï…Ï‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î® Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î±.

### Enumeration
```powershell
# Get only Function Apps
Get-AzFunctionApp
```
## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://learn.microsoft.com/en-in/azure/app-service/overview](https://learn.microsoft.com/en-in/azure/app-service/overview)
* [https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition](https://learn.microsoft.com/en-us/azure/azure-functions/functions-openapi-definition)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
