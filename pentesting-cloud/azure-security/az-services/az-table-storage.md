# Az - Table Storage

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**Azure Table Storage** est un magasin de valeurs cl√© NoSQL con√ßu pour stocker de grands volumes de donn√©es structur√©es et non relationnelles. Il offre une haute disponibilit√©, une faible latence et une √©volutivit√© pour g√©rer efficacement de grands ensembles de donn√©es. Les donn√©es sont organis√©es en tables, chaque entit√© √©tant identifi√©e par une cl√© de partition et une cl√© de ligne, permettant des recherches rapides. Il prend en charge des fonctionnalit√©s telles que le chiffrement au repos, le contr√¥le d'acc√®s bas√© sur les r√¥les et les signatures d'acc√®s partag√© pour un stockage s√©curis√© et g√©r√© adapt√© √† un large √©ventail d'applications.

Il **n'y a pas de m√©canisme de sauvegarde int√©gr√©** pour le stockage de table.

### Keys

#### **PartitionKey**

* Le **PartitionKey regroupe les entit√©s en partitions logiques**. Les entit√©s ayant le m√™me PartitionKey sont stock√©es ensemble, ce qui am√©liore les performances des requ√™tes et l'√©volutivit√©.
* Exemple : Dans une table stockant des donn√©es d'employ√©s, `PartitionKey` pourrait repr√©senter un d√©partement, par exemple, `"RH"` ou `"IT"`.

#### **RowKey**

* Le **RowKey est l'identifiant unique** d'une entit√© au sein d'une partition. Lorsqu'il est combin√© avec le PartitionKey, il garantit que chaque entit√© dans la table a un identifiant unique au niveau mondial.
* Exemple : Pour la partition `"RH"`, `RowKey` pourrait √™tre un identifiant d'employ√©, par exemple, `"12345"`.

#### **Other Properties (Custom Properties)**

* En plus du PartitionKey et du RowKey, une entit√© peut avoir des **propri√©t√©s personnalis√©es suppl√©mentaires pour stocker des donn√©es**. Celles-ci sont d√©finies par l'utilisateur et agissent comme des colonnes dans une base de donn√©es traditionnelle.
* Les propri√©t√©s sont stock√©es sous forme de **paires cl√©-valeur**.
* Exemple : `Nom`, `√Çge`, `Titre` pourraient √™tre des propri√©t√©s personnalis√©es pour un employ√©.

## Enumeration
```bash
# Get storage accounts
az storage account list

# List tables
az storage table list --account-name <name>

# Read table
az storage entity query \
--account-name <name> \
--table-name <t-name> \
--top 10

# Write table
az storage entity insert \
--account-name <STORAGE_ACCOUNT_NAME> \
--table-name <TABLE_NAME> \
--entity PartitionKey=<PARTITION_KEY> RowKey=<ROW_KEY> <PROPERTY_KEY>=<PROPERTY_VALUE>

# Write example
az storage entity insert \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=HR RowKey=12345 Name="John Doe" Age=30 Title="Manager"

# Update row
az storage entity merge \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=pk1 RowKey=rk1 Age=31
```
{% hint style="info" %}
Par d√©faut, `az` cli utilisera une cl√© de compte pour signer une cl√© et effectuer l'action. Pour utiliser les privil√®ges du principal Entra ID, utilisez les param√®tres `--auth-mode login`.
{% endhint %}

{% hint style="success" %}
Utilisez le param√®tre `--account-key` pour indiquer la cl√© de compte √† utiliser\
Utilisez le param√®tre `--sas-token` avec le token SAS pour acc√©der via un token SAS
{% endhint %}

## Escalade de Privil√®ges

Identique √† l'escalade de privil√®ges de stockage :

{% content-ref url="../az-privilege-escalation/az-storage-privesc.md" %}
[az-storage-privesc.md](../az-privilege-escalation/az-storage-privesc.md)
{% endcontent-ref %}

## Post Exploitation

{% content-ref url="../az-post-exploitation/az-table-storage-post-exploitation.md" %}
[az-table-storage-post-exploitation.md](../az-post-exploitation/az-table-storage-post-exploitation.md)
{% endcontent-ref %}

## Persistance

Identique √† la persistance de stockage :

{% content-ref url="../az-persistence/az-storage-persistence.md" %}
[az-storage-persistence.md](../az-persistence/az-storage-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
