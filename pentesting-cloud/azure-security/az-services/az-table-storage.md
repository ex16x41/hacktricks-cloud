# Az - Table Storage

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

## Grundinformationen

**Azure Table Storage** ist ein NoSQL-Key-Value-Store, der f√ºr die Speicherung gro√üer Mengen strukturierter, nicht-relationaler Daten konzipiert ist. Es bietet hohe Verf√ºgbarkeit, niedrige Latenz und Skalierbarkeit, um gro√üe Datens√§tze effizient zu verarbeiten. Daten sind in Tabellen organisiert, wobei jede Entit√§t durch einen PartitionKey und einen RowKey identifiziert wird, was schnelle Abfragen erm√∂glicht. Es unterst√ºtzt Funktionen wie Verschl√ºsselung im Ruhezustand, rollenbasierte Zugriffskontrolle und gemeinsame Zugriffssignaturen f√ºr sichere, verwaltete Speicherung, die f√ºr eine Vielzahl von Anwendungen geeignet ist.

Es **gibt keinen integrierten Backup-Mechanismus** f√ºr die Tabellenspeicherung.

### Schl√ºssel

#### **PartitionKey**

* Der **PartitionKey gruppiert Entit√§ten in logische Partitionen**. Entit√§ten mit demselben PartitionKey werden zusammen gespeichert, was die Abfrageleistung und Skalierbarkeit verbessert.
* Beispiel: In einer Tabelle, die Mitarbeiterdaten speichert, k√∂nnte der `PartitionKey` eine Abteilung darstellen, z.B. `"HR"` oder `"IT"`.

#### **RowKey**

* Der **RowKey ist der eindeutige Identifikator** f√ºr eine Entit√§t innerhalb einer Partition. In Kombination mit dem PartitionKey stellt er sicher, dass jede Entit√§t in der Tabelle einen global eindeutigen Identifikator hat.
* Beispiel: F√ºr die Partition `"HR"` k√∂nnte der `RowKey` eine Mitarbeiter-ID sein, z.B. `"12345"`.

#### **Andere Eigenschaften (Benutzerdefinierte Eigenschaften)**

* Neben dem PartitionKey und RowKey kann eine Entit√§t zus√§tzliche **benutzerdefinierte Eigenschaften zur Datenspeicherung** haben. Diese sind benutzerdefiniert und fungieren wie Spalten in einer traditionellen Datenbank.
* Eigenschaften werden als **Schl√ºssel-Wert-Paare** gespeichert.
* Beispiel: `Name`, `Alter`, `Titel` k√∂nnten benutzerdefinierte Eigenschaften f√ºr einen Mitarbeiter sein.

## Enumeration
```bash
# Get storage accounts
az storage account list

# List tables
az storage table list --account-name <name>

# Read table
az storage entity query \
--account-name <name> \
--table-name <t-name> \
--top 10

# Write table
az storage entity insert \
--account-name <STORAGE_ACCOUNT_NAME> \
--table-name <TABLE_NAME> \
--entity PartitionKey=<PARTITION_KEY> RowKey=<ROW_KEY> <PROPERTY_KEY>=<PROPERTY_VALUE>

# Write example
az storage entity insert \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=HR RowKey=12345 Name="John Doe" Age=30 Title="Manager"

# Update row
az storage entity merge \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=pk1 RowKey=rk1 Age=31
```
{% hint style="info" %}
Standardm√§√üig verwendet die `az` CLI einen Kontoschl√ºssel, um einen Schl√ºssel zu signieren und die Aktion auszuf√ºhren. Um die Berechtigungen des Entra ID-Prinzipals zu verwenden, verwenden Sie die Parameter `--auth-mode login`.
{% endhint %}

{% hint style="success" %}
Verwenden Sie den Parameter `--account-key`, um den zu verwendenden Kontoschl√ºssel anzugeben\
Verwenden Sie den Parameter `--sas-token` mit dem SAS-Token, um √ºber ein SAS-Token zuzugreifen
{% endhint %}

## Privilegieneskalation

Gleich wie bei der Speicherprivilegieneskalation:

{% content-ref url="../az-privilege-escalation/az-storage-privesc.md" %}
[az-storage-privesc.md](../az-privilege-escalation/az-storage-privesc.md)
{% endcontent-ref %}

## Nach der Ausnutzung

{% content-ref url="../az-post-exploitation/az-table-storage-post-exploitation.md" %}
[az-table-storage-post-exploitation.md](../az-post-exploitation/az-table-storage-post-exploitation.md)
{% endcontent-ref %}

## Persistenz

Gleich wie bei der Speicherpersistenz:

{% content-ref url="../az-persistence/az-storage-persistence.md" %}
[az-storage-persistence.md](../az-persistence/az-storage-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
