# Az - Table Storage

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

**Azure Table Storage** ã¯ã€å¤§é‡ã®æ§‹é€ åŒ–ã•ã‚ŒãŸéãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸ NoSQL ã‚­ãƒ¼-ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ã§ã™ã€‚é«˜å¯ç”¨æ€§ã€ä½é…å»¶ã€ãŠã‚ˆã³ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚’æä¾›ã—ã€å¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åŠ¹ç‡çš„ã«å‡¦ç†ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ•´ç†ã•ã‚Œã€å„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã¨è¡Œã‚­ãƒ¼ã«ã‚ˆã£ã¦è­˜åˆ¥ã•ã‚Œã€è¿…é€Ÿãªæ¤œç´¢ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯ã€é™æ­¢æ™‚ã®æš—å·åŒ–ã€ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã€ãŠã‚ˆã³å®‰å…¨ã§ç®¡ç†ã•ã‚ŒãŸã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ãŸã‚ã®å…±æœ‰ã‚¢ã‚¯ã‚»ã‚¹ç½²åãªã©ã®æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€å¹…åºƒã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é©ã—ã¦ã„ã¾ã™ã€‚

ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã¯**çµ„ã¿è¾¼ã¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã‚ã‚Šã¾ã›ã‚“**ã€‚

### ã‚­ãƒ¼

#### **PartitionKey**

* **PartitionKey ã¯ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’è«–ç†ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¾ã™**ã€‚åŒã˜ PartitionKey ã‚’æŒã¤ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¯ä¸€ç·’ã«ä¿å­˜ã•ã‚Œã€ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãŒå‘ä¸Šã—ã¾ã™ã€‚
* ä¾‹: å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã¯ã€`PartitionKey` ã¯éƒ¨é–€ã‚’è¡¨ã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹: `"HR"` ã¾ãŸã¯ `"IT"`ã€‚

#### **RowKey**

* **RowKey ã¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³å†…ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ä¸€æ„ã®è­˜åˆ¥å­ã§ã™**ã€‚PartitionKey ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã®å„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä¸€æ„ã®è­˜åˆ¥å­ã‚’æŒã¤ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚
* ä¾‹: `"HR"` ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã®å ´åˆã€`RowKey` ã¯å¾“æ¥­å“¡ ID ã§ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹: `"12345"`ã€‚

#### **ãã®ä»–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ (ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£)**

* PartitionKey ã¨ RowKey ã«åŠ ãˆã¦ã€ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¯ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®è¿½åŠ ã® **ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ã“ã¨ãŒã§ãã¾ã™**ã€‚ã“ã‚Œã‚‰ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã§ã‚ã‚Šã€å¾“æ¥ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆ—ã®ã‚ˆã†ã«æ©Ÿèƒ½ã—ã¾ã™ã€‚
* ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ **ã‚­ãƒ¼-ãƒãƒªãƒ¥ãƒ¼ãƒšã‚¢** ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚
* ä¾‹: `Name`ã€`Age`ã€`Title` ã¯å¾“æ¥­å“¡ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## åˆ—æŒ™
```bash
# Get storage accounts
az storage account list

# List tables
az storage table list --account-name <name>

# Read table
az storage entity query \
--account-name <name> \
--table-name <t-name> \
--top 10

# Write table
az storage entity insert \
--account-name <STORAGE_ACCOUNT_NAME> \
--table-name <TABLE_NAME> \
--entity PartitionKey=<PARTITION_KEY> RowKey=<ROW_KEY> <PROPERTY_KEY>=<PROPERTY_VALUE>

# Write example
az storage entity insert \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=HR RowKey=12345 Name="John Doe" Age=30 Title="Manager"

# Update row
az storage entity merge \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=pk1 RowKey=rk1 Age=31
```
{% hint style="info" %}
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€`az` cliã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã‚­ãƒ¼ã«ç½²åã—ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚Entra IDã®ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«æ¨©é™ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿`--auth-mode login`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
{% endhint %}

{% hint style="success" %}
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿`--account-key`ã‚’ä½¿ç”¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã‚’æŒ‡å®šã—ã¾ã™\
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿`--sas-token`ã‚’SASãƒˆãƒ¼ã‚¯ãƒ³ã¨å…±ã«ä½¿ç”¨ã—ã¦SASãƒˆãƒ¼ã‚¯ãƒ³çµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™
{% endhint %}

## æ¨©é™æ˜‡æ ¼

ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®æ¨©é™æ˜‡æ ¼ã¨åŒæ§˜ã§ã™ï¼š

{% content-ref url="../az-privilege-escalation/az-storage-privesc.md" %}
[az-storage-privesc.md](../az-privilege-escalation/az-storage-privesc.md)
{% endcontent-ref %}

## ãƒã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ

{% content-ref url="../az-post-exploitation/az-table-storage-post-exploitation.md" %}
[az-table-storage-post-exploitation.md](../az-post-exploitation/az-table-storage-post-exploitation.md)
{% endcontent-ref %}

## æ°¸ç¶šæ€§

ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®æ°¸ç¶šæ€§ã¨åŒæ§˜ã§ã™ï¼š

{% content-ref url="../az-persistence/az-storage-persistence.md" %}
[az-storage-persistence.md](../az-persistence/az-storage-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
