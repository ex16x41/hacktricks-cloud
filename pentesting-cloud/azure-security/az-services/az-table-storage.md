# Az - Table Storage

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**Azure Table Storage** √© um armazenamento NoSQL de chave-valor projetado para armazenar grandes volumes de dados estruturados e n√£o relacionais. Oferece alta disponibilidade, baixa lat√™ncia e escalabilidade para lidar com grandes conjuntos de dados de forma eficiente. Os dados s√£o organizados em tabelas, com cada entidade identificada por uma chave de parti√ß√£o e uma chave de linha, permitindo buscas r√°pidas. Suporta recursos como criptografia em repouso, controle de acesso baseado em fun√ß√µes e assinaturas de acesso compartilhado para armazenamento seguro e gerenciado, adequado para uma ampla gama de aplica√ß√µes.

N√£o **existe um mecanismo de backup embutido** para o armazenamento de tabelas.

### Keys

#### **PartitionKey**

* A **PartitionKey agrupa entidades em parti√ß√µes l√≥gicas**. Entidades com a mesma PartitionKey s√£o armazenadas juntas, o que melhora o desempenho da consulta e a escalabilidade.
* Exemplo: Em uma tabela que armazena dados de funcion√°rios, `PartitionKey` pode representar um departamento, por exemplo, `"RH"` ou `"TI"`.

#### **RowKey**

* A **RowKey √© o identificador √∫nico** para uma entidade dentro de uma parti√ß√£o. Quando combinada com a PartitionKey, garante que cada entidade na tabela tenha um identificador globalmente √∫nico.
* Exemplo: Para a parti√ß√£o `"RH"`, `RowKey` pode ser um ID de funcion√°rio, por exemplo, `"12345"`.

#### **Other Properties (Custom Properties)**

* Al√©m da PartitionKey e RowKey, uma entidade pode ter **propriedades personalizadas adicionais para armazenar dados**. Estas s√£o definidas pelo usu√°rio e atuam como colunas em um banco de dados tradicional.
* As propriedades s√£o armazenadas como **pares chave-valor**.
* Exemplo: `Nome`, `Idade`, `T√≠tulo` podem ser propriedades personalizadas para um funcion√°rio.

## Enumeration
```bash
# Get storage accounts
az storage account list

# List tables
az storage table list --account-name <name>

# Read table
az storage entity query \
--account-name <name> \
--table-name <t-name> \
--top 10

# Write table
az storage entity insert \
--account-name <STORAGE_ACCOUNT_NAME> \
--table-name <TABLE_NAME> \
--entity PartitionKey=<PARTITION_KEY> RowKey=<ROW_KEY> <PROPERTY_KEY>=<PROPERTY_VALUE>

# Write example
az storage entity insert \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=HR RowKey=12345 Name="John Doe" Age=30 Title="Manager"

# Update row
az storage entity merge \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=pk1 RowKey=rk1 Age=31
```
{% hint style="info" %}
Por padr√£o, o `az` cli usar√° uma chave de conta para assinar uma chave e realizar a a√ß√£o. Para usar os privil√©gios do principal do Entra ID, use os par√¢metros `--auth-mode login`.
{% endhint %}

{% hint style="success" %}
Use o par√¢metro `--account-key` para indicar a chave de conta a ser usada\
Use o par√¢metro `--sas-token` com o token SAS para acessar via um token SAS
{% endhint %}

## Escala√ß√£o de Privil√©gios

Mesma coisa que privesc de armazenamento:

{% content-ref url="../az-privilege-escalation/az-storage-privesc.md" %}
[az-storage-privesc.md](../az-privilege-escalation/az-storage-privesc.md)
{% endcontent-ref %}

## P√≥s Explora√ß√£o

{% content-ref url="../az-post-exploitation/az-table-storage-post-exploitation.md" %}
[az-table-storage-post-exploitation.md](../az-post-exploitation/az-table-storage-post-exploitation.md)
{% endcontent-ref %}

## Persist√™ncia

Mesma coisa que persist√™ncia de armazenamento:

{% content-ref url="../az-persistence/az-storage-persistence.md" %}
[az-storage-persistence.md](../az-persistence/az-storage-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
