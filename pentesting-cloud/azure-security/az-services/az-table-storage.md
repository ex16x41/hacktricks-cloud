# Az - Table Storage

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Podstawowe informacje

**Azure Table Storage** to magazyn NoSQL typu klucz-wartoÅ›Ä‡ zaprojektowany do przechowywania duÅ¼ych wolumenÃ³w ustrukturyzowanych danych nieliniowych. Oferuje wysokÄ… dostÄ™pnoÅ›Ä‡, niskie opÃ³Åºnienia i skalowalnoÅ›Ä‡, aby efektywnie obsÅ‚ugiwaÄ‡ duÅ¼e zbiory danych. Dane sÄ… zorganizowane w tabelach, a kaÅ¼da encja jest identyfikowana przez klucz partycji i klucz wiersza, co umoÅ¼liwia szybkie wyszukiwanie. ObsÅ‚uguje funkcje takie jak szyfrowanie w spoczynku, kontrola dostÄ™pu oparta na rolach oraz podpisy dostÄ™pu wspÃ³Å‚dzielonego dla bezpiecznego, zarzÄ…dzanego przechowywania odpowiedniego dla szerokiego zakresu aplikacji.

**Nie ma wbudowanego mechanizmu kopii zapasowej** dla magazynu tabel.

### Klucze

#### **PartitionKey**

* **PartitionKey grupuje encje w logiczne partycje**. Encje z tym samym PartitionKey sÄ… przechowywane razem, co poprawia wydajnoÅ›Ä‡ zapytaÅ„ i skalowalnoÅ›Ä‡.
* PrzykÅ‚ad: W tabeli przechowujÄ…cej dane pracownikÃ³w, `PartitionKey` moÅ¼e reprezentowaÄ‡ dziaÅ‚, np. `"HR"` lub `"IT"`.

#### **RowKey**

* **RowKey jest unikalnym identyfikatorem** dla encji w obrÄ™bie partycji. W poÅ‚Ä…czeniu z PartitionKey zapewnia, Å¼e kaÅ¼da encja w tabeli ma globalnie unikalny identyfikator.
* PrzykÅ‚ad: Dla partycji `"HR"` `RowKey` moÅ¼e byÄ‡ identyfikatorem pracownika, np. `"12345"`.

#### **Inne wÅ‚aÅ›ciwoÅ›ci (WÅ‚aÅ›ciwoÅ›ci niestandardowe)**

* OprÃ³cz PartitionKey i RowKey, encja moÅ¼e mieÄ‡ dodatkowe **wÅ‚aÅ›ciwoÅ›ci niestandardowe do przechowywania danych**. SÄ… one definiowane przez uÅ¼ytkownika i dziaÅ‚ajÄ… jak kolumny w tradycyjnej bazie danych.
* WÅ‚aÅ›ciwoÅ›ci sÄ… przechowywane jako **pary klucz-wartoÅ›Ä‡**.
* PrzykÅ‚ad: `Name`, `Age`, `Title` mogÄ… byÄ‡ wÅ‚aÅ›ciwoÅ›ciami niestandardowymi dla pracownika.

## Enumeracja
```bash
# Get storage accounts
az storage account list

# List tables
az storage table list --account-name <name>

# Read table
az storage entity query \
--account-name <name> \
--table-name <t-name> \
--top 10

# Write table
az storage entity insert \
--account-name <STORAGE_ACCOUNT_NAME> \
--table-name <TABLE_NAME> \
--entity PartitionKey=<PARTITION_KEY> RowKey=<ROW_KEY> <PROPERTY_KEY>=<PROPERTY_VALUE>

# Write example
az storage entity insert \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=HR RowKey=12345 Name="John Doe" Age=30 Title="Manager"

# Update row
az storage entity merge \
--account-name mystorageaccount \
--table-name mytable \
--entity PartitionKey=pk1 RowKey=rk1 Age=31
```
{% hint style="info" %}
DomyÅ›lnie `az` cli uÅ¼yje klucza konta do podpisania klucza i wykonania akcji. Aby uÅ¼yÄ‡ uprawnieÅ„ gÅ‚Ã³wnego uÅ¼ytkownika Entra ID, uÅ¼yj parametrÃ³w `--auth-mode login`.
{% endhint %}

{% hint style="success" %}
UÅ¼yj parametru `--account-key`, aby wskazaÄ‡ klucz konta do uÅ¼ycia\
UÅ¼yj parametru `--sas-token` z tokenem SAS, aby uzyskaÄ‡ dostÄ™p za pomocÄ… tokena SAS
{% endhint %}

## Eskalacja uprawnieÅ„

Tak samo jak storage privesc:

{% content-ref url="../az-privilege-escalation/az-storage-privesc.md" %}
[az-storage-privesc.md](../az-privilege-escalation/az-storage-privesc.md)
{% endcontent-ref %}

## Po eksploatacji

{% content-ref url="../az-post-exploitation/az-table-storage-post-exploitation.md" %}
[az-table-storage-post-exploitation.md](../az-post-exploitation/az-table-storage-post-exploitation.md)
{% endcontent-ref %}

## Utrzymywanie

Tak samo jak storage persistence:

{% content-ref url="../az-persistence/az-storage-persistence.md" %}
[az-storage-persistence.md](../az-persistence/az-storage-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Dziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w na GitHubie.

</details>
{% endhint %}
