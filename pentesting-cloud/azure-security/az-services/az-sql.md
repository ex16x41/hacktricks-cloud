# Az - SQL

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

[Î‘Ï€ÏŒ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î±:](https://learn.microsoft.com/en-us/azure/azure-sql/azure-sql-iaas-vs-paas-what-is-overview) Î¤Î¿ Azure SQL ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î¿Î¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Ï‰Î½, Î±ÏƒÏ†Î±Î»ÏÎ½ ÎºÎ±Î¹ Î­Î¾Ï…Ï€Î½Ï‰Î½ Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Ï‰Î½ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î·Î½ **Î¼Î·Ï‡Î±Î½Î® Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ SQL Server ÏƒÏ„Î¿ Azure cloud**. Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î±Î½Î·ÏƒÏ…Ï‡ÎµÎ¯Ï„Îµ Î³Î¹Î± Ï„Î· Ï†Ï…ÏƒÎ¹ÎºÎ® Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï„Ï‰Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„ÏÎ½ ÏƒÎ±Ï‚ ÎºÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏ‰Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÎ±Ï‚.

Î¤Î¿ Azure SQL Î±Ï€Î¿Ï„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„ÏÎµÎ¹Ï‚ ÎºÏÏÎ¹ÎµÏ‚ Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ­Ï‚:

1. **Azure SQL Database**: Î‘Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± **Ï€Î»Î®ÏÏ‰Ï‚ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½**, Ï€Î¿Ï… ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï†Î¹Î»Î¿Î¾ÎµÎ½ÎµÎ¯Ï„Îµ Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½ÎµÏ‚ Î²Î¬ÏƒÎµÎ¹Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ„Î¿ Azure cloud. Î ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î· Î½Î¿Î·Î¼Î¿ÏƒÏÎ½Î· Ï€Î¿Ï… Î¼Î±Î¸Î±Î¯Î½ÎµÎ¹ Ï„Î± Î¼Î¿Î½Î±Î´Î¹ÎºÎ¬ Ï€ÏÏŒÏ„Ï…Ï€Î± Ï„Î·Ï‚ Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÎ±Ï‚ ÎºÎ±Î¹ Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÏ…ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÏÏÎ¸Î¼Î¹ÏƒÎ·.
2. **Azure SQL Managed Instance**: Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î³Î¹Î± Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ·Ï‚ ÎºÎ»Î¯Î¼Î±ÎºÎ±Ï‚, Ï€Î»Î®ÏÎµÎ¹Ï‚ Î±Î½Î±Ï€Ï„ÏÎ¾ÎµÎ¹Ï‚ SQL Server. Î Î±ÏÎ­Ï‡ÎµÎ¹ ÏƒÏ‡ÎµÎ´ÏŒÎ½ 100% ÏƒÏ…Î¼Î²Î±Ï„ÏŒÏ„Î·Ï„Î± Î¼Îµ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Î¼Î·Ï‡Î±Î½Î® Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ SQL Server on-premises (Enterprise Edition), Î· Î¿Ï€Î¿Î¯Î± Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± ÎµÎ³Î³ÎµÎ½Î® Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ¿Ï Î´Î¹ÎºÏ„ÏÎ¿Ï… (VNet) Ï€Î¿Ï… Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯Î¶ÎµÎ¹ ÎºÎ¿Î¹Î½Î­Ï‚ Î±Î½Î·ÏƒÏ…Ï‡Î¯ÎµÏ‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚, ÎºÎ±Î¹ Î­Î½Î± ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ·Î¼Î±Ï„Î¹ÎºÏŒ Î¼Î¿Î½Ï„Î­Î»Î¿ ÎµÏ…Î½Î¿ÏŠÎºÏŒ Î³Î¹Î± Ï„Î¿Ï…Ï‚ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ SQL Server on-premises.
3. **Azure SQL Server ÏƒÎµ Azure VMs**: Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î¥Ï€Î¿Î´Î¿Î¼Î® Ï‰Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯Î± (IaaS) ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î»ÏÏ„ÎµÏÎ¿ Î³Î¹Î± Î¼ÎµÏ„ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚ ÏŒÏ€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ **Î­Î»ÎµÎ³Ï‡Î¿ Ï„Î¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ¿Ï ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ ÎºÎ±Î¹ Ï„Î·Ï‚ Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±Ï‚ SQL Server**, ÏŒÏ€Ï‰Ï‚ Î±Î½ Î®Ï„Î±Î½ Î­Î½Î±Ï‚ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Ï€Î¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÏƒÎµ on-premises.

## Enumeration
```bash
az sql server list
az sql server show --resource-group <res-grp> --name <name>
az sql db list --server <server> --resource-group <res-grp>

az sql mi list
az sql mi show --resource-group <res-grp> --name <name>
az sql midb list
az sql midb show --resource-group <res-grp> --name <name>

az sql vm list
az sql vm show --resource-group <res-grp> --name <name>
```
### Î£Ï…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ ÎºÎ±Î¹ ÎµÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ SQL ÎµÏÏ‰Ï„Î®Î¼Î±Ï„Î±

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼Î¹Î± ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬ ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ (Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±) Î±Ï€ÏŒ Ï„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± [ÎºÎ±Ï„Î±Î¼Î­Ï„ÏÎ·ÏƒÎ· ÎµÎ½ÏŒÏ‚ Az WebApp](az-azure-app-service.md):

{% code overflow="wrap" %}
```powershell
function invoke-sql{
param($query)
$Connection_string = "Server=tcp:supercorp.database.windows.net,1433;Initial Catalog=flag;Persist Security Info=False;User ID=db_read;Password=gAegH!324fAG!#1fht;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;"
$Connection = New-Object System.Data.SqlClient.SqlConnection $Connection_string
$Connection.Open()
$Command = New-Object System.Data.SqlClient.SqlCommand
$Command.Connection = $Connection
$Command.CommandText = $query
$Reader = $Command.ExecuteReader()
while ($Reader.Read()) {
$Reader.GetValue(0)
}
$Connection.Close()
}

invoke-sql 'Select Distinct TABLE_NAME From information_schema.TABLES;'
```
{% endcode %}

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://learn.microsoft.com/en-us/azure/azure-sql/azure-sql-iaas-vs-paas-what-is-overview?view=azuresql](https://learn.microsoft.com/en-us/azure/azure-sql/azure-sql-iaas-vs-paas-what-is-overview?view=azuresql)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
