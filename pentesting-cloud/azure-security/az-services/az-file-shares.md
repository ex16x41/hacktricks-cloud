# Az - File Shares

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**Azure Files** ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï€Î»Î®ÏÏ‰Ï‚ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î¿ cloud Ï€Î¿Ï… Ï€Î±ÏÎ­Ï‡ÎµÎ¹ ÎºÎ¿Î¹Î½Î® Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î· Î¼Î­ÏƒÏ‰ Ï„Ï‰Î½ Ï„Ï…Ï€Î¹ÎºÏÎ½ Ï€ÏÏ‰Ï„Î¿ÎºÏŒÎ»Î»Ï‰Î½ **SMB (Server Message Block)** ÎºÎ±Î¹ **NFS (Network File System)**. Î‘Î½ ÎºÎ±Î¹ Ï„Î¿ ÎºÏÏÎ¹Î¿ Ï€ÏÏ‰Ï„ÏŒÎºÎ¿Î»Î»Î¿ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ SMB, Î¿Î¹ ÎºÎ¿Î¹Î½Î­Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ NFS Azure Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î³Î¹Î± Windows (ÏƒÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î± [**docs**](https://learn.microsoft.com/en-us/azure/storage/files/files-nfs-protocol)). Î£Î±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚ ÎºÎ¿Î¹Î½Î­Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î´Î¹ÎºÏ„ÏÎ¿Ï… Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î±ÏƒÏ„Î¿ÏÎ½ Ï„Î±Ï…Ï„ÏŒÏ‡ÏÎ¿Î½Î± Î±Ï€ÏŒ Ï€Î¿Î»Î»Î­Ï‚ ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ­Ï‚ Î¼Î·Ï‡Î±Î½Î­Ï‚ (VMs) Î® Ï„Î¿Ï€Î¹ÎºÎ¬ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î±, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±Ï€ÏÏŒÏƒÎºÎ¿Ï€Ï„Î· ÎºÎ¿Î¹Î½Î® Ï‡ÏÎ®ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎ± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î±.

### Access Tiers

* **Transaction Optimized**: Î’ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î¿ Î³Î¹Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Î¼Îµ Ï€Î¿Î»Î»Î­Ï‚ ÏƒÏ…Î½Î±Î»Î»Î±Î³Î­Ï‚.
* **Hot**: Î™ÏƒÎ¿ÏÏÎ¿Ï€Î·Î¼Î­Î½Î¿ Î¼ÎµÏ„Î±Î¾Ï ÏƒÏ…Î½Î±Î»Î»Î±Î³ÏÎ½ ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚.
* **Cool**: ÎŸÎ¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÏŒ Î³Î¹Î± Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·.
* **Premium:** Î¥ÏˆÎ·Î»Î®Ï‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î³Î¹Î± Ï†Î¿ÏÏ„Î¯Î± ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ Î¼Îµ Ï‡Î±Î¼Î·Î»Î® ÎºÎ±Î¸Ï…ÏƒÏ„Î­ÏÎ·ÏƒÎ· ÎºÎ±Î¹ IOPS.

### Backups

* **Daily backup**: ÎˆÎ½Î± ÏƒÎ·Î¼ÎµÎ¯Î¿ Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î¿Ï… Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ ÎºÎ¬Î¸Îµ Î¼Î­ÏÎ± ÏƒÎµ Î¼Î¹Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· ÏÏÎ± (Ï€.Ï‡. 19.30 UTC) ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ 1 Î­Ï‰Ï‚ 200 Î·Î¼Î­ÏÎµÏ‚.
* **Weekly backup**: ÎˆÎ½Î± ÏƒÎ·Î¼ÎµÎ¯Î¿ Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î¿Ï… Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ ÎºÎ¬Î¸Îµ ÎµÎ²Î´Î¿Î¼Î¬Î´Î± ÏƒÎµ Î¼Î¹Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· Î·Î¼Î­ÏÎ± ÎºÎ±Î¹ ÏÏÎ± (ÎšÏ…ÏÎ¹Î±ÎºÎ® ÏƒÏ„Î¹Ï‚ 19.30) ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ 1 Î­Ï‰Ï‚ 200 ÎµÎ²Î´Î¿Î¼Î¬Î´ÎµÏ‚.
* **Monthly backup**: ÎˆÎ½Î± ÏƒÎ·Î¼ÎµÎ¯Î¿ Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î¿Ï… Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ ÎºÎ¬Î¸Îµ Î¼Î®Î½Î± ÏƒÎµ Î¼Î¹Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· Î·Î¼Î­ÏÎ± ÎºÎ±Î¹ ÏÏÎ± (Ï€.Ï‡. Ï€ÏÏÏ„Î· ÎšÏ…ÏÎ¹Î±ÎºÎ® ÏƒÏ„Î¹Ï‚ 19.30) ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ 1 Î­Ï‰Ï‚ 120 Î¼Î®Î½ÎµÏ‚.
* **Yearly backup**: ÎˆÎ½Î± ÏƒÎ·Î¼ÎµÎ¯Î¿ Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î¿Ï… Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ ÎºÎ¬Î¸Îµ Ï‡ÏÏŒÎ½Î¿ ÏƒÎµ Î¼Î¹Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· Î·Î¼Î­ÏÎ± ÎºÎ±Î¹ ÏÏÎ± (Ï€.Ï‡. Ï€ÏÏÏ„Î· ÎšÏ…ÏÎ¹Î±ÎºÎ® Ï„Î¿Ï… Î™Î±Î½Î¿Ï…Î±ÏÎ¯Î¿Ï… ÏƒÏ„Î¹Ï‚ 19.30) ÎºÎ±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ Î±Ï€ÏŒ 1 Î­Ï‰Ï‚ 10 Ï‡ÏÏŒÎ½Î¹Î±.
* Î•Î¯Î½Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î´Ï…Î½Î±Ï„Î® Î· ÎµÎºÏ„Î­Î»ÎµÏƒÎ· **Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Ï‰Î½ Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Ï‰Î½ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ ÎºÎ±Î¹ ÏƒÏ„Î¹Î³Î¼Î¹ÏŒÏ„Ï…Ï€Ï‰Î½ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ ÏƒÏ„Î¹Î³Î¼Î®**. Î¤Î± Î±Î½Ï„Î¯Î³ÏÎ±Ï†Î± Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ ÎºÎ±Î¹ Ï„Î± ÏƒÏ„Î¹Î³Î¼Î¹ÏŒÏ„Ï…Ï€Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Î± Î¯Î´Î¹Î± ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿.

### Supported Authentications via SMB

* **On-premises AD DS Authentication**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Active Directory Ï„Î¿Ï€Î¹ÎºÎ¬ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î­Î½Î± Î¼Îµ Ï„Î¿ Microsoft Entra ID Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î²Î¬ÏƒÎµÎ¹ Ï„Î±Ï…Ï„ÏŒÏ„Î·Ï„Î±Ï‚. Î‘Ï€Î±Î¹Ï„ÎµÎ¯ ÏƒÏ…Î½Î´ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î± Î´Î¹ÎºÏ„ÏÎ¿Ï… Î¼Îµ Ï„Î¿ Ï„Î¿Ï€Î¹ÎºÏŒ AD DS.
* **Microsoft Entra Domain Services Authentication**: Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ Ï„Î¹Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î¤Î¿Î¼Î­Î± Microsoft Entra (cloud-based AD) Î³Î¹Î± Î½Î± Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Microsoft Entra.
* **Microsoft Entra Kerberos for Hybrid Identities**: Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Microsoft Entra Î½Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î¿ÏÎ½ Ï„Î¹Ï‚ ÎºÎ¿Î¹Î½Î­Ï‚ Î±Ï€Î¿Î¸Î®ÎºÎµÏ‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Azure Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… Î´Î¹Î±Î´Î¹ÎºÏ„ÏÎ¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Kerberos. Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Ï…Î²ÏÎ¹Î´Î¹ÎºÎ­Ï‚ ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ­Ï‚ Î¼Î·Ï‡Î±Î½Î­Ï‚ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½ÎµÏ‚ Î¼Îµ Ï„Î¿ Microsoft Entra Î® Microsoft Entra Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Î±Ï€Î±Î¹Ï„ÎµÎ¯ ÏƒÏ…Î½Î´ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î± Î¼Îµ Ï„Î¿Ï€Î¹ÎºÎ¿ÏÏ‚ ÎµÎ»ÎµÎ³ÎºÏ„Î­Ï‚ Ï„Î¿Î¼Î­Î±. Î‘Î»Î»Î¬ Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Î¼ÏŒÎ½Î¿ cloud Ï„Î±Ï…Ï„ÏŒÏ„Î·Ï„ÎµÏ‚.
* **AD Kerberos Authentication for Linux Clients**: Î•Ï€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ Linux Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Kerberos Î³Î¹Î± Ï„Î·Î½ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· SMB Î¼Î­ÏƒÏ‰ Ï„Î¿Ï€Î¹ÎºÎ¿Ï AD DS Î® Î¥Ï€Î·ÏÎµÏƒÎ¹ÏÎ½ Î¤Î¿Î¼Î­Î± Microsoft Entra.

## Enumeration

{% code overflow="wrap" %}
```bash
# Get storage accounts
az storage account list #Get the account name from here

# List file shares
az storage share list --account-name <name>
# Get dirs/files inside the share
az storage file list --account-name <name> --share-name <share-name>
## If type is "dir", you can continue enumerating files inside of it
az storage file list --account-name <name> --share-name <prev_dir/share-name>
# Download a complete share (with directories and files inside of them)
az storage file download-batch -d . --source <share-name> --account-name <name>

# Get snapshots/backups
az storage share list --account-name <name> --include-snapshots --query "[?snapshot != null]"
# List contents of a snapshot/backup
az storage file list --account-name <name> --share-name <share-name> --snapshot <snapshot-version> #e.g. "2024-11-25T11:26:59.0000000Z"
# Download snapshot/backup
az storage file download-batch -d . --account-name <name> --source <share-name> --snapshot <snapshot-version>
```
{% endcode %}

{% hint style="info" %}
Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Ï„Î¿ `az` cli Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î­Î½Î± ÎºÎ»ÎµÎ¹Î´Î¯ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Î³Î¹Î± Î½Î± Ï…Ï€Î¿Î³ÏÎ¬ÏˆÎµÎ¹ Î­Î½Î± ÎºÎ»ÎµÎ¹Î´Î¯ ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î·Î½ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±. Î“Î¹Î± Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Ï„Î¿Ï… Entra ID principal, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î¹Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚ `--auth-mode login --enable-file-backup-request-intent`.
{% endhint %}

{% hint style="success" %}
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `--account-key` Î³Î¹Î± Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï Ï€Î¿Ï… Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯\
Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `--sas-token` Î¼Îµ Ï„Î¿ SAS token Î³Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î¼Î­ÏƒÏ‰ ÎµÎ½ÏŒÏ‚ SAS token
{% endhint %}

### Î£ÏÎ½Î´ÎµÏƒÎ·

Î‘Ï…Ï„Î¬ ÎµÎ¯Î½Î±Î¹ Ï„Î± ÏƒÎµÎ½Î¬ÏÎ¹Î± Ï€Î¿Ï… Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ Azure ÎºÎ±Ï„Î¬ Ï„Î· ÏƒÏ„Î¹Î³Î¼Î® Ï„Î·Ï‚ ÏƒÏ…Î³Î³ÏÎ±Ï†Î®Ï‚ Î³Î¹Î± Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ ÏƒÎµ Î­Î½Î± File Share:

Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ Ï„Î¿Ï…Ï‚ Ï‡ÏÏÎ¿Ï…Ï‚ `<STORAGE-ACCOUNT>`, `<ACCESS-KEY>` ÎºÎ±Î¹ `<FILE-SHARE-NAME>`.

{% tabs %}
{% tab title="Windows" %}
{% code overflow="wrap" %}
```powershell
$connectTestResult = Test-NetConnection -ComputerName filescontainersrdtfgvhb.file.core.windows.net -Port 445
if ($connectTestResult.TcpTestSucceeded) {
# Save the password so the drive will persist on reboot
cmd.exe /C "cmdkey /add:`"<STORAGE-ACCOUNT>.file.core.windows.net`" /user:`"localhost\<STORAGE-ACCOUNT>`" /pass:`"<ACCESS-KEY>`""
# Mount the drive
New-PSDrive -Name Z -PSProvider FileSystem -Root "\\<STORAGE-ACCOUNT>.file.core.windows.net\<FILE-SHARE-NAME>" -Persist
} else {
Write-Error -Message "Unable to reach the Azure storage account via port 445. Check to make sure your organization or ISP is not blocking port 445, or use Azure P2S VPN, Azure S2S VPN, or Express Route to tunnel SMB traffic over a different port."
}
```
{% endcode %}
{% endtab %}

{% tab title="Î›Î¯Î½Î¿Ï…Î¾" %}
{% code overflow="wrap" %}
```bash
sudo mkdir /mnt/disk-shareeifrube
if [ ! -d "/etc/smbcredentials" ]; then
sudo mkdir /etc/smbcredentials
fi
if [ ! -f "/etc/smbcredentials/<STORAGE-ACCOUNT>.cred" ]; then
sudo bash -c 'echo "username=<STORAGE-ACCOUNT>" >> /etc/smbcredentials/<STORAGE-ACCOUNT>.cred'
sudo bash -c 'echo "password=<ACCESS-KEY>" >> /etc/smbcredentials/<STORAGE-ACCOUNT>.cred'
fi
sudo chmod 600 /etc/smbcredentials/<STORAGE-ACCOUNT>.cred

sudo bash -c 'echo "//<STORAGE-ACCOUNT>.file.core.windows.net/<FILE-SHARE-NAME> /mnt/<FILE-SHARE-NAME> cifs nofail,credentials=/etc/smbcredentials/<STORAGE-ACCOUNT>.cred,dir_mode=0777,file_mode=0777,serverino,nosharesock,actimeo=30" >> /etc/fstab'
sudo mount -t cifs //<STORAGE-ACCOUNT>.file.core.windows.net/<FILE-SHARE-NAME> /mnt/<FILE-SHARE-NAME> -o credentials=/etc/smbcredentials/<STORAGE-ACCOUNT>.cred,dir_mode=0777,file_mode=0777,serverino,nosharesock,actimeo=30
```
{% endcode %}
{% endtab %}

{% tab title="macOS" %}
{% code overflow="wrap" %}
```bash
open smb://<STORAGE-ACCOUNT>:<ACCESS-KEY>@<STORAGE-ACCOUNT>.file.core.windows.net/<FILE-SHARE-NAME>
```
{% endcode %}
{% endtab %}
{% endtabs %}

### ÎšÎ±Î½Î¿Î½Î¹ÎºÎ® Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎºÎ±Ï„Î±Î¼Î­Ï„ÏÎ·ÏƒÎ·Ï‚ (ÎºÎ»ÎµÎ¹Î´Î¹Î¬ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚, SAS...)

{% content-ref url="az-storage.md" %}
[az-storage.md](az-storage.md)
{% endcontent-ref %}

## ÎšÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· Î”Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½

ÎŠÎ´Î¹Î¿ Î¼Îµ Ï„Î·Î½ ÎºÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚:

{% content-ref url="../az-privilege-escalation/az-storage-privesc.md" %}
[az-storage-privesc.md](../az-privilege-escalation/az-storage-privesc.md)
{% endcontent-ref %}

## ÎœÎµÏ„Î¬ Ï„Î·Î½ Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·

{% content-ref url="../az-post-exploitation/az-file-share-post-exploitation.md" %}
[az-file-share-post-exploitation.md](../az-post-exploitation/az-file-share-post-exploitation.md)
{% endcontent-ref %}

## Î•Ï€Î¹Î¼Î¿Î½Î®

ÎŠÎ´Î¹Î¿ Î¼Îµ Ï„Î·Î½ ÎºÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚:

{% content-ref url="../az-persistence/az-storage-persistence.md" %}
[az-storage-persistence.md](../az-persistence/az-storage-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
