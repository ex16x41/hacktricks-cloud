# Az - Azure Network

{% hint style="success" %}
Leer en oefen AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer en oefen GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**intekenplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basiese Inligting

Netwerke binne Azure funksioneer as 'n integrale deel van sy wolkrekenaarplatform, wat die **verbinding en kommunikasie tussen verskeie Azure-dienste en -hulpbronne** moontlik maak. Die netwerkargitektuur in Azure is ontwerp om hoogs skaalbaar, veilig en aanpasbaar te wees.

In sy kern bied Azure 'n **virtuele netwerk (VNet)** wat gebruikers toelaat om **ge√Øsoleerde** **netwerke** binne die Azure-wolk te skep. Binne hierdie VNets kan hulpbronne soos virtuele masjiene, toepassings en databasisse veilig gehuisves en bestuur word. Die netwerk in Azure ondersteun beide die kommunikasie binne die wolk (tussen Azure-dienste) en die verbinding met eksterne netwerke en die internet.

**Sekuriteit** is 'n kritieke aspek van Azure-netwerking, met verskeie gereedskap en dienste beskikbaar vir die beskerming van data, bestuur van toegang en verseker van nakoming. Hierdie sekuriteitsmaatre√´ls sluit in **firewalls**, **netwerksekuriteitsgroepe**, en **enkripsie** vermo√´ns, wat 'n ho√´ vlak van beheer oor verkeer en toegang moontlik maak.

Oor die algemeen is Azure se netwerkvermo√´ns ontwerp om buigsaamheid te bied, wat gebruikers toelaat om 'n netwerkomgewing te skep wat by hul spesifieke toepassings- en werklasbehoeftes pas, terwyl 'n sterk klem op sekuriteit en betroubaarheid gehandhaaf word.

## Virtuele Netwerk (VNET) & Subnetwerke

'n VNet in Azure is in wese 'n voorstelling van jou eie netwerk in die wolk. Dit is 'n **logiese isolasie van die Azure-wolk toegewy aan jou subskripsie**. 'n VNet laat jou toe om virtuele privaat netwerke (VPNs) in Azure te voorsien en te bestuur en kan gebruik word om verskeie tipes Azure-hulpbronne te huisves en **te bestuur**, soos Virtuele Masjiene (VMs), databasisse, en toepassingsdienste.

VNets bied jou **volledige beheer oor jou netwerkinstellings**, insluitend **IP-adres** reekse, subnet-skepping, roetetabelle, en netwerk-gateways.

'n **Subnet** is 'n **reeks IP-adresse in jou VNet**. Jy kan 'n VNet in verskeie subnette verdeel vir organisasie en sekuriteit. Elke subnet in 'n VNet kan gebruik word om hulpbronne te isoleer en te groepeer volgens jou netwerk- en toepassingsargitektuur.

Verder laat subnette jou toe om jou VNet in een of meer sub-netwerke te segmenteer, wat 'n reeks IP-adresse bied wat hulpbronne kan gebruik.

### **Voorbeeld**

* Gestel jy het 'n VNet genaamd `MyVNet` met 'n IP-adresreeks van `10.0.0.0/16`. Jy kan 'n subnet binne hierdie VNet skep, kom ons s√™ `Subnet-1`, met 'n IP-adresreeks van `10.0.0.0/24` vir die huisvesting van jou webbedieners. Nog 'n subnet, `Subnet-2` met 'n reeks van `10.0.1.0/24`, kan gebruik word vir jou databasisbedieners. Hierdie segmentasie laat doeltreffende bestuur en sekuriteitsbeheer binne die netwerk toe.

### Enumerasie

Om al die VNets en subnette in 'n Azure-rekening te lys, kan jy die Azure Command-Line Interface (CLI) gebruik. Hier is die stappe:

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## Network Security Groups (NSG)

In Azure, dien 'n **Network Security Group (NSG)** die prim√™re funksie van die filter van netwerkverkeer na en van Azure-hulpbronne binne 'n Azure Virtual Network (VNet). Dit bevat 'n stel **sekuriteitsre√´ls** wat noukeurig die vloei van netwerkverkeer bepaal.

Sleutelaspekte van NSG sluit in:

* **Verkeersbeheer**: Elke NSG bevat re√´ls wat instrumenteel is in √≥f die toelaat √≥f die belemmering van inkomende en uitgaande netwerkverkeer wat met verskeie Azure-hulpbronne geassosieer word.
* **Re√´lkomponente**: Die re√´ls binne 'n NSG is baie spesifiek en filter verkeer gebaseer op kriteria soos bron/bestemming IP-adres, poort, en protokol. Hierdie spesifisiteit laat vir fynbeheer van netwerkverkeer toe.
* **Sekuriteitsverbetering**: Deur te verseker dat slegs gemagtigde verkeer jou Azure-hulpbronne kan binnegaan of verlaat, speel NSG's 'n deurslaggewende rol in die versterking van die sekuriteitshouding van jou netwerk-infrastruktuur.

### **Voorbeeld**

* Stel jou voor jy het 'n NSG genaamd `MyNSG` toegepas op 'n subnet of 'n spesifieke virtuele masjien binne jou VNet. Jy kan re√´ls skep soos:
* 'n Inkomende re√´l wat HTTP-verkeer (poort 80) van enige bron na jou webbedieners toelaat.
* 'n Uitgaande re√´l wat slegs SQL-verkeer (poort 1433) na 'n spesifieke bestemming IP-adresreeks toelaat.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall is 'n bestuurde, wolk-gebaseerde **netwerk sekuriteitsdiens wat jou Azure Virtual Network hulpbronne beskerm**. Dit is 'n volledig staatshouer firewall as 'n diens met ingeboude ho√´ beskikbaarheid en skaalbaarheid kenmerke.

Azure Firewall bied **meer gevorderde** kenmerke as **NSGs**, insluitend **toepassingsvlak filter**, netwerkvlak filter, bedreigingsintelligensie-gebaseerde filter, en integrasie met Azure Monitor vir logboeke en analise.\
Dit kan uitgaande, inkomende, spoke-to-spoke, VPN, en ExpressRoute verkeer filter. **Firewall re√´ls kan geskep word gebaseer op FQDN (Fully Qualified Domain Name), IP adresse, en poorte**.

### Verskille tussen Azure Firewall en NSGs

1. **Reikwydte:**
* **NSG:** Werk op die subnet of netwerk koppelvlak vlak. Dit is bedoel om basiese filter van inkomende en uitgaande verkeer van netwerk koppelvlakke (NIC), VMs, of subnets te verskaf.
* **Azure Firewall:** Werk op die VNet vlak, wat 'n bre√´r reikwydte van beskerming bied. Dit is ontwerp om jou virtuele netwerk hulpbronne te beveilig en verkeer wat in en uit die VNet vloei te bestuur.
2. **Vermo√´ns:**
* **NSG:** Verskaf basiese filter vermo√´ns gebaseer op IP adres, poort, en protokol. Dit ondersteun nie gevorderde kenmerke soos toepassingsvlak inspeksie of bedreigingsintelligensie nie.
* **Azure Firewall:** Bied gevorderde kenmerke soos toepassingsvlak (Laag 7) verkeer filter, bedreigingsintelligensie-gebaseerde filter, netwerk verkeer filter, en meer. Dit ondersteun ook verskeie publieke IP adresse.
3. **Gebruik Gevalle:**
* **NSG:** Ideaal vir basiese netwerk vlak verkeer filter.
* **Azure Firewall:** Geskik vir meer komplekse filter scenario's waar toepassingsvlak beheer, logboeke, en bedreigingsintelligensie benodig word.
4. **Bestuur en Monitering:**
* **NSG:** Bied basiese logboeke en integrasie met Azure Monitor.
* **Azure Firewall:** Verskaf gevorderde logboeke en analise vermo√´ns deur Azure Monitor, wat noodsaaklik is vir die verstaan van die aard en patroon van die verkeer.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## Network Virtual Appliance (NVA)

'n Network Virtual Appliance (**NVA**) in Azure is 'n virtuele toestel wat **netwerkfunksies binne 'n virtuele netwerk uitvoer**. NVAs word tipies gebruik vir netwerkfunksies wat **nie inheems beskikbaar is** in Azure nie of wanneer meer aanpassing vereis word. Hulle is in wese **VMs wat netwerktoepassings of -dienste bestuur**, soos firewalls, WAN-optimeerders, of lasbalanseerders.

NVAs word gebruik vir komplekse roetering, **sekuriteit**, en **netwerkverkeersbestuurtake**. Hulle kan vanaf Azure **Marketplace** ontplooi word, waar baie derdeparty-verskaffers hul toestelle gereed bied vir integrasie in Azure-omgewings.

### **Voorbeeld**

* 'n Organisasie kan 'n NVA in Azure ontplooi om 'n **pasgemaakte firewall-oplossing** te skep. Hierdie NVA kan 'n **derdeparty firewall-sagteware** bestuur, wat gevorderde kenmerke soos indringingsopsporing, pakkie-inspeksie, of VPN-konnektiwiteit bied. Die NVA kan gekonfigureer word om verkeer wat daardeur gaan te inspekteer en te filter, wat verseker dat verbeterde sekuriteitsmaatre√´ls in plek is volgens die organisasie se beleide.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
{% endcode %}

## Azure Route Tables & User Defined Routes (UDR)

**Azure Route Tables** is 'n funksie binne Microsoft Azure wat toelaat vir die **beheer van netwerkverkeerroetering binne Azure Virtual Networks (VNets)**. Basies definieer hulle hoe **pakkette** **aangegee** word tussen subnetwerke binne VNets, tussen VNets, of na eksterne netwerke. Elke roetertabel bevat 'n stel re√´ls, bekend as roetes, wat spesifiseer hoe pakkette gerouteer moet word gebaseer op hul bestemmings-IP-adresse.

**User Defined Routes (UDR)** in Azure is **pasgemaakte roetes wat jy binne Azure Route Tables skep** om die **vloei van netwerkverkeer** binne en tussen Azure Virtual Networks (VNets), en na eksterne verbindings te beheer. UDRs gee jou die buigsaamheid om netwerkverkeer te rig volgens jou spesifieke vereistes, wat Azure se standaard roeteringsbesluite oorskry.

Hierdie roetes is veral nuttig vir scenario's waar jy verkeer deur 'n virtuele toestel moet **roeteer**, 'n spesifieke pad vir sekuriteit of beleidsnakoming moet afdwing, of met op-perseel netwerke moet integreer.

### **Voorbeeld**

* Veronderstel jy het 'n Network Virtual Appliance (NVA) ontplooi vir die inspeksie van verkeer tussen subnetwerke binne 'n VNet. Jy kan 'n UDR skep wat alle verkeer van een subnet na 'n ander subnet rig om deur die NVA te gaan. Hierdie UDR verseker dat die NVA die verkeer vir sekuriteitsdoeleindes inspekteer voordat dit sy bestemming bereik.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Private Link

Azure Private Link is 'n diens in Azure wat **privaat toegang tot Azure-dienste moontlik maak** deur te verseker dat **verkeer tussen jou Azure virtuele netwerk (VNet) en die diens heeltemal binne Microsoft se Azure-ruggraatnetwerk reis**. Dit bring die diens effektief in jou VNet. Hierdie opstelling verbeter sekuriteit deur nie die data aan die publieke internet bloot te stel nie.

Private Link kan gebruik word met verskeie Azure-dienste, soos Azure Storage, Azure SQL Database, en pasgemaakte dienste wat via Private Link gedeel word. Dit bied 'n veilige manier om dienste te gebruik van binne jou eie VNet of selfs van verskillende Azure-subskripsies.

{% hint style="danger" %}
NSGs is nie van toepassing op private eindpunte nie, wat duidelik beteken dat die assosiasie van 'n NSG met 'n subnet wat die Private Link bevat geen effek sal h√™ nie.
{% endhint %}

### **Voorbeeld**

* Oorweeg 'n scenario waar jy 'n **Azure SQL Database het wat jy veilig vanaf jou VNet wil toegang**. Normaalweg kan dit behels dat jy die publieke internet moet oorsteek. Met Private Link kan jy 'n **private eindpunt in jou VNet skep** wat direk aan die Azure SQL Database-diens koppel. Hierdie eindpunt laat die databasis voorkom asof dit deel is van jou eie VNet, toeganklik via 'n private IP-adres, wat veilige en private toegang verseker.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Service Endpoints

Azure Service Endpoints brei jou virtuele netwerk se private adresruimte en die identiteit van jou VNet uit na Azure-dienste oor 'n direkte verbinding. Deur diens-eindpunte te aktiveer, kan **hulpbronne in jou VNet veilig aan Azure-dienste koppel**, soos Azure Storage en Azure SQL Database, deur Azure se ruggraatnetwerk te gebruik. Dit verseker dat die **verkeer van die VNet na die Azure-diens binne die Azure-netwerk bly**, wat 'n veiliger en betroubaarder pad bied.

### **Voorbeeld**

* Byvoorbeeld, 'n **Azure Storage**-rekening is standaard oor die publieke internet toeganklik. Deur 'n **diens-eindpunt vir Azure Storage binne jou VNet** te aktiveer, kan jy verseker dat slegs verkeer van jou VNet toegang tot die stoorrekening het. Die stoorrekening se firewall kan dan gekonfigureer word om slegs verkeer van jou VNet te aanvaar.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Verskille Tussen Diens Eindpunte en Private Skakels

Microsoft beveel aan om Private Skakels te gebruik in die [**dokumentasie**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints):\\

<figure><img src="../../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

**Diens Eindpunte:**

* Verkeer vanaf jou VNet na die Azure-diens reis oor die Microsoft Azure-ruggraatnetwerk, wat die publieke internet omseil.
* Die eindpunt is 'n direkte verbinding na die Azure-diens en verskaf nie 'n private IP vir die diens binne die VNet nie.
* Die diens self is steeds toeganklik via sy publieke eindpunt van buite jou VNet, tensy jy die diens se firewall konfigureer om sulke verkeer te blokkeer.
* Dit is 'n een-tot-een verhouding tussen die subnet en die Azure-diens.
* Minder duur as Private Skakels.

**Private Skakels:**

* Private Skakel karteer Azure-dienste in jou VNet via 'n private eindpunt, wat 'n netwerk-koppelvlak met 'n private IP-adres binne jou VNet is.
* Die Azure-diens word gebruik deur hierdie private IP-adres, wat dit laat voorkom asof dit deel is van jou netwerk.
* Dienste wat via Private Skakel gekoppel is, kan slegs vanaf jou VNet of gekoppelde netwerke gebruik word; daar is geen publieke internettoegang tot die diens nie.
* Dit maak 'n veilige verbinding met Azure-dienste of jou eie dienste wat in Azure aangebied word, sowel as 'n verbinding met dienste wat deur ander gedeel word.
* Dit verskaf meer gedetailleerde toegangsbeheer via 'n private eindpunt in jou VNet, in teenstelling met bre√´r toegangsbeheer op die subnetvlak met diens eindpunte.

In opsomming, terwyl beide Diens Eindpunte en Private Skakels veilige konnektiwiteit aan Azure-dienste verskaf, **bied Private Skakels 'n ho√´r vlak van isolasie en sekuriteit deur te verseker dat dienste privaat gebruik word sonder om dit aan die publieke internet bloot te stel**. Diens Eindpunte, aan die ander kant, is makliker om op te stel vir algemene gevalle waar eenvoudige, veilige toegang tot Azure-dienste benodig word sonder die behoefte aan 'n private IP in die VNet.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door** is 'n skaalbare en veilige toegangspunt vir **vinnige aflewering** van jou globale webtoepassings. Dit **kombineer** verskeie dienste soos globale **lasbalansering, werfversnelling, SSL-aflaai, en Webtoepassings Firewall (WAF)** vermo√´ns in 'n enkele diens. Azure Front Door verskaf intelligente roetering gebaseer op die **naaste randligging aan die gebruiker**, wat optimale prestasie en betroubaarheid verseker. Daarbenewens bied dit URL-gebaseerde roetering, veelvuldige werfhosting, sessie-affiniteit, en toepassingslaag sekuriteit.

**Azure Front Door WAF** is ontwerp om **webtoepassings te beskerm teen webgebaseerde aanvalle** sonder aanpassing aan agterkantkode. Dit sluit persoonlike re√´ls en bestuurde re√´lstelle in om te beskerm teen bedreigings soos SQL-inspuiting, kruis-webwerf skripsie, en ander algemene aanvalle.

### **Voorbeeld**

* Stel jou voor jy het 'n w√™reldwyd verspreide toepassing met gebruikers regoor die w√™reld. Jy kan Azure Front Door gebruik om **gebruiker versoeke na die naaste streek datacentrum** wat jou toepassing aanbied, te roeteer, wat latensie verminder, gebruikerservaring verbeter en **dit verdedig teen webaanvalle met die WAF vermo√´ns**. As 'n spesifieke streek stilstand ervaar, kan Azure Front Door outomaties verkeer herlei na die volgende beste ligging, wat ho√´ beskikbaarheid verseker.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Application Gateway en Azure Application Gateway WAF

Azure Application Gateway is 'n **webverkeer-lasbalanseerder** wat jou in staat stel om verkeer na jou **web** toepassings te bestuur. Dit bied **Laag 7 lasbalansering, SSL-terminasie, en webtoepassingsfirewall (WAF) vermo√´ns** in die Application Delivery Controller (ADC) as 'n diens. Sleutelfunksies sluit in URL-gebaseerde roetering, koekie-gebaseerde sessie-affiniteit, en veilige sokkellaag (SSL) aflaai, wat noodsaaklik is vir toepassings wat komplekse lasbalanseringsvermo√´ns benodig soos globale roetering en pad-gebaseerde roetering.

### Voorbeeld

* Oorweeg 'n scenario waar jy 'n e-handelswebwerf het wat verskeie subdomeine insluit vir verskillende funksies, soos gebruikersrekeninge en betalingsverwerking. Azure Application Gateway kan **verkeer na die toepaslike webbedieners roeteer gebaseer op die URL-pad**. Byvoorbeeld, verkeer na `example.com/accounts` kan na die gebruikersrekeninge-diens gerig word, en verkeer na `example.com/pay` kan na die betalingsverwerkingsdiens gerig word.\
En **beskerm jou webwerf teen aanvalle deur die WAF-vermo√´ns te gebruik.**

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** is 'n netwerkfunksie in Azure wat **verskillende Virtuele Netwerke (VNets) toelaat om direk en naatloos gekoppel te word**. Deur VNet peering kan hulpbronne in een VNet kommunikeer met hulpbronne in 'n ander VNet deur private IP-adresse te gebruik, **asof hulle in dieselfde netwerk is**.\
**VNet Peering kan ook gebruik word met 'n on-prem netwerke** deur 'n site-to-site VPN of Azure ExpressRoute op te stel.

**Azure Hub en Spoke** is 'n netwerk topologie wat in Azure gebruik word om netwerkverkeer te bestuur en te organiseer. **Die "hub" is 'n sentrale punt wat verkeer tussen verskillende "spokes" beheer en roeteer**. Die hub bevat tipies gedeelde dienste soos netwerk virtuele toestelle (NVAs), Azure VPN Gateway, Azure Firewall, of Azure Bastion. Die **"spokes" is VNets wat werklaste huisves en aan die hub koppel deur VNet peering**, wat hulle toelaat om die gedeelde dienste binne die hub te benut. Hierdie model bevorder 'n skoon netwerk uitleg, wat kompleksiteit verminder deur algemene dienste te sentraliseer wat verskeie werklaste oor verskillende VNets kan gebruik.

{% hint style="danger" %}
**VNET peering is nie-transitief in Azure**, wat beteken dat as spoke 1 aan spoke 2 gekoppel is en spoke 2 aan spoke 3 gekoppel is, dan kan spoke 1 nie direk met spoke 3 praat nie.
{% endhint %}

### Voorbeelde

* Stel jou 'n maatskappy voor met afsonderlike afdelings soos Verkope, HR, en Ontwikkeling, **elk met sy eie VNet (die spokes)**. Hierdie VNets **vereis toegang tot gedeelde hulpbronne** soos 'n sentrale databasis, 'n firewall, en 'n internet gateway, wat almal in **'n ander VNet (die hub)** gele√´ is. Deur die Hub en Spoke model te gebruik, kan elke afdeling **veilig aan die gedeelde hulpbronne koppel deur die hub VNet sonder om daardie hulpbronne aan die publieke internet bloot te stel** of 'n komplekse netwerkstruktuur met talle verbindings te skep.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

'n Site-to-Site VPN in Azure laat jou toe om jou **on-premises netwerk aan jou Azure Virtual Network (VNet) te koppel**, wat hulpbronne soos VMs binne Azure laat voorkom asof hulle op jou plaaslike netwerk is. Hierdie verbinding word gevestig deur 'n **VPN-gateway wat verkeer tussen die twee netwerke enkripteer**.

### **Voorbeeld**

* 'n Besigheid met sy hoofkantoor in New York het 'n on-premises datacentrum wat veilig aan sy VNet in Azure moet koppel, wat sy gevirtualiseerde werklaste huisves. Deur 'n **Site-to-Site VPN op te stel, kan die maatskappy verseker dat daar ge√´nkripteerde konnektiwiteit tussen die on-premises bedieners en die Azure VMs is**, wat toelaat dat hulpbronne veilig oor beide omgewings verkry kan word asof hulle in dieselfde plaaslike netwerk is.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute is 'n diens wat 'n **private, toegewyde, ho√´spoed-verbinding tussen jou plaaslike infrastruktuur en Azure-datasentrums** verskaf. Hierdie verbinding word gemaak deur 'n konnektiwiteitsverskaffer, wat die publieke internet omseil en meer betroubaarheid, vinniger spoed, laer latensies, en ho√´r sekuriteit bied as tipiese internetverbindings.

### **Voorbeeld**

* 'n Multinasionale korporasie benodig 'n **konsekwente en betroubare verbinding na sy Azure-dienste as gevolg van die ho√´ volume data** en die behoefte aan ho√´ deurset. Die maatskappy kies vir Azure ExpressRoute om sy plaaslike datasentrum direk aan Azure te koppel, wat grootskaalse data-oordragte vergemaklik, soos daaglikse rugsteun en intydse data-analise, met verbeterde privaatheid en spoed.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

{% hint style="success" %}
Leer en oefen AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Leer en oefen GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**intekenplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-bewaarplekke.

</details>
{% endhint %}
