# Az - Azure Network

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Azure å†…çš„ç½‘ç»œä½œä¸ºå…¶äº‘è®¡ç®—å¹³å°çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œèƒ½å¤Ÿå®ç°**å„ç§ Azure æœåŠ¡å’Œèµ„æºä¹‹é—´çš„è¿æ¥å’Œé€šä¿¡**ã€‚Azure çš„ç½‘ç»œæ¶æ„è®¾è®¡ä¸ºé«˜åº¦å¯æ‰©å±•ã€å®‰å…¨ä¸”å¯å®šåˆ¶ã€‚

Azure æä¾›çš„æ ¸å¿ƒæœåŠ¡æ˜¯**è™šæ‹Ÿç½‘ç»œ (VNet)**ï¼Œå…è®¸ç”¨æˆ·åœ¨ Azure äº‘ä¸­åˆ›å»º**éš”ç¦»çš„ç½‘ç»œ**ã€‚åœ¨è¿™äº› VNet ä¸­ï¼Œå¯ä»¥å®‰å…¨åœ°æ‰˜ç®¡å’Œç®¡ç†è™šæ‹Ÿæœºã€åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“ç­‰èµ„æºã€‚Azure çš„ç½‘ç»œæ”¯æŒäº‘å†…é€šä¿¡ï¼ˆAzure æœåŠ¡ä¹‹é—´ï¼‰ä»¥åŠä¸å¤–éƒ¨ç½‘ç»œå’Œäº’è”ç½‘çš„è¿æ¥ã€‚

**å®‰å…¨æ€§**æ˜¯ Azure ç½‘ç»œçš„ä¸€ä¸ªå…³é”®æ–¹é¢ï¼Œæä¾›äº†å„ç§å·¥å…·å’ŒæœåŠ¡æ¥ä¿æŠ¤æ•°æ®ã€ç®¡ç†è®¿é—®å’Œç¡®ä¿åˆè§„æ€§ã€‚è¿™äº›å®‰å…¨æªæ–½åŒ…æ‹¬**é˜²ç«å¢™**ã€**ç½‘ç»œå®‰å…¨ç»„**å’Œ**åŠ å¯†**åŠŸèƒ½ï¼Œå…è®¸å¯¹æµé‡å’Œè®¿é—®è¿›è¡Œé«˜åº¦æ§åˆ¶ã€‚

æ€»ä½“è€Œè¨€ï¼ŒAzure çš„ç½‘ç»œåŠŸèƒ½æ—¨åœ¨æä¾›çµæ´»æ€§ï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºé€‚åˆå…¶ç‰¹å®šåº”ç”¨å’Œå·¥ä½œè´Ÿè½½éœ€æ±‚çš„ç½‘ç»œç¯å¢ƒï¼ŒåŒæ—¶ä¿æŒå¯¹å®‰å…¨æ€§å’Œå¯é æ€§çš„é«˜åº¦é‡è§†ã€‚

## Virtual Network (VNET) & Subnets

Azure ä¸­çš„ VNet æœ¬è´¨ä¸Šæ˜¯æ‚¨åœ¨äº‘ä¸­çš„è‡ªæœ‰ç½‘ç»œçš„è¡¨ç¤ºã€‚å®ƒæ˜¯**ä¸“ç”¨äºæ‚¨çš„è®¢é˜…çš„ Azure äº‘çš„é€»è¾‘éš”ç¦»**ã€‚VNet å…è®¸æ‚¨åœ¨ Azure ä¸­é…ç½®å’Œç®¡ç†è™šæ‹Ÿä¸“ç”¨ç½‘ç»œ (VPN)ï¼Œå¹¶å¯ç”¨äºæ‰˜ç®¡å’Œ**ç®¡ç†å¤šç§ç±»å‹çš„ Azure èµ„æº**ï¼Œå¦‚è™šæ‹Ÿæœº (VM)ã€æ•°æ®åº“å’Œåº”ç”¨æœåŠ¡ã€‚

VNet ä¸ºæ‚¨æä¾›**å®Œå…¨æ§åˆ¶ç½‘ç»œè®¾ç½®**çš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬**IP åœ°å€**èŒƒå›´ã€å­ç½‘åˆ›å»ºã€è·¯ç”±è¡¨å’Œç½‘ç»œç½‘å…³ã€‚

**å­ç½‘**æ˜¯ VNet ä¸­çš„**IP åœ°å€èŒƒå›´**ã€‚æ‚¨å¯ä»¥å°† VNet åˆ’åˆ†ä¸ºå¤šä¸ªå­ç½‘ä»¥ä¾¿äºç»„ç»‡å’Œå®‰å…¨ã€‚VNet ä¸­çš„æ¯ä¸ªå­ç½‘å¯ç”¨äºæ ¹æ®æ‚¨çš„ç½‘ç»œå’Œåº”ç”¨æ¶æ„éš”ç¦»å’Œåˆ†ç»„èµ„æºã€‚

æ­¤å¤–ï¼Œå­ç½‘å…è®¸æ‚¨**å°† VNet åˆ†æ®µä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå­ç½‘ç»œ**ï¼Œæä¾›èµ„æºå¯ä»¥ä½¿ç”¨çš„ä¸€ç³»åˆ— IP åœ°å€ã€‚

### **Example**

* å‡è®¾æ‚¨æœ‰ä¸€ä¸ªåä¸º `MyVNet` çš„ VNetï¼Œå…¶ IP åœ°å€èŒƒå›´ä¸º `10.0.0.0/16`ã€‚æ‚¨å¯ä»¥åœ¨æ­¤ VNet ä¸­åˆ›å»ºä¸€ä¸ªå­ç½‘ï¼Œä¾‹å¦‚ `Subnet-1`ï¼Œå…¶ IP åœ°å€èŒƒå›´ä¸º `10.0.0.0/24`ï¼Œç”¨äºæ‰˜ç®¡æ‚¨çš„ Web æœåŠ¡å™¨ã€‚å¦ä¸€ä¸ªå­ç½‘ `Subnet-2`ï¼ŒèŒƒå›´ä¸º `10.0.1.0/24`ï¼Œå¯ä»¥ç”¨äºæ‚¨çš„æ•°æ®åº“æœåŠ¡å™¨ã€‚è¿™ç§åˆ†æ®µå…è®¸åœ¨ç½‘ç»œå†…è¿›è¡Œé«˜æ•ˆçš„ç®¡ç†å’Œå®‰å…¨æ§åˆ¶ã€‚

### Enumeration

è¦åˆ—å‡º Azure è´¦æˆ·ä¸­çš„æ‰€æœ‰ VNet å’Œå­ç½‘ï¼Œå¯ä»¥ä½¿ç”¨ Azure å‘½ä»¤è¡Œç•Œé¢ (CLI)ã€‚ä»¥ä¸‹æ˜¯æ­¥éª¤ï¼š
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## Network Security Groups (NSG)

åœ¨ Azure ä¸­ï¼Œ**Network Security Group (NSG)** çš„ä¸»è¦åŠŸèƒ½æ˜¯è¿‡æ»¤ Azure Virtual Network (VNet) å†… Azure èµ„æºçš„ç½‘ç»œæµé‡ã€‚å®ƒåŒ…å«ä¸€ç»„**å®‰å…¨è§„åˆ™**ï¼Œè¯¦ç»†è§„å®šäº†ç½‘ç»œæµé‡çš„æµå‘ã€‚

NSG çš„å…³é”®æ–¹é¢åŒ…æ‹¬ï¼š

* **æµé‡æ§åˆ¶**ï¼šæ¯ä¸ª NSG åŒ…å«çš„è§„åˆ™å¯¹äºå…è®¸æˆ–é˜»æ­¢ä¸å„ç§ Azure èµ„æºç›¸å…³çš„å…¥ç«™å’Œå‡ºç«™ç½‘ç»œæµé‡è‡³å…³é‡è¦ã€‚
* **è§„åˆ™ç»„ä»¶**ï¼šNSG å†…çš„è§„åˆ™éå¸¸å…·ä½“ï¼ŒåŸºäºæº/ç›®æ ‡ IP åœ°å€ã€ç«¯å£å’Œåè®®ç­‰æ ‡å‡†è¿‡æ»¤æµé‡ã€‚è¿™ç§ç‰¹å¼‚æ€§å…è®¸å¯¹ç½‘ç»œæµé‡è¿›è¡Œç²¾ç»†ç®¡ç†ã€‚
* **å®‰å…¨å¢å¼º**ï¼šé€šè¿‡ç¡®ä¿åªæœ‰æˆæƒæµé‡å¯ä»¥è¿›å…¥æˆ–ç¦»å¼€æ‚¨çš„ Azure èµ„æºï¼ŒNSG åœ¨åŠ å¼ºç½‘ç»œåŸºç¡€è®¾æ–½çš„å®‰å…¨æ€åŠ¿æ–¹é¢èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚

### **ç¤ºä¾‹**

* å‡è®¾æ‚¨æœ‰ä¸€ä¸ªåä¸º `MyNSG` çš„ NSG åº”ç”¨äº VNet å†…çš„å­ç½‘æˆ–ç‰¹å®šè™šæ‹Ÿæœºã€‚æ‚¨å¯ä»¥åˆ›å»ºå¦‚ä¸‹è§„åˆ™ï¼š
* ä¸€ä¸ªå…¥ç«™è§„åˆ™ï¼Œå…è®¸æ¥è‡ªä»»ä½•æºçš„ HTTP æµé‡ï¼ˆç«¯å£ 80ï¼‰åˆ°æ‚¨çš„ Web æœåŠ¡å™¨ã€‚
* ä¸€ä¸ªå‡ºç«™è§„åˆ™ï¼Œä»…å…è®¸ SQL æµé‡ï¼ˆç«¯å£ 1433ï¼‰åˆ°ç‰¹å®šç›®æ ‡ IP åœ°å€èŒƒå›´ã€‚

### æšä¸¾

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall æ˜¯ä¸€ç§æ‰˜ç®¡çš„åŸºäºäº‘çš„**ç½‘ç»œå®‰å…¨æœåŠ¡ï¼Œç”¨äºä¿æŠ¤æ‚¨çš„ Azure è™šæ‹Ÿç½‘ç»œèµ„æº**ã€‚å®ƒæ˜¯ä¸€ç§å®Œå…¨æœ‰çŠ¶æ€çš„é˜²ç«å¢™å³æœåŠ¡ï¼Œå…·æœ‰å†…ç½®çš„é«˜å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§åŠŸèƒ½ã€‚

Azure Firewall æä¾›æ¯” **NSGs** æ›´é«˜çº§çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬**åº”ç”¨çº§è¿‡æ»¤**ã€ç½‘ç»œçº§è¿‡æ»¤ã€åŸºäºå¨èƒæƒ…æŠ¥çš„è¿‡æ»¤ä»¥åŠä¸ Azure Monitor çš„æ—¥å¿—è®°å½•å’Œåˆ†æé›†æˆã€‚\
å®ƒå¯ä»¥è¿‡æ»¤å‡ºç«™ã€å…¥ç«™ã€spoke-to-spokeã€VPN å’Œ ExpressRoute æµé‡ã€‚**é˜²ç«å¢™è§„åˆ™å¯ä»¥åŸºäº FQDNï¼ˆå®Œå…¨é™å®šåŸŸåï¼‰ã€IP åœ°å€å’Œç«¯å£åˆ›å»º**ã€‚

### Azure Firewall å’Œ NSGs ä¹‹é—´çš„åŒºåˆ«

1. **èŒƒå›´:**
* **NSG:** åœ¨å­ç½‘æˆ–ç½‘ç»œæ¥å£çº§åˆ«å·¥ä½œã€‚æ—¨åœ¨æä¾›å¯¹ç½‘ç»œæ¥å£ï¼ˆNICï¼‰ã€è™šæ‹Ÿæœºæˆ–å­ç½‘çš„å…¥ç«™å’Œå‡ºç«™æµé‡çš„åŸºæœ¬è¿‡æ»¤ã€‚
* **Azure Firewall:** åœ¨ VNet çº§åˆ«æ“ä½œï¼Œæä¾›æ›´å¹¿æ³›çš„ä¿æŠ¤èŒƒå›´ã€‚æ—¨åœ¨ä¿æŠ¤æ‚¨çš„è™šæ‹Ÿç½‘ç»œèµ„æºå¹¶ç®¡ç†æµå…¥å’Œæµå‡º VNet çš„æµé‡ã€‚
2. **åŠŸèƒ½:**
* **NSG:** æä¾›åŸºäº IP åœ°å€ã€ç«¯å£å’Œåè®®çš„åŸºæœ¬è¿‡æ»¤åŠŸèƒ½ã€‚ä¸æ”¯æŒåº”ç”¨çº§æ£€æŸ¥æˆ–å¨èƒæƒ…æŠ¥ç­‰é«˜çº§åŠŸèƒ½ã€‚
* **Azure Firewall:** æä¾›é«˜çº§åŠŸèƒ½ï¼Œå¦‚åº”ç”¨çº§ï¼ˆç¬¬ 7 å±‚ï¼‰æµé‡è¿‡æ»¤ã€åŸºäºå¨èƒæƒ…æŠ¥çš„è¿‡æ»¤ã€ç½‘ç»œæµé‡è¿‡æ»¤ç­‰ã€‚è¿˜æ”¯æŒå¤šä¸ªå…¬å…± IP åœ°å€ã€‚
3. **ä½¿ç”¨åœºæ™¯:**
* **NSG:** é€‚ç”¨äºåŸºæœ¬çš„ç½‘ç»œçº§æµé‡è¿‡æ»¤ã€‚
* **Azure Firewall:** é€‚ç”¨äºéœ€è¦åº”ç”¨çº§æ§åˆ¶ã€æ—¥å¿—è®°å½•å’Œå¨èƒæƒ…æŠ¥çš„æ›´å¤æ‚çš„è¿‡æ»¤åœºæ™¯ã€‚
4. **ç®¡ç†å’Œç›‘æ§:**
* **NSG:** æä¾›åŸºæœ¬çš„æ—¥å¿—è®°å½•å’Œä¸ Azure Monitor çš„é›†æˆã€‚
* **Azure Firewall:** é€šè¿‡ Azure Monitor æä¾›é«˜çº§æ—¥å¿—è®°å½•å’Œåˆ†æåŠŸèƒ½ï¼Œè¿™å¯¹äºäº†è§£æµé‡çš„æ€§è´¨å’Œæ¨¡å¼è‡³å…³é‡è¦ã€‚

### æšä¸¾

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## Network Virtual Appliance (NVA)

Azure ä¸­çš„ Network Virtual Appliance (**NVA**) æ˜¯ä¸€ç§åœ¨è™šæ‹Ÿç½‘ç»œä¸­æ‰§è¡Œç½‘ç»œåŠŸèƒ½çš„è™šæ‹Ÿè®¾å¤‡ã€‚NVAs é€šå¸¸ç”¨äº Azure ä¸­**æœ¬åœ°ä¸å¯ç”¨**çš„ç½‘ç»œåŠŸèƒ½æˆ–éœ€è¦æ›´å¤šè‡ªå®šä¹‰æ—¶ã€‚å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯**è¿è¡Œç½‘ç»œåº”ç”¨ç¨‹åºæˆ–æœåŠ¡**çš„è™šæ‹Ÿæœºï¼Œä¾‹å¦‚é˜²ç«å¢™ã€WAN ä¼˜åŒ–å™¨æˆ–è´Ÿè½½å‡è¡¡å™¨ã€‚

NVAs ç”¨äºå¤æ‚çš„è·¯ç”±ã€**å®‰å…¨**å’Œ**ç½‘ç»œæµé‡ç®¡ç†**ä»»åŠ¡ã€‚å®ƒä»¬å¯ä»¥ä» Azure **Marketplace** éƒ¨ç½²ï¼Œè®¸å¤šç¬¬ä¸‰æ–¹ä¾›åº”å•†åœ¨æ­¤æä¾›å…¶è®¾å¤‡ï¼Œå‡†å¤‡é›†æˆåˆ° Azure ç¯å¢ƒä¸­ã€‚

### **ç¤ºä¾‹**

* ä¸€ä¸ªç»„ç»‡å¯ä»¥åœ¨ Azure ä¸­éƒ¨ç½²ä¸€ä¸ª NVA æ¥åˆ›å»ºä¸€ä¸ª**è‡ªå®šä¹‰é˜²ç«å¢™è§£å†³æ–¹æ¡ˆ**ã€‚è¿™ä¸ª NVA å¯ä»¥è¿è¡Œ**ç¬¬ä¸‰æ–¹é˜²ç«å¢™è½¯ä»¶**ï¼Œæä¾›é«˜çº§åŠŸèƒ½ï¼Œå¦‚å…¥ä¾µæ£€æµ‹ã€æ•°æ®åŒ…æ£€æŸ¥æˆ– VPN è¿æ¥ã€‚NVA å¯ä»¥é…ç½®ä¸ºæ£€æŸ¥å’Œè¿‡æ»¤é€šè¿‡å®ƒçš„æµé‡ï¼Œç¡®ä¿æ ¹æ®ç»„ç»‡çš„æ”¿ç­–å®æ–½å¢å¼ºçš„å®‰å…¨æªæ–½ã€‚

### **æšä¸¾**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
{% endcode %}

## Azure Route Tables & User Defined Routes (UDR)

**Azure Route Tables** æ˜¯ Microsoft Azure ä¸­çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå…è®¸åœ¨ **Azure Virtual Networks (VNets) å†…æ§åˆ¶ç½‘ç»œæµé‡è·¯ç”±**ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒä»¬å®šä¹‰äº† **æ•°æ®åŒ…** åœ¨ VNets å†…çš„å­ç½‘ä¹‹é—´ã€VNets ä¹‹é—´æˆ–åˆ°å¤–éƒ¨ç½‘ç»œä¹‹é—´çš„ **è½¬å‘** æ–¹å¼ã€‚æ¯ä¸ªè·¯ç”±è¡¨åŒ…å«ä¸€ç»„è§„åˆ™ï¼Œç§°ä¸ºè·¯ç”±ï¼Œè¿™äº›è§„åˆ™æŒ‡å®šäº†æ•°æ®åŒ…åº”å¦‚ä½•æ ¹æ®å…¶ç›®æ ‡ IP åœ°å€è¿›è¡Œè·¯ç”±ã€‚

**User Defined Routes (UDR)** æ˜¯ Azure ä¸­çš„ **è‡ªå®šä¹‰è·¯ç”±**ï¼Œæ‚¨å¯ä»¥åœ¨ Azure Route Tables ä¸­åˆ›å»ºè¿™äº›è·¯ç”±ï¼Œä»¥æ§åˆ¶ **ç½‘ç»œæµé‡çš„æµåŠ¨**ï¼Œæ— è®ºæ˜¯åœ¨ Azure Virtual Networks (VNets) å†…éƒ¨ã€VNets ä¹‹é—´ï¼Œè¿˜æ˜¯åˆ°å¤–éƒ¨è¿æ¥ã€‚UDR ä½¿æ‚¨èƒ½å¤Ÿæ ¹æ®ç‰¹å®šéœ€æ±‚çµæ´»åœ°å¼•å¯¼ç½‘ç»œæµé‡ï¼Œè¦†ç›– Azure çš„é»˜è®¤è·¯ç”±å†³ç­–ã€‚

è¿™äº›è·¯ç”±åœ¨éœ€è¦ **é€šè¿‡è™šæ‹Ÿè®¾å¤‡è·¯ç”±æµé‡**ã€ä¸ºå®‰å…¨æˆ–æ”¿ç­–åˆè§„æ€§å¼ºåˆ¶ç‰¹å®šè·¯å¾„æˆ–ä¸æœ¬åœ°ç½‘ç»œé›†æˆçš„åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨ã€‚

### **ç¤ºä¾‹**

* å‡è®¾æ‚¨éƒ¨ç½²äº†ä¸€ä¸ª Network Virtual Appliance (NVA) æ¥æ£€æŸ¥ VNet å†…å­ç½‘ä¹‹é—´çš„æµé‡ã€‚æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ª UDRï¼Œå°†ä¸€ä¸ªå­ç½‘åˆ°å¦ä¸€ä¸ªå­ç½‘çš„æ‰€æœ‰æµé‡å¼•å¯¼é€šè¿‡ NVAã€‚è¿™ä¸ª UDR ç¡®ä¿ NVA åœ¨æµé‡åˆ°è¾¾ç›®çš„åœ°ä¹‹å‰å¯¹å…¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚

### **æšä¸¾**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Private Link

Azure Private Link æ˜¯ Azure ä¸­çš„ä¸€é¡¹æœåŠ¡ï¼Œé€šè¿‡ç¡®ä¿ **Azure è™šæ‹Ÿç½‘ç»œ (VNet) å’ŒæœåŠ¡ä¹‹é—´çš„æµé‡å®Œå…¨åœ¨ Microsoft çš„ Azure ä¸»å¹²ç½‘ç»œå†…ä¼ è¾“**ï¼Œä»è€Œ **å®ç°å¯¹ Azure æœåŠ¡çš„ç§æœ‰è®¿é—®**ã€‚å®ƒæœ‰æ•ˆåœ°å°†æœåŠ¡å¼•å…¥æ‚¨çš„ VNetã€‚è¿™ç§è®¾ç½®é€šè¿‡ä¸å°†æ•°æ®æš´éœ²åœ¨å…¬å…±äº’è”ç½‘ä¸­æ¥å¢å¼ºå®‰å…¨æ€§ã€‚

Private Link å¯ä»¥ä¸å„ç§ Azure æœåŠ¡ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ Azure Storageã€Azure SQL Database å’Œé€šè¿‡ Private Link å…±äº«çš„è‡ªå®šä¹‰æœåŠ¡ã€‚å®ƒæä¾›äº†ä¸€ç§ä»æ‚¨è‡ªå·±çš„ VNet ç”šè‡³ä¸åŒçš„ Azure è®¢é˜…ä¸­å®‰å…¨ä½¿ç”¨æœåŠ¡çš„æ–¹æ³•ã€‚

{% hint style="danger" %}
NSG ä¸é€‚ç”¨äºç§æœ‰ç«¯ç‚¹ï¼Œè¿™æ˜¾ç„¶æ„å‘³ç€å°† NSG ä¸åŒ…å« Private Link çš„å­ç½‘å…³è”å°†æ²¡æœ‰æ•ˆæœã€‚
{% endhint %}

### **ç¤ºä¾‹**

* è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œæ‚¨æœ‰ä¸€ä¸ª **Azure SQL Databaseï¼Œæ‚¨å¸Œæœ›ä»æ‚¨çš„ VNet å®‰å…¨è®¿é—®**ã€‚é€šå¸¸ï¼Œè¿™å¯èƒ½æ¶‰åŠé€šè¿‡å…¬å…±äº’è”ç½‘ã€‚ä½¿ç”¨ Private Linkï¼Œæ‚¨å¯ä»¥åœ¨æ‚¨çš„ VNet ä¸­åˆ›å»ºä¸€ä¸ª **ç›´æ¥è¿æ¥åˆ° Azure SQL Database æœåŠ¡çš„ç§æœ‰ç«¯ç‚¹**ã€‚æ­¤ç«¯ç‚¹ä½¿æ•°æ®åº“çœ‹èµ·æ¥åƒæ˜¯æ‚¨è‡ªå·± VNet çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡ç§æœ‰ IP åœ°å€è®¿é—®ï¼Œä»è€Œç¡®ä¿å®‰å…¨å’Œç§æœ‰è®¿é—®ã€‚

### **æšä¸¾**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Service Endpoints

Azure Service Endpoints æ‰©å±•äº†æ‚¨çš„è™šæ‹Ÿç½‘ç»œç§æœ‰åœ°å€ç©ºé—´å’Œ VNet çš„èº«ä»½ï¼Œé€šè¿‡ç›´æ¥è¿æ¥åˆ° Azure æœåŠ¡ã€‚é€šè¿‡å¯ç”¨æœåŠ¡ç«¯ç‚¹ï¼Œ**VNet ä¸­çš„èµ„æºå¯ä»¥å®‰å…¨åœ°è¿æ¥åˆ° Azure æœåŠ¡**ï¼Œå¦‚ Azure Storage å’Œ Azure SQL Databaseï¼Œä½¿ç”¨ Azure çš„éª¨å¹²ç½‘ç»œã€‚è¿™ç¡®ä¿äº†**ä» VNet åˆ° Azure æœåŠ¡çš„æµé‡ä¿æŒåœ¨ Azure ç½‘ç»œå†…**ï¼Œæä¾›äº†æ›´å®‰å…¨å’Œå¯é çš„è·¯å¾„ã€‚

### **Example**

* ä¾‹å¦‚ï¼Œä¸€ä¸ª**Azure Storage** è´¦æˆ·é»˜è®¤æƒ…å†µä¸‹å¯ä»¥é€šè¿‡å…¬å…±äº’è”ç½‘è®¿é—®ã€‚é€šè¿‡åœ¨ VNet ä¸­å¯ç”¨**Azure Storage çš„æœåŠ¡ç«¯ç‚¹**ï¼Œæ‚¨å¯ä»¥ç¡®ä¿åªæœ‰æ¥è‡ª VNet çš„æµé‡å¯ä»¥è®¿é—®å­˜å‚¨è´¦æˆ·ã€‚ç„¶åå¯ä»¥é…ç½®å­˜å‚¨è´¦æˆ·é˜²ç«å¢™ï¼Œä»…æ¥å—æ¥è‡ª VNet çš„æµé‡ã€‚

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Service Endpoints å’Œ Private Links ä¹‹é—´çš„åŒºåˆ«

Microsoft åœ¨ [**docs**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints) ä¸­æ¨èä½¿ç”¨ Private Linksï¼š\\

<figure><img src="../../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

**Service Endpoints:**

* ä»ä½ çš„ VNet åˆ° Azure æœåŠ¡çš„æµé‡é€šè¿‡ Microsoft Azure ä¸»å¹²ç½‘ç»œä¼ è¾“ï¼Œç»•è¿‡å…¬å…±äº’è”ç½‘ã€‚
* ç«¯ç‚¹æ˜¯åˆ° Azure æœåŠ¡çš„ç›´æ¥è¿æ¥ï¼Œå¹¶ä¸åœ¨ VNet å†…ä¸ºæœåŠ¡æä¾›ç§æœ‰ IPã€‚
* é™¤éä½ é…ç½®æœåŠ¡é˜²ç«å¢™ä»¥é˜»æ­¢æ­¤ç±»æµé‡ï¼Œå¦åˆ™æœåŠ¡æœ¬èº«ä»å¯é€šè¿‡å…¶å…¬å…±ç«¯ç‚¹ä»ä½ çš„ VNet å¤–éƒ¨è®¿é—®ã€‚
* å­ç½‘å’Œ Azure æœåŠ¡ä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚
* æ¯” Private Links ä¾¿å®œã€‚

**Private Links:**

* Private Link é€šè¿‡ç§æœ‰ç«¯ç‚¹å°† Azure æœåŠ¡æ˜ å°„åˆ°ä½ çš„ VNetï¼Œç§æœ‰ç«¯ç‚¹æ˜¯ VNet å†…å…·æœ‰ç§æœ‰ IP åœ°å€çš„ç½‘ç»œæ¥å£ã€‚
* ä½¿ç”¨æ­¤ç§æœ‰ IP åœ°å€è®¿é—® Azure æœåŠ¡ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒæ˜¯ä½ ç½‘ç»œçš„ä¸€éƒ¨åˆ†ã€‚
* é€šè¿‡ Private Link è¿æ¥çš„æœåŠ¡åªèƒ½ä»ä½ çš„ VNet æˆ–è¿æ¥çš„ç½‘ç»œè®¿é—®ï¼›æœåŠ¡æ²¡æœ‰å…¬å…±äº’è”ç½‘è®¿é—®ã€‚
* å®ƒä½¿å¾—ä¸ Azure æœåŠ¡æˆ–ä½ åœ¨ Azure ä¸­æ‰˜ç®¡çš„æœåŠ¡çš„å®‰å…¨è¿æ¥æˆä¸ºå¯èƒ½ï¼Œä»¥åŠä¸ä»–äººå…±äº«çš„æœåŠ¡çš„è¿æ¥ã€‚
* å®ƒé€šè¿‡ VNet ä¸­çš„ç§æœ‰ç«¯ç‚¹æä¾›æ›´ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶ï¼Œè€Œä¸æ˜¯é€šè¿‡æœåŠ¡ç«¯ç‚¹åœ¨å­ç½‘çº§åˆ«æä¾›æ›´å¹¿æ³›çš„è®¿é—®æ§åˆ¶ã€‚

æ€»ä¹‹ï¼Œè™½ç„¶ Service Endpoints å’Œ Private Links éƒ½æä¾›äº†å¯¹ Azure æœåŠ¡çš„å®‰å…¨è¿æ¥ï¼Œä½† **Private Links é€šè¿‡ç¡®ä¿æœåŠ¡ç§å¯†è®¿é—®è€Œä¸æš´éœ²äºå…¬å…±äº’è”ç½‘ï¼Œæä¾›äº†æ›´é«˜æ°´å¹³çš„éš”ç¦»å’Œå®‰å…¨æ€§**ã€‚å¦ä¸€æ–¹é¢ï¼ŒService Endpoints æ›´å®¹æ˜“è®¾ç½®ï¼Œé€‚ç”¨äºä¸éœ€è¦åœ¨ VNet ä¸­ä½¿ç”¨ç§æœ‰ IP çš„ä¸€èˆ¬æƒ…å†µä¸‹çš„ç®€å•ã€å®‰å…¨çš„ Azure æœåŠ¡è®¿é—®ã€‚

## Azure Front Door (AFD) å’Œ AFD WAF

**Azure Front Door** æ˜¯ä¸€ä¸ªå¯æ‰©å±•ä¸”å®‰å…¨çš„å…¥å£ç‚¹ï¼Œç”¨äº**å¿«é€Ÿäº¤ä»˜**ä½ çš„å…¨çƒ Web åº”ç”¨ç¨‹åºã€‚å®ƒ**ç»“åˆ**äº†å„ç§æœåŠ¡ï¼Œå¦‚å…¨çƒ**è´Ÿè½½å‡è¡¡ã€ç«™ç‚¹åŠ é€Ÿã€SSL å¸è½½å’Œ Web åº”ç”¨é˜²ç«å¢™ (WAF)** åŠŸèƒ½äºä¸€ä½“ã€‚Azure Front Door æä¾›åŸºäº**ç”¨æˆ·æœ€è¿‘çš„è¾¹ç¼˜ä½ç½®**çš„æ™ºèƒ½è·¯ç”±ï¼Œç¡®ä¿æœ€ä½³æ€§èƒ½å’Œå¯é æ€§ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æä¾›åŸºäº URL çš„è·¯ç”±ã€å¤šç«™ç‚¹æ‰˜ç®¡ã€ä¼šè¯äº²å’Œæ€§å’Œåº”ç”¨å±‚å®‰å…¨æ€§ã€‚

**Azure Front Door WAF** æ—¨åœ¨**ä¿æŠ¤ Web åº”ç”¨ç¨‹åºå…å—åŸºäº Web çš„æ”»å‡»**ï¼Œæ— éœ€ä¿®æ”¹åç«¯ä»£ç ã€‚å®ƒåŒ…æ‹¬è‡ªå®šä¹‰è§„åˆ™å’Œæ‰˜ç®¡è§„åˆ™é›†ï¼Œä»¥é˜²æ­¢ SQL æ³¨å…¥ã€è·¨ç«™è„šæœ¬å’Œå…¶ä»–å¸¸è§æ”»å‡»ã€‚

### **ç¤ºä¾‹**

* å‡è®¾ä½ æœ‰ä¸€ä¸ªå…¨çƒåˆ†å¸ƒçš„åº”ç”¨ç¨‹åºï¼Œç”¨æˆ·éå¸ƒä¸–ç•Œå„åœ°ã€‚ä½ å¯ä»¥ä½¿ç”¨ Azure Front Door å°†**ç”¨æˆ·è¯·æ±‚è·¯ç”±åˆ°æœ€è¿‘çš„åŒºåŸŸæ•°æ®ä¸­å¿ƒ**æ‰˜ç®¡ä½ çš„åº”ç”¨ç¨‹åºï¼Œä»è€Œå‡å°‘å»¶è¿Ÿï¼Œæ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œå¹¶**é€šè¿‡ WAF åŠŸèƒ½ä¿æŠ¤å…¶å…å— Web æ”»å‡»**ã€‚å¦‚æœæŸä¸ªåŒºåŸŸå‘ç”Ÿåœæœºï¼ŒAzure Front Door å¯ä»¥è‡ªåŠ¨å°†æµé‡é‡æ–°è·¯ç”±åˆ°ä¸‹ä¸€ä¸ªæœ€ä½³ä½ç½®ï¼Œç¡®ä¿é«˜å¯ç”¨æ€§ã€‚

### æšä¸¾

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Application Gateway å’Œ Azure Application Gateway WAF

Azure Application Gateway æ˜¯ä¸€ä¸ª**ç½‘ç»œæµé‡è´Ÿè½½å‡è¡¡å™¨**ï¼Œä½¿æ‚¨èƒ½å¤Ÿç®¡ç†åˆ°**ç½‘ç»œ**åº”ç”¨ç¨‹åºçš„æµé‡ã€‚å®ƒåœ¨åº”ç”¨äº¤ä»˜æ§åˆ¶å™¨ï¼ˆADCï¼‰ä¸­æä¾›**ç¬¬7å±‚è´Ÿè½½å‡è¡¡ã€SSLç»ˆæ­¢å’Œç½‘ç»œåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰åŠŸèƒ½**ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬åŸºäºURLçš„è·¯ç”±ã€åŸºäºcookieçš„ä¼šè¯äº²å’Œæ€§å’Œå®‰å…¨å¥—æ¥å­—å±‚ï¼ˆSSLï¼‰å¸è½½ï¼Œè¿™å¯¹äºéœ€è¦å¤æ‚è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼ˆå¦‚å…¨å±€è·¯ç”±å’ŒåŸºäºè·¯å¾„çš„è·¯ç”±ï¼‰çš„åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚

### ç¤ºä¾‹

* è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œæ‚¨æœ‰ä¸€ä¸ªåŒ…å«å¤šä¸ªå­åŸŸçš„ç”µå­å•†åŠ¡ç½‘ç«™ï¼Œç”¨äºä¸åŒçš„åŠŸèƒ½ï¼Œå¦‚ç”¨æˆ·è´¦æˆ·å’Œæ”¯ä»˜å¤„ç†ã€‚Azure Application Gateway å¯ä»¥**æ ¹æ®URLè·¯å¾„å°†æµé‡è·¯ç”±åˆ°é€‚å½“çš„ç½‘ç»œæœåŠ¡å™¨**ã€‚ä¾‹å¦‚ï¼Œ`example.com/accounts` çš„æµé‡å¯ä»¥è¢«å®šå‘åˆ°ç”¨æˆ·è´¦æˆ·æœåŠ¡ï¼Œè€Œ `example.com/pay` çš„æµé‡å¯ä»¥è¢«å®šå‘åˆ°æ”¯ä»˜å¤„ç†æœåŠ¡ã€‚\
å¹¶ä¸”**ä½¿ç”¨WAFåŠŸèƒ½ä¿æŠ¤æ‚¨çš„ç½‘ç«™å…å—æ”»å‡»ã€‚**

### **æšä¸¾**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** æ˜¯ Azure ä¸­çš„ä¸€é¡¹ç½‘ç»œåŠŸèƒ½ï¼Œ**å…è®¸ä¸åŒçš„è™šæ‹Ÿç½‘ç»œï¼ˆVNetï¼‰ç›´æ¥æ— ç¼è¿æ¥**ã€‚é€šè¿‡ VNet Peeringï¼Œä¸€ä¸ª VNet ä¸­çš„èµ„æºå¯ä»¥ä½¿ç”¨ç§æœ‰ IP åœ°å€ä¸å¦ä¸€ä¸ª VNet ä¸­çš„èµ„æºé€šä¿¡ï¼Œ**å°±åƒå®ƒä»¬åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ä¸€æ ·**ã€‚\
**VNet Peering ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ç«™ç‚¹åˆ°ç«™ç‚¹ VPN æˆ– Azure ExpressRoute ä¸æœ¬åœ°ç½‘ç»œä¸€èµ·ä½¿ç”¨**ã€‚

**Azure Hub and Spoke** æ˜¯ Azure ä¸­ç”¨äºç®¡ç†å’Œç»„ç»‡ç½‘ç»œæµé‡çš„ç½‘ç»œæ‹“æ‰‘ã€‚**â€œHubâ€æ˜¯æ§åˆ¶å’Œè·¯ç”±ä¸åŒâ€œSpokeâ€ä¹‹é—´æµé‡çš„ä¸­å¿ƒç‚¹**ã€‚Hub é€šå¸¸åŒ…å«å…±äº«æœåŠ¡ï¼Œå¦‚ç½‘ç»œè™šæ‹Ÿè®¾å¤‡ï¼ˆNVAï¼‰ã€Azure VPN Gatewayã€Azure Firewall æˆ– Azure Bastionã€‚**â€œSpokeâ€æ˜¯æ‰˜ç®¡å·¥ä½œè´Ÿè½½å¹¶ä½¿ç”¨ VNet Peering è¿æ¥åˆ° Hub çš„ VNet**ï¼Œå…è®¸å®ƒä»¬åˆ©ç”¨ Hub å†…çš„å…±äº«æœåŠ¡ã€‚æ­¤æ¨¡å‹ä¿ƒè¿›äº†æ¸…æ™°çš„ç½‘ç»œå¸ƒå±€ï¼Œé€šè¿‡é›†ä¸­å¤šä¸ª VNet ä¸­çš„å¸¸è§æœåŠ¡æ¥å‡å°‘å¤æ‚æ€§ã€‚

{% hint style="danger" %}
**VNET Peering åœ¨ Azure ä¸­æ˜¯éä¼ é€’æ€§çš„**ï¼Œè¿™æ„å‘³ç€å¦‚æœ Spoke 1 è¿æ¥åˆ° Spoke 2ï¼ŒSpoke 2 è¿æ¥åˆ° Spoke 3ï¼Œé‚£ä¹ˆ Spoke 1 ä¸èƒ½ç›´æ¥ä¸ Spoke 3 é€šä¿¡ã€‚
{% endhint %}

### Examples

* æƒ³è±¡ä¸€ä¸ªå…¬å¸æœ‰ä¸åŒçš„éƒ¨é—¨ï¼Œå¦‚é”€å”®ã€äººåŠ›èµ„æºå’Œå¼€å‘ï¼Œ**æ¯ä¸ªéƒ¨é—¨éƒ½æœ‰è‡ªå·±çš„ VNetï¼ˆSpokeï¼‰**ã€‚è¿™äº› VNet **éœ€è¦è®¿é—®å…±äº«èµ„æº**ï¼Œå¦‚ä¸­å¤®æ•°æ®åº“ã€é˜²ç«å¢™å’Œäº’è”ç½‘ç½‘å…³ï¼Œè¿™äº›èµ„æºéƒ½ä½äº**å¦ä¸€ä¸ª VNetï¼ˆHubï¼‰**ä¸­ã€‚é€šè¿‡ä½¿ç”¨ Hub and Spoke æ¨¡å‹ï¼Œæ¯ä¸ªéƒ¨é—¨å¯ä»¥**é€šè¿‡ Hub VNet å®‰å…¨åœ°è¿æ¥åˆ°å…±äº«èµ„æºï¼Œè€Œæ— éœ€å°†è¿™äº›èµ„æºæš´éœ²åœ¨å…¬å…±äº’è”ç½‘æˆ–åˆ›å»ºå…·æœ‰ä¼—å¤šè¿æ¥çš„å¤æ‚ç½‘ç»œç»“æ„ä¸­**ã€‚

### Enumeration

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

åœ¨ Azure ä¸­ï¼Œç«™ç‚¹åˆ°ç«™ç‚¹ VPN å…è®¸æ‚¨**å°†æœ¬åœ°ç½‘ç»œè¿æ¥åˆ° Azure è™šæ‹Ÿç½‘ç»œ (VNet)**ï¼Œä½¿å¾— Azure ä¸­çš„èµ„æºï¼ˆå¦‚ VMsï¼‰çœ‹èµ·æ¥åƒæ˜¯åœ¨æœ¬åœ°ç½‘ç»œä¸­ã€‚æ­¤è¿æ¥é€šè¿‡**åŠ å¯†ä¸¤è€…ä¹‹é—´æµé‡çš„ VPN ç½‘å…³**å»ºç«‹ã€‚

### **ç¤ºä¾‹**

* ä¸€å®¶æ€»éƒ¨ä½äºçº½çº¦çš„å…¬å¸æœ‰ä¸€ä¸ªæœ¬åœ°æ•°æ®ä¸­å¿ƒï¼Œéœ€è¦å®‰å…¨åœ°è¿æ¥åˆ°å…¶åœ¨ Azure ä¸­çš„ VNetï¼Œè¯¥ VNet æ‰˜ç®¡å…¶è™šæ‹ŸåŒ–å·¥ä½œè´Ÿè½½ã€‚é€šè¿‡è®¾ç½®**ç«™ç‚¹åˆ°ç«™ç‚¹ VPNï¼Œå…¬å¸å¯ä»¥ç¡®ä¿æœ¬åœ°æœåŠ¡å™¨ä¸ Azure VMs ä¹‹é—´çš„åŠ å¯†è¿æ¥**ï¼Œä½¿å¾—èµ„æºå¯ä»¥åœ¨ä¸¤ä¸ªç¯å¢ƒä¸­å®‰å…¨è®¿é—®ï¼Œå°±åƒå®ƒä»¬åœ¨åŒä¸€ä¸ªæœ¬åœ°ç½‘ç»œä¸­ä¸€æ ·ã€‚

### **æšä¸¾**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute æ˜¯ä¸€é¡¹æœåŠ¡ï¼Œæä¾›**æœ¬åœ°åŸºç¡€è®¾æ–½ä¸ Azure æ•°æ®ä¸­å¿ƒä¹‹é—´çš„ç§æœ‰ã€ä¸“ç”¨ã€é«˜é€Ÿè¿æ¥**ã€‚è¿™ç§è¿æ¥é€šè¿‡è¿æ¥æä¾›å•†å®ç°ï¼Œç»•è¿‡å…¬å…±äº’è”ç½‘ï¼Œæä¾›æ¯”å…¸å‹äº’è”ç½‘è¿æ¥æ›´é«˜çš„å¯é æ€§ã€æ›´å¿«çš„é€Ÿåº¦ã€æ›´ä½çš„å»¶è¿Ÿå’Œæ›´é«˜çš„å®‰å…¨æ€§ã€‚

### **ç¤ºä¾‹**

* ä¸€å®¶è·¨å›½å…¬å¸ç”±äºæ•°æ®é‡å¤§ä¸”éœ€è¦é«˜ååé‡ï¼Œè¦æ±‚ä¸å…¶ Azure æœåŠ¡ä¹‹é—´æœ‰**ä¸€è‡´ä¸”å¯é çš„è¿æ¥**ã€‚è¯¥å…¬å¸é€‰æ‹© Azure ExpressRoute ç›´æ¥å°†å…¶æœ¬åœ°æ•°æ®ä¸­å¿ƒè¿æ¥åˆ° Azureï¼Œä»¥å¢å¼ºéšç§å’Œé€Ÿåº¦ï¼Œä¿ƒè¿›å¤§è§„æ¨¡æ•°æ®ä¼ è¾“ï¼Œå¦‚æ¯æ—¥å¤‡ä»½å’Œå®æ—¶æ•°æ®åˆ†æã€‚

### **æšä¸¾**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hackingï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hackingï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PRs åˆ†äº« hacking æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}
