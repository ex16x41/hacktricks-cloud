# Az - Azure Network

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na.

</details>
{% endhint %}

## Temel Bilgiler

Azure iÃ§indeki aÄŸlar, Ã§eÅŸitli Azure hizmetleri ve kaynaklarÄ± arasÄ±nda **baÄŸlantÄ± ve iletiÅŸimi** saÄŸlayarak bulut biliÅŸim platformunun ayrÄ±lmaz bir parÃ§asÄ± olarak iÅŸlev gÃ¶rÃ¼r. Azure'daki aÄŸ mimarisi, son derece Ã¶lÃ§eklenebilir, gÃ¼venli ve Ã¶zelleÅŸtirilebilir olacak ÅŸekilde tasarlanmÄ±ÅŸtÄ±r.

Azure, temelinde, kullanÄ±cÄ±larÄ±n Azure bulutu iÃ§inde **izole edilmiÅŸ aÄŸlar** oluÅŸturmasÄ±na olanak tanÄ±yan bir **sanal aÄŸ (VNet)** saÄŸlar. Bu VNets iÃ§inde, sanal makineler, uygulamalar ve veritabanlarÄ± gibi kaynaklar gÃ¼venli bir ÅŸekilde barÄ±ndÄ±rÄ±labilir ve yÃ¶netilebilir. Azure'daki aÄŸ, hem bulut iÃ§indeki iletiÅŸimi (Azure hizmetleri arasÄ±nda) hem de dÄ±ÅŸ aÄŸlara ve internete baÄŸlantÄ±yÄ± destekler.

**GÃ¼venlik**, Azure aÄŸÄ±nÄ±n kritik bir yÃ¶nÃ¼dÃ¼r ve verileri korumak, eriÅŸimi yÃ¶netmek ve uyumluluÄŸu saÄŸlamak iÃ§in Ã§eÅŸitli araÃ§lar ve hizmetler mevcuttur. Bu gÃ¼venlik Ã¶nlemleri arasÄ±nda **gÃ¼venlik duvarlarÄ±**, **aÄŸ gÃ¼venlik gruplarÄ±** ve **ÅŸifreleme** yetenekleri bulunur ve trafik ve eriÅŸim Ã¼zerinde yÃ¼ksek dÃ¼zeyde kontrol saÄŸlar.

Genel olarak, Azure'un aÄŸ yetenekleri, kullanÄ±cÄ±larÄ±n belirli uygulama ve iÅŸ yÃ¼kÃ¼ ihtiyaÃ§larÄ±na uygun bir aÄŸ ortamÄ± oluÅŸturmasÄ±na olanak tanÄ±rken, gÃ¼venlik ve gÃ¼venilirliÄŸe gÃ¼Ã§lÃ¼ bir vurgu yapar.

## Sanal AÄŸ (VNET) ve Alt AÄŸlar

Azure'daki bir VNet, buluttaki kendi aÄŸÄ±nÄ±zÄ±n bir temsili olarak iÅŸlev gÃ¶rÃ¼r. Bu, Azure bulutunun aboneliÄŸinize Ã¶zel **mantÄ±ksal izolasyonudur**. Bir VNet, Azure'da sanal Ã¶zel aÄŸlar (VPN'ler) saÄŸlama ve yÃ¶netme olanaÄŸÄ± tanÄ±r ve sanal makineler (VM'ler), veritabanlarÄ± ve uygulama hizmetleri gibi **birden fazla tÃ¼rde Azure kaynaÄŸÄ±nÄ± barÄ±ndÄ±rmak ve yÃ¶netmek** iÃ§in kullanÄ±labilir.

VNets, **IP adresi** aralÄ±klarÄ±, alt aÄŸ oluÅŸturma, yÃ¶nlendirme tablolarÄ± ve aÄŸ geÃ§itleri dahil olmak Ã¼zere **aÄŸ ayarlarÄ± Ã¼zerinde tam kontrol** saÄŸlar.

Bir **alt aÄŸ**, VNet'inizdeki **bir IP adresi aralÄ±ÄŸÄ±dÄ±r**. Bir VNet'i organizasyon ve gÃ¼venlik iÃ§in birden fazla alt aÄŸa bÃ¶lebilirsiniz. Bir VNet'teki her alt aÄŸ, aÄŸ ve uygulama mimarinize gÃ¶re kaynaklarÄ± izole etmek ve gruplamak iÃ§in kullanÄ±labilir.

AyrÄ±ca, alt aÄŸlar, VNet'inizi bir veya daha fazla alt aÄŸa **bÃ¶lmenize** olanak tanÄ±r ve kaynaklarÄ±n kullanabileceÄŸi bir IP adresi aralÄ±ÄŸÄ± saÄŸlar.

### **Ã–rnek**

* `10.0.0.0/16` IP adresi aralÄ±ÄŸÄ±na sahip `MyVNet` adlÄ± bir VNet'iniz olduÄŸunu varsayalÄ±m. Bu VNet iÃ§inde, web sunucularÄ±nÄ±zÄ± barÄ±ndÄ±rmak iÃ§in `10.0.0.0/24` IP adresi aralÄ±ÄŸÄ±na sahip `Subnet-1` adlÄ± bir alt aÄŸ oluÅŸturabilirsiniz. VeritabanÄ± sunucularÄ±nÄ±z iÃ§in `10.0.1.0/24` aralÄ±ÄŸÄ±na sahip baÅŸka bir alt aÄŸ olan `Subnet-2` kullanÄ±labilir. Bu segmentasyon, aÄŸ iÃ§inde verimli yÃ¶netim ve gÃ¼venlik kontrolleri saÄŸlar.

### Enumeration

Bir Azure hesabÄ±ndaki tÃ¼m VNet'leri ve alt aÄŸlarÄ± listelemek iÃ§in Azure Komut SatÄ±rÄ± ArayÃ¼zÃ¼ (CLI) kullanabilirsiniz. Ä°ÅŸte adÄ±mlar:
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## Network Security Groups (NSG)

Azure'da, bir **Network Security Group (NSG)**, Azure Virtual Network (VNet) iÃ§indeki Azure kaynaklarÄ±na gelen ve giden aÄŸ trafiÄŸini filtreleme iÅŸlevini yerine getirir. Bu grup, aÄŸ trafiÄŸinin akÄ±ÅŸÄ±nÄ± titizlikle belirleyen bir dizi **gÃ¼venlik kuralÄ±** barÄ±ndÄ±rÄ±r.

NSG'nin temel Ã¶zellikleri ÅŸunlardÄ±r:

* **Trafik KontrolÃ¼**: Her NSG, Ã§eÅŸitli Azure kaynaklarÄ±yla iliÅŸkili gelen ve giden aÄŸ trafiÄŸini ya izin veren ya da engelleyen kurallar iÃ§erir.
* **Kural BileÅŸenleri**: NSG iÃ§indeki kurallar, kaynak/hedef IP adresi, port ve protokol gibi kriterlere dayalÄ± olarak trafiÄŸi filtreleyerek son derece spesifiktir. Bu spesifiklik, aÄŸ trafiÄŸinin ayrÄ±ntÄ±lÄ± yÃ¶netimine olanak tanÄ±r.
* **GÃ¼venlik ArtÄ±rÄ±mÄ±**: YalnÄ±zca yetkili trafiÄŸin Azure kaynaklarÄ±nÄ±za girip Ã§Ä±kmasÄ±nÄ± saÄŸlayarak, NSG'ler aÄŸ altyapÄ±nÄ±zÄ±n gÃ¼venlik duruÅŸunu gÃ¼Ã§lendirmede Ã¶nemli bir rol oynar.

### **Ã–rnek**

* VNet'iniz iÃ§inde bir alt aÄŸa veya belirli bir sanal makineye uygulanan `MyNSG` adlÄ± bir NSG'ye sahip olduÄŸunuzu hayal edin. Åu kurallarÄ± oluÅŸturabilirsiniz:
* Web sunucularÄ±nÄ±za herhangi bir kaynaktan HTTP trafiÄŸine (port 80) izin veren bir gelen kural.
* Belirli bir hedef IP adresi aralÄ±ÄŸÄ±na yalnÄ±zca SQL trafiÄŸine (port 1433) izin veren bir giden kural.

### Enumeration

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall, Azure Sanal AÄŸ kaynaklarÄ±nÄ±zÄ± koruyan yÃ¶netilen, bulut tabanlÄ± bir **aÄŸ gÃ¼venlik hizmetidir**. YÃ¼ksek kullanÄ±labilirlik ve Ã¶lÃ§eklenebilirlik Ã¶zelliklerine sahip tam durumsal bir hizmet olarak gÃ¼venlik duvarÄ±dÄ±r.

Azure Firewall, **uygulama dÃ¼zeyinde filtreleme**, aÄŸ dÃ¼zeyinde filtreleme, tehdit istihbaratÄ±na dayalÄ± filtreleme ve gÃ¼nlÃ¼k kaydÄ± ve analiz iÃ§in Azure Monitor ile entegrasyon gibi **NSG'lerden daha geliÅŸmiÅŸ** Ã¶zellikler sunar.\
Giden, gelen, spoke-to-spoke, VPN ve ExpressRoute trafiÄŸini filtreleyebilir. **GÃ¼venlik duvarÄ± kurallarÄ± FQDN (Fully Qualified Domain Name), IP adresleri ve portlara gÃ¶re oluÅŸturulabilir**.

### Azure Firewall ve NSG'ler ArasÄ±ndaki Farklar

1. **Kapsam:**
* **NSG:** Alt aÄŸ veya aÄŸ arayÃ¼zÃ¼ dÃ¼zeyinde Ã§alÄ±ÅŸÄ±r. AÄŸ arayÃ¼zlerinden (NIC), VM'lerden veya alt aÄŸlardan gelen ve giden trafiÄŸin temel filtrelemesini saÄŸlamak iÃ§in tasarlanmÄ±ÅŸtÄ±r.
* **Azure Firewall:** VNet dÃ¼zeyinde Ã§alÄ±ÅŸÄ±r ve daha geniÅŸ bir koruma kapsamÄ± saÄŸlar. Sanal aÄŸ kaynaklarÄ±nÄ±zÄ± gÃ¼vence altÄ±na almak ve VNet'e giren ve Ã§Ä±kan trafiÄŸi yÃ¶netmek iÃ§in tasarlanmÄ±ÅŸtÄ±r.
2. **Yetenekler:**
* **NSG:** IP adresi, port ve protokole dayalÄ± temel filtreleme yetenekleri saÄŸlar. Uygulama dÃ¼zeyinde inceleme veya tehdit istihbaratÄ± gibi geliÅŸmiÅŸ Ã¶zellikleri desteklemez.
* **Azure Firewall:** Uygulama dÃ¼zeyinde (Katman 7) trafik filtreleme, tehdit istihbaratÄ±na dayalÄ± filtreleme, aÄŸ trafiÄŸi filtreleme ve daha fazlasÄ± gibi geliÅŸmiÅŸ Ã¶zellikler sunar. AyrÄ±ca birden fazla genel IP adresini destekler.
3. **KullanÄ±m DurumlarÄ±:**
* **NSG:** Temel aÄŸ dÃ¼zeyinde trafik filtreleme iÃ§in idealdir.
* **Azure Firewall:** Uygulama dÃ¼zeyinde kontrol, gÃ¼nlÃ¼k kaydÄ± ve tehdit istihbaratÄ±nÄ±n gerektiÄŸi daha karmaÅŸÄ±k filtreleme senaryolarÄ± iÃ§in uygundur.
4. **YÃ¶netim ve Ä°zleme:**
* **NSG:** Temel gÃ¼nlÃ¼k kaydÄ± ve Azure Monitor ile entegrasyon sunar.
* **Azure Firewall:** Azure Monitor aracÄ±lÄ±ÄŸÄ±yla geliÅŸmiÅŸ gÃ¼nlÃ¼k kaydÄ± ve analiz yetenekleri saÄŸlar, bu da trafiÄŸin doÄŸasÄ±nÄ± ve desenini anlamak iÃ§in gereklidir.

### Enumeration

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## Network Virtual Appliance (NVA)

Azure'da bir Network Virtual Appliance (**NVA**), sanal bir aÄŸ iÃ§inde **aÄŸ iÅŸlevlerini gerÃ§ekleÅŸtiren** sanal bir cihazdÄ±r. NVAlar genellikle Azure'da **doÄŸal olarak mevcut olmayan** aÄŸ iÅŸlevleri iÃ§in veya daha fazla Ã¶zelleÅŸtirme gerektiÄŸinde kullanÄ±lÄ±r. Esasen, **aÄŸ uygulamalarÄ± veya hizmetleri Ã§alÄ±ÅŸtÄ±ran VMlerdir**, Ã¶rneÄŸin gÃ¼venlik duvarlarÄ±, WAN optimizasyon cihazlarÄ± veya yÃ¼k dengeleyiciler.

NVAlar karmaÅŸÄ±k yÃ¶nlendirme, **gÃ¼venlik** ve **aÄŸ trafiÄŸi yÃ¶netimi** gÃ¶revleri iÃ§in kullanÄ±lÄ±r. Azure **Marketplace**'ten daÄŸÄ±tÄ±labilirler, burada birÃ§ok Ã¼Ã§Ã¼ncÃ¼ taraf satÄ±cÄ±, cihazlarÄ±nÄ± Azure ortamlarÄ±na entegrasyon iÃ§in hazÄ±r olarak sunar.

### **Ã–rnek**

* Bir organizasyon, Azure'da **Ã¶zel bir gÃ¼venlik duvarÄ± Ã§Ã¶zÃ¼mÃ¼** oluÅŸturmak iÃ§in bir NVA daÄŸÄ±tabilir. Bu NVA, geliÅŸmiÅŸ Ã¶zellikler sunan **Ã¼Ã§Ã¼ncÃ¼ taraf bir gÃ¼venlik duvarÄ± yazÄ±lÄ±mÄ±** Ã§alÄ±ÅŸtÄ±rabilir, Ã¶rneÄŸin izinsiz giriÅŸ tespiti, paket incelemesi veya VPN baÄŸlantÄ±sÄ±. NVA, Ã¼zerinden geÃ§en trafiÄŸi incelemek ve filtrelemek iÃ§in yapÄ±landÄ±rÄ±labilir, bÃ¶ylece organizasyonun politikalarÄ±na gÃ¶re geliÅŸmiÅŸ gÃ¼venlik Ã¶nlemleri saÄŸlanÄ±r.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
{% endcode %}

## Azure Route Tables & User Defined Routes (UDR)

**Azure Route Tables**, Microsoft Azure iÃ§inde, **Azure Virtual Networks (VNets) iÃ§indeki aÄŸ trafiÄŸi yÃ¶nlendirmesini kontrol etme** Ã¶zelliÄŸidir. Temelde, **paketlerin** VNets iÃ§indeki alt aÄŸlar arasÄ±nda, VNets arasÄ±nda veya harici aÄŸlara nasÄ±l **yÃ¶nlendirileceÄŸini** tanÄ±mlarlar. Her yÃ¶nlendirme tablosu, paketlerin hedef IP adreslerine gÃ¶re nasÄ±l yÃ¶nlendirilmesi gerektiÄŸini belirten bir dizi kural, yani yÃ¶nlendirme iÃ§erir.

**User Defined Routes (UDR)**, Azure Route Tables iÃ§inde oluÅŸturduÄŸunuz **Ã¶zel yÃ¶nlendirmelerdir** ve **aÄŸ trafiÄŸinin akÄ±ÅŸÄ±nÄ±** Azure Virtual Networks (VNets) iÃ§inde ve arasÄ±nda, ayrÄ±ca harici baÄŸlantÄ±lara kontrol etmenizi saÄŸlar. UDR'ler, Azure'un varsayÄ±lan yÃ¶nlendirme kararlarÄ±nÄ± geÃ§ersiz kÄ±larak, aÄŸ trafiÄŸini belirli gereksinimlerinize gÃ¶re yÃ¶nlendirme esnekliÄŸi sunar.

Bu yÃ¶nlendirmeler, Ã¶zellikle **aÄŸ trafiÄŸini sanal bir cihaz Ã¼zerinden yÃ¶nlendirme**, gÃ¼venlik veya politika uyumu iÃ§in belirli bir yol zorunluluÄŸu getirme veya yerel aÄŸlarla entegrasyon saÄŸlama senaryolarÄ±nda kullanÄ±ÅŸlÄ±dÄ±r.

### **Ã–rnek**

* Bir VNet iÃ§indeki alt aÄŸlar arasÄ±nda trafiÄŸi denetlemek iÃ§in bir Network Virtual Appliance (NVA) daÄŸÄ±ttÄ±ÄŸÄ±nÄ±zÄ± varsayalÄ±m. Bir alt aÄŸdan diÄŸerine giden tÃ¼m trafiÄŸi NVA Ã¼zerinden yÃ¶nlendiren bir UDR oluÅŸturabilirsiniz. Bu UDR, trafiÄŸin hedefine ulaÅŸmadan Ã¶nce gÃ¼venlik amacÄ±yla NVA tarafÄ±ndan denetlendiÄŸinden emin olur.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Private Link

Azure Private Link, **Azure hizmetlerine Ã¶zel eriÅŸim saÄŸlayan** bir hizmettir ve **Azure sanal aÄŸÄ±nÄ±z (VNet) ile hizmet arasÄ±ndaki trafiÄŸin tamamen Microsoft'un Azure omurga aÄŸÄ± iÃ§inde seyahat etmesini saÄŸlar**. Bu, hizmeti VNet'inize getirir. Bu yapÄ±, verilerin genel internete maruz kalmamasÄ± nedeniyle gÃ¼venliÄŸi artÄ±rÄ±r.

Private Link, Azure Storage, Azure SQL Database ve Private Link aracÄ±lÄ±ÄŸÄ±yla paylaÅŸÄ±lan Ã¶zel hizmetler gibi Ã§eÅŸitli Azure hizmetleriyle kullanÄ±labilir. Kendi VNet'inizden veya farklÄ± Azure aboneliklerinden hizmetleri gÃ¼venli bir ÅŸekilde tÃ¼ketmenin bir yolunu saÄŸlar.

{% hint style="danger" %}
NSG'ler Ã¶zel uÃ§ noktalara uygulanmaz, bu da Private Link iÃ§eren bir alt aÄŸa NSG iliÅŸkilendirmenin hiÃ§bir etkisi olmayacaÄŸÄ± anlamÄ±na gelir.
{% endhint %}

### **Ã–rnek**

* **VNet'inizden gÃ¼venli bir ÅŸekilde eriÅŸmek istediÄŸiniz bir Azure SQL Database** senaryosunu dÃ¼ÅŸÃ¼nÃ¼n. Normalde, bu genel internet Ã¼zerinden geÃ§iÅŸi iÃ§erebilir. Private Link ile, **VNet'inizde doÄŸrudan Azure SQL Database hizmetine baÄŸlanan Ã¶zel bir uÃ§ nokta** oluÅŸturabilirsiniz. Bu uÃ§ nokta, veritabanÄ±nÄ± kendi VNet'inizin bir parÃ§asÄ±ymÄ±ÅŸ gibi gÃ¶sterir ve Ã¶zel bir IP adresi aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilir hale getirir, bÃ¶ylece gÃ¼venli ve Ã¶zel eriÅŸim saÄŸlar.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Service Endpoints

Azure Service Endpoints, sanal aÄŸÄ±nÄ±zÄ±n Ã¶zel adres alanÄ±nÄ± ve VNet'inizin kimliÄŸini doÄŸrudan baÄŸlantÄ± Ã¼zerinden Azure hizmetlerine geniÅŸletir. Hizmet uÃ§ noktalarÄ±nÄ± etkinleÅŸtirerek, **VNet'inizdeki kaynaklar Azure'un omurga aÄŸÄ± Ã¼zerinden Azure hizmetlerine gÃ¼venli bir ÅŸekilde baÄŸlanabilir**, Ã¶rneÄŸin Azure Storage ve Azure SQL Database. Bu, **VNet'ten Azure hizmetine giden trafiÄŸin Azure aÄŸÄ± iÃ§inde kalmasÄ±nÄ±** saÄŸlar ve daha gÃ¼venli ve gÃ¼venilir bir yol sunar.

### **Ã–rnek**

* Ã–rneÄŸin, bir **Azure Storage** hesabÄ± varsayÄ±lan olarak genel internet Ã¼zerinden eriÅŸilebilir. **VNet'iniz iÃ§inde Azure Storage iÃ§in bir hizmet uÃ§ noktasÄ± etkinleÅŸtirerek**, yalnÄ±zca VNet'inizden gelen trafiÄŸin depolama hesabÄ±na eriÅŸmesini saÄŸlayabilirsiniz. Depolama hesabÄ± gÃ¼venlik duvarÄ± daha sonra yalnÄ±zca VNet'inizden gelen trafiÄŸi kabul edecek ÅŸekilde yapÄ±landÄ±rÄ±labilir.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Service Endpoints ve Private Links ArasÄ±ndaki Farklar

Microsoft, [**docs**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints)'ta Private Links kullanmayÄ± Ã¶neriyor:\\

<figure><img src="../../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

**Service Endpoints:**

* VNet'inizden Azure hizmetine giden trafik, Microsoft Azure omurga aÄŸÄ± Ã¼zerinden geÃ§er ve genel interneti atlar.
* Endpoint, Azure hizmetine doÄŸrudan bir baÄŸlantÄ±dÄ±r ve VNet iÃ§inde hizmet iÃ§in Ã¶zel bir IP saÄŸlamaz.
* Hizmetin kendisi, hizmet gÃ¼venlik duvarÄ±nÄ± bu tÃ¼r trafiÄŸi engelleyecek ÅŸekilde yapÄ±landÄ±rmadÄ±ÄŸÄ±nÄ±z sÃ¼rece, VNet'iniz dÄ±ÅŸÄ±ndan genel endpoint Ã¼zerinden eriÅŸilebilir.
* Alt aÄŸ ile Azure hizmeti arasÄ±nda bire bir iliÅŸki vardÄ±r.
* Private Links'ten daha ucuzdur.

**Private Links:**

* Private Link, Azure hizmetlerini VNet'inize Ã¶zel bir endpoint aracÄ±lÄ±ÄŸÄ±yla haritalar; bu, VNet'iniz iÃ§inde Ã¶zel bir IP adresine sahip bir aÄŸ arayÃ¼zÃ¼dÃ¼r.
* Azure hizmetine bu Ã¶zel IP adresi kullanÄ±larak eriÅŸilir, bu da onu aÄŸÄ±nÄ±zÄ±n bir parÃ§asÄ±ymÄ±ÅŸ gibi gÃ¶sterir.
* Private Link aracÄ±lÄ±ÄŸÄ±yla baÄŸlanan hizmetlere yalnÄ±zca VNet'inizden veya baÄŸlÄ± aÄŸlardan eriÅŸilebilir; hizmete genel internet eriÅŸimi yoktur.
* Azure hizmetlerine veya Azure'da barÄ±ndÄ±rÄ±lan kendi hizmetlerinize gÃ¼venli bir baÄŸlantÄ± saÄŸlar ve baÅŸkalarÄ± tarafÄ±ndan paylaÅŸÄ±lan hizmetlere baÄŸlantÄ± saÄŸlar.
* VNet'inizdeki Ã¶zel bir endpoint aracÄ±lÄ±ÄŸÄ±yla daha ayrÄ±ntÄ±lÄ± eriÅŸim kontrolÃ¼ saÄŸlar, hizmet endpoint'leri ile alt aÄŸ dÃ¼zeyinde daha geniÅŸ eriÅŸim kontrolÃ¼ne karÅŸÄ±.

Ã–zetle, hem Service Endpoints hem de Private Links Azure hizmetlerine gÃ¼venli baÄŸlantÄ± saÄŸlarken, **Private Links, hizmetlerin genel internete maruz kalmadan Ã¶zel olarak eriÅŸilmesini saÄŸlayarak daha yÃ¼ksek dÃ¼zeyde izolasyon ve gÃ¼venlik sunar**. Ã–te yandan, Service Endpoints, VNet'te Ã¶zel bir IP'ye ihtiyaÃ§ duymadan Azure hizmetlerine basit ve gÃ¼venli eriÅŸim gereken genel durumlar iÃ§in kurulumu daha kolaydÄ±r.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door**, kÃ¼resel web uygulamalarÄ±nÄ±zÄ±n **hÄ±zlÄ± teslimatÄ±** iÃ§in Ã¶lÃ§eklenebilir ve gÃ¼venli bir giriÅŸ noktasÄ±dÄ±r. **KÃ¼resel yÃ¼k dengeleme, site hÄ±zlandÄ±rma, SSL offloading ve Web Application Firewall (WAF)** gibi Ã§eÅŸitli hizmetleri tek bir hizmette **birleÅŸtirir**. Azure Front Door, **kullanÄ±cÄ±ya en yakÄ±n edge konumuna** dayalÄ± akÄ±llÄ± yÃ¶nlendirme saÄŸlayarak optimal performans ve gÃ¼venilirlik sunar. AyrÄ±ca, URL tabanlÄ± yÃ¶nlendirme, Ã§oklu site barÄ±ndÄ±rma, oturum baÄŸlÄ±lÄ±ÄŸÄ± ve uygulama katmanÄ± gÃ¼venliÄŸi sunar.

**Azure Front Door WAF**, arka uÃ§ kodunda deÄŸiÅŸiklik yapmadan **web uygulamalarÄ±nÄ± web tabanlÄ± saldÄ±rÄ±lardan korumak** iÃ§in tasarlanmÄ±ÅŸtÄ±r. SQL enjeksiyonu, cross-site scripting ve diÄŸer yaygÄ±n saldÄ±rÄ±lara karÅŸÄ± koruma saÄŸlamak iÃ§in Ã¶zel kurallar ve yÃ¶netilen kural setleri iÃ§erir.

### **Ã–rnek**

* KÃ¼resel olarak daÄŸÄ±tÄ±lmÄ±ÅŸ ve dÃ¼nya Ã§apÄ±nda kullanÄ±cÄ±larÄ± olan bir uygulamanÄ±z olduÄŸunu hayal edin. Azure Front Door'u kullanarak kullanÄ±cÄ± isteklerini uygulamanÄ±zÄ± barÄ±ndÄ±ran en yakÄ±n bÃ¶lgesel veri merkezine **yÃ¶nlendirebilir**, bÃ¶ylece gecikmeyi azaltabilir, kullanÄ±cÄ± deneyimini iyileÅŸtirebilir ve **WAF yetenekleriyle web saldÄ±rÄ±larÄ±ndan koruyabilirsiniz**. Belirli bir bÃ¶lge kesinti yaÅŸarsa, Azure Front Door trafiÄŸi otomatik olarak bir sonraki en iyi konuma yÃ¶nlendirebilir ve yÃ¼ksek kullanÄ±labilirlik saÄŸlar.

### Enumeration

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Application Gateway ve Azure Application Gateway WAF

Azure Application Gateway, **web trafiÄŸi yÃ¼k dengeleyicisi** olup, **web** uygulamalarÄ±nÄ±za gelen trafiÄŸi yÃ¶netmenizi saÄŸlar. **Katman 7 yÃ¼k dengeleme, SSL sonlandÄ±rma ve web uygulama gÃ¼venlik duvarÄ± (WAF) yetenekleri** sunar ve Application Delivery Controller (ADC) hizmeti olarak Ã§alÄ±ÅŸÄ±r. Ana Ã¶zellikler arasÄ±nda URL tabanlÄ± yÃ¶nlendirme, Ã§erez tabanlÄ± oturum baÄŸÄ±mlÄ±lÄ±ÄŸÄ± ve gÃ¼venli soket katmanÄ± (SSL) yÃ¼k boÅŸaltma bulunur. Bu Ã¶zellikler, global yÃ¶nlendirme ve yol tabanlÄ± yÃ¶nlendirme gibi karmaÅŸÄ±k yÃ¼k dengeleme yeteneklerine ihtiyaÃ§ duyan uygulamalar iÃ§in kritiktir.

### Ã–rnek

* Bir e-ticaret web siteniz olduÄŸunu ve bu sitenin kullanÄ±cÄ± hesaplarÄ± ve Ã¶deme iÅŸlemleri gibi farklÄ± iÅŸlevler iÃ§in birden fazla alt alan adÄ± iÃ§erdiÄŸini dÃ¼ÅŸÃ¼nÃ¼n. Azure Application Gateway, **URL yoluna gÃ¶re trafiÄŸi uygun web sunucularÄ±na yÃ¶nlendirebilir**. Ã–rneÄŸin, `example.com/accounts` adresine gelen trafik kullanÄ±cÄ± hesaplarÄ± servisine, `example.com/pay` adresine gelen trafik ise Ã¶deme iÅŸleme servisine yÃ¶nlendirilebilir.\
Ve **WAF yeteneklerini kullanarak web sitenizi saldÄ±rÄ±lardan koruyabilirsiniz.**

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering**, Azure'da **farklÄ± Virtual Networks (VNets) doÄŸrudan ve sorunsuz bir ÅŸekilde baÄŸlanmasÄ±nÄ± saÄŸlayan** bir aÄŸ Ã¶zelliÄŸidir. VNet peering aracÄ±lÄ±ÄŸÄ±yla, bir VNet'teki kaynaklar, baÅŸka bir VNet'teki kaynaklarla Ã¶zel IP adresleri kullanarak **aynÄ± aÄŸdaymÄ±ÅŸ gibi iletiÅŸim kurabilir**.\
**VNet Peering, site-to-site VPN veya Azure ExpressRoute kurarak on-prem aÄŸlarla da kullanÄ±labilir**.

**Azure Hub and Spoke**, Azure'da aÄŸ trafiÄŸini yÃ¶netmek ve dÃ¼zenlemek iÃ§in kullanÄ±lan bir aÄŸ topolojisidir. **"Hub", farklÄ± "spokes" arasÄ±ndaki trafiÄŸi kontrol eden ve yÃ¶nlendiren merkezi bir noktadÄ±r**. Hub genellikle network virtual appliances (NVAs), Azure VPN Gateway, Azure Firewall veya Azure Bastion gibi paylaÅŸÄ±lan hizmetleri iÃ§erir. **"Spokes", iÅŸ yÃ¼klerini barÄ±ndÄ±ran ve VNet peering kullanarak hub'a baÄŸlanan VNets'tir**, bu sayede hub iÃ§indeki paylaÅŸÄ±lan hizmetlerden yararlanabilirler. Bu model, farklÄ± VNets'teki birden fazla iÅŸ yÃ¼kÃ¼nÃ¼n kullanabileceÄŸi ortak hizmetleri merkezileÅŸtirerek karmaÅŸÄ±klÄ±ÄŸÄ± azaltan temiz bir aÄŸ dÃ¼zeni saÄŸlar.

{% hint style="danger" %}
**VNET peering Azure'da geÃ§iÅŸli deÄŸildir**, bu da demektir ki spoke 1 spoke 2'ye baÄŸlÄ±ysa ve spoke 2 spoke 3'e baÄŸlÄ±ysa spoke 1 doÄŸrudan spoke 3 ile konuÅŸamaz.
{% endhint %}

### Ã–rnekler

* SatÄ±ÅŸ, Ä°K ve GeliÅŸtirme gibi ayrÄ± departmanlara sahip bir ÅŸirketi hayal edin, **her biri kendi VNet'ine (spokes) sahip**. Bu VNets **merkezi bir veritabanÄ±, bir firewall ve bir internet gateway gibi paylaÅŸÄ±lan kaynaklara eriÅŸim gerektirir**, bunlarÄ±n hepsi **baÅŸka bir VNet'te (hub) bulunur**. Hub and Spoke modelini kullanarak, her departman **bu paylaÅŸÄ±lan kaynaklara hub VNet Ã¼zerinden gÃ¼venli bir ÅŸekilde baÄŸlanabilir, bu kaynaklarÄ± genel internete maruz bÄ±rakmadan** veya Ã§ok sayÄ±da baÄŸlantÄ± ile karmaÅŸÄ±k bir aÄŸ yapÄ±sÄ± oluÅŸturmadan.

### Enumeration

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

Azure'da bir Site-to-Site VPN, **yerel aÄŸÄ±nÄ±zÄ± Azure Sanal AÄŸÄ±nÄ±za (VNet) baÄŸlamanÄ±zÄ±** saÄŸlar ve Azure iÃ§indeki VM'ler gibi kaynaklarÄ±n yerel aÄŸÄ±nÄ±zdaymÄ±ÅŸ gibi gÃ¶rÃ¼nmesini saÄŸlar. Bu baÄŸlantÄ±, **iki aÄŸ arasÄ±ndaki trafiÄŸi ÅŸifreleyen bir VPN aÄŸ geÃ§idi** aracÄ±lÄ±ÄŸÄ±yla kurulur.

### **Ã–rnek**

* New York'ta ana ofisi bulunan bir iÅŸletmenin, sanallaÅŸtÄ±rÄ±lmÄ±ÅŸ iÅŸ yÃ¼klerini barÄ±ndÄ±ran Azure'daki VNet'ine gÃ¼venli bir ÅŸekilde baÄŸlanmasÄ± gereken bir yerel veri merkezi vardÄ±r. **Site-to-Site VPN kurarak, ÅŸirket yerel sunucular ile Azure VM'leri arasÄ±nda ÅŸifreli baÄŸlantÄ± saÄŸlayabilir**, bÃ¶ylece kaynaklar her iki ortamda da aynÄ± yerel aÄŸdaymÄ±ÅŸ gibi gÃ¼venli bir ÅŸekilde eriÅŸilebilir.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute, **ÅŸirket iÃ§i altyapÄ±nÄ±z ile Azure veri merkezleri arasÄ±nda Ã¶zel, ayrÄ±lmÄ±ÅŸ, yÃ¼ksek hÄ±zlÄ± bir baÄŸlantÄ± saÄŸlayan bir hizmettir**. Bu baÄŸlantÄ±, bir baÄŸlantÄ± saÄŸlayÄ±cÄ±sÄ± aracÄ±lÄ±ÄŸÄ±yla yapÄ±lÄ±r, genel interneti atlayarak daha fazla gÃ¼venilirlik, daha hÄ±zlÄ± hÄ±zlar, daha dÃ¼ÅŸÃ¼k gecikmeler ve tipik internet baÄŸlantÄ±larÄ±ndan daha yÃ¼ksek gÃ¼venlik sunar.

### **Ã–rnek**

* Ã‡ok uluslu bir ÅŸirket, **yÃ¼ksek veri hacmi ve yÃ¼ksek verim ihtiyacÄ± nedeniyle Azure hizmetlerine tutarlÄ± ve gÃ¼venilir bir baÄŸlantÄ± gerektirir**. Åirket, ÅŸirket iÃ§i veri merkezini Azure'a doÄŸrudan baÄŸlamak iÃ§in Azure ExpressRoute'u tercih eder, gÃ¼nlÃ¼k yedeklemeler ve gerÃ§ek zamanlÄ± veri analitiÄŸi gibi bÃ¼yÃ¼k Ã¶lÃ§ekli veri transferlerini geliÅŸtirilmiÅŸ gizlilik ve hÄ±z ile kolaylaÅŸtÄ±rÄ±r.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n.

</details>
{% endhint %}
