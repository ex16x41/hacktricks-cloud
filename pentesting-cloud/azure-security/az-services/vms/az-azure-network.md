# Az - Azure Network

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basiese Inligting

Netwerke binne Azure funksioneer as 'n integrale deel van sy wolk rekenaar platform, wat die **verbinding en kommunikasie tussen verskeie Azure dienste en hulpbronne** moontlik maak. Die netwerk argitektuur in Azure is ontwerp om hoogs skaalbaar, veilig, en aanpasbaar te wees.

In sy kern bied Azure 'n **virtuele netwerk (VNet)** wat gebruikers toelaat om **ge√Øsoleerde** **netwerke** binne die Azure wolk te skep. Binne hierdie VNets kan hulpbronne soos virtuele masjiene, toepassings, en databasisse veilig gehos en bestuur word. Die netwerking in Azure ondersteun beide die kommunikasie binne die wolk (tussen Azure dienste) en die verbinding met eksterne netwerke en die internet.

**Sekuriteit** is 'n kritieke aspek van Azure netwerking, met verskeie gereedskap en dienste beskikbaar vir die beskerming van data, bestuur van toegang, en versekerings van nakoming. Hierdie sekuriteitsmaatre√´ls sluit **vuurmure**, **netwerk sekuriteitsgroepe**, en **versleuteling** vermo√´ns in, wat 'n ho√´ vlak van beheer oor verkeer en toegang moontlik maak.

Algeheel is Azure se netwerking vermo√´ns ontwerp om buigsaamheid te bied, wat gebruikers toelaat om 'n netwerk omgewing te skep wat aan hul spesifieke toepassing en werklading behoeftes voldoen terwyl 'n sterk klem op sekuriteit en betroubaarheid gehandhaaf word.

## Virtuele Netwerk (VNET) & Subnetwerke

'n VNet in Azure is essensieel 'n voorstelling van jou eie netwerk in die wolk. Dit is 'n **logiese isolasie van die Azure wolk toegewy aan jou subskripsie**. 'n VNet laat jou toe om virtuele privaat netwerke (VPNs) in Azure te voorsien en te bestuur en kan gebruik word om **meerdere tipes Azure hulpbronne** te huisves en te bestuur, soos Virtuele Masjiene (VMs), databasisse, en toepassingsdienste.

VNets bied jou **volledige beheer oor jou netwerk instellings**, insluitend **IP adres** reekse, subnet skepping, roete tafels, en netwerk poorte.

'n **subnet** is 'n **reeks van IP adresse in jou VNet**. Jy kan 'n VNet in verskeie subnets verdeel vir organisasie en sekuriteit. Elke subnet in 'n VNet kan gebruik word om hulpbronne te isoleer en te groepeer volgens jou netwerk en toepassing argitektuur.

Boonop laat subnets jou toe om jou VNet in een of meer sub-netwerke te **segmenteer**, wat 'n reeks van IP adresse bied wat hulpbronne kan gebruik.

### **Voorbeeld**

* Neem aan jy het 'n VNet genaamd `MyVNet` met 'n IP adres reeks van `10.0.0.0/16`. Jy kan 'n subnet binne hierdie VNet skep, kom ons s√™ `Subnet-1`, met 'n IP adres reeks van `10.0.0.0/24` vir die huisvesting van jou web bedieners. 'n Ander subnet, `Subnet-2` met 'n reeks van `10.0.1.0/24`, kan gebruik word vir jou databasis bedieners. Hierdie segmentasie laat vir doeltreffende bestuur en sekuriteitsbeheer binne die netwerk.

### Enumerasie

Om al die VNets en subnetwerke in 'n Azure rekening te lys, kan jy die Azure Command-Line Interface (CLI) gebruik. Hier is die stappe:

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## Netwerk Sekuriteits Groepe (NSG)

In Azure dien 'n **Netwerk Sekuriteits Groep (NSG)** as die prim√™re funksie om netwerkverkeer te filtreer, beide na en van Azure hulpbronne binne 'n Azure Virtuele Netwerk (VNet). Dit huisves 'n stel **sekuriteitsre√´ls** wat die vloei van netwerkverkeer noukeurig bepaal.

Belangrike aspekte van NSG sluit in:

* **Verkeersbeheer**: Elke NSG bevat re√´ls wat instrumenteel is in die toelaat of blokkeer van inkomende en uitgaande netwerkverkeer wat verband hou met verskeie Azure hulpbronne.
* **Re√´lkomponente**: Die re√´ls binne 'n NSG is baie spesifiek, wat verkeer filtreer op grond van kriteria soos bron/bestemmings IP-adres, poort, en protokol. Hierdie spesifisiteit stel in staat tot fynbestuur van netwerkverkeer.
* **Sekuriteitsverbetering**: Deur te verseker dat slegs gemagtigde verkeer jou Azure hulpbronne kan binnekom of verlaat, speel NSG's 'n cruciale rol in die versterking van die sekuriteitsposisie van jou netwerk infrastruktuur.

### **Voorbeeld**

* Stel jou voor jy het 'n NSG genaamd `MyNSG` toegepas op 'n subnet of 'n spesifieke virtuele masjien binne jou VNet. Jy kan re√´ls skep soos:
* 'n Inkomende re√´l wat HTTP-verkeer (poort 80) van enige bron na jou webbedieners toelaat.
* 'n Uitgaande re√´l wat slegs SQL-verkeer (poort 1433) na 'n spesifieke bestemmings IP-adres reeks toelaat.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall is 'n bestuurde, wolk-gebaseerde **netwerk sekuriteitsdiens wat jou Azure Virtuele Netwerk hulpbronne beskerm**. Dit is 'n volledig staatlike firewall as 'n diens met ingeboude ho√´ beskikbaarheid en skaalbaarheid funksies.

Azure Firewall bied **meer gevorderde** funksies as **NSGs**, insluitend **aansoekvlak filtrering**, netwerkvlak filtrering, bedreigingsintelligensie-gebaseerde filtrering, en integrasie met Azure Monitor vir logging en analise.\
Dit kan uitgaande, inkomende, spoke-to-spoke, VPN, en ExpressRoute verkeer filter. **Firewall re√´ls kan geskep word op grond van FQDN (Volledig Gekwalifiseerde Domeinnaam), IP adresse, en poorte**.

### Verskille tussen Azure Firewall en NSGs

1. **Bereik:**
* **NSG:** Werk op die subnet of netwerk interfase vlak. Dit is bedoel om basiese filtrering van inkomende en uitgaande verkeer van netwerk interfaces (NIC), VMs, of subnets te bied.
* **Azure Firewall:** Werk op die VNet vlak, wat 'n bre√´r bereik van beskerming bied. Dit is ontwerp om jou virtuele netwerk hulpbronne te beveilig en verkeer wat in en uit die VNet vloei te bestuur.
2. **Vermoe:**
* **NSG:** Bied basiese filtreringsvermo√´ns gebaseer op IP adres, poort, en protokol. Dit ondersteun nie gevorderde funksies soos aansoekvlak inspeksie of bedreigingsintelligensie nie.
* **Azure Firewall:** Bied gevorderde funksies soos aansoekvlak (Laag 7) verkeer filtrering, bedreigingsintelligensie-gebaseerde filtrering, netwerk verkeer filtrering, en meer. Dit ondersteun ook verskeie publieke IP adresse.
3. **Gebruik Gevalle:**
* **NSG:** Ideaal vir basiese netwerkvlak verkeer filtrering.
* **Azure Firewall:** Geskik vir meer komplekse filtrering scenario's waar aansoekvlak beheer, logging, en bedreigingsintelligensie benodig word.
4. **Bestuur en Monitering:**
* **NSG:** Bied basiese logging en integrasie met Azure Monitor.
* **Azure Firewall:** Bied gevorderde logging en analise vermo√´ns deur Azure Monitor, wat noodsaaklik is om die aard en patroon van die verkeer te verstaan.

### Enumeration

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## Netwerk Virtuele Toestel (NVA)

'n Netwerk Virtuele Toestel (**NVA**) in Azure is 'n virtuele toestel wat **netwerkfunksies binne 'n virtuele netwerk uitvoer**. NVA's word tipies gebruik vir netwerkfunksies wat **nie van nature beskikbaar** is in Azure of wanneer meer aanpassing benodig word. Hulle is essensieel **VM's wat netwerktoepassings of -dienste** uitvoer, soos vuurmure, WAN-optimaliseerders, of laaibalanseerders.

NVA's word gebruik vir komplekse routering, **sekuriteit**, en **netwerkverkeerbestuur** take. Hulle kan ontplooi word vanaf Azure **Marketplace**, waar baie derdepartyverskaffers hul toestelle aanbied wat gereed is vir integrasie in Azure-omgewings.

### **Voorbeeld**

* 'n Organisasie kan 'n NVA in Azure ontplooi om 'n **aangepaste vuurmuuroplossing** te skep. Hierdie NVA kan 'n **derdeparty vuurmursoftware** uitvoer, wat gevorderde funksies soos indringingdetectie, pakketinspeksie, of VPN-verbinding bied. Die NVA kan geconfigureer word om verkeer wat deur dit beweeg te inspekteer en te filtreer, wat verseker dat verbeterde sekuriteitsmaatre√´ls in plek is volgens die organisasie se beleide.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
{% endcode %}

## Azure Roete Tabels & Gebruiker Gedefinieerde Roetes (UDR)

**Azure Roete Tabels** is 'n kenmerk binne Microsoft Azure wat die **beheer van netwerkverkeer routing binne Azure Virtuele Netwerke (VNets)** moontlik maak. Essensieel definieer dit hoe **pakkette** tussen subnetwerke binne VNets, tussen VNets, of na eksterne netwerke **gestuur** word. Elke roete tabel bevat 'n stel re√´ls, bekend as roetes, wat spesifiseer hoe pakkette volgens hul bestemmings IP adresse gerouteer moet word.

**Gebruiker Gedefinieerde Roetes (UDR)** in Azure is **aangepaste roetes wat jy binne Azure Roete Tabels skep** om die **vloei van netwerkverkeer** binne en tussen Azure Virtuele Netwerke (VNets), en na eksterne verbindings te beheer. UDRs bied jou die buigsaamheid om netwerkverkeer volgens jou spesifieke vereistes te rig, wat Azure se standaard routingbesluite oortref.

Hierdie roetes is veral nuttig vir scenario's waar jy **verkeer deur 'n virtuele toestel** moet routeer, 'n spesifieke pad vir sekuriteit of beleidsnakoming moet afdwing, of met plaaslike netwerke moet integreer.

### **Voorbeeld**

* Neem aan jy het 'n Netwerk Virtuele Toestel (NVA) ontplooi om verkeer tussen subnetwerke binne 'n VNet te inspekteer. Jy kan 'n UDR skep wat al die verkeer van een subnet na 'n ander subnet deur die NVA laat gaan. Hierdie UDR verseker dat die NVA die verkeer vir sekuriteitsdoeleindes inspekteer voordat dit sy bestemming bereik.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Private Link

Azure Private Link is 'n diens in Azure wat **privaat toegang tot Azure-dienste moontlik maak** deur te verseker dat **verkeer tussen jou Azure virtuele netwerk (VNet) en die diens heeltemal binne Microsoft se Azure rugsteun netwerk beweeg**. Dit bring die diens effektief in jou VNet. Hierdie opstelling verbeter sekuriteit deur die data nie aan die openbare internet bloot te stel nie.

Private Link kan gebruik word met verskeie Azure-dienste, soos Azure Storage, Azure SQL Database, en pasgemaakte dienste wat via Private Link gedeel word. Dit bied 'n veilige manier om dienste van binne jou eie VNet of selfs van verskillende Azure-subskripsies te verbruik.

{% hint style="danger" %}
NSG's is nie van toepassing op private eindpunte nie, wat duidelik beteken dat die assosiasie van 'n NSG met 'n subnet wat die Private Link bevat, geen effek sal h√™ nie.
{% endhint %}

### **Voorbeeld**

* Oorweeg 'n scenario waar jy 'n **Azure SQL Database het wat jy veilig van jou VNet wil toegang**. Normaalweg kan dit behels dat jy die openbare internet oorsteek. Met Private Link kan jy 'n **private eindpunt in jou VNet skep** wat direk met die Azure SQL Database diens verbind. Hierdie eindpunt laat die databasis lyk asof dit deel van jou eie VNet is, toeganklik via 'n private IP-adres, wat dus veilige en private toegang verseker.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Diens Eindpunte

Azure Diens Eindpunte brei jou virtuele netwerk se private adresruimte en die identiteit van jou VNet uit na Azure dienste oor 'n direkte verbinding. Deur diens eindpunte in te skakel, **kan hulpbronne in jou VNet veilig met Azure dienste verbind**, soos Azure Storage en Azure SQL Database, met behulp van Azure se rugsteun netwerk. Dit verseker dat die **verkeer van die VNet na die Azure diens binne die Azure netwerk bly**, wat 'n meer veilige en betroubare pad bied.

### **Voorbeeld**

* Byvoorbeeld, 'n **Azure Storage** rekening is standaard oor die openbare internet toeganklik. Deur 'n **diens eindpunt vir Azure Storage binne jou VNet** in te skakel, kan jy verseker dat slegs verkeer van jou VNet toegang tot die stoorrekening het. Die stoorrekening se vuurmuur kan dan geconfigureer word om slegs verkeer van jou VNet te aanvaar.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Verskille Tussen Diens Eindpunte en Privaat Skakels

Microsoft beveel aan om Privaat Skakels te gebruik in die [**docs**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints):\\

<figure><img src="../../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

**Diens Eindpunte:**

* Verkeer van jou VNet na die Azure diens reis oor die Microsoft Azure rugsteun netwerk, wat die openbare internet omseil.
* Die eindpunt is 'n direkte verbinding na die Azure diens en bied nie 'n private IP vir die diens binne die VNet nie.
* Die diens self is steeds beskikbaar via sy openbare eindpunt van buite jou VNet tensy jy die diens vuurmuur konfigureer om sulke verkeer te blokkeer.
* Dit is 'n een-tot-een verhouding tussen die subnet en die Azure diens.
* Goedkoper as Privaat Skakels.

**Privaat Skakels:**

* Privaat Skakel kaart Azure dienste in jou VNet via 'n private eindpunt, wat 'n netwerkinterface met 'n private IP adres binne jou VNet is.
* Die Azure diens word toeganklik gemaak met hierdie private IP adres, wat dit laat lyk asof dit deel van jou netwerk is.
* Dienste wat via Privaat Skakel gekoppel is, kan slegs vanaf jou VNet of gekonnekteerde netwerke toeganklik wees; daar is geen openbare internettoegang tot die diens nie.
* Dit stel 'n veilige verbinding met Azure dienste of jou eie dienste wat in Azure gehos is, asook 'n verbinding met dienste wat deur ander gedeel word, moontlik.
* Dit bied meer fynbeheerde toegangbeheer via 'n private eindpunt in jou VNet, in teenstelling met bre√´r toegangbeheer op subnetvlak met diens eindpunte.

In samevatting, terwyl beide Diens Eindpunte en Privaat Skakels veilige konnektiwiteit na Azure dienste bied, **bied Privaat Skakels 'n ho√´r vlak van isolasie en sekuriteit deur te verseker dat dienste privaat toeganklik is sonder om hulle aan die openbare internet bloot te stel**. Diens Eindpunte, aan die ander kant, is makliker om op te stel vir algemene gevalle waar eenvoudige, veilige toegang tot Azure dienste benodig word sonder die behoefte aan 'n private IP in die VNet.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door** is 'n skaalbare en veilige toegangspunt vir **vinnige aflewering** van jou globale webtoepassings. Dit **kombineer** verskeie dienste soos globale **laaibalansering, webwerfversnelling, SSL-aflaai, en Webtoepassing Vuurmuur (WAF)** vermo√´ns in 'n enkele diens. Azure Front Door bied intelligente routering gebaseer op die **nabyste rand ligging aan die gebruiker**, wat optimale prestasie en betroubaarheid verseker. Daarbenewens bied dit URL-gebaseerde routering, veelvuldige webwerfgasheer, sessie-affiniteid, en toepassingslaagnavorsing.

**Azure Front Door WAF** is ontwerp om **webtoepassings te beskerm teen web-gebaseerde aanvalle** sonder om agtergrondkode te wysig. Dit sluit pasgemaakte re√´ls en bestuurde re√´lstelle in om teen bedreigings soos SQL-inspuiting, kruis-webwerf skripting, en ander algemene aanvalle te beskerm.

### **Voorbeeld**

* Stel jou voor jy het 'n globaal verspreide toepassing met gebruikers regoor die w√™reld. Jy kan Azure Front Door gebruik om **gebruikers versoeke na die naaste streeksdatacentrum** wat jou toepassing gasheer, te **routeer, wat latensie verminder, gebruikerservaring verbeter en dit teen webaanvalle met die WAF vermo√´ns verdedig**. As 'n spesifieke streek stilstand ervaar, kan Azure Front Door verkeer outomaties na die volgende beste ligging herrouter, wat ho√´ beskikbaarheid verseker.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Application Gateway en Azure Application Gateway WAF

Azure Application Gateway is 'n **webverkeer laaibalanser** wat jou in staat stel om verkeer na jou **web** toepassings te bestuur. Dit bied **Laag 7 laaibalansering, SSL-terminering, en webtoepassing vuurmuur (WAF) vermo√´ns** in die Toepassing Aflewering Beheerder (ADC) as 'n diens. Sleutelkenmerke sluit URL-gebaseerde roetering, koekie-gebaseerde sessie affiniteid, en veilige sokkellaag (SSL) aflaai in, wat noodsaaklik is vir toepassings wat komplekse laaibalansering vermo√´ns vereis soos globale roetering en pad-gebaseerde roetering.

### Voorbeeld

* Oorweeg 'n scenario waar jy 'n e-handel webwerf het wat verskeie subdomeine insluit vir verskillende funksies, soos gebruikersrekeninge en betalingsverwerking. Azure Application Gateway kan **verkeer na die toepaslike webbedieners roeteer op grond van die URL-pad**. Byvoorbeeld, verkeer na `example.com/accounts` kan na die gebruikersrekeninge diens gelei word, en verkeer na `example.com/pay` kan na die betalingsverwerkingsdiens gelei word.\
En **beskerm jou webwerf teen aanvalle met die WAF vermo√´ns.**

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering** is 'n netwerkfunksie in Azure wat **verskillende Virtuele Netwerke (VNets) toelaat om direk en naatloos gekoppel te word**. Deur VNet peering kan hulpbronne in een VNet kommunikeer met hulpbronne in 'n ander VNet met behulp van private IP adresse, **asof hulle in dieselfde netwerk is**.\
**VNet Peering kan ook gebruik word met 'n plaaslike netwerk** deur 'n site-to-site VPN of Azure ExpressRoute op te stel.

**Azure Hub en Spoke** is 'n netwerktopologie wat in Azure gebruik word om netwerkverkeer te bestuur en te organiseer. **Die "hub" is 'n sentrale punt wat verkeer tussen verskillende "spokes" beheer en roete**. Die hub bevat tipies gedeelde dienste soos netwerk virtuele toestelle (NVAs), Azure VPN Gateway, Azure Firewall, of Azure Bastion. Die **"spokes" is VNets wat werklading huisves en met die hub verbind deur VNet peering**, wat hulle toelaat om die gedeelde dienste binne die hub te benut. Hierdie model bevorder 'n skoon netwerkopstelling, wat kompleksiteit verminder deur algemene dienste te sentraliseer wat verskeie werklading oor verskillende VNets kan gebruik.

{% hint style="danger" %}
**VNET paarvorming is nie-transitief in Azure**, wat beteken dat as spoke 1 met spoke 2 verbind is en spoke 2 met spoke 3 verbind is, dan kan spoke 1 nie direk met spoke 3 praat nie.
{% endhint %}

### Voorbeelde

* Stel jou 'n maatskappy voor met aparte afdelings soos Verkope, HR, en Ontwikkeling, **elke met sy eie VNet (die spokes)**. Hierdie VNets **vereis toegang tot gedeelde hulpbronne** soos 'n sentrale databasis, 'n firewall, en 'n internetgateway, wat almal gele√´ is in **'n ander VNet (die hub)**. Deur die Hub en Spoke-model te gebruik, kan elke afdeling **veilig met die gedeelde hulpbronne verbind deur die hub VNet sonder om daardie hulpbronne aan die openbare internet bloot te stel** of 'n komplekse netwerkstruktuur met talle verbindings te skep.

### Enumerasie

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

'n Site-to-Site VPN in Azure laat jou toe om jou **plaaslike netwerk aan jou Azure Virtuele Netwerk (VNet) te koppel**, wat hulpbronne soos VM's binne Azure in staat stel om te lyk asof hulle op jou plaaslike netwerk is. Hierdie verbinding word tot stand gebring deur 'n **VPN-gateway wat verkeer enkripteer** tussen die twee netwerke.

### **Voorbeeld**

* 'n Besigheid met sy hoofkantoor in New York het 'n plaaslike datacentrum wat veilig aan sy VNet in Azure moet koppel, wat sy gevirtualiseerde werklas huisves. Deur 'n **Site-to-Site VPN op te stel, kan die maatskappy verseker dat daar enkripteerde konneksie tussen die plaaslike bedieners en die Azure VM's is**, wat dit moontlik maak om hulpbronne veilig oor beide omgewings te benader asof hulle in dieselfde plaaslike netwerk is.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute is 'n diens wat 'n **private, toegewyde, ho√´spoedverbinding tussen jou plaaslike infrastruktuur en Azure datacenters** bied. Hierdie verbinding word gemaak deur 'n verbindingsverskaffer, wat die publieke internet omseil en meer betroubaarheid, vinniger snelhede, laer latensies, en ho√´r sekuriteit as tipiese internetverbindinge bied.

### **Voorbeeld**

* 'n Multinasionale korporasie vereis 'n **konstante en betroubare verbinding met sy Azure dienste weens die ho√´ volume van data** en die behoefte aan ho√´ deurset. Die maatskappy kies vir Azure ExpressRoute om sy plaaslike datacentrum direk aan Azure te verbind, wat grootmaat data-oordragte, soos daaglikse rugsteun en regstreekse data-analise, met verbeterde privaatheid en spoed fasiliteer.

### **Enumerasie**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
