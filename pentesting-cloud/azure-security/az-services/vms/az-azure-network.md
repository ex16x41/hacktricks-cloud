# Az - Azure Network

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Azure iÃ§indeki aÄŸlar, Ã§eÅŸitli Azure hizmetleri ve kaynaklarÄ± arasÄ±nda **baÄŸlantÄ± ve iletiÅŸim** saÄŸlamak iÃ§in bulut biliÅŸim platformunun ayrÄ±lmaz bir parÃ§asÄ± olarak iÅŸlev gÃ¶rÃ¼r. Azure'daki aÄŸ mimarisi, yÃ¼ksek Ã¶lÃ§eklenebilirlik, gÃ¼venlik ve Ã¶zelleÅŸtirilebilirlik saÄŸlamak Ã¼zere tasarlanmÄ±ÅŸtÄ±r.

Temelinde, Azure, kullanÄ±cÄ±larÄ±n Azure bulutunda **izole** **aÄŸlar** oluÅŸturmasÄ±na olanak tanÄ±yan bir **sanaldan aÄŸ (VNet)** saÄŸlar. Bu VNets iÃ§inde, sanal makineler, uygulamalar ve veritabanlarÄ± gibi kaynaklar gÃ¼venli bir ÅŸekilde barÄ±ndÄ±rÄ±labilir ve yÃ¶netilebilir. Azure'daki aÄŸ, hem bulut iÃ§indeki iletiÅŸimi (Azure hizmetleri arasÄ±nda) hem de dÄ±ÅŸ aÄŸlara ve internete baÄŸlantÄ±yÄ± destekler.

**GÃ¼venlik**, Azure aÄŸlarÄ±nÄ±n kritik bir yÃ¶nÃ¼dÃ¼r ve verileri korumak, eriÅŸimi yÃ¶netmek ve uyumluluÄŸu saÄŸlamak iÃ§in Ã§eÅŸitli araÃ§lar ve hizmetler mevcuttur. Bu gÃ¼venlik Ã¶nlemleri, trafiÄŸi ve eriÅŸimi kontrol etme konusunda yÃ¼ksek bir dÃ¼zey saÄŸlamak iÃ§in **gÃ¼venlik duvarlarÄ±**, **aÄŸ gÃ¼venlik gruplarÄ±** ve **ÅŸifreleme** yeteneklerini iÃ§erir.

Genel olarak, Azure'Ä±n aÄŸ yetenekleri, kullanÄ±cÄ±larÄ±n belirli uygulama ve iÅŸ yÃ¼kÃ¼ ihtiyaÃ§larÄ±na uygun bir aÄŸ ortamÄ± oluÅŸturmasÄ±na olanak tanÄ±rken gÃ¼venlik ve gÃ¼venilirliÄŸe gÃ¼Ã§lÃ¼ bir vurgu yapacak ÅŸekilde tasarlanmÄ±ÅŸtÄ±r.

## Virtual Network (VNET) & Subnets

Azure'daki bir VNet, esasen buluttaki kendi aÄŸÄ±nÄ±zÄ±n bir temsilidir. Bu, **abone olduÄŸunuz Azure bulutunun mantÄ±ksal izolasyonudur**. Bir VNet, Azure'da sanal Ã¶zel aÄŸlar (VPN'ler) oluÅŸturmanÄ±za ve yÃ¶netmenize olanak tanÄ±r ve **birden fazla tÃ¼rde Azure kaynaÄŸÄ±nÄ±** barÄ±ndÄ±rmak ve **yÃ¶netmek** iÃ§in kullanÄ±labilir; Ã¶rneÄŸin Sanal Makineler (VM'ler), veritabanlarÄ± ve uygulama hizmetleri.

VNets, **IP adresi** aralÄ±klarÄ±, alt aÄŸ oluÅŸturma, yÃ¶nlendirme tablolarÄ± ve aÄŸ geÃ§itleri dahil olmak Ã¼zere aÄŸ ayarlarÄ±nÄ±z Ã¼zerinde **tam kontrol** saÄŸlar.

Bir **alt aÄŸ**, VNet'inizdeki **IP adresleri aralÄ±ÄŸÄ±dÄ±r**. Bir VNet'i organizasyon ve gÃ¼venlik iÃ§in birden fazla alt aÄŸa bÃ¶lebilirsiniz. Bir VNet'teki her alt aÄŸ, kaynaklarÄ± aÄŸ ve uygulama mimarinize gÃ¶re izole etmek ve gruplamak iÃ§in kullanÄ±labilir.

AyrÄ±ca, alt aÄŸlar, VNet'inizi bir veya daha fazla alt aÄŸa **bÃ¶lmenize** olanak tanÄ±r ve kaynaklarÄ±n kullanabileceÄŸi bir IP adresi aralÄ±ÄŸÄ± saÄŸlar.

### **Example**

* Diyelim ki `MyVNet` adÄ±nda bir VNet'iniz var ve IP adresi aralÄ±ÄŸÄ± `10.0.0.0/16`. Bu VNet iÃ§inde, web sunucularÄ±nÄ±zÄ± barÄ±ndÄ±rmak iÃ§in `10.0.0.0/24` IP adresi aralÄ±ÄŸÄ±na sahip `Subnet-1` adÄ±nda bir alt aÄŸ oluÅŸturabilirsiniz. `10.0.1.0/24` aralÄ±ÄŸÄ±na sahip baÅŸka bir alt aÄŸ, `Subnet-2`, veritabanÄ± sunucularÄ±nÄ±z iÃ§in kullanÄ±labilir. Bu segmentasyon, aÄŸ iÃ§inde verimli yÃ¶netim ve gÃ¼venlik kontrolleri saÄŸlar.

### Enumeration

Azure hesabÄ±ndaki tÃ¼m VNets ve alt aÄŸlarÄ± listelemek iÃ§in Azure Komut SatÄ±rÄ± ArayÃ¼zÃ¼ (CLI) kullanabilirsiniz. Ä°ÅŸte adÄ±mlar: 

{% code overflow="wrap" %}
```bash
# List VNets
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List subnets of a VNet
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, addressPrefix:addressPrefix}" -o table
```
{% endcode %}

## AÄŸ GÃ¼venlik GruplarÄ± (NSG)

Azure'da, bir **AÄŸ GÃ¼venlik Grubu (NSG)**, Azure Sanal AÄŸÄ± (VNet) iÃ§indeki Azure kaynaklarÄ±na giden ve gelen aÄŸ trafiÄŸini filtrelemenin ana iÅŸlevini yerine getirir. AÄŸ trafiÄŸinin akÄ±ÅŸÄ±nÄ± titizlikle belirleyen bir dizi **gÃ¼venlik kuralÄ±** barÄ±ndÄ±rÄ±r.

NSG'nin ana yÃ¶nleri ÅŸunlardÄ±r:

* **Trafik KontrolÃ¼**: Her NSG, Ã§eÅŸitli Azure kaynaklarÄ±yla iliÅŸkili gelen ve giden aÄŸ trafiÄŸini ya izin verme ya da engelleme konusunda etkili olan kurallar iÃ§erir.
* **Kural BileÅŸenleri**: Bir NSG iÃ§indeki kurallar son derece spesifiktir ve trafiÄŸi kaynak/hedef IP adresi, port ve protokol gibi kriterlere gÃ¶re filtreler. Bu spesifiklik, aÄŸ trafiÄŸinin ayrÄ±ntÄ±lÄ± yÃ¶netimini saÄŸlar.
* **GÃ¼venlik ArtÄ±ÅŸÄ±**: Sadece yetkilendirilmiÅŸ trafiÄŸin Azure kaynaklarÄ±nÄ±za girmesine veya Ã§Ä±kmasÄ±na izin vererek, NSG'ler aÄŸ altyapÄ±nÄ±zÄ±n gÃ¼venlik duruÅŸunu gÃ¼Ã§lendirmede kritik bir rol oynar.

### **Ã–rnek**

* VNet'inizde bir alt aÄŸa veya belirli bir sanal makineye uygulanan `MyNSG` adlÄ± bir NSG'niz olduÄŸunu hayal edin. AÅŸaÄŸÄ±daki gibi kurallar oluÅŸturabilirsiniz:
* Herhangi bir kaynaktan web sunucularÄ±nÄ±za HTTP trafiÄŸine (port 80) izin veren bir gelen kural.
* Belirli bir hedef IP adresi aralÄ±ÄŸÄ±na yalnÄ±zca SQL trafiÄŸine (port 1433) izin veren bir giden kural.

### SayÄ±m

{% code overflow="wrap" %}
```bash
# List NSGs
az network nsg list --query "[].{name:name, location:location}" -o table

# Get NSG rules
az network nsg rule list --nsg-name <NSGName> --resource-group <ResourceGroupName> --query "[].{name:name, priority:priority, direction:direction, access:access, protocol:protocol, sourceAddressPrefix:sourceAddressPrefix, destinationAddressPrefix:destinationAddressPrefix, sourcePortRange:sourcePortRange, destinationPortRange:destinationPortRange}" -o table
```
{% endcode %}

## Azure Firewall

Azure Firewall, **Azure Sanal AÄŸ kaynaklarÄ±nÄ±zÄ± koruyan yÃ¶netilen, bulut tabanlÄ± bir aÄŸ gÃ¼venlik hizmetidir**. YÃ¼ksek kullanÄ±labilirlik ve Ã¶lÃ§eklenebilirlik Ã¶zellikleri ile tamamen durum bilgisi olan bir hizmet olarak sunulan bir gÃ¼venlik duvarÄ±dÄ±r.

Azure Firewall, **NSG'lerden daha geliÅŸmiÅŸ** Ã¶zellikler sunar; bunlar arasÄ±nda **uygulama dÃ¼zeyinde filtreleme**, aÄŸ dÃ¼zeyinde filtreleme, tehdit istihbaratÄ±na dayalÄ± filtreleme ve gÃ¼nlÃ¼kleme ve analiz iÃ§in Azure Monitor ile entegrasyon bulunmaktadÄ±r.\
Ã‡Ä±kÄ±ÅŸ, giriÅŸ, spoke-to-spoke, VPN ve ExpressRoute trafiÄŸini filtreleyebilir. **GÃ¼venlik duvarÄ± kurallarÄ± FQDN (Tam Nitelikli Alan AdÄ±), IP adresleri ve portlara dayalÄ± olarak oluÅŸturulabilir.**

### Azure Firewall ve NSG'ler ArasÄ±ndaki Farklar

1. **Kapsam:**
* **NSG:** Alt aÄŸ veya aÄŸ arayÃ¼zÃ¼ dÃ¼zeyinde Ã§alÄ±ÅŸÄ±r. AÄŸ arayÃ¼zlerinden (NIC), VM'lerden veya alt aÄŸlardan gelen ve giden trafiÄŸin temel filtrelemesini saÄŸlamak iÃ§in tasarlanmÄ±ÅŸtÄ±r.
* **Azure Firewall:** VNet dÃ¼zeyinde Ã§alÄ±ÅŸÄ±r ve daha geniÅŸ bir koruma kapsamÄ± sunar. Sanal aÄŸ kaynaklarÄ±nÄ±zÄ± gÃ¼vence altÄ±na almak ve VNet'e giren ve Ã§Ä±kan trafiÄŸi yÃ¶netmek iÃ§in tasarlanmÄ±ÅŸtÄ±r.
2. **Yetenekler:**
* **NSG:** IP adresi, port ve protokole dayalÄ± temel filtreleme yetenekleri sunar. Uygulama dÃ¼zeyinde denetim veya tehdit istihbaratÄ± gibi geliÅŸmiÅŸ Ã¶zellikleri desteklemez.
* **Azure Firewall:** Uygulama dÃ¼zeyinde (Katman 7) trafik filtreleme, tehdit istihbaratÄ±na dayalÄ± filtreleme, aÄŸ trafiÄŸi filtreleme gibi geliÅŸmiÅŸ Ã¶zellikler sunar. AyrÄ±ca birden fazla genel IP adresini destekler.
3. **KullanÄ±m SenaryolarÄ±:**
* **NSG:** Temel aÄŸ dÃ¼zeyinde trafik filtreleme iÃ§in idealdir.
* **Azure Firewall:** Uygulama dÃ¼zeyinde kontrol, gÃ¼nlÃ¼kleme ve tehdit istihbaratÄ±nÄ±n gerekli olduÄŸu daha karmaÅŸÄ±k filtreleme senaryolarÄ± iÃ§in uygundur.
4. **YÃ¶netim ve Ä°zleme:**
* **NSG:** Temel gÃ¼nlÃ¼kleme ve Azure Monitor ile entegrasyon sunar.
* **Azure Firewall:** Azure Monitor aracÄ±lÄ±ÄŸÄ±yla geliÅŸmiÅŸ gÃ¼nlÃ¼kleme ve analiz yetenekleri saÄŸlar; bu, trafiÄŸin doÄŸasÄ±nÄ± ve desenini anlamak iÃ§in gereklidir.

### Enumeration

{% code overflow="wrap" %}
```bash
# List Azure Firewalls
az network firewall list --query "[].{name:name, location:location, subnet:subnet, publicIp:publicIp}" -o table

# Get network rules of a firewall
az network firewall network-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get application rules of a firewall
az network firewall application-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table

# Get nat rules of a firewall
az network firewall nat-rule collection list --firewall-name <FirewallName> --resource-group <ResourceGroupName> --query "[].{name:name, rules:rules}" -o table
```
{% endcode %}

## AÄŸ Sanal CihazÄ± (NVA)

AÄŸ Sanal CihazÄ± (**NVA**) Azure'da **sanal bir aÄŸ iÅŸlevi** gerÃ§ekleÅŸtiren bir sanal cihazdÄ±r. NVAlar genellikle Azure'da **doÄŸal olarak mevcut olmayan** aÄŸ iÅŸlevleri iÃ§in veya daha fazla Ã¶zelleÅŸtirme gerektiÄŸinde kullanÄ±lÄ±r. Temelde, **aÄŸ uygulamalarÄ± veya hizmetleri** Ã§alÄ±ÅŸtÄ±ran **VM'lerdir**, Ã¶rneÄŸin gÃ¼venlik duvarlarÄ±, WAN optimizasyon cihazlarÄ± veya yÃ¼k dengeleyiciler.

NVAlar karmaÅŸÄ±k yÃ¶nlendirme, **gÃ¼venlik** ve **aÄŸ trafiÄŸi yÃ¶netimi** gÃ¶revleri iÃ§in kullanÄ±lÄ±r. Azure **Marketplace**'ten daÄŸÄ±tÄ±labilirler; burada birÃ§ok Ã¼Ã§Ã¼ncÃ¼ taraf satÄ±cÄ±, Azure ortamlarÄ±na entegrasyon iÃ§in hazÄ±r cihazlarÄ±nÄ± sunar.

### **Ã–rnek**

* Bir kuruluÅŸ, Azure'da **Ã¶zel bir gÃ¼venlik duvarÄ± Ã§Ã¶zÃ¼mÃ¼** oluÅŸturmak iÃ§in bir NVA daÄŸÄ±tabilir. Bu NVA, **Ã¼Ã§Ã¼ncÃ¼ taraf bir gÃ¼venlik duvarÄ± yazÄ±lÄ±mÄ±** Ã§alÄ±ÅŸtÄ±rabilir ve saldÄ±rÄ± tespiti, paket inceleme veya VPN baÄŸlantÄ±sÄ± gibi geliÅŸmiÅŸ Ã¶zellikler sunabilir. NVA, Ã¼zerinden geÃ§en trafiÄŸi incelemek ve filtrelemek iÃ§in yapÄ±landÄ±rÄ±labilir, bÃ¶ylece kuruluÅŸun politikalarÄ±na uygun olarak geliÅŸtirilmiÅŸ gÃ¼venlik Ã¶nlemlerinin uygulanmasÄ±nÄ± saÄŸlar.

### **SÄ±ralama**

{% code overflow="wrap" %}
```bash
# Usually NVAs are named or tagged in a way to distinguish them from other VMs
az vm list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# For a specific VM identified as an NVA, list its network interfaces
az vm nic list --vm-name <VMName> --resource-group <ResourceGroupName> --query "[].{id:id}" -o table
```
{% endcode %}

## Azure Route Tables & User Defined Routes (UDR)

**Azure Route Tables**, Microsoft Azure iÃ§inde **Azure Sanal AÄŸlarÄ± (VNet)** iÃ§indeki aÄŸ trafiÄŸi yÃ¶nlendirmesini kontrol etme Ã¶zelliÄŸidir. Temelde, **paketlerin** VNet'ler iÃ§indeki alt aÄŸlar arasÄ±nda, VNet'ler arasÄ±nda veya dÄ±ÅŸ aÄŸlara nasÄ±l **iletileceÄŸini** tanÄ±mlar. Her yÃ¶nlendirme tablosu, paketlerin hedef IP adreslerine gÃ¶re nasÄ±l yÃ¶nlendirilmesi gerektiÄŸini belirten, yÃ¶nlendirme olarak bilinen bir dizi kural iÃ§erir.

**User Defined Routes (UDR)**, Azure'da **Azure Route Tables iÃ§inde oluÅŸturduÄŸunuz Ã¶zel yÃ¶nlendirmelerdir** ve Azure Sanal AÄŸlarÄ± (VNet) iÃ§indeki ve arasÄ±ndaki aÄŸ trafiÄŸinin akÄ±ÅŸÄ±nÄ± kontrol etmek iÃ§in kullanÄ±lÄ±r, ayrÄ±ca dÄ±ÅŸ baÄŸlantÄ±lar iÃ§in de geÃ§erlidir. UDR'ler, aÄŸ trafiÄŸini belirli gereksinimlerinize gÃ¶re yÃ¶nlendirme esnekliÄŸi saÄŸlar ve Azure'un varsayÄ±lan yÃ¶nlendirme kararlarÄ±nÄ± geÃ§ersiz kÄ±lmanÄ±za olanak tanÄ±r.

Bu yÃ¶nlendirmeler, trafiÄŸi bir sanal cihazdan geÃ§irmek, gÃ¼venlik veya politika uyumluluÄŸu iÃ§in belirli bir yolu zorunlu kÄ±lmak veya yerel aÄŸlarla entegrasyon saÄŸlamak gerektiÄŸi senaryolar iÃ§in Ã¶zellikle faydalÄ±dÄ±r.

### **Ã–rnek**

* Diyelim ki, bir VNet iÃ§indeki alt aÄŸlar arasÄ±nda trafiÄŸi denetlemek iÃ§in bir AÄŸ Sanal CihazÄ± (NVA) daÄŸÄ±ttÄ±nÄ±z. Bir alt aÄŸdan diÄŸer bir alt aÄŸa giden tÃ¼m trafiÄŸi NVA Ã¼zerinden yÃ¶nlendiren bir UDR oluÅŸturabilirsiniz. Bu UDR, trafiÄŸin hedefe ulaÅŸmadan Ã¶nce gÃ¼venlik amaÃ§larÄ± iÃ§in NVA tarafÄ±ndan denetlenmesini saÄŸlar.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List Route Tables
az network route-table list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List UDRs for a table
az network route-table route list --route-table-name <RouteTableName> --resource-group <ResourceGroupName> --query "[].{name:name, addressPrefix:addressPrefix, nextHopType:nextHopType, nextHopIpAddress:nextHopIpAddress}" -o table
```
{% endcode %}

## Azure Ã–zel BaÄŸlantÄ±

Azure Ã–zel BaÄŸlantÄ±, **Azure hizmetlerine Ã¶zel eriÅŸim saÄŸlamayÄ±** mÃ¼mkÃ¼n kÄ±lan bir hizmettir; bu, **Azure sanal aÄŸÄ±nÄ±z (VNet) ile hizmet arasÄ±ndaki trafiÄŸin tamamen Microsoft'un Azure omurga aÄŸÄ± iÃ§inde seyahat etmesini saÄŸlar**. Bu yapÄ±, hizmeti VNet'inize getirir. Bu kurulum, verileri genel internete maruz bÄ±rakmadÄ±ÄŸÄ± iÃ§in gÃ¼venliÄŸi artÄ±rÄ±r.

Ã–zel BaÄŸlantÄ±, Azure Depolama, Azure SQL VeritabanÄ± ve Ã–zel BaÄŸlantÄ± aracÄ±lÄ±ÄŸÄ±yla paylaÅŸÄ±lan Ã¶zel hizmetler gibi Ã§eÅŸitli Azure hizmetleri ile kullanÄ±labilir. Kendi VNet'inizden veya farklÄ± Azure aboneliklerinden hizmetleri tÃ¼ketmenin gÃ¼venli bir yolunu saÄŸlar.

{% hint style="danger" %}
NSG'ler Ã¶zel uÃ§ noktalara uygulanmaz, bu da bir NSG'yi Ã–zel BaÄŸlantÄ±yÄ± iÃ§eren bir alt aÄŸa iliÅŸkilendirmenin hiÃ§bir etkisi olmayacaÄŸÄ± anlamÄ±na gelir.
{% endhint %}

### **Ã–rnek**

* **VNet'inizden gÃ¼venli bir ÅŸekilde eriÅŸmek istediÄŸiniz bir Azure SQL VeritabanÄ±** senaryosunu dÃ¼ÅŸÃ¼nÃ¼n. Normalde, bu genel internet Ã¼zerinden geÃ§iÅŸ yapmayÄ± gerektirebilir. Ã–zel BaÄŸlantÄ± ile, Azure SQL VeritabanÄ± hizmetine doÄŸrudan baÄŸlanan **VNet'inizde bir Ã¶zel uÃ§ nokta oluÅŸturabilirsiniz**. Bu uÃ§ nokta, veritabanÄ±nÄ± kendi VNet'inizin bir parÃ§asÄ±ymÄ±ÅŸ gibi gÃ¶sterir ve Ã¶zel bir IP adresi aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilir hale getirir, bÃ¶ylece gÃ¼venli ve Ã¶zel eriÅŸim saÄŸlanÄ±r.

### **SÄ±ralama**

{% code overflow="wrap" %}
```bash
# List Private Link Services
z network private-link-service list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List Private Endpoints
az network private-endpoint list --query "[].{name:name, location:location, resourceGroup:resourceGroup, privateLinkServiceConnections:privateLinkServiceConnections}" -o table
```
{% endcode %}

## Azure Servis UÃ§ NoktalarÄ±

Azure Servis UÃ§ NoktalarÄ±, sanal aÄŸÄ±nÄ±zÄ±n Ã¶zel adres alanÄ±nÄ± ve VNet'inizin kimliÄŸini doÄŸrudan bir baÄŸlantÄ± Ã¼zerinden Azure hizmetlerine geniÅŸletir. Servis uÃ§ noktalarÄ±nÄ± etkinleÅŸtirerek, **VNet'inizdeki kaynaklar Azure hizmetlerine gÃ¼venli bir ÅŸekilde baÄŸlanabilir**, Ã¶rneÄŸin Azure Storage ve Azure SQL Database, Azure'Ä±n omurga aÄŸÄ± kullanÄ±larak. Bu, **VNet'ten Azure hizmetine giden trafiÄŸin Azure aÄŸÄ± iÃ§inde kalmasÄ±nÄ± saÄŸlar**, daha gÃ¼venli ve gÃ¼venilir bir yol sunar.

### **Ã–rnek**

* Ã–rneÄŸin, bir **Azure Storage** hesabÄ± varsayÄ±lan olarak genel internet Ã¼zerinden eriÅŸilebilir. **VNet'iniz iÃ§inde Azure Storage iÃ§in bir servis uÃ§ noktasÄ± etkinleÅŸtirerek**, yalnÄ±zca VNet'inizden gelen trafiÄŸin depolama hesabÄ±na eriÅŸmesini saÄŸlayabilirsiniz. Depolama hesabÄ± gÃ¼venlik duvarÄ±, yalnÄ±zca VNet'inizden gelen trafiÄŸi kabul edecek ÅŸekilde yapÄ±landÄ±rÄ±labilir.

### **SÄ±ralama**

{% code overflow="wrap" %}
```bash
# List Virtual Networks with Service Endpoints
az network vnet list --query "[].{name:name, location:location, serviceEndpoints:serviceEndpoints}" -o table

# List Subnets with Service Endpoints
az network vnet subnet list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, serviceEndpoints:serviceEndpoints}" -o table
```
{% endcode %}

### Service Endpoint'leri ve Ã–zel BaÄŸlantÄ±lar ArasÄ±ndaki Farklar

Microsoft, [**docs**](https://learn.microsoft.com/en-us/azure/virtual-network/vnet-integration-for-azure-services#compare-private-endpoints-and-service-endpoints) sayfasÄ±nda Ã–zel BaÄŸlantÄ±larÄ±n kullanÄ±lmasÄ±nÄ± Ã¶nermektedir: \\

<figure><img src="../../../../.gitbook/assets/image (25).png" alt=""><figcaption></figcaption></figure>

**Service Endpoint'leri:**

* VNet'inizden Azure hizmetine giden trafik, kamu internetini atlayarak Microsoft Azure omurga aÄŸÄ± Ã¼zerinden geÃ§er.
* Endpoint, Azure hizmetine doÄŸrudan bir baÄŸlantÄ±dÄ±r ve VNet iÃ§inde hizmet iÃ§in Ã¶zel bir IP saÄŸlamaz.
* Hizmetin kendisi, hizmet gÃ¼venlik duvarÄ±nÄ± bu tÃ¼r trafiÄŸi engelleyecek ÅŸekilde yapÄ±landÄ±rmadÄ±ÄŸÄ±nÄ±z sÃ¼rece, VNet'iniz dÄ±ÅŸÄ±ndan kamu endpoint'i aracÄ±lÄ±ÄŸÄ±yla hala eriÅŸilebilir.
* Alt aÄŸ ile Azure hizmeti arasÄ±nda bire bir iliÅŸki vardÄ±r.
* Ã–zel BaÄŸlantÄ±lardan daha az maliyetlidir.

**Ã–zel BaÄŸlantÄ±lar:**

* Ã–zel BaÄŸlantÄ±, Azure hizmetlerini VNet'inize Ã¶zel bir endpoint aracÄ±lÄ±ÄŸÄ±yla haritalar; bu, VNet'iniz iÃ§inde Ã¶zel bir IP adresine sahip bir aÄŸ arayÃ¼zÃ¼dÃ¼r.
* Azure hizmetine bu Ã¶zel IP adresi kullanÄ±larak eriÅŸilir, bu da onu aÄŸÄ±nÄ±zÄ±n bir parÃ§asÄ± gibi gÃ¶sterir.
* Ã–zel BaÄŸlantÄ± aracÄ±lÄ±ÄŸÄ±yla baÄŸlanan hizmetlere yalnÄ±zca VNet'inizden veya baÄŸlÄ± aÄŸlardan eriÅŸilebilir; hizmete kamu internet eriÅŸimi yoktur.
* Azure hizmetlerine veya Azure'da barÄ±ndÄ±rÄ±lan kendi hizmetlerinize gÃ¼venli bir baÄŸlantÄ± saÄŸlar ve baÅŸkalarÄ± tarafÄ±ndan paylaÅŸÄ±lan hizmetlere de baÄŸlantÄ± sunar.
* VNet'inizde Ã¶zel bir endpoint aracÄ±lÄ±ÄŸÄ±yla daha ayrÄ±ntÄ±lÄ± eriÅŸim kontrolÃ¼ saÄŸlar; bu, service endpoint'leri ile alt aÄŸ dÃ¼zeyinde daha geniÅŸ eriÅŸim kontrolÃ¼ne kÄ±yasla daha Ã¶zelleÅŸmiÅŸ bir kontrol sunar.

Ã–zetle, hem Service Endpoint'leri hem de Ã–zel BaÄŸlantÄ±lar Azure hizmetlerine gÃ¼venli baÄŸlantÄ± saÄŸlarken, **Ã–zel BaÄŸlantÄ±lar, hizmetlerin kamu internetine maruz kalmadan Ã¶zel olarak eriÅŸilmesini saÄŸlayarak daha yÃ¼ksek bir izolasyon ve gÃ¼venlik seviyesi sunar**. Ã–te yandan, Service Endpoint'leri, VNet iÃ§inde Ã¶zel bir IP gerektirmeden Azure hizmetlerine basit ve gÃ¼venli eriÅŸim gereken genel durumlar iÃ§in daha kolay bir ÅŸekilde kurulabilir.

## Azure Front Door (AFD) & AFD WAF

**Azure Front Door**, **kÃ¼resel web uygulamalarÄ±nÄ±zÄ±n hÄ±zlÄ± teslimatÄ±** iÃ§in Ã¶lÃ§eklenebilir ve gÃ¼venli bir giriÅŸ noktasÄ±dÄ±r. **KÃ¼resel yÃ¼k dengeleme, site hÄ±zlandÄ±rma, SSL yÃ¼k dengelemesi ve Web Uygulama GÃ¼venlik DuvarÄ± (WAF)** yetenekleri gibi Ã§eÅŸitli hizmetleri tek bir hizmette **birleÅŸtirir**. Azure Front Door, **kullanÄ±cÄ±ya en yakÄ±n kenar konumuna** dayalÄ± akÄ±llÄ± yÃ¶nlendirme saÄŸlar, bÃ¶ylece optimal performans ve gÃ¼venilirlik sunar. AyrÄ±ca, URL tabanlÄ± yÃ¶nlendirme, Ã§oklu site barÄ±ndÄ±rma, oturum baÄŸlÄ±lÄ±ÄŸÄ± ve uygulama katmanÄ± gÃ¼venliÄŸi sunar.

**Azure Front Door WAF**, **web tabanlÄ± saldÄ±rÄ±lardan web uygulamalarÄ±nÄ± korumak** iÃ§in tasarlanmÄ±ÅŸtÄ±r ve arka uÃ§ kodunda deÄŸiÅŸiklik gerektirmez. SQL enjeksiyonu, Ã§apraz site betikleme ve diÄŸer yaygÄ±n saldÄ±rÄ±lar gibi tehditlere karÅŸÄ± korumak iÃ§in Ã¶zel kurallar ve yÃ¶netilen kural setleri iÃ§erir.

### **Ã–rnek**

* DÃ¼nyanÄ±n dÃ¶rt bir yanÄ±nda kullanÄ±cÄ±larÄ± olan kÃ¼resel bir daÄŸÄ±tÄ±m uygulamanÄ±z olduÄŸunu hayal edin. Azure Front Door'u kullanarak **kullanÄ±cÄ± isteklerini uygulamanÄ±zÄ± barÄ±ndÄ±ran en yakÄ±n bÃ¶lgesel veri merkezine yÃ¶nlendirebilirsiniz**, bÃ¶ylece gecikmeyi azaltÄ±r, kullanÄ±cÄ± deneyimini iyileÅŸtirir ve **WAF yetenekleri ile web saldÄ±rÄ±larÄ±na karÅŸÄ± savunursunuz**. Belirli bir bÃ¶lge kesintiye uÄŸrarsa, Azure Front Door otomatik olarak trafiÄŸi bir sonraki en iyi konuma yÃ¶nlendirebilir, bÃ¶ylece yÃ¼ksek kullanÄ±labilirlik saÄŸlar.

### Enumeration

{% code overflow="wrap" %}
```bash
# List Azure Front Door Instances
az network front-door list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table

# List Front Door WAF Policies
az network front-door waf-policy list --query "[].{name:name, resourceGroup:resourceGroup, location:location}" -o table
```
{% endcode %}

## Azure Uygulama GeÃ§idi ve Azure Uygulama GeÃ§idi WAF

Azure Uygulama GeÃ§idi, **web** uygulamalarÄ±nÄ±za trafik yÃ¶netmenizi saÄŸlayan bir **web trafiÄŸi yÃ¼k dengeleyici**dir. **Katman 7 yÃ¼k dengeleme, SSL sonlandÄ±rma ve web uygulama gÃ¼venlik duvarÄ± (WAF) yetenekleri** sunar. Ana Ã¶zellikler arasÄ±nda URL tabanlÄ± yÃ¶nlendirme, Ã§erez tabanlÄ± oturum baÄŸlÄ±lÄ±ÄŸÄ± ve gÃ¼venli soket katmanÄ± (SSL) yÃ¼k dengelemesi bulunur; bu Ã¶zellikler, kÃ¼resel yÃ¶nlendirme ve yol tabanlÄ± yÃ¶nlendirme gibi karmaÅŸÄ±k yÃ¼k dengeleme yetenekleri gerektiren uygulamalar iÃ§in kritik Ã¶neme sahiptir.

### Ã–rnek

* KullanÄ±cÄ± hesaplarÄ± ve Ã¶deme iÅŸlemleri gibi farklÄ± iÅŸlevler iÃ§in birden fazla alt alan iÃ§eren bir e-ticaret web siteniz olduÄŸunu dÃ¼ÅŸÃ¼nÃ¼n. Azure Uygulama GeÃ§idi, **URL yolu temelinde uygun web sunucularÄ±na trafiÄŸi yÃ¶nlendirebilir**. Ã–rneÄŸin, `example.com/accounts` adresine gelen trafik kullanÄ±cÄ± hesaplarÄ± hizmetine yÃ¶nlendirilebilir ve `example.com/pay` adresine gelen trafik Ã¶deme iÅŸleme hizmetine yÃ¶nlendirilebilir.\
Ve **WAF yeteneklerini kullanarak web sitenizi saldÄ±rÄ±lardan koruyun.**

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List the Web Application Firewall configurations for your Application Gateways
az network application-gateway waf-config list --gateway-name <AppGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, firewallMode:firewallMode, ruleSetType:ruleSetType, ruleSetVersion:ruleSetVersion}" -o table
```
{% endcode %}

## Azure Hub, Spoke & VNet Peering

**VNet Peering**, Azure'da **farklÄ± Sanal AÄŸlarÄ±n (VNet'lerin) doÄŸrudan ve kesintisiz bir ÅŸekilde baÄŸlanmasÄ±nÄ± saÄŸlayan** bir aÄŸ Ã¶zelliÄŸidir. VNet peering aracÄ±lÄ±ÄŸÄ±yla, bir VNet'teki kaynaklar, **sanki aynÄ± aÄŸdaymÄ±ÅŸ gibi** baÅŸka bir VNet'teki kaynaklarla Ã¶zel IP adresleri kullanarak iletiÅŸim kurabilir.\
**VNet Peering, yerel aÄŸlarla da kullanÄ±labilir**; bir site-to-site VPN veya Azure ExpressRoute kurarak.

**Azure Hub ve Spoke**, Azure'da aÄŸ trafiÄŸini yÃ¶netmek ve organize etmek iÃ§in kullanÄ±lan bir aÄŸ topolojisidir. **"Hub", farklÄ± "spokelar" arasÄ±ndaki trafiÄŸi kontrol eden ve yÃ¶nlendiren merkezi bir noktadÄ±r**. Hub genellikle aÄŸ sanal cihazlarÄ± (NVA'lar), Azure VPN Gateway, Azure Firewall veya Azure Bastion gibi paylaÅŸÄ±lan hizmetleri iÃ§erir. **"Spokelar", iÅŸ yÃ¼klerini barÄ±ndÄ±ran ve hub'a VNet peering kullanarak baÄŸlanan VNNet'lerdir**, bÃ¶ylece hub iÃ§indeki paylaÅŸÄ±lan hizmetlerden yararlanabilirler. Bu model, farklÄ± VNet'ler arasÄ±nda birden fazla iÅŸ yÃ¼kÃ¼nÃ¼n kullanabileceÄŸi ortak hizmetleri merkezileÅŸtirerek karmaÅŸÄ±klÄ±ÄŸÄ± azaltarak temiz bir aÄŸ dÃ¼zenini teÅŸvik eder.

{% hint style="danger" %}
**VNET eÅŸleÅŸtirmesi Azure'da geÃ§iÅŸken deÄŸildir**, bu da demektir ki eÄŸer spoke 1, spoke 2'ye baÄŸlÄ±ysa ve spoke 2, spoke 3'e baÄŸlÄ±ysa, spoke 1 doÄŸrudan spoke 3 ile iletiÅŸim kuramaz.
{% endhint %}

### Ã–rnekler

* SatÄ±ÅŸ, Ä°K ve GeliÅŸtirme gibi ayrÄ± departmanlara sahip bir ÅŸirketi hayal edin, **her birinin kendi VNet'i (spokelar)** vardÄ±r. Bu VNNet'ler, **bir merkezi veritabanÄ±, bir gÃ¼venlik duvarÄ± ve bir internet geÃ§idi gibi paylaÅŸÄ±lan kaynaklara eriÅŸim gerektirir**, bunlarÄ±n hepsi **baÅŸka bir VNet'te (hub)** bulunmaktadÄ±r. Hub ve Spoke modelini kullanarak, her departman **bu paylaÅŸÄ±lan kaynaklara hub VNet aracÄ±lÄ±ÄŸÄ±yla gÃ¼venli bir ÅŸekilde baÄŸlanabilir ve bu kaynaklarÄ± kamu internetine aÃ§madan** veya Ã§ok sayÄ±da baÄŸlantÄ± ile karmaÅŸÄ±k bir aÄŸ yapÄ±sÄ± oluÅŸturmadan eriÅŸebilir.

### Enumeration

{% code overflow="wrap" %}
```bash
# List all VNets in your subscription
az network vnet list --query "[].{name:name, location:location, addressSpace:addressSpace}" -o table

# List VNet peering connections for a given VNet
az network vnet peering list --resource-group <ResourceGroupName> --vnet-name <VNetName> --query "[].{name:name, peeringState:peeringState, remoteVnetId:remoteVnetId}" -o table

# List Shared Resources (e.g., Azure Firewall) in the Hub
az network firewall list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table
```
{% endcode %}

## Site-to-Site VPN

Azure'daki Site-to-Site VPN, **yerel aÄŸÄ±nÄ±zÄ± Azure Sanal AÄŸÄ± (VNet) ile baÄŸlamanÄ±za** olanak tanÄ±r ve Azure iÃ§indeki VM'ler gibi kaynaklarÄ±n yerel aÄŸÄ±nÄ±zda varmÄ±ÅŸ gibi gÃ¶rÃ¼nmesini saÄŸlar. Bu baÄŸlantÄ±, iki aÄŸ arasÄ±ndaki trafiÄŸi **ÅŸifreleyen bir VPN geÃ§idi aracÄ±lÄ±ÄŸÄ±yla** kurulur.

### **Ã–rnek**

* New York'ta ana ofisi bulunan bir iÅŸletmenin, Azure'daki VNet'ine gÃ¼venli bir ÅŸekilde baÄŸlanmasÄ± gereken yerel bir veri merkezi vardÄ±r. **Site-to-Site VPN kurarak, ÅŸirket yerel sunucular ile Azure VM'leri arasÄ±nda ÅŸifreli bir baÄŸlantÄ± saÄŸlayabilir**, bÃ¶ylece kaynaklara her iki ortamda da sanki aynÄ± yerel aÄŸdaymÄ±ÅŸ gibi gÃ¼venli bir ÅŸekilde eriÅŸilebilir.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List VPN Gateways
az network vnet-gateway list --query "[].{name:name, location:location, resourceGroup:resourceGroup}" -o table

# List VPN Connections
az network vpn-connection list --gateway-name <VpnGatewayName> --resource-group <ResourceGroupName> --query "[].{name:name, connectionType:connectionType, connectionStatus:connectionStatus}" -o table
```
{% endcode %}

## Azure ExpressRoute

Azure ExpressRoute, **yerel altyapÄ±nÄ±z ile Azure veri merkezleri arasÄ±nda Ã¶zel, ayrÄ±lmÄ±ÅŸ, yÃ¼ksek hÄ±zlÄ± bir baÄŸlantÄ± saÄŸlayan bir hizmettir**. Bu baÄŸlantÄ±, kamu internetini atlayarak bir baÄŸlantÄ± saÄŸlayÄ±cÄ±sÄ± aracÄ±lÄ±ÄŸÄ±yla yapÄ±lÄ±r ve tipik internet baÄŸlantÄ±larÄ±ndan daha fazla gÃ¼venilirlik, daha hÄ±zlÄ± hÄ±zlar, daha dÃ¼ÅŸÃ¼k gecikmeler ve daha yÃ¼ksek gÃ¼venlik sunar.

### **Ã–rnek**

* Bir Ã§ok uluslu ÅŸirket, **yÃ¼ksek veri hacmi ve yÃ¼ksek veri akÄ±ÅŸÄ± ihtiyacÄ± nedeniyle Azure hizmetlerine tutarlÄ± ve gÃ¼venilir bir baÄŸlantÄ± gerektirir**. Åirket, yerel veri merkezini doÄŸrudan Azure'a baÄŸlamak iÃ§in Azure ExpressRoute'u tercih eder, bÃ¶ylece gÃ¼nlÃ¼k yedeklemeler ve gerÃ§ek zamanlÄ± veri analitiÄŸi gibi bÃ¼yÃ¼k Ã¶lÃ§ekli veri transferlerini artÄ±rÄ±lmÄ±ÅŸ gizlilik ve hÄ±z ile kolaylaÅŸtÄ±rÄ±r.

### **Enumeration**

{% code overflow="wrap" %}
```bash
# List ExpressRoute Circuits
az network express-route list --query "[].{name:name, location:location, resourceGroup:resourceGroup, serviceProviderName:serviceProviderName, peeringLocation:peeringLocation}" -o table
```
{% endcode %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
