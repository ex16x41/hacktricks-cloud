# Az - Blob Storage

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

[‡§°‡•â‡§ï‡•ç‡§∏ ‡§∏‡•á:](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-overview) Azure Blob storage Microsoft ‡§ï‡§æ object **storage solution for the cloud** ‡§π‡•à‡•§ Blob storage ‡§ï‡•ã massive amounts of unstructured data ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è optimized ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ Unstructured data ‡§µ‡§π ‡§°‡•á‡§ü‡§æ ‡§π‡•à ‡§ú‡•ã ‡§ï‡§ø‡§∏‡•Ä ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§°‡•á‡§ü‡§æ ‡§Æ‡•â‡§°‡§≤ ‡§Ø‡§æ ‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§æ ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ, ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§Ø‡§æ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§°‡•á‡§ü‡§æ‡•§

Blob storage ‡§§‡•Ä‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à:

* **storage account** (‡§Ö‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø ‡§®‡§æ‡§Æ)
* storage account ‡§Æ‡•á‡§Ç ‡§è‡§ï **container** (‡§´‡•ã‡§≤‡•ç‡§°‡§∞)
* ‡§è‡§ï container ‡§Æ‡•á‡§Ç ‡§è‡§ï **blob**

<figure><img src="../../../.gitbook/assets/image (114).png" alt=""><figcaption></figcaption></figure>

### ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á storage

| **Blob storage**                 | <p><code>https://&#x3C;storage-account>.blob.core.windows.net</code><br><br><code>https://&#x3C;stg-acc>.blob.core.windows.net/&#x3C;container-name>?restype=container&#x26;comp=list</code></p> |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Azure Data Lake Storage Gen2** | `https://<storage-account>.dfs.core.windows.net`                                                                                                                                                 |
| **Azure Files**                  | `https://<storage-account>.file.core.windows.net`                                                                                                                                                |
| **Queue storage**                | `https://<storage-account>.queue.core.windows.net`                                                                                                                                               |
| **Table storage**                | `https://<storage-account>.table.core.windows.net`                                                                                                                                               |

### Storage ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö <a href="#about-blob-storage" id="about-blob-storage"></a>

* Azure AD principals ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç **RBAC roles** ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§‡•§
* **Access Keys**: storage account ‡§ï‡•Ä access keys ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ø‡§π storage account ‡§§‡§ï **‡§™‡•Ç‡§∞‡•ç‡§£ ‡§™‡§π‡•Å‡§Ç‡§ö** ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
* **Shared Access Signature** (SAS): **‡§∏‡§Æ‡§Ø** **‡§∏‡•Ä‡§Æ‡§ø‡§§** ‡§î‡§∞ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡§æ‡§Å‡•§
* ‡§Ü‡§™ ‡§è‡§ï SAS url ‡§è‡§ï **access key** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç (‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§ü‡§ø‡§≤)‡•§
* ‡§ö‡•Ç‡§Ç‡§ï‡§ø SAS access key ‡§∏‡•á ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§Ø‡§¶‡§ø ‡§á‡§∏‡•á ‡§®‡§µ‡•Ä‡§®‡•Ä‡§ï‡•É‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡•ã SAS ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡§æ ‡§¨‡§Ç‡§¶ ‡§ï‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§

### Public Exposure

‡§Ø‡§¶‡§ø "Allow Blob public access" **‡§∏‡§ï‡•ç‡§∑‡§Æ** ‡§π‡•à (‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ö‡§ï‡•ç‡§∑‡§Æ), ‡§§‡•ã ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:

* **public access to read blobs** ‡§¶‡•á‡§Ç (‡§Ü‡§™‡§ï‡•ã ‡§®‡§æ‡§Æ ‡§ú‡§æ‡§®‡§®‡§æ ‡§π‡•ã‡§ó‡§æ)‡•§
* **List container blobs** ‡§î‡§∞ **‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§™‡§¢‡§º‡•á‡§Ç**‡•§

### Storage ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç

‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•ã ‡§ï‡•ã‡§à **storage** ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à ‡§ú‡§ø‡§∏‡§∏‡•á ‡§Ü‡§™ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§Ü‡§™ ‡§ê‡§∏‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è [**Microsoft Azure Storage Explorer**](https://azure.microsoft.com/es-es/products/storage/storage-explorer/) ‡§ü‡•Ç‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

## SAS URLs

[‡§°‡•â‡§ï‡•ç‡§∏ ‡§∏‡•á:](https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview) ‡§è‡§ï shared access signature (SAS) ‡§Ü‡§™‡§ï‡•á storage account ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§§‡§ï ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø ‡§™‡§π‡•Å‡§Ç‡§ö ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§è‡§ï SAS ‡§ï‡•á ‡§∏‡§æ‡§•, ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§Ø‡§π ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§∏‡•Ç‡§ï‡•ç‡§∑‡•ç‡§Æ‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§è‡§ï ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§Ü‡§™‡§ï‡•á ‡§°‡•á‡§ü‡§æ ‡§§‡§ï ‡§ï‡•à‡§∏‡•á ‡§™‡§π‡•Å‡§Ç‡§ö ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è:

* ‡§ï‡•å‡§® ‡§∏‡•á ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§§‡§ï ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§™‡§π‡•Å‡§Ç‡§ö ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§
* ‡§â‡§® ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§®‡§ï‡•á ‡§™‡§æ‡§∏ ‡§ï‡•ç‡§Ø‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡§æ‡§Å ‡§π‡•à‡§Ç‡•§
* SAS ‡§ï‡§ø‡§§‡§®‡•á ‡§∏‡§Æ‡§Ø ‡§§‡§ï ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à‡•§

‡§è‡§ï SAS URL ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§¶‡§ø‡§ñ‡§§‡§æ ‡§π‡•à: **`https://<container_name>.blob.core.windows.net/newcontainer?sp=r&st=2021-09-26T18:15:21Z&se=2021-10-27T02:14:21Z&spr=https&sv=2021-07-08&sr=c&sig=7S%2BZySOgy4aA3Dk0V1cJyTSIf1cW%2Fu3WFkhHV32%2B4PE%3D`**

‡§°‡•á‡§ü‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è [**Storage Explorer**](https://azure.microsoft.com/en-us/features/storage-explorer/) ‡§Ø‡§æ python ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç:

{% code overflow="wrap" %}
```python
#pip3 install azure-storage-blob
from azure.storage.blob import BlobServiceClient

# List containers
conn_str="<SAS URL>"
svc = BlobServiceClient.from_connection_string(conn_str=conn_str)
for c in svc.list_containers():
print(c['name'])

# List blobs inside the containers
container = svc.get_container_client(container=c['name'])

for b in container.list_blobs():
print(b['name'])


# Download all the blobs
blob_name = b['name'].split("/")[::-1][0]
blob = svc.get_blob_client(container=c['name'],blob=b['name'])
with open(blob_name,"wb") as f:
f.write(blob.download_blob().readall())
```
{% endcode %}

### User delegation SAS <a href="#user-delegation-sas" id="user-delegation-sas"></a>

‡§Ü‡§™ ‡§è‡§ï ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞, ‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü‡§∞‡•Ä, ‡§Ø‡§æ ‡§¨‡•ç‡§≤‡•â‡§¨ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•á ‡§≤‡§ø‡§è **‡§∏‡§æ‡§ù‡§æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§∏‡§ø‡§ó‡•ç‡§®‡•á‡§ö‡§∞ (SAS)** ‡§ü‡•ã‡§ï‡§® ‡§ï‡•ã Azure Active Directory (Azure AD) **‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§Ø‡§æ ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü ‡§ï‡•Ä** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§è‡§ï ‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§∂‡§® SAS ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™‡§ï‡•ã ‡§™‡§π‡§≤‡•á ‡§è‡§ï **‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§∂‡§® ‡§ï‡•Ä** ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ, ‡§ú‡§ø‡§∏‡•á ‡§Ü‡§™ ‡§´‡§ø‡§∞ SAS ‡§™‡§∞ ‡§π‡§∏‡•ç‡§§‡§æ‡§ï‡•ç‡§∑‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§

**‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§∂‡§® ‡§∏‡§æ‡§ù‡§æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§∏‡§ø‡§ó‡•ç‡§®‡•á‡§ö‡§∞ (SAS)** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® **Azure Blob Storage** ‡§î‡§∞ **Azure Data Lake Storage Gen2** ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§Ø‡§π ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à ‡§ï‡§ø **‡§∏‡•ç‡§ü‡•ã‡§∞‡•ç‡§° ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§™‡•â‡§≤‡§ø‡§∏‡•Ä‡§ú** ‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§∂‡§® SAS ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Ç‡§ó‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç‡•§

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§∂‡§® SAS **‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü ‡§ï‡•Ä‡§ú ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø Azure AD ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§** ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü‡•ç‡§∏/‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§Ç‡§∏ ‡§ï‡•ã SAS ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§ï‡•Ä‡§ú ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•ã‡§∞/‡§∞‡§ø‡§ü‡•ç‡§∞‡•Ä‡§µ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§∞‡•ã‡§ï‡§§‡§æ ‡§π‡•à‡•§

### Service SAS

‡§è‡§ï ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ SAS **‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü ‡§ï‡•Ä** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•à‡•§ ‡§è‡§ï ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ SAS **Azure Storage ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï** ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à: Blob storage, Queue storage, Table storage, ‡§Ø‡§æ Azure Files‡•§ ‡§è‡§ï ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏-‡§≤‡•á‡§µ‡§≤ SAS ‡§ï‡•á ‡§≤‡§ø‡§è URI ‡§â‡§∏ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§ï‡•á URI ‡§∏‡•á ‡§¨‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡•á ‡§≤‡§ø‡§è SAS ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ, ‡§á‡§∏‡§ï‡•á ‡§¨‡§æ‡§¶ SAS ‡§ü‡•ã‡§ï‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§

Azure Active Directory (Azure AD) ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï **‡§ï‡§Ç‡§ü‡•á‡§®‡§∞** ‡§Ø‡§æ **‡§¨‡•ç‡§≤‡•â‡§¨** ‡§ï‡•á ‡§≤‡§ø‡§è SAS ‡§ï‡•ã ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§è‡§ï **‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§∂‡§® SAS** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§

### Account SAS

‡§è‡§ï ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü SAS ‡§¶‡•ã ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§è‡§ï **‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü ‡§ï‡•Ä‡§ú** (2 ‡§π‡•à‡§Ç) ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•à‡•§ ‡§è‡§ï ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü SAS ‡§è‡§ï ‡§Ø‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§è‡§ï ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ ‡§Ø‡§æ ‡§Ø‡•Ç‡§ú‡§∞ ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§∂‡§® SAS ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§∏‡§≠‡•Ä ‡§ë‡§™‡§∞‡•á‡§∂‡§Ç‡§∏ ‡§è‡§ï ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü SAS ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≠‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à‡§Ç‡•§

[‡§°‡•â‡§ï‡•ç‡§∏ ‡§∏‡•á:](https://learn.microsoft.com/en-us/rest/api/storageservices/create-account-sas) ‡§è‡§ï ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü SAS ‡§¨‡§®‡§æ‡§ï‡§∞, ‡§Ü‡§™:

* ‡§â‡§® ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏-‡§≤‡•á‡§µ‡§≤ ‡§ë‡§™‡§∞‡•á‡§∂‡§Ç‡§∏ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏-‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü SAS ‡§ï‡•á ‡§∏‡§æ‡§• ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç, ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø `Get/Set Service Properties` ‡§î‡§∞ `Get Service Stats` ‡§ë‡§™‡§∞‡•á‡§∂‡§Ç‡§∏‡•§
* ‡§è‡§ï ‡§∏‡§Æ‡§Ø ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡•á‡§µ‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ ‡§è‡§ï ‡§è‡§ï‡§æ‡§â‡§Ç‡§ü SAS ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á Azure Blob Storage ‡§î‡§∞ Azure Files ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§®‡•ã‡§Ç ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
* ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞‡•ç‡§∏, ‡§ï‡•ç‡§µ‡•Ä‡§ú‡§º, ‡§ü‡•á‡§¨‡§≤‡•ç‡§∏, ‡§î‡§∞ ‡§´‡§æ‡§á‡§≤ ‡§∂‡•á‡§Ø‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡§ø‡§ñ‡§®‡•á ‡§î‡§∞ ‡§π‡§ü‡§æ‡§®‡•á ‡§ï‡•á ‡§ë‡§™‡§∞‡•á‡§∂‡§Ç‡§∏ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•ã ‡§°‡•á‡§≤‡•Ä‡§ó‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§è‡§ï ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü-‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü SAS ‡§ï‡•á ‡§∏‡§æ‡§• ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç‡•§
* ‡§è‡§ï IP ‡§™‡§§‡§æ ‡§Ø‡§æ IP ‡§™‡§§‡•ã‡§Ç ‡§ï‡•Ä ‡§è‡§ï ‡§∞‡•á‡§Ç‡§ú ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§∏‡§∏‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á‡•§
* HTTP ‡§™‡•ç‡§∞‡•ã‡§ü‡•ã‡§ï‡•â‡§≤ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§∏‡§∏‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á (‡§Ø‡§æ ‡§§‡•ã HTTPS ‡§Ø‡§æ HTTP/HTTPS)‡•§

## Enumeration

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# Get storage accounts
az storage account list #Get the account name from here

# Get keys to authenticate
az storage account keys list --account-name <name>

# Get shares
az storage share list --account-name <name> --account-key <key>

# Get dirs/files inside the share
az storage file list --account-name <name> --share-name <share-name> --account-key <key>
## If type is "dir", you can continue enumerationg files inside of it
az storage file list --account-name <name> --share-name <prev_dir/share-name> --account-key <key>

# Download a complete share (with directories and files inside of them)
az storage file download-batch -d . --source <share-name> --account-name <name> --account-key <key>
```
{% endcode %}
{% endtab %}

{% tab title="Az PowerShell" %}
{% code overflow="wrap" %}
```powershell
# Get storage accounts
Get-AzStorageAccount | fl
# Get rules to access the storage account
Get-AzStorageAccount | select -ExpandProperty NetworkRuleSet
# Get IPs
(Get-AzStorageAccount | select -ExpandProperty NetworkRuleSet).IPRules
# Get containers of a storage account
Get-AzStorageContainer -Context (Get-AzStorageAccount -name <NAME> -ResourceGroupName <NAME>).context
# Get blobs inside container
Get-AzStorageBlob -Container epbackup-planetary -Context (Get-AzStorageAccount -name <name> -ResourceGroupName <name>).context
# Get a blob from a container
Get-AzStorageBlobContent -Container <NAME> -Context (Get-AzStorageAccount -name <NAME> -ResourceGroupName <NAME>).context -Blob <blob_name> -Destination .\Desktop\filename.txt
```
{% endcode %}
{% endtab %}
{% endtabs %}

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction)
* [https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview](https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview)

{% hint style="success" %}
AWS Hacking ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡•ã ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§¶‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§ì‡§Ç**](https://github.com/sponsors/carlospolop) ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö ‡§ï‡§∞‡•á‡§Ç!
* **üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**telegram ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **Twitter** üê¶ ‡§™‡§∞ **‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç‡•§

</details>
{% endhint %}
