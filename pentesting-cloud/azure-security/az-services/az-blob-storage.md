# Az - Blob Storage

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

[–ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó:](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-overview) Azure Blob storage - —Ü–µ –æ–±'—î–∫—Ç–Ω–µ **—Å—Ö–æ–≤–∏—â–µ Microsoft –¥–ª—è —Ö–º–∞—Ä–∏**. Blob storage –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤–µ–ª–∏—á–µ–∑–Ω–∏—Ö –æ–±—Å—è–≥—ñ–≤ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –ù–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ - —Ü–µ –¥–∞–Ω—ñ, —è–∫—ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –ø–µ–≤–Ω—ñ–π –º–æ–¥–µ–ª—ñ –∞–±–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—é –¥–∞–Ω–∏—Ö, —Ç–∞–∫—ñ —è–∫ —Ç–µ–∫—Å—Ç –∞–±–æ –±—ñ–Ω–∞—Ä–Ω—ñ –¥–∞–Ω—ñ.

Blob storage –ø—Ä–æ–ø–æ–Ω—É—î —Ç—Ä–∏ —Ç–∏–ø–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤:

* **–æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —Å—Ö–æ–≤–∏—â–∞** (—É–Ω—ñ–∫–∞–ª—å–Ω–∞ –Ω–∞–∑–≤–∞)
* **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ —Å—Ö–æ–≤–∏—â–∞ (–ø–∞–ø–∫–∞)
* **blob** –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ

<figure><img src="../../../.gitbook/assets/image (114).png" alt=""><figcaption></figcaption></figure>

### Different types of storage

| **Blob storage**                 | <p><code>https://&#x3C;storage-account>.blob.core.windows.net</code><br><br><code>https://&#x3C;stg-acc>.blob.core.windows.net/&#x3C;container-name>?restype=container&#x26;comp=list</code></p> |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Azure Data Lake Storage Gen2** | `https://<storage-account>.dfs.core.windows.net`                                                                                                                                                 |
| **Azure Files**                  | `https://<storage-account>.file.core.windows.net`                                                                                                                                                |
| **Queue storage**                | `https://<storage-account>.queue.core.windows.net`                                                                                                                                               |
| **Table storage**                | `https://<storage-account>.table.core.windows.net`                                                                                                                                               |

### Access to Storage <a href="#about-blob-storage" id="about-blob-storage"></a>

* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏ Azure AD —á–µ—Ä–µ–∑ **RBAC —Ä–æ–ª—ñ**.
* **–ö–ª—é—á—ñ –¥–æ—Å—Ç—É–ø—É**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–ª—é—á—ñ –¥–æ—Å—Ç—É–ø—É –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Å—Ö–æ–≤–∏—â–∞. –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î **–ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Å—Ö–æ–≤–∏—â–∞.**
* **–°–ø—ñ–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –ø—ñ–¥–ø–∏—Å—É** (SAS): **–û–±–º–µ–∂–µ–Ω–∏–π –∑–∞ —á–∞—Å–æ–º** —Ç–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–æ–∑–≤–æ–ª–∏.
* –í–∏ –º–æ–∂–µ—Ç–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ SAS URL –∑ **–∫–ª—é—á–µ–º –¥–æ—Å—Ç—É–ø—É** (—Å–∫–ª–∞–¥–Ω—ñ—à–µ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è).
* –û—Å–∫—ñ–ª—å–∫–∏ SAS –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∑ –∫–ª—é—á–∞ –¥–æ—Å—Ç—É–ø—É, —è–∫—â–æ –≤—ñ–Ω –±—É–¥–µ –æ–Ω–æ–≤–ª–µ–Ω–∏–π, SAS –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏.

### Public Exposure

–Ø–∫—â–æ "–î–æ–∑–≤–æ–ª–∏—Ç–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ blob" **—É–≤—ñ–º–∫–Ω–µ–Ω–æ** (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–º–∫–Ω–µ–Ω–æ), –º–æ–∂–ª–∏–≤–æ:

* –ù–∞–¥–∞—Ç–∏ **–ø—É–±–ª—ñ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è blob** (–Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–Ω–∞—Ç–∏ –Ω–∞–∑–≤—É).
* **–ü–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ blob –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** —Ç–∞ **—á–∏—Ç–∞—Ç–∏** —ó—Ö.

### Connect to Storage

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –±—É–¥—å-—è–∫–µ **—Å—Ö–æ–≤–∏—â–µ**, –¥–æ —è–∫–æ–≥–æ –º–æ–∂–µ—Ç–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**Microsoft Azure Storage Explorer**](https://azure.microsoft.com/es-es/products/storage/storage-explorer/) –¥–ª—è —Ü—å–æ–≥–æ.

## SAS URLs

[–ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó:](https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview) –°–ø—ñ–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –ø—ñ–¥–ø–∏—Å—É (SAS) –∑–∞–±–µ–∑–ø–µ—á—É—î –±–µ–∑–ø–µ—á–Ω–∏–π –¥–µ–ª–µ–≥–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ —É –≤–∞—à–æ–º—É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ —Å—Ö–æ–≤–∏—â–∞. –ó SAS –≤–∏ –º–∞—î—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ç–∏–º, —è–∫ –∫–ª—ñ—î–Ω—Ç –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:

* –Ø–∫—ñ —Ä–µ—Å—É—Ä—Å–∏ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—ñ—î–Ω—Ç.
* –Ø–∫—ñ –¥–æ–∑–≤–æ–ª–∏ –≤–æ–Ω–∏ –º–∞—é—Ç—å –Ω–∞ —Ü—ñ —Ä–µ—Å—É—Ä—Å–∏.
* –Ø–∫ –¥–æ–≤–≥–æ SAS —î –¥—ñ–π—Å–Ω–∏–º.

SAS URL –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫: **`https://<container_name>.blob.core.windows.net/newcontainer?sp=r&st=2021-09-26T18:15:21Z&se=2021-10-27T02:14:21Z&spr=https&sv=2021-07-08&sr=c&sig=7S%2BZySOgy4aA3Dk0V1cJyTSIf1cW%2Fu3WFkhHV32%2B4PE%3D`**

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**Storage Explorer**](https://azure.microsoft.com/en-us/features/storage-explorer/) –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö –∞–±–æ python:

{% code overflow="wrap" %}
```python
#pip3 install azure-storage-blob
from azure.storage.blob import BlobServiceClient

# List containers
conn_str="<SAS URL>"
svc = BlobServiceClient.from_connection_string(conn_str=conn_str)
for c in svc.list_containers():
print(c['name'])

# List blobs inside the containers
container = svc.get_container_client(container=c['name'])

for b in container.list_blobs():
print(b['name'])


# Download all the blobs
blob_name = b['name'].split("/")[::-1][0]
blob = svc.get_blob_client(container=c['name'],blob=b['name'])
with open(blob_name,"wb") as f:
f.write(blob.download_blob().readall())
```
{% endcode %}

### User delegation SAS <a href="#user-delegation-sas" id="user-delegation-sas"></a>

–í–∏ –º–æ–∂–µ—Ç–µ **–∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ —Ç–æ–∫–µ–Ω —Å–ø—ñ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É (SAS)** –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∫–∞—Ç–∞–ª–æ–≥—É –∞–±–æ –±–ª–æ–±—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∞–±–æ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ Azure Active Directory (Azure AD), –∞–±–æ –∫–ª—é—á –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É. –©–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ SAS –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Å–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø–∏—Ç–∞—Ç–∏ **–∫–ª—é—á –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —è–∫–∏–π –≤–∏ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –¥–ª—è –ø—ñ–¥–ø–∏—Å–∞–Ω–Ω—è SAS.

–ü—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è **SAS —Å–ø—ñ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (SAS)** —è–∫ –≤ **Azure Blob Storage**, —Ç–∞–∫ —ñ –≤ **Azure Data Lake Storage Gen2**. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ **–ó–±–µ—Ä–µ–∂–µ–Ω—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø—É** –Ω–µ —Å—É–º—ñ—Å–Ω—ñ –∑ SAS –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ SAS –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **–∑–∞–±–µ–∑–ø–µ—á—É—î—Ç—å—Å—è –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏ Azure AD –∑–∞–º—ñ—Å—Ç—å –∫–ª—é—á—ñ–≤ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è**. –¶–µ –∑–∞–ø–æ–±—ñ–≥–∞—î –∫–ª—ñ—î–Ω—Ç–∞–º/–¥–æ–¥–∞—Ç–∫–∞–º –∑–±–µ—Ä—ñ–≥–∞—Ç–∏/–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è SAS.

### Service SAS

SAS —Å–µ—Ä–≤—ñ—Å—É –∑–∞–±–µ–∑–ø–µ—á—É—î—Ç—å—Å—è **–∫–ª—é—á–µ–º –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è**. SAS —Å–µ—Ä–≤—ñ—Å—É **–¥–µ–ª–µ–≥—É—î –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—É –ª–∏—à–µ –≤ –æ–¥–Ω–æ–º—É** –∑ —Å–µ—Ä–≤—ñ—Å—ñ–≤ Azure Storage: Blob storage, Queue storage, Table storage –∞–±–æ Azure Files. URI –¥–ª—è SAS –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å–µ—Ä–≤—ñ—Å—É —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ URI –¥–æ —Ä–µ—Å—É—Ä—Å—É, –¥–ª—è —è–∫–æ–≥–æ SAS –¥–µ–ª–µ–≥—É–≤–∞—Ç–∏–º–µ –¥–æ—Å—Ç—É–ø, –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î —Ç–æ–∫–µ–Ω SAS.

–©–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ Azure Active Directory (Azure AD) –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è SAS –¥–ª—è **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** –∞–±–æ **–±–ª–æ–±—É**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **SAS –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**.

### Account SAS

SAS –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∑–∞–±–µ–∑–ø–µ—á—É—î—Ç—å—Å—è –æ–¥–Ω–∏–º –∑ **–∫–ª—é—á—ñ–≤ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è** (—ó—Ö —î 2). SAS –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –¥–µ–ª–µ–≥—É—î –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –≤ –æ–¥–Ω–æ–º—É –∞–±–æ –∫—ñ–ª—å–∫–æ—Ö —Å–µ—Ä–≤—ñ—Å–∞—Ö –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è. –£—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ SAS —Å–µ—Ä–≤—ñ—Å—É –∞–±–æ SAS –¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–∞–∫–æ–∂ –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ SAS –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É.

[–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó:](https://learn.microsoft.com/en-us/rest/api/storageservices/create-account-sas) –°—Ç–≤–æ—Ä–∏–≤—à–∏ SAS –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É, –≤–∏ –º–æ–∂–µ—Ç–µ:

* –î–µ–ª–µ–≥—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–ø–µ—Ä–∞—Ü—ñ–π –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å–µ—Ä–≤—ñ—Å—É, —è–∫—ñ –Ω–∞—Ä–∞–∑—ñ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ –∑ SAS, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–≥–æ –¥–ª—è —Å–µ—Ä–≤—ñ—Å—É, —Ç–∞–∫–∏—Ö —è–∫ –æ–ø–µ—Ä–∞—Ü—ñ—ó `Get/Set Service Properties` —Ç–∞ `Get Service Stats`.
* –î–µ–ª–µ–≥—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –±—ñ–ª—å—à –Ω—ñ–∂ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –æ–¥–Ω–æ—á–∞—Å–Ω–æ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏ –º–æ–∂–µ—Ç–µ –¥–µ–ª–µ–≥—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ —è–∫ –≤ Azure Blob Storage, —Ç–∞–∫ —ñ –≤ Azure Files, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ SAS –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É.
* –î–µ–ª–µ–≥—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–ø–µ—Ä–∞—Ü—ñ–π –∑–∞–ø–∏—Å—É —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤, —á–µ—Ä–≥, —Ç–∞–±–ª–∏—Ü—å —Ç–∞ –∑–∞–≥–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, —è–∫—ñ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ –∑ SAS, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–≥–æ –¥–ª—è –æ–±'—î–∫—Ç–∞.
* –í–∫–∞–∑–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω IP-–∞–¥—Ä–µ—Å, –∑ —è–∫–∏—Ö –ø—Ä–∏–π–º–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏.
* –í–∫–∞–∑–∞—Ç–∏ HTTP-–ø—Ä–æ—Ç–æ–∫–æ–ª, –∑ —è–∫–æ–≥–æ –ø—Ä–∏–π–º–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ (–∞–±–æ HTTPS, –∞–±–æ HTTP/HTTPS).

## Enumeration

{% tabs %}
{% tab title="az cli" %}
{% code overflow="wrap" %}
```bash
# Get storage accounts
az storage account list #Get the account name from here

# Get keys to authenticate
az storage account keys list --account-name <name>

# Get shares
az storage share list --account-name <name> --account-key <key>

# Get dirs/files inside the share
az storage file list --account-name <name> --share-name <share-name> --account-key <key>
## If type is "dir", you can continue enumerationg files inside of it
az storage file list --account-name <name> --share-name <prev_dir/share-name> --account-key <key>

# Download a complete share (with directories and files inside of them)
az storage file download-batch -d . --source <share-name> --account-name <name> --account-key <key>
```
{% endcode %}
{% endtab %}

{% tab title="Az PowerShell" %}
{% code overflow="wrap" %}
```powershell
# Get storage accounts
Get-AzStorageAccount | fl
# Get rules to access the storage account
Get-AzStorageAccount | select -ExpandProperty NetworkRuleSet
# Get IPs
(Get-AzStorageAccount | select -ExpandProperty NetworkRuleSet).IPRules
# Get containers of a storage account
Get-AzStorageContainer -Context (Get-AzStorageAccount -name <NAME> -ResourceGroupName <NAME>).context
# Get blobs inside container
Get-AzStorageBlob -Container epbackup-planetary -Context (Get-AzStorageAccount -name <name> -ResourceGroupName <name>).context
# Get a blob from a container
Get-AzStorageBlobContent -Container <NAME> -Context (Get-AzStorageAccount -name <NAME> -ResourceGroupName <NAME>).context -Blob <blob_name> -Destination .\Desktop\filename.txt
```
{% endcode %}
{% endtab %}
{% endtabs %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction)
* [https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview](https://learn.microsoft.com/en-us/azure/storage/common/storage-sas-overview)

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
