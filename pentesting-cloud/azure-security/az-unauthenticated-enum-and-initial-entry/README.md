# Az - ì¸ì¦ë˜ì§€ ì•Šì€ Enum ë° ì´ˆê¸° ì§„ì…

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ë ˆí¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}

## Azure í…Œë„ŒíŠ¸

### í…Œë„ŒíŠ¸ ì—´ê±°

**í…Œë„ŒíŠ¸ì˜ ë„ë©”ì¸**ì„ ì•Œê³  ìˆëŠ” ê³µê²©ìëŠ” **ì¼ë¶€ ê³µê°œ Azure API**ë¥¼ ì¿¼ë¦¬í•˜ì—¬ í•´ë‹¹ í…Œë„ŒíŠ¸ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
APIë¥¼ ì§ì ‘ ì¿¼ë¦¬í•˜ê±°ë‚˜ PowerShell ë¼ì´ë¸ŒëŸ¬ë¦¬ [**AADInternals**](https://github.com/Gerenios)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

| API                                                                  | ì •ë³´                                                                                                                                                                                                                                                | AADInternals í•¨ìˆ˜                             |
| -------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- |
| login.microsoftonline.com/\<domain>/.well-known/openid-configuration | í…Œë„ŒíŠ¸ IDë¥¼ í¬í•¨í•œ **ë¡œê·¸ì¸ ì •ë³´**                                                                                                                                                                                                                   | `Get-AADIntTenantID -Domain <domain>`             |
| autodiscover-s.outlook.com/autodiscover/autodiscover.svc             | í…Œë„ŒíŠ¸ì˜ **ëª¨ë“  ë„ë©”ì¸**                                                                                                                                                                                                                            | `Get-AADIntTenantDomains -Domain <domain>`        |
| login.microsoftonline.com/GetUserRealm.srf?login=\<UserName>         | <p>í…Œë„ŒíŠ¸ì˜ **ë¡œê·¸ì¸ ì •ë³´**, í…Œë„ŒíŠ¸ ì´ë¦„ ë° ë„ë©”ì¸ì„ í¬í•¨í•œ <strong>ì¸ì¦ ìœ í˜•</strong>.<br>If <code>NameSpaceType</code>ì´ <strong><code>Managed</code></strong>ì´ë©´ <strong>AzureAD</strong>ê°€ ì‚¬ìš©ë¨.</p> | `Get-AADIntLoginInformation -UserName <UserName>` |
| login.microsoftonline.com/common/GetCredentialType                   | **ë°ìŠ¤í¬í†± SSO ì •ë³´**ë¥¼ í¬í•¨í•œ ë¡œê·¸ì¸ ì •ë³´                                                                                                                                                                                                         | `Get-AADIntLoginInformation -UserName <UserName>` |

**AADInternals** ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ **í•œ ëª…ë ¹ì–´ë¡œ Azure í…Œë„ŒíŠ¸ì˜ ëª¨ë“  ì •ë³´ë¥¼ ì¿¼ë¦¬**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```powershell
Invoke-AADIntReconAsOutsider -DomainName corp.onmicrosoft.com | Format-Table
```
Azure í…Œë„ŒíŠ¸ ì •ë³´ì˜ ì¶œë ¥ ì˜ˆì‹œ:
```
Tenant brand:       Company Ltd
Tenant name:        company
Tenant id:          1937e3ab-38de-a735-a830-3075ea7e5b39
DesktopSSO enabled: True

Name                           DNS   MX    SPF  Type      STS
----                           ---   --    ---  ----      ---
company.com                   True  True  True  Federated sts.company.com
company.mail.onmicrosoft.com  True  True  True  Managed
company.onmicrosoft.com       True  True  True  Managed
int.company.com              False False False  Managed
```
í…Œë„ŒíŠ¸ì˜ ì´ë¦„, ID ë° "ë¸Œëœë“œ" ì´ë¦„ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´ë¥¼ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ë°ìŠ¤í¬í†± ë‹¨ì¼ ë¡œê·¸ì¸(SSO)ì˜ ìƒíƒœ, ì¼ëª… [**Seamless SSO**](https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sso)ë„ í‘œì‹œë©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ë©´ ì´ ê¸°ëŠ¥ì„ í†µí•´ íŠ¹ì • ì‚¬ìš©ìì˜ ì¡´ì¬(ì—´ê±°)ë¥¼ ëŒ€ìƒ ì¡°ì§ ë‚´ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ ì¶œë ¥ì—ëŠ” ëŒ€ìƒ í…Œë„ŒíŠ¸ì™€ ê´€ë ¨ëœ ëª¨ë“  í™•ì¸ëœ ë„ë©”ì¸ì˜ ì´ë¦„ê³¼ í•´ë‹¹ ì‹ë³„ ìœ í˜•ì´ í‘œì‹œë©ë‹ˆë‹¤. ì—°í•© ë„ë©”ì¸ì˜ ê²½ìš° ì‚¬ìš© ì¤‘ì¸ ì‹ë³„ ê³µê¸‰ìì˜ ì™„ì „í•œ ë„ë©”ì¸ ì´ë¦„(FQDN)(ì¼ë°˜ì ìœ¼ë¡œ ADFS ì„œë²„)ë„ ê³µê°œë©ë‹ˆë‹¤. "MX" ì—´ì€ ì´ë©”ì¼ì´ Exchange Onlineìœ¼ë¡œ ë¼ìš°íŒ…ë˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ì§€ì •í•˜ë©°, "SPF" ì—´ì€ Exchange Onlineì´ ì´ë©”ì¼ ë°œì‹ ìë¡œ ë‚˜ì—´ë˜ì–´ ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. í˜„ì¬ì˜ ì •ì°° ê¸°ëŠ¥ì€ SPF ë ˆì½”ë“œ ë‚´ì˜ "include" ë¬¸ì„ êµ¬ë¬¸ ë¶„ì„í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì˜ëª»ëœ ë¶€ì •ì  ê²°ê³¼ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

### ì‚¬ìš©ì ì—´ê±°

í…Œë„ŒíŠ¸ ë‚´ì—ì„œ **ì‚¬ìš©ì ì´ë¦„ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” **ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ì**ë¥¼ í¬í•¨í•˜ë©°, ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ìì˜ ì‚¬ìš©ì ì´ë¦„ í˜•ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```
<email>#EXT#@<tenant name>.onmicrosoft.com
```
ì´ë©”ì¼ì€ ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì£¼ì†Œì´ë©° "@"ê°€ ë°‘ì¤„ "_"ë¡œ ëŒ€ì²´ë©ë‹ˆë‹¤.

[**AADInternals**](https://github.com/Gerenios/AADInternals)ë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```powershell
# Check does the user exist
Invoke-AADIntUserEnumerationAsOutsider -UserName "user@company.com"
```
## Azure Unauthenticated Enumeration and Initial Entry

### Introduction

In this section, we will cover the techniques used to perform unauthenticated enumeration and gain initial access in Azure environments. Unauthenticated enumeration involves gathering information from publicly available sources without the need for valid credentials. This information can then be used to identify potential entry points and security weaknesses in the Azure environment.

### Tools and Techniques

#### 1. **Cloud Metadata API**

Azure provides a metadata service that can be accessed without authentication. This service can be used to retrieve valuable information about the Azure instance, such as its location, resource group, and network configuration. By querying the metadata service, an attacker can gather intelligence to aid in further exploitation.

#### 2. **DNS Enumeration**

Performing DNS enumeration can reveal subdomains and other domain-related information that may be useful for identifying targets within the Azure environment. Tools like `dnsrecon` and `dnsenum` can be used to gather this information without authentication.

#### 3. **Service Principal Enumeration**

Service principals in Azure are used to authenticate applications and services. Enumerating service principals can provide insights into the permissions and roles assigned to different applications, potentially revealing misconfigurations that could be exploited by an attacker.

#### 4. **Storage Account Enumeration**

Azure storage accounts may contain sensitive data or misconfigured access controls that could lead to unauthorized access. Enumerating storage accounts can help identify such vulnerabilities and assist in gaining initial entry into the Azure environment.

### Conclusion

Unauthenticated enumeration is a critical phase in the reconnaissance process of a penetration test. By leveraging publicly available information and tools, attackers can gather valuable intelligence to identify potential attack vectors and security gaps in Azure environments. It is essential for organizations to regularly assess and secure their Azure environments to prevent unauthorized access and data breaches.
```
UserName         Exists
--------         ------
user@company.com True
```
ë‹¹ì‹ ì€ ë˜í•œ í•œ ì¤„ì— í•˜ë‚˜ì˜ ì´ë©”ì¼ ì£¼ì†Œê°€ í¬í•¨ëœ í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
user@company.com
user2@company.com
admin@company.com
admin2@company.com
external.user_gmail.com#EXT#@company.onmicrosoft.com
external.user_outlook.com#EXT#@company.onmicrosoft.com
```

```powershell
# Invoke user enumeration
Get-Content .\users.txt | Invoke-AADIntUserEnumerationAsOutsider -Method Normal
```
**ì„¸ ê°€ì§€ ë‹¤ë¥¸ ì—´ê±° ë°©ë²•**ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

| ë°©ë²•       | ì„¤ëª…                                                                                                                                                                                             |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Normal    | ì´ëŠ” ìœ„ì—ì„œ ì–¸ê¸‰í•œ GetCredentialType APIë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤. ê¸°ë³¸ ë°©ë²•ì…ë‹ˆë‹¤.                                                                                                                           |
| Login     | <p>ì´ ë°©ë²•ì€ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸ì„ ì‹œë„í•©ë‹ˆë‹¤.<br><strong>ì°¸ê³ :</strong> ì¿¼ë¦¬ëŠ” ë¡œê·¸ì¸ ë¡œê·¸ì— ê¸°ë¡ë©ë‹ˆë‹¤.</p>                                                                                       |
| Autologon | <p>ì´ ë°©ë²•ì€ ì‚¬ìš©ìë¡œ ìë™ ë¡œê·¸ì¸ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ë¡œê·¸ì¸ì„ ì‹œë„í•©ë‹ˆë‹¤.<br><strong>ì¿¼ë¦¬ëŠ”</strong> ë¡œê·¸ì¸ ë¡œê·¸ì— ê¸°ë¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤! ë”°ë¼ì„œ, íŒ¨ìŠ¤ì›Œë“œ ìŠ¤í”„ë ˆì´ ë° ë¸Œë£¨íŠ¸í¬ìŠ¤ ê³µê²©ì—ë„ ì˜ ì‘ë™í•©ë‹ˆë‹¤.</p> |

ìœ íš¨í•œ ì‚¬ìš©ì ì´ë¦„ì„ ë°œê²¬í•œ í›„ **ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´**ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```powershell
Get-AADIntLoginInformation -UserName root@corp.onmicrosoft.com
```
ìŠ¤í¬ë¦½íŠ¸ [**o365creeper**](https://github.com/LMGsec/o365creeper)ë¥¼ ì‚¬ìš©í•˜ë©´ **ì´ë©”ì¼ì´ ìœ íš¨í•œì§€** í™•ì¸í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
```powershell
# Put in emails.txt emails such as:
# - root@corp.onmicrosoft.com
python.exe .\o365creeper\o365creeper.py -f .\emails.txt -o validemails.txt
```
**Microsoft Teamsë¥¼ í†µí•œ ì‚¬ìš©ì ì—´ê±°**

Microsoft TeamsëŠ” ì •ë³´ë¥¼ ì–»ê¸° ì¢‹ì€ ì†ŒìŠ¤ì…ë‹ˆë‹¤.

Microsoft Teamsì˜ APIë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ **externalsearchv3**ì™€ **searchUsers**ì™€ ê°™ì€ "ì‚¬ìš©ì ê²€ìƒ‰" ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ Teamsì— ë“±ë¡ëœ ì‚¬ìš©ì ê³„ì •ì— ëŒ€í•œ ì¼ë°˜ ì •ë³´ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

API ì‘ë‹µì— ë”°ë¼ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ìì™€ ìœ íš¨í•œ Teams êµ¬ë…ì„ ê°€ì§„ ê¸°ì¡´ ì‚¬ìš©ìë¥¼ êµ¬ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[**TeamsEnum**](https://github.com/sse-secure-systems/TeamsEnum) ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ì–´ì§„ ì‚¬ìš©ì ì´ë¦„ ì§‘í•©ì„ Teams APIì— ëŒ€í•´ ìœ íš¨ì„±ì„ ê²€ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
python3 TeamsEnum.py -a password -u <username> -f inputlist.txt -o teamsenum-output.json
```
## Azure Unauthenticated Enumeration and Initial Entry

### Introduction

In this section, we will cover the techniques used to perform unauthenticated enumeration and gain initial access in Azure environments. Unauthenticated enumeration involves gathering information from publicly available sources without the need for valid credentials. This information can then be used to identify potential entry points and vulnerabilities that can be exploited to gain initial access to the Azure environment.

### Tools and Techniques

#### 1. **Enumerating Azure Subdomains**

One common technique is to use tools like `Sublist3r` or `Amass` to discover subdomains associated with the target Azure environment. By identifying subdomains, an attacker can uncover additional entry points that may have weaker security controls compared to the main domain.

#### 2. **Identifying Azure Storage Accounts**

Another important aspect is identifying Azure storage accounts that may be publicly accessible. Tools like `azurite` or manual inspection can help in identifying storage accounts that have misconfigured access controls, allowing an attacker to view, modify, or delete data stored in the account.

#### 3. **Discovering Azure Web Applications**

Using tools like `dirb` or `Gobuster`, an attacker can discover web applications hosted within the Azure environment. By identifying these applications, the attacker can look for common vulnerabilities such as misconfigured permissions, outdated software, or known security issues that can be exploited to gain access.

### Conclusion

Unauthenticated enumeration is a critical phase in the reconnaissance process, allowing attackers to gather valuable information without alerting the target organization. By leveraging tools and techniques to identify potential entry points and vulnerabilities, an attacker can increase their chances of successfully gaining initial access to Azure environments.
```
[-] user1@domain - Target user not found. Either the user does not exist, is not Teams-enrolled or is configured to not appear in search results (personal accounts only)
[+] user2@domain - User2 | Company (Away, Mobile)
[+] user3@domain - User3 | Company (Available, Desktop)
```
ë˜í•œ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ì¡´ ì‚¬ìš©ìì˜ ê°€ìš©ì„± ì •ë³´ë¥¼ ì—´ëŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- ì‚¬ìš© ê°€ëŠ¥
- ìë¦¬ ë¹„ì›€
- ë°©í•´ ê¸ˆì§€
- ë°”ì¨
- ì˜¤í”„ë¼ì¸

**ì—…ë¬´ ì™¸ ë©”ì‹œì§€**ê°€ êµ¬ì„±ë˜ì–´ ìˆëŠ” ê²½ìš° TeamsEnumì„ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ê²€ìƒ‰í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì¶œë ¥ íŒŒì¼ì´ ì§€ì •ëœ ê²½ìš°, ì—…ë¬´ ì™¸ ë©”ì‹œì§€ëŠ” ìë™ìœ¼ë¡œ JSON íŒŒì¼ ë‚´ì— ì €ì¥ë©ë‹ˆë‹¤:
```
jq . teamsenum-output.json
```
## Azure Unauthenticated Enumeration and Initial Entry

### Introduction

In this section, we will cover the techniques to perform unauthenticated enumeration and gain initial access in Azure environments. By leveraging publicly available information and tools, an attacker can gather valuable information about the target Azure environment without the need for authentication. This information can then be used to identify potential entry points and security weaknesses that can be exploited to gain initial access.

### Enumeration Techniques

#### 1. DNS Enumeration

DNS enumeration involves querying DNS servers to gather information about the target domain, such as subdomains, mail servers, and other DNS records. Tools like `dnsrecon` and `dnsenum` can be used to perform DNS enumeration and gather valuable information that can be used in further attacks.

#### 2. Service Enumeration

Service enumeration involves identifying services running in the Azure environment, such as web servers, databases, and other applications. Tools like `nmap` and `Masscan` can be used to scan for open ports and identify services running on those ports.

#### 3. Storage Account Enumeration

Azure storage accounts can often contain sensitive data such as configuration files, backups, and other valuable information. Tools like `azcopy` and `Azure Storage Explorer` can be used to enumerate storage accounts and identify potentially sensitive data that can be accessed without authentication.

### Initial Entry Points

Once valuable information has been gathered through enumeration, the attacker can identify potential entry points to gain initial access to the Azure environment. Common entry points include:

- Weak or default credentials on services such as web servers, databases, and storage accounts.
- Misconfigurations that allow unauthorized access to sensitive data or resources.
- Vulnerabilities in applications or services running in the Azure environment that can be exploited to gain unauthorized access.

By leveraging the information gathered during enumeration and identifying these entry points, an attacker can gain initial access to the Azure environment and further compromise the security of the target organization.
```json
{
"email": "user2@domain",
"exists": true,
"info": [
{
"tenantId": "[REDACTED]",
"isShortProfile": false,
"accountEnabled": true,
"featureSettings": {
"coExistenceMode": "TeamsOnly"
},
"userPrincipalName": "user2@domain",
"givenName": "user2@domain",
"surname": "",
"email": "user2@domain",
"tenantName": "Company",
"displayName": "User2",
"type": "Federated",
"mri": "8:orgid:[REDACTED]",
"objectId": "[REDACTED]"
}
],
"presence": [
{
"mri": "8:orgid:[REDACTED]",
"presence": {
"sourceNetwork": "Federated",
"calendarData": {
"outOfOfficeNote": {
"message": "Dear sender. I am out of the office until March 23rd with limited access to my email. I will respond after my return.Kind regards, User2",
"publishTime": "2023-03-15T21:44:42.0649385Z",
"expiry": "2023-04-05T14:00:00Z"
},
"isOutOfOffice": true
},
"capabilities": [
"Audio",
"Video"
],
"availability": "Away",
"activity": "Away",
"deviceType": "Mobile"
},
"etagMatch": false,
"etag": "[REDACTED]",
"status": 20000
}
]
}
```
## Azure Services

Azure í…Œë„ŒíŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” **ë„ë©”ì¸ì„ ì•Œì•˜ìœ¼ë¯€ë¡œ** ì´ì œ **ë…¸ì¶œëœ Azure ì„œë¹„ìŠ¤ë¥¼ ì°¾ì•„ë³´ëŠ” ê²ƒ**ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ [**MicroBust**](https://github.com/NetSPI/MicroBurst)ì—ì„œ ì œê³µí•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ **ì—¬ëŸ¬ Azure ì„œë¹„ìŠ¤ ë„ë©”ì¸**ì—ì„œ ê¸°ë³¸ ë„ë©”ì¸ ì´ë¦„(ë° ëª‡ ê°€ì§€ ìˆœì—´)ì„ ê²€ìƒ‰í•  ê²ƒì…ë‹ˆë‹¤:
```powershell
Import-Module .\MicroBurst\MicroBurst.psm1 -Verbose
Invoke-EnumerateAzureSubDomains -Base corp -Verbose
```
## ì˜¤í”ˆ ìŠ¤í† ë¦¬ì§€

[**InvokeEnumerateAzureBlobs.ps1**](https://github.com/NetSPI/MicroBurst/blob/master/Misc/Invoke-EnumerateAzureBlobs.ps1)ì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤í”ˆ ìŠ¤í† ë¦¬ì§€ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” **`Microburst/Misc/permitations.txt`** íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ìˆœì—´ì„ ìƒì„±í•˜ì—¬ **ì˜¤í”ˆ ìŠ¤í† ë¦¬ì§€ ê³„ì •ì„ ì°¾ìœ¼ë ¤ê³  ì‹œë„**í•©ë‹ˆë‹¤.
```powershell
Import-Module .\MicroBurst\MicroBurst.psm1
Invoke-EnumerateAzureBlobs -Base corp
[...]
https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
[...]

# Access https://corpcommon.blob.core.windows.net/secrets?restype=container&comp=list
# Check: <Name>ssh_info.json</Name>
# Access then https://corpcommon.blob.core.windows.net/secrets/ssh_info.json
```
### SAS URLs

_**ê³µìœ  ì•¡ì„¸ìŠ¤ ì„œëª…**_ (SAS) URLì€ **íŠ¹ì • ìŠ¤í† ë¦¬ì§€ ê³„ì •ì˜ ì¼ë¶€** (ì „ì²´ ì»¨í…Œì´ë„ˆ, íŒŒì¼ ë“±)ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” URLì´ë©° ì¼ë¶€ íŠ¹ì • ê¶Œí•œ (ì½ê¸°, ì“°ê¸° ë“±)ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ìœ ì¶œëœ ê²ƒì„ ë°œê²¬í•˜ë©´ ë¯¼ê°í•œ ì •ë³´ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ë³´ì…ë‹ˆë‹¤ (ì´ê²ƒì€ ì»¨í…Œì´ë„ˆì— ì•¡ì„¸ìŠ¤í•˜ê¸° ìœ„í•œ ê²ƒì´ë©°, íŒŒì¼ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ë¶€ì—¬í•˜ëŠ” ê²½ìš° URLì˜ ê²½ë¡œì—ë„ í•´ë‹¹ íŒŒì¼ì´ í¬í•¨ë  ê²ƒì…ë‹ˆë‹¤):

`https://<storage_account_name>.blob.core.windows.net/newcontainer?sp=r&st=2021-09-26T18:15:21Z&se=2021-10-27T02:14:21Z&spr=https&sv=2021-07-08&sr=c&sig=7S%2BZySOgy4aA3Dk0V1cJyTSIf1cW%2Fu3WFkhHV32%2B4PE%3D`

[**Storage Explorer**](https://azure.microsoft.com/en-us/features/storage-explorer/)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì— ì•¡ì„¸ìŠ¤í•©ë‹ˆë‹¤

## ìê²© ì¦ëª… ì¹¨í•´

### í”¼ì‹±

* [**ì¼ë°˜ í”¼ì‹±**](https://book.hacktricks.xyz/generic-methodologies-and-resources/phishing-methodology) (ìê²© ì¦ëª… ë˜ëŠ” OAuth ì•± -[ë¶ˆë²• ë™ì˜ ê·¸ëœíŠ¸ ê³µê²©](az-illicit-consent-grant.md)-)
* [**ì¥ì¹˜ ì½”ë“œ ì¸ì¦** í”¼ì‹±](az-device-code-authentication-phishing.md)

### ë¹„ë°€ë²ˆí˜¸ ìŠ¤í”„ë ˆì´ / ë¸Œë£¨íŠ¸ í¬ìŠ¤

{% content-ref url="az-password-spraying.md" %}
[az-password-spraying.md](az-password-spraying.md)
{% endcontent-ref %}

## ì°¸ê³  ìë£Œ

* [https://aadinternals.com/post/just-looking/](https://aadinternals.com/post/just-looking/)
* [https://www.securesystems.de/blog/a-fresh-look-at-user-enumeration-in-microsoft-teams/](https://www.securesystems.de/blog/a-fresh-look-at-user-enumeration-in-microsoft-teams/)

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
