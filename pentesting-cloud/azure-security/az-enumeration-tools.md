# Az - Enumeration Tools

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teile Hacking-Tricks, indem du PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

## Installiere PowerShell in Linux

{% hint style="success" %}
In Linux musst du PowerShell Core installieren:
```bash
sudo apt-get update
sudo apt-get install -y wget apt-transport-https software-properties-common

# Ubuntu 20.04
wget -q https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb

# Update repos
sudo apt-get update
sudo add-apt-repository universe

# Install & start powershell
sudo apt-get install -y powershell
pwsh

# Az cli
curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash
```
{% endhint %}

## PowerShell auf MacOS installieren

Anweisungen aus der [**Dokumentation**](https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-macos?view=powershell-7.4):

1. Installiere `brew`, falls noch nicht installiert:
```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```
2. Installieren Sie die neueste stabile Version von PowerShell:
```sh
brew install powershell/tap/powershell
```
3. PowerShell ausf√ºhren:
```sh
pwsh
```
4. Aktualisierung:
```sh
brew update
brew upgrade powershell
```
## Haupt-Enumeration-Tools

### az cli

[**Azure Command-Line Interface (CLI)**](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli) ist ein plattform√ºbergreifendes Tool, das in Python geschrieben wurde, um (die meisten) Azure- und Entra ID-Ressourcen zu verwalten und zu administrieren. Es verbindet sich mit Azure und f√ºhrt administrative Befehle √ºber die Befehlszeile oder Skripte aus.

Folgen Sie diesem Link f√ºr die [**Installationsanweisungen¬°**](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli#install).

Befehle in Azure CLI sind nach folgendem Muster strukturiert: `az <service> <action> <parameters>`

#### Debug | MitM az cli

Mit dem Parameter **`--debug`** ist es m√∂glich, alle Anfragen zu sehen, die das Tool **`az`** sendet:
```bash
az account management-group list --output table --debug
```
Um einen **MitM** auf das Tool durchzuf√ºhren und **alle Anfragen**, die es manuell sendet, zu √ºberpr√ºfen, kannst du Folgendes tun:

{% tabs %}
{% tab title="Bash" %}
```bash
export ADAL_PYTHON_SSL_NO_VERIFY=1
export AZURE_CLI_DISABLE_CONNECTION_VERIFICATION=1
export HTTPS_PROXY="http://127.0.0.1:8080"
export HTTP_PROXY="http://127.0.0.1:8080"

# If this is not enough
# Download the certificate from Burp and convert it into .pem format
# And export the following env variable
openssl x509 -in ~/Downloads/cacert.der -inform DER -out ~/Downloads/cacert.pem -outform PEM
export REQUESTS_CA_BUNDLE=/Users/user/Downloads/cacert.pem
```
{% endtab %}

{% tab title="PS" %}
```bash
$env:ADAL_PYTHON_SSL_NO_VERIFY=1
$env:AZURE_CLI_DISABLE_CONNECTION_VERIFICATION=1
$env:HTTPS_PROXY="http://127.0.0.1:8080"
$env:HTTP_PROXY="http://127.0.0.1:8080"
```
{% endtab %}
{% endtabs %}

### Az PowerShell

Azure PowerShell ist ein Modul mit Cmdlets zur Verwaltung von Azure-Ressourcen direkt √ºber die PowerShell-Befehlszeile.

Folgen Sie diesem Link f√ºr die [**Installationsanweisungen**](https://learn.microsoft.com/en-us/powershell/azure/install-azure-powershell).

Befehle im Azure PowerShell AZ-Modul sind strukturiert wie: `<Action>-Az<Service> <parameters>`

#### Debug | MitM Az PowerShell

Mit dem Parameter **`-Debug`** ist es m√∂glich, alle Anfragen zu sehen, die das Tool sendet:
```bash
Get-AzResourceGroup -Debug
```
Um ein **MitM** auf das Tool durchzuf√ºhren und **alle Anfragen**, die es manuell sendet, zu √ºberpr√ºfen, k√∂nnen Sie die Umgebungsvariablen `HTTPS_PROXY` und `HTTP_PROXY` gem√§√ü den [**Dokumenten**](https://learn.microsoft.com/en-us/powershell/azure/az-powershell-proxy) festlegen.

### Microsoft Graph PowerShell

Microsoft Graph PowerShell ist ein plattform√ºbergreifendes SDK, das den Zugriff auf alle Microsoft Graph APIs erm√∂glicht, einschlie√ülich Dienste wie SharePoint, Exchange und Outlook, √ºber einen einzigen Endpunkt. Es unterst√ºtzt PowerShell 7+, moderne Authentifizierung √ºber MSAL, externe Identit√§ten und erweiterte Abfragen. Mit einem Fokus auf den minimalen Zugriff gew√§hrleistet es sichere Operationen und erh√§lt regelm√§√üige Updates, um mit den neuesten Funktionen der Microsoft Graph API in Einklang zu stehen.

Folgen Sie diesem Link f√ºr die [**Installationsanweisungen**](https://learn.microsoft.com/en-us/powershell/microsoftgraph/installation).

Befehle in Microsoft Graph PowerShell sind strukturiert wie: `<Action>-Mg<Service> <parameters>`

#### Debug Microsoft Graph PowerShell

Mit dem Parameter **`-Debug`** ist es m√∂glich, alle Anfragen zu sehen, die das Tool sendet:
```bash
Get-MgUser -Debug
```
### ~~**AzureAD Powershell**~~

Das Azure Active Directory (AD) Modul, jetzt **veraltet**, ist Teil von Azure PowerShell zur Verwaltung von Azure AD-Ressourcen. Es bietet Cmdlets f√ºr Aufgaben wie die Verwaltung von Benutzern, Gruppen und Anwendungsregistrierungen in Entra ID.

{% hint style="success" %}
Dies wird durch Microsoft Graph PowerShell ersetzt
{% endhint %}

Folgen Sie diesem Link f√ºr die [**Installationsanweisungen**](https://www.powershellgallery.com/packages/AzureAD).
