# Az - Grundinformationen

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

## Organisationshierarchie

<figure><img src="../../.gitbook/assets/image (271).png" alt=""><figcaption></figcaption></figure>

### Verwaltungsguppen

Wenn Ihre Organisation **viele Azure-Abonnements** hat, ben√∂tigen Sie m√∂glicherweise eine M√∂glichkeit, um den **Zugriff**, die Richtlinien und die Compliance f√ºr diese **Abonnements** effizient zu **verwalten**. **Verwaltungsguppen** bieten einen **Governance-Bereich √ºber Abonnements**.

Beachten Sie, dass in einem einzelnen Verzeichnis **10.000 Verwaltungsguppen** unterst√ºtzt werden k√∂nnen und ein Verwaltungsgruppenbaum **bis zu sechs Ebenen tief** sein kann.

<figure><img src="../../.gitbook/assets/image (147).png" alt=""><figcaption></figcaption></figure>

[Aus den Dokumenten](https://learn.microsoft.com/en-us/azure/governance/management-groups/overview#root-management-group-for-each-directory): Jedes Verzeichnis erh√§lt eine einzige **oberste Verwaltunggruppe, die als Wurzel** Verwaltunggruppe bezeichnet wird. Die Wurzelverwaltunggruppe ist in die Hierarchie integriert, sodass **alle Verwaltungsguppen und Abonnements zu ihr zusammengefasst werden**. Diese Wurzelverwaltunggruppe erm√∂glicht es, **globale Richtlinien und Azure-Rollen zuzuweisen**, die auf Verzeichnisebene angewendet werden. Der [Azure AD **Global Administrator muss sich zun√§chst**](https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin) in die **Rolle des Benutzerzugriffsadministrators dieser Wurzelgruppe** erheben. Nach der Erh√∂hung des Zugriffs kann der Administrator **jedem Azure-Benutzer oder -Gruppe Rollen zuweisen, um die Hierarchie zu verwalten**. Als Administrator k√∂nnen Sie **Ihr eigenes Konto als Eigent√ºmer der Wurzel** Verwaltunggruppe zuweisen.

Die Wurzelverwaltunggruppe **kann nicht verschoben oder gel√∂scht werden**, im Gegensatz zu anderen Verwaltungsguppen.

Verwaltungsguppen bieten Ihnen eine Unternehmensverwaltung in gro√üem Ma√üstab, unabh√§ngig davon, welche Art von Abonnements Sie haben. Allerdings m√ºssen **alle Abonnements innerhalb einer einzigen Verwaltunggruppe** dem **gleichen Azure Active Directory (Azure AD) Mandanten** vertrauen.

<figure><img src="../../.gitbook/assets/image (157).png" alt=""><figcaption></figcaption></figure>

### Azure-Abonnements

In Azure dient ein Abonnement als **logischer Container** zum **Bereitstellen** von gesch√§ftlichen oder technischen **Ressourcen**. Dieser Container enth√§lt die **Details der Ressourcen** wie virtuelle Maschinen (VMs), Datenbanken und andere. Bei der Erstellung einer Azure-Ressource, wie einer VM, wird das **dazugeh√∂rige Abonnement** angegeben. Diese Struktur erleichtert die Delegation des Zugriffs unter Verwendung von rollenbasierten Zugriffskontrollmechanismen.

### Ressourcengruppen

[Aus den Dokumenten:](https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/manage-resource-groups-python?tabs=macos#what-is-a-resource-group) Eine Ressourcengruppe ist ein **Container**, der **verwandte Ressourcen** f√ºr eine Azure-L√∂sung enth√§lt. Die Ressourcengruppe kann alle Ressourcen f√ºr die L√∂sung oder nur die **Ressourcen, die Sie als Gruppe verwalten m√∂chten**, enthalten. Im Allgemeinen f√ºgen Sie **Ressourcen** hinzu, die den **gleichen Lebenszyklus** teilen, zur gleichen Ressourcengruppe hinzu, damit Sie sie einfach als Gruppe bereitstellen, aktualisieren und l√∂schen k√∂nnen.

Alle **Ressourcen** m√ºssen **innerhalb einer Ressourcengruppe** sein und k√∂nnen nur zu einer Gruppe geh√∂ren. Wenn eine Ressourcengruppe gel√∂scht wird, werden auch alle Ressourcen darin gel√∂scht.

### Verwaltungseinheiten

[Aus den Dokumenten:](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-manage) Verwaltungseinheiten erm√∂glichen es Ihnen, Ihre Organisation in **jede Einheit** zu **unterteilen**, die Sie m√∂chten, und dann **spezifische Administratoren zuzuweisen**, die **nur die Mitglieder** dieser Einheit verwalten k√∂nnen. Zum Beispiel k√∂nnten Sie Verwaltungseinheiten verwenden, um Berechtigungen an Administratoren jeder Schule an einer gro√üen Universit√§t zu delegieren, damit sie den Zugriff steuern, Benutzer verwalten und Richtlinien nur in der Ingenieurschule festlegen k√∂nnen.

Nur **Benutzer**, **Gruppen** und **Ger√§te** k√∂nnen **Mitglieder** einer **Verwaltungseinheit** sein.

Daher wird eine **Verwaltungseinheit** einige **Mitglieder** **enthalten**, und andere **Prinzipale** werden **Berechtigungen √ºber diese** Verwaltungseinheit **zugewiesen**, die sie verwenden k√∂nnen, um die Mitglieder der Verwaltungseinheit zu **verwalten**.

## Azure vs Azure AD vs Azure AD-Dom√§nendienste

Es ist wichtig zu beachten, dass **Azure AD** ein Dienst **innerhalb** von **Azure** ist. **Azure** ist die **Cloud-Plattform** von Microsoft, w√§hrend **Azure AD** ein Unternehmens-**Identit√§tsdienst** in Azure ist.\
Dar√ºber hinaus ist **Azure AD nicht wie Windows Active Directory**, es ist ein Identit√§tsdienst, der auf eine v√∂llig andere Weise funktioniert. Wenn Sie einen **Dom√§nencontroller in Azure** f√ºr Ihre Windows Active Directory-Umgebung betreiben m√∂chten, m√ºssen Sie **Azure AD-Dom√§nendienste** verwenden.

## Prinzipale

Azure unterst√ºtzt verschiedene Arten von Prinzipalen:

* **Benutzer**: Eine regul√§re **Person** mit Anmeldeinformationen f√ºr den Zugriff.
* **Gruppe**: Eine **Gruppe von Prinzipalen**, die gemeinsam verwaltet wird. **Berechtigungen**, die Gruppen gew√§hrt werden, werden von ihren **Mitgliedern** **vererbt**.
* **Service Principal/Unternehmensanwendungen**: Es handelt sich um eine **Identit√§t**, die f√ºr die **Nutzung** mit **Anwendungen**, gehosteten Diensten und automatisierten Tools zum Zugriff auf Azure-Ressourcen erstellt wurde. Dieser Zugriff ist **durch die zugewiesenen Rollen** f√ºr den Service Principal eingeschr√§nkt, was Ihnen die Kontrolle dar√ºber gibt, **auf welche Ressourcen zugegriffen werden kann** und auf welcher Ebene. Aus Sicherheitsgr√ºnden wird immer empfohlen, **Service Principals mit automatisierten Tools** zu verwenden, anstatt ihnen zu erlauben, sich mit einer Benutzeridentit√§t anzumelden.

Beim Erstellen eines **Service Principals** k√∂nnen Sie zwischen **Passwortauthentifizierung** oder **Zertifikatsauthentifizierung** w√§hlen.

* Wenn Sie **Passwort**-Auth (standardm√§√üig) w√§hlen, **speichern Sie das generierte Passwort**, da Sie nicht erneut darauf zugreifen k√∂nnen.
* Wenn Sie die Zertifikatsauthentifizierung w√§hlen, stellen Sie sicher, dass die **Anwendung Zugriff auf den privaten Schl√ºssel hat**.
* **Verwaltete Identit√§t (Metadaten-Creds)**: Verwaltete Identit√§ten in Azure Active Directory bieten eine L√∂sung zur **automatischen Verwaltung der Identit√§t** von Anwendungen. Diese Identit√§ten werden von Anwendungen verwendet, um sich mit **Ressourcen** zu verbinden, die mit der Azure Active Directory (**Azure AD**) Authentifizierung kompatibel sind. Durch die Nutzung verwalteter Identit√§ten k√∂nnen Anwendungen **Azure AD-Token sichern**, w√§hrend die Notwendigkeit entf√§llt, Anmeldeinformationen direkt zu verwalten. Es gibt zwei Arten von verwalteten Identit√§ten:
* **Systemzugewiesen**. Einige Azure-Dienste erm√∂glichen es Ihnen, eine verwaltete Identit√§t direkt auf einer Dienstinstanz **zu aktivieren**. Wenn Sie eine systemzugewiesene verwaltete Identit√§t aktivieren, wird eine Identit√§t in Azure AD erstellt. Die Identit√§t ist an den **Lebenszyklus dieser Dienstinstanz** gebunden. Wenn die **Ressource** **gel√∂scht** wird, l√∂scht Azure automatisch die **Identit√§t** f√ºr Sie. Von Design kann nur diese Azure-Ressource diese Identit√§t verwenden, um Token von Azure AD anzufordern.
* **Benutzerzugewiesen**. Sie k√∂nnen auch eine verwaltete Identit√§t als eigenst√§ndige Azure-Ressource erstellen. Sie k√∂nnen [eine benutzerzugewiesene verwaltete Identit√§t erstellen](https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-manage-ua-identity-portal) und sie einer oder **mehreren Instanzen** eines Azure-Dienstes (mehrere Ressourcen) zuweisen. Bei benutzerzugewiesenen verwalteten Identit√§ten wird die **Identit√§t separat von den Ressourcen verwaltet, die sie verwenden**.

## Rollen & Berechtigungen

**Rollen** werden **Prinzipalen** auf einem **Bereich** zugewiesen: `principal -[HAS ROLE]->(scope)`

**Rollen**, die Gruppen zugewiesen werden, werden von allen **Mitgliedern** der Gruppe **vererbt**.

Je nach dem Bereich, dem die Rolle zugewiesen wurde, kann die **Rolle** auf **andere Ressourcen** innerhalb des Bereichscontainers **vererbt** werden. Wenn beispielsweise ein Benutzer A eine **Rolle im Abonnement** hat, hat er diese **Rolle in allen Ressourcengruppen** innerhalb des Abonnements und auf **allen Ressourcen** innerhalb der Ressourcengruppe.

### **Klassische Rollen**

| **Besitzer**                     | <ul><li>Vollzugriff auf alle Ressourcen</li><li>Kann den Zugriff f√ºr andere Benutzer verwalten</li></ul> | Alle Ressourcentypen |
| ----------------------------- | ---------------------------------------------------------------------------------------- | ------------------ |
| **Mitwirkender**               | <ul><li>Vollzugriff auf alle Ressourcen</li><li>Kann den Zugriff nicht verwalten</li></ul>              | Alle Ressourcentypen |
| **Leser**                    | ‚Ä¢ Alle Ressourcen anzeigen                                                                     | Alle Ressourcentypen |
| **Benutzerzugriffsadministrator** | <ul><li>Alle Ressourcen anzeigen</li><li>Kann den Zugriff f√ºr andere Benutzer verwalten</li></ul>           | Alle Ressourcentypen |

### Eingebaute Rollen

[Aus den Dokumenten: ](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles)[Azure rollenbasierte Zugriffskontrolle (Azure RBAC)](https://learn.microsoft.com/en-us/azure/role-based-access-control/overview) hat mehrere Azure **eingebaute Rollen**, die Sie **Benutzern, Gruppen, Service Principals und verwalteten Identit√§ten** zuweisen k√∂nnen. Rollenzuweisungen sind der Weg, wie Sie **Zugriff auf Azure-Ressourcen** steuern. Wenn die eingebauten Rollen nicht den spezifischen Bed√ºrfnissen Ihrer Organisation entsprechen, k√∂nnen Sie Ihre eigenen [**benutzerdefinierten Azure-Rollen**](https://learn.microsoft.com/en-us/azure/role-based-access-control/custom-roles)** erstellen.**

**Eingebaute** Rollen gelten nur f√ºr die **Ressourcen**, f√ºr die sie **bestimmt** sind, zum Beispiel √ºberpr√ºfen Sie diese 2 Beispiele f√ºr **eingebaute Rollen √ºber Compute** Ressourcen:

| [Disk Backup Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#disk-backup-reader)                 | Berechtigt, das Backup-Repository f√ºr die Durchf√ºhrung von Festplattensicherungen zu verwenden.      | 3e5e47e6-65f7-47ef-90b5-e5dd4d455f24 |
| ----------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- | ------------------------------------ |
| [Virtual Machine User Login](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#virtual-machine-user-login) | Virtuelle Maschinen im Portal anzeigen und sich als regul√§rer Benutzer anmelden. | fb879df8-f326-4884-b1cf-06f3ad86be52 |

Diese Rollen k√∂nnen **auch √ºber logische Container** (wie Verwaltungsguppen, Abonnements und Ressourcengruppen) zugewiesen werden, und die betroffenen Prinzipale haben sie **√ºber die Ressourcen innerhalb dieser Container**.

* Finden Sie hier eine Liste mit [**allen Azure eingebauten Rollen**](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles).
* Finden Sie hier eine Liste mit [**allen Azure AD eingebauten Rollen**](https://learn.microsoft.com/en-us/azure/active-directory/roles/permissions-reference).

### Benutzerdefinierte Rollen

Azure erm√∂glicht auch die Erstellung von [**benutzerdefinierten Rollen**](https://learn.microsoft.com/en-us/azure/role-based-access-control/custom-roles) mit den Berechtigungen, die der Benutzer ben√∂tigt.

### Berechtigung verweigert

* Damit ein **Prinzipal Zugriff auf eine Ressource hat**, muss ihm eine explizite Rolle zugewiesen werden (in irgendeiner Form), die ihm diese Berechtigung **gew√§hrt**.
* Eine explizite **Verweigerungsrollenzuweisung hat Vorrang** vor der Rolle, die die Berechtigung gew√§hrt.

<figure><img src="../../.gitbook/assets/image (191).png" alt=""><figcaption></figcaption></figure>

### Globaler Administrator

Benutzer mit der Rolle des Globalen Administrators haben die M√∂glichkeit, sich in die Rolle des Benutzerzugriffsadministrators f√ºr die Wurzelverwaltunggruppe zu '**erheben**'. Das bedeutet, dass ein Globaler Administrator in der Lage sein wird, den Zugriff auf **alle Azure-Abonnements und Verwaltungsguppen** zu verwalten.\
Diese Erh√∂hung kann am Ende der Seite durchgef√ºhrt werden: [https://portal.azure.com/#view/Microsoft\_AAD\_IAM/ActiveDirectoryMenuBlade/\~/Properties](https://portal.azure.com/#view/Microsoft\_AAD\_IAM/ActiveDirectoryMenuBlade/\~/Properties)

<figure><img src="../../.gitbook/assets/image (162).png" alt=""><figcaption></figcaption></figure>

### Azure-Richtlinien

Azure-Richtlinien sind eine Reihe von **Regeln und Vorschriften in Microsoft Azure**, einem Cloud-Computing-Dienst, die helfen, organisatorische Standards zu verwalten und durchzusetzen und die Compliance in gro√üem Ma√üstab zu bewerten. Diese Richtlinien setzen verschiedene Regeln f√ºr Ihre **Azure-Ressourcen** durch und stellen sicher, dass diese Ressourcen den Unternehmensstandards und Service-Level-Vereinbarungen entsprechen.

Azure-Richtlinien sind entscheidend f√ºr die Cloud-Governance und -Sicherheit, da sie helfen, sicherzustellen, dass Ressourcen ordnungsgem√§√ü und effizient genutzt werden und dass sie externen Vorschriften und internen Richtlinien entsprechen.\
Einige Beispiele:

1. **Sicherstellen der Compliance mit bestimmten Azure-Regionen**: Diese Richtlinie stellt sicher, dass alle Ressourcen in bestimmten Azure-Regionen bereitgestellt werden. Zum Beispiel m√∂chte ein Unternehmen m√∂glicherweise sicherstellen, dass alle seine Daten in Europa f√ºr die Einhaltung der DSGVO gespeichert werden.
2. **Durchsetzung von Namensstandards**: Richtlinien k√∂nnen Namenskonventionen f√ºr Azure-Ressourcen durchsetzen. Dies hilft bei der Organisation und der einfachen Identifizierung von Ressourcen anhand ihrer Namen, was in gro√üen Umgebungen hilfreich ist.
3. **Einschr√§nkung bestimmter Ressourcentypen**: Diese Richtlinie kann die Erstellung bestimmter Ressourcentypen einschr√§nken. Zum Beispiel k√∂nnte eine Richtlinie festgelegt werden, um die Erstellung teurer Ressourcentypen, wie bestimmter VM-Gr√∂√üen, zur Kostenkontrolle zu verhindern.
4. **Durchsetzung von Tagging-Richtlinien**: Tags sind Schl√ºssel-Wert-Paare, die mit Azure-Ressourcen verkn√ºpft sind und f√ºr das Ressourcenmanagement verwendet werden. Richtlinien k√∂nnen durchsetzen, dass bestimmte Tags vorhanden sein m√ºssen oder spezifische Werte haben m√ºssen, f√ºr alle Ressourcen. Dies ist n√ºtzlich f√ºr die Kostenverfolgung, den Besitz oder die Kategorisierung von Ressourcen.
5. **Einschr√§nkung des √∂ffentlichen Zugriffs auf Ressourcen**: Richtlinien k√∂nnen durchsetzen, dass bestimmte Ressourcen, wie Speicherkonten oder Datenbanken, keine √∂ffentlichen Endpunkte haben, um sicherzustellen, dass sie nur innerhalb des Netzwerks der Organisation zug√§nglich sind.
6. **Automatisches Anwenden von Sicherheitseinstellungen**: Richtlinien k√∂nnen verwendet werden, um automatisch Sicherheitseinstellungen auf Ressourcen anzuwenden, wie das Anwenden einer bestimmten Netzwerksicherheitsgruppe auf alle VMs oder sicherzustellen, dass alle Speicherkonten Verschl√ºsselung verwenden.

Beachten Sie, dass Azure-Richtlinien an jeder Ebene der Azure-Hierarchie angeh√§ngt werden k√∂nnen, aber sie werden **h√§ufig in der Wurzelverwaltunggruppe** oder in anderen Verwaltungsguppen verwendet.

### Berechtigungsbereich

In Azure **k√∂nnen Berechtigungen an jedem Teil der Hierarchie zugewiesen werden**. Dazu geh√∂ren Verwaltungsguppen, Abonnements, Ressourcengruppen und einzelne Ressourcen. Berechtigungen werden von den enthaltenen **Ressourcen** der Entit√§t, der sie zugewiesen wurden, **vererbt**.

Diese hierarchische Struktur erm√∂glicht eine effiziente und skalierbare Verwaltung von Zugriffsberechtigungen.

<figure><img src="../../.gitbook/assets/image (26).png" alt=""><figcaption></figcaption></figure>

### Azure RBAC vs ABAC

**RBAC** (rollenbasierte Zugriffskontrolle) ist das, was wir bereits in den vorherigen Abschnitten gesehen haben: **Zuweisen einer Rolle an einen Prinzipal, um ihm Zugriff** auf eine Ressource zu gew√§hren.\
In einigen F√§llen m√∂chten Sie jedoch m√∂glicherweise **feinere Zugriffskontrolle** oder die Verwaltung von **Hunderte** von Rollenzuweisungen **vereinfachen**.

Azure **ABAC** (attributbasierte Zugriffskontrolle) baut auf Azure RBAC auf, indem es **Bedingungen f√ºr die Rollenzuweisung basierend auf Attributen** im Kontext spezifischer Aktionen hinzuf√ºgt. Eine _Bedingung f√ºr die Rollenzuweisung_ ist eine **zus√§tzliche √úberpr√ºfung, die Sie optional zu Ihrer Rollenzuweisung hinzuf√ºgen k√∂nnen**, um eine feinere Zugriffskontrolle zu bieten. Eine Bedingung filtert die Berechtigungen, die als Teil der Rollendefinition und Rollenzuweisung gew√§hrt werden. Zum Beispiel k√∂nnen Sie **eine Bedingung hinzuf√ºgen, die erfordert, dass ein Objekt ein bestimmtes Tag hat, um das Objekt zu lesen**.\
Sie **k√∂nnen** den **Zugriff** auf bestimmte Ressourcen **nicht** ausdr√ºcklich **verweigern** **mit Bedingungen**.

### Standardbenutzerberechtigungen

Ein grundlegender Benutzer hat einige **Standardberechtigungen**, um einige Teile von AzureAD aufzulisten:

* Alle Benutzer, Gruppen, Anwendungen, Ger√§te, Rollen, Abonnements und deren √∂ffentliche Eigenschaften lesen
* G√§ste einladen (_kann deaktiviert werden_)
* Sicherheitsgruppen erstellen
* Nicht versteckte Gruppenmitgliedschaften lesen
* G√§ste zu eigenen Gruppen hinzuf√ºgen
* Neue Anwendung erstellen (_kann deaktiviert werden_)
* Bis zu 50 Ger√§te in Azure hinzuf√ºgen (_kann deaktiviert werden_)

Sie k√∂nnen die vollst√§ndige [Liste der **Standardberechtigungen von Benutzern** in den Dokumenten](https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/users-default-permissions) einsehen. Dar√ºber hinaus beachten Sie, dass Sie in dieser Liste auch die **Liste der Standardberechtigungen f√ºr G√§ste** sehen k√∂nnen.

{% hint style="info" %}
Denken Sie daran, dass der Benutzer eine explizite Genehmigung f√ºr die Berechtigung ben√∂tigt, um Azure-Ressourcen aufzulisten.
{% endhint %}

### Privileged Identity Management (PIM)

Privileged Identity Management (PIM) in Azure ist ein Tool, das **privilegierten Zugriff** in Azure Active Directory und Azure **verwaltet, steuert und √ºberwacht**. Es verbessert die Sicherheit, indem es **just-in-time und zeitlich begrenzten privilegierten Zugriff** bereitstellt, **Genehmigungsworkflows durchsetzt und zus√§tzliche Authentifizierung** erfordert. Dieser Ansatz minimiert das Risiko unbefugten Zugriffs, indem sichergestellt wird, dass erh√∂hte Berechtigungen nur gew√§hrt werden, wenn dies erforderlich ist und f√ºr einen bestimmten Zeitraum.

## Authentifizierungstoken

Es gibt **drei Arten von Token**, die in OIDC verwendet werden:

* [**Zugriffstoken**](https://learn.microsoft.com/en-us/azure/active-directory/develop/access-tokens)**:** Der Client pr√§sentiert dieses Token dem Ressourcenserver, um **auf Ressourcen** zuzugreifen. Es kann nur f√ºr eine bestimmte Kombination aus Benutzer, Client und Ressource verwendet werden und **kann nicht** bis zum Ablauf widerrufen werden - das ist standardm√§√üig 1 Stunde. Die Erkennung ist bei dieser Verwendung gering.
* **ID-Token**: Der Client erh√§lt dieses **Token vom Autorisierungsserver**. Es enth√§lt grundlegende Informationen √ºber den Benutzer. Es ist **an eine bestimmte Kombination aus Benutzer und Client** gebunden.
* **Aktualisierungstoken**: Dem Client mit dem Zugriffstoken bereitgestellt. Wird verwendet, um **neue Zugriffs- und ID-Token** zu erhalten. Es ist an eine bestimmte Kombination aus Benutzer und Client gebunden und kann widerrufen werden. Die Standardablaufzeit betr√§gt **90 Tage** f√ºr inaktive Aktualisierungstoken und **keine Ablaufzeit f√ºr aktive Token**.

{% hint style="warning" %}
Informationen f√ºr **bedingten Zugriff** sind **innerhalb** des **JWT** **gespeichert**. Wenn Sie das **Token von einer erlaubten IP-Adresse** anfordern, wird diese **IP** im Token **gespeichert**, und dann k√∂nnen Sie dieses Token von einer **nicht erlaubten IP verwenden, um auf die Ressourcen** zuzugreifen.
{% endhint %}

√úberpr√ºfen Sie die folgende Seite, um verschiedene M√∂glichkeiten zu lernen, **Zugriffstoken anzufordern** und sich mit ihnen anzumelden:

{% content-ref url="az-azuread/" %}
[az-azuread](az-azuread/)
{% endcontent-ref %}

Die h√§ufigsten API-Endpunkte sind:

* **Azure Resource Manager** (ARM): management.azure.com
* **Microsoft Graph**: graph.microsoft.com (Azure AD Graph, das veraltet ist, ist graph.windows.net)

## Referenzen

* [https://learn.microsoft.com/en-us/azure/governance/management-groups/overview](https://learn.microsoft.com/en-us/azure/governance/management-groups/overview)
* [https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/organize-subscriptions](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/organize-subscriptions)
* [https://abouttmc.com/glossary/azure-subscription/#:\~:text=An%20Azure%20subscription%20is%20a,the%20subscription%20it%20belongs%20to.](https://abouttmc.com/glossary/azure-subscription/)
* [https://learn.microsoft.com/en-us/azure/role-based-access-control/overview#how-azure-rbac-determines-if-a-user-has-access-to-a-resource](https://learn.microsoft.com/en-us/azure/role-based-access-control/overview#how-azure-rbac-determines-if-a-user-has-access-to-a-resource)

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
