# Az - SertifikayÄ± GeÃ§ir

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks EÄŸitimi AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitimi GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR'ler gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}

## SertifikayÄ± GeÃ§ir (Azure)

Azure'a katÄ±lan makinelerde, **NegoEx** kimlik doÄŸrulama mekanizmasÄ±nÄ± destekleyen her iki makineden birinden diÄŸerine sertifikalar kullanÄ±larak kimlik doÄŸrulamasÄ± yapmak mÃ¼mkÃ¼ndÃ¼r. Bu sertifikalar, gereken kullanÄ±cÄ± iÃ§in Azure AD CA tarafÄ±ndan verilmelidir (konu olarak).

SÃ¼per basitleÅŸtirilmiÅŸ terimlerle:

* BaÄŸlantÄ± baÅŸlatan makine (istemci) **kullanÄ±cÄ± iÃ§in Azure AD'den bir sertifikaya ihtiyaÃ§ duyar**.
* Ä°stemci, PRT ve diÄŸer detaylarÄ± iÃ§eren bir JSON Web Token (JWT) baÅŸlÄ±ÄŸÄ± oluÅŸturur, bunu TÃ¼retilmiÅŸ anahtarÄ± kullanarak (oturum anahtarÄ± ve gÃ¼venlik baÄŸlamÄ±nÄ± kullanarak) imzalar ve **Azure AD'ye gÃ¶nderir**.
* Azure AD, istemci oturum anahtarÄ± ve gÃ¼venlik baÄŸlamÄ±nÄ± kullanarak JWT imzasÄ±nÄ± doÄŸrular, PRT'nin geÃ§erliliÄŸini kontrol eder ve **sertifika ile yanÄ±t verir**.

Bu senaryoda ve [**PRT'yi GeÃ§ir**](pass-the-prt.md) saldÄ±rÄ±sÄ± iÃ§in gerekli tÃ¼m bilgileri topladÄ±ktan sonra:

* KullanÄ±cÄ± adÄ±
* KiracÄ± KimliÄŸi
* PRT
* GÃ¼venlik baÄŸlamÄ±
* TÃ¼retilmiÅŸ Anahtar

KullanÄ±cÄ± iÃ§in **P2P sertifikasÄ± talep etmek** mÃ¼mkÃ¼ndÃ¼r [**PrtToCert**](https://github.com/morRubin/PrtToCert)** aracÄ±yla:**

{% code overflow="wrap" %}
```bash
RequestCert.py [-h] --tenantId TENANTID --prt PRT --userName USERNAME --hexCtx HEXCTX --hexDerivedKey HEXDERIVEDKEY [--passPhrase PASSPHRASE]
```
{% endcode %}

Sertifikalar, PRT ile aynÄ± sÃ¼reyle geÃ§erli olacaktÄ±r. SertifikayÄ± kullanmak iÃ§in [**AzureADJoinedMachinePTC**](https://github.com/morRubin/AzureADJoinedMachinePTC) adlÄ± python aracÄ±nÄ± kullanabilirsiniz, bu araÃ§ uzak makineye **kimlik doÄŸrulamasÄ± yapacak**, **PSEXEC** Ã§alÄ±ÅŸtÄ±racak ve **kurban makinede bir CMD aÃ§acaktÄ±r**. Bu, bize Mimikatz'Ä± tekrar kullanma imkanÄ± verecektir ve baÅŸka bir kullanÄ±cÄ±nÄ±n PRT'sini alabileceÄŸiz.
```bash
Main.py [-h] --usercert USERCERT --certpass CERTPASS --remoteip REMOTEIP
```
## Referanslar

* Pass the Certificate'nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± daha detaylÄ± Ã¶ÄŸrenmek iÃ§in orijinal yazÄ±ya gÃ¶z atÄ±n [https://medium.com/@mor2464/azure-ad-pass-the-certificate-d0c5de624597](https://medium.com/@mor2464/azure-ad-pass-the-certificate-d0c5de624597)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR'ler gÃ¶ndererek **HackTricks** ve **HackTricks Cloud** github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}
