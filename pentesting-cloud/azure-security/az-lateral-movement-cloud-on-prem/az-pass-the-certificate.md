# Az - ì¸ì¦ì„œ ì „ë‹¬

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ **ê³µìœ **í•˜ì„¸ìš”.

</details>
{% endhint %}

## ì¸ì¦ì„œ ì „ë‹¬ (Azure)

Azureì— ê°€ì…ëœ ê¸°ê¸°ì—ì„œëŠ” **NegoEx** ì¸ì¦ ë©”ì»¤ë‹ˆì¦˜ì„ ì§€ì›í•˜ëŠ” ê²½ìš° **Azure AD CAì—ì„œ ë°œê¸‰**ëœ ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ì—¬ í•œ ê¸°ê¸°ì—ì„œ ë‹¤ë¥¸ ê¸°ê¸°ë¡œ ì¸ì¦í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

ë§¤ìš° ê°„ë‹¨íˆ ì„¤ëª…í•˜ë©´:

* ì—°ê²°ì„ ì‹œì‘í•˜ëŠ” ê¸°ê¸°(í´ë¼ì´ì–¸íŠ¸)ëŠ” **Azure ADì—ì„œ ì‚¬ìš©ìë¥¼ ìœ„í•´ ì¸ì¦ì„œê°€ í•„ìš”**í•©ë‹ˆë‹¤.
* í´ë¼ì´ì–¸íŠ¸ëŠ” PRT ë° ê¸°íƒ€ ì„¸ë¶€ ì •ë³´ë¥¼ í¬í•¨í•˜ëŠ” JSON Web Token (JWT) í—¤ë”ë¥¼ ìƒì„±í•˜ê³ , íŒŒìƒ í‚¤(ì„¸ì…˜ í‚¤ ë° ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œëª…í•˜ê³  **Azure ADë¡œ ì „ì†¡**í•©ë‹ˆë‹¤.
* Azure ADëŠ” í´ë¼ì´ì–¸íŠ¸ ì„¸ì…˜ í‚¤ ë° ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ JWT ì„œëª…ì„ í™•ì¸í•˜ê³ , PRTì˜ ìœ íš¨ì„±ì„ í™•ì¸í•˜ê³  **ì¸ì¦ì„œë¡œ ì‘ë‹µ**í•©ë‹ˆë‹¤.

ì´ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ [**PRT ì „ë‹¬**](pass-the-prt.md) ê³µê²©ì— í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¥¼ ìˆ˜ì§‘í•œ í›„:

* ì‚¬ìš©ì ì´ë¦„
* í…Œë„ŒíŠ¸ ID
* PRT
* ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸
* íŒŒìƒ í‚¤

**ì‚¬ìš©ìë¥¼ ìœ„í•œ P2P ì¸ì¦ì„œë¥¼ ìš”ì²­**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ [**PrtToCert**](https://github.com/morRubin/PrtToCert)** ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:**

{% code overflow="wrap" %}
```bash
RequestCert.py [-h] --tenantId TENANTID --prt PRT --userName USERNAME --hexCtx HEXCTX --hexDerivedKey HEXDERIVEDKEY [--passPhrase PASSPHRASE]
```
{% endcode %}

ì¸ì¦ì„œì˜ ìœ íš¨ ê¸°ê°„ì€ PRTì™€ ë™ì¼í•©ë‹ˆë‹¤. ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ python ë„êµ¬ [**AzureADJoinedMachinePTC**](https://github.com/morRubin/AzureADJoinedMachinePTC)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” ì›ê²© ì»´í“¨í„°ì— **ì¸ì¦**í•˜ê³ , **PSEXEC**ë¥¼ ì‹¤í–‰í•˜ê³ , í”¼í•´ì ì»´í“¨í„°ì—ì„œ **CMDë¥¼ ì—½ë‹ˆë‹¤**. ì´ë¥¼ í†µí•´ Mimikatzë¥¼ ë‹¤ì‹œ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ì‚¬ìš©ìì˜ PRTë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```bash
Main.py [-h] --usercert USERCERT --certpass CERTPASS --remoteip REMOTEIP
```
## ì°¸ê³  ìë£Œ

* Pass the Certificate ì‘ë™ ë°©ì‹ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ì›ë³¸ ê²Œì‹œë¬¼ì„ í™•ì¸í•˜ì„¸ìš”. [https://medium.com/@mor2464/azure-ad-pass-the-certificate-d0c5de624597](https://medium.com/@mor2464/azure-ad-pass-the-certificate-d0c5de624597)

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* í•´í‚¹ ìš”ë ¹ì„ ê³µìœ í•˜ë ¤ë©´ [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>
{% endhint %}
