# Az AD Connect - Hybrid Identity

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**рдСрди-рдкреНрд░рд┐рдорд╛рдЗрд╕реЗрд╕ рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА (AD)** рдФрд░ **Azure AD** рдХреЗ рдмреАрдЪ рдПрдХреАрдХрд░рдг **Azure AD Connect** рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ **рд╕рд┐рдВрдЧрд▓ рд╕рд╛рдЗрди-рдСрди (SSO)** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рддрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рдзрд┐, рдЬрдмрдХрд┐ рдЙрдкрдпреЛрдЧреА рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреА рд╣реИ рдЬреЛ рдХреНрд▓рд╛рдЙрдб рдпрд╛ рдСрди-рдкреНрд░рд┐рдорд╛рдЗрд╕реЗрд╕ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реЛрд╖рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

* **рдкрд╛рд╕-рдереНрд░реВ рдСрдереЗрдВрдЯрд┐рдХреЗрд╢рди (PTA)**:
* рдСрди-рдкреНрд░рд┐рдо AD рдкрд░ рдПрдЬреЗрдВрдЯ рдХрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдордЭреМрддрд╛, Azure рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдСрди-рдкреНрд░рд┐рдо рд╕реЗ рдХреНрд▓рд╛рдЙрдб)ред
* рдПрдХ рдирдП рд╕реНрдерд╛рди (рдХреНрд▓рд╛рдЙрдб рд╕реЗ рдСрди-рдкреНрд░рд┐рдо) рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдорд╛рдиреНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдП рдПрдЬреЗрдВрдЯ рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ред

{% content-ref url="pta-pass-through-authentication.md" %}
[pta-pass-through-authentication.md](pta-pass-through-authentication.md)
{% endcontent-ref %}

* **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢ рд╕рд┐рдВрдХ (PHS)**:
* AD рд╕реЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд╕реНрдкрд╖реНрдЯ-рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рдирд┐рд╖реНрдХрд░реНрд╖рдг, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЙрдЪреНрдЪ-рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд, рд╕реНрд╡-рдирд┐рд░реНрдорд┐рдд AzureAD рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

{% content-ref url="phs-password-hash-sync.md" %}
[phs-password-hash-sync.md](phs-password-hash-sync.md)
{% endcontent-ref %}

* **рдлреЗрдбрд░реЗрд╢рди**:
* SAML рд╕рд╛рдЗрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреА рдЪреЛрд░реА, рдСрди-рдкреНрд░рд┐рдо рдФрд░ рдХреНрд▓рд╛рдЙрдб рдкрд╣рдЪрд╛рди рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред

{% content-ref url="federation.md" %}
[federation.md](federation.md)
{% endcontent-ref %}

* **рд╕рд┐рдорд▓реЗрд╕ SSO:**
* `AZUREADSSOACC` рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЪреБрд░рд╛рдирд╛, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реНрдмреЗрд░реЛрд╕ рд╕рд┐рд▓реНрд╡рд░ рдЯрд┐рдХрдЯ рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХрд┐рд╕реА рднреА рдХреНрд▓рд╛рдЙрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

{% content-ref url="seamless-sso.md" %}
[seamless-sso.md](seamless-sso.md)
{% endcontent-ref %}

* **рдХреНрд▓рд╛рдЙрдб рдХрд░реНрдмреЗрд░реЛрд╕ рдЯреНрд░рд╕реНрдЯ**:
* AzureAD рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ SIDs рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рдХреЗ рдЧреНрд▓реЛрдмрд▓ рдПрдбрдорд┐рди рд╕реЗ рдСрди-рдкреНрд░рд┐рдо рдбреЛрдореЗрди рдПрдбрдорд┐рди рдореЗрдВ рдмрдврд╝рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдФрд░ AzureAD рд╕реЗ TGTs рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ред

{% content-ref url="az-cloud-kerberos-trust.md" %}
[az-cloud-kerberos-trust.md](az-cloud-kerberos-trust.md)
{% endcontent-ref %}

* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди**:
* рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рдпрд╛ рдСрди-рдкреНрд░рд┐рдорд┐рд╕ рд╕рд┐рдВрдХ рдЦрд╛рддрд╛ рдХрд╛ рд╕рдордЭреМрддрд╛ рдХрд░рдирд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕, рд╕рдореВрд╣ рд╕рджрд╕реНрдпрддрд╛, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ, SharePoint рд╕рд╛рдЗрдЯреЛрдВ рдФрд░ OneDrive рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

{% content-ref url="az-default-applications.md" %}
[az-default-applications.md](az-default-applications.md)
{% endcontent-ref %}

рдкреНрд░рддреНрдпреЗрдХ рдПрдХреАрдХрд░рдг рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдордиреНрд╡рдп рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдСрди-рдкреНрд░рд┐рдо AD рдореЗрдВ рдПрдХ `MSOL_<installationidentifier>` рдЦрд╛рддрд╛ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рджреЛрдиреЛрдВ **PHS** рдФрд░ **PTA** рд╡рд┐рдзрд┐рдпрд╛рдБ **рд╕рд┐рдорд▓реЗрд╕ SSO** рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ, рдЬреЛ рдСрди-рдкреНрд░рд┐рдо рдбреЛрдореЗрди рд╕реЗ рдЬреБрдбрд╝реЗ Azure AD рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕рд╛рдЗрди-рдЗрди рд╕рдХреНрд╖рдо рдХрд░рддреА рд╣реИрдВред

**Azure AD Connect** рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд PowerShell рдХрдорд╛рдВрдб, рдЬреЛ **AzureADConnectHealthSync** рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (рдЬреЛ Azure AD Connect рдХреЗ рд╕рд╛рде рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИ), рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```powershell
Get-ADSyncConnector
```
{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
