# Az AD Connect - ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã®ã‚µãƒãƒ¼ãƒˆ</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **HackTricks**ã¨**HackTricks Cloud**ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

**ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹Active Directory (AD)** ã¨ **Azure AD** ã®é–“ã®çµ±åˆã¯ã€**Azure AD Connect** ã«ã‚ˆã£ã¦å®¹æ˜“ã«è¡Œã‚ã‚Œã€**ã‚·ãƒ³ã‚°ãƒ«ã‚µã‚¤ãƒ³ã‚ªãƒ³ (SSO)** ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã•ã¾ã–ã¾ãªæ–¹æ³•ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚å„æ–¹æ³•ã¯æœ‰ç”¨ã§ã™ãŒã€ã‚¯ãƒ©ã‚¦ãƒ‰ã¾ãŸã¯ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ç’°å¢ƒã‚’å±é™ºã«ã•ã‚‰ã™å¯èƒ½æ€§ã®ã‚ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ãŒå­˜åœ¨ã—ã¾ã™ã€‚

* **Pass-Through Authentication (PTA)**:
- ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ADä¸Šã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå¦¥å”ã•ã‚Œã€Azureæ¥ç¶šã®ãŸã‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æ¤œè¨¼ãŒå¯èƒ½ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã‹ã‚‰ã‚¯ãƒ©ã‚¦ãƒ‰ã¸ï¼‰ã€‚
- æ–°ã—ã„å ´æ‰€ã§èªè¨¼ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã®æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ç™»éŒ²ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆã‚¯ãƒ©ã‚¦ãƒ‰ã‹ã‚‰ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã¸ï¼‰ã€‚

{% content-ref url="pta-pass-through-authentication.md" %}
[pta-pass-through-authentication.md](pta-pass-through-authentication.md)
{% endcontent-ref %}

* **Password Hash Sync (PHS)**:
- ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¯ãƒªã‚¢ãƒ†ã‚­ã‚¹ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒADã‹ã‚‰æŠ½å‡ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€é«˜ç‰¹æ¨©ã®è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸAzureADãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³‡æ ¼æƒ…å ±ã‚‚å«ã¾ã‚Œã¾ã™ã€‚

{% content-ref url="phs-password-hash-sync.md" %}
[phs-password-hash-sync.md](phs-password-hash-sync.md)
{% endcontent-ref %}

* **Federation**:
- SAMLç½²åã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã®ç›—é›£ã«ã‚ˆã‚Šã€ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ãŠã‚ˆã³ã‚¯ãƒ©ã‚¦ãƒ‰ã®ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ãªã‚Šã™ã¾ã™ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

{% content-ref url="federation.md" %}
[federation.md](federation.md)
{% endcontent-ref %}

* **Seamless SSO:**
- Kerberosã‚·ãƒ«ãƒãƒ¼ãƒã‚±ãƒƒãƒˆã«ç½²åã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹`AZUREADSSOACC`ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒç›—ã¾ã‚Œã€ä»»æ„ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãªã‚Šã™ã¾ã™ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

{% content-ref url="seamless-sso.md" %}
[seamless-sso.md](seamless-sso.md)
{% endcontent-ref %}

* **Cloud Kerberos Trust**:
- AzureADãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨SIDã‚’æ“ä½œã—ã€AzureADã‹ã‚‰TGTã‚’è¦æ±‚ã™ã‚‹ã“ã¨ã§ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ç®¡ç†è€…ã‹ã‚‰ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ãƒ‰ãƒ¡ã‚¤ãƒ³ç®¡ç†è€…ã«æ˜‡æ ¼ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

{% content-ref url="az-cloud-kerberos-trust.md" %}
[az-cloud-kerberos-trust.md](az-cloud-kerberos-trust.md)
{% endcontent-ref %}

* **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**:
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¾ãŸã¯ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹åŒæœŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å¦¥å”ã™ã‚‹ã¨ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¨­å®šã€ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€SharePointã‚µã‚¤ãƒˆã€OneDriveãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

{% content-ref url="az-default-applications.md" %}
[az-default-applications.md](az-default-applications.md)
{% endcontent-ref %}

å„çµ±åˆæ–¹æ³•ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åŒæœŸãŒå®Ÿè¡Œã•ã‚Œã€ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ADã«`MSOL_<installationidentifier>`ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ã€‚ç‰¹ã«ã€**PHS** ã¨ **PTA** æ–¹æ³•ã¯ **Seamless SSO** ã‚’å¯èƒ½ã«ã—ã€ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å‚åŠ ã—ãŸAzure ADã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã«è‡ªå‹•ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚’è¨±å¯ã—ã¾ã™ã€‚

**Azure AD Connect** ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®PowerShellã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€**AzureADConnectHealthSync** ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆAzure AD Connectã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ï¼‰ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚
```powershell
Get-ADSyncConnector
```
{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã®ã‚µãƒãƒ¼ãƒˆ</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ï¼
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
{% endhint %}
