# Az AD Connect - ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ±

**ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã®Active Directory (AD)** ã¨ **Azure AD** ã®çµ±åˆã¯ã€**Azure AD Connect** ã«ã‚ˆã£ã¦ä¿ƒé€²ã•ã‚Œã€**ã‚·ãƒ³ã‚°ãƒ«ã‚µã‚¤ãƒ³ã‚ªãƒ³ (SSO)** ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã•ã¾ã–ã¾ãªæ–¹æ³•ãŒæä¾›ã•ã‚Œã¾ã™ã€‚å„æ–¹æ³•ã¯ä¾¿åˆ©ã§ã™ãŒã€ã‚¯ãƒ©ã‚¦ãƒ‰ã¾ãŸã¯ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ç’°å¢ƒã‚’å±é™ºã«ã•ã‚‰ã™å¯èƒ½æ€§ã®ã‚ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

* **ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼èªè¨¼ (PTA)**:
* ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ADã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä¾µå®³ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€Azureæ¥ç¶šã®ãŸã‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æ¤œè¨¼ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ï¼ˆã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã‹ã‚‰ã‚¯ãƒ©ã‚¦ãƒ‰ã¸ï¼‰ã€‚
* æ–°ã—ã„å ´æ‰€ï¼ˆã‚¯ãƒ©ã‚¦ãƒ‰ã‹ã‚‰ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ï¼‰ã§èªè¨¼ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã«æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ç™»éŒ²ã™ã‚‹å¯èƒ½æ€§ã€‚

{% content-ref url="pta-pass-through-authentication.md" %}
[pta-pass-through-authentication.md](pta-pass-through-authentication.md)
{% endcontent-ref %}

* **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒæœŸ (PHS)**:
* é«˜ç‰¹æ¨©ã®è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸAzureADãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³‡æ ¼æƒ…å ±ã‚’å«ã‚€ã€ADã‹ã‚‰ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¹³æ–‡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æŠ½å‡ºã™ã‚‹å¯èƒ½æ€§ã€‚

{% content-ref url="phs-password-hash-sync.md" %}
[phs-password-hash-sync.md](phs-password-hash-sync.md)
{% endcontent-ref %}

* **ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:
* SAMLç½²åã«ä½¿ç”¨ã•ã‚Œã‚‹ç§˜å¯†éµã®ç›—é›£ã«ã‚ˆã‚Šã€ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ãŠã‚ˆã³ã‚¯ãƒ©ã‚¦ãƒ‰ã®ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å½è£…ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

{% content-ref url="federation.md" %}
[federation.md](federation.md)
{% endcontent-ref %}

* **ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹SSO:**
* Kerberosã‚·ãƒ«ãƒãƒ¼ãƒã‚±ãƒƒãƒˆã®ç½²åã«ä½¿ç”¨ã•ã‚Œã‚‹ `AZUREADSSOACC` ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ç›—é›£ã«ã‚ˆã‚Šã€ä»»æ„ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å½è£…ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

{% content-ref url="seamless-sso.md" %}
[seamless-sso.md](seamless-sso.md)
{% endcontent-ref %}

* **ã‚¯ãƒ©ã‚¦ãƒ‰Kerberosä¿¡é ¼**:
* AzureADãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨SIDã‚’æ“ä½œã—ã€AzureADã‹ã‚‰TGTã‚’è¦æ±‚ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ç®¡ç†è€…ã‹ã‚‰ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ãƒ‰ãƒ¡ã‚¤ãƒ³ç®¡ç†è€…ã«æ˜‡æ ¼ã™ã‚‹å¯èƒ½æ€§ã€‚

{% content-ref url="az-cloud-kerberos-trust.md" %}
[az-cloud-kerberos-trust.md](az-cloud-kerberos-trust.md)
{% endcontent-ref %}

* **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**:
* ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¾ãŸã¯ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã®åŒæœŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¾µå®³ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¨­å®šã€ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€SharePointã‚µã‚¤ãƒˆã€ãŠã‚ˆã³OneDriveãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

{% content-ref url="az-default-applications.md" %}
[az-default-applications.md](az-default-applications.md)
{% endcontent-ref %}

å„çµ±åˆæ–¹æ³•ã«å¯¾ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŒæœŸãŒè¡Œã‚ã‚Œã€ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ADã« `MSOL_<installationidentifier>` ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ã€‚ç‰¹ã«ã€**PHS** ã¨ **PTA** ã®ä¸¡æ–¹ã®æ–¹æ³•ã¯ **ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹SSO** ã‚’ä¿ƒé€²ã—ã€ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å‚åŠ ã—ã¦ã„ã‚‹Azure ADã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®è‡ªå‹•ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

**Azure AD Connect** ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®PowerShellã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€**AzureADConnectHealthSync** ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆAzure AD Connectã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ï¼‰ã‚’åˆ©ç”¨ã—ã¾ã™ï¼š
```powershell
Get-ADSyncConnector
```
{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
