# Az - Queue Persistance

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Queue

ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

{% content-ref url="../az-services/az-queue-enum.md" %}
[az-queue-enum.md](../az-services/az-queue-enum.md)
{% endcontent-ref %}



### Actions: `Microsoft.Storage/storageAccounts/queueServices/queues/write`

ì´ ê¶Œí•œì€ ê³µê²©ìê°€ ìŠ¤í† ë¦¬ì§€ ê³„ì • ë‚´ì—ì„œ í ë° ê·¸ ì†ì„±ì„ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë¬´ë‹¨ íë¥¼ ìƒì„±í•˜ê±°ë‚˜ ë©”íƒ€ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ ì ‘ê·¼ ì œì–´ ëª©ë¡(ACL)ì„ ë³€ê²½í•˜ì—¬ ì ‘ê·¼ì„ í—ˆìš©í•˜ê±°ë‚˜ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ì›Œí¬í”Œë¡œë¥¼ ë°©í•´í•˜ê±°ë‚˜ ì•…ì„± ë°ì´í„°ë¥¼ ì£¼ì…í•˜ê±°ë‚˜ ë¯¼ê°í•œ ì •ë³´ë¥¼ ìœ ì¶œí•˜ê±°ë‚˜ í ì„¤ì •ì„ ì¡°ì‘í•˜ì—¬ ì¶”ê°€ ê³µê²©ì„ ê°€ëŠ¥í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az storage queue create --name <new-queue-name> --account-name <storage-account>

az storage queue metadata update --name <queue-name> --metadata key1=value1 key2=value2 --account-name <storage-account>

az storage queue policy set --name <queue-name> --permissions rwd --expiry 2024-12-31T23:59:59Z --account-name <storage-account>
```
{% endcode %}

### Actions: `Microsoft.Storage/storageAccounts/queueServices/queues/setAcl/action`

ì´ ê¶Œí•œì„ í†µí•´ ê³µê²©ìëŠ” Azure Storage Queueì˜ ì ‘ê·¼ ì œì–´ ëª©ë¡(ACL)ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ê³µìœ  ì•¡ì„¸ìŠ¤ ì„œëª…ê³¼ í•¨ê»˜ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê³µê²©ìëŠ” ìì‹ ì´ë‚˜ ë‹¤ë¥¸ ì•…ì˜ì ì¸ ì‚¬ìš©ìì—ê²Œ íì— ëŒ€í•œ ì§€ì†ì ì¸ ì•¡ì„¸ìŠ¤ë¥¼ ë¶€ì—¬í•  ìˆ˜ ìˆìœ¼ë©°, ì •ë‹¹í•œ ì•¡ì„¸ìŠ¤ ìê²© ì¦ëª…ì´ ì·¨ì†Œë˜ë”ë¼ë„ ê³„ì†í•´ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬´ë‹¨ ì ‘ê·¼ì„ ìœ ì§€í•¨ìœ¼ë¡œì¨, ê·¸ë“¤ì€ ì§€ì†ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ëª¨ë‹ˆí„°ë§, ì¡°ì‘ ë˜ëŠ” ìœ ì¶œí•  ìˆ˜ ìˆìœ¼ë©°, ìì‹ ì˜ ì¡´ì¬ê°€ ê°ì§€ë˜ì§€ ì•Šê³  ì‘ì—… íë¦„ì´ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì¤‘ë‹¨ë˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
az storage queue policy create \
--queue-name <QUEUE_NAME> \
--account-name <STORAGE_ACCOUNT_NAME> \
--account-key <STORAGE_ACCOUNT_KEY> \
--name <POLICY_NAME> \
--permission <PERMISSIONS> \
--start <START_TIME> \
--expiry <EXPIRY_TIME>
```
## References

* https://learn.microsoft.com/en-us/azure/storage/queues/storage-powershell-how-to-use-queues
* https://learn.microsoft.com/en-us/rest/api/storageservices/queue-service-rest-api
* https://learn.microsoft.com/en-us/azure/storage/queues/queues-auth-abac-attributes

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop)ì„ í™•ì¸í•˜ì„¸ìš”!
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
