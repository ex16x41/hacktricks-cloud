# Az - Queue Persistance

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## Queue

æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../az-services/az-queue-enum.md" %}
[az-queue-enum.md](../az-services/az-queue-enum.md)
{% endcontent-ref %}



### Actions: `Microsoft.Storage/storageAccounts/queueServices/queues/write`

æ­¤æƒé™å…è®¸æ”»å‡»è€…åœ¨å­˜å‚¨å¸æˆ·å†…åˆ›å»ºæˆ–ä¿®æ”¹é˜Ÿåˆ—åŠå…¶å±æ€§ã€‚å®ƒå¯ç”¨äºåˆ›å»ºæœªç»æˆæƒçš„é˜Ÿåˆ—ã€ä¿®æ”¹å…ƒæ•°æ®æˆ–æ›´æ”¹è®¿é—®æ§åˆ¶åˆ—è¡¨ (ACL) ä»¥æˆäºˆæˆ–é™åˆ¶è®¿é—®ã€‚æ­¤èƒ½åŠ›å¯èƒ½ä¼šå¹²æ‰°å·¥ä½œæµç¨‹ã€æ³¨å…¥æ¶æ„æ•°æ®ã€å¤–æ³„æ•æ„Ÿä¿¡æ¯æˆ–æ“çºµé˜Ÿåˆ—è®¾ç½®ä»¥å¯ç”¨è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

{% code overflow="wrap" %}
```bash
az storage queue create --name <new-queue-name> --account-name <storage-account>

az storage queue metadata update --name <queue-name> --metadata key1=value1 key2=value2 --account-name <storage-account>

az storage queue policy set --name <queue-name> --permissions rwd --expiry 2024-12-31T23:59:59Z --account-name <storage-account>
```
{% endcode %}

### Actions: `Microsoft.Storage/storageAccounts/queueServices/queues/setAcl/action`

é€šè¿‡æ­¤æƒé™ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹ Azure å­˜å‚¨é˜Ÿåˆ—çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ (ACL)ï¼Œè¯¥åˆ—è¡¨å¯ä¸å…±äº«è®¿é—®ç­¾åä¸€èµ·ä½¿ç”¨ã€‚è¿™ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿæˆäºˆè‡ªå·±æˆ–å…¶ä»–æ¶æ„ç”¨æˆ·å¯¹é˜Ÿåˆ—çš„æŒä¹…è®¿é—®ï¼Œå³ä½¿åˆæ³•è®¿é—®å‡­æ®è¢«æ’¤é”€ã€‚é€šè¿‡ç»´æŒæœªæˆæƒçš„è®¿é—®ï¼Œä»–ä»¬å¯ä»¥æŒç»­ç›‘æ§ã€æ“çºµæˆ–å¤–æ³„æ•°æ®ï¼Œç¡®ä¿ä»–ä»¬çš„å­˜åœ¨ä¿æŒéšè”½ï¼Œå¹¶éšç€æ—¶é—´çš„æ¨ç§»ç ´åå·¥ä½œæµç¨‹ã€‚

{% code overflow="wrap" %}
```bash
az storage queue policy create \
--queue-name <QUEUE_NAME> \
--account-name <STORAGE_ACCOUNT_NAME> \
--account-key <STORAGE_ACCOUNT_KEY> \
--name <POLICY_NAME> \
--permission <PERMISSIONS> \
--start <START_TIME> \
--expiry <EXPIRY_TIME>
```
## å‚è€ƒæ–‡çŒ®

* https://learn.microsoft.com/en-us/azure/storage/queues/storage-powershell-how-to-use-queues
* https://learn.microsoft.com/en-us/rest/api/storageservices/queue-service-rest-api
* https://learn.microsoft.com/en-us/azure/storage/queues/queues-auth-abac-attributes

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚
