# Az - Key Vault Post Exploitation

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## Azure Key Vault

æœ‰å…³æ­¤æœåŠ¡çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../az-services/keyvault.md" %}
[keyvault.md](../az-services/keyvault.md)
{% endcontent-ref %}

### Microsoft.KeyVault/vaults/secrets/getSecret/action

æ­¤æƒé™å°†å…è®¸ä¸»ä½“è¯»å–ç§˜å¯†çš„å€¼ï¼š 

{% code overflow="wrap" %}
```bash
az keyvault secret show --vault-name <vault name> --name <secret name>

# Get old version secret value
az keyvault secret show --id https://<KeyVaultName>.vault.azure.net/secrets/<KeyVaultName>/<idOldVersion>
```
{% endcode %}

### **Microsoft.KeyVault/vaults/certificates/purge/action**

æ­¤æƒé™å…è®¸ä¸»ä½“ä»ä¿ç®¡åº“ä¸­æ°¸ä¹…åˆ é™¤è¯ä¹¦ã€‚
```bash
az keyvault certificate purge --vault-name <vault name> --name <certificate name>
```
### **Microsoft.KeyVault/vaults/keys/encrypt/action**

æ­¤æƒé™å…è®¸ä¸»ä½“ä½¿ç”¨å­˜å‚¨åœ¨ä¿ç®¡åº“ä¸­çš„å¯†é’¥åŠ å¯†æ•°æ®ã€‚

{% code overflow="wrap" %}
```bash
az keyvault key encrypt --vault-name <vault name> --name <key name> --algorithm <algorithm> --value <value>

# Example
echo "HackTricks" | base64 # SGFja1RyaWNrcwo=
az keyvault key encrypt --vault-name testing-1231234 --name testing --algorithm RSA-OAEP-256 --value SGFja1RyaWNrcwo=
```
{% endcode %}

### **Microsoft.KeyVault/vaults/keys/decrypt/action**

æ­¤æƒé™å…è®¸ä¸»ä½“ä½¿ç”¨å­˜å‚¨åœ¨ä¿ç®¡åº“ä¸­çš„å¯†é’¥è§£å¯†æ•°æ®ã€‚

{% code overflow="wrap" %}
```bash
az keyvault key decrypt --vault-name <vault name> --name <key name> --algorithm <algorithm> --value <value>

# Example
az keyvault key decrypt --vault-name testing-1231234 --name testing --algorithm RSA-OAEP-256 --value "ISZ+7dNcDJXLPR5MkdjNvGbtYK3a6Rg0ph/+3g1IoUrCwXnF791xSF0O4rcdVyyBnKRu0cbucqQ/+0fk2QyAZP/aWo/gaxUH55pubS8Zjyw/tBhC5BRJiCtFX4tzUtgTjg8lv3S4SXpYUPxev9t/9UwUixUlJoqu0BgQoXQhyhP7PfgAGsxayyqxQ8EMdkx9DIR/t9jSjv+6q8GW9NFQjOh70FCjEOpYKy9pEGdLtPTrirp3fZXgkYfIIV77TXuHHdR9Z9GG/6ge7xc9XT6X9ciE7nIXNMQGGVCcu3JAn9BZolb3uL7PBCEq+k2rH4tY0jwkxinM45tg38Re2D6CEA==" # This is the result from the previous encryption
```
{% endcode %}

### **Microsoft.KeyVault/vaults/keys/purge/action**

æ­¤æƒé™å…è®¸ä¸»ä½“ä»ä¿ç®¡åº“ä¸­æ°¸ä¹…åˆ é™¤å¯†é’¥ã€‚
```bash
az keyvault key purge --vault-name <vault name> --name <key name>
```
### **Microsoft.KeyVault/vaults/secrets/purge/action**

æ­¤æƒé™å…è®¸ä¸»ä½“ä»ä¿ç®¡åº“ä¸­æ°¸ä¹…åˆ é™¤ä¸€ä¸ªç§˜å¯†ã€‚
```bash
az keyvault secret purge --vault-name <vault name> --name <secret name>
```
### **Microsoft.KeyVault/vaults/secrets/setSecret/action**

æ­¤æƒé™å…è®¸ä¸»ä½“åœ¨ä¿ç®¡åº“ä¸­åˆ›å»ºæˆ–æ›´æ–°ä¸€ä¸ªç§˜å¯†ã€‚

{% code overflow="wrap" %}
```bash
az keyvault secret set --vault-name <vault name> --name <secret name> --value <secret value>
```
{% endcode %}

### **Microsoft.KeyVault/vaults/certificates/delete**

æ­¤æƒé™å…è®¸ä¸»ä½“ä»ä¿ç®¡åº“ä¸­åˆ é™¤è¯ä¹¦ã€‚è¯ä¹¦è¢«ç§»åŠ¨åˆ°â€œè½¯åˆ é™¤â€çŠ¶æ€ï¼Œåœ¨æ­¤çŠ¶æ€ä¸‹å¯ä»¥æ¢å¤ï¼Œé™¤éè¢«æ¸…é™¤ã€‚

{% code overflow="wrap" %}
```bash
az keyvault certificate delete --vault-name <vault name> --name <certificate name>
```
{% endcode %}

### **Microsoft.KeyVault/vaults/keys/delete**

æ­¤æƒé™å…è®¸ä¸»ä½“ä»ä¿ç®¡åº“ä¸­åˆ é™¤å¯†é’¥ã€‚å¯†é’¥è¢«ç§»åŠ¨åˆ°â€œè½¯åˆ é™¤â€çŠ¶æ€ï¼Œåœ¨æ­¤çŠ¶æ€ä¸‹å¯ä»¥æ¢å¤ï¼Œé™¤éè¢«æ¸…é™¤ã€‚
```bash
az keyvault key delete --vault-name <vault name> --name <key name>
```
### **Microsoft.KeyVault/vaults/secrets/delete**

æ­¤æƒé™å…è®¸ä¸»ä½“ä»ä¿ç®¡åº“ä¸­åˆ é™¤ä¸€ä¸ªç§˜å¯†ã€‚è¯¥ç§˜å¯†è¢«ç§»åŠ¨åˆ°â€œè½¯åˆ é™¤â€çŠ¶æ€ï¼Œåœ¨æ­¤çŠ¶æ€ä¸‹å¯ä»¥æ¢å¤ï¼Œé™¤éè¢«æ¸…é™¤ã€‚
```bash
az keyvault secret delete --vault-name <vault name> --name <secret name>
```
### Microsoft.KeyVault/vaults/secrets/restore/action

æ­¤æƒé™å…è®¸ä¸»ä½“ä»å¤‡ä»½ä¸­æ¢å¤ä¸€ä¸ªç§˜å¯†ã€‚
```bash
az keyvault secret restore --vault-name <vault-name> --file <backup-file-path>
```
{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
