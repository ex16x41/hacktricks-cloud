# Î‘Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ· Î£Ï…Î½Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ Cloud Ï„Î¿Ï… GCP

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Hacking Ï„Î¿Ï… AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ· HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ Hacking Ï„Î¿Ï… GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ· HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ** ÏƒÏ„Î·Î½ ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± Ï‡Î¬ÎºÎµÏ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs** ÏƒÏ„Î± Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ Ï„Î¿Ï… [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Î£Ï…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Cloud <a href="#reviewing-cloud-functions" id="reviewing-cloud-functions"></a>

[ÎŸÎ¹ Google Cloud Functions](https://cloud.google.com/functions/) ÎµÎ¯Î½Î±Î¹ ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½ÎµÏ‚ Î³Î¹Î± Î½Î± Ï†Î¹Î»Î¿Î¾ÎµÎ½Î¿ÏÎ½ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ¬ ÏƒÎ±Ï‚, Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ **ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Ï‰Ï‚ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· ÏƒÎµ ÏƒÏ…Î¼Î²Î¬Î½Ï„Î±**, Ï‡Ï‰ÏÎ¯Ï‚ Ï„Î·Î½ Î±Î½Î¬Î³ÎºÎ· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ ÎµÎ½ÏŒÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ¿Ï ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ Ï†Î¹Î»Î¿Î¾ÎµÎ½Î¯Î±Ï‚. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î±Ï…Ï„Î­Ï‚ Î¿Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î¿Ï‚, Ï„Î¹Ï‚ Î¿Ï€Î¿Î¯ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚.

### Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·

ÎŸ **ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï„Ï‰Î½ Cloud Functions Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÏ„Î¿ GCP Storage**. Î£Ï…Î½ÎµÏ€ÏÏ‚, Î¿Ï€Î¿Î¹Î¿ÏƒÎ´Î®Ï€Î¿Ï„Îµ Î¼Îµ **Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·Ï‚ ÏƒÎµ ÎºÎ¬Î´Î¿Ï…Ï‚** ÏƒÏ„Î¿ GCP Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Î´Î¹Î±Î²Î¬ÏƒÎµÎ¹ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Ï„Ï‰Î½ Cloud Functions**.\
ÎŸ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÎµ Î­Î½Î±Î½ ÎºÎ¬Î´Î¿ ÏŒÏ€Ï‰Ï‚:

`gcf-sources-<Î±ÏÎ¹Î¸Î¼ÏŒÏ‚>-<Ï€ÎµÏÎ¹Î¿Ï‡Î®>/<ÏŒÎ½Î¿Î¼Î±-ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚>-<uuid>/Î­ÎºÎ´Î¿ÏƒÎ·-<n>/ÎºÏÎ´Î¹ÎºÎ±Ï‚-ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚.zip`\
Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:\
`gcf-sources-645468741258-us-central1/function-1-003dcbdf-32e1-430f-a5ff-785a6e238c76/version-4/function-source.zip`

{% hint style="warning" %}
ÎŸÏ€Î¿Î¹Î¿ÏƒÎ´Î®Ï€Î¿Ï„Îµ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Îµ **Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚ ÏƒÏ„Î¿Î½ ÎºÎ¬Î´Î¿** Ï€Î¿Ï… Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï„Î· Cloud Function Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Ï„Î¿Î½ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ¼ÎµÎ½Î¿ ÎºÏÎ´Î¹ÎºÎ±**.
{% endhint %}

### SA

Î‘Î½ Î´ÎµÎ½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬, Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Ï„Î¿ **Î ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ Ï„Î¿Ï… App Engine** Î¼Îµ **Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÏ„Î®** Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿ Î­ÏÎ³Î¿ Î¸Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Îµ Ï„Î· Cloud Function.

### Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Ï„Î­Ï‚, URL & Î¤Î±Ï…Ï„Î¿Ï€Î¿Î¯Î·ÏƒÎ·

ÎŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± Cloud Function Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î¿ **ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Ï„Î®Ï‚**. ÎˆÎ½Î±Ï‚ ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ **HTTPS**, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î­Î½Î± URL ÏŒÏ€Î¿Ï… Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¼Î­ÏƒÏ‰ Ï€ÎµÏÎ¹Î®Î³Î·ÏƒÎ·Ï‚ ÏƒÏ„Î¿Î½ Î¹ÏƒÏ„ÏŒ.\
Î†Î»Î»Î¿Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Ï„Î­Ï‚ ÎµÎ¯Î½Î±Î¹ pub/sub, Storage, Filestore...

Î— Î¼Î¿ÏÏ†Î® Ï„Î¿Ï… URL ÎµÎ¯Î½Î±Î¹ **`https://<Ï€ÎµÏÎ¹Î¿Ï‡Î®>-<ÏŒÎ½Î¿Î¼Î±-Î­ÏÎ³Î¿Ï…-gcp>.cloudfunctions.net/<ÏŒÎ½Î¿Î¼Î±-ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚>`**

ÎŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¿ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Ï„Î®Ï‚ HTTPS, ÎµÏ€Î¯ÏƒÎ·Ï‚ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÏ„Î±Î¹ Î±Î½ Î¿ **ÎºÎ±Î»Î¿ÏÎ½Ï„Î±Ï‚ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î¬Î´ÎµÎ¹Î± IAM** Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Ï„Î· Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ· Î® Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î·Î½ ÎºÎ±Î»Î­ÏƒÎµÎ¹ **Î¿Ï€Î¿Î¹Î¿ÏƒÎ´Î®Ï€Î¿Ï„Îµ**:

<figure><img src="../../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

### ÎœÎ­ÏƒÎ± ÏƒÏ„Î· Cloud Function

ÎŸ ÎºÏÎ´Î¹ÎºÎ±Ï‚ **ÎºÎ±Ï„ÎµÎ²Î±Î¯Î½ÎµÎ¹ Î¼Î­ÏƒÎ±** ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ **`/workspace`** Î¼Îµ Ï„Î± Î¯Î´Î¹Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÏŒÏ€Ï‰Ï‚ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± ÏƒÏ„Î· Cloud Function ÎºÎ±Î¹ ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Î±Î¹ Î¼Îµ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î· `www-data`.\
Î¤Î¿ Î´Î¯ÏƒÎºÎ¿Ï‚ **Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¼Î­Î½Î¿Ï‚ Ï‰Ï‚ Î¼ÏŒÎ½Î¿ Î³Î¹Î± Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·.**

### Î‘Ï€Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·
```bash
# List functions
gcloud functions list
gcloud functions describe <func_name> # Check triggers to see how is this function invoked
gcloud functions get-iam-policy <func_name>

# Get logs of previous runs. By default, limits to 10 lines
gcloud functions logs read <func_name> --limit [NUMBER]

# Call a function
curl https://<region>-<project>.cloudfunctions.net/<func_name>
gcloud functions call <func_name> --data='{"message": "Hello World!"}'

# If you know the name of projects you could try to BF cloud functions names

# Get events that could be used to trigger a cloud function
gcloud functions event-types list

# Access function with authentication
curl -X POST https://<region>-<project>.cloudfunctions.net/<func_name> \
-H "Authorization: bearer $(gcloud auth print-identity-token)" \
-H "Content-Type: application/json" \
-d '{}'
```
### Î•scalation Ï€ÏÎ¿Î½Î¿Î¼Î¯Ï‰Î½

Î£Ï„Î·Î½ Î±ÎºÏŒÎ»Î¿Ï…Î¸Î· ÏƒÎµÎ»Î¯Î´Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï€ÏÏ‚ Î½Î± **ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± Ï„Ï‰Î½ cloud functions Î³Î¹Î± Îµscalation Ï€ÏÎ¿Î½Î¿Î¼Î¯Ï‰Î½**:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-cloudfunctions-privesc.md" %}
[gcp-cloudfunctions-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-cloudfunctions-privesc.md)
{% endcontent-ref %}

### ÎœÎ· ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´Î¿Ï„Î·Î¼Î­Î½Î· Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·

{% content-ref url="../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-functions-unauthenticated-enum.md" %}
[gcp-cloud-functions-unauthenticated-enum.md](../../gcp-security/gcp-unaunthenticated-enum-and-access/gcp-cloud-functions-unauthenticated-enum.md)
{% endcontent-ref %}

### ÎœÎµÏ„Î¬ Î±Ï€ÏŒ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ·

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-cloud-functions-post-exploitation.md" %}
[gcp-cloud-functions-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-cloud-functions-post-exploitation.md)
{% endcontent-ref %}

### Î”Î¹Î±Ï„Î®ÏÎ·ÏƒÎ·

{% content-ref url="../../gcp-security/gcp-persistence/gcp-cloud-functions-persistence.md" %}
[gcp-cloud-functions-persistence.md](../../gcp-security/gcp-persistence/gcp-cloud-functions-persistence.md)
{% endcontent-ref %}

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/#reviewing-stackdriver-logging](https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/#reviewing-stackdriver-logging)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾Ï„Îµ Ï„Î¿ HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ** ğŸ’¬ ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î± [**Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î± [**telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ hacking tricks Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± ÏƒÏ„Î¿ GitHub.

</details>
{% endhint %}
