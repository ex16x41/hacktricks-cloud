# Pentesting Cloud Methodology

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/CLOUD-logo-letters.svg" alt=""><figcaption></figcaption></figure>

## åŸºæœ¬çš„ãªæ–¹æ³•è«–

å„ã‚¯ãƒ©ã‚¦ãƒ‰ã«ã¯ç‹¬è‡ªã®ç‰¹æ€§ãŒã‚ã‚Šã¾ã™ãŒã€ä¸€èˆ¬çš„ã«ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹éš›ã«**ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ãŒç¢ºèªã™ã¹ãå…±é€šã®äº‹é …**ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã™ï¼š

* **ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒã‚§ãƒƒã‚¯**
* ã“ã‚Œã«ã‚ˆã‚Šã€**ç’°å¢ƒã®è¦æ¨¡**ã‚„**ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹**ã‚’ç†è§£ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚
* ã»ã¨ã‚“ã©ã®ãƒ†ã‚¹ãƒˆã‚’**è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«**ã§å®Ÿè¡Œã§ãã‚‹ãŸã‚ã€ã„ãã¤ã‹ã®**è¿…é€Ÿãªèª¤è¨­å®š**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
* **ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ—æŒ™**
* ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã‚’æ­£ã—ãå®Ÿæ–½ã—ã¦ã„ã‚Œã°ã€ã“ã“ã§è¦‹ã¤ã‹ã‚‹èª¤è¨­å®šã¯ã‚ã¾ã‚Šãªã„ã§ã—ã‚‡ã†ãŒã€ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã§æ¢ã•ã‚Œã¦ã„ãªã‹ã£ãŸã‚‚ã®ãŒè¦‹ã¤ã‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
* ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã§**ä½•ãŒæ­£ç¢ºã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹**ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å¤§ã„ã«å½¹ç«‹ã¡ã¾ã™ã€‚
* **å…¬é–‹ã•ã‚Œã¦ã„ã‚‹è³‡ç”£ã®ç¢ºèª**
* ã“ã‚Œã¯å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è¡Œã†ã“ã¨ãŒã§ãã€**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«æ½œåœ¨çš„ã«å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚‚ã®**ã‚’è¦‹ã¤ã‘å‡ºã—ã€ã©ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
* ã“ã“ã§ã¯ã€**æ‰‹å‹•ã§å…¬é–‹ã•ã‚ŒãŸã‚¤ãƒ³ãƒ•ãƒ©**ï¼ˆã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚’æŒã¤ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚„ä»–ã®ãƒãƒ¼ãƒˆãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ï¼‰ã‚„ã€**å…¬é–‹ã•ã‚Œã‚‹ã‚ˆã†ã«è¨­å®šã§ãã‚‹ä»–ã®ã‚¯ãƒ©ã‚¦ãƒ‰ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹**ï¼ˆDBã‚„ãƒã‚±ãƒƒãƒˆãªã©ï¼‰ã«ã¤ã„ã¦å–ã‚Šä¸Šã’ã¦ã„ã¾ã™ã€‚
* æ¬¡ã«ã€ãã®ãƒªã‚½ãƒ¼ã‚¹ãŒ**å…¬é–‹å¯èƒ½ã‹ã©ã†ã‹**ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆæ©Ÿå¯†æƒ…å ±ï¼Ÿè„†å¼±æ€§ï¼Ÿå…¬é–‹ã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã®èª¤è¨­å®šï¼Ÿï¼‰ã€‚
* **æ¨©é™ã®ç¢ºèª**
* ã“ã“ã§ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰å†…ã®å„ãƒ­ãƒ¼ãƒ«/ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®**ã™ã¹ã¦ã®æ¨©é™**ã‚’è¦‹ã¤ã‘å‡ºã—ã€ãã‚ŒãŒã©ã®ã‚ˆã†ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
* **éå¸¸ã«ç‰¹æ¨©ã®é«˜ã„**ï¼ˆã™ã¹ã¦ã‚’åˆ¶å¾¡ã™ã‚‹ï¼‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¤šã™ãã‚‹ï¼Ÿç”Ÿæˆã•ã‚ŒãŸã‚­ãƒ¼ãŒä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ï¼Ÿ... ã“ã‚Œã‚‰ã®ãƒã‚§ãƒƒã‚¯ã®ã»ã¨ã‚“ã©ã¯ã™ã§ã«ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã§è¡Œã‚ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚
* ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒOpenIDã‚„SAMLãªã©ã®**ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€**å„ãƒ­ãƒ¼ãƒ«ãŒã©ã®ã‚ˆã†ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã‹**ã«ã¤ã„ã¦ã•ã‚‰ã«**æƒ…å ±**ã‚’æ±‚ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆç®¡ç†è€…ãƒ­ãƒ¼ãƒ«ãŒ1äººã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¨100äººã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¯åŒã˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚
* **ç®¡ç†è€…**æ¨©é™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ**ã©ã‚Œã ã‘ã„ã‚‹ã‹**ã‚’è¦‹ã¤ã‘ã‚‹ã ã‘ã§ã¯**ä¸ååˆ†**ã§ã™ã€‚ä½¿ç”¨ã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚ˆã£ã¦ã¯ã€éå¸¸ã«**æ•æ„Ÿãª**ä»–ã®**æ¨©é™**ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚
* ã•ã‚‰ã«ã€æ¨©é™ã‚’æ‚ªç”¨ã™ã‚‹**æ½œåœ¨çš„ãªç‰¹æ¨©æ˜‡æ ¼**ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã™ã¹ã¦ã®ã“ã¨ã‚’è€ƒæ…®ã«å…¥ã‚Œã€**ã§ãã‚‹ã ã‘å¤šãã®ç‰¹æ¨©æ˜‡æ ¼ãƒ‘ã‚¹**ã‚’å ±å‘Šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
* **çµ±åˆã®ç¢ºèª**
* **ä»–ã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚„SaaSã¨ã®çµ±åˆ**ãŒã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒå†…ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒéå¸¸ã«é«˜ã„ã§ã™ã€‚
* **ç›£æŸ»ã—ã¦ã„ã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰ã®çµ±åˆ**ã«ã¤ã„ã¦ã¯ã€ãã®çµ±åˆã‚’**ï¼ˆæ‚ªç”¨ï¼‰ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã¤äºº**ã‚’é€šçŸ¥ã—ã€å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒ**ã©ã‚Œã ã‘æ•æ„Ÿ**ã§ã‚ã‚‹ã‹ã‚’å°‹ã­ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\
ä¾‹ãˆã°ã€GCPãŒãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ã‚‹AWSãƒã‚±ãƒƒãƒˆã«æ›¸ãè¾¼ã‚€ã“ã¨ãŒã§ãã‚‹ã®ã¯èª°ã‹ï¼ˆGCPã§ãã®ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†éš›ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æ•æ„Ÿã•ã‚’å°‹ã­ã‚‹ï¼‰ã€‚
* **ç›£æŸ»ã—ã¦ã„ã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰å†…ã®çµ±åˆ**ã«ã¤ã„ã¦ã¯ã€å¤–éƒ¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰**ï¼ˆæ‚ªç”¨ï¼‰ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã¤äºº**ã‚’å°‹ã­ã€ãã®ãƒ‡ãƒ¼ã‚¿ãŒã©ã®ã‚ˆã†ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\
ä¾‹ãˆã°ã€ã‚µãƒ¼ãƒ“ã‚¹ãŒGCRã«ãƒ›ã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ãã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å¤‰æ›´ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã¤ã®ã¯èª°ã‹ã€AWSã‚¯ãƒ©ã‚¦ãƒ‰å†…ã§å®Ÿè¡Œã•ã‚Œã‚‹éš›ã«ãã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒã©ã®ã‚ˆã†ãªæ©Ÿå¯†æƒ…å ±ã‚„ã‚¢ã‚¯ã‚»ã‚¹ã‚’å¾—ã‚‹ã‹ã‚’å°‹ã­ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## ãƒãƒ«ãƒã‚¯ãƒ©ã‚¦ãƒ‰ãƒ„ãƒ¼ãƒ«

ç•°ãªã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã¨ãƒªãƒ³ã‚¯ãŒç¤ºã•ã‚Œã¾ã™ã€‚

### [PurplePanda](https://github.com/carlospolop/purplepanda)

ã‚¯ãƒ©ã‚¦ãƒ‰ãŠã‚ˆã³ã‚¯ãƒ©ã‚¦ãƒ‰/SaaSé–“ã®**æ‚ªã„è¨­å®šã‚„ç‰¹æ¨©æ˜‡æ ¼ãƒ‘ã‚¹ã‚’ç‰¹å®šã™ã‚‹**ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

{% tabs %}
{% tab title="Install" %}
```bash
# You need to install and run neo4j also
git clone https://github.com/carlospolop/PurplePanda
cd PurplePanda
python3 -m venv .
source bin/activate
python3 -m pip install -r requirements.txt
export PURPLEPANDA_NEO4J_URL="bolt://neo4j@localhost:7687"
export PURPLEPANDA_PWD="neo4j_pwd_4_purplepanda"
python3 main.py -h # Get help
```
{% endtab %}

{% tab title="GCP" %}
```bash
export GOOGLE_DISCOVERY=$(echo 'google:
- file_path: ""

- file_path: ""
service_account_id: "some-sa-email@sidentifier.iam.gserviceaccount.com"' | base64)

python3 main.py -a -p google #Get basic info of the account to check it's correctly configured
python3 main.py -e -p google #Enumerate the env
```
{% endtab %}
{% endtabs %}

### [Prowler](https://github.com/prowler-cloud/prowler)

**AWSã€GCPã€Azure**ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚å„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®è¨­å®šæ–¹æ³•ã¯[https://docs.prowler.cloud/en/latest/#aws](https://docs.prowler.cloud/en/latest/#aws)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
```bash
# Install
pip install prowler
prowler -v

# Run
prowler <provider>
# Example
prowler aws --profile custom-profile [-M csv json json-asff html]

# Get info about checks & services
prowler <provider> --list-checks
prowler <provider> --list-services
```
### [CloudSploit](https://github.com/aquasecurity/cloudsploit)

AWSã€Azureã€Githubã€Googleã€Oracleã€Alibaba

{% tabs %}
{% tab title="ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" %}
```bash
# Install
git clone https://github.com/aquasecurity/cloudsploit.git
cd cloudsploit
npm install
./index.js -h
## Docker instructions in github
```
{% endtab %}

{% tab title="GCP" %}
```bash
## You need to have creds for a service account and set them in config.js file
./index.js --cloud google --config </abs/path/to/config.js>
```
{% endtab %}
{% endtabs %}

### [ScoutSuite](https://github.com/nccgroup/ScoutSuite)

AWSã€Azureã€GCPã€Alibaba Cloudã€Oracle Cloud Infrastructure

{% tabs %}
{% tab title="ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" %}
```bash
mkdir scout; cd scout
virtualenv -p python3 venv
source venv/bin/activate
pip install scoutsuite
scout --help
## Using Docker: https://github.com/nccgroup/ScoutSuite/wiki/Docker-Image
```
{% endtab %}

{% tab title="GCP" %}
```bash
scout gcp --report-dir /tmp/gcp --user-account --all-projects
## use "--service-account KEY_FILE" instead of "--user-account" to use a service account

SCOUT_FOLDER_REPORT="/tmp"
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "================================================"
echo "Checking $pid"
mkdir "$SCOUT_FOLDER_REPORT/$pid"
scout gcp --report-dir "$SCOUT_FOLDER_REPORT/$pid" --no-browser --user-account --project-id "$pid"
done
```
{% endtab %}
{% endtabs %}

### [Steampipe](https://github.com/turbot)

{% tabs %}
{% tab title="ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«" %}
Steampipeã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼ˆ[https://steampipe.io/downloads](https://steampipe.io/downloads)ï¼‰ã€‚ã¾ãŸã¯ã€Brewã‚’ä½¿ç”¨ã—ã¾ã™ï¼š
```
brew tap turbot/tap
brew install steampipe
```
{% endtab %}

{% tab title="GCP" %}
```bash
# Install gcp plugin
steampipe plugin install gcp

# Use https://github.com/turbot/steampipe-mod-gcp-compliance.git
git clone https://github.com/turbot/steampipe-mod-gcp-compliance.git
cd steampipe-mod-gcp-compliance
# To run all the checks from the dashboard
steampipe dashboard
# To run all the checks from rhe cli
steampipe check all
```
<details>

<summary>ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç¢ºèª</summary>

ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€ãƒ†ã‚¹ãƒˆã™ã‚‹ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç¤ºã™ `gcp.spc` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ¬¡ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æŒ‡ç¤ºã«å¾“ã†ã ã‘ã§æ¸ˆã¿ã¾ã™ã€‚
```bash
FILEPATH="/tmp/gcp.spc"
rm -rf "$FILEPATH" 2>/dev/null

# Generate a json like object for each project
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "connection \"gcp_$(echo -n $pid | tr "-" "_" )\" {
plugin  = \"gcp\"
project = \"$pid\"
}" >> "$FILEPATH"
done

# Generate the aggragator to call
echo 'connection "gcp_all" {
plugin      = "gcp"
type        = "aggregator"
connections = ["gcp_*"]
}' >> "$FILEPATH"

echo "Copy $FILEPATH in ~/.steampipe/config/gcp.spc if it was correctly generated"
```
</details>

**ä»–ã®GCPã‚¤ãƒ³ã‚µã‚¤ãƒˆ**ï¼ˆã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ—æŒ™ã™ã‚‹ã®ã«ä¾¿åˆ©ï¼‰ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€æ¬¡ã‚’ä½¿ç”¨ã—ã¾ã™: [https://github.com/turbot/steampipe-mod-gcp-insights](https://github.com/turbot/steampipe-mod-gcp-insights)

Terraform GCPã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã™ã‚‹ã«ã¯: [https://github.com/turbot/steampipe-mod-terraform-gcp-compliance](https://github.com/turbot/steampipe-mod-terraform-gcp-compliance)

Steampipeã®ä»–ã®GCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³: [https://github.com/turbot?q=gcp](https://github.com/turbot?q=gcp)
{% endtab %}

{% tab title="AWS" %}
```bash
# Install aws plugin
steampipe plugin install aws

# Modify the spec indicating in "profile" the profile name to use
nano ~/.steampipe/config/aws.spc

# Get some info on how the AWS account is being used
git clone https://github.com/turbot/steampipe-mod-aws-insights.git
cd steampipe-mod-aws-insights
steampipe dashboard

# Get the services exposed to the internet
git clone https://github.com/turbot/steampipe-mod-aws-perimeter.git
cd steampipe-mod-aws-perimeter
steampipe dashboard

# Run the benchmarks
git clone https://github.com/turbot/steampipe-mod-aws-compliance
cd steampipe-mod-aws-compliance
steampipe dashboard # To see results in browser
steampipe check all --export=/tmp/output4.json
```
Terraform AWSã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã™ã‚‹ã«ã¯: [https://github.com/turbot/steampipe-mod-terraform-aws-compliance](https://github.com/turbot/steampipe-mod-terraform-aws-compliance)

Steampipeã®ä»–ã®AWSãƒ—ãƒ©ã‚°ã‚¤ãƒ³: [https://github.com/orgs/turbot/repositories?q=aws](https://github.com/orgs/turbot/repositories?q=aws)
{% endtab %}
{% endtabs %}

### [~~cs-suite~~](https://github.com/SecurityFTW/cs-suite)

AWSã€GCPã€Azureã€DigitalOceanã€‚\
python2.7ãŒå¿…è¦ã§ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã•ã‚Œã¦ã„ãªã„ã‚ˆã†ã§ã™ã€‚

### Nessus

Nessusã«ã¯ã€AWSã€Azureã€Office 365ã€Rackspaceã€Salesforceã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹_**Audit Cloud Infrastructure**_ã‚¹ã‚­ãƒ£ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚**Azure**ã§**Client Id**ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€ã„ãã¤ã‹ã®è¿½åŠ è¨­å®šãŒå¿…è¦ã§ã™ã€‚

### [**cloudlist**](https://github.com/projectdiscovery/cloudlist)

Cloudlistã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‹ã‚‰è³‡ç”£ï¼ˆãƒ›ã‚¹ãƒˆåã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®**ãƒãƒ«ãƒã‚¯ãƒ©ã‚¦ãƒ‰ãƒ„ãƒ¼ãƒ«**ã§ã™ã€‚

{% tabs %}
{% tab title="Cloudlist" %}
```bash
cd /tmp
wget https://github.com/projectdiscovery/cloudlist/releases/latest/download/cloudlist_1.0.1_macOS_arm64.zip
unzip cloudlist_1.0.1_macOS_arm64.zip
chmod +x cloudlist
sudo mv cloudlist /usr/local/bin
```
{% endtab %}

{% tab title="ã‚»ã‚«ãƒ³ãƒ‰ã‚¿ãƒ–" %}
```bash
## For GCP it requires service account JSON credentials
cloudlist -config </path/to/config>
```
{% endtab %}
{% endtabs %}

### [**cartography**](https://github.com/lyft/cartography)

Cartographyã¯ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£è³‡ç”£ã¨ãã‚Œã‚‰ã®é–¢ä¿‚ã‚’ã€Neo4jãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚ˆã£ã¦å¼·åŒ–ã•ã‚ŒãŸç›´æ„Ÿçš„ãªã‚°ãƒ©ãƒ•ãƒ“ãƒ¥ãƒ¼ã§çµ±åˆã™ã‚‹Pythonãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

{% tabs %}
{% tab title="Install" %}
```bash
# Installation
docker image pull ghcr.io/lyft/cartography
docker run --platform linux/amd64 ghcr.io/lyft/cartography cartography --help
## Install a Neo4j DB version 3.5.*
```
{% endtab %}

{% tab title="GCP" %}
```bash
docker run --platform linux/amd64 \
--volume "$HOME/.config/gcloud/application_default_credentials.json:/application_default_credentials.json" \
-e GOOGLE_APPLICATION_CREDENTIALS="/application_default_credentials.json" \
-e NEO4j_PASSWORD="s3cr3t" \
ghcr.io/lyft/cartography  \
--neo4j-uri bolt://host.docker.internal:7687 \
--neo4j-password-env-var NEO4j_PASSWORD \
--neo4j-user neo4j


# It only checks for a few services inside GCP (https://lyft.github.io/cartography/modules/gcp/index.html)
## Cloud Resource Manager
## Compute
## DNS
## Storage
## Google Kubernetes Engine
### If you can run starbase or purplepanda you will get more info
```
{% endtab %}
{% endtabs %}

### [**starbase**](https://github.com/JupiterOne/starbase)

Starbaseã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã€SaaSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãªã©ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚„ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰è³‡ç”£ã¨é–¢ä¿‚ã‚’åé›†ã—ã€Neo4jãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ã„ãŸç›´æ„Ÿçš„ãªã‚°ãƒ©ãƒ•ãƒ“ãƒ¥ãƒ¼ã«è¡¨ç¤ºã—ã¾ã™ã€‚

{% tabs %}
{% tab title="Install" %}
```bash
# You are going to need Node version 14, so install nvm following https://tecadmin.net/install-nvm-macos-with-homebrew/
npm install --global yarn
nvm install 14
git clone https://github.com/JupiterOne/starbase.git
cd starbase
nvm use 14
yarn install
yarn starbase --help
# Configure manually config.yaml depending on the env to analyze
yarn starbase setup
yarn starbase run

# Docker
git clone https://github.com/JupiterOne/starbase.git
cd starbase
cp config.yaml.example config.yaml
# Configure manually config.yaml depending on the env to analyze
docker build --no-cache -t starbase:latest .
docker-compose run starbase setup
docker-compose run starbase run
```
{% endtab %}

{% tab title="GCP" %}
```yaml
## Config for GCP
### Check out: https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md
### It requires service account credentials

integrations:
-
name: graph-google-cloud
instanceId: testInstanceId
directory: ./.integrations/graph-google-cloud
gitRemoteUrl: https://github.com/JupiterOne/graph-google-cloud.git
config:
SERVICE_ACCOUNT_KEY_FILE: '{Check https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md#service_account_key_file-string}'
PROJECT_ID: ""
FOLDER_ID: ""
ORGANIZATION_ID: ""
CONFIGURE_ORGANIZATION_PROJECTS: false

storage:
engine: neo4j
config:
username: neo4j
password: s3cr3t
uri: bolt://localhost:7687
#Consider using host.docker.internal if from docker
```
{% endtab %}
{% endtabs %}

### [**SkyArk**](https://github.com/cyberark/SkyArk)

ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚ŒãŸAWSã¾ãŸã¯Azureç’°å¢ƒã§æœ€ã‚‚ç‰¹æ¨©ã®ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™ºè¦‹ã—ã¾ã™ã€‚ã“ã‚Œã«ã¯AWSã‚·ãƒ£ãƒ‰ã‚¦ç®¡ç†è€…ãŒå«ã¾ã‚Œã¾ã™ã€‚PowerShellã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
```powershell
Import-Module .\SkyArk.ps1 -force
Start-AzureStealth

# in the Cloud Console
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/cyberark/SkyArk/master/AzureStealth/AzureStealth.ps1')
Scan-AzureAdmins
```
### [Cloud Brute](https://github.com/0xsha/CloudBrute)

ä¼æ¥­ï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰ã®ã‚¤ãƒ³ãƒ•ãƒ©ã€ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚¢ãƒ—ãƒªã‚’ä¸»è¦ãªã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆAmazonã€Googleã€Microsoftã€DigitalOceanã€Alibabaã€Vultrã€Linodeï¼‰ã§è¦‹ã¤ã‘ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

### [CloudFox](https://github.com/BishopFox/cloudfox)

* CloudFoxã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å†…ã®æ‚ªç”¨å¯èƒ½ãªæ”»æ’ƒçµŒè·¯ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ï¼ˆç¾åœ¨ã¯AWSã¨Azureã®ã¿ã‚µãƒãƒ¼ãƒˆã€GCPã¯è¿‘æ—¥ä¸­ã«å¯¾å¿œäºˆå®šï¼‰ã€‚
* æ‰‹å‹•ã®pentestingã‚’è£œå®Œã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸåˆ—æŒ™ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
* ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒå†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã¾ãŸã¯å¤‰æ›´ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### ã‚¯ãƒ©ã‚¦ãƒ‰ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã®ã•ã‚‰ãªã‚‹ãƒªã‚¹ãƒˆ

* [https://github.com/RyanJarv/awesome-cloud-sec](https://github.com/RyanJarv/awesome-cloud-sec)

## Google

### GCP

{% content-ref url="gcp-security/" %}
[gcp-security](gcp-security/)
{% endcontent-ref %}

### Workspace

{% content-ref url="workspace-security/" %}
[workspace-security](workspace-security/)
{% endcontent-ref %}

## AWS

{% content-ref url="aws-security/" %}
[aws-security](aws-security/)
{% endcontent-ref %}

## Azure

{% content-ref url="azure-security/" %}
[azure-security](azure-security/)
{% endcontent-ref %}

### Attack Graph

[**Stormspotter** ](https://github.com/Azure/Stormspotter)ã¯ã€Azureã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å†…ã®ãƒªã‚½ãƒ¼ã‚¹ã®ã€Œæ”»æ’ƒã‚°ãƒ©ãƒ•ã€ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¬ãƒƒãƒ‰ãƒãƒ¼ãƒ ã‚„pentesterã¯ãƒ†ãƒŠãƒ³ãƒˆå†…ã®æ”»æ’ƒé¢ã¨ãƒ”ãƒœãƒƒãƒˆã®æ©Ÿä¼šã‚’è¦–è¦šåŒ–ã§ãã€ãƒ‡ã‚£ãƒ•ã‚§ãƒ³ãƒ€ãƒ¼ã¯ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œä½œæ¥­ã‚’è¿…é€Ÿã«æ–¹å‘ä»˜ã‘ã€å„ªå…ˆé †ä½ã‚’ä»˜ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### Office365

**Global Admin**ã¾ãŸã¯å°‘ãªãã¨ã‚‚**Global Admin Reader**ãŒå¿…è¦ã§ã™ï¼ˆãŸã ã—ã€Global Admin Readerã«ã¯å°‘ã—åˆ¶é™ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚ãŸã ã—ã€ã“ã‚Œã‚‰ã®åˆ¶é™ã¯ä¸€éƒ¨ã®PSãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ç¾ã‚Œã€**ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»‹ã—ã¦**æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã§å›é¿ã§ãã¾ã™ã€‚

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
