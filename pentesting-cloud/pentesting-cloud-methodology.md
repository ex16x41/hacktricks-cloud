# Pentesting Cloud Methodology

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/CLOUD-logo-letters.svg" alt=""><figcaption></figcaption></figure>

## Basic Methodology

ê° í´ë¼ìš°ë“œëŠ” ê³ ìœ í•œ íŠ¹ì„±ì„ ê°€ì§€ê³  ìˆì§€ë§Œ, ì¼ë°˜ì ìœ¼ë¡œ í´ë¼ìš°ë“œ í™˜ê²½ì„ í…ŒìŠ¤íŠ¸í•  ë•Œ **íœí…ŒìŠ¤í„°ê°€ í™•ì¸í•´ì•¼ í•  ëª‡ ê°€ì§€ ê³µí†µ ì‚¬í•­**ì´ ìˆìŠµë‹ˆë‹¤:

* **ë²¤ì¹˜ë§ˆí¬ ì²´í¬**
* ì´ëŠ” **í™˜ê²½ì˜ í¬ê¸°**ì™€ **ì‚¬ìš©ë˜ëŠ” ì„œë¹„ìŠ¤**ë¥¼ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.
* ëŒ€ë¶€ë¶„ì˜ í…ŒìŠ¤íŠ¸ë¥¼ **ìë™í™” ë„êµ¬**ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¼ë¶€ **ë¹ ë¥¸ ì˜ëª»ëœ êµ¬ì„±**ì„ ì°¾ëŠ” ë°ë„ ë„ì›€ì´ ë©ë‹ˆë‹¤.
* **ì„œë¹„ìŠ¤ ì—´ê±°**
* ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸ë¥¼ ì˜¬ë°”ë¥´ê²Œ ìˆ˜í–‰í–ˆë‹¤ë©´ ì—¬ê¸°ì„œ ë” ë§ì€ ì˜ëª»ëœ êµ¬ì„±ì„ ì°¾ì§€ ëª»í•  ê°€ëŠ¥ì„±ì´ ë†’ì§€ë§Œ, ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸ì—ì„œ ì°¾ì§€ ëª»í•œ ì¼ë¶€ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ì´ëŠ” í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ **ì •í™•íˆ ë¬´ì—‡ì´ ì‚¬ìš©ë˜ê³  ìˆëŠ”ì§€** ì•Œ ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
* ì´ëŠ” ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ë§ì€ ë„ì›€ì´ ë©ë‹ˆë‹¤.
* **ë…¸ì¶œëœ ìì‚° í™•ì¸**
* ì´ëŠ” ì´ì „ ì„¹ì…˜ì—ì„œ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë©°, **ì¸í„°ë„·ì— ì ì¬ì ìœ¼ë¡œ ë…¸ì¶œëœ ëª¨ë“  ê²ƒ**ê³¼ ì–´ë–»ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ì§€ë¥¼ **ì°¾ì•„ì•¼** í•©ë‹ˆë‹¤.
* ì—¬ê¸°ì„œëŠ” ì›¹ í˜ì´ì§€ê°€ ìˆëŠ” ì¸ìŠ¤í„´ìŠ¤ë‚˜ ë‹¤ë¥¸ í¬íŠ¸ê°€ ë…¸ì¶œëœ **ìˆ˜ë™ìœ¼ë¡œ ë…¸ì¶œëœ ì¸í”„ë¼**ì™€, ë…¸ì¶œë˜ë„ë¡ **êµ¬ì„±í•  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ í´ë¼ìš°ë“œ ê´€ë¦¬ ì„œë¹„ìŠ¤**(ì˜ˆ: DB ë˜ëŠ” ë²„í‚·)ì— ëŒ€í•´ ë‹¤ë£¹ë‹ˆë‹¤.
* ê·¸ëŸ° ë‹¤ìŒ **í•´ë‹¹ ë¦¬ì†ŒìŠ¤ê°€ ë…¸ì¶œë  ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€**ë¥¼ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤(ê¸°ë°€ ì •ë³´? ì·¨ì•½ì ? ë…¸ì¶œëœ ì„œë¹„ìŠ¤ì˜ ì˜ëª»ëœ êµ¬ì„±?).
* **ê¶Œí•œ í™•ì¸**
* ì—¬ê¸°ì„œëŠ” í´ë¼ìš°ë“œ ë‚´ ê° ì—­í• /ì‚¬ìš©ìì˜ **ëª¨ë“  ê¶Œí•œ**ì„ **ì°¾ì•„ì•¼** í•˜ë©°, ê·¸ê²ƒë“¤ì´ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ë¥¼ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.
* ë„ˆë¬´ **ë§ì€ ê³ ê¸‰ ê¶Œí•œ**(ëª¨ë“  ê²ƒì„ ì œì–´í•˜ëŠ”) ê³„ì •ì´ ìˆìŠµë‹ˆê¹Œ? ìƒì„±ëœ í‚¤ê°€ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆê¹Œ?... ì´ëŸ¬í•œ ëŒ€ë¶€ë¶„ì˜ ì²´í¬ëŠ” ì´ë¯¸ ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸ì—ì„œ ìˆ˜í–‰ë˜ì—ˆì–´ì•¼ í•©ë‹ˆë‹¤.
* í´ë¼ì´ì–¸íŠ¸ê°€ OpenID ë˜ëŠ” SAML ë˜ëŠ” ë‹¤ë¥¸ **ì—°í•©**ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´, ê° ì—­í• ì´ **ì–´ë–»ê²Œ í• ë‹¹ë˜ëŠ”ì§€**ì— ëŒ€í•œ ì¶”ê°€ **ì •ë³´**ë¥¼ ìš”ì²­í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ê´€ë¦¬ ì—­í• ì´ 1ëª…ì—ê²Œ í• ë‹¹ë˜ëŠ” ê²ƒê³¼ 100ëª…ì—ê²Œ í• ë‹¹ë˜ëŠ” ê²ƒì€ ë‹¤ë¦…ë‹ˆë‹¤).
* **ê´€ë¦¬** ê¶Œí•œ "\*:\*"ì„ ê°€ì§„ ì‚¬ìš©ìë¥¼ ì°¾ëŠ” ê²ƒë§Œìœ¼ë¡œëŠ” **ì¶©ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. ì‚¬ìš©ë˜ëŠ” ì„œë¹„ìŠ¤ì— ë”°ë¼ ë§¤ìš° **ë¯¼ê°í•  ìˆ˜ ìˆëŠ”** **ë‹¤ë¥¸ ê¶Œí•œ**ì´ ë§ì´ ìˆìŠµë‹ˆë‹¤.
* ê²Œë‹¤ê°€, ê¶Œí•œì„ ë‚¨ìš©í•˜ì—¬ ë”°ë¼ê°ˆ ìˆ˜ ìˆëŠ” **ì ì¬ì ì¸ ê¶Œí•œ ìƒìŠ¹** ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ëª¨ë“  ì‚¬í•­ì„ ê³ ë ¤í•´ì•¼ í•˜ë©°, **ê°€ëŠ¥í•œ í•œ ë§ì€ ê¶Œí•œ ìƒìŠ¹ ê²½ë¡œ**ë¥¼ ë³´ê³ í•´ì•¼ í•©ë‹ˆë‹¤.
* **í†µí•© í™•ì¸**
* í´ë¼ìš°ë“œ í™˜ê²½ ë‚´ì—ì„œ **ë‹¤ë¥¸ í´ë¼ìš°ë“œ ë˜ëŠ” SaaSì™€ì˜ í†µí•©**ì´ ì‚¬ìš©ë˜ê³  ìˆì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
* **ê°ì‚¬ ì¤‘ì¸ í´ë¼ìš°ë“œì˜ í†µí•©**ì´ ë‹¤ë¥¸ í”Œë«í¼ê³¼ì˜ ê²½ìš°, **ê·¸ í†µí•©ì„ (ë‚¨ìš©í•  ìˆ˜ ìˆëŠ”) ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ” ì‚¬ëŒ**ì„ ì•Œë ¤ì•¼ í•˜ë©°, ìˆ˜í–‰ë˜ëŠ” ì‘ì—…ì´ **ì–¼ë§ˆë‚˜ ë¯¼ê°í•œì§€**ë¥¼ ë¬¼ì–´ë´ì•¼ í•©ë‹ˆë‹¤.\
ì˜ˆë¥¼ ë“¤ì–´, GCPê°€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” AWS ë²„í‚·ì— ì“¸ ìˆ˜ ìˆëŠ” ì‚¬ëŒì€ ëˆ„êµ¬ì¸ì§€(ê·¸ ë°ì´í„° ì²˜ë¦¬ì—ì„œ GCPì˜ ì‘ì—…ì´ ì–¼ë§ˆë‚˜ ë¯¼ê°í•œì§€ ë¬¼ì–´ë³´ì„¸ìš”).
* **ê°ì‚¬ ì¤‘ì¸ í´ë¼ìš°ë“œ ë‚´ì—ì„œ** ì™¸ë¶€ í”Œë«í¼ìœ¼ë¡œë¶€í„°ì˜ í†µí•©ì— ëŒ€í•´, **ê·¸ í†µí•©ì„ (ë‚¨ìš©í•  ìˆ˜ ìˆëŠ”) ì™¸ë¶€ ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ” ì‚¬ëŒ**ì„ ë¬¼ì–´ë³´ê³ , ê·¸ ë°ì´í„°ê°€ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.\
ì˜ˆë¥¼ ë“¤ì–´, ì„œë¹„ìŠ¤ê°€ GCRì— í˜¸ìŠ¤íŒ…ëœ Docker ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒê³¼ AWS í´ë¼ìš°ë“œ ë‚´ì—ì„œ ì‹¤í–‰ë  ë•Œ í•´ë‹¹ ì´ë¯¸ì§€ê°€ ì–´ë–¤ ë¯¼ê°í•œ ì •ë³´ì™€ ì ‘ê·¼ ê¶Œí•œì„ ì–»ëŠ”ì§€ ë¬¼ì–´ë´ì•¼ í•©ë‹ˆë‹¤.

## Multi-Cloud tools

ì—¬ëŸ¬ í´ë¼ìš°ë“œ í™˜ê²½ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ë„êµ¬ê°€ ìˆìŠµë‹ˆë‹¤. ì„¤ì¹˜ ë‹¨ê³„ì™€ ë§í¬ëŠ” ì´ ì„¹ì…˜ì—ì„œ ì•ˆë‚´ë©ë‹ˆë‹¤.

### [PurplePanda](https://github.com/carlospolop/purplepanda)

í´ë¼ìš°ë“œ ë° í´ë¼ìš°ë“œ/SaaS ê°„ì˜ **ì˜ëª»ëœ êµ¬ì„± ë° ê¶Œí•œ ìƒìŠ¹ ê²½ë¡œë¥¼ ì‹ë³„í•˜ëŠ” ë„êµ¬**ì…ë‹ˆë‹¤.

{% tabs %}
{% tab title="Install" %}
```bash
# You need to install and run neo4j also
git clone https://github.com/carlospolop/PurplePanda
cd PurplePanda
python3 -m venv .
source bin/activate
python3 -m pip install -r requirements.txt
export PURPLEPANDA_NEO4J_URL="bolt://neo4j@localhost:7687"
export PURPLEPANDA_PWD="neo4j_pwd_4_purplepanda"
python3 main.py -h # Get help
```
{% endtab %}

{% tab title="GCP" %}
```bash
export GOOGLE_DISCOVERY=$(echo 'google:
- file_path: ""

- file_path: ""
service_account_id: "some-sa-email@sidentifier.iam.gserviceaccount.com"' | base64)

python3 main.py -a -p google #Get basic info of the account to check it's correctly configured
python3 main.py -e -p google #Enumerate the env
```
{% endtab %}
{% endtabs %}

### [Prowler](https://github.com/prowler-cloud/prowler)

**AWS, GCP ë° Azure**ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. ê° ê³µê¸‰ìë¥¼ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì€ [https://docs.prowler.cloud/en/latest/#aws](https://docs.prowler.cloud/en/latest/#aws)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.
```bash
# Install
pip install prowler
prowler -v

# Run
prowler <provider>
# Example
prowler aws --profile custom-profile [-M csv json json-asff html]

# Get info about checks & services
prowler <provider> --list-checks
prowler <provider> --list-services
```
### [CloudSploit](https://github.com/aquasecurity/cloudsploit)

AWS, Azure, Github, Google, Oracle, Alibaba

{% tabs %}
{% tab title="ì„¤ì¹˜" %}
```bash
# Install
git clone https://github.com/aquasecurity/cloudsploit.git
cd cloudsploit
npm install
./index.js -h
## Docker instructions in github
```
{% endtab %}

{% tab title="GCP" %}
```bash
## You need to have creds for a service account and set them in config.js file
./index.js --cloud google --config </abs/path/to/config.js>
```
{% endtab %}
{% endtabs %}

### [ScoutSuite](https://github.com/nccgroup/ScoutSuite)

AWS, Azure, GCP, Alibaba Cloud, Oracle Cloud Infrastructure

{% tabs %}
{% tab title="ì„¤ì¹˜" %}
```bash
mkdir scout; cd scout
virtualenv -p python3 venv
source venv/bin/activate
pip install scoutsuite
scout --help
## Using Docker: https://github.com/nccgroup/ScoutSuite/wiki/Docker-Image
```
{% endtab %}

{% tab title="GCP" %}
```bash
scout gcp --report-dir /tmp/gcp --user-account --all-projects
## use "--service-account KEY_FILE" instead of "--user-account" to use a service account

SCOUT_FOLDER_REPORT="/tmp"
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "================================================"
echo "Checking $pid"
mkdir "$SCOUT_FOLDER_REPORT/$pid"
scout gcp --report-dir "$SCOUT_FOLDER_REPORT/$pid" --no-browser --user-account --project-id "$pid"
done
```
{% endtab %}
{% endtabs %}

### [Steampipe](https://github.com/turbot)

{% tabs %}
{% tab title="ì„¤ì¹˜" %}
Steampipeë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì„¤ì¹˜í•˜ì„¸ìš” ([https://steampipe.io/downloads](https://steampipe.io/downloads)). ë˜ëŠ” Brewë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:
```
brew tap turbot/tap
brew install steampipe
```
{% endtab %}

{% tab title="GCP" %}
```bash
# Install gcp plugin
steampipe plugin install gcp

# Use https://github.com/turbot/steampipe-mod-gcp-compliance.git
git clone https://github.com/turbot/steampipe-mod-gcp-compliance.git
cd steampipe-mod-gcp-compliance
# To run all the checks from the dashboard
steampipe dashboard
# To run all the checks from rhe cli
steampipe check all
```
<details>

<summary>ëª¨ë“  í”„ë¡œì íŠ¸ í™•ì¸</summary>

ëª¨ë“  í”„ë¡œì íŠ¸ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” í…ŒìŠ¤íŠ¸í•  ëª¨ë“  í”„ë¡œì íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” `gcp.spc` íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ì˜ ì§€ì¹¨ì„ ë”°ë¥´ë©´ ë©ë‹ˆë‹¤.
```bash
FILEPATH="/tmp/gcp.spc"
rm -rf "$FILEPATH" 2>/dev/null

# Generate a json like object for each project
for pid in $(gcloud projects list --format="value(projectId)"); do
echo "connection \"gcp_$(echo -n $pid | tr "-" "_" )\" {
plugin  = \"gcp\"
project = \"$pid\"
}" >> "$FILEPATH"
done

# Generate the aggragator to call
echo 'connection "gcp_all" {
plugin      = "gcp"
type        = "aggregator"
connections = ["gcp_*"]
}' >> "$FILEPATH"

echo "Copy $FILEPATH in ~/.steampipe/config/gcp.spc if it was correctly generated"
```
</details>

**ê¸°íƒ€ GCP ì¸ì‚¬ì´íŠ¸**(ì„œë¹„ìŠ¤ ì—´ê±°ì— ìœ ìš©)ë¥¼ í™•ì¸í•˜ë ¤ë©´: [https://github.com/turbot/steampipe-mod-gcp-insights](https://github.com/turbot/steampipe-mod-gcp-insights)

Terraform GCP ì½”ë“œë¥¼ í™•ì¸í•˜ë ¤ë©´: [https://github.com/turbot/steampipe-mod-terraform-gcp-compliance](https://github.com/turbot/steampipe-mod-terraform-gcp-compliance)

Steampipeì˜ ë” ë§ì€ GCP í”ŒëŸ¬ê·¸ì¸: [https://github.com/turbot?q=gcp](https://github.com/turbot?q=gcp)
{% endtab %}

{% tab title="AWS" %}
```bash
# Install aws plugin
steampipe plugin install aws

# Modify the spec indicating in "profile" the profile name to use
nano ~/.steampipe/config/aws.spc

# Get some info on how the AWS account is being used
git clone https://github.com/turbot/steampipe-mod-aws-insights.git
cd steampipe-mod-aws-insights
steampipe dashboard

# Get the services exposed to the internet
git clone https://github.com/turbot/steampipe-mod-aws-perimeter.git
cd steampipe-mod-aws-perimeter
steampipe dashboard

# Run the benchmarks
git clone https://github.com/turbot/steampipe-mod-aws-compliance
cd steampipe-mod-aws-compliance
steampipe dashboard # To see results in browser
steampipe check all --export=/tmp/output4.json
```
Terraform AWS ì½”ë“œë¥¼ í™•ì¸í•˜ë ¤ë©´: [https://github.com/turbot/steampipe-mod-terraform-aws-compliance](https://github.com/turbot/steampipe-mod-terraform-aws-compliance)

Steampipeì˜ ë” ë§ì€ AWS í”ŒëŸ¬ê·¸ì¸: [https://github.com/orgs/turbot/repositories?q=aws](https://github.com/orgs/turbot/repositories?q=aws)
{% endtab %}
{% endtabs %}

### [~~cs-suite~~](https://github.com/SecurityFTW/cs-suite)

AWS, GCP, Azure, DigitalOcean.\
python2.7ì´ í•„ìš”í•˜ë©° ìœ ì§€ ê´€ë¦¬ë˜ì§€ ì•ŠëŠ” ê²ƒì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤.

### Nessus

NessusëŠ” _**í´ë¼ìš°ë“œ ì¸í”„ë¼ ê°ì‚¬**_ ìŠ¤ìº”ì„ ì§€ì›í•˜ë©°: AWS, Azure, Office 365, Rackspace, Salesforce. **Client Id**ë¥¼ ì–»ê¸° ìœ„í•´ **Azure**ì—ì„œ ì¶”ê°€ êµ¬ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤.

### [**cloudlist**](https://github.com/projectdiscovery/cloudlist)

CloudlistëŠ” í´ë¼ìš°ë“œ ì œê³µì—…ì²´ì—ì„œ ìì‚°(í˜¸ìŠ¤íŠ¸ ì´ë¦„, IP ì£¼ì†Œ)ì„ ê°€ì ¸ì˜¤ëŠ” **ë‹¤ì¤‘ í´ë¼ìš°ë“œ ë„êµ¬**ì…ë‹ˆë‹¤.

{% tabs %}
{% tab title="Cloudlist" %}
```bash
cd /tmp
wget https://github.com/projectdiscovery/cloudlist/releases/latest/download/cloudlist_1.0.1_macOS_arm64.zip
unzip cloudlist_1.0.1_macOS_arm64.zip
chmod +x cloudlist
sudo mv cloudlist /usr/local/bin
```
{% endtab %}

{% tab title="ë‘ ë²ˆì§¸ íƒ­" %}
```bash
## For GCP it requires service account JSON credentials
cloudlist -config </path/to/config>
```
{% endtab %}
{% endtabs %}

### [**cartography**](https://github.com/lyft/cartography)

CartographyëŠ” Neo4j ë°ì´í„°ë² ì´ìŠ¤ë¡œ êµ¬ë™ë˜ëŠ” ì§ê´€ì ì¸ ê·¸ë˜í”„ ë·°ì—ì„œ ì¸í”„ë¼ ìì‚°ê³¼ ê·¸ë“¤ ê°„ì˜ ê´€ê³„ë¥¼ í†µí•©í•˜ëŠ” Python ë„êµ¬ì…ë‹ˆë‹¤.

{% tabs %}
{% tab title="Install" %}
```bash
# Installation
docker image pull ghcr.io/lyft/cartography
docker run --platform linux/amd64 ghcr.io/lyft/cartography cartography --help
## Install a Neo4j DB version 3.5.*
```
{% endtab %}

{% tab title="GCP" %}
```bash
docker run --platform linux/amd64 \
--volume "$HOME/.config/gcloud/application_default_credentials.json:/application_default_credentials.json" \
-e GOOGLE_APPLICATION_CREDENTIALS="/application_default_credentials.json" \
-e NEO4j_PASSWORD="s3cr3t" \
ghcr.io/lyft/cartography  \
--neo4j-uri bolt://host.docker.internal:7687 \
--neo4j-password-env-var NEO4j_PASSWORD \
--neo4j-user neo4j


# It only checks for a few services inside GCP (https://lyft.github.io/cartography/modules/gcp/index.html)
## Cloud Resource Manager
## Compute
## DNS
## Storage
## Google Kubernetes Engine
### If you can run starbase or purplepanda you will get more info
```
{% endtab %}
{% endtabs %}

### [**starbase**](https://github.com/JupiterOne/starbase)

StarbaseëŠ” í´ë¼ìš°ë“œ ì¸í”„ë¼, SaaS ì• í”Œë¦¬ì¼€ì´ì…˜, ë³´ì•ˆ ì œì–´ ë“± ì„œë¹„ìŠ¤ ë° ì‹œìŠ¤í…œì—ì„œ ìì‚°ê³¼ ê´€ê³„ë¥¼ ìˆ˜ì§‘í•˜ì—¬ Neo4j ë°ì´í„°ë² ì´ìŠ¤ì— ê¸°ë°˜í•œ ì§ê´€ì ì¸ ê·¸ë˜í”„ ë·°ë¡œ ì œê³µí•©ë‹ˆë‹¤.

{% tabs %}
{% tab title="ì„¤ì¹˜" %}
```bash
# You are going to need Node version 14, so install nvm following https://tecadmin.net/install-nvm-macos-with-homebrew/
npm install --global yarn
nvm install 14
git clone https://github.com/JupiterOne/starbase.git
cd starbase
nvm use 14
yarn install
yarn starbase --help
# Configure manually config.yaml depending on the env to analyze
yarn starbase setup
yarn starbase run

# Docker
git clone https://github.com/JupiterOne/starbase.git
cd starbase
cp config.yaml.example config.yaml
# Configure manually config.yaml depending on the env to analyze
docker build --no-cache -t starbase:latest .
docker-compose run starbase setup
docker-compose run starbase run
```
{% endtab %}

{% tab title="GCP" %}
```yaml
## Config for GCP
### Check out: https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md
### It requires service account credentials

integrations:
-
name: graph-google-cloud
instanceId: testInstanceId
directory: ./.integrations/graph-google-cloud
gitRemoteUrl: https://github.com/JupiterOne/graph-google-cloud.git
config:
SERVICE_ACCOUNT_KEY_FILE: '{Check https://github.com/JupiterOne/graph-google-cloud/blob/main/docs/development.md#service_account_key_file-string}'
PROJECT_ID: ""
FOLDER_ID: ""
ORGANIZATION_ID: ""
CONFIGURE_ORGANIZATION_PROJECTS: false

storage:
engine: neo4j
config:
username: neo4j
password: s3cr3t
uri: bolt://localhost:7687
#Consider using host.docker.internal if from docker
```
{% endtab %}
{% endtabs %}

### [**SkyArk**](https://github.com/cyberark/SkyArk)

ìŠ¤ìº”ëœ AWS ë˜ëŠ” Azure í™˜ê²½ì—ì„œ ê°€ì¥ íŠ¹ê¶Œì´ ìˆëŠ” ì‚¬ìš©ì, AWS Shadow Adminsë¥¼ í¬í•¨í•˜ì—¬ ë°œê²¬í•©ë‹ˆë‹¤. PowerShellì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
```powershell
Import-Module .\SkyArk.ps1 -force
Start-AzureStealth

# in the Cloud Console
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/cyberark/SkyArk/master/AzureStealth/AzureStealth.ps1')
Scan-AzureAdmins
```
### [Cloud Brute](https://github.com/0xsha/CloudBrute)

íšŒì‚¬ì˜ (ëŒ€ìƒ) ì¸í”„ë¼, íŒŒì¼ ë° ì•±ì„ ì£¼ìš” í´ë¼ìš°ë“œ ì œê³µì—…ì²´(ì•„ë§ˆì¡´, êµ¬ê¸€, ë§ˆì´í¬ë¡œì†Œí”„íŠ¸, ë””ì§€í„¸ì˜¤ì…˜, ì•Œë¦¬ë°”ë°”, ë²ŒíŠ¸ë¥´, ë¦¬ë…¸ë“œ)ì—ì„œ ì°¾ê¸° ìœ„í•œ ë„êµ¬ì…ë‹ˆë‹¤.

### [CloudFox](https://github.com/BishopFox/cloudfox)

* CloudFoxëŠ” í´ë¼ìš°ë“œ ì¸í”„ë¼ì—ì„œ ì•…ìš© ê°€ëŠ¥í•œ ê³µê²© ê²½ë¡œë¥¼ ì°¾ê¸° ìœ„í•œ ë„êµ¬ì…ë‹ˆë‹¤(í˜„ì¬ AWS ë° Azureë§Œ ì§€ì›í•˜ë©° GCPëŠ” ê³§ ì§€ì› ì˜ˆì •).
* ìˆ˜ë™ pentestingì„ ë³´ì™„í•˜ê¸° ìœ„í•œ ì—´ê±° ë„êµ¬ì…ë‹ˆë‹¤.
* í´ë¼ìš°ë“œ í™˜ê²½ ë‚´ì—ì„œ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### í´ë¼ìš°ë“œ ë³´ì•ˆ ë„êµ¬ ëª©ë¡ ë” ë³´ê¸°

* [https://github.com/RyanJarv/awesome-cloud-sec](https://github.com/RyanJarv/awesome-cloud-sec)

## êµ¬ê¸€

### GCP

{% content-ref url="gcp-security/" %}
[gcp-security](gcp-security/)
{% endcontent-ref %}

### Workspace

{% content-ref url="workspace-security/" %}
[workspace-security](workspace-security/)
{% endcontent-ref %}

## AWS

{% content-ref url="aws-security/" %}
[aws-security](aws-security/)
{% endcontent-ref %}

## Azure

{% content-ref url="azure-security/" %}
[azure-security](azure-security/)
{% endcontent-ref %}

### ê³µê²© ê·¸ë˜í”„

[**Stormspotter** ](https://github.com/Azure/Stormspotter)ëŠ” Azure êµ¬ë…ì˜ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ â€œê³µê²© ê·¸ë˜í”„â€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ëŠ” ë ˆë“œíŒ€ê³¼ pentesterê°€ í…Œë„ŒíŠ¸ ë‚´ì—ì„œ ê³µê²© í‘œë©´ê³¼ í”¼ë²— ê¸°íšŒë¥¼ ì‹œê°í™”í•  ìˆ˜ ìˆê²Œ í•˜ë©°, ë°©ì–´ìê°€ ì‚¬ê±´ ëŒ€ì‘ ì‘ì—…ì„ ì‹ ì†í•˜ê²Œ ì •ë ¬í•˜ê³  ìš°ì„ ìˆœìœ„ë¥¼ ì •í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•©ë‹ˆë‹¤.

### Office365

**Global Admin** ë˜ëŠ” ìµœì†Œí•œ **Global Admin Reader**ê°€ í•„ìš”í•©ë‹ˆë‹¤(ë‹¨, Global Admin ReaderëŠ” ì•½ê°„ ì œí•œì ì…ë‹ˆë‹¤). ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ì œí•œì€ ì¼ë¶€ PS ëª¨ë“ˆì—ì„œ ë‚˜íƒ€ë‚˜ë©° **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í†µí•´** ê¸°ëŠ¥ì— ì ‘ê·¼í•˜ì—¬ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
