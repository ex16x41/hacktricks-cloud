# Exposing Services in Kubernetes

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ **Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿Î¯ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± ÎµÎºÎ¸Î­ÏƒÎµÏ„Îµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚** ÏƒÏ„Î¿ Kubernetes Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ Ï„ÏŒÏƒÎ¿ Î¿Î¹ **ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚** ÏŒÏƒÎ¿ ÎºÎ±Î¹ Î¿Î¹ **ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚** Ï„ÎµÎ»Î¹ÎºÎ­Ï‚ ÏƒÎ·Î¼ÎµÎ¯Î± Î½Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÎ¿Ï…Î½. Î‘Ï…Ï„Î® Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï„Î¿Ï… Kubernetes ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ ÎºÏÎ¯ÏƒÎ¹Î¼Î· ÎºÎ±Î¸ÏÏ‚ Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± Î´ÏÏƒÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ **ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï…Ï‚ ÏƒÎµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï€Î¿Ï… Î´ÎµÎ½ Î¸Î± Î­Ï€ÏÎµÏ€Îµ Î½Î± Î­Ï‡Î¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·**.

### Automatic Enumeration

Î ÏÎ¹Î½ Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ Î½Î± Î±Ï€Î±ÏÎ¹Î¸Î¼ÎµÎ¯Ï„Îµ Ï„Î¿Ï…Ï‚ Ï„ÏÏŒÏ€Î¿Ï…Ï‚ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ†Î­ÏÎµÎ¹ Ï„Î¿ K8s Î³Î¹Î± Î½Î± ÎµÎºÎ¸Î­ÏƒÎµÎ¹ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÏƒÏ„Î¿ ÎºÎ¿Î¹Î½ÏŒ, Î³Î½Ï‰ÏÎ¯ÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ namespaces, Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¹ ingresses, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î± Ï€Î¬Î½Ï„Î± ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½Î± ÏƒÏ„Î¿ ÎºÎ¿Î¹Î½ÏŒ Î¼Îµ:
```bash
kubectl get namespace -o custom-columns='NAME:.metadata.name' | grep -v NAME | while IFS='' read -r ns; do
echo "Namespace: $ns"
kubectl get service -n "$ns"
kubectl get ingress -n "$ns"
echo "=============================================="
echo ""
echo ""
done | grep -v "ClusterIP"
# Remove the last '| grep -v "ClusterIP"' to see also type ClusterIP
```
### ClusterIP

ÎœÎ¹Î± **ClusterIP** Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ¯Î½Î±Î¹ Î· **Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î·** Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Kubernetes. Î£Î±Ï‚ Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± **Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Î¼Î­ÏƒÎ±** ÏƒÏ„Î¿ cluster ÏƒÎ±Ï‚ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÎ¿Ï…Î½ Î¬Î»Î»ÎµÏ‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ cluster ÏƒÎ±Ï‚. Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ **ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ® Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·**.

Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Ï…Ï„ÏŒ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î±ÏƒÏ„ÎµÎ¯ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ Kubernetes Proxy:
```bash
kubectl proxy --port=8080
```
Î¤ÏÏÎ±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï€Î»Î¿Î·Î³Î·Î¸ÎµÎ¯Ï„Îµ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… Kubernetes API Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ‡Î®Î¼Î±:

`http://localhost:8080/api/v1/proxy/namespaces/<NAMESPACE>/services/<SERVICE-NAME>:<PORT-NAME>/`

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ Î±ÎºÏŒÎ»Î¿Ï…Î¸Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· URL:

`http://localhost:8080/api/v1/proxy/namespaces/default/services/my-internal-service:http/`

Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-internal-service
spec:
selector:
app: my-app
type: ClusterIP
ports:
- name: http
port: 80
targetPort: 80
protocol: TCP
```
_Î‘Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯Ï„Îµ Ï„Î¿ `kubectl` Ï‰Ï‚ **ÎµÏ€Î±Î»Î·Î¸ÎµÏ…Î¼Î­Î½Î¿Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚**._

Î›Î¯ÏƒÏ„Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ ClusterIPs:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,PORT(S):.spec.ports[*].port,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep ClusterIP
```
{% endcode %}

### NodePort

ÎŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Ï„Î¿ **NodePort**, Î¼Î¹Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î· Î¸ÏÏÎ± ÎµÎ¯Î½Î±Î¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î· ÏƒÎµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ ÎšÏŒÎ¼Î²Î¿Ï…Ï‚ (Ï€Î¿Ï… Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎ¿Ï…Î½ Ï„Î¹Ï‚ Î•Î¹ÎºÎ¿Î½Î¹ÎºÎ­Ï‚ ÎœÎ·Ï‡Î±Î½Î­Ï‚). **Î— ÎºÎ¯Î½Î·ÏƒÎ·** Ï€Î¿Ï… ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î· ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Î¸ÏÏÎ± **Î´ÏÎ¿Î¼Î¿Î»Î¿Î³ÎµÎ¯Ï„Î±Î¹ ÏƒÏ…ÏƒÏ„Î·Î¼Î±Ï„Î¹ÎºÎ¬ ÏƒÏ„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±**. Î£Ï…Î½Î®Î¸Ï‰Ï‚, Î±Ï…Ï„Î® Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Î´ÎµÎ½ ÏƒÏ…Î½Î¹ÏƒÏ„Î¬Ï„Î±Î¹ Î»ÏŒÎ³Ï‰ Ï„Ï‰Î½ Î¼ÎµÎ¹Î¿Î½ÎµÎºÏ„Î·Î¼Î¬Ï„Ï‰Î½ Ï„Î·Ï‚.

Î›Î¯ÏƒÏ„Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ NodePorts:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,PORT(S):.spec.ports[*].port,NODEPORT(S):.spec.ports[*].nodePort,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep NodePort
```
{% endcode %}

ÎˆÎ½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï€ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î®Ï‚ NodePort:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-nodeport-service
spec:
selector:
app: my-app
type: NodePort
ports:
- name: http
port: 80
targetPort: 80
nodePort: 30036
protocol: TCP
```
Î‘Î½ **Î´ÎµÎ½ ÎºÎ±Î¸Î¿ÏÎ¯ÏƒÎµÏ„Îµ** Ï„Î¿ **nodePort** ÏƒÏ„Î¿ yaml (ÎµÎ¯Î½Î±Î¹ Î· Î¸ÏÏÎ± Ï€Î¿Ï… Î¸Î± Î±Î½Î¿Î¹Ï‡Ï„ÎµÎ¯) Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¼Î¹Î± Î¸ÏÏÎ± ÏƒÏ„Î·Î½ **ÎµÎ¼Î²Î­Î»ÎµÎ¹Î± 30000â€“32767**.

### LoadBalancer <a href="#id-0d96" id="id-0d96"></a>

Î•ÎºÎ¸Î­Ï„ÎµÎ¹ Ï„Î·Î½ Î¥Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¬ **Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿Î½ Ï†Î¿ÏÏ„Ï‰Ï„Î® Î¹ÏƒÏ‡ÏÎ¿Ï‚ ÎµÎ½ÏŒÏ‚ Ï€Î±ÏÏŒÏ‡Î¿Ï… cloud**. Î£Ï„Î¿ GKE, Î±Ï…Ï„ÏŒ Î¸Î± ÎµÎºÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î­Î½Î±Î½ [Network Load Balancer](https://cloud.google.com/compute/docs/load-balancing/network/) Ï€Î¿Ï… Î¸Î± ÏƒÎ±Ï‚ Î´ÏÏƒÎµÎ¹ Î¼Î¹Î± Î¼Î¿Î½Î±Î´Î¹ÎºÎ® Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP Ï€Î¿Ï… Î¸Î± Ï€ÏÎ¿Ï‰Î¸ÎµÎ¯ ÏŒÎ»Î· Ï„Î·Î½ ÎºÎ¯Î½Î·ÏƒÎ· ÏƒÏ„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÎ±Ï‚. Î£Ï„Î¿ AWS Î¸Î± ÎµÎºÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î­Î½Î±Î½ Load Balancer.

Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€Î»Î·ÏÏÏƒÎµÏ„Îµ Î³Î¹Î± Î­Î½Î±Î½ LoadBalancer Î±Î½Î¬ ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î±, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±ÎºÏÎ¹Î²ÏŒ.

Î›Î¯ÏƒÏ„Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ LoadBalancers:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,EXTERNAL-IP:.status.loadBalancer.ingress[*],PORT(S):.spec.ports[*].port,NODEPORT(S):.spec.ports[*].nodePort,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep LoadBalancer
```
{% endcode %}

### Î•Î¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ IP <a href="#external-ips" id="external-ips"></a>

{% hint style="success" %}
ÎŸÎ¹ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ IP ÎµÎºÏ„Î¯Î¸ÎµÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï„ÏÏ€Î¿Ï… Load Balancers ÎºÎ±Î¹ Î³ÎµÎ½Î¹ÎºÎ¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î­Î½Î±Ï‚ ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÏŒÏ‚ Load Balancer Cloud Provider.

Î“Î¹Î± Î½Î± Ï„Î¹Ï‚ Î²ÏÎµÎ¯Ï„Îµ, ÎµÎ»Î­Î³Î¾Ï„Îµ Î³Î¹Î± load balancers Î¼Îµ Ï„Î¹Î¼Î­Ï‚ ÏƒÏ„Î¿ Ï€ÎµÎ´Î¯Î¿ `EXTERNAL-IP`.
{% endhint %}

Î— ÎºÎ¯Î½Î·ÏƒÎ· Ï€Î¿Ï… ÎµÎ¹ÏƒÎ­ÏÏ‡ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ cluster Î¼Îµ Ï„Î·Î½ **ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ® IP** (Ï‰Ï‚ **destination IP**), ÏƒÏ„Î·Î½ Î¸ÏÏÎ± Ï„Î·Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚, Î¸Î± **Î´ÏÎ¿Î¼Î¿Î»Î¿Î³Î·Î¸ÎµÎ¯ ÏƒÎµ Î­Î½Î± Î±Ï€ÏŒ Ï„Î± endpoints Ï„Î·Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚**. ÎŸÎ¹ `externalIPs` Î´ÎµÎ½ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ Kubernetes ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¸ÏÎ½Î· Ï„Î¿Ï… Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® Ï„Î¿Ï… cluster.

Î£Ï„Î·Î½ Ï€ÏÎ¿Î´Î¹Î±Î³ÏÎ±Ï†Î® Ï„Î·Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚, Î¿Î¹ `externalIPs` Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„Î¿ÏÎ½ Î¼Î±Î¶Î¯ Î¼Îµ Î¿Ï€Î¿Î¹Î¿Î½Î´Î®Ï€Î¿Ï„Îµ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ `ServiceTypes`. Î£Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, "`my-service`" Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î±ÏƒÏ„ÎµÎ¯ Î±Ï€ÏŒ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ ÏƒÏ„Î¿ "`80.11.12.10:80`" (`externalIP:port`)
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-service
spec:
selector:
app: MyApp
ports:
- name: http
protocol: TCP
port: 80
targetPort: 9376
externalIPs:
- 80.11.12.10
```
### ExternalName

[**Î‘Ï€ÏŒ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î±:**](https://kubernetes.io/docs/concepts/services-networking/service/#externalname) ÎŸÎ¹ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï„ÏÏ€Î¿Ï… ExternalName **Ï‡Î±ÏÏ„Î¿Î³ÏÎ±Ï†Î¿ÏÎ½ Î¼Î¹Î± Î¥Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÎµ Î­Î½Î± ÏŒÎ½Î¿Î¼Î± DNS**, ÏŒÏ‡Î¹ ÏƒÎµ Î­Î½Î±Î½ Ï„Ï…Ï€Î¹ÎºÏŒ ÎµÏ€Î¹Î»ÎµÎ³Î­Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `my-service` Î® Ï„Î¿ `cassandra`. Î‘Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Ï„Î¹Ï‚ ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÏ„Îµ Î¼Îµ Ï„Î·Î½ Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿ `spec.externalName`.

Î‘Ï…Ï„Î® Î· Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚, Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Ï‡Î±ÏÏ„Î¿Î³ÏÎ±Ï†ÎµÎ¯ Ï„Î·Î½ Î¥Ï€Î·ÏÎµÏƒÎ¯Î± `my-service` ÏƒÏ„Î¿ namespace `prod` ÏƒÏ„Î¿ `my.database.example.com`:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-service
namespace: prod
spec:
type: ExternalName
externalName: my.database.example.com
```
ÎŒÏ„Î±Î½ Î±Î½Î±Î¶Î·Ï„Î¬Ï„Îµ Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿ `my-service.prod.svc.cluster.local`, Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± DNS Ï„Î¿Ï… ÎºÎ»Î¬ÏƒÎ¼Î±Ï„Î¿Ï‚ ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ Î¼Î¹Î± ÎµÎ³Î³ÏÎ±Ï†Î® `CNAME` Î¼Îµ Ï„Î·Î½ Ï„Î¹Î¼Î® `my.database.example.com`. Î— Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¿ `my-service` Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ Î¯Î´Î¹Î¿ Ï„ÏÏŒÏ€Î¿ ÏŒÏ€Ï‰Ï‚ ÎºÎ±Î¹ Î¬Î»Î»ÎµÏ‚ Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚, Î±Î»Î»Î¬ Î¼Îµ Ï„Î· ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ® Î´Î¹Î±Ï†Î¿ÏÎ¬ ÏŒÏ„Î¹ **Î· Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÎµ ÎµÏ€Î¯Ï€ÎµÎ´Î¿ DNS** Î±Î½Ï„Î¯ Î¼Î­ÏƒÏ‰ Ï€ÏÎ¿Î¾ÎµÎ½Î¯Î¿Ï… Î® Ï€ÏÎ¿ÏÎ¸Î·ÏƒÎ·Ï‚.

Î›Î¯ÏƒÏ„Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ ExternalNames:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces | grep ExternalName
```
{% endcode %}

### Ingress

Î£Îµ Î±Î½Ï„Î¯Î¸ÎµÏƒÎ· Î¼Îµ ÏŒÎ»Î± Ï„Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±, **Ï„Î¿ Ingress Î”Î•Î ÎµÎ¯Î½Î±Î¹ Ï„ÏÏ€Î¿Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚**. Î‘Î½Ï„Î¯Î¸ÎµÏ„Î±, Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ **Î¼Ï€ÏÎ¿ÏƒÏ„Î¬ Î±Ï€ÏŒ Ï€Î¿Î»Î»Î­Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÎºÎ±Î¹ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï‰Ï‚ â€œÎ­Î¾Ï…Ï€Î½Î¿Ï‚ Î´ÏÎ¿Î¼Î¿Î»Î¿Î³Î·Ï„Î®Ï‚â€** Î® ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎ¹ÏƒÏŒÎ´Î¿Ï… ÏƒÏ„Î¿ cluster ÏƒÎ±Ï‚.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Ï€Î¿Î»Î»Î¬ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ Ï€ÏÎ¬Î³Î¼Î±Ï„Î± Î¼Îµ Î­Î½Î± Ingress, ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ **Ï€Î¿Î»Î»Î¿Î¯ Ï„ÏÏ€Î¿Î¹ ÎµÎ»ÎµÎ³ÎºÏ„ÏÎ½ Ingress Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„ÎµÏ‚**.

ÎŸ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï‚ ÎµÎ»ÎµÎ³ÎºÏ„Î®Ï‚ ingress GKE Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î­Î½Î±Î½ [HTTP(S) Load Balancer](https://cloud.google.com/compute/docs/load-balancing/http/) Î³Î¹Î± ÎµÏƒÎ¬Ï‚. Î‘Ï…Ï„ÏŒ Î¸Î± ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ Î´ÏÎ¿Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ· Ï„ÏŒÏƒÎ¿ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® ÏŒÏƒÎ¿ ÎºÎ±Î¹ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿ Ï…Ï€Î¿Ï„Î¿Î¼Î­Î± Ï€ÏÎ¿Ï‚ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ backend. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÏ„Îµ Ï„Î± Ï€Î¬Î½Ï„Î± ÏƒÏ„Î¿ foo.yourdomain.com ÏƒÏ„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± foo, ÎºÎ±Î¹ Ï„Î± Ï€Î¬Î½Ï„Î± ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® yourdomain.com/bar/ ÏƒÏ„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± bar.

Î¤Î¿ YAML Î³Î¹Î± Î­Î½Î± Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ingress ÏƒÏ„Î¿ GKE Î¼Îµ Î­Î½Î±Î½ [L7 HTTP Load Balancer](https://cloud.google.com/compute/docs/load-balancing/http/) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î¿Î¹Î¬Î¶ÎµÎ¹ Î­Ï„ÏƒÎ¹:
```yaml
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
name: my-ingress
spec:
backend:
serviceName: other
servicePort: 8080
rules:
- host: foo.mydomain.com
http:
paths:
- backend:
serviceName: foo
servicePort: 8080
- host: mydomain.com
http:
paths:
- path: /bar/*
backend:
serviceName: bar
servicePort: 8080
```
ÎšÎ±Ï„Î±Î³ÏÎ¬ÏˆÏ„Îµ ÏŒÎ»Î± Ï„Î± ingresses:

{% code overflow="wrap" %}
```bash
kubectl get ingresses --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,RULES:spec.rules[*],STATUS:status'
```
{% endcode %}

Î‘Î½ ÎºÎ±Î¹ ÏƒÎµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î»ÏÏ„ÎµÏÎ¿ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î· ÎºÎ±Î¸ÎµÎ¼Î¯Î± Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ Î³Î¹Î± Î½Î± Ï„Î¹Ï‚ Î´Î¹Î±Î²Î¬ÏƒÎµÏ„Îµ ÎºÎ±Î»ÏÏ„ÎµÏÎ±:
```bash
kubectl get ingresses --all-namespaces -o=yaml
```
### Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* [https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0](https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0)
* [https://kubernetes.io/docs/concepts/services-networking/service/](https://kubernetes.io/docs/concepts/services-networking/service/)

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
