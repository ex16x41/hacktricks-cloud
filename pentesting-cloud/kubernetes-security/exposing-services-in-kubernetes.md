# Kubernetes рдореЗрдВ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

Kubernetes рдореЗрдВ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреЗ **рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ** рд╣реИрдВ рддрд╛рдХрд┐ **рдЖрдВрддрд░рд┐рдХ** рдПрдВрдбрдкреЙрдЗрдВрдЯ рдФрд░ **рдмрд╛рд╣рд░реА** рдПрдВрдбрдкреЙрдЗрдВрдЯ рджреЛрдиреЛрдВ рдЙрдиреНрд╣реЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХреЗрдВред рдпрд╣ Kubernetes рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛рдлреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ **рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдЙрди рд╕реЗрд╡рд╛рдУрдВ рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рди рддрдХ рдЙрдиреНрд╣реЗрдВ рдкрд╣реБрдБрдЪ рдирд╣реАрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**ред

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реВрдЪреАрдХрд░рдг

K8s рджреНрд╡рд╛рд░рд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЬрд╛рди рд▓реЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдирд╛рдорд╕реНрдерд╛рди, рд╕реЗрд╡рд╛рдУрдВ рдФрд░ рдЗрдирдЧреНрд░реЗрд╕реЗрд╕ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдЬрд╛рдЧрд░ рдХреА рдЧрдИ рд╕рднреА рдЪреАрдЬрд╝реЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
kubectl get namespace -o custom-columns='NAME:.metadata.name' | grep -v NAME | while IFS='' read -r ns; do
echo "Namespace: $ns"
kubectl get service -n "$ns"
kubectl get ingress -n "$ns"
echo "=============================================="
echo ""
echo ""
done | grep -v "ClusterIP"
# Remove the last '| grep -v "ClusterIP"' to see also type ClusterIP
```
### ClusterIP

A **ClusterIP** рд╕реЗрд╡рд╛ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** Kubernetes **рд╕реЗрд╡рд╛** рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рдЕрдВрджрд░ рдПрдХ **рд╕реЗрд╡рд╛** рджреЗрддреА рд╣реИ рдЬрд┐рд╕реЗ рдЖрдкрдХреЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рдЕрдВрджрд░ рдЕрдиреНрдп рдРрдкреНрд╕ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣рд╛рдБ **рдХреЛрдИ рдмрд╛рд╣рд░реА рдПрдХреНрд╕реЗрд╕** рдирд╣реАрдВ рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ Kubernetes рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
kubectl proxy --port=8080
```
рдЕрдм, рдЖрдк рдЗрд╕ рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛рдУрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП Kubernetes API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`http://localhost:8080/api/v1/proxy/namespaces/<NAMESPACE>/services/<SERVICE-NAME>:<PORT-NAME>/`

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд URL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`http://localhost:8080/api/v1/proxy/namespaces/default/services/my-internal-service:http/`

рдЗрд╕ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-internal-service
spec:
selector:
app: my-app
type: ClusterIP
ports:
- name: http
port: 80
targetPort: 80
protocol: TCP
```
_рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЗ рд░реВрдк рдореЗрдВ `kubectl` рдЪрд▓рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред_

рд╕рднреА ClusterIPs рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,PORT(S):.spec.ports[*].port,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep ClusterIP
```
{% endcode %}

### NodePort

рдЬрдм **NodePort** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рднреА рдиреЛрдбреНрд╕ (рдЬреЛ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрдиреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддреЗ рд╣реИрдВ) рдкрд░ рдПрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкреЛрд░реНрдЯ рдЙрдкрд▓рдмреНрдз рдХрд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рдкреЛрд░реНрдЯ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд **Traffic** рдХреЛ рдлрд┐рд░ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рд░реВрдк рд╕реЗ **рд╕реЗрд╡рд╛** рдХреА рдУрд░ **рд░реВрдЯ** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдорддреМрд░ рдкрд░, рдЗрд╕ рд╡рд┐рдзрд┐ рдХреА рдХрдорд┐рдпреЛрдВ рдХреЗ рдХрд╛рд░рдг рдЗрд╕рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИред

рд╕рднреА NodePorts рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,PORT(S):.spec.ports[*].port,NODEPORT(S):.spec.ports[*].nodePort,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep NodePort
```
{% endcode %}

NodePort рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-nodeport-service
spec:
selector:
app: my-app
type: NodePort
ports:
- name: http
port: 80
targetPort: 80
nodePort: 30036
protocol: TCP
```
рдпрджрд┐ рдЖрдк yaml рдореЗрдВ **nodePort** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ (рдпрд╣ рд╡рд╣ рдкреЛрд░реНрдЯ рд╣реИ рдЬреЛ рдЦреЛрд▓рд╛ рдЬрд╛рдПрдЧрд╛), рддреЛ **30000тАУ32767 рдХреА рд╕реАрдорд╛ рдореЗрдВ рдПрдХ рдкреЛрд░реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред

### LoadBalancer <a href="#id-0d96" id="id-0d96"></a>

рд╕реЗрд╡рд╛ рдХреЛ рдмрд╛рд╣рд░реА рд░реВрдк рд╕реЗ **рдПрдХ рдХреНрд▓рд╛рдЙрдб рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ** рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред GKE рдкрд░, рдпрд╣ рдПрдХ [рдиреЗрдЯрд╡рд░реНрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░](https://cloud.google.com/compute/docs/load-balancing/network/) рдЪрд╛рд▓реВ рдХрд░реЗрдЧрд╛ рдЬреЛ рдЖрдкрдХреЛ рдПрдХрд▓ IP рдкрддрд╛ рджреЗрдЧрд╛ рдЬреЛ рдЖрдкрдХреЗ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рд╕рднреА рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░реЗрдЧрд╛ред AWS рдкрд░ рдпрд╣ рдПрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рд▓реЙрдиреНрдЪ рдХрд░реЗрдЧрд╛ред

рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЙрдЬрд╛рдЧрд░ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреЗ рд▓рд┐рдП рднреБрдЧрддрд╛рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рдорд╣рдВрдЧрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рд╕рднреА рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,TYPE:.spec.type,CLUSTER-IP:.spec.clusterIP,EXTERNAL-IP:.status.loadBalancer.ingress[*],PORT(S):.spec.ports[*].port,NODEPORT(S):.spec.ports[*].nodePort,TARGETPORT(S):.spec.ports[*].targetPort,SELECTOR:.spec.selector' | grep LoadBalancer
```
{% endcode %}

### External IPs <a href="#external-ips" id="external-ips"></a>

{% hint style="success" %}
рдмрд╛рд╣рд░реА IPs рдХреЛ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЬрдм рдПрдХ рдмрд╛рд╣рд░реА рдХреНрд▓рд╛рдЙрдб рдкреНрд░рджрд╛рддрд╛ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдорддреМрд░ рдкрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, `EXTERNAL-IP` рдлрд╝реАрд▓реНрдб рдореЗрдВ рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
{% endhint %}

рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ **рдмрд╛рд╣рд░реА IP** (рдЬреИрд╕реЗ **рдЧрдВрддрд╡реНрдп IP**) рдХреЗ рд╕рд╛рде рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдЯреНрд░реИрдлрд╝рд┐рдХ, рд╕реЗрд╡рд╛ рдкреЛрд░реНрдЯ рдкрд░, **рд╕реЗрд╡рд╛ рдХреЗ рдПрдХ рдЕрдВрдд рдмрд┐рдВрджреБ** рдХреА рдУрд░ **рд░реВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред `externalIPs` рдХреЛ Kubernetes рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдХреНрд▓рд╕реНрдЯрд░ рдкреНрд░рд╢рд╛рд╕рдХ рдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рд╣реЛрддреА рд╣реИред

рд╕реЗрд╡рд╛ рд╕реНрдкреЗрдХ рдореЗрдВ, `externalIPs` рдХреЛ рдХрд┐рд╕реА рднреА `ServiceTypes` рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, "`my-service`" рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ "`80.11.12.10:80`" (`externalIP:port`) рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-service
spec:
selector:
app: MyApp
ports:
- name: http
protocol: TCP
port: 80
targetPort: 9376
externalIPs:
- 80.11.12.10
```
### ExternalName

[**From the docs:**](https://kubernetes.io/docs/concepts/services-networking/service/#externalname) ExternalName рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдПрдБ **рдПрдХ рд╕реЗрд╡рд╛ рдХреЛ DNS рдирд╛рдо рд╕реЗ рдореИрдк рдХрд░рддреА рд╣реИрдВ**, рди рдХрд┐ рдХрд┐рд╕реА рд╕рд╛рдорд╛рдиреНрдп рдЪрдпрдирдХрд░реНрддрд╛ рдЬреИрд╕реЗ `my-service` рдпрд╛ `cassandra` рдХреЗ рд▓рд┐рдПред рдЖрдк рдЗрди рд╕реЗрд╡рд╛рдУрдВ рдХреЛ `spec.externalName` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВред

рдпрд╣ рд╕реЗрд╡рд╛ рдкрд░рд┐рднрд╛рд╖рд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `prod` рдирд╛рдорд╕реНрдерд╛рди рдореЗрдВ `my-service` рд╕реЗрд╡рд╛ рдХреЛ `my.database.example.com` рд╕реЗ рдореИрдк рдХрд░рддреА рд╣реИ:
```yaml
apiVersion: v1
kind: Service
metadata:
name: my-service
namespace: prod
spec:
type: ExternalName
externalName: my.database.example.com
```
рдЬрдм `my-service.prod.svc.cluster.local` рд╣реЛрд╕реНрдЯ рдХреЛ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреНрд▓рд╕реНрдЯрд░ DNS рд╕реЗрд╡рд╛ рдПрдХ `CNAME` рд░рд┐рдХреЙрд░реНрдб рд▓реМрдЯрд╛рддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдорд╛рди `my.database.example.com` рд╣реИред `my-service` рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреА рддрд░рд╣ рд╣реА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрдВрддрд░ рдХреЗ рд╕рд╛рде рдХрд┐ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди DNS рд╕реНрддрд░ рдкрд░ рд╣реЛрддрд╛ рд╣реИ** рди рдХрд┐ рдкреНрд░реЙрдХреНрд╕реА рдпрд╛ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

рд╕рднреА ExternalNames рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:

{% code overflow="wrap" %}
```bash
kubectl get services --all-namespaces | grep ExternalName
```
{% endcode %}

### Ingress

рдКрдкрд░ рджрд┐рдП рдЧрдП рд╕рднреА рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд, **Ingress рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛ рдирд╣реАрдВ рд╣реИ**ред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдпрд╣ **рдХрдИ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рдордиреЗ рдмреИрдарддрд╛ рд╣реИ рдФрд░ рдПрдХ "рд╕реНрдорд╛рд░реНрдЯ рд░рд╛рдЙрдЯрд░"** рдпрд╛ рдЖрдкрдХреЗ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред

рдЖрдк Ingress рдХреЗ рд╕рд╛рде рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ **Ingress рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рдХрдИ рдкреНрд░рдХрд╛рд░ рд╣реИрдВ рдЬрд┐рдирдХреА рд╡рд┐рднрд┐рдиреНрди рдХреНрд╖рдорддрд╛рдПрдБ рд╣реИрдВ**ред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ GKE рдЗрдирдЧреНрд░реЗрд╕ рдирд┐рдпрдВрддреНрд░рдХ рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ [HTTP(S) рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░](https://cloud.google.com/compute/docs/load-balancing/http/) рдЪрд╛рд▓реВ рдХрд░реЗрдЧрд╛ред рдпрд╣ рдЖрдкрдХреЛ рдмреИрдХрдПрдВрдб рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкрде рдЖрдзрд╛рд░рд┐рдд рдФрд░ рдЙрдкрдбреЛрдореЗрди рдЖрдзрд╛рд░рд┐рдд рд░реВрдЯрд┐рдВрдЧ рджреЛрдиреЛрдВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк foo.yourdomain.com рдкрд░ рд╕рдм рдХреБрдЫ foo рд╕реЗрд╡рд╛ рдкрд░ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ yourdomain.com/bar/ рдкрде рдХреЗ рдЕрдВрддрд░реНрдЧрдд рд╕рдм рдХреБрдЫ bar рд╕реЗрд╡рд╛ рдкрд░ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред

GKE рдкрд░ [L7 HTTP рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░](https://cloud.google.com/compute/docs/load-balancing/http/) рдХреЗ рд╕рд╛рде рдПрдХ Ingress рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП YAML рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```yaml
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
name: my-ingress
spec:
backend:
serviceName: other
servicePort: 8080
rules:
- host: foo.mydomain.com
http:
paths:
- backend:
serviceName: foo
servicePort: 8080
- host: mydomain.com
http:
paths:
- path: /bar/*
backend:
serviceName: bar
servicePort: 8080
```
рд╕рднреА рдЗрдирдЧреНрд░реЗрд╕ рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ:

{% code overflow="wrap" %}
```bash
kubectl get ingresses --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,RULES:spec.rules[*],STATUS:status'
```
{% endcode %}

рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдПрдХ-рдПрдХ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ рддрд╛рдХрд┐ рдЗрд╕реЗ рдмреЗрд╣рддрд░ рддрд░реАрдХреЗ рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХреЗ:
```bash
kubectl get ingresses --all-namespaces -o=yaml
```
### References

* [https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0](https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0)
* [https://kubernetes.io/docs/concepts/services-networking/service/](https://kubernetes.io/docs/concepts/services-networking/service/)

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
