# Kubernetes Role-Based Access Control(RBAC)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Role-Based Access Control (RBAC)

Î¤Î¿ Kubernetes Î­Ï‡ÎµÎ¹ Î­Î½Î± **module ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´ÏŒÏ„Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ Role-Based Access Control** ([**RBAC**](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)) Ï€Î¿Ï… Î²Î¿Î·Î¸Î¬ ÏƒÏ„Î·Î½ ÏÏÎ¸Î¼Î¹ÏƒÎ· Ï„Ï‰Î½ Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½ Ï‡ÏÎ®ÏƒÎ·Ï‚ ÏƒÏ„Î¿Î½ API server.

Î¤Î¿ Î¼Î¿Î½Ï„Î­Î»Î¿ Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½ Ï„Î¿Ï… RBAC ÎµÎ¯Î½Î±Î¹ Î´Î¿Î¼Î·Î¼Î­Î½Î¿ Î±Ï€ÏŒ **Ï„ÏÎ¯Î± Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ Î¼Î­ÏÎ·**:

1. **Role\ClusterRole Â­â€“** Î¤Î¿ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Î´Î¹ÎºÎ±Î¯Ï‰Î¼Î±. Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ _**ÎºÎ±Î½ÏŒÎ½ÎµÏ‚**_ Ï€Î¿Ï… Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎ¿Ï…Î½ Î­Î½Î± ÏƒÏÎ½Î¿Î»Î¿ Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½. ÎšÎ¬Î¸Îµ ÎºÎ±Î½ÏŒÎ½Î±Ï‚ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ [Ï€ÏŒÏÎ¿Ï…Ï‚](https://kubernetes.io/docs/reference/kubectl/overview/#resource-types) ÎºÎ±Î¹ [ÏÎ®Î¼Î±Ï„Î±](https://kubernetes.io/docs/reference/access-authn-authz/authorization/#determine-the-request-verb). Î¤Î¿ ÏÎ®Î¼Î± ÎµÎ¯Î½Î±Î¹ Î· ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± Ï€Î¿Ï… Î¸Î± ÎµÏ†Î±ÏÎ¼Î¿ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¿Î½ Ï€ÏŒÏÎ¿.
2. **Subject (Î§ÏÎ®ÏƒÏ„Î·Ï‚, ÎŸÎ¼Î¬Î´Î± Î® ServiceAccount) â€“** Î¤Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… Î¸Î± Î»Î¬Î²ÎµÎ¹ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±.
3. **RoleBinding\ClusterRoleBinding â€“** Î— ÏƒÏÎ½Î´ÎµÏƒÎ· Î¼ÎµÏ„Î±Î¾Ï Role\ClusterRole ÎºÎ±Î¹ Ï„Î¿Ï… Ï…Ï€Î¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï….

![](https://www.cyberark.com/wp-content/uploads/2018/12/rolebiding_serviceaccount_and_role-1024x551.png)

Î— Î´Î¹Î±Ï†Î¿ÏÎ¬ Î¼ÎµÏ„Î±Î¾Ï â€œ**Roles**â€ ÎºÎ±Î¹ â€œ**ClusterRoles**â€ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ Ï„Î¿ Ï€Î¿Ï Î¸Î± ÎµÏ†Î±ÏÎ¼Î¿ÏƒÏ„ÎµÎ¯ Î¿ ÏÏŒÎ»Î¿Ï‚ â€“ Î¼Î¹Î± â€œ**Role**â€ Î¸Î± Ï€Î±ÏÎ±Ï‡Ï‰ÏÎ®ÏƒÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· Î¼ÏŒÎ½Î¿ ÏƒÎµ **Î­Î½Î±** **ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿** **namespace**, ÎµÎ½Ï Î¼Î¹Î± â€œ**ClusterRole**â€ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ ÏƒÎµ **ÏŒÎ»Î± Ï„Î± namespaces** ÏƒÏ„Î¿ cluster. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î¿Î¹ **ClusterRoles** Î¼Ï€Î¿ÏÎ¿ÏÎ½ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï€Î±ÏÎ±Ï‡Ï‰ÏÎ®ÏƒÎ¿Ï…Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ:

* **Ï€ÏŒÏÎ¿Ï…Ï‚ ÎºÎ»Î¯Î¼Î±ÎºÎ±Ï‚ cluster** (ÏŒÏ€Ï‰Ï‚ Î¿Î¹ ÎºÏŒÎ¼Î²Î¿Î¹).
* **Î¼Î·-Ï€ÏŒÏÎ¿Ï…Ï‚** endpoints (ÏŒÏ€Ï‰Ï‚ Ï„Î¿ /healthz).
* Ï€ÏŒÏÎ¿Ï…Ï‚ Î¼Îµ namespace (ÏŒÏ€Ï‰Ï‚ Ï„Î± Pods), **ÏƒÎµ ÏŒÎ»Î± Ï„Î± namespaces**.

Î‘Ï€ÏŒ Ï„Î¿ **Kubernetes** 1.6 ÎºÎ±Î¹ Î¼ÎµÏ„Î¬, Î¿Î¹ Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ­Ï‚ **RBAC** ÎµÎ¯Î½Î±Î¹ **ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½ÎµÏ‚ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®**. Î‘Î»Î»Î¬ Î³Î¹Î± Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ RBAC Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎºÎ¬Ï„Î¹ ÏŒÏ€Ï‰Ï‚:
```
kube-apiserver --authorization-mode=Example,RBAC --other-options --more-options
```
## Templates

Î£Ï„Î¿ Ï€ÏÏŒÏ„Ï…Ï€Î¿ ÎµÎ½ÏŒÏ‚ **Role** Î® ÎµÎ½ÏŒÏ‚ **ClusterRole** Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯ Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ **ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… ÏÏŒÎ»Î¿Ï…**, Ï„Î¿ **namespace** (ÏƒÎµ ÏÏŒÎ»Î¿Ï…Ï‚) ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Ï„Î¹Ï‚ **apiGroups**, **resources** ÎºÎ±Î¹ **verbs** Ï„Î¿Ï… ÏÏŒÎ»Î¿Ï…:

* ÎŸÎ¹ **apiGroups** ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î± Î´Î¹Î¬Ï†Î¿ÏÎ± **API namespaces** ÏƒÏ„Î± Î¿Ï€Î¿Î¯Î± Î¹ÏƒÏ‡ÏÎµÎ¹ Î±Ï…Ï„ÏŒÏ‚ Î¿ ÎºÎ±Î½ÏŒÎ½Î±Ï‚. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¼Î¹Î± Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Pod Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ apiVersion: v1. _ÎœÏ€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Ï„Î¹Î¼Î­Ï‚ ÏŒÏ€Ï‰Ï‚ rbac.authorization.k8s.io Î® \[\*]_.
* ÎŸÎ¹ **resources** ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï€Î¿Ï… Î¿ÏÎ¯Î¶ÎµÎ¹ **ÏƒÎµ Ï€Î¿Î¹Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ Î¹ÏƒÏ‡ÏÎµÎ¹ Î±Ï…Ï„ÏŒÏ‚ Î¿ ÎºÎ±Î½ÏŒÎ½Î±Ï‚**. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ Î¼Îµ: `kubectl api-resources --namespaced=true`
* ÎŸÎ¹ **verbs** ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î± **ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½Î± ÏÎ®Î¼Î±Ï„Î±**. Î¤Î¿ ÏÎ®Î¼Î± ÏƒÏ„Î¿ Kubernetes Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿Î½ **Ï„ÏÏ€Î¿ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±Ï‚** Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÏ„Îµ ÏƒÏ„Î¿Î½ Ï€ÏŒÏÎ¿. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Ï„Î¿ ÏÎ®Î¼Î± list Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Ï„Î¬ ÏƒÏ…Î»Î»Î¿Î³ÏÎ½ ÎµÎ½Ï Ï„Î¿ "get" Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎºÎ±Ï„Î¬ ÎµÎ½ÏŒÏ‚ Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î¿Ï… Ï€ÏŒÏÎ¿Ï….

### Rules Verbs

(_Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÎµÎ»Î®Ï†Î¸Î·ÏƒÎ±Î½ Î±Ï€ÏŒ_ [_**the docs**_](https://kubernetes.io/docs/reference/access-authn-authz/authorization/#determine-the-request-verb))

| HTTP verb | request verb                                                                                                                                                  |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| POST      | create                                                                                                                                                        |
| GET, HEAD | get (Î³Î¹Î± Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚), list (Î³Î¹Î± ÏƒÏ…Î»Î»Î¿Î³Î­Ï‚, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Î¿Ï… Ï„Î¿Ï… Ï€Î»Î®ÏÎ¿Ï…Ï‚ Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï… Î±Î½Ï„Î¹ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½), watch (Î³Î¹Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· ÎµÎ½ÏŒÏ‚ Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î¿Ï… Ï€ÏŒÏÎ¿Ï… Î® ÏƒÏ…Î»Î»Î¿Î³Î®Ï‚ Ï€ÏŒÏÏ‰Î½) |
| PUT       | update                                                                                                                                                        |
| PATCH     | patch                                                                                                                                                         |
| DELETE    | delete (Î³Î¹Î± Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚), deletecollection (Î³Î¹Î± ÏƒÏ…Î»Î»Î¿Î³Î­Ï‚)                                                                                         |

Î¤Î¿ Kubernetes Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚ ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Ï„Î·Î½ ÎµÎ¾Î¿Ï…ÏƒÎ¹Î¿Î´ÏŒÏ„Î·ÏƒÎ· Î³Î¹Î± Ï€ÏÏŒÏƒÎ¸ÎµÏ„ÎµÏ‚ Î¬Î´ÎµÎ¹ÎµÏ‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎµÎ¾ÎµÎ¹Î´Î¹ÎºÎµÏ…Î¼Î­Î½Î± ÏÎ®Î¼Î±Ï„Î±. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:

* [PodSecurityPolicy](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)
* `use` ÏÎ®Î¼Î± ÏƒÏ„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ `podsecuritypolicies` ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î± API `policy`.
* [RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#privilege-escalation-prevention-and-bootstrapping)
* `bind` ÎºÎ±Î¹ `escalate` ÏÎ®Î¼Î±Ï„Î± ÏƒÏ„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ `roles` ÎºÎ±Î¹ `clusterroles` ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î± API `rbac.authorization.k8s.io`.
* [Authentication](https://kubernetes.io/docs/reference/access-authn-authz/authentication/)
* `impersonate` ÏÎ®Î¼Î± ÏƒÏ„Î¿Ï…Ï‚ `users`, `groups`, ÎºÎ±Î¹ `serviceaccounts` ÏƒÏ„Î·Î½ ÎºÏÏÎ¹Î± Î¿Î¼Î¬Î´Î± API, ÎºÎ±Î¹ Ï„Î¿ `userextras` ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î± API `authentication.k8s.io`.

{% hint style="warning" %}
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ **ÏŒÎ»Î± Ï„Î± ÏÎ®Î¼Î±Ï„Î± Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ ÎºÎ¬Î¸Îµ Ï€ÏŒÏÎ¿Ï‚** ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚ `kubectl api-resources --sort-by name -o wide`
{% endhint %}

### Examples

{% code title="Role" %}
```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
namespace: defaultGreen
name: pod-and-pod-logs-reader
rules:
- apiGroups: [""]
resources: ["pods", "pods/log"]
verbs: ["get", "list", "watch"]
```
{% endcode %}

{% code title="ClusterRole" %}
```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
# "namespace" omitted since ClusterRoles are not namespaced
name: secret-reader
rules:
- apiGroups: [""]
resources: ["secrets"]
verbs: ["get", "watch", "list"]
```
{% endcode %}

Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î­Î½Î± **ClusterRole** Î³Î¹Î± Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÏ„Îµ ÏƒÎµ Î­Î½Î±Î½ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Ï‡ÏÎ®ÏƒÏ„Î· Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯:
```
kubectl get pods --all-namespaces
```
### **RoleBinding ÎºÎ±Î¹ ClusterRoleBinding**

[**Î‘Ï€ÏŒ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î±:**](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#rolebinding-and-clusterrolebinding) ÎˆÎ½Î± **role binding Ï€Î±ÏÎ±Ï‡Ï‰ÏÎµÎ¯ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ Ï€Î¿Ï… Î¿ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ Î­Î½Î±Î½ ÏÏŒÎ»Î¿ ÏƒÎµ Î­Î½Î±Î½ Ï‡ÏÎ®ÏƒÏ„Î· Î® ÏƒÎµ Î­Î½Î± ÏƒÏÎ½Î¿Î»Î¿ Ï‡ÏÎ·ÏƒÏ„ÏÎ½**. Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± Ï…Ï€Î¿ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½ (Ï‡ÏÎ·ÏƒÏ„ÏÎ½, Î¿Î¼Î¬Î´Ï‰Î½ Î® Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏÎ½ Ï…Ï€Î·ÏÎµÏƒÎ¹ÏÎ½) ÎºÎ±Î¹ Î¼Î¹Î± Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î¿Î½ ÏÏŒÎ»Î¿ Ï€Î¿Ï… Ï€Î±ÏÎ±Ï‡Ï‰ÏÎµÎ¯Ï„Î±Î¹. ÎˆÎ½Î± **RoleBinding** Ï€Î±ÏÎ±Ï‡Ï‰ÏÎµÎ¯ Î¬Î´ÎµÎ¹ÎµÏ‚ ÎµÎ½Ï„ÏŒÏ‚ ÎµÎ½ÏŒÏ‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿Ï… **namespace** ÎµÎ½Ï Î­Î½Î± **ClusterRoleBinding** Ï€Î±ÏÎ±Ï‡Ï‰ÏÎµÎ¯ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· **ÏƒÎµ ÏŒÎ»Î¿ Ï„Î¿ cluster**.

{% code title="" %}
```yaml
piVersion: rbac.authorization.k8s.io/v1
# This role binding allows "jane" to read pods in the "default" namespace.
# You need to already have a Role named "pod-reader" in that namespace.
kind: RoleBinding
metadata:
name: read-pods
namespace: default
subjects:
# You can specify more than one "subject"
- kind: User
name: jane # "name" is case sensitive
apiGroup: rbac.authorization.k8s.io
roleRef:
# "roleRef" specifies the binding to a Role / ClusterRole
kind: Role #this must be Role or ClusterRole
name: pod-reader # this must match the name of the Role or ClusterRole you wish to bind to
apiGroup: rbac.authorization.k8s.io
```
{% endcode %}

{% code title="ClusterRoleBinding" %}
```yaml
apiVersion: rbac.authorization.k8s.io/v1
# This cluster role binding allows anyone in the "manager" group to read secrets in any namespace.
kind: ClusterRoleBinding
metadata:
name: read-secrets-global
subjects:
- kind: Group
name: manager # Name is case sensitive
apiGroup: rbac.authorization.k8s.io
roleRef:
kind: ClusterRole
name: secret-reader
apiGroup: rbac.authorization.k8s.io
```
{% endcode %}

**ÎŸÎ¹ Î¬Î´ÎµÎ¹ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ¸ÎµÏ„Î¹ÎºÎ­Ï‚** Î¿Ï€ÏŒÏ„Îµ Î±Î½ Î­Ï‡ÎµÏ„Îµ Î­Î½Î± clusterRole Î¼Îµ â€œlistâ€ ÎºÎ±Î¹ â€œdeleteâ€ Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î¿ Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÏ„Îµ Î¼Îµ Î­Î½Î± Role Î¼Îµ â€œgetâ€. ÎŸÏ€ÏŒÏ„Îµ Î½Î± ÎµÎ¯ÏƒÏ„Îµ Ï€ÏÎ¿ÏƒÎµÎºÏ„Î¹ÎºÎ¿Î¯ ÎºÎ±Î¹ Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬Î¶ÎµÏ„Îµ Ï€Î¬Î½Ï„Î± Ï„Î¿Ï…Ï‚ ÏÏŒÎ»Î¿Ï…Ï‚ ÎºÎ±Î¹ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹Î­Ï‚ ÏƒÎ±Ï‚ ÎºÎ±Î¹ **Î½Î± ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Î•Î Î™Î¤Î¡Î•Î Î¤ÎŸ, Î³Î¹Î±Ï„Î¯ Ï„Î± Ï€Î¬Î½Ï„Î± ÎµÎ¯Î½Î±Î¹ Î‘Î Î‘Î“ÎŸÎ¡Î•Î¥ÎœÎ•ÎÎ‘ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®.**

## **ÎšÎ±Ï„Î±Î¼Î­Ï„ÏÎ·ÏƒÎ· RBAC**
```bash
# Get current privileges
kubectl auth can-i --list
# use `--as=system:serviceaccount:<namespace>:<sa_name>` to impersonate a service account

# List Cluster Roles
kubectl get clusterroles
kubectl describe clusterroles

# List Cluster Roles Bindings
kubectl get clusterrolebindings
kubectl describe clusterrolebindings

# List Roles
kubectl get roles
kubectl describe roles

# List Roles Bindings
kubectl get rolebindings
kubectl describe rolebindings
```
### ÎšÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· Î¡ÏŒÎ»Ï‰Î½/ClusterRoles Î³Î¹Î± ÎšÎ»Î¹Î¼Î¬ÎºÏ‰ÏƒÎ· Î”Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[abusing-roles-clusterroles-in-kubernetes](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
