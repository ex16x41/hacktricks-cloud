# Kubernetes SecurityContext(s)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## PodSecurityContext <a href="#podsecuritycontext-v1-core" id="podsecuritycontext-v1-core"></a>

[**Belgelerden:**](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core)

Bir Pod'un gÃ¼venlik baÄŸlamÄ±nÄ± belirtirken birkaÃ§ Ã¶zellik kullanabilirsiniz. Savunma gÃ¼venliÄŸi aÃ§Ä±sÄ±ndan dikkate almanÄ±z gerekenler:

* **runASNonRoot**'u **True** olarak ayarlamak
* **runAsUser**'Ä± yapÄ±landÄ±rmak
* MÃ¼mkÃ¼nse, **seLinuxOptions** ve **seccompProfile** belirterek **izinleri** **sÄ±nÄ±rlamayÄ±** dÃ¼ÅŸÃ¼nmek
* **runAsGroup** ve **supplementaryGroups** aracÄ±lÄ±ÄŸÄ±yla **yetki** **grubu** eriÅŸimi vermemek

| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>fsGroup</strong></a><br><em>integer</em></p>                                                                                                                                                                                                                                                 | <p>Bir <strong>pod'daki tÃ¼m konteynerlere</strong> uygulanan Ã¶zel bir ek gruptur. BazÄ± hacim tÃ¼rleri, Kubelet'in bu hacmin <strong>sahipliÄŸini deÄŸiÅŸtirmesine</strong> izin verir:<br>1. Sahip GID FSGroup olacaktÄ±r<br>2. setgid biti ayarlanmÄ±ÅŸtÄ±r (hacimde oluÅŸturulan yeni dosyalar FSGroup tarafÄ±ndan sahip olunacaktÄ±r)<br>3. Ä°zin bitleri rw-rw---- ile OR'lanÄ±r. Ayarlanmazsa, Kubelet herhangi bir hacmin sahipliÄŸini ve izinlerini deÄŸiÅŸtirmeyecektir.</p> |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>fsGroupChangePolicy</strong></a><br><em>string</em></p>                                                                                                                                                                                                                                      | Bu, Pod iÃ§inde sergilenmeden Ã¶nce **hacmin sahipliÄŸini ve iznini deÄŸiÅŸtirme** davranÄ±ÅŸÄ±nÄ± tanÄ±mlar.                                                                                                                                                                                                                                                                                                                                                                         |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>runAsGroup</strong></a><br><em>integer</em></p>                                                                                                                                                                                                                                              | Konteyner sÃ¼recinin giriÅŸ noktasÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in **GID**. Ayarlanmazsa Ã§alÄ±ÅŸma zamanÄ± varsayÄ±lanÄ±nÄ± kullanÄ±r.                                                                                                                                                                                                                                                                                                                                                        |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>runAsNonRoot</strong></a><br><em>boolean</em></p>                                                                                                                                                                                                                                            | Konteynerin kÃ¶k olmayan bir kullanÄ±cÄ± olarak Ã§alÄ±ÅŸmasÄ± gerektiÄŸini belirtir. DoÄŸruysa, Kubelet, gÃ¶rÃ¼ntÃ¼yÃ¼ Ã§alÄ±ÅŸma zamanÄ±nda UID 0 (kÃ¶k) olarak Ã§alÄ±ÅŸmadÄ±ÄŸÄ±ndan emin olmak iÃ§in doÄŸrulayacak ve Ã§alÄ±ÅŸtÄ±rmazsa konteyneri baÅŸlatmayÄ± baÅŸarÄ±sÄ±z kÄ±lacaktÄ±r.                                                                                                                                                                                                                  |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>runAsUser</strong></a><br><em>integer</em></p>                                                                                                                                                                                                                                               | Konteyner sÃ¼recinin giriÅŸ noktasÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in **UID**. BelirtilmemiÅŸse, gÃ¶rÃ¼ntÃ¼ meta verilerinde belirtilen kullanÄ±cÄ±ya varsayÄ±lan olarak ayarlanÄ±r.                                                                                                                                                                                                                                                                                                                                                              |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>seLinuxOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#selinuxoptions-v1-core"><em>SELinuxOptions</em></a><br><em>HakkÄ±nda daha fazla bilgi</em> <em><strong>seLinux</strong></em></p>                                                           | TÃ¼m konteynerlere uygulanacak **SELinux baÄŸlamÄ±**. BelirtilmemiÅŸse, konteyner Ã§alÄ±ÅŸma zamanÄ± her konteyner iÃ§in rastgele bir SELinux baÄŸlamÄ± tahsis edecektir.                                                                                                                                                                                                                                                                                                                             |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>seccompProfile</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#seccompprofile-v1-core"><em>SeccompProfile</em></a><br><em>HakkÄ±nda daha fazla bilgi</em> <em><strong>Seccomp</strong></em></p>                                                           | Bu pod'daki konteynerler tarafÄ±ndan kullanÄ±lacak **seccomp seÃ§enekleri**.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>supplementalGroups</strong></a><br><em>integer array</em></p>                                                                                                                                                                                                                                | Her konteynerde Ã§alÄ±ÅŸtÄ±rÄ±lan ilk sÃ¼reÃ§ iÃ§in ek olarak uygulanan **gruplarÄ±n** bir listesi.                                                                                                                                                                                                                                                                                                                                                                  |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>sysctls</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#sysctl-v1-core"><em>Sysctl</em></a> <em>dizi</em><br><em>HakkÄ±nda daha fazla bilgi</em> <a href="https://www.garron.me/en/go2linux/sysctl-linux.html"><em><strong>sysctls</strong></em></a></p> | Sysctls, pod iÃ§in kullanÄ±lan **namespaced sysctls** listesini tutar. Desteklenmeyen sysctls (konteyner Ã§alÄ±ÅŸma zamanÄ± tarafÄ±ndan) olan pod'lar baÅŸlatÄ±lamayabilir.                                                                                                                                                                                                                                                                                                                                        |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core"><strong>windowsOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#windowssecuritycontextoptions-v1-core"><em>WindowsSecurityContextOptions</em></a></p>                                                                                           | TÃ¼m konteynerlere uygulanan Windows'a Ã¶zgÃ¼ ayarlar. BelirtilmemiÅŸse, bir konteynerin SecurityContext iÃ§indeki seÃ§enekler kullanÄ±lacaktÄ±r.                                                                                                                                                                                                                                                                                                                                               |

## SecurityContext

[**Belgelerden:**](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core)

Bu baÄŸlam **konteyner tanÄ±mlarÄ±nÄ±n** iÃ§inde ayarlanÄ±r. Savunma gÃ¼venliÄŸi aÃ§Ä±sÄ±ndan dikkate almanÄ±z gerekenler:

* **allowPrivilegeEscalation**'Ä± **False** olarak ayarlamak
* Hassas **yetkiler** eklememek (ve ihtiyaÃ§ duymadÄ±klarÄ±nÄ±zÄ± kaldÄ±rmak)
* **privileged**'i **False** olarak ayarlamak
* MÃ¼mkÃ¼nse, **readOnlyFilesystem**'Ä± **True** olarak ayarlamak
* **runAsNonRoot**'u **True** olarak ayarlamak ve bir **runAsUser** belirlemek
* MÃ¼mkÃ¼nse, **seLinuxOptions** ve **seccompProfile** belirterek **izinleri** **sÄ±nÄ±rlamayÄ±** dÃ¼ÅŸÃ¼nmek
* **runAsGroup** aracÄ±lÄ±ÄŸÄ±yla **yetki** **grubu** eriÅŸimi vermemek.

**SecurityContext** ve **PodSecurityContext**'te ayarlanan Ã¶zelliklerin her ikisinde de, **SecurityContext**'te belirtilen deÄŸer **Ã¶nceliklidir**.

| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>allowPrivilegeEscalation</strong></a><br><em>boolean</em></p>                                                                                                                                                                      | **AllowPrivilegeEscalation**, bir sÃ¼recin **ebeveyn sÃ¼recinden daha fazla yetki kazanÄ±p kazanamayacaÄŸÄ±nÄ±** kontrol eder. Bu bool, konteyner sÃ¼recinde no\_new\_privs bayraÄŸÄ±nÄ±n ayarlanÄ±p ayarlanmayacaÄŸÄ±nÄ± doÄŸrudan kontrol eder. AllowPrivilegeEscalation, konteyner **Privileged** olarak Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda veya **CAP\_SYS\_ADMIN** varsa her zaman doÄŸrudur. |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>capabilities</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#capabilities-v1-core"><em>Capabilities</em></a><br><em>HakkÄ±nda daha fazla bilgi</em> <em><strong>Capabilities</strong></em></p>  | Konteynerler Ã§alÄ±ÅŸtÄ±rÄ±lÄ±rken **eklenecek/kaldÄ±rÄ±lacak yetkiler**. VarsayÄ±lan olarak varsayÄ±lan yetki setine sahiptir.                                                                                                                                                                                                                    |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>privileged</strong></a><br><em>boolean</em></p>                                                                                                                                                                                    | Konteyneri ayrÄ±calÄ±klÄ± modda Ã§alÄ±ÅŸtÄ±rÄ±r. AyrÄ±calÄ±klÄ± konteynerlerdeki sÃ¼reÃ§ler esasen **host'ta root ile eÅŸdeÄŸerdir**. VarsayÄ±lan olarak false'dur.                                                                                                                                                                               |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>procMount</strong></a><br><em>string</em></p>                                                                                                                                                                                      | procMount, konteynerler iÃ§in kullanÄ±lacak **proc mount tÃ¼rÃ¼nÃ¼** belirtir. VarsayÄ±lan, yalnÄ±zca okunabilir yollar ve maskelenmiÅŸ yollar iÃ§in konteyner Ã§alÄ±ÅŸma zamanÄ± varsayÄ±lanlarÄ±nÄ± kullanan DefaultProcMount'tÄ±r.                                                                                                                                    |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>readOnlyRootFilesystem</strong></a><br><em>boolean</em></p>                                                                                                                                                                        | Bu **konteynerin yalnÄ±zca okunabilir bir kÃ¶k dosya sistemine sahip olup olmadÄ±ÄŸÄ±nÄ±** belirtir. VarsayÄ±lan olarak false'dur.                                                                                                                                                                                                                                             |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>runAsGroup</strong></a><br><em>integer</em></p>                                                                                                                                                                                    | Konteyner sÃ¼recinin giriÅŸ noktasÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in **GID**. Ayarlanmazsa Ã§alÄ±ÅŸma zamanÄ± varsayÄ±lanÄ±nÄ± kullanÄ±r.                                                                                                                                                                                                                                |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>runAsNonRoot</strong></a><br><em>boolean</em></p>                                                                                                                                                                                  | Konteynerin **kÃ¶k olmayan bir kullanÄ±cÄ± olarak Ã§alÄ±ÅŸmasÄ± gerektiÄŸini** belirtir. DoÄŸruysa, Kubelet, gÃ¶rÃ¼ntÃ¼yÃ¼ Ã§alÄ±ÅŸma zamanÄ±nda UID 0 (kÃ¶k) olarak Ã§alÄ±ÅŸmadÄ±ÄŸÄ±ndan emin olmak iÃ§in doÄŸrulayacak ve Ã§alÄ±ÅŸtÄ±rmazsa konteyneri baÅŸlatmayÄ± baÅŸarÄ±sÄ±z kÄ±lacaktÄ±r.                                                                                                          |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>runAsUser</strong></a><br><em>integer</em></p>                                                                                                                                                                                     | Konteyner sÃ¼recinin giriÅŸ noktasÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmak iÃ§in **UID**. BelirtilmemiÅŸse, gÃ¶rÃ¼ntÃ¼ meta verilerinde belirtilen kullanÄ±cÄ±ya varsayÄ±lan olarak ayarlanÄ±r.                                                                                                                                                                                                  |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>seLinuxOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#selinuxoptions-v1-core"><em>SELinuxOptions</em></a><br><em>HakkÄ±nda daha fazla bilgi</em> <em><strong>seLinux</strong></em></p> | Konteynere uygulanacak **SELinux baÄŸlamÄ±**. BelirtilmemiÅŸse, konteyner Ã§alÄ±ÅŸma zamanÄ± her konteyner iÃ§in rastgele bir SELinux baÄŸlamÄ± tahsis edecektir.                                                                                                                                                                  |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>seccompProfile</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#seccompprofile-v1-core"><em>SeccompProfile</em></a></p>                                                               | Bu konteyner iÃ§in kullanÄ±lacak **seccomp seÃ§enekleri**.                                                                                                                                                                                                                                                                         |
| <p><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core"><strong>windowsOptions</strong></a><br><a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#windowssecuritycontextoptions-v1-core"><em>WindowsSecurityContextOptions</em></a></p>                                 | TÃ¼m konteynerlere uygulanan **Windows'a Ã¶zgÃ¼ ayarlar**.                                                                                                                                                                                                                                                              |

## Referanslar

* [https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#podsecuritycontext-v1-core)
* [https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/#securitycontext-v1-core)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
