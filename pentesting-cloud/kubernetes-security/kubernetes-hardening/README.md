# Kubernetes Hardening

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ ìš”ë ¹ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}

## í´ëŸ¬ìŠ¤í„° ë¶„ì„ ë„êµ¬

### [**Kubescape**](https://github.com/armosec/kubescape)

[**Kubescape**](https://github.com/armosec/kubescape)ëŠ” K8s ì˜¤í”ˆ ì†ŒìŠ¤ ë„êµ¬ë¡œ, ë¦¬ìŠ¤í¬ ë¶„ì„, ë³´ì•ˆ ê·œì • ì¤€ìˆ˜, RBAC ì‹œê°í™” ë° ì´ë¯¸ì§€ ì·¨ì•½ì  ìŠ¤ìº”ì„ í¬í•¨í•˜ëŠ” ë©€í‹° í´ë¼ìš°ë“œ K8s ë‹¨ì¼ ì°½ì„ ì œê³µí•©ë‹ˆë‹¤. KubescapeëŠ” K8s í´ëŸ¬ìŠ¤í„°, YAML íŒŒì¼ ë° HELM ì°¨íŠ¸ë¥¼ ìŠ¤ìº”í•˜ì—¬ [NSA-CISA](https://www.armosec.io/blog/kubernetes-hardening-guidance-summary-by-armo) ë° [MITRE ATT\&CKÂ®](https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/)ì™€ ê°™ì€ ì—¬ëŸ¬ í”„ë ˆì„ì›Œí¬ì— ë”°ë¼ ì˜ëª»ëœ êµ¬ì„±ì„ ê°ì§€í•˜ë©°, ì†Œí”„íŠ¸ì›¨ì–´ ì·¨ì•½ì  ë° RBAC(ì—­í•  ê¸°ë°˜ ì•¡ì„¸ìŠ¤ ì œì–´) ìœ„ë°˜ì„ ì¡°ê¸°ì— CI/CD íŒŒì´í”„ë¼ì¸ì—ì„œ ê³„ì‚°í•˜ì—¬ ì¦‰ì‹œ ë¦¬ìŠ¤í¬ ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ê³  ì‹œê°„ ê²½ê³¼ì— ë”°ë¥¸ ë¦¬ìŠ¤í¬ íŠ¸ë Œë“œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
```bash
kubescape scan --verbose
```
### [**Kube-bench**](https://github.com/aquasecurity/kube-bench)

ë„êµ¬ [**kube-bench**](https://github.com/aquasecurity/kube-bench)ëŠ” [**CIS Kubernetes Benchmark**](https://www.cisecurity.org/benchmark/kubernetes/)ì— ë¬¸ì„œí™”ëœ í™•ì¸ ì‚¬í•­ì„ ì‹¤í–‰í•˜ì—¬ Kubernetesê°€ ì•ˆì „í•˜ê²Œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.\
ë‹¤ìŒ ì¤‘ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* í˜¸ìŠ¤íŠ¸ì™€ PID ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê³µìœ í•˜ëŠ” ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ kube-bench ì‹¤í–‰
* í˜¸ìŠ¤íŠ¸ì— kube-benchë¥¼ ì„¤ì¹˜í•˜ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•œ ë‹¤ìŒ í˜¸ìŠ¤íŠ¸ì—ì„œ kube-bench ì§ì ‘ ì‹¤í–‰
* [ë¦´ë¦¬ìŠ¤ í˜ì´ì§€](https://github.com/aquasecurity/kube-bench/releases)ì—ì„œ ìµœì‹  ì´ì§„ íŒŒì¼ ì„¤ì¹˜
* ì†ŒìŠ¤ì—ì„œ ì»´íŒŒì¼

### [**Kubeaudit**](https://github.com/Shopify/kubeaudit)

ë„êµ¬ [**kubeaudit**](https://github.com/Shopify/kubeaudit)ëŠ” ë‹¤ì–‘í•œ ë³´ì•ˆ ë¬¸ì œì— ëŒ€í•´ **Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ê°ì‚¬**í•˜ëŠ” ëª…ë ¹ì¤„ ë„êµ¬ ë° Go íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤.

Kubeauditì€ í´ëŸ¬ìŠ¤í„° ë‚´ì˜ ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ ì¤‘ì¸ì§€ ê°ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  Kubernetes ë¦¬ì†ŒìŠ¤ë¥¼ ê°ì‚¬í•˜ë ¤ê³  ì‹œë„í•  ê²ƒì…ë‹ˆë‹¤:
```
kubeaudit all
```
ì´ ë„êµ¬ì—ëŠ” ê°ì§€ëœ ë¬¸ì œë¥¼ **ìë™ìœ¼ë¡œ ìˆ˜ì •í•˜ëŠ”** `autofix` ì¸ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

### [**Kube-hunter**](https://github.com/aquasecurity/kube-hunter)

ë„êµ¬ [**kube-hunter**](https://github.com/aquasecurity/kube-hunter)ëŠ” Kubernetes í´ëŸ¬ìŠ¤í„°ì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ ì°¾ìŠµë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” Kubernetes í™˜ê²½ì—ì„œì˜ ë³´ì•ˆ ë¬¸ì œì— ëŒ€í•œ ì¸ì‹ê³¼ ê°€ì‹œì„±ì„ ë†’ì´ê¸° ìœ„í•´ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.
```bash
kube-hunter --remote some.node.com
```
### [**Kubei**](https://github.com/Erezf-p/kubei)

[**Kubei**](https://github.com/Erezf-p/kubei)ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ì •í™•í•˜ê³  ì¦‰ê°ì ì¸ ìœ„í—˜ í‰ê°€ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ì·¨ì•½ì  ìŠ¤ìºë‹ ë° CIS ë„ì»¤ ë²¤ì¹˜ë§ˆí¬ ë„êµ¬ì…ë‹ˆë‹¤. KubeiëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©ë˜ëŠ” ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ìŠ¤ìº”í•˜ë©°, ì‘ìš© í”„ë¡œê·¸ë¨ íŒŸ ë° ì‹œìŠ¤í…œ íŒŸì˜ ì´ë¯¸ì§€ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.

### [**KubiScan**](https://github.com/cyberark/KubiScan)

[**KubiScan**](https://github.com/cyberark/KubiScan)ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ìŠ¤ìº”í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì—­í•  ê¸°ë°˜ ì•¡ì„¸ìŠ¤ ì œì–´ (RBAC) ê¶Œí•œ ëª¨ë¸ì—ì„œ ìœ„í—˜í•œ ê¶Œí•œì„ ì°¾ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

### [Managed Kubernetes Auditing Toolkit](https://github.com/DataDog/managed-kubernetes-auditing-toolkit)

[**Mkat**](https://github.com/DataDog/managed-kubernetes-auditing-toolkit)ì€ ë‹¤ë¥¸ ìœ í˜•ì˜ ê³ ìœ„í—˜ ì²´í¬ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ë„êµ¬ì…ë‹ˆë‹¤. ì£¼ë¡œ 3ê°€ì§€ ë‹¤ë¥¸ ëª¨ë“œë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤:

* **`find-role-relationships`**: ì–´ë–¤ AWS ì—­í• ì´ ì–´ë–¤ íŒŸì—ì„œ ì‹¤í–‰ë˜ëŠ”ì§€ ì°¾ìŠµë‹ˆë‹¤.
* **`find-secrets`**: íŒŸ, ConfigMaps ë° Secretsì™€ ê°™ì€ K8s ë¦¬ì†ŒìŠ¤ì—ì„œ ë¹„ë°€ì„ ì‹ë³„í•˜ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤.
* **`test-imds-access`**: íŒŸì„ ì‹¤í–‰í•˜ê³  ë©”íƒ€ë°ì´í„° v1 ë° v2ì— ì•¡ì„¸ìŠ¤ë¥¼ ì‹œë„í•©ë‹ˆë‹¤. ê²½ê³ : ì´ ì‘ì—…ì€ í´ëŸ¬ìŠ¤í„°ì—ì„œ íŒŸì„ ì‹¤í–‰í•˜ë¯€ë¡œ ì‹ ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤. ì•„ë§ˆë„ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³  ì‹¶ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤!

## **IaC ì½”ë“œ ê°ì‚¬**

### [**Popeye**](https://github.com/derailed/popeye)

[**Popeye**](https://github.com/derailed/popeye)ì€ ë¼ì´ë¸Œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ìŠ¤ìº”í•˜ê³  **ë°°í¬ëœ ë¦¬ì†ŒìŠ¤ ë° êµ¬ì„±ì—ì„œ ì ì¬ì ì¸ ë¬¸ì œë¥¼ ë³´ê³ **í•˜ëŠ” ìœ í‹¸ë¦¬í‹°ì…ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ë¥¼ ìŠ¤ìº”í•˜ì—¬ ì˜ëª»ëœ êµ¬ì„±ì„ ê°ì§€í•˜ê³  ìµœìƒì˜ ì‹¤ì²œ ë°©ë²•ì´ ì¤€ìˆ˜ë˜ë„ë¡ ë„ì™€ ë¯¸ë˜ì˜ ë¨¸ë¦¬ ì•„í””ì„ ë°©ì§€í•©ë‹ˆë‹¤. ì´ëŠ” ì•¼ìƒì—ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ìš´ì˜í•  ë•Œ ì§ë©´í•˜ëŠ” ì¸ì§€ ë¶€í•˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ë˜í•œ í´ëŸ¬ìŠ¤í„°ì— ë©”íŠ¸ë¦­ ì„œë²„ê°€ ì‚¬ìš©ë˜ë©´ ì ì¬ì ì¸ ë¦¬ì†ŒìŠ¤ ê³¼ë¶€í•˜/ê³¼ì†Œ í• ë‹¹ì„ ë³´ê³ í•˜ê³  í´ëŸ¬ìŠ¤í„°ê°€ ìš©ëŸ‰ì„ ì´ˆê³¼í•  ê²½ìš° ê²½ê³ ë¥¼ ì‹œë„í•©ë‹ˆë‹¤.

### [**KICS**](https://github.com/Checkmarx/kics)

[**KICS**](https://github.com/Checkmarx/kics)ì€ ë‹¤ìŒ **ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì½”ë“œ ì†”ë£¨ì…˜**ì—ì„œ **ë³´ì•ˆ ì·¨ì•½ì **, ê·œì • ì¤€ìˆ˜ ë¬¸ì œ ë° ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ëª» êµ¬ì„±ì„ ì°¾ìŠµë‹ˆë‹¤: Terraform, Kubernetes, Docker, AWS CloudFormation, Ansible, Helm, Microsoft ARM ë° OpenAPI 3.0 ì‚¬ì–‘

### [**Checkov**](https://github.com/bridgecrewio/checkov)

[**Checkov**](https://github.com/bridgecrewio/checkov)ì€ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜-ì• ìŠ¤-ì½”ë“œë¥¼ ìœ„í•œ ì •ì  ì½”ë“œ ë¶„ì„ ë„êµ¬ì…ë‹ˆë‹¤.

ì´ëŠ” [Terraform](https://terraform.io), Terraform plan, [Cloudformation](https://aws.amazon.com/cloudformation/), [AWS SAM](https://aws.amazon.com/serverless/sam/), [Kubernetes](https://kubernetes.io), [Dockerfile](https://www.docker.com), [Serverless](https://www.serverless.com) ë˜ëŠ” [ARM Templates](https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/overview)ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œë¹„ì €ë‹ëœ í´ë¼ìš°ë“œ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ë¥¼ ìŠ¤ìº”í•˜ê³  ê·¸ë˜í”„ ê¸°ë°˜ ìŠ¤ìºë‹ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì•ˆ ë° ê·œì • ì¤€ìˆ˜ ì˜ëª» êµ¬ì„±ì„ ê°ì§€í•©ë‹ˆë‹¤.

### [**Kube-score**](https://github.com/zegl/kube-score)

[**kube-score**](https://github.com/zegl/kube-score)ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ ê°ì²´ ì •ì˜ì˜ ì •ì  ì½”ë“œ ë¶„ì„ì„ ìˆ˜í–‰í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

ì„¤ì¹˜ ë°©ë²•:

| ë°°í¬íŒ                                               | ëª…ë ¹ì–´ / ë§í¬                                                                            |
| --------------------------------------------------- | --------------------------------------------------------------------------------------- |
| macOS, Linux ë° Windowsìš© ë¯¸ë¦¬ ë¹Œë“œëœ ì´ì§„ íŒŒì¼    | [GitHub ë¦´ë¦¬ìŠ¤](https://github.com/zegl/kube-score/releases)                          |
| Docker                                              | `docker pull zegl/kube-score` ([Docker Hub)](https://hub.docker.com/r/zegl/kube-score/) |
| Homebrew (macOS ë° Linux)                          | `brew install kube-score`                                                               |
| [Krew](https://krew.sigs.k8s.io/) (macOS ë° Linux) | `kubectl krew install score`                                                            |

## íŒ

### ì¿ ë²„ë„¤í‹°ìŠ¤ PodSecurityContext ë° SecurityContext

**íŒŸì˜ ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸**(_PodSecurityContext_) ë° ì‹¤í–‰ë  **ì»¨í…Œì´ë„ˆ**ì˜ ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸(_SecurityContext_)ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ì •ë³´ëŠ” ë‹¤ìŒì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤:

{% content-ref url="kubernetes-securitycontext-s.md" %}
[kubernetes-securitycontext-s.md](kubernetes-securitycontext-s.md)
{% endcontent-ref %}

### ì¿ ë²„ë„¤í‹°ìŠ¤ API ê°•í™”

**ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ë³´í˜¸**ëŠ” ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ì¶©ë¶„í•œ ê¶Œí•œì„ ê°€ì§„ ì•…ì˜ì ì¸ ì‚¬ìš©ìê°€ ì•…ìš©í•˜ì—¬ í™˜ê²½ì„ ë§ì€ ë°©ë²•ìœ¼ë¡œ ì†ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
**ì•¡ì„¸ìŠ¤**ë¥¼ ì•ˆì „í•˜ê²Œ ë³´í˜¸í•˜ê³  (API ì„œë²„ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ì¶œì²˜ë¥¼ **í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸**í•˜ê³  ë‹¤ë¥¸ ì—°ê²°ì„ ê±°ë¶€) ë° [**ì¸ì¦**](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/)ì„ ë³´í˜¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤(ìµœì†Œ ê¶Œí•œì˜ ì›ì¹™ì„ ë”°ë¦…ë‹ˆë‹¤). ê·¸ë¦¬ê³  **ì ˆëŒ€ë¡œ** **ìµëª…** **ìš”ì²­**ì„ **í—ˆìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**.

**ì¼ë°˜ì ì¸ ìš”ì²­ í”„ë¡œì„¸ìŠ¤:**\
ì‚¬ìš©ì ë˜ëŠ” K8s ì„œë¹„ìŠ¤ ê³„ì • â€“> ì¸ì¦ â€“> ê¶Œí•œ ë¶€ì—¬ â€“> ì…ì¥ ì œì–´.

**íŒ**:

* í¬íŠ¸ë¥¼ ë‹«ìŠµë‹ˆë‹¤.
* ìµëª… ì•¡ì„¸ìŠ¤ë¥¼ í”¼í•©ë‹ˆë‹¤.
* NodeRestriction; íŠ¹ì • ë…¸ë“œì—ì„œ APIë¡œì˜ ì•¡ì„¸ìŠ¤ë¥¼ ê¸ˆì§€í•©ë‹ˆë‹¤.
* [https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#noderestriction](https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#noderestriction)
* ê¸°ë³¸ì ìœ¼ë¡œ kubeletsê°€ ë…¸ë“œ ê°ì²´ë¥¼ ì›Œí¬ë¡œë“œ ê²©ë¦¬ ëª©ì ìœ¼ë¡œ ë ˆì´ë¸”ë§í•˜ê¸° ìœ„í•´ ì˜ˆì•½ëœ node-restriction.kubernetes.io/ ì ‘ë‘ì‚¬ê°€ ìˆëŠ” ë ˆì´ë¸”ì„ ì¶”ê°€/ì œê±°/ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤. ë˜í•œ kubeletsê°€ ì´ëŸ¬í•œ ë ˆì´ë¸” ë° ë ˆì´ë¸” ì ‘ë‘ì‚¬ë¥¼ ì¶”ê°€/ì œê±°/ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ë ˆì´ë¸”ë¡œ ì•ˆì „í•œ ì›Œí¬ë¡œë“œ ê²©ë¦¬ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.
* íŠ¹ì • íŒŸì´ API ì•¡ì„¸ìŠ¤ë¥¼ í”¼í•©ë‹ˆë‹¤.
* ApiServerë¥¼ ì¸í„°ë„·ì— ë…¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* ë¬´ë‹¨ ì•¡ì„¸ìŠ¤ RBACë¥¼ í”¼í•©ë‹ˆë‹¤.
* ë°©í™”ë²½ ë° IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ë¡œ ApiServer í¬íŠ¸ë¥¼ ë³´í˜¸í•©ë‹ˆë‹¤.

### SecurityContext ê°•í™”

ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì§€ì •ë˜ì§€ ì•Šì€ ê²½ìš° íŒŸì´ ì‹œì‘ë  ë•Œ ë£¨íŠ¸ ì‚¬ìš©ìê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ìœ ì‚¬í•œ í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ì—¬ ë” ì•ˆì „í•œ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‘ìš© í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```yaml
apiVersion: v1
kind: Pod
metadata:
name: security-context-demo
spec:
securityContext:
runAsUser: 1000
runAsGroup: 3000
fsGroup: 2000
volumes:
- name: sec-ctx-vol
emptyDir: {}
containers:
- name: sec-ctx-demo
image: busybox
command: [ "sh", "-c", "sleep 1h" ]
securityContext:
runAsNonRoot: true
volumeMounts:
- name: sec-ctx-vol
mountPath: /data/demo
securityContext:
allowPrivilegeEscalation: true
```
* [https://kubernetes.io/docs/tasks/configure-pod-container/security-context/](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)
* [https://kubernetes.io/docs/concepts/policy/pod-security-policy/](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)

### ì¼ë°˜ ê°•í™”

ë‹¤ìŒê³¼ ê°™ì´ Kubernetes í™˜ê²½ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤:

* ì¢…ì†ì„±ì„ ìµœì‹  ìƒíƒœë¡œ ìœ ì§€í•©ë‹ˆë‹¤.
* ë²„ê·¸ ë° ë³´ì•ˆ íŒ¨ì¹˜ë¥¼ ì ìš©í•©ë‹ˆë‹¤.

[**ë¦´ë¦¬ìŠ¤ ì£¼ê¸°**](https://kubernetes.io/docs/setup/release/version-skew-policy/): ë§¤ 3ê°œì›”ë§ˆë‹¤ ìƒˆë¡œìš´ ì†Œê·œëª¨ ë¦´ë¦¬ìŠ¤ê°€ ìˆìŠµë‹ˆë‹¤ -- 1.20.3 = 1(ë©”ì´ì €).20(ë§ˆì´ë„ˆ).3(íŒ¨ì¹˜)

**Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ (ì—¬ê¸°ì„œë¶€í„°)** [**ì—¬ê¸°**](https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/)**ì…ë‹ˆë‹¤:**

* ì´ ìˆœì„œì— ë”°ë¼ ë§ˆìŠ¤í„° ë…¸ë“œ êµ¬ì„± ìš”ì†Œë¥¼ ì—…ê·¸ë ˆì´ë“œí•©ë‹ˆë‹¤:
* etcd (ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤).
* kube-apiserver (ëª¨ë“  ì œì–´ í”Œë ˆì¸ í˜¸ìŠ¤íŠ¸).
* kube-controller-manager.
* kube-scheduler.
* í´ë¼ìš°ë“œ ì»¨íŠ¸ë¡¤ëŸ¬ ë§¤ë‹ˆì €(ì‚¬ìš©í•˜ëŠ” ê²½ìš°).
* kube-proxy, kubeletê³¼ ê°™ì€ ì›Œì»¤ ë…¸ë“œ êµ¬ì„± ìš”ì†Œë¥¼ ì—…ê·¸ë ˆì´ë“œí•©ë‹ˆë‹¤.

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ë ˆí¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
