# Kubernetes Namespace Escalation

{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
学习和实践 GCP 黑客技术：<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub 仓库提交 PR 分享黑客技巧。

</details>
{% endhint %}

在 Kubernetes 中，**你设法进入一个命名空间**（通过窃取某些用户凭据或通过攻陷一个 pod）是相当常见的。然而，通常你会对**升级到一个不同的命名空间感兴趣，因为那里可以找到更有趣的东西**。

以下是一些你可以尝试逃到不同命名空间的技术：

### 滥用 K8s 权限

显然，如果你窃取的账户在你想要升级到的命名空间上具有敏感权限，你可以滥用诸如**在 NS 中创建 pods**、**在命名空间内已存在的 pod 中执行** shell 或读取 **secret** SA 令牌等操作。

有关你可以滥用的权限的更多信息，请阅读：

{% content-ref url="abusing-roles-clusterroles-in-kubernetes/" %}
[滥用 Kubernetes 中的角色和集群角色](abusing-roles-clusterroles-in-kubernetes/)
{% endcontent-ref %}

### 逃到节点

如果你可以逃到节点，无论是因为你攻陷了一个 pod 并且可以逃脱，还是因为你可以创建一个特权 pod 并逃脱，你可以做几件事情来窃取其他 SA 令牌：

* 检查节点中运行的其他 docker 容器中挂载的 **SA 令牌**
* 检查节点中具有额外权限的新 **kubeconfig 文件**
* 如果启用（或自己启用），尝试 **创建其他命名空间的镜像 pods**，因为你可能会获得对这些命名空间默认令牌账户的访问权限（我还没有测试过这个）

所有这些技术在以下内容中进行了说明：

{% content-ref url="attacking-kubernetes-from-inside-a-pod.md" %}
[从 pod 内部攻击 Kubernetes](attacking-kubernetes-from-inside-a-pod.md)
{% endcontent-ref %}

{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
学习和实践 GCP 黑客技术：<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub 仓库提交 PR 分享黑客技巧。

</details>
{% endhint %}
