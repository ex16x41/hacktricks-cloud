# AWS - Elastic Beanstalk Enum

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter**'da **bizi takip edin** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## Elastic Beanstalk

Amazon Elastic Beanstalk, **web uygulamalarını ve hizmetlerini dağıtmak, yönetmek ve ölçeklendirmek için basitleştirilmiş bir platform** sunar. Java, .NET, PHP, Node.js, Python, Ruby ve Go gibi çeşitli programlama dilleri ve çerçeveleri destekler ve Docker konteynerleri ile uyumludur. Hizmet, Apache, Nginx, Passenger ve IIS gibi yaygın olarak kullanılan sunucularla uyumludur.

Elastic Beanstalk, **uygulamalarınızı AWS bulutuna dağıtmanın** basit ve esnek bir yolunu sağlar; altyapı hakkında endişelenmenize gerek kalmaz. **Otomatik olarak** kapasite **sağlama**, yük **dengeleme**, **ölçeklendirme** ve uygulama sağlık **izleme** detaylarını yönetir, böylece kodunuzu yazmaya ve dağıtmaya odaklanabilirsiniz.

Elastic Beanstalk tarafından oluşturulan altyapı, **EC2**'deki **Otomatik Ölçekleme** Grupları tarafından yönetilmektedir (bir yük dengeleyici ile). Bu, günün sonunda, eğer **host'u tehlikeye atarsanız**, EC2 hakkında bilgi sahibi olmanız gerektiği anlamına gelir:

{% content-ref url="../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/" %}
[aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum](../../aws-security/aws-services/aws-ec2-ebs-elb-ssm-vpc-and-vpn-enum/)
{% endcontent-ref %}

Ayrıca, Docker kullanılıyorsa, **ECS** kullanmak mümkündür.

{% content-ref url="../../aws-security/aws-services/aws-eks-enum.md" %}
[aws-eks-enum.md](../../aws-security/aws-services/aws-eks-enum.md)
{% endcontent-ref %}

### Uygulama ve Ortamlar

AWS Elastic Beanstalk'ta, "uygulama" ve "ortam" kavramları farklı amaçlara hizmet eder ve dağıtım sürecinde farklı rollere sahiptir.

#### Uygulama

* Elastic Beanstalk'taki bir uygulama, **uygulamanızın kaynak kodu, ortamları ve yapılandırmaları için mantıksal bir konteynerdir**. Uygulama kodunuzun farklı sürümlerini bir araya getirir ve bunları tek bir varlık olarak yönetmenizi sağlar.
* Bir uygulama oluşturduğunuzda, bir isim ve **açıklama sağlarsınız, ancak bu aşamada hiçbir kaynak sağlanmaz**. Bu, kodunuzu ve ilgili kaynakları organize etmenin ve yönetmenin bir yoludur.
* Bir uygulama içinde **birden fazla uygulama sürümüne** sahip olabilirsiniz. Her sürüm, kodunuzun belirli bir sürümüne karşılık gelir ve bir veya daha fazla ortama dağıtılabilir.

#### Ortam

* Bir ortam, AWS altyapısında çalışan **uygulamanızın sağlanmış bir örneğidir**. **Uygulama kodunuzun dağıtıldığı ve çalıştırıldığı yerdir**. Elastic Beanstalk, ortam yapılandırmasına göre gerekli kaynakları (örneğin, EC2 örnekleri, yük dengeleyiciler, otomatik ölçekleme grupları, veritabanları) sağlar.
* **Her ortam, uygulamanızın tek bir sürümünü çalıştırır** ve geliştirme, test, sahneleme ve üretim gibi farklı amaçlar için birden fazla ortama sahip olabilirsiniz.
* Bir ortam oluşturduğunuzda, bir platform (örneğin, Java, .NET, Node.js vb.) ve bir ortam türü (örneğin, web sunucusu veya işçi) seçersiniz. Ayrıca, altyapının ve uygulama ayarlarının çeşitli yönlerini kontrol etmek için ortam yapılandırmasını özelleştirebilirsiniz.

### 2 Tür Ortam

1. **Web Sunucusu Ortamı**: **Web uygulamalarını ve API'leri barındırmak ve sunmak için tasarlanmıştır**. Bu uygulamalar genellikle gelen HTTP/HTTPS isteklerini işler. Web sunucusu ortamı, gelen trafiği yönetmek, kapasiteyi yönetmek ve uygulamanın yüksek kullanılabilirliğini sağlamak için **EC2 örnekleri, yük dengeleyiciler ve otomatik ölçekleme** grupları gibi kaynakları sağlar.
2. **İşçi Ortamı**: **Arka plan görevlerini** işlemek için tasarlanmıştır; bu görevler genellikle zaman alıcı veya kaynak yoğun işlemlerdir ve müşterilere anında yanıt gerektirmez. İşçi ortamı, **EC2 örnekleri ve otomatik ölçekleme grupları** gibi kaynakları sağlar, ancak doğrudan HTTP/HTTPS isteklerini işlemediği için **bir yük dengeleyiciye sahip değildir**. Bunun yerine, işçi ortamı, işlediği görevler ile işçi ortamı arasında bir tampon görevi gören **Amazon Simple Queue Service (SQS) kuyruğundan** görevleri alır.

### Güvenlik

Beanstalk'ta bir Uygulama oluştururken seçilecek 3 çok önemli güvenlik seçeneği vardır:

* **EC2 anahtar çifti**: Bu, uygulamayı çalıştıran EC2 örneklerine erişebilecek **SSH anahtarı** olacaktır.
* **IAM örnek profili**: Bu, örneklerin sahip olacağı **örnek profilidir** (**IAM ayrıcalıkları**).
* Otomatik olarak oluşturulan rol **`aws-elasticbeanstalk-ec2-role`** olarak adlandırılır ve AWS yönetilen politikaları kullanarak tüm ECS, tüm SQS, DynamoDB elasticbeanstalk ve elasticbeanstalk S3 üzerinde bazı ilginç erişimlere sahiptir: [AWSElasticBeanstalkWebTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier), [AWSElasticBeanstalkMulticontainerDocker](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker), [AWSElasticBeanstalkWorkerTier](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier).
* **Hizmet rolü**: Bu, AWS hizmetinin gerekli tüm eylemleri gerçekleştirmek için kullanacağı **roldür**. Bildiğim kadarıyla, normal bir AWS kullanıcısı bu role erişemez.
* AWS tarafından oluşturulan bu rol **`aws-elasticbeanstalk-service-role`** olarak adlandırılır ve AWS yönetilen politikaları [AWSElasticBeanstalkEnhancedHealth](https://us-east-1.console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth) ve [AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy](https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles/details/aws-elasticbeanstalk-service-role?section=permissions) kullanır.

Varsayılan olarak **metadata sürümü 1 devre dışıdır**:

<figure><img src="../../../.gitbook/assets/image (18) (1) (2).png" alt=""><figcaption></figcaption></figure>

### Maruz Kalma

Beanstalk verileri, aşağıdaki isimle bir **S3 bucket** içinde saklanır: **`elasticbeanstalk-<region>-<acc-id>`** (eğer AWS konsolunda oluşturulduysa). Bu bucket içinde, yüklenen **uygulama kaynak kodunu** bulacaksınız.

Oluşturulan web sayfasının **URL'si** **`http://<webapp-name>-env.<random>.<region>.elasticbeanstalk.com/`**

{% hint style="warning" %}
Eğer bucket üzerinde **okuma erişimi** elde ederseniz, **kaynak kodunu okuyabilir** ve hatta üzerinde **hassas kimlik bilgilerini** bulabilirsiniz.

Eğer bucket üzerinde **yazma erişimi** elde ederseniz, **kaynak kodunu değiştirebilir** ve uygulama bir sonraki çalıştırıldığında **IAM rolünü tehlikeye atabilirsiniz**.
{% endhint %}

### Sayım

{% code overflow="wrap" %}
```bash
# Find S3 bucket
ACCOUNT_NUMBER=<account_number>
for r in us-east-1 us-east-2 us-west-1 us-west-2 ap-south-1 ap-south-2 ap-northeast-1 ap-northeast-2 ap-northeast-3 ap-southeast-1 ap-southeast-2 ap-southeast-3 ca-central-1 eu-central-1 eu-central-2 eu-west-1 eu-west-2 eu-west-3 eu-north-1 sa-east-1 af-south-1 ap-east-1 eu-south-1 eu-south-2 me-south-1 me-central-1; do aws s3 ls elasticbeanstalk-$r-$ACCOUNT_NUMBER 2>/dev/null && echo "Found in: elasticbeanstalk-$r-$ACCOUNT_NUMBER"; done

# Get apps and URLs
aws elasticbeanstalk describe-applications # List apps
aws elasticbeanstalk describe-application-versions # Get apps & bucket name with source code
aws elasticbeanstalk describe-environments # List envs
aws elasticbeanstalk describe-environments | grep -E "EndpointURL|CNAME"
aws elasticbeanstalk describe-configuration-settings --application-name <app_name> --environment-name <env_name>
aws elasticbeanstalk describe-environment-resources --environment-name <env_name> # Get env info such as SQS used queues
aws elasticbeanstalk describe-instances-health --environment-name <env_name> # Get the instances of an environment

# Get events
aws elasticbeanstalk describe-events
```
{% endcode %}

### Kimlik Doğrulaması Olmadan Erişim

{% content-ref url="../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md" %}
[aws-elastic-beanstalk-unauthenticated-enum.md](../../aws-security/aws-unauthenticated-enum-access/aws-elastic-beanstalk-unauthenticated-enum.md)
{% endcontent-ref %}

### Süreklilik

{% content-ref url="../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md" %}
[aws-elastic-beanstalk-persistence.md](../../aws-security/aws-persistence/aws-elastic-beanstalk-persistence.md)
{% endcontent-ref %}

### Yetki Yükseltme

{% content-ref url="../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md" %}
[aws-elastic-beanstalk-privesc.md](../aws-privilege-escalation/aws-elastic-beanstalk-privesc.md)
{% endcontent-ref %}

### Saldırı Sonrası

{% content-ref url="../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md" %}
[aws-elastic-beanstalk-post-exploitation.md](../../aws-security/aws-post-exploitation/aws-elastic-beanstalk-post-exploitation.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
