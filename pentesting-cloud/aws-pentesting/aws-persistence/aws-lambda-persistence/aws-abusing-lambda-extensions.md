# AWS - Lambda UzantÄ±larÄ±nÄ± KÃ¶tÃ¼ye Kullanma

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Discord grubuna** ğŸ’¬ [**katÄ±lÄ±n**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±nda.

</details>
{% endhint %}

## Lambda UzantÄ±larÄ±

Lambda uzantÄ±larÄ±, Ã§eÅŸitli **izleme, gÃ¶zlemlenebilirlik, gÃ¼venlik ve yÃ¶netim araÃ§larÄ±** ile entegrasyon saÄŸlayarak fonksiyonlarÄ± geliÅŸtirir. Bu uzantÄ±lar, [.zip arÅŸivleri kullanarak Lambda katmanlarÄ±](https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html) veya [konteyner gÃ¶rÃ¼ntÃ¼ daÄŸÄ±tÄ±mlarÄ±na](https://aws.amazon.com/blogs/compute/working-with-lambda-layers-and-extensions-in-container-images/) dahil edilerek eklenir ve iki modda Ã§alÄ±ÅŸÄ±r: **dahili** ve **harici**.

* **Dahili uzantÄ±lar**, Ã§alÄ±ÅŸma zamanÄ± sÃ¼recine birleÅŸir, **dil-spesifik ortam deÄŸiÅŸkenleri** ve **sarmalayÄ±cÄ± betikler** kullanarak baÅŸlangÄ±cÄ±nÄ± manipÃ¼le eder. Bu Ã¶zelleÅŸtirme, **Java Correto 8 ve 11, Node.js 10 ve 12, ve .NET Core 3.1** gibi Ã§eÅŸitli Ã§alÄ±ÅŸma zamanlarÄ±na uygulanÄ±r.
* **Harici uzantÄ±lar**, ayrÄ± sÃ¼reÃ§ler olarak Ã§alÄ±ÅŸÄ±r ve Lambda fonksiyonunun yaÅŸam dÃ¶ngÃ¼sÃ¼ ile uyumlu kalÄ±r. **Node.js 10 ve 12, Python 3.7 ve 3.8, Ruby 2.5 ve 2.7, Java Corretto 8 ve 11, .NET Core 3.1** ve **Ã¶zel Ã§alÄ±ÅŸma zamanlarÄ±** gibi Ã§eÅŸitli Ã§alÄ±ÅŸma zamanlarÄ± ile uyumludur.

[**Lambda uzantÄ±larÄ±nÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ± hakkÄ±nda daha fazla bilgi iÃ§in belgeleri kontrol edin**](https://docs.aws.amazon.com/lambda/latest/dg/runtimes-extensions-api.html).

### KalÄ±cÄ±lÄ±k, Ä°stekleri Ã‡alma ve Ä°stekleri DeÄŸiÅŸtirme iÃ§in Harici UzantÄ±

Bu, ÅŸu yazÄ±da Ã¶nerilen tekniÄŸin bir Ã¶zetidir: [https://www.clearvector.com/blog/lambda-spy/](https://www.clearvector.com/blog/lambda-spy/)

Lambda Ã§alÄ±ÅŸma zamanÄ± ortamÄ±ndaki varsayÄ±lan Linux Ã§ekirdeÄŸinin â€œ**process\_vm\_readv**â€ ve â€œ**process\_vm\_writev**â€ sistem Ã§aÄŸrÄ±larÄ± ile derlendiÄŸi bulunmuÅŸtur. Ve tÃ¼m sÃ¼reÃ§ler aynÄ± kullanÄ±cÄ± kimliÄŸi ile Ã§alÄ±ÅŸÄ±r, hatta harici uzantÄ± iÃ§in oluÅŸturulan yeni sÃ¼reÃ§ bile. **Bu, harici bir uzantÄ±nÄ±n tasarÄ±m gereÄŸi Rapidâ€™in yÄ±ÄŸÄ±n belleÄŸine tam okuma ve yazma eriÅŸimine sahip olduÄŸu anlamÄ±na gelir.**

AyrÄ±ca, Lambda uzantÄ±larÄ± **Ã§aÄŸrÄ± olaylarÄ±na abone olma** yeteneÄŸine sahipken, AWS bu uzantÄ±lara ham verileri aÃ§Ä±klamaz. Bu, **uzantÄ±larÄ±n HTTP isteÄŸi Ã¼zerinden iletilen hassas bilgilere eriÅŸemeyeceÄŸini** garanti eder.

Init (Rapid) sÃ¼reci, tÃ¼m API isteklerini [http://127.0.0.1:9001](http://127.0.0.1:9001/) adresinde izlerken Lambda uzantÄ±larÄ±, herhangi bir Ã§alÄ±ÅŸma zamanÄ± kodu Ã§alÄ±ÅŸtÄ±rÄ±lmadan Ã¶nce, ancak Rapid'den sonra baÅŸlatÄ±lÄ±r ve Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r.

<figure><img src="../../../../.gitbook/assets/image (90).png" alt=""><figcaption><p><a href="https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.default.png">https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.default.png</a></p></figcaption></figure>

**`AWS_LAMBDA_RUNTIME_API`** deÄŸiÅŸkeni, **Ã§ocuk Ã§alÄ±ÅŸma zamanÄ± sÃ¼reÃ§lerine** ve ek uzantÄ±lara Rapid API'nin **IP** adresini ve **port** numarasÄ±nÄ± belirtir.

{% hint style="warning" %}
**`AWS_LAMBDA_RUNTIME_API`** ortam deÄŸiÅŸkenini eriÅŸimimiz olan bir **`port`** numarasÄ±na deÄŸiÅŸtirerek, Lambda Ã§alÄ±ÅŸma zamanÄ± iÃ§indeki tÃ¼m iÅŸlemleri kesmek mÃ¼mkÃ¼ndÃ¼r (**man-in-the-middle**). Bu, uzantÄ±nÄ±n Rapid Init ile aynÄ± ayrÄ±calÄ±klarla Ã§alÄ±ÅŸmasÄ± ve sistemin Ã§ekirdeÄŸinin **sÃ¼reÃ§ belleÄŸini deÄŸiÅŸtirmeye** izin vermesi nedeniyle, port numarasÄ±nÄ±n deÄŸiÅŸtirilmesini mÃ¼mkÃ¼n kÄ±lar.
{% endhint %}

Ã‡Ã¼nkÃ¼ **uzantÄ±lar herhangi bir Ã§alÄ±ÅŸma zamanÄ± kodundan Ã¶nce Ã§alÄ±ÅŸÄ±r**, ortam deÄŸiÅŸkenini deÄŸiÅŸtirmek, Ã§alÄ±ÅŸma zamanÄ± sÃ¼recini (Ã¶rneÄŸin, Python, Java, Node, Ruby) baÅŸlatÄ±rken etkiler. AyrÄ±ca, **bizim uzantÄ±mÄ±zdan sonra yÃ¼klenen ve bu deÄŸiÅŸkene dayanan uzantÄ±lar** da bizim uzantÄ±mÄ±z Ã¼zerinden yÃ¶nlendirilir. Bu yapÄ±landÄ±rma, kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mÄ±n gÃ¼venlik Ã¶nlemlerini veya gÃ¼nlÃ¼kleme uzantÄ±larÄ±nÄ± doÄŸrudan Ã§alÄ±ÅŸma zamanÄ± ortamÄ±nda tamamen atlamasÄ±nÄ± saÄŸlayabilir.

<figure><img src="../../../../.gitbook/assets/image (3) (4).png" alt=""><figcaption><p><a href="https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.mitm.png">https://www.clearvector.com/blog/content/images/size/w1000/2022/11/2022110801.rapid.mitm.png</a></p></figcaption></figure>

[**lambda-spy**](https://github.com/clearvector/lambda-spy) aracÄ±, bu **bellek yazma** iÅŸlemini gerÃ§ekleÅŸtirmek ve lambda isteklerinden, diÄŸer **uzantÄ± isteklerinden** hassas bilgileri **Ã§almak** ve hatta **deÄŸiÅŸtirmek** iÃ§in oluÅŸturulmuÅŸtur.

## Referanslar

* [https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/](https://aws.amazon.com/blogs/compute/building-extensions-for-aws-lambda-in-preview/)
* [https://www.clearvector.com/blog/lambda-spy/](https://www.clearvector.com/blog/lambda-spy/)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Discord grubuna** ğŸ’¬ [**katÄ±lÄ±n**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±nda.

</details>
{% endhint %}
