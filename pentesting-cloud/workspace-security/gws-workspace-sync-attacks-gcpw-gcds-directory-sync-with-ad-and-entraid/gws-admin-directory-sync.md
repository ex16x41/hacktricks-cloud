# GWS - Admin Directory Sync

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Temel Bilgiler

GCDS ile kullanÄ±cÄ±larÄ± senkronize etmenin bu yolunun ana farkÄ±, GCDS'nin bazÄ± ikili dosyalarÄ± indirip Ã§alÄ±ÅŸtÄ±rarak manuel olarak yapÄ±lmasÄ±dÄ±r; oysa **Admin Directory Sync, Google tarafÄ±ndan yÃ¶netilen sunucusuz** bir hizmettir ve [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories) adresindedir.

Bu yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± anda bu hizmet beta aÅŸamasÄ±ndadÄ±r ve 2 tÃ¼r senkronizasyonu desteklemektedir: **Active Directory** ve **Azure Entra ID**'den:

* **Active Directory:** Bunu ayarlamak iÃ§in **Google'a Active Directory ortamÄ±nÄ±za eriÅŸim vermeniz** gerekir. Google yalnÄ±zca GCP aÄŸlarÄ±na (**VPC baÄŸlantÄ±larÄ±** aracÄ±lÄ±ÄŸÄ±yla) eriÅŸim saÄŸladÄ±ÄŸÄ± iÃ§in bir baÄŸlantÄ± oluÅŸturmanÄ±z ve ardÄ±ndan AD'nizi bu baÄŸlantÄ±dan, GCP aÄŸÄ±ndaki VM'lerde veya Cloud VPN veya Cloud Interconnect kullanarak eriÅŸilebilir hale getirmeniz gerekir. AyrÄ±ca, dizin Ã¼zerinde okuma eriÅŸimi olan bir hesabÄ±n **kimlik bilgilerini** ve **LDAPS** Ã¼zerinden iletiÅŸim kurmak iÃ§in bir **sertifika** saÄŸlamanÄ±z gerekir.
* **Azure Entra ID:** Bunu yapÄ±landÄ±rmak iÃ§in, Google tarafÄ±ndan gÃ¶sterilen bir aÃ§Ä±lÄ±r pencerede Entra ID aboneliÄŸi Ã¼zerinde okuma eriÅŸimi olan bir kullanÄ±cÄ± ile Azure'a **giriÅŸ yapmanÄ±z** yeterlidir ve Google, Entra ID Ã¼zerinde okuma eriÅŸimi olan token'Ä± saklayacaktÄ±r.

DoÄŸru bir ÅŸekilde yapÄ±landÄ±rÄ±ldÄ±ÄŸÄ±nda, her iki seÃ§enek de **kullanÄ±cÄ±larÄ± ve gruplarÄ± Workspace'e senkronize etmeye** olanak tanÄ±yacaktÄ±r, ancak Workspace'ten AD veya EntraID'ye kullanÄ±cÄ± ve gruplarÄ± yapÄ±landÄ±rmaya izin vermeyecektir.

Bu senkronizasyon sÄ±rasÄ±nda izin verilen diÄŸer seÃ§enekler ÅŸunlardÄ±r:

* Yeni kullanÄ±cÄ±lara giriÅŸ yapmalarÄ± iÃ§in bir e-posta gÃ¶ndermek
* E-posta adreslerini Workspace tarafÄ±ndan kullanÄ±lan adresle otomatik olarak deÄŸiÅŸtirmek. Yani, eÄŸer Workspace `@hacktricks.xyz` kullanÄ±yorsa ve EntraID kullanÄ±cÄ±larÄ± `@carloshacktricks.onmicrosoft.com` kullanÄ±yorsa, `@hacktricks.xyz` hesapta oluÅŸturulan kullanÄ±cÄ±lar iÃ§in kullanÄ±lacaktÄ±r.
* Senkronize edilecek **kullanÄ±cÄ±larÄ± iÃ§eren gruplarÄ±** seÃ§mek.
* Senkronize edilecek ve Workspace'te oluÅŸturulacak **gruplarÄ±** seÃ§mek (veya tÃ¼m gruplarÄ± senkronize etmek iÃ§in belirtmek).

### AD/EntraID'den -> Google Workspace (& GCP)

EÄŸer bir AD veya EntraID'yi ele geÃ§irmeyi baÅŸarÄ±rsanÄ±z, Google Workspace ile senkronize edilecek kullanÄ±cÄ±lar ve gruplar Ã¼zerinde tam kontrol sahibi olursunuz.\
Ancak, kullanÄ±cÄ±larÄ±n Workspace'te kullanÄ±yor olabileceÄŸi **ÅŸifrelerin** **aynÄ± olabileceÄŸini veya olmayabileceÄŸini** unutmayÄ±n.

#### KullanÄ±cÄ±lara SaldÄ±rmak

Senkronizasyon gerÃ§ekleÅŸtiÄŸinde, **AD'den tÃ¼m kullanÄ±cÄ±larÄ± veya yalnÄ±zca belirli bir OU'dan olanlarÄ±** veya yalnÄ±zca **EntraID'deki belirli gruplarÄ±n Ã¼yelerini** senkronize edebilir. Bu, senkronize edilmiÅŸ bir kullanÄ±cÄ±ya saldÄ±rmak (veya senkronize edilen yeni bir kullanÄ±cÄ± oluÅŸturmak) iÃ§in Ã¶nce hangi kullanÄ±cÄ±larÄ±n senkronize edildiÄŸini belirlemeniz gerektiÄŸi anlamÄ±na gelir.

* KullanÄ±cÄ±lar **AD veya EntraID'den ÅŸifrelerini yeniden kullanÄ±yor olabilir**, ancak bu, **giriÅŸ yapmak iÃ§in kullanÄ±cÄ±larÄ±n ÅŸifrelerini ele geÃ§irmeniz gerektiÄŸi** anlamÄ±na gelir.
* KullanÄ±cÄ±larÄ±n **e-postalarÄ±na** eriÅŸiminiz varsa, mevcut bir kullanÄ±cÄ±nÄ±n Workspace ÅŸifresini **deÄŸiÅŸtirebilir** veya **yeni bir kullanÄ±cÄ± oluÅŸturabilir**, senkronize edilene kadar bekleyebilir ve hesabÄ± ayarlayabilirsiniz.

Workspace iÃ§inde kullanÄ±cÄ±ya eriÅŸtiÄŸinizde, varsayÄ±lan olarak bazÄ± **izinler verilebilir**.

#### Gruplara SaldÄ±rmak

Ã–ncelikle hangi gruplarÄ±n senkronize edildiÄŸini belirlemeniz gerekir. **TÃœM** gruplarÄ±n senkronize edilme olasÄ±lÄ±ÄŸÄ± vardÄ±r (Ã§Ã¼nkÃ¼ Workspace bunu saÄŸlar).

{% hint style="info" %}
Gruplar ve Ã¼yelikler Workspace'e aktarÄ±lsa bile, **kullanÄ±cÄ± senkronizasyonunda senkronize edilmeyen kullanÄ±cÄ±lar** gruplar senkronizasyonu sÄ±rasÄ±nda oluÅŸturulmayacaktÄ±r, bu gruplarÄ±n herhangi birinin Ã¼yesi olsalar bile.
{% endhint %}

Azure'dan hangi gruplarÄ±n **Workspace veya GCP'de izinler atandÄ±ÄŸÄ±nÄ±** biliyorsanÄ±z, yalnÄ±zca ele geÃ§irilmiÅŸ (veya yeni oluÅŸturulmuÅŸ) bir kullanÄ±cÄ±yÄ± o gruba ekleyebilir ve bu izinleri alabilirsiniz.

Workspace'teki mevcut ayrÄ±calÄ±klÄ± gruplarÄ± kÃ¶tÃ¼ye kullanmanÄ±n baÅŸka bir yolu vardÄ±r. Ã–rneÄŸin, `gcp-organization-admins@<workspace.email>` grubu genellikle GCP Ã¼zerinde yÃ¼ksek ayrÄ±calÄ±klara sahiptir.

EÄŸer EntraID'den Workspace'e senkronizasyon, **ithal edilen nesnenin alanÄ±nÄ±** Workspace'in e-postasÄ± ile **deÄŸiÅŸtirecek ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸsa**, bir saldÄ±rganÄ±n EntraID'de `gcp-organization-admins@<entraid.email>` grubunu oluÅŸturmasÄ±, bu gruba bir kullanÄ±cÄ± eklemesi ve tÃ¼m gruplarÄ±n senkronizasyonunu beklemesi mÃ¼mkÃ¼n olacaktÄ±r.\
**KullanÄ±cÄ±, `gcp-organization-admins@<workspace.email>` grubuna eklenerek GCP'de ayrÄ±calÄ±klarÄ±nÄ± artÄ±racaktÄ±r.**

### Google Workspace'ten -> AD/EntraID

Workspace'in kullanÄ±cÄ±larÄ± ve gruplarÄ± senkronize etmek iÃ§in AD veya EntraID Ã¼zerinde yalnÄ±zca okuma eriÅŸimi olan kimlik bilgilerine ihtiyaÃ§ duyduÄŸunu unutmayÄ±n. Bu nedenle, Google Workspace'i AD veya EntraID'de herhangi bir deÄŸiÅŸiklik yapmak iÃ§in kÃ¶tÃ¼ye kullanmak mÃ¼mkÃ¼n deÄŸildir. Yani, **bu ÅŸu anda mÃ¼mkÃ¼n deÄŸildir**.

Google'Ä±n AD kimlik bilgilerini veya EntraID token'Ä±nÄ± nerede sakladÄ±ÄŸÄ±nÄ± da bilmiyorum ve **senkronizasyonu yeniden yapÄ±landÄ±rarak bunlarÄ± geri alamazsÄ±nÄ±z** (web formunda gÃ¶rÃ¼nmezler, tekrar vermeniz gerekir). Ancak, web Ã¼zerinden mevcut iÅŸlevselliÄŸi **kullanÄ±cÄ±larÄ± ve gruplarÄ± listelemek** iÃ§in kÃ¶tÃ¼ye kullanmak mÃ¼mkÃ¼n olabilir.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
