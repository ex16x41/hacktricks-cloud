# GWS - Admin Directory Sync

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## ê¸°ë³¸ ì •ë³´

GCDSì™€ ì‚¬ìš©ìë¥¼ ë™ê¸°í™”í•˜ëŠ” ì´ ë°©ë²•ì˜ ì£¼ìš” ì°¨ì´ì ì€ GCDSê°€ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ì¼ë¶€ ë°”ì´ë„ˆë¦¬ë¡œ ìˆ˜ë™ìœ¼ë¡œ ìˆ˜í–‰ë˜ëŠ” ë°˜ë©´, **Admin Directory SyncëŠ” ì„œë²„ë¦¬ìŠ¤**ë¡œ Googleì—ì„œ ê´€ë¦¬ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. [https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ê¸€ì„ ì‘ì„±í•˜ëŠ” ì‹œì ì—ì„œ ì´ ì„œë¹„ìŠ¤ëŠ” ë² íƒ€ ìƒíƒœì´ë©° ë‘ ê°€ì§€ ìœ í˜•ì˜ ë™ê¸°í™”ë¥¼ ì§€ì›í•©ë‹ˆë‹¤: **Active Directory**ì™€ **Azure Entra ID**ì—ì„œ:

* **Active Directory:** ì´ë¥¼ ì„¤ì •í•˜ë ¤ë©´ **Googleì— Active Directory í™˜ê²½ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ë¶€ì—¬í•´ì•¼** í•©ë‹ˆë‹¤. Googleì€ **VPC ì»¤ë„¥í„°**ë¥¼ í†µí•´ GCP ë„¤íŠ¸ì›Œí¬ì—ë§Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì»¤ë„¥í„°ë¥¼ ìƒì„±í•œ ë‹¤ìŒ GCP ë„¤íŠ¸ì›Œí¬ì˜ VMì— ìˆê±°ë‚˜ Cloud VPN ë˜ëŠ” Cloud Interconnectë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ ì»¤ë„¥í„°ì—ì„œ ADë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ **ë””ë ‰í† ë¦¬ì— ëŒ€í•œ ì½ê¸° ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” ê³„ì •ì˜ ìê²© ì¦ëª…**ê³¼ **LDAPS**ë¥¼ í†µí•´ ì—°ë½í•˜ê¸° ìœ„í•œ **ì¸ì¦ì„œ**ë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤.
* **Azure Entra ID:** ì´ë¥¼ êµ¬ì„±í•˜ë ¤ë©´ **ì½ê¸° ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìë¡œ Azureì— ë¡œê·¸ì¸**í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. Googleì´ íŒì—…ì—ì„œ Entra ID êµ¬ë…ì— ëŒ€í•œ ì½ê¸° ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” í† í°ì„ ìœ ì§€í•©ë‹ˆë‹¤.

ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ë˜ë©´ ë‘ ì˜µì…˜ ëª¨ë‘ **ì‚¬ìš©ì ë° ê·¸ë£¹ì„ Workspaceì™€ ë™ê¸°í™”**í•  ìˆ˜ ìˆì§€ë§Œ, Workspaceì—ì„œ AD ë˜ëŠ” EntraIDë¡œ ì‚¬ìš©ì ë° ê·¸ë£¹ì„ êµ¬ì„±í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤.

ì´ ë™ê¸°í™” ì¤‘ì— í—ˆìš©ë˜ëŠ” ë‹¤ë¥¸ ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

* ìƒˆ ì‚¬ìš©ìì—ê²Œ ë¡œê·¸ì¸í•˜ë¼ëŠ” ì´ë©”ì¼ ì „ì†¡
* Workspaceì—ì„œ ì‚¬ìš©í•˜ëŠ” ì´ë©”ì¼ ì£¼ì†Œë¡œ ìë™ìœ¼ë¡œ ë³€ê²½. ë”°ë¼ì„œ Workspaceê°€ `@hacktricks.xyz`ë¥¼ ì‚¬ìš©í•˜ê³  EntraID ì‚¬ìš©ìê°€ `@carloshacktricks.onmicrosoft.com`ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, `@hacktricks.xyz`ê°€ ê³„ì •ì— ìƒì„±ëœ ì‚¬ìš©ìì—ê²Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
* ë™ê¸°í™”í•  **ì‚¬ìš©ìê°€ í¬í•¨ëœ ê·¸ë£¹ ì„ íƒ**.
* Workspaceì—ì„œ ë™ê¸°í™”í•˜ê³  ìƒì„±í•  **ê·¸ë£¹ ì„ íƒ**(ë˜ëŠ” ëª¨ë“  ê·¸ë£¹ì„ ë™ê¸°í™”í•˜ë„ë¡ ì§€ì •).

### AD/EntraID -> Google Workspace (& GCP)

AD ë˜ëŠ” EntraIDë¥¼ ì†ìƒì‹œí‚¤ë©´ Google Workspaceì™€ ë™ê¸°í™”ë  ì‚¬ìš©ì ë° ê·¸ë£¹ì— ëŒ€í•œ ì „ì²´ ì œì–´ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤.\
ê·¸ëŸ¬ë‚˜ ì‚¬ìš©ìê°€ Workspaceì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **ë¹„ë°€ë²ˆí˜¸**ëŠ” **ê°™ì„ ìˆ˜ë„ ìˆê³  ì•„ë‹ ìˆ˜ë„** ìˆìŠµë‹ˆë‹¤.

#### ì‚¬ìš©ì ê³µê²©

ë™ê¸°í™”ê°€ ë°œìƒí•˜ë©´ **ADì˜ ëª¨ë“  ì‚¬ìš©ì ë˜ëŠ” íŠ¹ì • OUì˜ ì‚¬ìš©ìë§Œ ë™ê¸°í™”**ë˜ê±°ë‚˜ **EntraIDì˜ íŠ¹ì • ê·¸ë£¹ì˜ ì‚¬ìš©ìë§Œ ë™ê¸°í™”**ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë™ê¸°í™”ëœ ì‚¬ìš©ìì—ê²Œ ê³µê²©ì„ í•˜ë ¤ë©´ ë¨¼ì € ì–´ë–¤ ì‚¬ìš©ìê°€ ë™ê¸°í™”ë˜ê³  ìˆëŠ”ì§€ íŒŒì•…í•´ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

* ì‚¬ìš©ìëŠ” **AD ë˜ëŠ” EntraIDì—ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  ì•„ë‹ ìˆ˜ë„** ìˆì§€ë§Œ, ì´ëŠ” **ë¡œê·¸ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì†ìƒì‹œì¼œì•¼** í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
* ì‚¬ìš©ìì˜ **ë©”ì¼**ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤ë©´, **ê¸°ì¡´ ì‚¬ìš©ìì˜ Workspace ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½**í•˜ê±°ë‚˜ **ìƒˆ ì‚¬ìš©ìë¥¼ ìƒì„±**í•˜ê³ , ë™ê¸°í™”ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ ê³„ì •ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Workspace ë‚´ì—ì„œ ì‚¬ìš©ìì— ì ‘ê·¼í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì¼ë¶€ **ê¶Œí•œì´ ë¶€ì—¬ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

#### ê·¸ë£¹ ê³µê²©

ì–´ë–¤ ê·¸ë£¹ì´ ë™ê¸°í™”ë˜ê³  ìˆëŠ”ì§€ ë¨¼ì € íŒŒì•…í•´ì•¼ í•©ë‹ˆë‹¤. **ëª¨ë“ ** ê·¸ë£¹ì´ ë™ê¸°í™”ë  ê°€ëŠ¥ì„±ì´ ìˆì§€ë§Œ (Workspaceê°€ ì´ë¥¼ í—ˆìš©í•˜ë¯€ë¡œ).

{% hint style="info" %}
ê·¸ë£¹ê³¼ ë©¤ë²„ì‹­ì´ Workspaceì— ê°€ì ¸ì™€ì§€ë”ë¼ë„, **ì‚¬ìš©ì ë™ê¸°í™”ì—ì„œ ë™ê¸°í™”ë˜ì§€ ì•Šì€ ì‚¬ìš©ì**ëŠ” ë™ê¸°í™”ëœ ê·¸ë£¹ì˜ ë©¤ë²„ì¼ì§€ë¼ë„ ê·¸ë£¹ ë™ê¸°í™” ì¤‘ì— ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
{% endhint %}

Azureì—ì„œ ì–´ë–¤ ê·¸ë£¹ì´ **Workspace ë˜ëŠ” GCPì—ì„œ ê¶Œí•œì´ í• ë‹¹**ë˜ê³  ìˆëŠ”ì§€ ì•Œê²Œ ë˜ë©´, ì†ìƒëœ ì‚¬ìš©ì(ë˜ëŠ” ìƒˆë¡œ ìƒì„±ëœ ì‚¬ìš©ì)ë¥¼ í•´ë‹¹ ê·¸ë£¹ì— ì¶”ê°€í•˜ì—¬ ê·¸ ê¶Œí•œì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Workspaceì—ì„œ ê¸°ì¡´ì˜ íŠ¹ê¶Œ ê·¸ë£¹ì„ ì•…ìš©í•  ìˆ˜ ìˆëŠ” ë˜ ë‹¤ë¥¸ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê·¸ë£¹ `gcp-organization-admins@<workspace.email>`ëŠ” ì¼ë°˜ì ìœ¼ë¡œ GCPì— ëŒ€í•œ ë†’ì€ ê¶Œí•œì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ EntraIDì—ì„œ Workspaceë¡œì˜ ë™ê¸°í™”ê°€ **ê°€ì ¸ì˜¨ ê°ì²´ì˜ ë„ë©”ì¸ì„ Workspaceì˜ ì´ë©”ì¼ë¡œ ëŒ€ì²´í•˜ë„ë¡ êµ¬ì„±ëœ ê²½ìš°**, ê³µê²©ìê°€ EntraIDì—ì„œ `gcp-organization-admins@<entraid.email>` ê·¸ë£¹ì„ ìƒì„±í•˜ê³  ì´ ê·¸ë£¹ì— ì‚¬ìš©ìë¥¼ ì¶”ê°€í•œ ë‹¤ìŒ ëª¨ë“  ê·¸ë£¹ì˜ ë™ê¸°í™”ê°€ ë°œìƒí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
**ì‚¬ìš©ìëŠ” `gcp-organization-admins@<workspace.email>` ê·¸ë£¹ì— ì¶”ê°€ë˜ì–´ GCPì—ì„œ ê¶Œí•œì´ ìƒìŠ¹í•©ë‹ˆë‹¤.**

### Google Workspace -> AD/EntraID

WorkspaceëŠ” ì‚¬ìš©ìë¥¼ ë™ê¸°í™”í•˜ê¸° ìœ„í•´ AD ë˜ëŠ” EntraIDì— ëŒ€í•œ ì½ê¸° ì „ìš© ì•¡ì„¸ìŠ¤ ê¶Œí•œì´ ìˆëŠ” ìê²© ì¦ëª…ì„ ìš”êµ¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ Google Workspaceë¥¼ ì•…ìš©í•˜ì—¬ AD ë˜ëŠ” EntraIDì—ì„œ ë³€ê²½ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ **í˜„ì¬ë¡œì„œëŠ” ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤**.

Googleì´ AD ìê²© ì¦ëª…ì´ë‚˜ EntraID í† í°ì„ ì–´ë””ì— ì €ì¥í•˜ëŠ”ì§€ ëª¨ë¥´ë©°, **ë™ê¸°í™”ë¥¼ ì¬êµ¬ì„±í•˜ì—¬ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤** (ì›¹ ì–‘ì‹ì— ë‚˜íƒ€ë‚˜ì§€ ì•Šìœ¼ë©°, ë‹¤ì‹œ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤). ê·¸ëŸ¬ë‚˜ ì›¹ì—ì„œ í˜„ì¬ ê¸°ëŠ¥ì„ ì•…ìš©í•˜ì—¬ **ì‚¬ìš©ì ë° ê·¸ë£¹ ëª©ë¡ì„ ë‚˜ì—´**í•  ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
