# GWS - Workspace Pentesting

{% hint style="success" %}
AWSハッキングを学び、実践する：<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCPハッキングを学び、実践する：<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksをサポートする</summary>

* [**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)を確認してください！
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**をフォローしてください。**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してハッキングトリックを共有してください。**

</details>
{% endhint %}

## エントリーポイント

### GoogleプラットフォームとOAuthアプリのフィッシング

Drive、Chat、GroupsなどのさまざまなGoogleプラットフォームを使用して、被害者にフィッシングリンクを送信する方法や、Google OAuthフィッシングを実行する方法を確認してください：

{% content-ref url="gws-google-platforms-phishing/" %}
[gws-google-platforms-phishing](gws-google-platforms-phishing/)
{% endcontent-ref %}

### パスワードスプレー

見つけたすべてのメールアドレス（または発見したメール名パターンに基づいて生成したもの）でパスワードをテストするために、[**https://github.com/ustayready/CredKing**](https://github.com/ustayready/CredKing)のようなツールを使用できます（メンテナンスされていないようですが）。このツールは、AWSラムダを使用してIPアドレスを変更します。

## ポストエクスプロイト

いくつかの資格情報やユーザーのセッションを侵害した場合、ユーザーの潜在的な機密情報にアクセスし、特権を昇格させるためにいくつかのアクションを実行できます：

{% content-ref url="gws-post-exploitation.md" %}
[gws-post-exploitation.md](gws-post-exploitation.md)
{% endcontent-ref %}

### GWS <--> GCP ピボッティング

GWSとGCPの間でピボットするためのさまざまな技術について詳しく読む：

{% content-ref url="../gcp-security/gcp-to-workspace-pivoting/" %}
[gcp-to-workspace-pivoting](../gcp-security/gcp-to-workspace-pivoting/)
{% endcontent-ref %}

## GWS <--> GCPW | GCDS | ディレクトリ同期（AD & EntraID）

* **GCPW（Google Credential Provider for Windows）**：これは、Google Workspaceが提供するシングルサインオンで、ユーザーは**Workspaceの資格情報**を使用してWindows PCにログインできます。さらに、これはPCのいくつかの場所にGoogle Workspaceにアクセスするためのトークンを**保存します**。
* **GCDS（Google Cloud Directory Sync）**：これは、**アクティブディレクトリのユーザーとグループをWorkspaceに同期するために使用できるツール**です。このツールは、**Workspaceのスーパーユーザーおよび特権のあるADユーザーの資格情報**を必要とします。したがって、ユーザーを時々同期しているドメインサーバー内で見つけることができるかもしれません。
* **管理者ディレクトリ同期**：これは、[https://admin.google.com/ac/sync/externaldirectories](https://admin.google.com/ac/sync/externaldirectories)からサーバーレスプロセスでADおよびEntraIDのユーザーを同期することを可能にします。

{% content-ref url="gws-workspace-sync-attacks-gcpw-gcds-gps-directory-sync-with-ad-and-entraid/" %}
[gws-workspace-sync-attacks-gcpw-gcds-gps-directory-sync-with-ad-and-entraid](gws-workspace-sync-attacks-gcpw-gcds-gps-directory-sync-with-ad-and-entraid/)
{% endcontent-ref %}

## 永続性

いくつかの資格情報やユーザーのセッションを侵害した場合、永続性を維持するためのこれらのオプションを確認してください：

{% content-ref url="gws-persistence.md" %}
[gws-persistence.md](gws-persistence.md)
{% endcontent-ref %}

## アカウント侵害の回復

* すべてのセッションからログアウト
* ユーザーパスワードを変更
* 新しい2FAバックアップコードを生成
* アプリパスワードを削除
* OAuthアプリを削除
* 2FAデバイスを削除
* メール転送を削除
* メールフィルターを削除
* 回復用メール/電話を削除
* 悪意のある同期スマートフォンを削除
* 悪いAndroidアプリを削除
* 悪いアカウントの委任を削除

## 参考文献

* [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - G Suiteのハッキング：ダークアプリスクリプトマジックの力
* [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike FelchとBeau Bullock - OK Google、G Suiteをレッドチームするにはどうすればよいですか？

{% hint style="success" %}
AWSハッキングを学び、実践する：<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCPハッキングを学び、実践する：<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksをサポートする</summary>

* [**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)を確認してください！
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**をフォローしてください。**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してハッキングトリックを共有してください。**

</details>
{% endhint %}
