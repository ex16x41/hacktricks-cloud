# GWS - Google PlatformlarÄ± Phishing

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve uygulayÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking pÃ¼f noktalarÄ±nÄ± paylaÅŸarak PR'ler gÃ¶ndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na katkÄ±da bulunun.

</details>
{% endhint %}

## Genel Phishing Metodolojisi

{% embed url="https://book.hacktricks.xyz/generic-methodologies-and-resources/phishing-methodology" %}

## Google GruplarÄ± Phishing

GÃ¶rÃ¼nÃ¼ÅŸe gÃ¶re, varsayÄ±lan olarak, iÅŸ yeri Ã¼yeleri [**gruplar oluÅŸturabilir**](https://groups.google.com/all-groups) **ve insanlarÄ± bu gruplara davet edebilirler**. Daha sonra kullanÄ±cÄ±ya gÃ¶nderilecek e-postayÄ± **bazÄ± baÄŸlantÄ±lar ekleyerek deÄŸiÅŸtirebilirsiniz**. E-posta **bir Google adresinden geleceÄŸi iÃ§in**, bu **gerÃ§ek** gÃ¶rÃ¼necek ve insanlar baÄŸlantÄ±ya tÄ±klayabilir.

AyrÄ±ca, **FROM** adresini **Google grup e-postasÄ±** olarak ayarlamak ve grup iÃ§indeki kullanÄ±cÄ±lara **daha fazla e-posta gÃ¶ndermek** mÃ¼mkÃ¼ndÃ¼r, aÅŸaÄŸÄ±daki resimde olduÄŸu gibi grup **`google--support@googlegroups.com`** oluÅŸturuldu ve grup Ã¼yelerine (izinleri olmadan eklenenler) bir e-posta gÃ¶nderildi.

<figure><img src="../../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

## Google Sohbet Phishing

Bir kiÅŸiyle **sohbet baÅŸlatabilir** veya **konuÅŸma daveti gÃ¶nderebilirsiniz**. AyrÄ±ca, "Google Destek" gibi herhangi bir adÄ± olabilen bir **Alan** oluÅŸturabilir ve Ã¼yeleri **davet edebilirsiniz**. Kabul ederlerse, Google Destek ile konuÅŸtuklarÄ±nÄ± dÃ¼ÅŸÃ¼nebilirler:

<figure><img src="../../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

{% hint style="success" %}
**Ancak testlerimde davet edilen Ã¼yeler davet bile almadÄ±.**
{% endhint %}

Bu nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± geÃ§miÅŸte ÅŸurada kontrol edebilirsiniz: [https://www.youtube.com/watch?v=KTVHLolz6cE\&t=904s](https://www.youtube.com/watch?v=KTVHLolz6cE\&t=904s)

## Google Belge Phishing

GeÃ§miÅŸte, **gÃ¶rÃ¼nÃ¼ÅŸte meÅŸru bir belge** oluÅŸturmak ve ardÄ±ndan bir yorumda **bazÄ± e-postalarÄ± belirtmek (@user@gmail.com gibi)** mÃ¼mkÃ¼ndÃ¼. Google, bu e-posta adresine belgede adlarÄ±nÄ±n geÃ§tiÄŸini bildiren bir e-posta gÃ¶nderdi.\
GÃ¼nÃ¼mÃ¼zde bu iÅŸe yaramÄ±yor ancak **kurban e-postaya belge eriÅŸim izni verirseniz**, Google bunu bildiren bir e-posta gÃ¶nderecektir. Birini belirttiÄŸinizde gÃ¶rÃ¼nen mesaj ÅŸudur:

<figure><img src="../../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

{% hint style="success" %}
KurbanlarÄ±n, dÄ±ÅŸ belgenin kendileriyle paylaÅŸÄ±ldÄ±ÄŸÄ±nÄ± bildiren e-postalarÄ±n e-postalarÄ±na ulaÅŸmasÄ±na izin vermeyen bir koruma mekanizmasÄ± olabilir.
{% endhint %}

## Google Takvim Phishing

Åirketi hedef alan bir **takvim etkinliÄŸi oluÅŸturabilir** ve saldÄ±rdÄ±ÄŸÄ±nÄ±z ÅŸirketin e-posta adreslerini sahip olduÄŸunuz kadar ekleyebilirsiniz. Bu takvim etkinliÄŸini **ÅŸu anki zamandan 5 veya 15 dakika** sonra planlayÄ±n. EtkinliÄŸi gerÃ§ekÃ§i gÃ¶sterin ve **okumalarÄ± gerektiÄŸini belirten bir yorum ve baÅŸlÄ±k ekleyin** (phishing baÄŸlantÄ±sÄ±yla).

Bu tarayÄ±cÄ±da "Ä°nsanlarÄ± Ä°ÅŸten Ã‡Ä±karma" baÅŸlÄ±klÄ± bir toplantÄ±yla ilgili uyarÄ± gÃ¶rÃ¼necektir, bu nedenle daha fazla phishing benzeri bir baÅŸlÄ±k belirleyebilirsiniz (ve hatta e-postanÄ±za iliÅŸkilendirilen adÄ± deÄŸiÅŸtirebilirsiniz).

<figure><img src="../../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

Daha az ÅŸÃ¼pheli gÃ¶rÃ¼nmesi iÃ§in:

* AlÄ±cÄ±larÄ±n **davet edilen diÄŸer kiÅŸileri gÃ¶rememesini** saÄŸlayÄ±n
* **Etkinlikle ilgili e-postalar gÃ¶ndermeyin**. Sonra insanlar sadece 5 dakika iÃ§inde bir toplantÄ± uyarÄ±sÄ± ve o baÄŸlantÄ±yÄ± okumalarÄ± gerektiÄŸine dair uyarÄ±larÄ±nÄ± gÃ¶recekler.
* API'yi kullanarak gÃ¶rÃ¼nÃ¼ÅŸe gÃ¶re **insanlarÄ±n** etkinliÄŸi **kabul ettiÄŸini** ve hatta **onlarÄ±n adÄ±na yorumlar oluÅŸturabileceÄŸinizi** ayarlayabilirsiniz.

## Uygulama Betikleri YÃ¶nlendirme Phishing'i

[https://script.google.com/](https://script.google.com/) adresinde bir betik oluÅŸturmak ve herkesin eriÅŸebileceÄŸi bir web uygulamasÄ± olarak aÃ§Ä±ÄŸa Ã§Ä±karmak mÃ¼mkÃ¼ndÃ¼r ve bu, meÅŸru alan **`script.google.com`**'u kullanacaktÄ±r.  \
AÅŸaÄŸÄ±daki gibi bazÄ± kodlarla bir saldÄ±rgan, betiÄŸi durdurmadan bu sayfada isteÄŸe baÄŸlÄ± iÃ§erik yÃ¼kleyebilir:

{% code overflow="wrap" %}
```javascript
function doGet() {
return HtmlService.createHtmlOutput('<meta http-equiv="refresh" content="0;url=https://cloud.hacktricks.xyz/pentesting-cloud/workspace-security/gws-google-platforms-phishing#app-scripts-redirect-phishing">')
.setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}
```
{% endcode %}

Ã–rneÄŸin [https://script.google.com/macros/s/AKfycbwuLlzo0PUaT63G33MtE6TbGUNmTKXCK12o59RKC7WLkgBTyltaS3gYuH\_ZscKQTJDC/exec](https://script.google.com/macros/s/AKfycbwuLlzo0PUaT63G33MtE6TbGUNmTKXCK12o59RKC7WLkgBTyltaS3gYuH\_ZscKQTJDC/exec) adresine eriÅŸtiÄŸinizde:

<figure><img src="../../../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

{% hint style="success" %}
Ä°Ã§eriÄŸin bir iframe iÃ§inde yÃ¼klendiÄŸi iÃ§in bir uyarÄ± belirecektir.
{% endhint %}

## App Scripts OAuth Phishing

Belgelerle iliÅŸkilendirilmiÅŸ App Scripts oluÅŸturarak kurbanÄ±n OAuth belirteci Ã¼zerinden eriÅŸim elde etmeye Ã§alÄ±ÅŸmak mÃ¼mkÃ¼ndÃ¼r, daha fazla bilgi iÃ§in kontrol edin:

{% content-ref url="gws-app-scripts.md" %}
[gws-app-scripts.md](gws-app-scripts.md)
{% endcontent-ref %}

## OAuth UygulamalarÄ± Phishing

Ã–nceki tekniklerden herhangi biri, kullanÄ±cÄ±nÄ±n **Google OAuth uygulamasÄ±na** eriÅŸmesini saÄŸlamak iÃ§in kullanÄ±labilir ve bu uygulama kullanÄ±cÄ±dan bazÄ± **eriÅŸimler** isteyecektir. KullanÄ±cÄ± **kaynaÄŸa gÃ¼venirse**, uygulamaya da **gÃ¼venebilir** (yÃ¼ksek ayrÄ±calÄ±klÄ± izinler istese bile).

{% hint style="info" %}
Google'Ä±n, uygulamanÄ±n gÃ¼venilir olmadÄ±ÄŸÄ±nÄ± belirten Ã§irkin bir uyarÄ± sunacaÄŸÄ±nÄ± ve Workspace yÃ¶neticilerinin insanlarÄ±n OAuth uygulamalarÄ±nÄ± kabul etmesini engelleyebileceÄŸini unutmayÄ±n.
{% endhint %}

**Google**, kullanÄ±cÄ±lar adÄ±na Ã§eÅŸitli **Google hizmetleriyle etkileÅŸimde bulunabilen uygulamalar oluÅŸturmaya izin verir**: Gmail, Drive, GCP...

BaÅŸka kullanÄ±cÄ±lar adÄ±na **hareket etmek iÃ§in bir uygulama oluÅŸturulduÄŸunda**, geliÅŸtirici, uygulamanÄ±n kullanÄ±cÄ± verilerine eriÅŸmek iÃ§in ihtiyaÃ§ duyduÄŸu kapsamlarÄ± (izinleri) belirtmek Ã¼zere **GCP iÃ§inde bir OAuth uygulamasÄ± oluÅŸturmalÄ±dÄ±r**.\
Bir **kullanÄ±cÄ±** o **uygulamayÄ± kullanmak istediÄŸinde**, belirtilen kapsamlarda belirtilen verilere eriÅŸim saÄŸlayacaÄŸÄ±na dair **uygulamanÄ±n kabul edilmesi gerektiÄŸi** konusunda **uyarÄ±lacaktÄ±r**.

Bu, teknik olmayan kullanÄ±cÄ±larÄ±, sonuÃ§larÄ± anlamayabilecekleri **duyarlÄ± bilgilere eriÅŸen uygulamalarÄ± kullanmaya yÃ¶nlendirmenin** Ã§ok etkili bir yoludur. Ancak, kuruluÅŸ hesaplarÄ±nda bunun gerÃ§ekleÅŸmesini engellemenin yollarÄ± vardÄ±r.

### DoÄŸrulanmamÄ±ÅŸ Uygulama uyarÄ±sÄ±

BahsedildiÄŸi gibi, Google her zaman kullanÄ±cÄ±nÄ±n, uygulamanÄ±n adÄ±na verdikleri izinleri kabul etmesi iÃ§in bir **uyarÄ± penceresi sunacaktÄ±r**. Ancak, uygulama **tehlikeli** olarak kabul edilirse, Google Ã¶nce **tehlikeli olduÄŸunu belirten bir uyarÄ± penceresi** gÃ¶sterecek ve kullanÄ±cÄ±nÄ±n uygulamaya izin vermesini daha zor hale getirecektir.

Bu uyarÄ±, ÅŸu tÃ¼r uygulamalarda gÃ¶rÃ¼nÃ¼r:

* Ã–zel verilere eriÅŸebilen herhangi bir kapsam kullanÄ±yor (Gmail, Drive, GCP, BigQuery...)
* 100'den az kullanÄ±cÄ±ya sahip uygulamalar (100'den fazla kullanÄ±cÄ±ya sahip uygulamalar iÃ§in doÄŸrulanmamÄ±ÅŸ uyarÄ±yÄ± gÃ¶stermeyi durdurmak iÃ§in bir inceleme sÃ¼reci de gereklidir)

### Ä°lginÃ§ Kapsamlar

[**Burada**](https://developers.google.com/identity/protocols/oauth2/scopes) tÃ¼m Google OAuth kapsamlarÄ±nÄ±n bir listesini bulabilirsiniz.

* **cloud-platform**: **Google Cloud Platform** hizmetlerindeki verilerinizi gÃ¶rÃ¼ntÃ¼leyin ve yÃ¶netin. GCP'de kullanÄ±cÄ±yÄ± taklit edebilirsiniz.
* **admin.directory.user.readonly**: KuruluÅŸunuzun GSuite dizinini gÃ¶rÃ¼ntÃ¼leyin ve indirin. TÃ¼m kullanÄ±cÄ±larÄ±n adlarÄ±nÄ±, telefon numaralarÄ±nÄ±, takvim URL'lerini alÄ±n.

### Bir OAuth UygulamasÄ± OluÅŸturun

**OAuth Ä°stemci KimliÄŸi oluÅŸturmaya baÅŸlayÄ±n**

1. [https://console.cloud.google.com/apis/credentials/oauthclient](https://console.cloud.google.com/apis/credentials/oauthclient) adresine gidin ve onay ekranÄ±nÄ± yapÄ±landÄ±rmak iÃ§in tÄ±klayÄ±n.
2. ArdÄ±ndan, **kullanÄ±cÄ± tÃ¼rÃ¼nÃ¼n** **iÃ§sel** (yalnÄ±zca kuruluÅŸunuzdaki kiÅŸiler iÃ§in) veya **harici** olup olmadÄ±ÄŸÄ± sorulacaktÄ±r. Ä°htiyaÃ§larÄ±nÄ±za uygun olanÄ± seÃ§in
* Ä°Ã§sel, kuruluÅŸun bir kullanÄ±cÄ±sÄ±nÄ± zaten ele geÃ§irdiyseniz ve baÅŸka birini avlamak iÃ§in bu UygulamayÄ± oluÅŸturuyorsanÄ±z ilginÃ§ olabilir.
3. Uygulamaya bir **ad**, bir **destek e-postasÄ±** (daha fazla anonimleÅŸmek iÃ§in bir googlegroup e-postasÄ± ayarlayabileceÄŸinizi unutmayÄ±n), bir **logo**, **yetkilendirilmiÅŸ alanlar** ve diÄŸer **gÃ¼ncelleÅŸtirmeler iÃ§in bir e-posta** verin.
4. **OAuth kapsamlarÄ±nÄ± seÃ§in**.
* Bu sayfa, hassas olmayan izinler, hassas izinler ve kÄ±sÄ±tlÄ± izinler olmak Ã¼zere Ã¼Ã§e ayrÄ±lmÄ±ÅŸtÄ±r. Yeni bir izin eklediÄŸinizde, kategorisine eklenir. Ä°stenen izinlere baÄŸlÄ± olarak, kullanÄ±cÄ±ya ne kadar hassas olduklarÄ±nÄ± belirten farklÄ± uyarÄ±lar gÃ¶rÃ¼necektir.
* Hem **`admin.directory.user.readonly`** hem de **`cloud-platform`** hassas izinlerdir.
5. **Test kullanÄ±cÄ±larÄ± ekleyin.** UygulamanÄ±n durumu test aÅŸamasÄ±ndayken, yalnÄ±zca bu kullanÄ±cÄ±lar uygulamaya eriÅŸebileceÄŸinden emin olmak iÃ§in **avlamayÄ± yapacaÄŸÄ±nÄ±z e-postayÄ± eklemeyi unutmayÄ±n**.

Åimdi **daha Ã¶nceden oluÅŸturulan OAuth Ä°stemci KimliÄŸi** kullanarak bir web uygulamasÄ± iÃ§in **kimlik bilgileri alalÄ±m**:

1. [https://console.cloud.google.com/apis/credentials/oauthclient](https://console.cloud.google.com/apis/credentials/oauthclient) adresine geri dÃ¶nÃ¼n, bu sefer farklÄ± bir seÃ§enek gÃ¶rÃ¼necektir.
2. **Web uygulamasÄ± iÃ§in kimlik bilgileri oluÅŸturmayÄ± seÃ§in**
3. Gerekli **Javascript kÃ¶kenleri** ve **yÃ¶nlendirme URI'leri** ayarlayÄ±n
* Test iÃ§in **`http://localhost:8000/callback`** gibi bir ÅŸey belirleyebilirsiniz
4. Uygulama **kimlik bilgilerinizi alÄ±n**

Son olarak, **OAuth uygulama kimlik bilgilerini kullanan bir web uygulamasÄ±nÄ± Ã§alÄ±ÅŸtÄ±ralÄ±m**. Bir Ã¶rnek [https://github.com/carlospolop/gcp\_oauth\_phishing\_example](https://github.com/carlospolop/gcp\_oauth\_phishing\_example) adresinde bulunabilir.
```bash
git clone ttps://github.com/carlospolop/gcp_oauth_phishing_example
cd gcp_oauth_phishing_example
pip install flask requests google-auth-oauthlib
python3 app.py --client-id "<client_id>" --client-secret "<client_secret>"
```
**`http://localhost:8000`** adresine gidin, Google ile GiriÅŸ yap dÃ¼ÄŸmesine tÄ±klayÄ±n, ÅŸÃ¶yle bir mesajla karÅŸÄ±laÅŸacaksÄ±nÄ±z:

<figure><img src="../../../.gitbook/assets/image (333).png" alt=""><figcaption></figcaption></figure>

Uygulama **eriÅŸim ve yenileme belirteÃ§lerini** gÃ¶sterecek, bu belirteÃ§ler kolayca kullanÄ±labilir. Bu belirteÃ§leri nasÄ±l kullanacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgi iÃ§in ÅŸu adrese bakÄ±n:

{% content-ref url="../../gcp-security/gcp-persistence/gcp-non-svc-persistance.md" %}
[gcp-non-svc-persistance.md](../../gcp-security/gcp-persistence/gcp-non-svc-persistance.md)
{% endcontent-ref %}

#### `glcoud` KullanÄ±mÄ±

Web konsolu yerine gcloud kullanarak bir ÅŸeyler yapmak mÃ¼mkÃ¼ndÃ¼r, bakÄ±nÄ±z:

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-clientauthconfig-privesc.md" %}
[gcp-clientauthconfig-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-clientauthconfig-privesc.md)
{% endcontent-ref %}

## Referanslar

* [https://www.youtube-nocookie.com/embed/6AsVUS79gLw](https://www.youtube-nocookie.com/embed/6AsVUS79gLw) - Matthew Bryant - G Suite Hackleme: Koyu Uygulama BetiÄŸi Sihirinin GÃ¼cÃ¼
* [https://www.youtube.com/watch?v=KTVHLolz6cE](https://www.youtube.com/watch?v=KTVHLolz6cE) - Mike Felch ve Beau Bullock - Tamam Google, GSuite'i NasÄ±l KÄ±rmalÄ±yÄ±m?

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks EÄŸitimi AWS Red Team UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitimi GCP Red Team UzmanÄ± (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) katÄ±lÄ±n veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya bizi **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **HackTricks ve HackTricks Cloud** github depolarÄ±na PR gÃ¶ndererek hackleme pÃ¼f noktalarÄ±nÄ± paylaÅŸÄ±n.

</details>
{% endhint %}
