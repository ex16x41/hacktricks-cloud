# GCP - ã‚½ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã®åˆ—æŒ™

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã®ã‚µãƒãƒ¼ãƒˆ</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ï¼
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **HackTricks**ã¨**HackTricks Cloud**ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
{% endhint %}

## åŸºæœ¬æƒ…å ± <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

Google Cloud Source Repositoriesã¯ã€**å®Œå…¨æ©Ÿèƒ½ã‚’å‚™ãˆãŸã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆGitãƒªãƒã‚¸ãƒˆãƒªã‚µãƒ¼ãƒ“ã‚¹**ã§ã™ã€‚ä»–ã®GCPãƒ„ãƒ¼ãƒ«ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«çµ±åˆã•ã‚Œã€**ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å®Œå…¨ã«ç®¡ç†ã•ã‚ŒãŸç’°å¢ƒã§ãƒ›ã‚¹ãƒˆ**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒãƒ¼ãƒ ãŒã‚³ãƒ¼ãƒ‰ã‚’æ ¼ç´ã€ç®¡ç†ã€è¿½è·¡ã™ã‚‹ãŸã‚ã®å”åŠ›çš„ã§å®‰å…¨ãªå ´æ‰€ã‚’æä¾›ã—ã¾ã™ã€‚

Cloud Source Repositoriesã®ä¸»ãªæ©Ÿèƒ½ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™:

1. **å®Œå…¨ç®¡ç†å‹Gitãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: Gitã®æ©Ÿèƒ½ã‚’æä¾›ã—ã€é€šå¸¸ã®Gitã‚³ãƒãƒ³ãƒ‰ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
2. **GCPã‚µãƒ¼ãƒ“ã‚¹ã¨ã®çµ±åˆ**: Cloud Buildã€Pub/Subã€App Engineãªã©ã®ä»–ã®GCPã‚µãƒ¼ãƒ“ã‚¹ã¨çµ±åˆã—ã€ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å±•é–‹ã¾ã§ã®ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’æä¾›ã—ã¾ã™ã€‚
3. **ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒª**: ã‚³ãƒ¼ãƒ‰ãŒå®‰å…¨ã‹ã¤ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã«ä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚Cloud Identityã¨Access Managementï¼ˆIAMï¼‰ãƒ­ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶å¾¡ã§ãã¾ã™ã€‚
4. **ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£æ**: ä»–ã®GCPãƒ„ãƒ¼ãƒ«ã¨é€£æºã—ã¦ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®è‡ªå‹•è§£æã‚’è¡Œã„ã€ãƒã‚°ã€è„†å¼±æ€§ã€ã¾ãŸã¯æ‚ªã„ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ãªã©ã®æ½œåœ¨çš„ãªå•é¡Œã‚’ç‰¹å®šã—ã¾ã™ã€‚
5. **ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«**: ãƒãƒ¼ã‚¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ã‚³ãƒ¡ãƒ³ãƒˆã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦å…±åŒã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
6. **ãƒŸãƒ©ãƒ¼ã‚µãƒãƒ¼ãƒˆ**: GitHubã‚„Bitbucketã«ãƒ›ã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã¨Cloud Source Repositoriesã‚’æ¥ç¶šã—ã€è‡ªå‹•åŒæœŸã‚’å¯èƒ½ã«ã—ã€ã™ã¹ã¦ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’çµ±ä¸€çš„ã«è¡¨ç¤ºã§ãã¾ã™ã€‚

### OffSecæƒ…å ± <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

* ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ã‚½ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆã«ã¯ã€Cloud Pub/Subãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¬é–‹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹**ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ãŒã‚ã‚Šã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹ã®ã¯**Compute SA**ã§ã™ã€‚ãŸã ã—ã€ã‚½ãƒ¼ã‚¹ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç›—ã‚€ã“ã¨ã¯ã§ããªã„ã¨æ€ã„ã¾ã™ã€‚
* GCP Cloud Source Repositoriesã‚¦ã‚§ãƒ–ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆ[https://source.cloud.google.com/](https://source.cloud.google.com/)ï¼‰ã§ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§masterãƒ–ãƒ©ãƒ³ãƒã«é…ç½®ã™ã‚‹**å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
* **Github**ã‚„**Bitbucket**ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’æŒ‡ã™ãƒŸãƒ©ãƒ¼Cloudãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆã“ã‚Œã«ã‚ˆã‚Šã€ã“ã‚Œã‚‰ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ï¼‰ã€‚
* GCPå†…éƒ¨ã‹ã‚‰**ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ‡ãƒãƒƒã‚°ãŒå¯èƒ½**ã§ã™ã€‚
* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Source Repositoriesã¯**ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã‚’ã‚³ãƒŸãƒƒãƒˆã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã‚’é˜²æ­¢**ã—ã¾ã™ãŒã€ã“ã‚Œã‚’ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### Cloud Shellã§é–‹ã

ãƒªãƒã‚¸ãƒˆãƒªã‚’Cloud Shellã§é–‹ãã“ã¨ãŒã§ãã€æ¬¡ã®ã‚ˆã†ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™:

<figure><img src="../../../.gitbook/assets/image (325).png" alt=""><figcaption></figcaption></figure>

ã“ã‚Œã«ã‚ˆã‚Šã€Cloud Shellã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ‡ãƒãƒƒã‚°ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ï¼ˆã“ã‚Œã«ã‚ˆã‚Šã€cloudshellãŒä¾µå®³ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚

### åˆ—æŒ™

{% code overflow="wrap" %}
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
{% endcode %}

### ç‰¹æ¨©æ˜‡æ ¼ã¨ãƒã‚¹ãƒˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

{% content-ref url="../gcp-privilege-escalation/gcp-sourcerepos-privesc.md" %}
[gcp-sourcerepos-privesc.md](../gcp-privilege-escalation/gcp-sourcerepos-privesc.md)
{% endcontent-ref %}

### èªè¨¼ã•ã‚Œã¦ã„ãªã„åˆ—æŒ™

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md" %}
[gcp-source-repositories-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md)
{% endcontent-ref %}

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’ï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’ï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã®ã‚µãƒãƒ¼ãƒˆ</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ï¼
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
{% endhint %}
