# GCP - Enumowanie Repozytoriów Źródłowych

{% hint style="success" %}
Ucz się i ćwicz Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Ucz się i ćwicz Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawdź [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Podziel się sztuczkami hackingowymi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów github.

</details>
{% endhint %}

## Podstawowe Informacje <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

Google Cloud Source Repositories to w pełni funkcjonalna, skalowalna, **prywatna usługa repozytoriów Git**. Została zaprojektowana, aby **przechowywać Twój kod źródłowy w w pełni zarządzanym środowisku**, integrując się płynnie z innymi narzędziami i usługami GCP. Oferuje współpracujące i bezpieczne miejsce dla zespołów do przechowywania, zarządzania i śledzenia ich kodu.

Kluczowe cechy Cloud Source Repositories obejmują:

1. **W pełni zarządzane hostowanie Git**: Oferuje znaną funkcjonalność Git, co oznacza, że możesz używać standardowych poleceń i przepływów pracy Git.
2. **Integracja z usługami GCP**: Integruje się z innymi usługami GCP, takimi jak Cloud Build, Pub/Sub i App Engine, zapewniając pełną śledzenie od kodu do wdrożenia.
3. **Prywatne repozytoria**: Zapewnia, że Twój kod jest przechowywany w sposób bezpieczny i prywatny. Możesz kontrolować dostęp za pomocą ról Cloud Identity and Access Management (IAM).
4. **Analiza kodu źródłowego**: Współpracuje z innymi narzędziami GCP, aby zapewnić automatyczną analizę Twojego kodu źródłowego, identyfikując potencjalne problemy, takie jak błędy, luki w zabezpieczeniach lub złe praktyki kodowania.
5. **Narzędzia do współpracy**: Wspiera współpracujące kodowanie z narzędziami takimi jak prośby o scalanie, komentarze i recenzje.
6. **Wsparcie dla lustracji**: Umożliwia połączenie Cloud Source Repositories z repozytoriami hostowanymi na GitHubie lub Bitbucket, umożliwiając automatyczną synchronizację i zapewniając jednolity widok wszystkich Twoich repozytoriów.

### Informacje OffSec <a href="#reviewing-cloud-git-repositories" id="reviewing-cloud-git-repositories"></a>

* Konfiguracja repozytoriów źródłowych w projekcie będzie miała **Konto Usługi** używane do publikowania wiadomości Cloud Pub/Sub. Domyślnie używane jest **Compute SA**. Jednak **nie sądzę, że możliwe jest skradzenie jego tokena** z Repozytoriów Źródłowych, ponieważ jest wykonywane w tle.
* Aby zobaczyć kod w konsoli internetowej GCP Cloud Source Repositories ([https://source.cloud.google.com/](https://source.cloud.google.com/)), musisz mieć kod **domyślnie w gałęzi master**.
* Możesz również **utworzyć lustrację repozytorium w chmurze**, wskazując na repozytorium z **Github** lub **Bitbucket** (dając dostęp do tych platform).
* Możliwe jest **kodowanie i debugowanie z wnętrza GCP**.
* Domyślnie, Repozytoria Źródłowe **zapobiegają przesyłaniu kluczy prywatnych w commitach**, ale to można wyłączyć.

### Otwórz w Cloud Shell

Możliwe jest otwarcie repozytorium w Cloud Shell, pojawi się taki komunikat:

<figure><img src="../../../.gitbook/assets/image (325).png" alt=""><figcaption></figcaption></figure>

To pozwoli Ci kodować i debugować w Cloud Shell (co może prowadzić do kompromitacji cloudshell).

### Enumowanie

{% code overflow="wrap" %}
```bash
# Repos enumeration
gcloud source repos list #Get names and URLs
gcloud source repos describe <repo_name>
gcloud source repos get-iam-policy <repo_name>

# gcloud repo clone
gcloud source repos clone <REPO NAME>
gcloud source repos get-iam-policy <REPO NAME>
... git add & git commit -m ...
git push --set-upstream origin master
git push -u origin master

# Access via git
## To add a SSH key go to https://source.cloud.google.com/user/ssh_keys (no gcloud command)
git clone ssh://username@domain.com@source.developers.google.com:2022/p/<proj-name>/r/<repo-name>
git add, commit, push...
```
{% endcode %}

### Eskalacja Uprawnień i Po Eksploatacji

{% content-ref url="../gcp-privilege-escalation/gcp-sourcerepos-privesc.md" %}
[gcp-sourcerepos-privesc.md](../gcp-privilege-escalation/gcp-sourcerepos-privesc.md)
{% endcontent-ref %}

### Nieuautoryzowane Enum

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md" %}
[gcp-source-repositories-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-source-repositories-unauthenticated-enum.md)
{% endcontent-ref %}

{% hint style="success" %}
Ucz się i ćwicz Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Ucz się i ćwicz Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawdź [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Dziel się trikami hackingowymi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów na GitHubie.

</details>
{% endhint %}
