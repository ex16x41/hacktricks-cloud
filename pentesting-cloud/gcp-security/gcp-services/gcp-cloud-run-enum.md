# GCP - Cloud Run Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Cloud Run <a href="#reviewing-cloud-run-configurations" id="reviewing-cloud-run-configurations"></a>

Cloud Run is 'n serverlose bestuurde rekenaarplatform wat jou toelaat om **houers** direk bo-op Google se skaalbare infrastruktuur te **hardloop**.

Jy kan jou houer hardloop of as jy Go, Node.js, Python, Java, .NET Core, of Ruby gebruik, kan jy die [bron-gebaseerde ontplooiing](https://cloud.google.com/run/docs/deploying-source-code) opsie gebruik wat **die houer vir jou bou.**

Google het Cloud Run gebou om **goed saam te werk met ander dienste op Google Cloud**, sodat jy volwaardige toepassings kan bou.

### Services and jobs <a href="#services-and-jobs" id="services-and-jobs"></a>

Op Cloud Run kan jou kode of voortdurend as 'n _**diens**_ of as 'n _**taak**_ hardloop. Beide dienste en take hardloop in dieselfde omgewing en kan dieselfde integrasies met ander dienste op Google Cloud gebruik.

* **Cloud Run dienste.** Gebruik om kode te hardloop wat op webversoeke of gebeurtenisse reageer.
* **Cloud Run take.** Gebruik om kode te hardloop wat werk (‚Äòn taak) uitvoer en stop wanneer die werk gedoen is.

## Cloud Run Service

Google [Cloud Run](https://cloud.google.com/run) is 'n ander serverlose aanbod waar jy ook na omgewing veranderlikes kan soek. Cloud Run skep 'n klein webbediener, wat standaard op poort 8080 binne die houer hardloop, wat wag vir 'n HTTP GET-versoek. Wanneer die versoek ontvang word, word 'n taak uitgevoer en die taaklog word via 'n HTTP-respons uitgevoer.

### Relevant details

* Deur **standaard** is die **toegang** tot die webbediener **openbaar**, maar dit kan ook **beperk word tot interne verkeer** (VPC...)\
Boonop kan die **verifikasie** om die webbediener te kontak **alle** toelaat of **verifikasie via IAM vereis**.
* Deur standaard gebruik die **versleuteling** 'n **Google bestuurde sleutel**, maar 'n **CMEK** (Kli√´nt Bestuurde Versleuteling Sleutel) van **KMS** kan ook **gekoop** word.
* Deur **standaard** is die **diensrekening** wat gebruik word die **Compute Engine standaard een** wat **Redakteur** toegang oor die projek het en dit het die **omvang `cloud-platform`.**
* Dit is moontlik om **duidelike teks omgewing veranderlikes** vir die uitvoering te definieer, en selfs **cloud geheime te monteer** of **cloud geheime aan omgewing veranderlikes toe te voeg.**
* Dit is ook moontlik om **verbindinge met Cloud SQL** toe te voeg en **'n l√™erstelsel te monteer.**
* Die **URL's** van die ontplooide dienste is soortgelyk aan **`https://<svc-name>-<random>.a.run.app`**
* 'n Run Service kan **meer as 1 weergawe of hersiening** h√™, en **verkeer tussen verskeie hersienings verdeel.**

### Enumeration
```bash
# List services
gcloud run services list
gcloud run services list --platform=managed
gcloud run services list --platform=gke

# Get info of a service
gcloud run services describe --region <region> <svc-name>

# Get info of all the services together
gcloud run services list --format=yaml
gcloud run services list --platform=managed --format=json
gcloud run services list --platform=gke --format=json

# Get policy
gcloud run services get-iam-policy --region <region> <svc-name>

# Get revisions
gcloud run revisions list --region <region>
gcloud run revisions describe --region <region> <revision>

# Get domains
gcloud run domain-mappings list
gcloud run domain-mappings describe <name>

# Attempt to trigger a job unauthenticated
curl <url>

# Attempt to trigger a job with your current gcloud authorization
curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" <url>
```
## Cloud Run Jobs

Cloud Run-jobs is 'n beter pas vir **houers wat tot voltooiing loop en nie versoeke bedien nie**. Jobs het nie die vermo√´ om versoeke te bedien of op 'n poort te luister nie. Dit beteken dat, anders as Cloud Run-dienste, jobs nie 'n webbediener moet saamvoeg nie. In plaas daarvan moet jobs-houers afsluit wanneer hulle klaar is.

### Enumeration
```bash
gcloud beta run jobs list
gcloud beta run jobs describe --region <region> <job-name>
gcloud beta run jobs get-iam-policy --region <region> <job-name>
```
## Privilege Escalation

In die volgende bladsy kan jy kyk hoe om **cloud run toestemmings te misbruik om voorregte te verhoog**:

{% content-ref url="../gcp-privilege-escalation/gcp-run-privesc.md" %}
[gcp-run-privesc.md](../gcp-privilege-escalation/gcp-run-privesc.md)
{% endcontent-ref %}

## Unauthenticated Access

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md" %}
[gcp-cloud-run-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-cloud-run-unauthenticated-enum.md)
{% endcontent-ref %}

## Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-cloud-run-post-exploitation.md" %}
[gcp-cloud-run-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-run-post-exploitation.md)
{% endcontent-ref %}

## Persistence

{% content-ref url="../gcp-persistence/gcp-cloud-run-persistence.md" %}
[gcp-cloud-run-persistence.md](../gcp-persistence/gcp-cloud-run-persistence.md)
{% endcontent-ref %}

## References

* [https://cloud.google.com/run/docs/overview/what-is-cloud-run](https://cloud.google.com/run/docs/overview/what-is-cloud-run)

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
