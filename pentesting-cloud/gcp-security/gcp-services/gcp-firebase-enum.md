# GCP - Firebase Enum

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã®å­¦ç¿’ã¨ç·´ç¿’: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã®ã‚µãƒãƒ¼ãƒˆ</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ï¼
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **HackTricks**ã¨**HackTricks Cloud**ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
{% endhint %}

## [Firebase](https://cloud.google.com/sdk/gcloud/reference/firebase/)

Firebase Realtime Databaseã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ãŠã‚ˆã³åŒæœŸã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ›ã‚¹ãƒˆå‹ã®NoSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚[è©³ç´°ã¯ã“ã¡ã‚‰](https://firebase.google.com/products/realtime-database/)ã€‚

### èªè¨¼ãªã—ã®åˆ—æŒ™

ä¸€éƒ¨ã®**Firebaseã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**ã¯**ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹Firebaseã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒ**æ§‹æˆãŒæ‚ªãã€èª°ã‚‚ãŒèª­ã¿å–ã‚Šï¼ˆãŠã‚ˆã³æ›¸ãè¾¼ã¿ï¼‰ã®æ¨©é™ã‚’æŒã¤ã‚ˆã†ã«è¨­å®š**ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã¯ã€æ§‹æˆãŒä¸é©åˆ‡ãªFirebaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ã—ã¦æ‚ªç”¨ã™ã‚‹ä¸€èˆ¬çš„ãªæ–¹æ³•ã§ã™ï¼š

1. **ã‚¢ãƒ—ãƒªã®APK**ã‚’å–å¾—ã—ã¾ã™ã€‚ã“ã®POCã§ã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰APKã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ãƒ„ãƒ¼ãƒ«ã®ã„ãšã‚Œã‹ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚\
â€œAPK Extractorâ€ã‚’ä½¿ç”¨ã§ãã¾ã™ [https://play.google.com/store/apps/details?id=com.ext.ui\&hl=e](https://hackerone.com/redirect?signature=3774f35d1b5ea8a4fd209d80084daa9f5887b105\&url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.ext.ui%26hl%3Den)
2. **apktool**ã‚’ä½¿ç”¨ã—ã¦APKã‚’**é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«**ã—ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã«å¾“ã£ã¦APKã‹ã‚‰ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
3. _**res/values/strings.xml**_ã«ç§»å‹•ã—ã€ã“ã“ã§â€œ**firebase**â€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’**æ¤œç´¢**ã—ã¾ã™ã€‚
4. æ¬¡ã®ã‚ˆã†ãªURLãŒè¦‹ã¤ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™: â€œ_**https://xyz.firebaseio.com/**_â€
5. æ¬¡ã«ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ç§»å‹•ã—ã¦ã€è¦‹ã¤ã‹ã£ãŸURLã«**ç§»å‹•ã—ã¾ã™**: _https://xyz.firebaseio.com/.json_
6. 2ç¨®é¡ã®å¿œç­”ãŒè¡¨ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š
1. â€œ**Permission Denied**â€: ã“ã‚Œã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã“ã¨ã‚’æ„å‘³ã—ã€é©åˆ‡ã«æ§‹æˆã•ã‚Œã¦ã„ã¾ã™
2. â€œ**null**â€å¿œç­”ã¾ãŸã¯ä¸€é€£ã®**JSONãƒ‡ãƒ¼ã‚¿**: ã“ã‚Œã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒå…¬é–‹ã•ã‚Œã¦ãŠã‚Šã€å°‘ãªãã¨ã‚‚èª­ã¿å–ã‚Šã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚
1. ã“ã®å ´åˆã€**æ›¸ãè¾¼ã¿æ¨©é™ã‚’ç¢ºèª**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ›¸ãè¾¼ã¿æ¨©é™ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã¯ã“ã¡ã‚‰ã«ã‚ã‚Šã¾ã™: [https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit](https://github.com/MuhammadKhizerJaved/Insecure-Firebase-Exploit)

**èˆˆå‘³æ·±ã„æ³¨è¨˜**: **MobSF**ã§ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ†æã™ã‚‹éš›ã«ã€Firebaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒ**å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹**ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€é€šçŸ¥ã—ã¾ã™ã€‚

ä»£æ›¿ã¨ã—ã¦ã€ä»¥ä¸‹ã«ç¤ºã™ã‚ˆã†ã«ä¸Šè¨˜ã®ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•åŒ–ã™ã‚‹Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚ã‚‹[Firebase Scanner](https://github.com/shivsahni/FireBaseScanner)ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
```bash
python FirebaseScanner.py -f <commaSeperatedFirebaseProjectNames>
```
### èªè¨¼æ¸ˆã¿åˆ—æŒ™

Firebaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®è³‡æ ¼æƒ…å ±ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€[**Baserunner**](https://github.com/iosiro/baserunner)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ä¿å­˜ã•ã‚ŒãŸæƒ…å ±ã«ã‚ˆã‚Šç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ã¾ãŸã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š
```python
#Taken from https://blog.assetnote.io/bug-bounty/2020/02/01/expanding-attack-surface-react-native/
import pyrebase

config = {
"apiKey": "FIREBASE_API_KEY",
"authDomain": "FIREBASE_AUTH_DOMAIN_ID.firebaseapp.com",
"databaseURL": "https://FIREBASE_AUTH_DOMAIN_ID.firebaseio.com",
"storageBucket": "FIREBASE_AUTH_DOMAIN_ID.appspot.com",
}

firebase = pyrebase.initialize_app(config)

db = firebase.database()

print(db.get())
```
### APPIDã¨APIã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ãŸã‚¢ã‚¯ã‚»ã‚¹æƒ…å ± <a href="#access-info-with-appid-and-api-key" id="access-info-with-appid-and-api-key"></a>

iOSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦`GoogleService-Info.plist`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¨ã€APIã‚­ãƒ¼ã¨APP IDãŒè¦‹ã¤ã‹ã‚Šã¾ã™ï¼š

* API KEY **AIzaSyAs1\[...]**
* APP ID **1:612345678909:ios:c212345678909876**

èˆˆå‘³æ·±ã„æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**

`curl -v -X POST "https://firebaseremoteconfig.googleapis.com/v1/projects/612345678909/namespaces/firebase:fetch?key=AIzaSyAs1[...]" -H "Content-Type: application/json" --data '{"appId": "1:612345678909:ios:c212345678909876", "appInstanceId": "PROD"}'`

## å‚è€ƒæ–‡çŒ® <a href="#references" id="references"></a>

* â€‹[https://blog.securitybreached.org/2020/02/04/exploiting-insecure-firebase-database-bugbounty/](https://blog.securitybreached.org/2020/02/04/exploiting-insecure-firebase-database-bugbounty/)â€‹
* â€‹[https://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1](https://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1)â€‹
