# GCP - Cloud Scheduler Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Informaci칩n B치sica

Google Cloud Scheduler es un **servicio de cron job** completamente gestionado que te permite ejecutar trabajos arbitrarios, como trabajos por lotes, trabajos de big data, operaciones de infraestructura en la nube, en momentos, fechas o intervalos fijos. Est치 integrado con los servicios de Google Cloud, proporcionando una forma de **automatizar varias tareas como actualizaciones o procesamiento por lotes en un horario regular**.

Aunque desde un punto de vista ofensivo esto suena incre칤ble, en realidad no es tan interesante porque el servicio solo permite programar ciertas acciones simples en un momento determinado y no ejecutar c칩digo arbitrario.

En el momento de escribir esto, estas son las acciones que este servicio permite programar:

<figure><img src="../../../.gitbook/assets/image (347).png" alt="" width="563"><figcaption></figcaption></figure>

* **HTTP**: Enviar una solicitud HTTP definiendo los encabezados y el cuerpo de la solicitud.
* **Pub/Sub**: Enviar un mensaje a un tema espec칤fico.
* **App Engine HTTP**: Enviar una solicitud HTTP a una aplicaci칩n construida en App Engine.
* **Workflows**: Llamar a un Workflow de GCP.

## Cuentas de Servicio

No siempre se requiere una cuenta de servicio para cada programador. Los tipos **Pub/Sub** y **App Engine HTTP** no requieren ninguna cuenta de servicio. El **Workflow** s칤 requiere una cuenta de servicio, pero solo invocar치 el flujo de trabajo.\
Finalmente, el tipo HTTP regular no requiere una cuenta de servicio, pero es posible indicar que se requiere alg칰n tipo de autenticaci칩n por el flujo de trabajo y agregar ya sea un **token de OAuth o un token de OIDC a la solicitud** HTTP enviada.

{% hint style="danger" %}
Por lo tanto, es posible robar el **token OIDC** y abusar del **token OAuth** de las cuentas de servicio **abusando del tipo HTTP**. M치s sobre esto en la p치gina de escalada de privilegios.
{% endhint %}

Ten en cuenta que es posible limitar el alcance del token de OAuth enviado, sin embargo, por defecto, ser치 `cloud-platform`.

## Enumeraci칩n
```bash
# Get schedulers in a location
gcloud scheduler jobs list --location us-central1

# Get information of an specific scheduler
gcloud scheduler jobs describe --location us-central1 <scheduler-name>
```
## Escalaci칩n de Privilegios

{% content-ref url="../gcp-privilege-escalation/gcp-cloudscheduler-privesc.md" %}
[gcp-cloudscheduler-privesc.md](../gcp-privilege-escalation/gcp-cloudscheduler-privesc.md)
{% endcontent-ref %}

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
