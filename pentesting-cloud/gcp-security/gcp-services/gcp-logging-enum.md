# GCP - Logging Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Î‘Ï…Ï„Î® Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Ï…Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Ï…Î½, Î½Î± Î±Î½Î±Î¶Î·Ï„Î¿ÏÎ½, Î½Î± Î±Î½Î±Î»ÏÎ¿Ï…Î½, Î½Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸Î¿ÏÎ½ ÎºÎ±Î¹ Î½Î± ÎµÎ¹Î´Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î³Î¹Î± **Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ Î³ÎµÎ³Î¿Î½ÏŒÏ„Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚** Î±Ï€ÏŒ Ï„Î¿ GCP.

Î¤Î¿ Cloud Logging ÎµÎ¯Î½Î±Î¹ Ï€Î»Î®ÏÏ‰Ï‚ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿ Î¼Îµ Î¬Î»Î»ÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ GCP, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± ÎºÎµÎ½Ï„ÏÎ¹ÎºÎ® Î±Ï€Î¿Î¸Î®ÎºÎ· Î³Î¹Î± Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Î±Ï€ÏŒ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ GCP ÏƒÎ±Ï‚. **Î£Ï…Î»Î»Î­Î³ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Î±Ï€ÏŒ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ GCP** ÏŒÏ€Ï‰Ï‚ Ï„Î¿ App Engine, Ï„Î¿ Compute Engine ÎºÎ±Î¹ Ï„Î¿ Cloud Functions. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ Cloud Logging Î³Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Ï„Î¿Ï€Î¹ÎºÎ¬ Î® ÏƒÎµ Î¬Î»Î»ÎµÏ‚ Ï…Ï€Î¿Î´Î¿Î¼Î­Ï‚ cloud Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿Î½ Ï€ÏÎ¬ÎºÏ„Î¿ÏÎ± Cloud Logging Î® Ï„Î¿ API.

Key Features:

* **ÎšÎµÎ½Ï„ÏÎ¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎšÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚:** Î£Ï…Î³ÎºÎµÎ½Ï„ÏÏÏƒÏ„Îµ Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Î±Ï€ÏŒ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï€Î·Î³Î­Ï‚, Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Î½Ï„Î±Ï‚ Î¼Î¹Î± Î¿Î»Î¹ÏƒÏ„Î¹ÎºÎ® ÎµÎ¹ÎºÏŒÎ½Î± Ï„Ï‰Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³ÏÎ½ ÎºÎ±Î¹ Ï„Î·Ï‚ Ï…Ï€Î¿Î´Î¿Î¼Î®Ï‚ ÏƒÎ±Ï‚.
* **Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· ÎšÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ ÏƒÎµ Î ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Î§ÏÏŒÎ½Î¿:** Î¡Î¿Î® ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ ÏƒÎµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï‡ÏÏŒÎ½Î¿ Î³Î¹Î± Î¬Î¼ÎµÏƒÎ· Î±Î½Î¬Î»Ï…ÏƒÎ· ÎºÎ±Î¹ Î±Î½Ï„Î¯Î´ÏÎ±ÏƒÎ·.
* **Î”Ï…Î½Î±Ï„Î® Î‘Î½Î¬Î»Ï…ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½:** Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï€ÏÎ¿Î·Î³Î¼Î­Î½ÎµÏ‚ Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„ÎµÏ‚ Ï†Î¹Î»Ï„ÏÎ±ÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚ ÎºÎ±Î¹ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Î³Î¹Î± Î½Î± Î´Î¹Î±Ï‡Ï‰ÏÎ¯ÏƒÎµÏ„Îµ Î¼ÎµÎ³Î¬Î»ÎµÏ‚ Ï€Î¿ÏƒÏŒÏ„Î·Ï„ÎµÏ‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ Î³ÏÎ®Î³Î¿ÏÎ±.
* **Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· Î¼Îµ BigQuery:** Î•Î¾Î¬Î³ÎµÏ„Îµ Î±ÏÏ‡ÎµÎ¯Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ ÏƒÏ„Î¿ BigQuery Î³Î¹Î± Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎ® Î±Î½Î¬Î»Ï…ÏƒÎ· ÎºÎ±Î¹ ÎµÏÏ‰Ï„Î®Î¼Î±Ï„Î±.
* **ÎœÎµÏ„ÏÎ¹ÎºÎ­Ï‚ Î’Î±ÏƒÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÎµ ÎšÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚:** Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ Î¼ÎµÏ„ÏÎ¹ÎºÎ­Ï‚ Î±Ï€ÏŒ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ ÏƒÎ±Ï‚ Î³Î¹Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· ÎºÎ±Î¹ ÎµÎ¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ·.

### Logs flow

<figure><img src="../../../.gitbook/assets/image (3) (1).png" alt=""><figcaption><p><a href="https://betterstack.com/community/guides/logging/gcp-logging/">https://betterstack.com/community/guides/logging/gcp-logging/</a></p></figcaption></figure>

Î’Î±ÏƒÎ¹ÎºÎ¬, Î¿Î¹ Î±Ï€Î¿Ï‡ÎµÏ„ÎµÏÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î¿Î¹ Î¼ÎµÏ„ÏÎ¹ÎºÎ­Ï‚ Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÎµ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚ Î¸Î± ÎºÎ±Î¸Î¿ÏÎ¯ÏƒÎ¿Ï…Î½ Ï€Î¿Ï Î¸Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ Î¼Î¹Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®.

### Configurations Supported by GCP Logging

Î¤Î¿ Cloud Logging ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï€Î±ÏÎ±Î¼ÎµÏ„ÏÎ¿Ï€Î¿Î¹Î®ÏƒÎ¹Î¼Î¿ Î³Î¹Î± Î½Î± ÎºÎ±Î»ÏÏˆÎµÎ¹ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ·ÏƒÎ¹Î±ÎºÎ­Ï‚ Î±Î½Î¬Î³ÎºÎµÏ‚:

1. **Log Buckets (Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ ÏƒÏ„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿):** ÎŸÏÎ¯ÏƒÏ„Îµ ÎºÎ¬Î´Î¿Ï…Ï‚ ÏƒÏ„Î¿ Cloud Logging Î³Î¹Î± Î½Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„ÎµÎ¯Ï„Îµ **Ï„Î· Î´Î¹Î±Ï„Î®ÏÎ·ÏƒÎ· ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½**, Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î­Î»ÎµÎ³Ï‡Î¿ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿ Ï€ÏŒÏƒÎ¿ ÎºÎ±Î¹ÏÏŒ Î´Î¹Î±Ï„Î·ÏÎ¿ÏÎ½Ï„Î±Î¹ Î¿Î¹ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ¯ÏƒÎµÎ¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ ÏƒÎ±Ï‚.
* Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Î¿Î¹ ÎºÎ¬Î´Î¿Î¹ `_Default` ÎºÎ±Î¹ `_Required` Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½Ï„Î±Î¹ (Î¿ Î­Î½Î±Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†ÎµÎ¹ ÏŒ,Ï„Î¹ Î´ÎµÎ½ ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†ÎµÎ¹ Î¿ Î¬Î»Î»Î¿Ï‚).
* **\_Required** ÎµÎ¯Î½Î±Î¹:

{% code overflow="wrap" %}
````
```bash
LOG_ID("cloudaudit.googleapis.com/activity") OR LOG_ID("externalaudit.googleapis.com/activity") OR LOG_ID("cloudaudit.googleapis.com/system_event") OR LOG_ID("externalaudit.googleapis.com/system_event") OR LOG_ID("cloudaudit.googleapis.com/access_transparency") OR LOG_ID("externalaudit.googleapis.com/access_transparency")
```

````
{% endcode %}

* **Î— Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚ Î´Î¹Î±Ï„Î®ÏÎ·ÏƒÎ·Ï‚** Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏÏ…Î¸Î¼Î¯Î¶ÎµÏ„Î±Î¹ Î±Î½Î¬ ÎºÎ¬Î´Î¿ ÎºÎ±Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ **Ï„Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ 1 Î·Î¼Î­ÏÎ±.** Î©ÏƒÏ„ÏŒÏƒÎ¿, Î· **Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚ Î´Î¹Î±Ï„Î®ÏÎ·ÏƒÎ·Ï‚ Ï„Î¿Ï… \_Required ÎµÎ¯Î½Î±Î¹ 400 Î·Î¼Î­ÏÎµÏ‚** ÎºÎ±Î¹ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯.
* Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¿Î¹ Log Buckets ÎµÎ¯Î½Î±Î¹ **Î¼Î· Î¿ÏÎ±Ï„Î¿Î¯ ÏƒÏ„Î¿ Cloud Storage.**

2. **Log Sinks (Î”ÏÎ¿Î¼Î¿Î»Î¿Î³Î·Ï„Î®Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ ÏƒÏ„Î¿ Î´Î¹Î±Î´Î¯ÎºÏ„Ï…Î¿):** Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ„Îµ sinks Î³Î¹Î± **ÎµÎ¾Î±Î³Ï‰Î³Î® ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½** ÏƒÎµ Î´Î¹Î¬Ï†Î¿ÏÎ¿Ï…Ï‚ Ï€ÏÎ¿Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ ÏŒÏ€Ï‰Ï‚ Pub/Sub, BigQuery Î® Cloud Storage Î¼Îµ Î²Î¬ÏƒÎ· Î­Î½Î± **Ï†Î¯Î»Ï„ÏÎ¿**.
* Î‘Ï€ÏŒ **Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®** Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½Ï„Î±Î¹ sinks Î³Î¹Î± Ï„Î¿Ï…Ï‚ ÎºÎ¬Î´Î¿Ï…Ï‚ `_Default` ÎºÎ±Î¹ `_Required`:
* ```bash
_Required  logging.googleapis.com/projects/<proj-name>/locations/global/buckets/_Required  LOG_ID("cloudaudit.googleapis.com/activity") OR LOG_ID("externalaudit.googleapis.com/activity") OR LOG_ID("cloudaudit.googleapis.com/system_event") OR LOG_ID("externalaudit.googleapis.com/system_event") OR LOG_ID("cloudaudit.googleapis.com/access_transparency") OR LOG_ID("externalaudit.googleapis.com/access_transparency")
_Default   logging.googleapis.com/projects/<proj-name>/locations/global/buckets/_Default   NOT LOG_ID("cloudaudit.googleapis.com/activity") AND NOT LOG_ID("externalaudit.googleapis.com/activity") AND NOT LOG_ID("cloudaudit.googleapis.com/system_event") AND NOT LOG_ID("externalaudit.googleapis.com/system_event") AND NOT LOG_ID("cloudaudit.googleapis.com/access_transparency") AND NOT LOG_ID("externalaudit.googleapis.com/access_transparency")
```
* **Î¦Î¯Î»Ï„ÏÎ± Î•Î¾Î±Î¯ÏÎµÏƒÎ·Ï‚:** Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· **ÎµÎ¾Î±Î¹ÏÎ­ÏƒÎµÏ‰Î½ Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï„ÏÎ±Ï€ÎµÎ¯ Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Ï‰Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½**, ÎµÎ¾Î¿Î¹ÎºÎ¿Î½Î¿Î¼ÏÎ½Ï„Î±Ï‚ ÎºÏŒÏƒÏ„Î¿Ï‚ ÎºÎ±Î¹ Î¼ÎµÎ¹ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ Ï€ÎµÏÎ¹Ï„Ï„ÏŒ Î¸ÏŒÏÏ…Î²Î¿.
3. **ÎœÎµÏ„ÏÎ¹ÎºÎ­Ï‚ Î²Î¬ÏƒÎµÎ¹ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½:** Î¡Ï…Î¸Î¼Î¯ÏƒÏ„Îµ **Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ Î¼ÎµÏ„ÏÎ¹ÎºÎ­Ï‚** Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Ï‰Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÎ¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½.
4. **Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½:** ÎŸÎ¹ Î±Î½Î±Ï†Î¿ÏÎ­Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ Ï€Î±ÏÎ­Ï‡Î¿Ï…Î½ Ï€ÏÎ¿Î·Î³Î¼Î­Î½Î¿ ÎºÎ±Î¹ **Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎ® Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Ï„Î¿ Ï€Î¿Î¹Î¿Ï‚ Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·** ÏƒÏ„Î¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚ ÎµÎ½Ï„ÏŒÏ‚ Ï„Ï‰Î½ ÎºÎ¬Î´Ï‰Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ ÏƒÎ±Ï‚.
* Î¤Î¿ Cloud Logging **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Ï„Î·Î½ Î±Î½Î±Ï†Î¿ÏÎ¬ `_AllLogs` Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ¬Î´Î¿**, Î· Î¿Ï€Î¿Î¯Î± Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚. Î¤Î¿ Cloud Logging Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¼Î¹Î± Î±Î½Î±Ï†Î¿ÏÎ¬ Î³Î¹Î± Ï„Î¿Î½ ÎºÎ¬Î´Î¿ `_Default` Ï€Î¿Ï… Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ `_Default`. Î— Î±Î½Î±Ï†Î¿ÏÎ¬ `_Default` Î³Î¹Î± Ï„Î¿Î½ ÎºÎ¬Î´Î¿ `_Default` Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚ ÎµÎºÏ„ÏŒÏ‚ Î±Ï€ÏŒ Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï… Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½. ÎŸÎ¹ Î±Î½Î±Ï†Î¿ÏÎ­Ï‚ `_AllLogs` ÎºÎ±Î¹ `_Default` Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎµÏ€ÎµÎ¾ÎµÏÎ³Î¬ÏƒÎ¹Î¼ÎµÏ‚.

Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î· Ï€Î±ÏÎ¿Ï‡Î® Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î¿Ï‚ ÏƒÎµ Î­Î½Î±Î½ ÎºÏÏÎ¹Î¿ **Î¼ÏŒÎ½Î¿ Î³Î¹Î± Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¼Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Î±Î½Î±Ï†Î¿ÏÎ¬ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½** Î¼Îµ Î¼Î¹Î± Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ® IAM ÏŒÏ€Ï‰Ï‚: 

{% code overflow="wrap" %}
```json
{
"bindings": [
{
"members": [
"user:username@gmail.com"
],
"role": "roles/logging.viewAccessor",
"condition": {
"title": "Bucket reader condition example",
"description": "Grants logging.viewAccessor role to user username@gmail.com for the VIEW_ID log view.",
"expression":
"resource.name == \"projects/PROJECT_ID/locations/LOCATION/buckets/BUCKET_NAME/views/VIEW_ID\""
}
}
],
"etag": "BwWd_6eERR4=",
"version": 3
}
```
{% endcode %}

### Default Logs

Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Î¿Î¹ **Admin Write** ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ (Î³Î½Ï‰ÏƒÏ„Î­Ï‚ ÎºÎ±Î¹ Ï‰Ï‚ Admin Activity audit logs) ÎµÎ¯Î½Î±Î¹ Î±Ï…Ï„Î­Ï‚ Ï€Î¿Ï… ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹ (Î³ÏÎ¬Ï†Î¿Ï…Î½ Î¼ÎµÏ„Î±Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î® Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚) ÎºÎ±Î¹ **Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½**.

Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î± **Data Access audit logs**, Î±Ï…Ï„Î¬ ÎµÎ¯Î½Î±Î¹ **Admin Read, Data Write ÎºÎ±Î¹ Data Write**.

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± ÎºÎ¬Î¸Îµ Ï„ÏÏ€Î¿ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ ÏƒÏ„Î± Î­Î³Î³ÏÎ±Ï†Î±: [https://cloud.google.com/iam/docs/audit-logging](https://cloud.google.com/iam/docs/audit-logging)

Î©ÏƒÏ„ÏŒÏƒÎ¿, ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Î¿Î¹ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ **`GetIamPolicy`** ÎºÎ±Î¹ Î¬Î»Î»ÎµÏ‚ Î±Î½Î±Î³Î½Ï‰ÏƒÏ„Î¹ÎºÎ­Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ **Î´ÎµÎ½ ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹**. ÎˆÏ„ÏƒÎ¹, Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÎ¹ Ï„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ Î´ÎµÎ½ Î¸Î± ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÏ„ÎµÎ¯ Î±Î½ Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹ Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½.

Î“Î¹Î± Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎµÏ‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚ ÏƒÏ„Î·Î½ ÎºÎ¿Î½ÏƒÏŒÎ»Î±, Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¼ÎµÏ„Î±Î²ÎµÎ¯ ÏƒÏ„Î¿ [https://console.cloud.google.com/iam-admin/audit](https://console.cloud.google.com/iam-admin/audit) ÎºÎ±Î¹ Î½Î± Ï„Î¹Ï‚ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹. Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ 2 Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚:

* **Default Configuration**: Î•Î¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„Î® Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î¼Î¹Î±Ï‚ Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î·Ï‚ Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ ÎºÎ±Î¹ Î· ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î® ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Admin Read ÎºÎ±Î¹/Î® Data Read ÎºÎ±Î¹/Î® Data Write logs ÎºÎ±Î¹ Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Î· Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎµÎ¾Î±Î¹ÏÎ¿ÏÎ¼ÎµÎ½Ï‰Î½ Ï€ÏÎ¿ÏƒÏÏ€Ï‰Î½:

<figure><img src="../../../.gitbook/assets/image (338).png" alt=""><figcaption></figcaption></figure>

* **Select the services**: Î‰ Î±Ï€Î»Î¬ **ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚** Ï€Î¿Ï… Î¸Î± Î¸Î­Î»Î±Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚ ÎºÎ±Î¹ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï„Ï‰Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ ÎºÎ±Î¹ Ï„Î¿ ÎµÎ¾Î±Î¹ÏÎ¿ÏÎ¼ÎµÎ½Î¿ Ï€ÏÏŒÏƒÏ‰Ï€Î¿ Î³Î¹Î± Î±Ï…Ï„Î®Î½ Ï„Î·Î½ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î±.

Î•Ï€Î¯ÏƒÎ·Ï‚, ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® Î¼ÏŒÎ½Î¿ Î±Ï…Ï„Î­Ï‚ Î¿Î¹ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ½Ï„Î±Î¹, ÎºÎ±Î¸ÏÏ‚ Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÏ‰Î½ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÏÎ½ Î¸Î± Î±Ï…Î¾Î®ÏƒÎµÎ¹ Ï„Î¿ ÎºÏŒÏƒÏ„Î¿Ï‚.

### Enumeration

Î¤Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ `gcloud` ÎµÎ¯Î½Î±Î¹ Î±Î½Î±Ï€ÏŒÏƒÏ€Î±ÏƒÏ„Î¿ Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… Î¿Î¹ÎºÎ¿ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ GCP, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î¬Ï‚ ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶ÎµÏƒÏ„Îµ Ï„Î¿Ï…Ï‚ Ï€ÏŒÏÎ¿Ï…Ï‚ ÎºÎ±Î¹ Ï„Î¹Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ ÏƒÎ±Ï‚. Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï€ÏÏ‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ `gcloud` Î³Î¹Î± Î½Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î®Ï‚ ÏƒÎ±Ï‚ ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î¹Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î­Ï‚. 

{% code overflow="wrap" %}
```bash
# List buckets
gcloud logging buckets list
gcloud logging buckets describe <bucket-name> --location <location>

# List log entries: only logs that contain log entries are listed.
gcloud logging logs list

# Get log metrics
gcloud logging metrics list
gcloud logging metrics describe <metric-name>

# Get log sinks
gcloud logging sinks list
gcloud logging sinks describe <sink-name>

# Get log views
gcloud logging views list --bucket <bucket> --location global
gcloud logging views describe --bucket <bucket> --location global <view-id> # view-id is usually the same as the bucket name

# Get log links
gcloud logging links list --bucket _Default --location global
gcloud logging links describe <link-id> --bucket _Default --location global
```
{% endcode %}

Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± logs Ï„Î¿Ï… **`cloudresourcemanager`** (Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± BF permissions): [https://console.cloud.google.com/logs/query;query=protoPayload.serviceName%3D%22cloudresourcemanager.googleapis.com%22;summaryFields=:false:32:beginning;cursorTimestamp=2024-01-20T00:07:14.482809Z;startTime=2024-01-01T11:12:26.062Z;endTime=2024-02-02T17:12:26.062Z?authuser=2\&project=digital-bonfire-410512](https://console.cloud.google.com/logs/query;query=protoPayload.serviceName%3D%22cloudresourcemanager.googleapis.com%22;summaryFields=:false:32:beginning;cursorTimestamp=2024-01-20T00:07:14.482809Z;startTime=2024-01-01T11:12:26.062Z;endTime=2024-02-02T17:12:26.062Z?authuser=2\&project=digital-bonfire-410512)

Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ logs Ï„Î¿Ï… **`testIamPermissions`**:

<figure><img src="../../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-logging-post-exploitation.md" %}
[gcp-logging-post-exploitation.md](../gcp-post-exploitation/gcp-logging-post-exploitation.md)
{% endcontent-ref %}

### Persistence

{% content-ref url="../gcp-persistence/gcp-logging-persistence.md" %}
[gcp-logging-persistence.md](../gcp-persistence/gcp-logging-persistence.md)
{% endcontent-ref %}

## References

* [https://cloud.google.com/logging/docs/logs-views#gcloud](https://cloud.google.com/logging/docs/logs-views#gcloud)
* [https://betterstack.com/community/guides/logging/gcp-logging/](https://betterstack.com/community/guides/logging/gcp-logging/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
