# GCP - Απαρίθμηση του Διαχειριστή Μυστικών

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο Hacking του AWS:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο Hacking του GCP: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστηρίξτε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε** 💬 [**στην ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Κοινοποιήστε κόλπα χάκινγκ υποβάλλοντας PRs** στα αποθετήρια [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## Διαχειριστής Μυστικών

Ο Google [**Διαχειριστής Μυστικών**](https://cloud.google.com/solutions/secrets-management/) είναι μια λύση παρόμοια με έναν θησαυρό για την αποθήκευση κωδικών πρόσβασης, κλειδιών API, πιστοποιητικών, αρχείων (έως 64KB) και άλλων ευαίσθητων δεδομένων.

Ένα μυστικό μπορεί να έχει **διαφορετικές εκδόσεις που αποθηκεύουν διαφορετικά δεδομένα**.

Τα μυστικά από προεπιλογή είναι **κρυπτογραφημένα χρησιμοποιώντας ένα κλειδί που διαχειρίζεται από τη Google**, αλλά είναι **δυνατόν να επιλεγεί ένα κλειδί από το KMS** για την κρυπτογράφηση του μυστικού.

Όσον αφορά τη **περιστροφή**, είναι δυνατόν να διαμορφωθούν **μηνύματα που θα σταλούν στο pub-sub κάθε αριθμό ημερών**, ο κώδικας που ακούει αυτά τα μηνύματα μπορεί να **περιστρέψει το μυστικό**.

Είναι δυνατόν να διαμορφωθεί μια ημέρα για τη **αυτόματη διαγραφή**, όταν η καθορισμένη ημέρα **επιτευχθεί**, το **μυστικό θα διαγραφεί αυτόματα**.

### Απαρίθμηση
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### Εscalation προνομίων

Στην ακόλουθη σελίδα μπορείτε να ελέγξετε πώς να **καταχραστείτε τα δικαιώματα του secretmanager για εξέλιξη προνομίων.**

{% content-ref url="../../gcp-security/gcp-privilege-escalation/gcp-secretmanager-privesc.md" %}
[gcp-secretmanager-privesc.md](../../gcp-security/gcp-privilege-escalation/gcp-secretmanager-privesc.md)
{% endcontent-ref %}

### Μετά από εκμετάλλευση

{% content-ref url="../../gcp-security/gcp-post-exploitation/gcp-secretmanager-post-exploitation.md" %}
[gcp-secretmanager-post-exploitation.md](../../gcp-security/gcp-post-exploitation/gcp-secretmanager-post-exploitation.md)
{% endcontent-ref %}

### Διατήρηση

{% content-ref url="../../gcp-security/gcp-persistence/gcp-secret-manager-persistence.md" %}
[gcp-secret-manager-persistence.md](../../gcp-security/gcp-persistence/gcp-secret-manager-persistence.md)
{% endcontent-ref %}

### Κατάχρηση περιστροφής

Ένας επιτιθέμενος θα μπορούσε να ενημερώσει το μυστικό για **διακοπή περιστροφών** (ώστε να μην τροποποιείται), ή να **κάνει περιστροφές πολύ λιγότερο συχνά** (ώστε το μυστικό να μην τροποποιείται) ή να **δημοσιεύσει το μήνυμα περιστροφής σε διαφορετικό pub/sub**, ή να τροποποιήσει τον κώδικα περιστροφής που εκτελείται (αυτό συμβαίνει σε διαφορετική υπηρεσία, πιθανότατα σε μια Cloud Function, έτσι ο επιτιθέμενος θα χρειαστεί προνομιακή πρόσβαση στη Cloud Function ή οποιαδήποτε άλλη υπηρεσία)
