# GCP - Secrets Manager Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Secret Manager

Google [**Secret Manager**](https://cloud.google.com/solutions/secrets-management/)는 비밀번호, API 키, 인증서, 파일(최대 64KB) 및 기타 민감한 데이터를 저장하기 위한 금고와 같은 솔루션입니다.

비밀은 **다른 데이터를 저장하는 서로 다른 버전**을 가질 수 있습니다.

비밀은 **기본적으로 Google 관리 키를 사용하여 암호화**되지만, 비밀을 암호화하는 데 사용할 **KMS에서 키를 선택하는 것이 가능합니다**.

**회전**과 관련하여, **몇 일마다 pub-sub에 전송될 메시지를 구성**할 수 있으며, 해당 메시지를 수신하는 코드는 **비밀을 회전**할 수 있습니다.

**자동 삭제**를 위한 날짜를 구성할 수 있으며, 지정된 날짜가 **도달하면**, **비밀이 자동으로 삭제됩니다**.

### Enumeration
```bash
# First, list the entries
gcloud secrets list
gcloud secrets get-iam-policy <secret_name>

# Then, pull the clear-text of any version of any secret
gcloud secrets versions list <secret_name>
gcloud secrets versions access 1 --secret="<secret_name>"
```
### 권한 상승

다음 페이지에서 **비밀 관리자 권한을 남용하여 권한을 상승시키는 방법**을 확인할 수 있습니다.

{% content-ref url="../gcp-privilege-escalation/gcp-secretmanager-privesc.md" %}
[gcp-secretmanager-privesc.md](../gcp-privilege-escalation/gcp-secretmanager-privesc.md)
{% endcontent-ref %}

### 포스트 익스플로잇

{% content-ref url="../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md" %}
[gcp-secretmanager-post-exploitation.md](../gcp-post-exploitation/gcp-secretmanager-post-exploitation.md)
{% endcontent-ref %}

### 지속성

{% content-ref url="../gcp-persistence/gcp-secret-manager-persistence.md" %}
[gcp-secret-manager-persistence.md](../gcp-persistence/gcp-secret-manager-persistence.md)
{% endcontent-ref %}

### 회전 남용

공격자는 비밀을 업데이트하여 **회전을 중지**시키거나(수정되지 않도록), **회전을 훨씬 덜 자주** 하도록(비밀이 수정되지 않도록) 하거나, **회전 메시지를 다른 pub/sub에 게시**하거나, 실행되는 회전 코드를 수정할 수 있습니다(이는 다른 서비스에서 발생하며, 아마도 Cloud Function에서 발생하므로 공격자는 Cloud Function 또는 다른 서비스에 대한 권한 있는 접근이 필요합니다).

{% hint style="success" %}
AWS 해킹 배우기 및 연습하기:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP 해킹 배우기 및 연습하기: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks 지원하기</summary>

* [**구독 계획**](https://github.com/sponsors/carlospolop) 확인하기!
* **💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 참여하거나 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**를 팔로우하세요.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) 깃허브 리포지토리에 PR을 제출하여 해킹 팁을 공유하세요.**

</details>
{% endhint %}
