# GCP - Filestore Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Google Cloud FilestoreëŠ” **íŒŒì¼ ì‹œìŠ¤í…œ ì¸í„°í˜ì´ìŠ¤ì™€ ë°ì´í„°ì— ëŒ€í•œ ê³µìœ  íŒŒì¼ ì‹œìŠ¤í…œ**ì´ í•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•´ ë§ì¶¤í™”ëœ **ê´€ë¦¬í˜• íŒŒì¼ ì €ì¥ ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” ë‹¤ì–‘í•œ GCP ì„œë¹„ìŠ¤ì™€ í†µí•©í•  ìˆ˜ ìˆëŠ” ê³ ì„±ëŠ¥ íŒŒì¼ ê³µìœ ë¥¼ ì œê³µí•˜ì—¬ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë°œíœ˜í•©ë‹ˆë‹¤. ì „í†µì ì¸ íŒŒì¼ ì‹œìŠ¤í…œ ì¸í„°í˜ì´ìŠ¤ì™€ ì˜ë¯¸ê°€ ì¤‘ìš”í•œ ë¯¸ë””ì–´ ì²˜ë¦¬, ì½˜í…ì¸  ê´€ë¦¬ ë° ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…ê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ìœ ìš©í•©ë‹ˆë‹¤.

ì´ê²ƒì€ ë‹¤ë¥¸ **NFS** **ê³µìœ  ë¬¸ì„œ ì €ì¥ì†Œ**ì™€ ê°™ë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ - ë¯¼ê°í•œ ì •ë³´ì˜ ì ì¬ì  ì¶œì²˜ì…ë‹ˆë‹¤.

### Connections

Filestore ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ **ì ‘ê·¼í•  ë„¤íŠ¸ì›Œí¬ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**.

ë˜í•œ, **ê¸°ë³¸ì ìœ¼ë¡œ ì„ íƒëœ VPC ë„¤íŠ¸ì›Œí¬ì™€ ì§€ì—­ì˜ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**, ê·¸ëŸ¬ë‚˜ **IP ì£¼ì†Œ** ë˜ëŠ” ë²”ìœ„ë¡œ ì ‘ê·¼ì„ **ì œí•œí•  ìˆ˜ ìˆìœ¼ë©°**, í´ë¼ì´ì–¸íŠ¸ê°€ **IP ì£¼ì†Œì— ë”°ë¼ ë°›ì„ ì ‘ê·¼ ê¶Œí•œ(ê´€ë¦¬ì, ê´€ë¦¬ì ë·°ì–´, í¸ì§‘ì, ë·°ì–´)**ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ **í”„ë¼ì´ë¹— ì„œë¹„ìŠ¤ ì ‘ê·¼ ì—°ê²°**ì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* VPC ë„¤íŠ¸ì›Œí¬ë³„ë¡œ ê´€ë¦¬ë˜ëŠ” ëª¨ë“  ì„œë¹„ìŠ¤(ì˜ˆ: Memorystore, Tensorflow ë° SQL)ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **VPC í”¼ì–´ë§ì„ ì‚¬ìš©í•˜ì—¬ Googleì´ ì†Œìœ í•œ ë„¤íŠ¸ì›Œí¬ì™€ ê·€í•˜ì˜ VPC ë„¤íŠ¸ì›Œí¬ ê°„ì—** ì´ë£¨ì–´ì§€ë©°, ê·€í•˜ì˜ ì¸ìŠ¤í„´ìŠ¤ì™€ ì„œë¹„ìŠ¤ê°€ **ë‚´ë¶€ IP ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ë…ì ì ìœ¼ë¡œ í†µì‹ í•  ìˆ˜ ìˆë„ë¡** í•©ë‹ˆë‹¤.
* ì„œë¹„ìŠ¤ ì œê³µì ì¸¡ì—ì„œ ê·€í•˜ë¥¼ ìœ„í•œ ê²©ë¦¬ëœ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ë‹¤ë¥¸ ê³ ê°ê³¼ ê³µìœ ë˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤. ê·€í•˜ëŠ” í”„ë¡œë¹„ì €ë‹í•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ì„œë§Œ ìš”ê¸ˆì´ ì²­êµ¬ë©ë‹ˆë‹¤.
* VPC í”¼ì–´ë§ì€ ê·€í•˜ì˜ VPCì— ìƒˆë¡œìš´ ê²½ë¡œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

### Backups

**íŒŒì¼ ê³µìœ ì˜ ë°±ì—…ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ì´ëŸ¬í•œ ë°±ì—…ì€ ë‚˜ì¤‘ì— **ì›ë³¸** ìƒˆë¡œìš´ íŒŒì¼ ê³µìœ  ì¸ìŠ¤í„´ìŠ¤ ë˜ëŠ” **ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤**ì— ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Encryption

ê¸°ë³¸ì ìœ¼ë¡œ **Google ê´€ë¦¬í˜• ì•”í˜¸í™” í‚¤**ê°€ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•˜ëŠ” ë° ì‚¬ìš©ë˜ì§€ë§Œ, **ê³ ê° ê´€ë¦¬í˜• ì•”í˜¸í™” í‚¤(CMEK)**ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Enumeration

í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ filestoreë¥¼ ì°¾ìœ¼ë©´, ì†ìƒëœ Compute Instance ë‚´ì—ì„œ **ë§ˆìš´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
filestore ì„œë¹„ìŠ¤ëŠ” **ì™„ì „íˆ ìƒˆë¡œìš´ ì„œë¸Œë„¤íŠ¸ì›Œí¬**ì— ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (Private Service Access Connection ë‚´ì—ì„œ, ì´ëŠ” **VPC í”¼ì–´**ì…ë‹ˆë‹¤).\
ë”°ë¼ì„œ **VPC í”¼ì–´ë¥¼ ì—´ê±°**í•˜ì—¬ í•´ë‹¹ ë„¤íŠ¸ì›Œí¬ ë²”ìœ„ì—ì„œ nmapì„ ì‹¤í–‰í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### ê¶Œí•œ ìƒìŠ¹ ë° ì‚¬í›„ í™œìš©

GCPì—ì„œ ì´ ì„œë¹„ìŠ¤ë¥¼ ì§ì ‘ ì•…ìš©í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¤ëŠ” ë°©ë²•ì€ ì—†ì§€ë§Œ, ì¼ë¶€ **ì‚¬í›„ í™œìš© ê¸°ë²•ì„ ì‚¬ìš©í•˜ë©´ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ê·¸ë¦¬ê³  ì•„ë§ˆë„ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¤ê¸° ìœ„í•œ ìê²© ì¦ëª…ì„ ì°¾ì„ ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### ì§€ì†ì„±

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ ê¸°ë²•ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
