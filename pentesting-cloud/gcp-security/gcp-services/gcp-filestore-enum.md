# GCP - Filestore Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Temel Bilgiler

Google Cloud Filestore, **dosya sistemi arayüzü ve veri için paylaşılan bir dosya sistemi** ihtiyacı olan uygulamalar için özel olarak tasarlanmış bir **yönetilen dosya depolama hizmetidir**. Bu hizmet, çeşitli GCP hizmetleriyle entegre edilebilen yüksek performanslı dosya paylaşımları sunarak öne çıkar. Geleneksel dosya sistemi arayüzlerinin ve anlamlarının kritik olduğu medya işleme, içerik yönetimi ve veritabanlarının yedeklenmesi gibi senaryolarda faydası belirgindir.

Bunu, herhangi bir **NFS** **paylaşılan belge deposu** gibi düşünebilirsiniz - hassas bilgi kaynağı olma potansiyeline sahip.

### Bağlantılar

Bir Filestore örneği oluştururken, **erişilebilir olacağı ağı seçmek mümkündür**.

Ayrıca, **varsayılan olarak seçilen VPC ağı ve bölgedeki tüm istemcilerin buna erişebilmesi sağlanır**, ancak erişimi **IP adresi** veya aralığı ile **kısıtlamak da mümkündür** ve istemcinin alacağı erişim ayrıcalığını (Admin, Admin Viewer, Editor, Viewer) IP adresine bağlı olarak belirtebilirsiniz.

Ayrıca, **Özel Hizmet Erişim Bağlantısı** aracılığıyla erişilebilir:

* VPC ağı başına olup, Memorystore, Tensorflow ve SQL gibi tüm yönetilen hizmetler arasında kullanılabilir.
* **VPC peering kullanarak Google'a ait bir ağ ile VPC ağınız arasında** olup, örneklerinizin ve hizmetlerinizin yalnızca **iç IP adreslerini kullanarak** iletişim kurmasını sağlar.
* Hizmet üretici tarafında sizin için izole bir proje oluşturur, yani başka müşterilerin paylaşmadığı bir alan. Sadece sağladığınız kaynaklar için faturalandırılacaksınız.
* VPC peering, VPC'nize yeni yollar ekleyecektir.

### Yedeklemeler

**Dosya paylaşımlarının yedeklerini oluşturmak mümkündür**. Bunlar daha sonra **orijinal** yeni Fileshare örneğine veya **yeni olanlara** **geri yüklenebilir**.

### Şifreleme

Varsayılan olarak, verileri şifrelemek için **Google tarafından yönetilen bir şifreleme anahtarı** kullanılacaktır, ancak **Müşteri tarafından yönetilen bir şifreleme anahtarı (CMEK)** seçmek de mümkündür.

### Sayım

Projede mevcut bir filestore bulursanız, **onu** ele geçirilmiş Compute Instance'ınızdan **bağlayabilirsiniz**. Herhangi birinin var olup olmadığını görmek için aşağıdaki komutu kullanın.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Bir filestore hizmetinin **tamamen yeni bir alt ağda** olabileceğini unutmayın (bir Özel Hizmet Erişim Bağlantısı içinde, bu bir **VPC eşidir**).\
Bu nedenle, bu ağ aralıkları üzerinde nmap çalıştırmak için **VPC eşlerini** de **numaralandırmanız** gerekebilir.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### Yetki Yükseltme & Sonrası İstismar

GCP'de bu hizmeti doğrudan kötüye kullanarak yetki yükseltmenin yolları yoktur, ancak bazı **Sonrası İstismar hileleri ile verilere erişmek mümkündür** ve belki de yetki yükseltmek için bazı kimlik bilgileri bulabilirsiniz:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Süreklilik

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* **Hacking hilelerini paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
