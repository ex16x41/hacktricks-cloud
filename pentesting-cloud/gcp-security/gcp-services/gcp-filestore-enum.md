# GCP - Filestore Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Google Cloud Filestore is a **bestuurde lÃªeropbergingsdiens** wat ontwerp is vir toepassings wat 'n **lÃªerstelselinterface en 'n gedeelde lÃªerstelsel vir data** benodig. Hierdie diens presteer uitstekend deur hoÃ«-prestasie lÃªerdeelings aan te bied, wat geÃ¯ntegreer kan word met verskeie GCP-dienste. Die nut daarvan skyn in scenario's waar tradisionele lÃªerstelselinterfaces en semantiek van kardinale belang is, soos in media verwerking, inhoudsbestuur, en die rugsteun van databasisse.

Jy kan dit beskou as enige ander **NFS** **gedeelde dokumentrepositori -** 'n potensiÃ«le bron van sensitiewe inligting.

### Connections

Wanneer jy 'n Filestore-instantie skep, is dit moontlik om die **netwerk te kies waar dit toeganklik gaan wees**.

Boonop, **per standaard gaan alle kliÃ«nte op die geselekteerde VPC-netwerk en streek toegang hÃª**, egter, dit is moontlik om die toegang ook te **beperk deur IP-adres** of reeks en die toegang regte (Admin, Admin Viewer, Editor, Viewer) aan te dui wat die kliÃ«nt gaan kry **afhangende van die IP-adres.**

Dit kan ook toeganklik wees via 'n **Privaat Diens Toegang Verbinding:**

* Is per VPC-netwerk en kan gebruik word oor alle bestuurde dienste soos Memorystore, Tensorflow en SQL.
* Is **tussen jou VPC-netwerk en 'n netwerk wat aan Google behoort deur 'n VPC-peering**, wat jou instansies en dienste in staat stel om eksklusief te kommunikeer deur **interne IP-adresse** te gebruik.
* Skep 'n geÃ¯soleerde projek vir jou aan die diens-producer kant, wat beteken dat geen ander kliÃ«nte dit deel nie. Jy sal slegs vir die hulpbronne wat jy voorsien, gefaktureer word.
* Die VPC-peering sal nuwe roetes na jou VPC invoer.

### Backups

Dit is moontlik om **rugsteun van die lÃªerdeelings** te skep. Hierdie kan later **herstel word in die oorsprong** nuwe LÃªerdeelings-instantie of in **nuwe**.

### Encryption

Per standaard sal 'n **Google-bestuurde versleuteling sleutel** gebruik word om die data te versleutel, maar dit is moontlik om 'n **KliÃ«nt-bestuurde versleuteling sleutel (CMEK)** te kies.

### Enumeration

As jy 'n filestore in die projek beskikbaar vind, kan jy dit **monteer** vanuit jou gecompromitteerde Compute Instance. Gebruik die volgende opdrag om te sien of enige bestaan. 

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
Let daarop dat 'n filestore-diens dalk in 'n **heeltemal nuwe subnetwerk geskep vir dit** (binne 'n Private Service Access Connection, wat 'n **VPC-peer** is).\
So jy mag dalk moet **VPC-peers opnoem** om ook nmap oor daardie netwerkreekse te laat loop.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### Privilege Escalation & Post Exploitation

Daar is nie maniere om voorregte in GCP direk te verhoog deur hierdie diens te misbruik nie, maar deur sommige **Post Exploitation truuks is dit moontlik om toegang tot die data te verkry** en dalk kan jy 'n paar akrediteerbare inligting vind om voorregte te verhoog:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### Persistence

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
