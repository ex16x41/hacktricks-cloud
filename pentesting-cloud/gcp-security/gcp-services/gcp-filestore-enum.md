# GCP - Filestore Enum

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **HackTricks** ë° **HackTricks Cloud** ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ ìš”ë ¹ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}

## ê¸°ë³¸ ì •ë³´

Google Cloud FilestoreëŠ” **íŒŒì¼ ì‹œìŠ¤í…œ ì¸í„°í˜ì´ìŠ¤ì™€ ë°ì´í„°ë¥¼ ìœ„í•œ ê³µìœ  íŒŒì¼ ì‹œìŠ¤í…œì´ í•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ** **ê´€ë¦¬í˜• íŒŒì¼ ì €ì¥ì†Œ ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” ê³ ì„±ëŠ¥ íŒŒì¼ ê³µìœ ë¥¼ ì œê³µí•˜ì—¬ ë‹¤ì–‘í•œ GCP ì„œë¹„ìŠ¤ì™€ í†µí•©ë  ìˆ˜ ìˆì–´ì„œ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë°œíœ˜í•©ë‹ˆë‹¤. ì „í†µì ì¸ íŒŒì¼ ì‹œìŠ¤í…œ ì¸í„°í˜ì´ìŠ¤ì™€ ì˜ë¯¸ë¡ ì´ ì¤‘ìš”í•œ ë¯¸ë””ì–´ ì²˜ë¦¬, ì½˜í…ì¸  ê´€ë¦¬ ë° ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…ê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ìœ ìš©í•©ë‹ˆë‹¤.

ì´ê²ƒì€ ë‹¤ë¥¸ **NFS ê³µìœ  ë¬¸ì„œ ì €ì¥ì†Œì™€ ê°™ì´** ë¯¼ê°í•œ ì •ë³´ì˜ ì ì¬ì ì¸ ì¶œì²˜ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì—°ê²°

Filestore ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ **ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ ì„ íƒ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë˜í•œ, **ê¸°ë³¸ì ìœ¼ë¡œ ì„ íƒí•œ VPC ë„¤íŠ¸ì›Œí¬ ë° ì§€ì—­ì˜ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ê°€ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆì§€ë§Œ**, **IP ì£¼ì†Œ ë˜ëŠ” ë²”ìœ„ì— ë”°ë¼ ì•¡ì„¸ìŠ¤ ê¶Œí•œ(ê´€ë¦¬ì, ê´€ë¦¬ì ë·°ì–´, í¸ì§‘ì, ë·°ì–´)ì„ ì§€ì •í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ê°€ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

ë˜í•œ **ê°œì¸ ì„œë¹„ìŠ¤ ì•¡ì„¸ìŠ¤ ì—°ê²°ì„ í†µí•´ ì•¡ì„¸ìŠ¤**í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

* VPC ë„¤íŠ¸ì›Œí¬ ë‹¹ í•˜ë‚˜ì”© ìˆìœ¼ë©° Memorystore, Tensorflow ë° SQLê³¼ ê°™ì€ ëª¨ë“  ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **VPC í”¼ì–´ë§ì„ ì‚¬ìš©í•˜ì—¬ êµ¬ê¸€ì´ ì†Œìœ í•œ ë„¤íŠ¸ì›Œí¬ì™€ ë‹¹ì‹ ì˜ VPC ë„¤íŠ¸ì›Œí¬ ì‚¬ì´ì— ì—°ê²°**ì„ ë§Œë“¤ì–´ ë‚´ë¶€ IP ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ ë° ì„œë¹„ìŠ¤ê°€ **ë…ì ì ìœ¼ë¡œ í†µì‹ **í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
* ì„œë¹„ìŠ¤ ìƒì‚°ì ì¸¡ì— ë‹¹ì‹ ì„ ìœ„í•œ ê²©ë¦¬ëœ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ë‹¤ë¥¸ ê³ ê°ì´ ê³µìœ í•˜ì§€ ì•ŠìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì œê³µí•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ì„œë§Œ ì²­êµ¬ë©ë‹ˆë‹¤.
* VPC í”¼ì–´ë§ì€ ìƒˆ ê²½ë¡œë¥¼ ë‹¹ì‹ ì˜ VPCë¡œ ê°€ì ¸ì˜¬ ê²ƒì…ë‹ˆë‹¤.

### ë°±ì—…

File ê³µìœ ì˜ **ë°±ì—…ì„ ìƒì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë°±ì—…ì€ ë‚˜ì¤‘ì— **ì›ë³¸** ìƒˆ Fileshare ì¸ìŠ¤í„´ìŠ¤ë‚˜ **ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤**ì— **ë³µì›**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì•”í˜¸í™”

ê¸°ë³¸ì ìœ¼ë¡œ **Google ê´€ë¦¬í˜• ì•”í˜¸í™” í‚¤**ê°€ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•˜ëŠ” ë° ì‚¬ìš©ë˜ì§€ë§Œ **ê³ ê° ê´€ë¦¬í˜• ì•”í˜¸í™” í‚¤(CMEK)**ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì—´ê±°

í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ filestoreë¥¼ ì°¾ìœ¼ë©´ **Compromised Compute Instance ë‚´ì—ì„œ** ë§ˆìš´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

{% code overflow="wrap" %}
```bash
# Instances
gcloud filestore instances list # Check the IP address
gcloud filestore instances describe --zone <zone> <name> # Check IP and access restrictions

# Backups
gcloud filestore backups list
gcloud filestore backups describe --region <region> <backup>

# Search for NFS shares in a VPC subnet
sudo nmap -n -T5 -Pn -p 2049 --min-parallelism 100 --min-rate 1000 --open 10.99.160.2/20
```
{% endcode %}

{% hint style="danger" %}
íŒŒì¼ ì €ì¥ì†Œ ì„œë¹„ìŠ¤ê°€ **ì „ìš© ì„œë¹„ìŠ¤ ì•¡ì„¸ìŠ¤ ì—°ê²° ë‚´ì—ì„œ ìƒì„±ëœ ì™„ì „íˆ ìƒˆë¡œìš´ í•˜ìœ„ ë„¤íŠ¸ì›Œí¬**ì— ìˆì„ ìˆ˜ ìˆë‹¤ëŠ” ì ì— ìœ ì˜í•˜ì‹­ì‹œì˜¤(ì´ëŠ” **VPC í”¼ì–´**ì…ë‹ˆë‹¤).\
ë”°ë¼ì„œ **VPC í”¼ì–´ë¥¼ ì—´ê±°**í•˜ì—¬ í•´ë‹¹ ë„¤íŠ¸ì›Œí¬ ë²”ìœ„ì— ëŒ€í•´ nmapì„ ì‹¤í–‰í•´ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

{% code overflow="wrap" %}
```bash
# Get peerings
gcloud compute networks peerings list
# Get routes imported from a peering
gcloud compute networks peerings list-routes <peering-name> --network=<network-name> --region=<region> --direction=INCOMING
```
{% endcode %}
{% endhint %}

### ê¶Œí•œ ìƒìŠ¹ ë° í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì‡ë ˆì´ì…˜

GCPì—ì„œëŠ” ì´ ì„œë¹„ìŠ¤ë¥¼ ì§ì ‘ ì•…ìš©í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¤ëŠ” ë°©ë²•ì€ ì—†ì§€ë§Œ, ì¼ë¶€ **í¬ìŠ¤íŠ¸ ìµìŠ¤í”Œë¡œì‡ë ˆì´ì…˜ íŠ¸ë¦­ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì— ì•¡ì„¸ìŠ¤**í•  ìˆ˜ ìˆìœ¼ë©° ê¶Œí•œ ìƒìŠ¹ì„ ìœ„í•œ ì¼ë¶€ ìê²© ì¦ëª…ì„ ì°¾ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../gcp-post-exploitation/gcp-filestore-post-exploitation.md" %}
[gcp-filestore-post-exploitation.md](../gcp-post-exploitation/gcp-filestore-post-exploitation.md)
{% endcontent-ref %}

### ì§€ì†ì„±

{% content-ref url="../gcp-persistence/gcp-filestore-persistence.md" %}
[gcp-filestore-persistence.md](../gcp-persistence/gcp-filestore-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP í•´í‚¹ í•™ìŠµ ë° ì‹¤ìŠµ: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›</summary>

* [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!
* ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—™ ë ˆí¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.

</details>
{% endhint %}
