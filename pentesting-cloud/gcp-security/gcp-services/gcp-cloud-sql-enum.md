# GCP - Cloud SQL Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Google Cloud SQL est un service g√©r√© qui **simplifie la configuration, la maintenance et l'administration des bases de donn√©es relationnelles** comme MySQL, PostgreSQL et SQL Server sur Google Cloud Platform, √©liminant ainsi le besoin de g√©rer des t√¢ches telles que la fourniture de mat√©riel, la configuration de la base de donn√©es, les mises √† jour et les sauvegardes.

Les principales caract√©ristiques de Google Cloud SQL incluent :

1. **Enti√®rement g√©r√©** : Google Cloud SQL est un service enti√®rement g√©r√©, ce qui signifie que Google s'occupe des t√¢ches de maintenance de la base de donn√©es telles que les mises √† jour, les sauvegardes et la configuration.
2. **Scalabilit√©** : Il offre la possibilit√© d'augmenter la capacit√© de stockage et les ressources de calcul de votre base de donn√©es, souvent sans temps d'arr√™t.
3. **Haute disponibilit√©** : Propose des configurations de haute disponibilit√©, garantissant que vos services de base de donn√©es sont fiables et peuvent r√©sister √† des pannes de zone ou d'instance.
4. **S√©curit√©** : Fournit des fonctionnalit√©s de s√©curit√© robustes telles que le chiffrement des donn√©es, les contr√¥les d'Identity and Access Management (IAM) et l'isolement r√©seau √† l'aide d'IP priv√©es et de VPC.
5. **Sauvegardes et r√©cup√©ration** : Prend en charge les sauvegardes automatiques et la r√©cup√©ration √† un moment donn√©, vous aidant √† prot√©ger et √† restaurer vos donn√©es.
6. **Int√©gration** : S'int√®gre parfaitement avec d'autres services Google Cloud, offrant une solution compl√®te pour la cr√©ation, le d√©ploiement et la gestion d'applications.
7. **Performance** : Offre des m√©triques de performance et des diagnostics pour surveiller, d√©panner et am√©liorer les performances de la base de donn√©es.

### Password

Dans la console web, Cloud SQL permet √† l'utilisateur de **d√©finir** le **mot de passe** de la base de donn√©es, il existe √©galement une fonction de g√©n√©ration, mais surtout, **MySQL** permet de **laisser un mot de passe vide et tous permettent de d√©finir comme mot de passe juste le caract√®re "a" :**

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

Il est √©galement possible de configurer une politique de mot de passe exigeant **longueur**, **complexit√©**, **d√©sactivation de la r√©utilisation** et **d√©sactivation du nom d'utilisateur dans le mot de passe**. Tous sont d√©sactiv√©s par d√©faut.

**SQL Server** peut √™tre configur√© avec **l'authentification Active Directory**.

### Zone Availability

La base de donn√©es peut √™tre **disponible dans 1 zone ou dans plusieurs**, bien s√ªr, il est recommand√© d'avoir des bases de donn√©es importantes dans plusieurs zones.

### Encryption

Par d√©faut, une cl√© de chiffrement g√©r√©e par Google est utilis√©e, mais il est √©galement **possible de s√©lectionner une cl√© de chiffrement g√©r√©e par le client (CMEK)**.

### Connections

* **IP priv√©e** : Indiquez le r√©seau VPC et la base de donn√©es obtiendra une IP priv√©e √† l'int√©rieur du r√©seau
* **IP publique** : La base de donn√©es obtiendra une IP publique, mais par d√©faut, personne ne pourra se connecter
* **R√©seaux autoris√©s** : Indiquez les **plages d'IP publiques qui devraient √™tre autoris√©es** √† se connecter √† la base de donn√©es
* **Chemin priv√©** : Si la DB est connect√©e dans un VPC, il est possible d'activer cette option et de donner **acc√®s √† d'autres services GCP comme BigQuery**

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### Data Protection

* **Sauvegardes quotidiennes** : Effectuez des sauvegardes automatiques quotidiennes et indiquez le nombre de sauvegardes que vous souhaitez maintenir.
* **R√©cup√©ration √† un moment donn√©** : Vous permet de r√©cup√©rer des donn√©es √† partir d'un moment sp√©cifique, jusqu'√† une fraction de seconde.
* **Protection contre la suppression** : Si activ√©e, la DB ne pourra pas √™tre supprim√©e tant que cette fonctionnalit√© n'est pas d√©sactiv√©e.

### Enumeration
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### Enum non authentifi√©

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### Post exploitation

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### Persistance

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Formation Expert Red Team AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Formation Expert Red Team GCP (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
