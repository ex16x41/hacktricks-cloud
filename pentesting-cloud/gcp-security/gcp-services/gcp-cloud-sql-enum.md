# GCP - Cloud SQL Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Informazioni di base

Google Cloud SQL √® un servizio gestito che **semplifica la configurazione, la manutenzione e l'amministrazione di database relazionali** come MySQL, PostgreSQL e SQL Server su Google Cloud Platform, eliminando la necessit√† di gestire attivit√† come la fornitura dell'hardware, la configurazione del database, le patch e i backup.

Le caratteristiche principali di Google Cloud SQL includono:

1. **Completamente gestito**: Google Cloud SQL √® un servizio completamente gestito, il che significa che Google si occupa delle attivit√† di manutenzione del database come patching, aggiornamenti, backup e configurazione.
2. **Scalabilit√†**: Fornisce la possibilit√† di scalare la capacit√† di archiviazione e le risorse di calcolo del tuo database, spesso senza tempi di inattivit√†.
3. **Alta disponibilit√†**: Offre configurazioni ad alta disponibilit√†, garantendo che i servizi del tuo database siano affidabili e possano resistere a guasti di zona o di istanza.
4. **Sicurezza**: Fornisce robuste funzionalit√† di sicurezza come la crittografia dei dati, i controlli di Identity and Access Management (IAM) e l'isolamento della rete utilizzando IP privati e VPC.
5. **Backup e recupero**: Supporta backup automatici e recupero a un punto nel tempo, aiutandoti a proteggere e ripristinare i tuoi dati.
6. **Integrazione**: Si integra perfettamente con altri servizi Google Cloud, fornendo una soluzione completa per costruire, distribuire e gestire applicazioni.
7. **Prestazioni**: Offre metriche di prestazione e diagnostica per monitorare, risolvere problemi e migliorare le prestazioni del database.

### Password

Nella console web, Cloud SQL consente all'utente di **impostare** la **password** del database, c'√® anche una funzione di generazione, ma soprattutto, **MySQL** consente di **lasciare una password vuota e tutti consentono di impostare come password solo il carattere "a":**

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

√à anche possibile configurare una politica delle password che richiede **lunghezza**, **complessit√†**, **disabilitazione del riutilizzo** e **disabilitazione del nome utente nella password**. Tutti sono disabilitati per impostazione predefinita.

**SQL Server** pu√≤ essere configurato con **Autenticazione di Active Directory**.

### Disponibilit√† della zona

Il database pu√≤ essere **disponibile in 1 zona o in pi√π**, ovviamente, √® consigliato avere database importanti in pi√π zone.

### Crittografia

Per impostazione predefinita viene utilizzata una chiave di crittografia gestita da Google, ma √® anche **possibile selezionare una chiave di crittografia gestita dal cliente (CMEK)**.

### Connessioni

* **IP privato**: Indica la rete VPC e il database otterr√† un IP privato all'interno della rete
* **IP pubblico**: Il database otterr√† un IP pubblico, ma per impostazione predefinita nessuno potr√† connettersi
* **Reti autorizzate**: Indica gli **intervalli di IP pubblici che dovrebbero essere autorizzati** a connettersi al database
* **Percorso privato**: Se il DB √® connesso a qualche VPC, √® possibile abilitare questa opzione e dare **ad altri servizi GCP come BigQuery accesso su di esso**

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### Protezione dei dati

* **Backup giornalieri**: Esegui backup automatici giornalieri e indica il numero di backup che desideri mantenere.
* **Recupero a un punto nel tempo**: Ti consente di recuperare dati da un punto specifico nel tempo, fino a una frazione di secondo.
* **Protezione dalla cancellazione**: Se abilitata, il DB non potr√† essere cancellato fino a quando questa funzione non sar√† disabilitata.

### Enumerazione
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### Enum non autenticato

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### Persistenza

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Impara e pratica AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Impara e pratica GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supporta HackTricks</summary>

* Controlla i [**piani di abbonamento**](https://github.com/sponsors/carlospolop)!
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Condividi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos su github.

</details>
{% endhint %}
