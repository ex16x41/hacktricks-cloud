# GCP - Cloud SQL Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Google Cloud SQL æ˜¯ä¸€ä¸ªæ‰˜ç®¡æœåŠ¡ï¼Œ**ç®€åŒ–äº†åœ¨ Google Cloud Platform ä¸Šè®¾ç½®ã€ç»´æŠ¤å’Œç®¡ç†å…³ç³»æ•°æ®åº“**ï¼ˆå¦‚ MySQLã€PostgreSQL å’Œ SQL Serverï¼‰çš„è¿‡ç¨‹ï¼Œæ¶ˆé™¤äº†å¤„ç†ç¡¬ä»¶é…ç½®ã€æ•°æ®åº“è®¾ç½®ã€æ‰“è¡¥ä¸å’Œå¤‡ä»½ç­‰ä»»åŠ¡çš„éœ€è¦ã€‚

Google Cloud SQL çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š

1. **å®Œå…¨æ‰˜ç®¡**ï¼šGoogle Cloud SQL æ˜¯ä¸€ä¸ªå®Œå…¨æ‰˜ç®¡çš„æœåŠ¡ï¼Œè¿™æ„å‘³ç€ Google å¤„ç†æ•°æ®åº“ç»´æŠ¤ä»»åŠ¡ï¼Œå¦‚æ‰“è¡¥ä¸ã€æ›´æ–°ã€å¤‡ä»½å’Œé…ç½®ã€‚
2. **å¯æ‰©å±•æ€§**ï¼šå®ƒæä¾›äº†æ‰©å±•æ•°æ®åº“å­˜å‚¨å®¹é‡å’Œè®¡ç®—èµ„æºçš„èƒ½åŠ›ï¼Œé€šå¸¸æ— éœ€åœæœºã€‚
3. **é«˜å¯ç”¨æ€§**ï¼šæä¾›é«˜å¯ç”¨æ€§é…ç½®ï¼Œç¡®ä¿æ‚¨çš„æ•°æ®åº“æœåŠ¡å¯é ï¼Œå¹¶èƒ½æ‰¿å—åŒºåŸŸæˆ–å®ä¾‹æ•…éšœã€‚
4. **å®‰å…¨æ€§**ï¼šæä¾›å¼ºå¤§çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æ•°æ®åŠ å¯†ã€èº«ä»½å’Œè®¿é—®ç®¡ç†ï¼ˆIAMï¼‰æ§åˆ¶ï¼Œä»¥åŠä½¿ç”¨ç§æœ‰ IP å’Œ VPC çš„ç½‘ç»œéš”ç¦»ã€‚
5. **å¤‡ä»½å’Œæ¢å¤**ï¼šæ”¯æŒè‡ªåŠ¨å¤‡ä»½å’Œæ—¶é—´ç‚¹æ¢å¤ï¼Œå¸®åŠ©æ‚¨ä¿æŠ¤å’Œæ¢å¤æ•°æ®ã€‚
6. **é›†æˆ**ï¼šä¸å…¶ä»– Google Cloud æœåŠ¡æ— ç¼é›†æˆï¼Œæä¾›æ„å»ºã€éƒ¨ç½²å’Œç®¡ç†åº”ç”¨ç¨‹åºçš„ç»¼åˆè§£å†³æ–¹æ¡ˆã€‚
7. **æ€§èƒ½**ï¼šæä¾›æ€§èƒ½æŒ‡æ ‡å’Œè¯Šæ–­å·¥å…·ï¼Œä»¥ç›‘æ§ã€æ’é™¤æ•…éšœå’Œæ”¹å–„æ•°æ®åº“æ€§èƒ½ã€‚

### Password

åœ¨ç½‘ç»œæ§åˆ¶å°ä¸­ï¼ŒCloud SQL å…è®¸ç”¨æˆ·**è®¾ç½®**æ•°æ®åº“çš„**å¯†ç **ï¼Œè¿˜æœ‰ç”Ÿæˆå¯†ç çš„åŠŸèƒ½ï¼Œä½†æœ€é‡è¦çš„æ˜¯ï¼Œ**MySQL** å…è®¸**ç•™ç©ºå¯†ç ï¼Œæ‰€æœ‰æ•°æ®åº“éƒ½å…è®¸å°†å­—ç¬¦ "a" è®¾ç½®ä¸ºå¯†ç ï¼š**

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

è¿˜å¯ä»¥é…ç½®å¯†ç ç­–ç•¥ï¼Œè¦æ±‚**é•¿åº¦**ã€**å¤æ‚æ€§**ã€**ç¦ç”¨é‡ç”¨**å’Œ**ç¦ç”¨ç”¨æˆ·åä½œä¸ºå¯†ç **ã€‚æ‰€æœ‰è¿™äº›é»˜è®¤éƒ½æ˜¯ç¦ç”¨çš„ã€‚

**SQL Server** å¯ä»¥é…ç½®ä¸ºä½¿ç”¨ **Active Directory Authentication**ã€‚

### Zone Availability

æ•°æ®åº“å¯ä»¥**åœ¨ 1 ä¸ªåŒºåŸŸæˆ–å¤šä¸ªåŒºåŸŸä¸­å¯ç”¨**ï¼Œå½“ç„¶ï¼Œå»ºè®®å°†é‡è¦æ•°æ®åº“æ”¾åœ¨å¤šä¸ªåŒºåŸŸä¸­ã€‚

### Encryption

é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ Google ç®¡ç†çš„åŠ å¯†å¯†é’¥ï¼Œä½†ä¹Ÿ**å¯ä»¥é€‰æ‹©å®¢æˆ·ç®¡ç†çš„åŠ å¯†å¯†é’¥ (CMEK)**ã€‚

### Connections

* **Private IP**ï¼šæŒ‡ç¤º VPC ç½‘ç»œï¼Œæ•°æ®åº“å°†åœ¨ç½‘ç»œå†…è·å¾—ä¸€ä¸ªç§æœ‰ IP
* **Public IP**ï¼šæ•°æ®åº“å°†è·å¾—ä¸€ä¸ªå…¬å…± IPï¼Œä½†é»˜è®¤æƒ…å†µä¸‹æ— äººèƒ½å¤Ÿè¿æ¥
* **Authorized networks**ï¼šæŒ‡ç¤ºåº”å…è®¸è¿æ¥åˆ°æ•°æ®åº“çš„å…¬å…±**IP èŒƒå›´**
* **Private Path**ï¼šå¦‚æœæ•°æ®åº“è¿æ¥åœ¨æŸä¸ª VPC ä¸­ï¼Œå¯ä»¥å¯ç”¨æ­¤é€‰é¡¹å¹¶ç»™äºˆ**å…¶ä»– GCP æœåŠ¡ï¼ˆå¦‚ BigQueryï¼‰è®¿é—®æƒé™**

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### Data Protection

* **Daily backups**ï¼šæ‰§è¡Œè‡ªåŠ¨æ¯æ—¥å¤‡ä»½ï¼Œå¹¶æŒ‡ç¤ºæ‚¨å¸Œæœ›ä¿ç•™çš„å¤‡ä»½æ•°é‡ã€‚
* **Point-in-time recovery**ï¼šå…è®¸æ‚¨ä»ç‰¹å®šæ—¶é—´ç‚¹æ¢å¤æ•°æ®ï¼Œç²¾ç¡®åˆ°ç§’çš„åˆ†æ•°ã€‚
* **Deletion Protection**ï¼šå¦‚æœå¯ç”¨ï¼Œæ•°æ®åº“å°†æ— æ³•è¢«åˆ é™¤ï¼Œç›´åˆ°ç¦ç”¨æ­¤åŠŸèƒ½ã€‚

### Enumeration
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### æœªè®¤è¯æšä¸¾

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### åˆ©ç”¨å

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…æ€§

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
