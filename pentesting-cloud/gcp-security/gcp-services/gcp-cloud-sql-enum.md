# GCP - Cloud SQL Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Grundinformationen

Google Cloud SQL ist ein verwalteter Dienst, der **die Einrichtung, Wartung und Verwaltung von relationalen Datenbanken** wie MySQL, PostgreSQL und SQL Server auf der Google Cloud Platform vereinfacht und die Notwendigkeit beseitigt, Aufgaben wie Hardwarebereitstellung, Datenbankeinrichtung, Patchen und Backups zu √ºbernehmen.

Wichtige Funktionen von Google Cloud SQL sind:

1. **Vollst√§ndig verwaltet**: Google Cloud SQL ist ein vollst√§ndig verwalteter Dienst, was bedeutet, dass Google Wartungsaufgaben f√ºr die Datenbank wie Patchen, Updates, Backups und Konfiguration √ºbernimmt.
2. **Skalierbarkeit**: Es bietet die M√∂glichkeit, die Speicherkapazit√§t und die Rechenressourcen Ihrer Datenbank oft ohne Ausfallzeiten zu skalieren.
3. **Hohe Verf√ºgbarkeit**: Bietet Konfigurationen f√ºr hohe Verf√ºgbarkeit, die sicherstellen, dass Ihre Datenbankdienste zuverl√§ssig sind und Ausf√§lle von Zonen oder Instanzen standhalten k√∂nnen.
4. **Sicherheit**: Bietet robuste Sicherheitsfunktionen wie Datenverschl√ºsselung, Identit√§ts- und Zugriffsmanagement (IAM) und Netzwerkisolierung mit privaten IPs und VPC.
5. **Backups und Wiederherstellung**: Unterst√ºtzt automatische Backups und die Wiederherstellung zu einem bestimmten Zeitpunkt, um Ihre Daten zu sch√ºtzen und wiederherzustellen.
6. **Integration**: Integriert sich nahtlos mit anderen Google Cloud-Diensten und bietet eine umfassende L√∂sung zum Erstellen, Bereitstellen und Verwalten von Anwendungen.
7. **Leistung**: Bietet Leistungsmetriken und Diagnosen zur √úberwachung, Fehlersuche und Verbesserung der Datenbankleistung.

### Passwort

In der Webkonsole Cloud SQL kann der Benutzer das **Passwort** der Datenbank **festlegen**, es gibt auch eine Generierungsfunktion, aber am wichtigsten ist, dass **MySQL** es erlaubt, **ein leeres Passwort zu lassen, und alle erlauben, als Passwort nur das Zeichen "a" festzulegen:**

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

Es ist auch m√∂glich, eine Passwortpolitik zu konfigurieren, die **L√§nge**, **Komplexit√§t**, **Deaktivierung der Wiederverwendung** und **Deaktivierung des Benutzernamens im Passwort** erfordert. Alle sind standardm√§√üig deaktiviert.

**SQL Server** kann mit **Active Directory-Authentifizierung** konfiguriert werden.

### Zonenverf√ºgbarkeit

Die Datenbank kann **in 1 Zone oder in mehreren** verf√ºgbar sein, es wird jedoch empfohlen, wichtige Datenbanken in mehreren Zonen zu haben.

### Verschl√ºsselung

Standardm√§√üig wird ein von Google verwalteter Verschl√ºsselungsschl√ºssel verwendet, es ist jedoch auch **m√∂glich, einen vom Kunden verwalteten Verschl√ºsselungsschl√ºssel (CMEK)** auszuw√§hlen.

### Verbindungen

* **Private IP**: Geben Sie das VPC-Netzwerk an, und die Datenbank erh√§lt eine private IP innerhalb des Netzwerks.
* **√ñffentliche IP**: Die Datenbank erh√§lt eine √∂ffentliche IP, aber standardm√§√üig kann niemand eine Verbindung herstellen.
* **Autorisierte Netzwerke**: Geben Sie √∂ffentliche **IP-Bereiche an, die eine Verbindung zur Datenbank herstellen d√ºrfen**.
* **Privater Pfad**: Wenn die DB in einer VPC verbunden ist, ist es m√∂glich, diese Option zu aktivieren und **anderen GCP-Diensten wie BigQuery √ºber sie Zugriff zu gew√§hren**.

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### Datenschutz

* **T√§gliche Backups**: F√ºhren Sie automatische t√§gliche Backups durch und geben Sie die Anzahl der Backups an, die Sie aufbewahren m√∂chten.
* **Wiederherstellung zu einem bestimmten Zeitpunkt**: Erm√∂glicht es Ihnen, Daten von einem bestimmten Zeitpunkt wiederherzustellen, bis zu einem Bruchteil einer Sekunde.
* **L√∂schschutz**: Wenn aktiviert, kann die DB nicht gel√∂scht werden, bis diese Funktion deaktiviert ist.

### Enumeration
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### Unauthenticated Enum

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### Persistence

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
