# GCP - Cloud SQL Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Informaci칩n B치sica

Google Cloud SQL es un servicio gestionado que **simplifica la configuraci칩n, el mantenimiento y la administraci칩n de bases de datos relacionales** como MySQL, PostgreSQL y SQL Server en Google Cloud Platform, eliminando la necesidad de manejar tareas como la provisi칩n de hardware, la configuraci칩n de bases de datos, la aplicaci칩n de parches y las copias de seguridad.

Las caracter칤sticas clave de Google Cloud SQL incluyen:

1. **Totalmente Gestionado**: Google Cloud SQL es un servicio totalmente gestionado, lo que significa que Google se encarga de las tareas de mantenimiento de la base de datos como la aplicaci칩n de parches, actualizaciones, copias de seguridad y configuraci칩n.
2. **Escalabilidad**: Proporciona la capacidad de escalar la capacidad de almacenamiento y los recursos de computaci칩n de su base de datos, a menudo sin tiempo de inactividad.
3. **Alta Disponibilidad**: Ofrece configuraciones de alta disponibilidad, asegurando que sus servicios de base de datos sean confiables y puedan resistir fallos de zona o de instancia.
4. **Seguridad**: Proporciona caracter칤sticas de seguridad robustas como cifrado de datos, controles de Identidad y Gesti칩n de Accesos (IAM), y aislamiento de red utilizando IPs privadas y VPC.
5. **Copias de Seguridad y Recuperaci칩n**: Soporta copias de seguridad autom치ticas y recuperaci칩n en un punto en el tiempo, ayud치ndole a proteger y restaurar sus datos.
6. **Integraci칩n**: Se integra sin problemas con otros servicios de Google Cloud, proporcionando una soluci칩n integral para construir, desplegar y gestionar aplicaciones.
7. **Rendimiento**: Ofrece m칠tricas de rendimiento y diagn칩sticos para monitorear, solucionar problemas y mejorar el rendimiento de la base de datos.

### Contrase침a

En la consola web, Cloud SQL permite al usuario **establecer** la **contrase침a** de la base de datos, tambi칠n hay una funci칩n de generaci칩n, pero lo m치s importante, **MySQL** permite **dejar una contrase침a vac칤a y todos ellos permiten establecer como contrase침a solo el car치cter "a":**

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

Tambi칠n es posible configurar una pol칤tica de contrase침as que requiera **longitud**, **complejidad**, **deshabilitar reutilizaci칩n** y **deshabilitar nombre de usuario en la contrase침a**. Todos est치n deshabilitados por defecto.

**SQL Server** se puede configurar con **Autenticaci칩n de Active Directory**.

### Disponibilidad de Zona

La base de datos puede estar **disponible en 1 zona o en m칰ltiples**, por supuesto, se recomienda tener bases de datos importantes en m칰ltiples zonas.

### Cifrado

Por defecto se utiliza una clave de cifrado gestionada por Google, pero tambi칠n es **posible seleccionar una clave de cifrado gestionada por el cliente (CMEK)**.

### Conexiones

* **IP Privada**: Indique la red VPC y la base de datos obtendr치 una IP privada dentro de la red.
* **IP P칰blica**: La base de datos obtendr치 una IP p칰blica, pero por defecto nadie podr치 conectarse.
* **Redes Autorizadas**: Indique los **rangos de IP p칰blicos que deber칤an ser permitidos** para conectarse a la base de datos.
* **Ruta Privada**: Si la base de datos est치 conectada en alguna VPC, es posible habilitar esta opci칩n y dar **acceso a otros servicios de GCP como BigQuery a trav칠s de ella**.

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### Protecci칩n de Datos

* **Copias de seguridad diarias**: Realiza copias de seguridad autom치ticas diarias e indica el n칰mero de copias de seguridad que desea mantener.
* **Recuperaci칩n en un punto en el tiempo**: Le permite recuperar datos de un punto espec칤fico en el tiempo, hasta una fracci칩n de segundo.
* **Protecci칩n contra Eliminaci칩n**: Si est치 habilitado, la base de datos no podr치 ser eliminada hasta que esta funci칩n sea deshabilitada.

### Enumeraci칩n
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### Enumeraci칩n No Autenticada

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### Post Explotaci칩n

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### Persistencia

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
