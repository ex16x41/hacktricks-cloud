# GCP - Cloud SQL Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Google Cloud SQL √© um servi√ßo gerenciado que **simplifica a configura√ß√£o, manuten√ß√£o e administra√ß√£o de bancos de dados relacionais** como MySQL, PostgreSQL e SQL Server na Google Cloud Platform, eliminando a necessidade de lidar com tarefas como provisionamento de hardware, configura√ß√£o de banco de dados, patching e backups.

As principais caracter√≠sticas do Google Cloud SQL incluem:

1. **Totalmente Gerenciado**: O Google Cloud SQL √© um servi√ßo totalmente gerenciado, o que significa que o Google cuida das tarefas de manuten√ß√£o do banco de dados, como patching, atualiza√ß√µes, backups e configura√ß√£o.
2. **Escalabilidade**: Ele oferece a capacidade de escalar a capacidade de armazenamento e os recursos computacionais do seu banco de dados, muitas vezes sem tempo de inatividade.
3. **Alta Disponibilidade**: Oferece configura√ß√µes de alta disponibilidade, garantindo que seus servi√ßos de banco de dados sejam confi√°veis e possam suportar falhas de zona ou inst√¢ncia.
4. **Seguran√ßa**: Fornece recursos de seguran√ßa robustos, como criptografia de dados, controles de Gerenciamento de Identidade e Acesso (IAM) e isolamento de rede usando IPs privados e VPC.
5. **Backups e Recupera√ß√£o**: Suporta backups autom√°ticos e recupera√ß√£o em um ponto no tempo, ajudando a proteger e restaurar seus dados.
6. **Integra√ß√£o**: Integra-se perfeitamente com outros servi√ßos do Google Cloud, fornecendo uma solu√ß√£o abrangente para construir, implantar e gerenciar aplicativos.
7. **Desempenho**: Oferece m√©tricas de desempenho e diagn√≥sticos para monitorar, solucionar problemas e melhorar o desempenho do banco de dados.

### Password

Na console web, o Cloud SQL permite que o usu√°rio **defina** a **senha** do banco de dados, tamb√©m h√° um recurso de gera√ß√£o, mas o mais importante, **MySQL** permite **deixar a senha em branco e todos eles permitem definir como senha apenas o caractere "a":**

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

Tamb√©m √© poss√≠vel configurar uma pol√≠tica de senha exigindo **comprimento**, **complexidade**, **desabilitar reutiliza√ß√£o** e **desabilitar nome de usu√°rio na senha**. Todos est√£o desabilitados por padr√£o.

**SQL Server** pode ser configurado com **Autentica√ß√£o do Active Directory**.

### Zone Availability

O banco de dados pode estar **dispon√≠vel em 1 zona ou em v√°rias**, claro, √© recomendado ter bancos de dados importantes em v√°rias zonas.

### Encryption

Por padr√£o, uma chave de criptografia gerenciada pelo Google √© usada, mas tamb√©m √© **poss√≠vel selecionar uma chave de criptografia gerenciada pelo cliente (CMEK)**.

### Connections

* **IP Privado**: Indique a rede VPC e o banco de dados receber√° um IP privado dentro da rede
* **IP P√∫blico**: O banco de dados receber√° um IP p√∫blico, mas por padr√£o ningu√©m poder√° se conectar
* **Redes autorizadas**: Indique os **intervalos de IP p√∫blicos que devem ser permitidos** para se conectar ao banco de dados
* **Caminho Privado**: Se o DB estiver conectado em alguma VPC, √© poss√≠vel habilitar esta op√ß√£o e dar **acesso a outros servi√ßos GCP como BigQuery sobre ele**

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### Data Protection

* **Backups di√°rios**: Realiza backups autom√°ticos di√°rios e indica o n√∫mero de backups que voc√™ deseja manter.
* **Recupera√ß√£o em um ponto no tempo**: Permite recuperar dados de um ponto espec√≠fico no tempo, at√© uma fra√ß√£o de segundo.
* **Prote√ß√£o contra exclus√£o**: Se habilitado, o DB n√£o poder√° ser exclu√≠do at√© que este recurso seja desabilitado.

### Enumeration
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### Enum N√£o Autenticado

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### P√≥s Explora√ß√£o

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### Persist√™ncia

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
