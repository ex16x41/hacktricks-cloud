# GCP - Cloud SQL æšä¸¾

{% hint style="success" %}
å­¦ä¹ å¹¶ç»ƒä¹  AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å¹¶ç»ƒä¹  GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* é€šè¿‡å‘ [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

Google Cloud SQL æ˜¯ä¸€é¡¹æ‰˜ç®¡æœåŠ¡ï¼Œ**ç®€åŒ–äº†åœ¨ Google Cloud å¹³å°ä¸Šè®¾ç½®ã€ç»´æŠ¤å’Œç®¡ç†å…³ç³»æ•°æ®åº“**ï¼ˆå¦‚ MySQLã€PostgreSQL å’Œ SQL Serverï¼‰çš„è¿‡ç¨‹ï¼Œæ— éœ€å¤„ç†ç¡¬ä»¶é…ç½®ã€æ•°æ®åº“è®¾ç½®ã€æ‰“è¡¥ä¸å’Œå¤‡ä»½ç­‰ä»»åŠ¡ã€‚

Google Cloud SQL çš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š

1. **å…¨é¢æ‰˜ç®¡**ï¼šGoogle Cloud SQL æ˜¯ä¸€é¡¹å…¨é¢æ‰˜ç®¡çš„æœåŠ¡ï¼Œæ„å‘³ç€ Google å¤„ç†æ•°æ®åº“ç»´æŠ¤ä»»åŠ¡ï¼Œå¦‚æ‰“è¡¥ä¸ã€æ›´æ–°ã€å¤‡ä»½å’Œé…ç½®ã€‚
2. **å¯æ‰©å±•æ€§**ï¼šå®ƒæä¾›äº†æ‰©å±•æ•°æ®åº“å­˜å‚¨å®¹é‡å’Œè®¡ç®—èµ„æºçš„èƒ½åŠ›ï¼Œé€šå¸¸æ— éœ€åœæœºã€‚
3. **é«˜å¯ç”¨æ€§**ï¼šæä¾›é«˜å¯ç”¨æ€§é…ç½®ï¼Œç¡®ä¿æ‚¨çš„æ•°æ®åº“æœåŠ¡å¯é ï¼Œå¹¶èƒ½æŠµå¾¡åŒºåŸŸæˆ–å®ä¾‹æ•…éšœã€‚
4. **å®‰å…¨æ€§**ï¼šæä¾›å¼ºå¤§çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æ•°æ®åŠ å¯†ã€èº«ä»½å’Œè®¿é—®ç®¡ç†ï¼ˆIAMï¼‰æ§åˆ¶ï¼Œä»¥åŠä½¿ç”¨ç§æœ‰ IP å’Œ VPC è¿›è¡Œç½‘ç»œéš”ç¦»ã€‚
5. **å¤‡ä»½å’Œæ¢å¤**ï¼šæ”¯æŒè‡ªåŠ¨å¤‡ä»½å’ŒæŒ‰æ—¶é—´ç‚¹æ¢å¤ï¼Œå¸®åŠ©æ‚¨ä¿æŠ¤å’Œæ¢å¤æ•°æ®ã€‚
6. **é›†æˆ**ï¼šä¸å…¶ä»– Google Cloud æœåŠ¡æ— ç¼é›†æˆï¼Œä¸ºæ„å»ºã€éƒ¨ç½²å’Œç®¡ç†åº”ç”¨ç¨‹åºæä¾›å…¨é¢è§£å†³æ–¹æ¡ˆã€‚
7. **æ€§èƒ½**ï¼šæä¾›æ€§èƒ½æŒ‡æ ‡å’Œè¯Šæ–­å·¥å…·ï¼Œç”¨äºç›‘è§†ã€æ’é™¤æ•…éšœå’Œæ”¹è¿›æ•°æ®åº“æ€§èƒ½ã€‚

### å¯†ç 

åœ¨ Web æ§åˆ¶å°ä¸­ï¼ŒCloud SQL å…è®¸ç”¨æˆ·**è®¾ç½®**æ•°æ®åº“çš„**å¯†ç **ï¼Œè¿˜æœ‰ä¸€ä¸ªç”ŸæˆåŠŸèƒ½ï¼Œä½†æœ€é‡è¦çš„æ˜¯ï¼Œ**MySQL** å…è®¸**å°†å¯†ç ç•™ç©ºï¼Œæ‰€æœ‰è¿™äº›éƒ½å…è®¸å°†å­—ç¬¦ "a" è®¾ç½®ä¸ºå¯†ç **ï¼š

<figure><img src="../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

è¿˜å¯ä»¥é…ç½®å¯†ç ç­–ç•¥ï¼Œè¦æ±‚**é•¿åº¦**ã€**å¤æ‚æ€§**ã€**ç¦ç”¨é‡ç”¨**å’Œ**ç¦ç”¨ç”¨æˆ·ååœ¨å¯†ç ä¸­**ã€‚æ‰€æœ‰è¿™äº›é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯ç¦ç”¨çš„ã€‚

**SQL Server** å¯ä»¥é…ç½®ä¸ºä½¿ç”¨**Active Directory èº«ä»½éªŒè¯**ã€‚

### åŒºåŸŸå¯ç”¨æ€§

æ•°æ®åº“å¯ä»¥åœ¨**ä¸€ä¸ªåŒºåŸŸæˆ–å¤šä¸ªåŒºåŸŸä¸­å¯ç”¨**ï¼Œå½“ç„¶ï¼Œå»ºè®®å°†é‡è¦æ•°æ®åº“æ”¾åœ¨å¤šä¸ªåŒºåŸŸä¸­ã€‚

### åŠ å¯†

é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ Google ç®¡ç†çš„åŠ å¯†å¯†é’¥ï¼Œä½†ä¹Ÿ**å¯ä»¥é€‰æ‹©å®¢æˆ·ç®¡ç†çš„åŠ å¯†å¯†é’¥ï¼ˆCMEKï¼‰**ã€‚

### è¿æ¥

* **ç§æœ‰ IP**ï¼šæŒ‡å®š VPC ç½‘ç»œï¼Œæ•°æ®åº“å°†åœ¨ç½‘ç»œå†…éƒ¨è·å¾—ä¸€ä¸ªç§æœ‰ IP
* **å…¬å…± IP**ï¼šæ•°æ®åº“å°†è·å¾—ä¸€ä¸ªå…¬å…± IPï¼Œä½†é»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰äººèƒ½å¤Ÿè¿æ¥
* **æˆæƒç½‘ç»œ**ï¼šæŒ‡å®šåº”å…è®¸è¿æ¥åˆ°æ•°æ®åº“çš„å…¬å…± IP èŒƒå›´
* **ç§æœ‰è·¯å¾„**ï¼šå¦‚æœæ•°æ®åº“è¿æ¥åœ¨æŸä¸ª VPC ä¸­ï¼Œå¯ä»¥å¯ç”¨æ­¤é€‰é¡¹ï¼Œå¹¶å…è®¸**å…¶ä»– GCP æœåŠ¡ï¼ˆå¦‚ BigQueryï¼‰è®¿é—®**

<figure><img src="../../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### æ•°æ®ä¿æŠ¤

* **æ¯æ—¥å¤‡ä»½**ï¼šæ‰§è¡Œè‡ªåŠ¨æ¯æ—¥å¤‡ä»½ï¼Œå¹¶æŒ‡å®šè¦ä¿ç•™çš„å¤‡ä»½æ•°é‡ã€‚
* **æŒ‰æ—¶é—´ç‚¹æ¢å¤**ï¼šå…è®¸æ‚¨ä»ç‰¹å®šæ—¶é—´ç‚¹æ¢å¤æ•°æ®ï¼Œç²¾ç¡®åˆ°ç§’çš„ä¸€éƒ¨åˆ†ã€‚
* **åˆ é™¤ä¿æŠ¤**ï¼šå¦‚æœå¯ç”¨ï¼Œç›´åˆ°ç¦ç”¨æ­¤åŠŸèƒ½ï¼Œæ•°æ®åº“å°†æ— æ³•è¢«åˆ é™¤ã€‚

### æšä¸¾
```bash
# Get SQL instances
gcloud sql instances list
gcloud sql instances describe <inst-name> # get IPs, CACert, settings

# Get database names inside an instance (like information_schema, sys...)
gcloud sql databases list --instance <intance-name>
gcloud sql databases describe <db-name> --instance <intance-name>

# Get usernames inside the db instance
gcloud sql users list --instance <intance-name>

# Backups
gcloud sql backups list --instance <intance-name>
gcloud sql backups describe <backup-name> --instance <intance-name>
```
### æœªç»èº«ä»½éªŒè¯çš„æšä¸¾

{% content-ref url="../gcp-unaunthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md" %}
[gcp-cloud-sql-unauthenticated-enum.md](../gcp-unaunthenticated-enum-and-access/gcp-cloud-sql-unauthenticated-enum.md)
{% endcontent-ref %}

### åæ¸—é€

{% content-ref url="../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md" %}
[gcp-cloud-sql-post-exploitation.md](../gcp-post-exploitation/gcp-cloud-sql-post-exploitation.md)
{% endcontent-ref %}

### æŒä¹…æ€§

{% content-ref url="../gcp-persistence/gcp-cloud-sql-persistence.md" %}
[gcp-cloud-sql-persistence.md](../gcp-persistence/gcp-cloud-sql-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
å­¦ä¹ å¹¶ç»ƒä¹ AWSé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å¹¶ç»ƒä¹ GCPé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æ£€æŸ¥[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨**æˆ‘ä»¬çš„**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* é€šè¿‡å‘[**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubä»“åº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
