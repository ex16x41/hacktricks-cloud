# GCP - Security Enum

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PRs åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

Google Cloud Platform (GCP) å®‰å…¨æ€§æ¶µç›–äº†ä¸€å¥—**å…¨é¢çš„å·¥å…·**å’Œå®è·µï¼Œæ—¨åœ¨ç¡®ä¿ Google Cloud ç¯å¢ƒä¸­èµ„æºå’Œæ•°æ®çš„**å®‰å…¨æ€§**ï¼Œåˆ†ä¸ºå››ä¸ªä¸»è¦éƒ¨åˆ†ï¼š**Security Command Center, Detections and Controls, Data Protection å’Œ Zero Trustã€‚**

## **Security Command Center**

Google Cloud Platform (GCP) Security Command Center (SCC) æ˜¯ä¸€ä¸ª**GCP èµ„æºçš„å®‰å…¨å’Œé£é™©ç®¡ç†å·¥å…·**ï¼Œä½¿ç»„ç»‡èƒ½å¤Ÿè·å¾—å¯¹å…¶äº‘èµ„äº§çš„å¯è§æ€§å’Œæ§åˆ¶ã€‚å®ƒé€šè¿‡æä¾›å…¨é¢çš„å®‰å…¨åˆ†æï¼Œ**è¯†åˆ«é”™è¯¯é…ç½®**ï¼Œç¡®ä¿**ç¬¦åˆå®‰å…¨æ ‡å‡†**ï¼Œå¹¶ä¸å…¶ä»–å®‰å…¨å·¥å…·**é›†æˆ**ä»¥å®ç°è‡ªåŠ¨å¨èƒæ£€æµ‹å’Œå“åº”ï¼Œå¸®åŠ©**æ£€æµ‹å’Œå“åº”å¨èƒ**ã€‚

* **æ¦‚è¿°**ï¼šé¢æ¿**å¯è§†åŒ– Security Command Center çš„æ‰€æœ‰ç»“æœæ¦‚è§ˆ**ã€‚
* å¨èƒï¼š\[éœ€è¦é«˜çº§ç‰ˆ] é¢æ¿å¯è§†åŒ–æ‰€æœ‰**æ£€æµ‹åˆ°çš„å¨èƒã€‚æ›´å¤šå…³äºå¨èƒçš„ä¿¡æ¯è¯·è§ä¸‹æ–‡**
* **æ¼æ´**ï¼šé¢æ¿**å¯è§†åŒ– GCP è´¦æˆ·ä¸­å‘ç°çš„é”™è¯¯é…ç½®**ã€‚
* **åˆè§„æ€§**ï¼š\[éœ€è¦é«˜çº§ç‰ˆ] æ­¤éƒ¨åˆ†å…è®¸**æ ¹æ®å¤šä¸ªåˆè§„æ€§æ£€æŸ¥ï¼ˆå¦‚ PCI-DSS, NIST 800-53, CIS åŸºå‡†ç­‰ï¼‰æµ‹è¯• GCP ç¯å¢ƒ**ã€‚
* **èµ„äº§**ï¼šæ­¤éƒ¨åˆ†**æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„èµ„äº§**ï¼Œå¯¹ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆå¯èƒ½è¿˜æœ‰æ”»å‡»è€…ï¼‰éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªé¡µé¢ä¸Šçœ‹åˆ°æ­£åœ¨è¿è¡Œçš„å†…å®¹ã€‚
* **å‘ç°**ï¼šæ­¤éƒ¨åˆ†**æ±‡æ€»** GCP å®‰å…¨çš„ä¸åŒéƒ¨åˆ†çš„**å‘ç°ç»“æœ**ï¼Œä»¥ä¾¿è½»æ¾å¯è§†åŒ–é‡è¦çš„å‘ç°ã€‚
* **æ¥æº**ï¼šæ˜¾ç¤º GCP å®‰å…¨ä¸åŒéƒ¨åˆ†çš„**å‘ç°æ‘˜è¦**ã€‚
* **å§¿æ€**ï¼š\[éœ€è¦é«˜çº§ç‰ˆ] å®‰å…¨å§¿æ€å…è®¸**å®šä¹‰ã€è¯„ä¼°å’Œç›‘æ§ GCP ç¯å¢ƒçš„å®‰å…¨æ€§**ã€‚å®ƒé€šè¿‡åˆ›å»ºå®šä¹‰çº¦æŸæˆ–é™åˆ¶çš„ç­–ç•¥æ¥æ§åˆ¶/ç›‘æ§ GCP ä¸­çš„èµ„æºã€‚å¯ä»¥åœ¨ [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy) æ‰¾åˆ°å‡ ä¸ªé¢„å®šä¹‰çš„å§¿æ€æ¨¡æ¿ã€‚

### **å¨èƒ**

ä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œè¿™å¯èƒ½æ˜¯**æœ€æœ‰è¶£çš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒå¯ä»¥æ£€æµ‹åˆ°æ”»å‡»è€…**ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„æ­¤åŠŸèƒ½éœ€è¦**é«˜çº§ç‰ˆ**ï¼ˆè¿™æ„å‘³ç€å…¬å¸éœ€è¦æ”¯ä»˜æ›´å¤šè´¹ç”¨ï¼‰ï¼Œå› æ­¤å®ƒ**å¯èƒ½ç”šè‡³æ²¡æœ‰å¯ç”¨**ã€‚

æœ‰ä¸‰ç§ç±»å‹çš„å¨èƒæ£€æµ‹æœºåˆ¶ï¼š

* **äº‹ä»¶å¨èƒ**ï¼šé€šè¿‡åŒ¹é…æ¥è‡ª **Cloud Logging** çš„äº‹ä»¶ï¼Œæ ¹æ® Google å†…éƒ¨åˆ›å»ºçš„**è§„åˆ™**ç”Ÿæˆçš„å‘ç°ç»“æœã€‚å®ƒè¿˜å¯ä»¥æ‰«æ **Google Workspace æ—¥å¿—**ã€‚
* å¯ä»¥åœ¨ [**æ–‡æ¡£ä¸­æ‰¾åˆ°æ‰€æœ‰æ£€æµ‹è§„åˆ™çš„æè¿°**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)
* **å®¹å™¨å¨èƒ**ï¼šåœ¨åˆ†æå®¹å™¨å†…æ ¸çš„ä½çº§è¡Œä¸ºåç”Ÿæˆçš„å‘ç°ç»“æœã€‚
* **è‡ªå®šä¹‰å¨èƒ**ï¼šç”±å…¬å¸åˆ›å»ºçš„è§„åˆ™ã€‚

å¯ä»¥åœ¨ [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response) æ‰¾åˆ°å¯¹æ£€æµ‹åˆ°çš„å¨èƒçš„æ¨èå“åº”ã€‚

### æšä¸¾

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## Detections and Controls

* **Chronicle SecOps**: ä¸€ä¸ªé«˜çº§å®‰å…¨æ“ä½œå¥—ä»¶ï¼Œæ—¨åœ¨å¸®åŠ©å›¢é˜Ÿæé«˜å®‰å…¨æ“ä½œçš„é€Ÿåº¦å’Œå½±å“åŠ›ï¼ŒåŒ…æ‹¬å¨èƒæ£€æµ‹ã€è°ƒæŸ¥å’Œå“åº”ã€‚
* **reCAPTCHA Enterprise**: ä¸€é¡¹æœåŠ¡ï¼Œé€šè¿‡åŒºåˆ†äººç±»ç”¨æˆ·å’Œæœºå™¨äººæ¥ä¿æŠ¤ç½‘ç«™å…å—æŠ“å–ã€å‡­è¯å¡«å……å’Œè‡ªåŠ¨åŒ–æ”»å‡»ç­‰æ¬ºè¯ˆæ´»åŠ¨çš„ä¾µå®³ã€‚
* **Web Security Scanner**: è‡ªåŠ¨åŒ–å®‰å…¨æ‰«æå·¥å…·ï¼Œæ£€æµ‹æ‰˜ç®¡åœ¨Google Cloudæˆ–å…¶ä»–ç½‘ç»œæœåŠ¡ä¸Šçš„Webåº”ç”¨ç¨‹åºä¸­çš„æ¼æ´å’Œå¸¸è§å®‰å…¨é—®é¢˜ã€‚
* **Risk Manager**: ä¸€ä¸ªæ²»ç†ã€é£é™©å’Œåˆè§„ï¼ˆGRCï¼‰å·¥å…·ï¼Œå¸®åŠ©ç»„ç»‡è¯„ä¼°ã€è®°å½•å’Œç†è§£å…¶Google Cloudé£é™©çŠ¶å†µã€‚
* **Binary Authorization**: ä¸€ä¸ªå®¹å™¨çš„å®‰å…¨æ§åˆ¶ï¼Œç¡®ä¿åªæœ‰å—ä¿¡ä»»çš„å®¹å™¨é•œåƒæ ¹æ®ä¼ä¸šè®¾å®šçš„ç­–ç•¥éƒ¨ç½²åœ¨Kubernetes Engineé›†ç¾¤ä¸Šã€‚
* **Advisory Notifications**: ä¸€é¡¹æœåŠ¡ï¼Œæä¾›å…³äºæ½œåœ¨å®‰å…¨é—®é¢˜ã€æ¼æ´å’Œæ¨èæ“ä½œçš„è­¦æŠ¥å’Œå»ºè®®ï¼Œä»¥ä¿æŒèµ„æºçš„å®‰å…¨ã€‚
* **Access Approval**: ä¸€ä¸ªåŠŸèƒ½ï¼Œå…è®¸ç»„ç»‡åœ¨Googleå‘˜å·¥è®¿é—®å…¶æ•°æ®æˆ–é…ç½®ä¹‹å‰éœ€è¦æ˜ç¡®æ‰¹å‡†ï¼Œæä¾›é¢å¤–çš„æ§åˆ¶å’Œå®¡è®¡å±‚ã€‚
* **Managed Microsoft AD**: ä¸€é¡¹æä¾›æ‰˜ç®¡Microsoft Active Directoryï¼ˆADï¼‰çš„æœåŠ¡ï¼Œå…è®¸ç”¨æˆ·åœ¨Google Cloudä¸Šä½¿ç”¨å…¶ç°æœ‰çš„ä¾èµ–äºMicrosoft ADçš„åº”ç”¨ç¨‹åºå’Œå·¥ä½œè´Ÿè½½ã€‚

## Data Protection

* **Sensitive Data Protection**: æ—¨åœ¨ä¿æŠ¤æ•æ„Ÿæ•°æ®ï¼ˆå¦‚ä¸ªäººä¿¡æ¯æˆ–çŸ¥è¯†äº§æƒï¼‰å…å—æœªç»æˆæƒè®¿é—®æˆ–æš´éœ²çš„å·¥å…·å’Œå®è·µã€‚
* **Data Loss Prevention (DLP)**: ä¸€å¥—å·¥å…·å’Œæµç¨‹ï¼Œé€šè¿‡æ·±åº¦å†…å®¹æ£€æŸ¥å’Œåº”ç”¨å…¨é¢çš„æ•°æ®ä¿æŠ¤è§„åˆ™ï¼Œç”¨äºè¯†åˆ«ã€ç›‘æ§å’Œä¿æŠ¤ä½¿ç”¨ä¸­ã€ä¼ è¾“ä¸­å’Œé™æ­¢ä¸­çš„æ•°æ®ã€‚
* **Certificate Authority Service**: ä¸€ä¸ªå¯æ‰©å±•ä¸”å®‰å…¨çš„æœåŠ¡ï¼Œç®€åŒ–å’Œè‡ªåŠ¨åŒ–SSL/TLSè¯ä¹¦çš„ç®¡ç†ã€éƒ¨ç½²å’Œæ›´æ–°ï¼Œç”¨äºå†…éƒ¨å’Œå¤–éƒ¨æœåŠ¡ã€‚
* **Key Management**: ä¸€ä¸ªåŸºäºäº‘çš„æœåŠ¡ï¼Œå…è®¸æ‚¨ç®¡ç†åº”ç”¨ç¨‹åºçš„åŠ å¯†å¯†é’¥ï¼ŒåŒ…æ‹¬åˆ›å»ºã€å¯¼å…¥ã€è½®æ¢ã€ä½¿ç”¨å’Œé”€æ¯åŠ å¯†å¯†é’¥ã€‚æ›´å¤šä¿¡æ¯åœ¨ï¼š

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Certificate Manager**: ä¸€ä¸ªç®¡ç†å’Œéƒ¨ç½²SSL/TLSè¯ä¹¦çš„æœåŠ¡ï¼Œç¡®ä¿ä¸æ‚¨çš„WebæœåŠ¡å’Œåº”ç”¨ç¨‹åºçš„è¿æ¥å®‰å…¨ä¸”åŠ å¯†ã€‚
* **Secret Manager**: ä¸€ä¸ªå®‰å…¨ä¸”æ–¹ä¾¿çš„å­˜å‚¨ç³»ç»Ÿï¼Œç”¨äºAPIå¯†é’¥ã€å¯†ç ã€è¯ä¹¦å’Œå…¶ä»–æ•æ„Ÿæ•°æ®ï¼Œå…è®¸åœ¨åº”ç”¨ç¨‹åºä¸­è½»æ¾ä¸”å®‰å…¨åœ°è®¿é—®å’Œç®¡ç†è¿™äº›ç§˜å¯†ã€‚æ›´å¤šä¿¡æ¯åœ¨ï¼š

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Zero Trust

* **BeyondCorp Enterprise**: ä¸€ä¸ªé›¶ä¿¡ä»»å®‰å…¨å¹³å°ï¼Œé€šè¿‡åœ¨æˆäºˆè®¿é—®æƒé™ä¹‹å‰éªŒè¯ç”¨æˆ·å’Œè®¾å¤‡çš„ä¿¡ä»»åº¦ï¼Œæ¥å®ç°å¯¹å†…éƒ¨åº”ç”¨ç¨‹åºçš„å®‰å…¨è®¿é—®ï¼Œè€Œæ— éœ€ä¼ ç»Ÿçš„VPNã€‚
* **Policy Troubleshooter**: ä¸€ä¸ªå·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©ç®¡ç†å‘˜ç†è§£å’Œè§£å†³ç»„ç»‡ä¸­çš„è®¿é—®é—®é¢˜ï¼Œé€šè¿‡è¯†åˆ«ç”¨æˆ·ä¸ºä½•æœ‰æƒè®¿é—®æŸäº›èµ„æºæˆ–ä¸ºä½•è¢«æ‹’ç»è®¿é—®ï¼Œä»è€Œå¸®åŠ©æ‰§è¡Œé›¶ä¿¡ä»»ç­–ç•¥ã€‚
* **Identity-Aware Proxy (IAP)**: ä¸€é¡¹æœåŠ¡ï¼ŒåŸºäºè¯·æ±‚çš„èº«ä»½å’Œä¸Šä¸‹æ–‡è€Œä¸æ˜¯è¯·æ±‚æ¥æºçš„ç½‘ç»œï¼Œæ§åˆ¶å¯¹Google Cloudã€å†…éƒ¨éƒ¨ç½²æˆ–å…¶ä»–äº‘ä¸Šè¿è¡Œçš„äº‘åº”ç”¨ç¨‹åºå’Œè™šæ‹Ÿæœºçš„è®¿é—®ã€‚
* **VPC Service Controls**: å®‰å…¨è¾¹ç•Œï¼Œä¸ºæ‰˜ç®¡åœ¨Google Cloudè™šæ‹Ÿç§æœ‰äº‘ï¼ˆVPCï¼‰ä¸­çš„èµ„æºå’ŒæœåŠ¡æä¾›é¢å¤–çš„ä¿æŠ¤å±‚ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²å¹¶æä¾›ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶ã€‚
* **Access Context Manager**: Google Cloud BeyondCorp Enterpriseçš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªå·¥å…·å¸®åŠ©å®šä¹‰å’Œæ‰§è¡ŒåŸºäºç”¨æˆ·èº«ä»½å’Œè¯·æ±‚ä¸Šä¸‹æ–‡ï¼ˆå¦‚è®¾å¤‡å®‰å…¨çŠ¶æ€ã€IPåœ°å€ç­‰ï¼‰çš„ç»†ç²’åº¦è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWS Hackingï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCP Hackingï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤PRsåˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubä»“åº“æ¥åˆ†äº«é»‘å®¢æŠ€å·§**ã€‚

</details>
{% endhint %}
