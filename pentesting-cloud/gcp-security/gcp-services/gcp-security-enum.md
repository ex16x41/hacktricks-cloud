# GCP - Security Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Informa√ß√µes B√°sicas

A Seguran√ßa da Google Cloud Platform (GCP) abrange um **conjunto abrangente de ferramentas** e pr√°ticas projetadas para garantir a **seguran√ßa** de recursos e dados dentro do ambiente Google Cloud, dividida em quatro se√ß√µes principais: **Centro de Comando de Seguran√ßa, Detec√ß√µes e Controles, Prote√ß√£o de Dados e Zero Trust.**

## **Centro de Comando de Seguran√ßa**

O Centro de Comando de Seguran√ßa da Google Cloud Platform (GCP) √© uma **ferramenta de seguran√ßa e gerenciamento de riscos para recursos GCP** que permite que as organiza√ß√µes tenham visibilidade e controle sobre seus ativos em nuvem. Ele ajuda a **detectar e responder a amea√ßas** oferecendo an√°lises de seguran√ßa abrangentes, **identificando configura√ß√µes incorretas**, garantindo **conformidade** com padr√µes de seguran√ßa e **integrando-se** a outras ferramentas de seguran√ßa para detec√ß√£o e resposta automatizadas a amea√ßas.

* **Vis√£o Geral**: Painel para **visualizar uma vis√£o geral** de todos os resultados do Centro de Comando de Seguran√ßa.
* Amea√ßas: \[Premium Requerido] Painel para visualizar todas as **amea√ßas detectadas. Confira mais sobre Amea√ßas abaixo**
* **Vulnerabilidades**: Painel para **visualizar configura√ß√µes incorretas encontradas na conta GCP**.
* **Conformidade**: \[Premium requerido] Esta se√ß√£o permite **testar seu ambiente GCP contra v√°rias verifica√ß√µes de conformidade** (como PCI-DSS, NIST 800-53, benchmarks CIS...) sobre a organiza√ß√£o.
* **Ativos**: Esta se√ß√£o **mostra todos os ativos sendo utilizados**, muito √∫til para sysadmins (e talvez atacantes) verem o que est√° rodando em uma √∫nica p√°gina.
* **Constata√ß√µes**: Isso **agrega** em uma **tabela constata√ß√µes** de diferentes se√ß√µes da Seguran√ßa GCP (n√£o apenas do Centro de Comando) para poder visualizar facilmente constata√ß√µes que importam.
* **Fontes**: Mostra um **resumo das constata√ß√µes** de todas as diferentes se√ß√µes da seguran√ßa GCP **por se√ß√£o**.
* **Postura**: \[Premium Requerido] A Postura de Seguran√ßa permite **definir, avaliar e monitorar a seguran√ßa do ambiente GCP**. Funciona criando pol√≠ticas que definem restri√ß√µes ou limita√ß√µes que controlam/monitoram os recursos na GCP. Existem v√°rios modelos de postura pr√©-definidos que podem ser encontrados em [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy)

### **Amea√ßas**

Do ponto de vista de um atacante, este √© provavelmente o **recurso mais interessante, pois pode detectar o atacante**. No entanto, observe que este recurso requer **Premium** (o que significa que a empresa precisar√° pagar mais), ent√£o **pode n√£o estar nem mesmo habilitado**.

Existem 3 tipos de mecanismos de detec√ß√£o de amea√ßas:

* **Amea√ßas de Evento**: Constata√ß√µes produzidas ao combinar eventos do **Cloud Logging** com base em **regras criadas** internamente pelo Google. Tamb√©m pode escanear **logs do Google Workspace**.
* √â poss√≠vel encontrar a descri√ß√£o de todas as [**regras de detec√ß√£o na documenta√ß√£o**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how_works)
* **Amea√ßas de Container**: Constata√ß√µes produzidas ap√≥s analisar o comportamento de baixo n√≠vel do kernel dos containers.
* **Amea√ßas Personalizadas**: Regras criadas pela empresa.

√â poss√≠vel encontrar respostas recomendadas para amea√ßas detectadas de ambos os tipos em [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event_response)

### Enumera√ß√£o

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### P√≥s Explora√ß√£o

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## Detec√ß√µes e Controles

* **Chronicle SecOps**: Uma su√≠te avan√ßada de opera√ß√µes de seguran√ßa projetada para ajudar as equipes a aumentar sua velocidade e impacto nas opera√ß√µes de seguran√ßa, incluindo detec√ß√£o de amea√ßas, investiga√ß√£o e resposta.
* **reCAPTCHA Enterprise**: Um servi√ßo que protege sites contra atividades fraudulentas, como scraping, credential stuffing e ataques automatizados, distinguindo entre usu√°rios humanos e bots.
* **Web Security Scanner**: Ferramenta de varredura de seguran√ßa automatizada que detecta vulnerabilidades e problemas de seguran√ßa comuns em aplica√ß√µes web hospedadas no Google Cloud ou em outro servi√ßo web.
* **Risk Manager**: Uma ferramenta de governan√ßa, risco e conformidade (GRC) que ajuda as organiza√ß√µes a avaliar, documentar e entender sua postura de risco no Google Cloud.
* **Binary Authorization**: Um controle de seguran√ßa para cont√™ineres que garante que apenas imagens de cont√™iner confi√°veis sejam implantadas em clusters do Kubernetes Engine de acordo com as pol√≠ticas definidas pela empresa.
* **Advisory Notifications**: Um servi√ßo que fornece alertas e avisos sobre potenciais problemas de seguran√ßa, vulnerabilidades e a√ß√µes recomendadas para manter os recursos seguros.
* **Access Approval**: Um recurso que permite que as organiza√ß√µes exijam aprova√ß√£o expl√≠cita antes que os funcion√°rios do Google possam acessar seus dados ou configura√ß√µes, proporcionando uma camada adicional de controle e auditabilidade.
* **Managed Microsoft AD**: Um servi√ßo que oferece Microsoft Active Directory (AD) gerenciado, permitindo que os usu√°rios utilizem seus aplicativos e cargas de trabalho dependentes do Microsoft AD existentes no Google Cloud.

## Prote√ß√£o de Dados

* **Prote√ß√£o de Dados Sens√≠veis**: Ferramentas e pr√°ticas destinadas a proteger dados sens√≠veis, como informa√ß√µes pessoais ou propriedade intelectual, contra acesso ou exposi√ß√£o n√£o autorizados.
* **Data Loss Prevention (DLP)**: Um conjunto de ferramentas e processos usados para identificar, monitorar e proteger dados em uso, em movimento e em repouso por meio de inspe√ß√£o profunda de conte√∫do e aplicando um conjunto abrangente de regras de prote√ß√£o de dados.
* **Certificate Authority Service**: Um servi√ßo escal√°vel e seguro que simplifica e automatiza a gest√£o, implanta√ß√£o e renova√ß√£o de certificados SSL/TLS para servi√ßos internos e externos.
* **Key Management**: Um servi√ßo baseado em nuvem que permite gerenciar chaves criptogr√°ficas para suas aplica√ß√µes, incluindo a cria√ß√£o, importa√ß√£o, rota√ß√£o, uso e destrui√ß√£o de chaves de criptografia. Mais informa√ß√µes em:

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Certificate Manager**: Um servi√ßo que gerencia e implanta certificados SSL/TLS, garantindo conex√µes seguras e criptografadas aos seus servi√ßos e aplica√ß√µes web.
* **Secret Manager**: Um sistema de armazenamento seguro e conveniente para chaves de API, senhas, certificados e outros dados sens√≠veis, que permite o acesso e gerenciamento f√°cil e seguro desses segredos em aplica√ß√µes. Mais informa√ß√µes em:

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Zero Trust

* **BeyondCorp Enterprise**: Uma plataforma de seguran√ßa de zero-trust que permite acesso seguro a aplica√ß√µes internas sem a necessidade de uma VPN tradicional, confiando na verifica√ß√£o da confian√ßa do usu√°rio e do dispositivo antes de conceder acesso.
* **Policy Troubleshooter**: Uma ferramenta projetada para ajudar administradores a entender e resolver problemas de acesso em sua organiza√ß√£o, identificando por que um usu√°rio tem acesso a certos recursos ou por que o acesso foi negado, ajudando assim na aplica√ß√£o de pol√≠ticas de zero-trust.
* **Identity-Aware Proxy (IAP)**: Um servi√ßo que controla o acesso a aplica√ß√µes e VMs em nuvem executadas no Google Cloud, on-premises ou em outras nuvens, com base na identidade e no contexto da solicita√ß√£o, em vez da rede de onde a solicita√ß√£o se origina.
* **VPC Service Controls**: Per√≠metros de seguran√ßa que fornecem camadas adicionais de prote√ß√£o a recursos e servi√ßos hospedados na Nuvem Privada Virtual (VPC) do Google Cloud, prevenindo exfiltra√ß√£o de dados e fornecendo controle de acesso granular.
* **Access Context Manager**: Parte do BeyondCorp Enterprise do Google Cloud, esta ferramenta ajuda a definir e aplicar pol√≠ticas de controle de acesso detalhadas com base na identidade do usu√°rio e no contexto de sua solicita√ß√£o, como status de seguran√ßa do dispositivo, endere√ßo IP e mais.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
