# GCP - Security Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

Google Cloud Platform (GCP) å®‰å…¨æ€§æ¶µç›–äº†ä¸€å¥—**å…¨é¢çš„å·¥å…·**å’Œå®è·µï¼Œæ—¨åœ¨ç¡®ä¿ Google Cloud ç¯å¢ƒä¸­èµ„æºå’Œæ•°æ®çš„**å®‰å…¨æ€§**ï¼Œåˆ†ä¸ºå››ä¸ªä¸»è¦éƒ¨åˆ†ï¼š**å®‰å…¨æŒ‡æŒ¥ä¸­å¿ƒã€æ£€æµ‹ä¸æ§åˆ¶ã€æ•°æ®ä¿æŠ¤å’Œé›¶ä¿¡ä»»ã€‚**

## **å®‰å…¨æŒ‡æŒ¥ä¸­å¿ƒ**

Google Cloud Platform (GCP) å®‰å…¨æŒ‡æŒ¥ä¸­å¿ƒ (SCC) æ˜¯ä¸€ä¸ª**ç”¨äº GCP èµ„æºçš„å®‰å…¨å’Œé£é™©ç®¡ç†å·¥å…·**ï¼Œä½¿ç»„ç»‡èƒ½å¤Ÿè·å¾—å¯¹å…¶äº‘èµ„äº§çš„å¯è§æ€§å’Œæ§åˆ¶ã€‚å®ƒé€šè¿‡æä¾›å…¨é¢çš„å®‰å…¨åˆ†æã€**è¯†åˆ«é”™è¯¯é…ç½®**ã€ç¡®ä¿ä¸å®‰å…¨æ ‡å‡†çš„**åˆè§„æ€§**ä»¥åŠä¸å…¶ä»–å®‰å…¨å·¥å…·çš„**é›†æˆ**æ¥å¸®åŠ©**æ£€æµ‹å’Œå“åº”å¨èƒ**ã€‚

* **æ¦‚è¿°**ï¼šé¢æ¿ç”¨äº**å¯è§†åŒ–å®‰å…¨æŒ‡æŒ¥ä¸­å¿ƒçš„æ‰€æœ‰ç»“æœ**ã€‚
* å¨èƒï¼š\[éœ€è¦é«˜çº§ç‰ˆ] é¢æ¿ç”¨äºå¯è§†åŒ–æ‰€æœ‰**æ£€æµ‹åˆ°çš„å¨èƒã€‚æœ‰å…³å¨èƒçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä¸‹æ–¹**ã€‚
* **æ¼æ´**ï¼šé¢æ¿ç”¨äº**å¯è§†åŒ–åœ¨ GCP è´¦æˆ·ä¸­å‘ç°çš„é”™è¯¯é…ç½®**ã€‚
* **åˆè§„æ€§**ï¼š\[éœ€è¦é«˜çº§ç‰ˆ] æ­¤éƒ¨åˆ†å…è®¸**å¯¹æ‚¨çš„ GCP ç¯å¢ƒè¿›è¡Œå¤šä¸ªåˆè§„æ€§æ£€æŸ¥**ï¼ˆå¦‚ PCI-DSSã€NIST 800-53ã€CIS åŸºå‡†ç­‰ï¼‰ã€‚
* **èµ„äº§**ï¼šæ­¤éƒ¨åˆ†**æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„èµ„äº§**ï¼Œå¯¹ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆä¹Ÿè®¸æ˜¯æ”»å‡»è€…ï¼‰éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥åœ¨å•ä¸€é¡µé¢ä¸ŠæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å†…å®¹ã€‚
* **å‘ç°**ï¼šæ­¤éƒ¨åˆ†**æ±‡æ€»** GCP å®‰å…¨çš„ä¸åŒéƒ¨åˆ†ï¼ˆä¸ä»…ä»…æ˜¯æŒ‡æŒ¥ä¸­å¿ƒï¼‰çš„**å‘ç°**ï¼Œä»¥ä¾¿è½»æ¾å¯è§†åŒ–é‡è¦çš„å‘ç°ã€‚
* **æ¥æº**ï¼šæ˜¾ç¤º GCP å®‰å…¨çš„æ‰€æœ‰ä¸åŒéƒ¨åˆ†çš„**å‘ç°æ‘˜è¦**ã€‚
* **æ€åŠ¿**ï¼š\[éœ€è¦é«˜çº§ç‰ˆ] å®‰å…¨æ€åŠ¿å…è®¸**å®šä¹‰ã€è¯„ä¼°å’Œç›‘æ§ GCP ç¯å¢ƒçš„å®‰å…¨æ€§**ã€‚å®ƒé€šè¿‡åˆ›å»ºå®šä¹‰çº¦æŸæˆ–é™åˆ¶çš„æ”¿ç­–æ¥æ§åˆ¶/ç›‘æ§ GCP ä¸­çš„èµ„æºã€‚å¯ä»¥åœ¨ [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy) æ‰¾åˆ°å‡ ä¸ªé¢„å®šä¹‰çš„æ€åŠ¿æ¨¡æ¿ã€‚

### **å¨èƒ**

ä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œè¿™å¯èƒ½æ˜¯**æœ€æœ‰è¶£çš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒå¯ä»¥æ£€æµ‹åˆ°æ”»å‡»è€…**ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæ­¤åŠŸèƒ½éœ€è¦**é«˜çº§ç‰ˆ**ï¼ˆè¿™æ„å‘³ç€å…¬å¸éœ€è¦æ”¯ä»˜æ›´å¤šè´¹ç”¨ï¼‰ï¼Œå› æ­¤**å¯èƒ½ç”šè‡³æœªå¯ç”¨**ã€‚

æœ‰ä¸‰ç§ç±»å‹çš„å¨èƒæ£€æµ‹æœºåˆ¶ï¼š

* **äº‹ä»¶å¨èƒ**ï¼šé€šè¿‡æ ¹æ® Google å†…éƒ¨åˆ›å»ºçš„**è§„åˆ™**åŒ¹é…æ¥è‡ª**Cloud Logging**çš„äº‹ä»¶ç”Ÿæˆçš„å‘ç°ã€‚å®ƒè¿˜å¯ä»¥æ‰«æ**Google Workspace æ—¥å¿—**ã€‚
* å¯ä»¥åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ°æ‰€æœ‰[**æ£€æµ‹è§„åˆ™çš„æè¿°**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)ã€‚
* **å®¹å™¨å¨èƒ**ï¼šåœ¨åˆ†æå®¹å™¨å†…æ ¸çš„ä½çº§è¡Œä¸ºåç”Ÿæˆçš„å‘ç°ã€‚
* **è‡ªå®šä¹‰å¨èƒ**ï¼šç”±å…¬å¸åˆ›å»ºçš„è§„åˆ™ã€‚

å¯ä»¥åœ¨ [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response) æ‰¾åˆ°å¯¹ä¸¤ç§ç±»å‹æ£€æµ‹åˆ°çš„å¨èƒçš„æ¨èå“åº”ã€‚

### æšä¸¾

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### åæœŸåˆ©ç”¨

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## æ£€æµ‹ä¸æ§åˆ¶

* **Chronicle SecOps**ï¼šä¸€ä¸ªå…ˆè¿›çš„å®‰å…¨è¿è¥å¥—ä»¶ï¼Œæ—¨åœ¨å¸®åŠ©å›¢é˜Ÿæé«˜å®‰å…¨è¿è¥çš„é€Ÿåº¦å’Œå½±å“åŠ›ï¼ŒåŒ…æ‹¬å¨èƒæ£€æµ‹ã€è°ƒæŸ¥å’Œå“åº”ã€‚
* **reCAPTCHA Enterprise**ï¼šä¸€ç§æœåŠ¡ï¼Œé€šè¿‡åŒºåˆ†äººç±»ç”¨æˆ·å’Œæœºå™¨äººï¼Œä¿æŠ¤ç½‘ç«™å…å—æŠ“å–ã€å‡­è¯å¡«å……å’Œè‡ªåŠ¨æ”»å‡»ç­‰æ¬ºè¯ˆæ´»åŠ¨ã€‚
* **Web Security Scanner**ï¼šè‡ªåŠ¨åŒ–å®‰å…¨æ‰«æå·¥å…·ï¼Œæ£€æµ‹æ‰˜ç®¡åœ¨Google Cloudæˆ–å…¶ä»–ç½‘ç»œæœåŠ¡ä¸Šçš„Webåº”ç”¨ç¨‹åºä¸­çš„æ¼æ´å’Œå¸¸è§å®‰å…¨é—®é¢˜ã€‚
* **Risk Manager**ï¼šä¸€ä¸ªæ²»ç†ã€é£é™©å’Œåˆè§„ï¼ˆGRCï¼‰å·¥å…·ï¼Œå¸®åŠ©ç»„ç»‡è¯„ä¼°ã€è®°å½•å’Œç†è§£å…¶Google Cloudé£é™©çŠ¶å†µã€‚
* **Binary Authorization**ï¼šä¸€ç§å®¹å™¨å®‰å…¨æ§åˆ¶ï¼Œç¡®ä¿ä»…æ ¹æ®ä¼ä¸šè®¾å®šçš„æ”¿ç­–åœ¨Kubernetes Engineé›†ç¾¤ä¸Šéƒ¨ç½²å—ä¿¡ä»»çš„å®¹å™¨é•œåƒã€‚
* **Advisory Notifications**ï¼šä¸€ç§æœåŠ¡ï¼Œæä¾›æœ‰å…³æ½œåœ¨å®‰å…¨é—®é¢˜ã€æ¼æ´å’Œæ¨èæªæ–½çš„è­¦æŠ¥å’Œå»ºè®®ï¼Œä»¥ä¿æŒèµ„æºå®‰å…¨ã€‚
* **Access Approval**ï¼šä¸€ç§åŠŸèƒ½ï¼Œå…è®¸ç»„ç»‡åœ¨Googleå‘˜å·¥è®¿é—®å…¶æ•°æ®æˆ–é…ç½®ä¹‹å‰è¦æ±‚æ˜ç¡®æ‰¹å‡†ï¼Œæä¾›é¢å¤–çš„æ§åˆ¶å’Œå®¡è®¡å±‚ã€‚
* **Managed Microsoft AD**ï¼šä¸€ç§æä¾›æ‰˜ç®¡Microsoft Active Directoryï¼ˆADï¼‰çš„æœåŠ¡ï¼Œå…è®¸ç”¨æˆ·åœ¨Google Cloudä¸Šä½¿ç”¨ç°æœ‰çš„ä¾èµ–Microsoft ADçš„åº”ç”¨ç¨‹åºå’Œå·¥ä½œè´Ÿè½½ã€‚

## æ•°æ®ä¿æŠ¤

* **æ•æ„Ÿæ•°æ®ä¿æŠ¤**ï¼šæ—¨åœ¨ä¿æŠ¤æ•æ„Ÿæ•°æ®ï¼ˆå¦‚ä¸ªäººä¿¡æ¯æˆ–çŸ¥è¯†äº§æƒï¼‰å…å—æœªç»æˆæƒè®¿é—®æˆ–æ³„éœ²çš„å·¥å…·å’Œå®è·µã€‚
* **æ•°æ®ä¸¢å¤±é˜²æŠ¤ï¼ˆDLPï¼‰**ï¼šä¸€å¥—å·¥å…·å’Œæµç¨‹ï¼Œç”¨äºé€šè¿‡æ·±åº¦å†…å®¹æ£€æŸ¥å’Œåº”ç”¨å…¨é¢çš„æ•°æ®ä¿æŠ¤è§„åˆ™æ¥è¯†åˆ«ã€ç›‘æ§å’Œä¿æŠ¤ä½¿ç”¨ä¸­ã€ä¼ è¾“ä¸­å’Œé™æ€çš„æ•°æ®ã€‚
* **è¯ä¹¦æˆæƒæœåŠ¡**ï¼šä¸€ç§å¯æ‰©å±•å’Œå®‰å…¨çš„æœåŠ¡ï¼Œç®€åŒ–å’Œè‡ªåŠ¨åŒ–å†…éƒ¨å’Œå¤–éƒ¨æœåŠ¡çš„SSL/TLSè¯ä¹¦çš„ç®¡ç†ã€éƒ¨ç½²å’Œç»­è®¢ã€‚
* **å¯†é’¥ç®¡ç†**ï¼šä¸€ç§åŸºäºäº‘çš„æœåŠ¡ï¼Œå…è®¸æ‚¨ç®¡ç†åº”ç”¨ç¨‹åºçš„åŠ å¯†å¯†é’¥ï¼ŒåŒ…æ‹¬åŠ å¯†å¯†é’¥çš„åˆ›å»ºã€å¯¼å…¥ã€è½®æ¢ã€ä½¿ç”¨å’Œé”€æ¯ã€‚æ›´å¤šä¿¡æ¯è¯·å‚è§ï¼š

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **è¯ä¹¦ç®¡ç†å™¨**ï¼šä¸€ç§ç®¡ç†å’Œéƒ¨ç½²SSL/TLSè¯ä¹¦çš„æœåŠ¡ï¼Œç¡®ä¿ä¸æ‚¨çš„WebæœåŠ¡å’Œåº”ç”¨ç¨‹åºçš„å®‰å…¨å’ŒåŠ å¯†è¿æ¥ã€‚
* **ç§˜å¯†ç®¡ç†å™¨**ï¼šä¸€ç§å®‰å…¨ä¸”æ–¹ä¾¿çš„å­˜å‚¨ç³»ç»Ÿï¼Œç”¨äºAPIå¯†é’¥ã€å¯†ç ã€è¯ä¹¦å’Œå…¶ä»–æ•æ„Ÿæ•°æ®ï¼Œå…è®¸åœ¨åº”ç”¨ç¨‹åºä¸­è½»æ¾å’Œå®‰å…¨åœ°è®¿é—®å’Œç®¡ç†è¿™äº›ç§˜å¯†ã€‚æ›´å¤šä¿¡æ¯è¯·å‚è§ï¼š

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## é›¶ä¿¡ä»»

* **BeyondCorp Enterprise**ï¼šä¸€ç§é›¶ä¿¡ä»»å®‰å…¨å¹³å°ï¼Œå…è®¸å®‰å…¨è®¿é—®å†…éƒ¨åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€ä¼ ç»ŸVPNï¼Œé€šè¿‡åœ¨æˆäºˆè®¿é—®æƒé™ä¹‹å‰éªŒè¯ç”¨æˆ·å’Œè®¾å¤‡çš„ä¿¡ä»»ã€‚
* **Policy Troubleshooter**ï¼šä¸€ç§å·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©ç®¡ç†å‘˜ç†è§£å’Œè§£å†³ç»„ç»‡ä¸­çš„è®¿é—®é—®é¢˜ï¼Œé€šè¿‡è¯†åˆ«ç”¨æˆ·ä¸ºä½•å¯ä»¥è®¿é—®æŸäº›èµ„æºæˆ–ä¸ºä½•è®¿é—®è¢«æ‹’ç»ï¼Œä»è€Œå¸®åŠ©æ‰§è¡Œé›¶ä¿¡ä»»æ”¿ç­–ã€‚
* **èº«ä»½æ„ŸçŸ¥ä»£ç†ï¼ˆIAPï¼‰**ï¼šä¸€ç§æœåŠ¡ï¼Œæ ¹æ®è¯·æ±‚çš„èº«ä»½å’Œä¸Šä¸‹æ–‡æ§åˆ¶å¯¹åœ¨Google Cloudã€å†…éƒ¨æˆ–å…¶ä»–äº‘ä¸Šè¿è¡Œçš„äº‘åº”ç”¨ç¨‹åºå’Œè™šæ‹Ÿæœºçš„è®¿é—®ï¼Œè€Œä¸æ˜¯æ ¹æ®è¯·æ±‚æ¥æºçš„ç½‘ç»œã€‚
* **VPCæœåŠ¡æ§åˆ¶**ï¼šä¸ºæ‰˜ç®¡åœ¨Google Cloudè™šæ‹Ÿç§æœ‰äº‘ï¼ˆVPCï¼‰ä¸­çš„èµ„æºå’ŒæœåŠ¡æä¾›é¢å¤–ä¿æŠ¤å±‚çš„å®‰å…¨è¾¹ç•Œï¼Œé˜²æ­¢æ•°æ®å¤–æ³„å¹¶æä¾›ç»†ç²’åº¦è®¿é—®æ§åˆ¶ã€‚
* **è®¿é—®ä¸Šä¸‹æ–‡ç®¡ç†å™¨**ï¼šä½œä¸ºGoogle Cloudçš„BeyondCorp Enterpriseçš„ä¸€éƒ¨åˆ†ï¼Œè¯¥å·¥å…·å¸®åŠ©æ ¹æ®ç”¨æˆ·çš„èº«ä»½å’Œè¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼ˆå¦‚è®¾å¤‡å®‰å…¨çŠ¶æ€ã€IPåœ°å€ç­‰ï¼‰å®šä¹‰å’Œæ‰§è¡Œç»†ç²’åº¦è®¿é—®æ§åˆ¶æ”¿ç­–ã€‚

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µAWSé»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µGCPé»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass)æˆ–**åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHubåº“æäº¤PRåˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
