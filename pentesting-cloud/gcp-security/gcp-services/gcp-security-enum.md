# GCP - Security Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

La s√©curit√© de Google Cloud Platform (GCP) englobe une **suite compl√®te d'outils** et de pratiques con√ßues pour garantir la **s√©curit√©** des ressources et des donn√©es au sein de l'environnement Google Cloud, divis√©e en quatre sections principales : **Centre de Commande de S√©curit√©, D√©tections et Contr√¥les, Protection des Donn√©es et Zero Trust.**

## **Centre de Commande de S√©curit√©**

Le Centre de Commande de S√©curit√© de Google Cloud Platform (GCP) est un **outil de gestion de la s√©curit√© et des risques pour les ressources GCP** qui permet aux organisations d'obtenir une visibilit√© et un contr√¥le sur leurs actifs cloud. Il aide √† **d√©tecter et r√©pondre aux menaces** en offrant des analyses de s√©curit√© compl√®tes, **en identifiant les erreurs de configuration**, en garantissant la **conformit√©** aux normes de s√©curit√©, et en **s'int√©grant** √† d'autres outils de s√©curit√© pour la d√©tection et la r√©ponse automatis√©es aux menaces.

* **Aper√ßu** : Panneau pour **visualiser un aper√ßu** de tous les r√©sultats du Centre de Commande de S√©curit√©.
* Menaces : \[Premium Requis] Panneau pour visualiser toutes les **menaces d√©tect√©es. Consultez plus d'informations sur les Menaces ci-dessous**
* **Vuln√©rabilit√©s** : Panneau pour **visualiser les erreurs de configuration trouv√©es dans le compte GCP**.
* **Conformit√©** : \[Premium requis] Cette section permet de **tester votre environnement GCP contre plusieurs v√©rifications de conformit√©** (telles que PCI-DSS, NIST 800-53, benchmarks CIS...) sur l'organisation.
* **Actifs** : Cette section **montre tous les actifs utilis√©s**, tr√®s utile pour les administrateurs syst√®me (et peut-√™tre les attaquants) pour voir ce qui fonctionne sur une seule page.
* **Constatations** : Cela **agr√®ge** dans un **tableau les constatations** des diff√©rentes sections de la s√©curit√© GCP (pas seulement le Centre de Commande) pour pouvoir visualiser facilement les constatations importantes.
* **Sources** : Montre un **r√©sum√© des constatations** de toutes les diff√©rentes sections de la s√©curit√© GCP **par section**.
* **Posture** : \[Premium Requis] La Posture de S√©curit√© permet de **d√©finir, √©valuer et surveiller la s√©curit√© de l'environnement GCP**. Elle fonctionne en cr√©ant une politique qui d√©finit des contraintes ou des restrictions qui contr√¥lent/surveillent les ressources dans GCP. Il existe plusieurs mod√®les de posture pr√©d√©finis qui peuvent √™tre trouv√©s sur [https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy](https://cloud.google.com/security-command-center/docs/security-posture-overview?authuser=2#predefined-policy)

### **Menaces**

Du point de vue d'un attaquant, c'est probablement la **fonctionnalit√© la plus int√©ressante car elle pourrait d√©tecter l'attaquant**. Cependant, notez que cette fonctionnalit√© n√©cessite un **Premium** (ce qui signifie que l'entreprise devra payer plus), donc elle **pourrait m√™me ne pas √™tre activ√©e**.

Il existe 3 types de m√©canismes de d√©tection des menaces :

* **Menaces d'√âv√©nements** : Constatations produites par la correspondance d'√©v√©nements provenant de **Cloud Logging** bas√©s sur des **r√®gles cr√©√©es** en interne par Google. Il peut √©galement analyser les **journaux de Google Workspace**.
* Il est possible de trouver la description de toutes les [**r√®gles de d√©tection dans la documentation**](https://cloud.google.com/security-command-center/docs/concepts-event-threat-detection-overview?authuser=2#how\_works)
* **Menaces de Conteneurs** : Constatations produites apr√®s avoir analys√© le comportement de bas niveau du noyau des conteneurs.
* **Menaces Personnalis√©es** : R√®gles cr√©√©es par l'entreprise.

Il est possible de trouver des r√©ponses recommand√©es aux menaces d√©tect√©es des deux types sur [https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response](https://cloud.google.com/security-command-center/docs/how-to-investigate-threats?authuser=2#event\_response)

### Enumeration

{% code overflow="wrap" %}
```bash
# Get a source
gcloud scc sources describe <org-number> --source=5678
## If the response is that the service is disabled or that the source is not found, then, it isn't enabled

# Get notifications
gcloud scc notifications list <org-number>

# Get findings (if not premium these are just vulnerabilities)
gcloud scc findings list <org-number>
```
{% endcode %}

### Post Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-security-post-exploitation.md" %}
[gcp-security-post-exploitation.md](../gcp-post-exploitation/gcp-security-post-exploitation.md)
{% endcontent-ref %}

## D√©tections et Contr√¥les

* **Chronicle SecOps** : Une suite avanc√©e d'op√©rations de s√©curit√© con√ßue pour aider les √©quipes √† augmenter leur rapidit√© et leur impact dans les op√©rations de s√©curit√©, y compris la d√©tection des menaces, l'investigation et la r√©ponse.
* **reCAPTCHA Enterprise** : Un service qui prot√®ge les sites web contre les activit√©s frauduleuses telles que le scraping, le credential stuffing et les attaques automatis√©es en distinguant les utilisateurs humains des bots.
* **Web Security Scanner** : Outil de scan de s√©curit√© automatis√© qui d√©tecte les vuln√©rabilit√©s et les probl√®mes de s√©curit√© courants dans les applications web h√©berg√©es sur Google Cloud ou un autre service web.
* **Risk Manager** : Un outil de gouvernance, de risque et de conformit√© (GRC) qui aide les organisations √† √©valuer, documenter et comprendre leur posture de risque sur Google Cloud.
* **Binary Authorization** : Un contr√¥le de s√©curit√© pour les conteneurs qui garantit que seules des images de conteneurs de confiance sont d√©ploy√©es sur les clusters Kubernetes Engine selon les politiques d√©finies par l'entreprise.
* **Advisory Notifications** : Un service qui fournit des alertes et des avis sur les probl√®mes de s√©curit√© potentiels, les vuln√©rabilit√©s et les actions recommand√©es pour maintenir les ressources s√©curis√©es.
* **Access Approval** : Une fonctionnalit√© qui permet aux organisations d'exiger une approbation explicite avant que les employ√©s de Google puissent acc√©der √† leurs donn√©es ou configurations, fournissant une couche suppl√©mentaire de contr√¥le et d'auditabilit√©.
* **Managed Microsoft AD** : Un service offrant un Active Directory (AD) Microsoft g√©r√© qui permet aux utilisateurs d'utiliser leurs applications et charges de travail d√©pendantes de Microsoft AD existantes sur Google Cloud.

## Protection des Donn√©es

* **Protection des Donn√©es Sensibles** : Outils et pratiques visant √† prot√©ger les donn√©es sensibles, telles que les informations personnelles ou la propri√©t√© intellectuelle, contre l'acc√®s ou l'exposition non autoris√©s.
* **Data Loss Prevention (DLP)** : Un ensemble d'outils et de processus utilis√©s pour identifier, surveiller et prot√©ger les donn√©es en cours d'utilisation, en mouvement et au repos gr√¢ce √† une inspection approfondie du contenu et en appliquant un ensemble complet de r√®gles de protection des donn√©es.
* **Certificate Authority Service** : Un service √©volutif et s√©curis√© qui simplifie et automatise la gestion, le d√©ploiement et le renouvellement des certificats SSL/TLS pour les services internes et externes.
* **Key Management** : Un service bas√© sur le cloud qui vous permet de g√©rer les cl√©s cryptographiques pour vos applications, y compris la cr√©ation, l'importation, la rotation, l'utilisation et la destruction des cl√©s de chiffrement. Plus d'infos dans :

{% content-ref url="gcp-kms-enum.md" %}
[gcp-kms-enum.md](gcp-kms-enum.md)
{% endcontent-ref %}

* **Certificate Manager** : Un service qui g√®re et d√©ploie des certificats SSL/TLS, garantissant des connexions s√©curis√©es et chiffr√©es √† vos services et applications web.
* **Secret Manager** : Un syst√®me de stockage s√©curis√© et pratique pour les cl√©s API, les mots de passe, les certificats et d'autres donn√©es sensibles, qui permet un acc√®s et une gestion faciles et s√©curis√©s de ces secrets dans les applications. Plus d'infos dans :

{% content-ref url="gcp-secrets-manager-enum.md" %}
[gcp-secrets-manager-enum.md](gcp-secrets-manager-enum.md)
{% endcontent-ref %}

## Zero Trust

* **BeyondCorp Enterprise** : Une plateforme de s√©curit√© zero-trust qui permet un acc√®s s√©curis√© aux applications internes sans avoir besoin d'un VPN traditionnel, en s'appuyant sur la v√©rification de la confiance de l'utilisateur et de l'appareil avant d'accorder l'acc√®s.
* **Policy Troubleshooter** : Un outil con√ßu pour aider les administrateurs √† comprendre et √† r√©soudre les probl√®mes d'acc√®s dans leur organisation en identifiant pourquoi un utilisateur a acc√®s √† certaines ressources ou pourquoi l'acc√®s a √©t√© refus√©, aidant ainsi √† l'application des politiques zero-trust.
* **Identity-Aware Proxy (IAP)** : Un service qui contr√¥le l'acc√®s aux applications cloud et aux VM fonctionnant sur Google Cloud, sur site ou sur d'autres clouds, en fonction de l'identit√© et du contexte de la demande plut√¥t que du r√©seau d'o√π provient la demande.
* **VPC Service Controls** : P√©rim√®tres de s√©curit√© qui fournissent des couches de protection suppl√©mentaires aux ressources et services h√©berg√©s dans le Virtual Private Cloud (VPC) de Google Cloud, emp√™chant l'exfiltration de donn√©es et fournissant un contr√¥le d'acc√®s granulaire.
* **Access Context Manager** : Partie de BeyondCorp Enterprise de Google Cloud, cet outil aide √† d√©finir et √† appliquer des politiques de contr√¥le d'acc√®s granulaires bas√©es sur l'identit√© d'un utilisateur et le contexte de sa demande, tel que l'√©tat de s√©curit√© de l'appareil, l'adresse IP, et plus encore.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
