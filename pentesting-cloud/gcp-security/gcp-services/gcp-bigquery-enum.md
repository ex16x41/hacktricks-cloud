# GCP - Bigquery Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Google Cloud BigQuery —î **–ø–æ–≤–Ω—ñ—Å—Ç—é –∫–µ—Ä–æ–≤–∞–Ω–∏–º, –±–µ–∑—Å–µ—Ä–≤–µ—Ä–Ω–∏–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏–º —Å—Ö–æ–≤–∏—â–µ–º –¥–∞–Ω–∏—Ö**, —â–æ –ø—Ä–æ–ø–æ–Ω—É—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è **–∞–Ω–∞–ª—ñ–∑—É –ø–µ—Ç–∞–±–∞–π—Ç—ñ–≤** –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–æ–±–ª—è—é—á–∏ –≤–µ–ª–∏–∫—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö. –Ø–∫ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —è–∫ –ø–æ—Å–ª—É–≥–∞ (PaaS), –≤–æ–Ω–∞ –Ω–∞–¥–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–∞–Ω–∏–º–∏ –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ —Ä—É—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é.

–í–æ–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∑–∞–ø–∏—Ç–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º **ANSI SQL**. –û—Å–Ω–æ–≤–Ω–∏–º–∏ –æ–±'—î–∫—Ç–∞–º–∏ —î **–Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö**, —â–æ –º—ñ—Å—Ç—è—Ç—å **—Ç–∞–±–ª–∏—Ü—ñ**, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å SQL **–¥–∞–Ω—ñ**.

### Encryption

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **–∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, –∫–µ—Ä–æ–≤–∞–Ω–∏–π Google**, —Ö–æ—á–∞ –º–æ–∂–ª–∏–≤–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ **–∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, –∫–µ—Ä–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç–æ–º (CMEK)**. –ú–æ–∂–ª–∏–≤–æ –≤–∫–∞–∑–∞—Ç–∏ –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö —ñ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö.

### Expiration

–ú–æ–∂–ª–∏–≤–æ –≤–∫–∞–∑–∞—Ç–∏ **—á–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö**, —Ç–æ–º—É –±—É–¥—å-—è–∫–∞ –Ω–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è, —Å—Ç–≤–æ—Ä–µ–Ω–∞ –≤ —Ü—å–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö, –±—É–¥–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–∞** —á–µ—Ä–µ–∑ –≤–∫–∞–∑–∞–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è.

### External Sources

Bigquery –≥–ª–∏–±–æ–∫–æ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∏–π –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ Google. –ú–æ–∂–ª–∏–≤–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑ –±–∞–∫–µ—Ç—ñ–≤, pub/sub, google drive, –±–∞–∑ –¥–∞–Ω–∏—Ö RDS...

### Dataset ACLs

–ö–æ–ª–∏ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –¥–æ –Ω—å–æ–≥–æ **–¥–æ–¥–∞—é—Ç—å—Å—è ACL**, —â–æ–± –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω—å–æ–≥–æ. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–∞–¥–∞—é—Ç—å—Å—è **–ø—Ä–∞–≤–∞ –≤–ª–∞—Å–Ω–∏–∫–∞** –¥–ª—è **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —Å—Ç–≤–æ—Ä–∏–≤** –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –∞ –ø–æ—Ç—ñ–º **–≤–ª–∞—Å–Ω–∏–∫—É** –≥—Ä—É–ø–∏ **projectOwners** (–≤–ª–∞—Å–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç—É), **–ø–∏—Å—å–º–µ–Ω–Ω–∏–∫—É** –≥—Ä—É–ø–∏ **projectWriters** —Ç–∞ **—á–∏—Ç–∞—á—É** –≥—Ä—É–ø–∏ **projectReaders**:
```bash
bq show --format=prettyjson <proj>:<dataset>

...
"access": [
{
"role": "WRITER",
"specialGroup": "projectWriters"
},
{
"role": "OWNER",
"specialGroup": "projectOwners"
},
{
"role": "OWNER",
"userByEmail": "gcp-admin@hacktricks.xyz"
},
{
"role": "OWNER",
"userByEmail": "support@hacktricks.xyz"
},
{
"role": "READER",
"specialGroup": "projectReaders"
}
],
...
```
### Table Rows Control Access

–ú–æ–∂–ª–∏–≤–æ **–∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ä—è–¥–∫–∏, –¥–æ —è–∫–∏—Ö —Å—É–±'—î–∫—Ç –∑–º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–æ–ª—ñ—Ç–∏–∫ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ä—è–¥–∫—ñ–≤. –í–æ–Ω–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [**DDL**](https://cloud.google.com/bigquery/docs/reference/standard-sql/data-definition-language#create\_row\_access\_policy\_statement).\
–ü–æ–ª—ñ—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø—É –≤–∏–∑–Ω–∞—á–∞—î —Ñ—ñ–ª—å—Ç—Ä, —ñ **—Ç—ñ–ª—å–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —Ä—è–¥–∫–∏** –∑ —Ü–∏–º —Ñ—ñ–ª—å—Ç—Ä–æ–º –±—É–¥—É—Ç—å **–¥–æ—Å—Ç—É–ø–Ω—ñ** –≤–∫–∞–∑–∞–Ω–∏–º —Å—É–±'—î–∫—Ç–∞–º.
```sql
# Create
CREATE ROW ACCESS POLICY apac_filter
ON project.dataset.my_table
GRANT TO ('user:abc@example.com')
FILTER USING (region = 'APAC');

# Update
CREATE OR REPLACE ROW ACCESS POLICY
CREATE ROW ACCESS POLICY sales_us_filter
ON project.dataset.my_table
GRANT TO ('user:john@example.com',
'group:sales-us@example.com',
'group:sales-managers@example.com')
FILTER USING (region = 'US');

# Check the Post Exploitation tricks to see how to call this from the cli
```

```bash
# Enumerate row policies on a table
bq ls --row_access_policies <proj>:<dataset>.<table> # Get row policies
```
### Columns Access Control

<figure><img src="../../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

–©–æ–± –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–∞–Ω–∏—Ö –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ–≤:

1. **–í–∏–∑–Ω–∞—á—Ç–µ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—é —Ç–∞ –ø–æ–ª—ñ—Ç–∏—á–Ω—ñ —Ç–µ–≥–∏**. –°—Ç–≤–æ—Ä—ñ—Ç—å —ñ –∫–µ—Ä—É–π—Ç–µ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—î—é —Ç–∞ –ø–æ–ª—ñ—Ç–∏—á–Ω–∏–º–∏ —Ç–µ–≥–∞–º–∏ –¥–ª—è –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö. [https://console.cloud.google.com/bigquery/policy-tags](https://console.cloud.google.com/bigquery/policy-tags)
2. –ó–∞ –±–∞–∂–∞–Ω–Ω—è–º: –Ω–∞–¥–∞–π—Ç–µ **—Ä–æ–ª—å —á–∏—Ç–∞—á–∞ –∑ —Ç–æ–Ω–∫–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–∞–Ω–∏—Ö Data Catalog –æ–¥–Ω–æ–º—É –∞–±–æ –∫—ñ–ª—å–∫–æ–º –æ—Å–æ–±–∞–º** –Ω–∞ –æ–¥–Ω–æ–º—É –∞–±–æ –∫—ñ–ª—å–∫–æ—Ö –ø–æ–ª—ñ—Ç–∏—á–Ω–∏—Ö —Ç–µ–≥–∞—Ö, —è–∫—ñ –≤–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏.
3. **–ü—Ä–∏–∑–Ω–∞—á—Ç–µ –ø–æ–ª—ñ—Ç–∏—á–Ω—ñ —Ç–µ–≥–∏ —Å–≤–æ—ó–º —Å—Ç–æ–≤–ø—Ü—è–º BigQuery**. –£ BigQuery –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞–Ω–æ—Ç–∞—Ü—ñ—ó —Å—Ö–µ–º–∏, —â–æ–± –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –ø–æ–ª—ñ—Ç–∏—á–Ω–∏–π —Ç–µ–≥ –∫–æ–∂–Ω–æ–º—É —Å—Ç–æ–≤–ø—Ü—é, –¥–æ —è–∫–æ–≥–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø.
4. **–ó–∞–±–µ–∑–ø–µ—á—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É –Ω–∞ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—ó**. –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –æ–±–º–µ–∂–µ–Ω—å –¥–æ—Å—Ç—É–ø—É, –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –¥–ª—è –≤—Å—ñ—Ö –ø–æ–ª—ñ—Ç–∏—á–Ω–∏—Ö —Ç–µ–≥—ñ–≤ —É —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—ó.
5. **–ö–µ—Ä—É–π—Ç–µ –¥–æ—Å—Ç—É–ø–æ–º –¥–æ –ø–æ–ª—ñ—Ç–∏—á–Ω–∏—Ö —Ç–µ–≥—ñ–≤**. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [Identity and Access Management](https://cloud.google.com/iam) (IAM) –ø–æ–ª—ñ—Ç–∏–∫–∏, —â–æ–± –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–∂–Ω–æ–≥–æ –ø–æ–ª—ñ—Ç–∏—á–Ω–æ–≥–æ —Ç–µ–≥—É. –ü–æ–ª—ñ—Ç–∏–∫–∞ –¥—ñ—î –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å—Ç–æ–≤–ø—Ü—è, —â–æ –Ω–∞–ª–µ–∂–∏—Ç—å –¥–æ –ø–æ–ª—ñ—Ç–∏—á–Ω–æ–≥–æ —Ç–µ–≥—É.

–ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–∞–Ω–∏—Ö —Å—Ç–æ–≤–ø—Ü—è –ø—ñ–¥ —á–∞—Å –∑–∞–ø–∏—Ç—É, BigQuery **–ø–µ—Ä–µ–≤—ñ—Ä—è—î –ø–æ–ª—ñ—Ç–∏—á–Ω–∏–π —Ç–µ–≥ —Å—Ç–æ–≤–ø—Ü—è —Ç–∞ –π–æ–≥–æ –ø–æ–ª—ñ—Ç–∏–∫—É, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –º–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—Ä–∞–≤–æ –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ –¥–∞–Ω–∏—Ö**.

{% hint style="success" %}
–£ –ø—ñ–¥—Å—É–º–∫—É, —â–æ–± –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–µ—è–∫–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤ –¥–ª—è –¥–µ—è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ–¥–∞—Ç–∏ —Ç–µ–≥ –¥–æ —Å—Ç–æ–≤–ø—Ü—è –≤ —Å—Ö–µ–º—ñ —Ç–∞ –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–æ —Ç–µ–≥—É, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É –Ω–∞ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—ó —Ç–µ–≥—É.
{% endhint %}

–©–æ–± –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É –Ω–∞ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—ó, –ø–æ—Ç—Ä—ñ–±–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Å–µ—Ä–≤—ñ—Å:
```bash
gcloud services enable bigquerydatapolicy.googleapis.com
```
–ú–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ —Ç–µ–≥–∏ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:

{% code overflow="wrap" %}
```bash
bq show --schema <proj>:<dataset>.<table>

[{"name":"username","type":"STRING","mode":"NULLABLE","policyTags":{"names":["projects/.../locations/us/taxonomies/2030629149897327804/policyTags/7703453142914142277"]},"maxLength":"20"},{"name":"age","type":"INTEGER","mode":"NULLABLE"}]
```
{% endcode %}

### –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

{% code overflow="wrap" %}
```bash
# Dataset info
bq ls # List datasets
bq ls -a # List all datasets (even hidden)
bq ls <proj>:<dataset> # List tables in a dataset
bq show --format=prettyjson <proj>:<dataset> # Get info about the dataset (like ACLs)

# Tables info
bq show --format=prettyjson <proj>:<dataset>.<table> # Get table info
bq show --schema <proj>:<dataset>.<table>  # Get schema of a table

# Get entries from the table
bq head <dataset>.<table>
bq query --nouse_legacy_sql 'SELECT * FROM `<proj>.<dataset>.<table-name>` LIMIT 1000'
bq extract <dataset>.<table> "gs://<bucket>/table*.csv" # Use the * so it can dump everything in different files

# Insert data
bq query --nouse_legacy_sql 'INSERT INTO `digital-bonfire-410512.importeddataset.tabletest` (rank, refresh_date, dma_name, dma_id, term, week, score) VALUES (22, "2023-12-28", "Baltimore MD", 512, "Ms", "2019-10-13", 62), (22, "2023-12-28", "Baltimore MD", 512, "Ms", "2020-05-24", 67)'
bq insert dataset.table /tmp/mydata.json

# Get permissions
bq get-iam-policy <proj>:<dataset> # Get dataset IAM policy
bq show --format=prettyjson <proj>:<dataset> # Get dataset ACLs
bq get-iam-policy <proj>:<dataset>.<table> # Get table IAM policy
bq ls --row_access_policies <proj>:<dataset>.<table> # Get row policies

# Taxonomies (Get the IDs from the shemas of the tables)
gcloud data-catalog taxonomies describe <taxonomi-ID> --location=<location>
gcloud data-catalog taxonomies list --location <location> #Find more
gcloud data-catalog taxonomies get-iam-policy <taxonomi-ID> --location=<location>

# Get jobs executed
bq ls --jobs=true --all=true
bq show --location=<location> show --format=prettyjson --job=true <job-id>

# Misc
bq show --encryption_service_account # Get encryption service account
```
{% endcode %}

### BigQuery SQL Injection

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–ª–æ–≥: [https://ozguralp.medium.com/bigquery-sql-injection-cheat-sheet-65ad70e11eac](https://ozguralp.medium.com/bigquery-sql-injection-cheat-sheet-65ad70e11eac). –¢—É—Ç –±—É–¥—É—Ç—å –Ω–∞–¥–∞–Ω—ñ –ª–∏—à–µ –¥–µ—è–∫—ñ –¥–µ—Ç–∞–ª—ñ.

**–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ**:

* `select 1#from here it is not working`
* `select 1/*between those it is not working*/` –ê–ª–µ –ª–∏—à–µ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –Ω–µ —Å–ø—Ä–∞—Ü—é—î
* `select 1--from here it is not working`

–û—Ç—Ä–∏–º–∞—Ç–∏ **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é** –ø—Ä–æ **—Å–µ—Ä–µ–¥–æ–≤–∏—â–µ**, —Ç–∞–∫—É —è–∫:

* –ü–æ—Ç–æ—á–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á: `select session_user()`
* –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç—É: `select @@project_id`

–û–±'—î–¥–Ω–∞—Ç–∏ —Ä—è–¥–∫–∏:

* –£—Å—ñ –Ω–∞–∑–≤–∏ —Ç–∞–±–ª–∏—Ü—å: `string_agg(table_name, ', ')`

–û—Ç—Ä–∏–º–∞—Ç–∏ **–Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö**, **—Ç–∞–±–ª–∏—Ü—ñ** —Ç–∞ **—ñ–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫**:

* **–ù–∞–∑–≤–∞ –ø—Ä–æ–µ–∫—Ç—É** —Ç–∞ **–Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö**:

{% code overflow="wrap" %}
```sql
SELECT catalog_name, schema_name FROM INFORMATION_SCHEMA.SCHEMATA
```
{% endcode %}

* **–ù–∞–∑–≤–∏** —Å—Ç–æ–≤–ø—Ü—ñ–≤ —Ç–∞ **—Ç–∞–±–ª–∏—Ü—å** **–≤—Å—ñ—Ö —Ç–∞–±–ª–∏—Ü—å** –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö:

{% code overflow="wrap" %}
```sql
# SELECT table_name, column_name FROM <proj-name>.<dataset-name>.INFORMATION_SCHEMA.COLUMNS

SELECT table_name, column_name FROM <project-name>.<dataset-name>.INFORMATION_SCHEMA.COLUMNS
```
{% endcode %}

* **–Ü–Ω—à—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö** –≤ —Ç–æ–º—É –∂ –ø—Ä–æ–µ–∫—Ç—ñ:

{% code overflow="wrap" %}
```sql
#¬†SELECT catalog_name, schema_name, FROM <proj-name>.INFORMATION_SCHEMA.SCHEMATA

SELECT catalog_name, schema_name, NULL FROM <project-name>.INFORMATION_SCHEMA.SCHEMATA
```
{% endcode %}

**–¢–∏–ø–∏ SQL-—ñ–Ω'—î–∫—Ü—ñ–π:**

* –ù–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫ - –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è: `select CAST(@@project_id AS INT64)`
* –ù–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫ - –¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ –Ω—É–ª—å: `' OR if(1/(length((select('a')))-1)=1,true,false) OR '`
* –ù–∞ –æ—Å–Ω–æ–≤—ñ –æ–±'—î–¥–Ω–∞–Ω–Ω—è (–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ ALL —É bigquery): `UNION ALL SELECT (SELECT @@project_id),1,1,1,1,1,1)) AS T1 GROUP BY column_name#`
* –ù–∞ –æ—Å–Ω–æ–≤—ñ –±—É–ª–µ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å: ``' WHERE SUBSTRING((select column_name from `project_id.dataset_name.table_name` limit 1),1,1)='A'#``
* –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—É - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥: ``SELECT * FROM `bigquery-public-data.covid19_open_data.covid19_open_data` LIMIT 1000``

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:**

* –£—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó: [https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators](https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators)
* –°–∫—Ä–∏–ø—Ç–æ–≤—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏: [https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting](https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting)

### –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —Ç–∞ –ø–æ—Å—Ç–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

{% content-ref url="../gcp-privilege-escalation/gcp-bigquery-privesc.md" %}
[gcp-bigquery-privesc.md](../gcp-privilege-escalation/gcp-bigquery-privesc.md)
{% endcontent-ref %}

### –ü–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å

{% content-ref url="../gcp-persistence/gcp-bigquery-persistence.md" %}
[gcp-bigquery-persistence.md](../gcp-persistence/gcp-bigquery-persistence.md)
{% endcontent-ref %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://cloud.google.com/bigquery/docs/column-level-security-intro](https://cloud.google.com/bigquery/docs/column-level-security-intro)

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
