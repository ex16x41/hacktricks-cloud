# GCP - Artifact Registry Enum

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Google Cloud Artifact Registry ni huduma inayosimamiwa kikamilifu inayokuruhusu **kusimamia, kuhifadhi, na kulinda artefaki zako za programu**. Kimsingi ni hazina ya **kuhifadhi utegemezi wa ujenzi**, kama vile **Docker** picha, **Maven**, pakiti za npm, na aina nyingine za artefaki. Inatumika **kawaida katika mipangilio ya CI/CD** kwa ajili ya kuhifadhi na kuandika toleo la artefaki zinazozalishwa wakati wa mchakato wa maendeleo ya programu.

Vipengele muhimu vya Artifact Registry ni pamoja na:

1. **Hifadhi Iliyounganishwa**: Inasaidia **aina nyingi za artefaki**, ikikuruhusu kuwa na hazina moja kwa picha za Docker, pakiti za lugha (kama Maven ya Java, npm ya Node.js), na aina nyingine za artefaki, ikiruhusu udhibiti wa ufikiaji wa kawaida na mtazamo uliounganishwa katika artefaki zako zote.
2. **Imesimamiwa Kikamilifu**: Kama huduma inayosimamiwa, inashughulikia miundombinu ya msingi, kupanua, na usalama, ikipunguza mzigo wa matengenezo kwa watumiaji.
3. **Udhibiti wa Ufikiaji wa Kina**: Inajumuisha na Usimamizi wa Utambulisho na Ufikiaji wa Google Cloud (IAM), ikikuruhusu kufafanua nani anaweza kufikia, kupakia, au kupakua artefaki katika hazina zako.
4. **Urejeleaji wa Kijiografia**: Inasaidia urejeleaji wa artefaki katika maeneo mengi, ikiboresha kasi ya upakuaji na kuhakikisha upatikanaji.
5. **Ushirikiano na Huduma za Google Cloud**: Inafanya kazi bila mshono na **huduma nyingine za GCP kama Cloud Build, Kubernetes Engine, na Compute Engine**, ikifanya kuwa chaguo rahisi kwa timu zinazofanya kazi ndani ya mfumo wa Google Cloud.
6. **Usalama**: Inatoa vipengele kama **uchambuzi wa udhaifu na uchambuzi wa kontena** kusaidia kuhakikisha kuwa artefaki zilizohifadhiwa ni salama na hazina matatizo ya usalama yanayojulikana.

### Formats and Modes

Unapounda hazina mpya, inawezekana **kuchagua muundo/aina** ya hazina kati ya kadhaa kama Docker, Maven, npm, Python... na hali ambayo kawaida inaweza kuwa moja ya hizi tatu:

* **Hifadhi ya Kawaida**: Hali ya chaguo-msingi kwa **kuhifadhi artefaki zako mwenyewe** (kama picha za Docker, pakiti za Maven) moja kwa moja katika GCP. Ni salama, inapanuka, na inajumuika vizuri ndani ya mfumo wa Google Cloud.
* **Hifadhi ya Mbali** (ikiwa inapatikana): Inafanya kazi kama proxy kwa **kuficha artefaki kutoka kwa hazina za umma za nje**. Inasaidia kuzuia matatizo kutokana na utegemezi kubadilika juu na inapunguza ucheleweshaji kwa kuficha artefaki zinazopatikana mara kwa mara.
* **Hifadhi ya Kijadi** (ikiwa inapatikana): Inatoa **kiwango kimoja cha ufikiaji wa hazina nyingi (za kawaida au za mbali)** kupitia kiunganishi kimoja, ikirahisisha usanidi wa upande wa mteja na usimamizi wa ufikiaji wa artefaki zilizotawanyika katika hazina mbalimbali.
* Kwa hifadhi ya kijadi utahitaji **kuchagua hazina na kuwapa kipaumbele** (hifadhi yenye kipaumbele kikubwa itatumika).
* Unaweza **kuchanganya hazina za mbali na za kawaida** katika **hifadhi ya kijadi**, ikiwa **kipaumbele** cha **mbali** ni **kikubwa** kuliko cha kawaida, **pakiti kutoka mbali (kama PyPi kwa mfano) zitatumika**. Hii inaweza kusababisha **Kuchanganyikiwa kwa Utegemezi.**

Kumbuka kwamba katika **toleo la Mbali la Docker** inawezekana kutoa jina la mtumiaji na tokeni ili kufikia Docker Hub. **Tokeni hiyo kisha inahifadhiwa katika Meneja wa Siri**.

### Encryption

Kama inavyotarajiwa, kwa chaguo-msingi funguo inayosimamiwa na Google inatumika lakini funguo inayosimamiwa na Mteja inaweza kuonyeshwa (CMEK).

### Cleanup Policies

* **Futa artefaki:** Artefaki zitafutwa **kulingana na vigezo vya sera ya usafishaji**.
* **Kimbilio kavu:** (Chaguo-msingi) Artefaki **hazitafutwa**. Sera za usafishaji zitaangaliwa, na matukio ya kufuta ya majaribio yatatumwa kwa Usajili wa Ukaguzi wa Cloud.

### Vulnerability Scanning

Inawezekana kuwezesha **scanner ya udhaifu** ambayo itakagua udhaifu ndani ya **picha za kontena**.

### Enumeration
```bash
# Get repositories
gcloud artifacts repositories list
gcloud artifacts repositories describe --location <location> <repo-name>
gcloud artifacts versions list --repository=<repo-name> -location <location> --package <package-name>

# Get settings of a repository (example using python but could be other)
gcloud artifacts print-settings python --repository <repo-name> --location <location>

# Get docker images
gcloud artifacts docker images list us-central1-docker.pkg.dev/<proj-name>/<repo-name>

# Get packages (like python and others...)
gcloud artifacts packages list --repository <repo-name> --location <location>

# Get SBOMB artifacts
gcloud artifacts sbom list

# Get vulnerabilities (docker images)
gcloud artifacts vulnerabilities list us-east1-docker.pkg.dev/project123/repository123/someimage@sha256:49765698074d6d7baa82f
gcloud artifacts docker images list-vulnerabilities projects/<proj-name>/locations/<location>/scans/<scan-uuid>
```
### Privilege Escalation

{% content-ref url="../gcp-privilege-escalation/gcp-artifact-registry-privesc.md" %}
[gcp-artifact-registry-privesc.md](../gcp-privilege-escalation/gcp-artifact-registry-privesc.md)
{% endcontent-ref %}

### Unauthenticated Access

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md" %}
[gcp-artifact-registry-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-artifact-registry-unauthenticated-enum.md)
{% endcontent-ref %}

### Post-Exploitation

{% content-ref url="../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md" %}
[gcp-artifact-registry-post-exploitation.md](../gcp-post-exploitation/gcp-artifact-registry-post-exploitation.md)
{% endcontent-ref %}

### Persistence

{% content-ref url="../gcp-persistence/gcp-artifact-registry-persistence.md" %}
[gcp-artifact-registry-persistence.md](../gcp-persistence/gcp-artifact-registry-persistence.md)
{% endcontent-ref %}

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **fuata** sisi kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu za hacking kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
