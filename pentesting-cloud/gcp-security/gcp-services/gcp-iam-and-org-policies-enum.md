# GCP - IAMã€ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã¨çµ„ç¹”ãƒãƒªã‚·ãƒ¼ã®åˆ—æŒ™

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}

## ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã¯ä½•ã‹ã«ã¤ã„ã¦ã®ã‚¤ãƒ³ãƒˆãƒ­ã¯æ¬¡ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../gcp-basic-information/" %}
[gcp-basic-information](../gcp-basic-information/)
{% endcontent-ref %}

### åˆ—æŒ™

ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯å¸¸ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å±ã—ã¾ã™ï¼š
```bash
gcloud iam service-accounts list --project <project>
```
## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã‚°ãƒ«ãƒ¼ãƒ—

GCPã«ãŠã‘ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã‚°ãƒ«ãƒ¼ãƒ—ã®å‹•ä½œã«ã¤ã„ã¦ã®ã‚¤ãƒ³ãƒˆãƒ­ã¯ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../gcp-basic-information/" %}
[gcp-basic-information](../gcp-basic-information/)
{% endcontent-ref %}

### åˆ—æŒ™

æ¨©é™ **`serviceusage.services.enable`** ã¨ **`serviceusage.services.use`** ãŒã‚ã‚Œã°ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ **ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹ã«ã™ã‚‹** ã“ã¨ãŒã§ãã¾ã™ã€‚

{% hint style="danger" %}
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Workspaceãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ **Project Creator** ã®å½¹å‰²ãŒä»˜ä¸ã•ã‚Œã€æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ **ä½œæˆã™ã‚‹** ã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã¨ã€å½¼ã¯ãã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ **`owner`** ã®å½¹å‰²ãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€å½¼ã¯ **Workspaceã‚’åˆ—æŒ™ã™ã‚‹ãŸã‚ã«ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æœ‰åŠ¹ã«ã™ã‚‹** ã“ã¨ãŒã§ãã¾ã™ã€‚

ãŸã ã—ã€ã“ã‚Œã‚‰ã®APIã‚’å‘¼ã³å‡ºã™ãŸã‚ã«ã¯ **Workspaceå†…ã§ååˆ†ãªæ¨©é™ã‚’æŒã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹** ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
{% endhint %}

ã‚‚ã— **`admin` ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹ã«ã§ã**ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ **Workspaceå†…ã§ååˆ†ãªæ¨©é™ã‚’æŒã£ã¦ã„ã‚‹** ãªã‚‰ã€ä»¥ä¸‹ã®è¡Œã‚’ä½¿ã£ã¦ **ã™ã¹ã¦ã®ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ—æŒ™ã™ã‚‹** ã“ã¨ãŒã§ãã¾ã™ã€‚\
**`identity groups`** ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã¦ã‚‚ã€**ã‚°ãƒ«ãƒ¼ãƒ—ã«å±ã•ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼** ã‚‚è¿”ã•ã‚Œã¾ã™ï¼š

{% code overflow="wrap" %}
```bash
# Enable admin
gcloud services enable admin.googleapis.com
gcloud services enable cloudidentity.googleapis.com

# Using admin.googleapis.com
## List all users
gcloud organizations list #The DIRECTORY_CUSTOMER_ID is the Workspace ID
gcloud beta identity groups preview --customer <workspace-id>

# Using cloudidentity.googleapis.com
## List groups of a user (you can list at least the groups you belong to)
gcloud identity groups memberships search-transitive-groups --member-email <email> --labels=cloudidentity.googleapis.com/groups.discussion_forum

## List Group Members (you can list at least the groups you belong to)
gcloud identity groups memberships list --group-email=<email>
### Make it transitive
gcloud identity groups memberships search-transitive-memberships --group-email=<email>

## Get a graph (if you have enough permissions)
gcloud identity groups memberships get-membership-graph --member-email=<email> --labels=cloudidentity.googleapis.com/groups.discussion_forum
```
{% endcode %}

{% hint style="success" %}
å‰ã®ä¾‹ã§ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ `--labels` ãŒå¿…è¦ã§ã‚ã‚‹ãŸã‚ã€ä¸€èˆ¬çš„ãªå€¤ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ï¼ˆAPIã‚’ç›´æ¥ä½¿ç”¨ã—ãŸå ´åˆã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€[**PurplePandaãŒã“ã“ã§è¡Œã£ã¦ã„ã‚‹ã‚ˆã†ã«**](https://github.com/carlospolop/PurplePanda/blob/master/intel/google/discovery/disc\_groups\_users.py)ï¼‰ã€‚
{% endhint %}

ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã¦ã‚‚ã€ä¾µå®³ã•ã‚ŒãŸãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ååˆ†ãªæ¨©é™ãŒãªã„ãŸã‚ã€åˆ—æŒ™ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

<figure><img src="../../../.gitbook/assets/image (193).png" alt=""><figcaption></figcaption></figure>

## IAM

[**IAMã«é–¢ã™ã‚‹åŸºæœ¬æƒ…å ±ã¯ã“ã¡ã‚‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„**](../gcp-basic-information/#iam-roles)ã€‚

### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ¨©é™

[**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**](https://cloud.google.com/resource-manager/docs/default-access-control)ã‹ã‚‰ï¼šçµ„ç¹”ãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ã¨ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å†…ã®ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«**è«‹æ±‚ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆè€…**ãŠã‚ˆã³**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆè€…**ã®å½¹å‰²ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä»˜ä¸ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å½¹å‰²ã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã™ãã«Google Cloudã‚’ä½¿ç”¨é–‹å§‹ã§ãã¾ã™ãŒã€çµ„ç¹”ãƒªã‚½ãƒ¼ã‚¹ã®é€šå¸¸ã®é‹ç”¨ã«ã¯ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’æ„å›³ã—ã¦ã„ã¾ã›ã‚“ã€‚

ã“ã‚Œã‚‰ã®**å½¹å‰²**ã¯**æ¨©é™**ã‚’ä»˜ä¸ã—ã¾ã™ï¼š

* `billing.accounts.create` ãŠã‚ˆã³ `resourcemanager.organizations.get`
* `resourcemanager.organizations.get` ãŠã‚ˆã³ `resourcemanager.projects.create`

ã•ã‚‰ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã¨ã€[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://cloud.google.com/resource-manager/docs/access-control-proj)ã«å¾“ã£ã¦ã€ãã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®**ã‚ªãƒ¼ãƒŠãƒ¼ãŒè‡ªå‹•çš„ã«ä»˜ä¸ã•ã‚Œã¾ã™**ã€‚ã—ãŸãŒã£ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€ãã®ä¸Šã§ä»»æ„ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ˆãƒã‚¤ãƒŠãƒ¼ï¼Ÿãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®åˆ—æŒ™ï¼Ÿ...ï¼‰

{% hint style="danger" %}
GCPçµ„ç¹”ã«ãŠã‘ã‚‹æœ€é«˜ã®æ¨©é™ã¯**çµ„ç¹”ç®¡ç†è€…**ã®å½¹å‰²ã§ã™ã€‚
{% endhint %}

### set-iam-policy vs add-iam-policy-binding

ã»ã¨ã‚“ã©ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯ã€**`add-iam-policy-binding`**ã¾ãŸã¯**`set-iam-policy`**ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹æ¨©é™ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚ä¸»ãªé•ã„ã¯ã€**`add-iam-policy-binding`ã¯æ—¢å­˜ã®IAMãƒãƒªã‚·ãƒ¼ã«æ–°ã—ã„å½¹å‰²ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¿½åŠ ã™ã‚‹**ã®ã«å¯¾ã—ã€**`set-iam-policy`ã¯ä»¥å‰ã«ä»˜ä¸ã•ã‚ŒãŸæ¨©é™ã‚’**å‰Šé™¤ã—ã€**ã‚³ãƒãƒ³ãƒ‰ã§æŒ‡å®šã•ã‚ŒãŸã‚‚ã®ã ã‘ã‚’è¨­å®šã—ã¾ã™**ã€‚

### åˆ—æŒ™
```bash
# Roles
## List roles
gcloud iam roles list --project $PROJECT_ID # List only custom roles
gcloud iam roles list --filter='etag:AA=='

## Get perms and description of role
gcloud iam roles describe roles/container.admin
gcloud iam roles describe --project <proj-name> <role-name>

# Policies
gcloud organizations get-iam-policy <org_id>
gcloud resource-manager folders get-iam-policy <folder-id>
gcloud projects get-iam-policy <project-id>

# MISC
## Testable permissions in resource
gcloud iam list-testable-permissions --filter "NOT apiDisabled: true" <resource>
## Grantable roles to a resource
gcloud iam list-grantable-roles <project URL>
```
### cloudasset IAM Enumeration

ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã€ç•°ãªã‚‹ãƒªã‚½ãƒ¼ã‚¹ï¼ˆçµ„ç¹”ã€ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãªã©ï¼‰å†…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã™ã¹ã¦ã®æ¨©é™ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚

* æ¨©é™ **`cloudasset.assets.searchAllIamPolicies`** ã¯ã€ãƒªã‚½ãƒ¼ã‚¹å†…ã® **ã™ã¹ã¦ã®iamãƒãƒªã‚·ãƒ¼** ã‚’è¦æ±‚ã§ãã¾ã™ã€‚
```bash
gcloud asset search-all-iam-policies #By default uses current configured project
gcloud asset search-all-iam-policies --scope folders/1234567
gcloud asset search-all-iam-policies --scope organizations/123456
gcloud asset search-all-iam-policies --scope projects/project-id-123123
```
* æ¨©é™ **`cloudasset.assets.analyzeIamPolicy`** ã¯ã€ãƒªã‚½ãƒ¼ã‚¹å†…ã®ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã® **ã™ã¹ã¦ã® IAM ãƒãƒªã‚·ãƒ¼** ã‚’è¦æ±‚ã§ãã¾ã™ã€‚
```bash
# Needs perm "cloudasset.assets.analyzeIamPolicy" over the asset
gcloud asset analyze-iam-policy --organization=<org-id> \
--identity='user:email@hacktricks.xyz'
gcloud asset analyze-iam-policy --folder=<folder-id> \
--identity='user:email@hacktricks.xyz'
gcloud asset analyze-iam-policy --project=<project-name> \
--identity='user:email@hacktricks.xyz'
```
* æ¨©é™ **`cloudasset.assets.searchAllResources`** ã¯ã€çµ„ç¹”ã€ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã€ã¾ãŸã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’è¨±å¯ã—ã¾ã™ã€‚IAMé–¢é€£ã®ãƒªã‚½ãƒ¼ã‚¹ï¼ˆãƒ­ãƒ¼ãƒ«ãªã©ï¼‰ãŒå«ã¾ã‚Œã¾ã™ã€‚
```bash
gcloud asset search-all-resources --scope projects/<proj-name>
gcloud asset search-all-resources --scope folders/1234567
gcloud asset search-all-resources --scope organizations/123456
```
* æ¨©é™ **`cloudasset.assets.analyzeMove`** ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚ˆã†ãªãƒªã‚½ãƒ¼ã‚¹ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ãƒãƒªã‚·ãƒ¼ã‚’å–å¾—ã™ã‚‹ã®ã«ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚
```bash
gcloud asset analyze-move --project=<proj-name> \
--destination-organization=609216679593
```
* **`cloudasset.assets.queryIamPolicy`** ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã¯ã€ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æä¾›ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```bash
# But, when running something like this
gcloud asset query --project=<proj> --statement='SELECT * FROM compute_googleapis_com_Instance'
# I get the error
ERROR: (gcloud.asset.query) UNAUTHENTICATED: QueryAssets API is only supported for SCC premium customers. See https://cloud.google.com/security-command-center/pricing
```
### testIamPermissions enumeration

{% hint style="danger" %}
ã‚‚ã—**å‰ã®æ–¹æ³•ã§IAMæƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„**å ´åˆã€ã‚ãªãŸãŒRed Teamã«ã„ã‚‹ãªã‚‰ã€**ãƒ„ãƒ¼ãƒ«**[ **https://github.com/carlospolop/bf\_my\_gcp\_perms**](https://github.com/carlospolop/bf\_my\_gcp\_perms) **ã‚’ä½¿ç”¨ã—ã¦ç¾åœ¨ã®æ¨©é™ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚**

ãŸã ã—ã€ã‚µãƒ¼ãƒ“ã‚¹**`cloudresourcemanager.googleapis.com`**ã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
{% endhint %}

### Privesc

æ¬¡ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€**IAMæ¨©é™ã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©ã‚’æ˜‡æ ¼ã•ã›ã‚‹æ–¹æ³•**ã‚’ç¢ºèªã§ãã¾ã™ï¼š

{% content-ref url="../gcp-privilege-escalation/gcp-iam-privesc.md" %}
[gcp-iam-privesc.md](../gcp-privilege-escalation/gcp-iam-privesc.md)
{% endcontent-ref %}

### Unauthenticated Enum <a href="#service-account-impersonation" id="service-account-impersonation"></a>

{% content-ref url="../gcp-unauthenticated-enum-and-access/gcp-iam-principals-and-org-unauthenticated-enum.md" %}
[gcp-iam-principals-and-org-unauthenticated-enum.md](../gcp-unauthenticated-enum-and-access/gcp-iam-principals-and-org-unauthenticated-enum.md)
{% endcontent-ref %}

### Post Exploitation <a href="#service-account-impersonation" id="service-account-impersonation"></a>

{% content-ref url="../gcp-post-exploitation/gcp-iam-post-exploitation.md" %}
[gcp-iam-post-exploitation.md](../gcp-post-exploitation/gcp-iam-post-exploitation.md)
{% endcontent-ref %}

### Persistence

é«˜ã„ç‰¹æ¨©ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€ã‚ãªãŸã¯ï¼š

* æ–°ã—ã„SAï¼ˆã¾ãŸã¯Workspaceå†…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã‚’ä½œæˆã™ã‚‹
* è‡ªåˆ†ãŒç®¡ç†ã™ã‚‹ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ã«ã‚ˆã‚Šå¤šãã®æ¨©é™ã‚’ä¸ãˆã‚‹
* è„†å¼±ãªSAã«ã‚ˆã‚Šå¤šãã®ç‰¹æ¨©ã‚’ä¸ãˆã‚‹ï¼ˆvmå†…ã®SSRFã€è„†å¼±ãªCloud Functionâ€¦ï¼‰
* â€¦

## Org Policies

Org PoliciesãŒä½•ã§ã‚ã‚‹ã‹ã®ã‚¤ãƒ³ãƒˆãƒ­ã«ã¤ã„ã¦ã¯ã€æ¬¡ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../gcp-basic-information/" %}
[gcp-basic-information](../gcp-basic-information/)
{% endcontent-ref %}

IAMãƒãƒªã‚·ãƒ¼ã¯ã€å½¹å‰²ã‚’ä»‹ã—ã¦ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ãŒãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦æŒã¤æ¨©é™ã‚’ç¤ºã—ã€å½¹å‰²ã«ã¯ç´°ã‹ã„æ¨©é™ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚çµ„ç¹”ãƒãƒªã‚·ãƒ¼ã¯ã€**ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒã©ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã‚‹ã‹ã€ã¾ãŸã¯ã©ã®æ©Ÿèƒ½ãŒç„¡åŠ¹ã«ã•ã‚Œã‚‹ã‹ã‚’åˆ¶é™ã—ã¾ã™**ã€‚ã“ã‚Œã¯ã€GCPç’°å¢ƒå†…ã®å„ãƒªã‚½ãƒ¼ã‚¹ã®æœ€å°ç‰¹æ¨©ã‚’å‘ä¸Šã•ã›ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚
```bash
gcloud resource-manager org-policies list --organization=ORGANIZATION_ID
gcloud resource-manager org-policies list --folder=FOLDER_ID
gcloud resource-manager org-policies list --project=PROJECT_ID
```
### Privesc

æ¬¡ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€**çµ„ç¹”ãƒãƒªã‚·ãƒ¼ã®æ¨©é™ã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©ã‚’æ˜‡æ ¼ã•ã›ã‚‹æ–¹æ³•**ã‚’ç¢ºèªã§ãã¾ã™ï¼š

{% content-ref url="../gcp-privilege-escalation/gcp-orgpolicy-privesc.md" %}
[gcp-orgpolicy-privesc.md](../gcp-privilege-escalation/gcp-orgpolicy-privesc.md)
{% endcontent-ref %}

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
