# GCP - Artifact Registry Persistence

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Artifact Registry

Artifact Registryã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±ã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../gcp-services/gcp-artifact-registry-enum.md" %}
[gcp-artifact-registry-enum.md](../gcp-services/gcp-artifact-registry-enum.md)
{% endcontent-ref %}

### Dependency Confusion

* **ãƒªãƒ¢ãƒ¼ãƒˆã¨æ¨™æº–ã®**ãƒªãƒã‚¸ãƒˆãƒªãŒ**ä»®æƒ³ãƒªãƒã‚¸ãƒˆãƒª**ã§æ··åœ¨ã—ã€ä¸¡æ–¹ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ã©ã†ãªã‚‹ã‹ï¼Ÿ
* **ä»®æƒ³ãƒªãƒã‚¸ãƒˆãƒªã§è¨­å®šã•ã‚ŒãŸå„ªå…ˆåº¦ãŒæœ€ã‚‚é«˜ã„ã‚‚ã®**ãŒä½¿ç”¨ã•ã‚Œã‚‹
* **å„ªå…ˆåº¦ãŒåŒã˜å ´åˆ**ï¼š
* **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**ãŒ**åŒã˜**ã§ã‚ã‚Œã°ã€**ä»®æƒ³ãƒªãƒã‚¸ãƒˆãƒªå†…ã§ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«æœ€åˆã®ãƒãƒªã‚·ãƒ¼å**ãŒä½¿ç”¨ã•ã‚Œã‚‹
* ãã†ã§ãªã‘ã‚Œã°ã€**æœ€ã‚‚é«˜ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³**ãŒä½¿ç”¨ã•ã‚Œã‚‹

{% hint style="danger" %}
ã—ãŸãŒã£ã¦ã€ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªãŒã‚ˆã‚Šé«˜ã„ã¾ãŸã¯åŒã˜å„ªå…ˆåº¦ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€**ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã§ã®æœ€é«˜ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾å­˜é–¢ä¿‚ã®æ··ä¹±ï¼‰**ã‚’**æ‚ªç”¨ã™ã‚‹**ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
{% endhint %}

ã“ã®æŠ€è¡“ã¯ã€**æŒç¶šæ€§**ã¨**èªè¨¼ã•ã‚Œã¦ã„ãªã„ã‚¢ã‚¯ã‚»ã‚¹**ã«å½¹ç«‹ã¤å¯èƒ½æ€§ãŒã‚ã‚Šã€ã“ã‚Œã‚’æ‚ªç”¨ã™ã‚‹ã«ã¯ã€Artifact Registryã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹**ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåã‚’çŸ¥ã£ã¦ã„ã‚‹**ã“ã¨ã¨ã€**ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒªï¼ˆä¾‹ãˆã°Pythonã®PyPiï¼‰ã«åŒã˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚ˆã‚Šé«˜ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ä½œæˆã™ã‚‹**ã“ã¨ãŒå¿…è¦ã§ã™ã€‚

æŒç¶šæ€§ã®ãŸã‚ã«å¾“ã†ã¹ãæ‰‹é †ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

* **è¦ä»¶**ï¼š**ä»®æƒ³ãƒªãƒã‚¸ãƒˆãƒª**ãŒ**å­˜åœ¨ã—**ã€ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã€**ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒª**ã«å­˜åœ¨ã—ãªã„**åå‰ã®å†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸**ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
* ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆã™ã‚‹
* ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‚’ä»®æƒ³ãƒªãƒã‚¸ãƒˆãƒªã«è¿½åŠ ã™ã‚‹
* ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«ã‚ˆã‚Šé«˜ã„ï¼ˆã¾ãŸã¯åŒã˜ï¼‰å„ªå…ˆåº¦ã‚’ä¸ãˆã‚‹ãŸã‚ã«ä»®æƒ³ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®ãƒãƒªã‚·ãƒ¼ã‚’ç·¨é›†ã™ã‚‹ã€‚\
æ¬¡ã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š
* [gcloud artifacts repositories update --upstream-policy-file ...](https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/update#--upstream-policy-file)
* æ­£å½“ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ã€åŒã˜ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒªã«ç™»éŒ²ã—ã¾ã™ã€‚é–‹ç™ºè€…ãŒãã‚Œã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã³ã«ã€å½¼ã¯ã‚ãªãŸã®ã‚‚ã®ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼

ä¾å­˜é–¢ä¿‚ã®æ··ä¹±ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±ã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% embed url="https://book.hacktricks.xyz/pentesting-web/dependency-confusion" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
