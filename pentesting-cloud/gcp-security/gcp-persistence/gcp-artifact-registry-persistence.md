# GCP - Utrzymywanie w Rejestrze ArtefaktÃ³w

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

## Rejestr ArtefaktÃ³w

Aby uzyskaÄ‡ wiÄ™cej informacji na temat Rejestru ArtefaktÃ³w, sprawdÅº:

{% content-ref url="../gcp-services/gcp-artifact-registry-enum.md" %}
[gcp-artifact-registry-enum.md](../gcp-services/gcp-artifact-registry-enum.md)
{% endcontent-ref %}

### Zamieszanie w zaleÅ¼noÅ›ciach

* Co siÄ™ stanie, jeÅ›li **zdalne i standardowe** repozytoria **sÄ… pomieszane w wirtualnym** i pakiet istnieje w obu?
* UÅ¼ywane jest to z **najwyÅ¼szym priorytetem ustawionym w wirtualnym repozytorium**
* JeÅ›li **priorytet jest taki sam**:
* JeÅ›li **wersja** jest **taka sama**, uÅ¼ywana jest **nazwa polityki alfabetycznie** pierwsza w wirtualnym repozytorium
* JeÅ›li nie, uÅ¼ywana jest **najwyÅ¼sza wersja**

{% hint style="danger" %}
Dlatego moÅ¼liwe jest **naduÅ¼ycie najwyÅ¼szej wersji (zamieszanie w zaleÅ¼noÅ›ciach)** w publicznym rejestrze pakietÃ³w, jeÅ›li zdalne repozytorium ma wyÅ¼szy lub taki sam priorytet
{% endhint %}

Ta technika moÅ¼e byÄ‡ przydatna do **utrzymywania** i **nieautoryzowanego dostÄ™pu**, poniewaÅ¼ aby jÄ… naduÅ¼yÄ‡, wystarczy **znaÄ‡ nazwÄ™ biblioteki** przechowywanej w Rejestrze ArtefaktÃ³w i **utworzyÄ‡ tÄ™ samÄ… bibliotekÄ™ w publicznym repozytorium (na przykÅ‚ad PyPi dla Pythona)** z wyÅ¼szÄ… wersjÄ….

Aby uzyskaÄ‡ utrzymanie, naleÅ¼y wykonaÄ‡ nastÄ™pujÄ…ce kroki:

* **Wymagania**: Musi **istnieÄ‡** i byÄ‡ uÅ¼ywane **wirtualne repozytorium**, musi byÄ‡ uÅ¼ywane **wewnÄ™trzne pakiet** z **nazwÄ…**, ktÃ³ra nie istnieje w **publicznym repozytorium**.
* UtwÃ³rz zdalne repozytorium, jeÅ›li nie istnieje
* Dodaj zdalne repozytorium do wirtualnego repozytorium
* Edytuj polityki w wirtualnym rejestrze, aby nadaÄ‡ wyÅ¼szy priorytet (lub taki sam) zdalnemu repozytorium.\
Uruchom coÅ› takiego jak:
* [gcloud artifacts repositories update --upstream-policy-file ...](https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/update#--upstream-policy-file)
* Pobierz legalny pakiet, dodaj swÃ³j zÅ‚oÅ›liwy kod i zarejestruj go w publicznym repozytorium z tÄ… samÄ… wersjÄ…. Za kaÅ¼dym razem, gdy deweloper go zainstaluje, zainstaluje twÃ³j!

Aby uzyskaÄ‡ wiÄ™cej informacji na temat zamieszania w zaleÅ¼noÅ›ciach, sprawdÅº:

{% embed url="https://book.hacktricks.xyz/pentesting-web/dependency-confusion" %}

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
