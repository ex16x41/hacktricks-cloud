# GCP - Artefak Registrasie Volharding

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Opleiding AWS Rooi Span Ekspert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Rooi Span Ekspert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** ğŸ’¬ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Artefak Registrasie

Vir meer inligting oor Artefak Registrasie kyk:

{% content-ref url="../gcp-services/gcp-artifact-registry-enum.md" %}
[gcp-artifact-registry-enum.md](../gcp-services/gcp-artifact-registry-enum.md)
{% endcontent-ref %}

### Afhanklikheid Verwarring

* Wat gebeur as 'n **afgeleÃ« en 'n standaard** registrasies **in 'n virtuele** een gemeng word en 'n pakket in albei bestaan?
* Die een met die **hoogste prioriteit wat in die virtuele registrasie** gestel is, word gebruik
* As die **prioriteit dieselfde is**:
* As die **weergawe** dieselfde is, word die **beleid naam alfabeties** eerste in die virtuele registrasie gebruik
* As nie, word die **hoogste weergawe** gebruik

{% hint style="danger" %}
Daarom is dit moontlik om 'n **hoogste weergawe (afhanklikheid verwarring)** in 'n openbare pakket registrasie te **misbruik** as die afgeleÃ« registrasie 'n hoÃ«r of dieselfde prioriteit het
{% endhint %}

Hierdie tegniek kan nuttig wees vir **volharding** en **onaangetekende toegang** aangesien dit net vereis om 'n **biblioteek naam** wat in Artefak Registrasie gestoor is te **ken** en **daardie selfde biblioteek in die openbare registrasie (PyPi vir python byvoorbeeld)** met 'n hoÃ«r weergawe te **skep**.

Vir volharding is dit die stappe wat jy moet volg:

* **Vereistes**: 'n **virtuele registrasie** moet **bestaan** en gebruik word, 'n **interne pakket** met 'n **naam** wat nie in die **openbare registrasie** bestaan nie, moet gebruik word.
* Skep 'n afgeleÃ« registrasie as dit nie bestaan nie
* Voeg die afgeleÃ« registrasie by die virtuele registrasie
* Wysig die beleide van die virtuele registrasie om 'n hoÃ«r prioriteit (of dieselfde) aan die afgeleÃ« registrasie te gee.\
Voer iets soos uit:
* [gcloud artifacts repositories update --upstream-policy-file ...](https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/update#--upstream-policy-file)
* Laai die wettige pakket af, voeg jou kwaadwillige kode by en registreer dit in die openbare registrasie met dieselfde weergawe. Elke keer as 'n ontwikkelaar dit installeer, sal hy joune installeer!

Vir meer inligting oor afhanklikheid verwarring kyk:

{% embed url="https://book.hacktricks.xyz/pentesting-web/dependency-confusion" %}

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Opleiding AWS Rooi Span Ekspert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Opleiding GCP Rooi Span Ekspert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** ğŸ’¬ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
