# GCP - Artifact Registry Persistence

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Artifact Registry

Artifact Registry рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="../gcp-services/gcp-artifact-registry-enum.md" %}
[gcp-artifact-registry-enum.md](../gcp-services/gcp-artifact-registry-enum.md)
{% endcontent-ref %}

### Dependency Confusion

* рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ рдЕрдЧрд░ рдПрдХ **remote рдФрд░ рдПрдХ standard** repositories **рдПрдХ virtual** рдореЗрдВ **рдорд┐рд╢реНрд░рд┐рдд** рд╣реЛ рдЬрд╛рдПрдВ рдФрд░ рдПрдХ рдкреИрдХреЗрдЬ рджреЛрдиреЛрдВ рдореЗрдВ рдореМрдЬреВрдж рд╣реЛ?
* **рд╡рд░реНрдЪреБрдЕрд▓ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА** рдореЗрдВ рд╕реЗрдЯ рдХреА рдЧрдИ **рдЙрдЪреНрдЪрддрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛** рд╡рд╛рд▓рд╛ рдкреИрдХреЗрдЬ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
* рдпрджрд┐ **рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕рдорд╛рди рд╣реИ**:
* рдпрджрд┐ **рд╕рдВрд╕реНрдХрд░рдг** **рд╕рдорд╛рди** рд╣реИ, рддреЛ **рд╡рд░реНрдЪреБрдЕрд▓ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА** рдореЗрдВ **рдиреАрддрд┐ рдирд╛рдо рд╡рд░реНрдгрд╛рдиреБрдХреНрд░рдо рдореЗрдВ** рдкрд╣рд▓реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
* рдпрджрд┐ рдирд╣реАрдВ, рддреЛ **рдЙрдЪреНрдЪрддрдо рд╕рдВрд╕реНрдХрд░рдг** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ remote repository рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдЙрдЪреНрдЪ рдпрд╛ рд╕рдорд╛рди рд╣реИ, рддреЛ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкреИрдХреЗрдЬ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ **рдЙрдЪреНрдЪрддрдо рд╕рдВрд╕реНрдХрд░рдг (dependency confusion)** рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ
{% endhint %}

рдпрд╣ рддрдХрдиреАрдХ **persistence** рдФрд░ **unauthenticated access** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ **Artifact Registry** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд **рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдирд╛рдо** рдЬрд╛рдирдирд╛ рдФрд░ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП Python рдХреЗ рд▓рд┐рдП PyPi)** рдореЗрдВ рдЙрд╕реА рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдЙрдЪреНрдЪ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рдмрдирд╛рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

**Persistence** рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

* **рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ**: рдПрдХ **рд╡рд░реНрдЪреБрдЕрд▓ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА** рдХрд╛ **рдЕрд╕реНрддрд┐рддреНрд╡** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдПрдХ **рдЖрдВрддрд░рд┐рдХ рдкреИрдХреЗрдЬ** рдЬрд┐рд╕рдХрд╛ **рдирд╛рдо** **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА** рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ рдпрд╣ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ рддреЛ рдПрдХ remote repository рдмрдирд╛рдПрдВ
* рд╡рд░реНрдЪреБрдЕрд▓ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ remote repository рдЬреЛрдбрд╝реЗрдВ
* рд╡рд░реНрдЪреБрдЕрд▓ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рддрд╛рдХрд┐ remote repository рдХреЛ рдЙрдЪреНрдЪ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ (рдпрд╛ рд╕рдорд╛рди) рджреА рдЬрд╛ рд╕рдХреЗред\
рдХреБрдЫ рдРрд╕рд╛ рдЪрд▓рд╛рдПрдВ:
* [gcloud artifacts repositories update --upstream-policy-file ...](https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/update#--upstream-policy-file)
* рд╡реИрдз рдкреИрдХреЗрдЬ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ, рдЕрдкрдиреЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреЛрдб рдХреЛ рдЬреЛрдбрд╝реЗрдВ рдФрд░ рдЗрд╕реЗ рдЙрд╕реА рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдкрдВрдЬреАрдХреГрдд рдХрд░реЗрдВред рд╣рд░ рдмрд╛рд░ рдЬрдм рдПрдХ рдбреЗрд╡рд▓рдкрд░ рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЖрдкрдХрд╛ рдкреИрдХреЗрдЬ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдЧрд╛!

Dependency confusion рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% embed url="https://book.hacktricks.xyz/pentesting-web/dependency-confusion" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
