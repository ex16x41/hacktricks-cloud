# GCP - Informations de base

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## **Hi√©rarchie des ressources**

Google Cloud utilise une [hi√©rarchie des ressources](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy) qui est conceptuellement similaire √† celle d'un syst√®me de fichiers traditionnel. Cela fournit un flux de travail logique parent/enfant avec des points d'attache sp√©cifiques pour les politiques et les autorisations.

√Ä un niveau √©lev√©, cela ressemble √† ceci :
```
Organization
--> Folders
--> Projects
--> Resources
```
Une machine virtuelle (appel√©e une instance de calcul) est une ressource. Une ressource r√©side dans un projet, probablement aux c√¥t√©s d'autres instances de calcul, de buckets de stockage, etc.

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption><p><a href="https://cloud.google.com/static/resource-manager/img/cloud-hierarchy.svg">https://cloud.google.com/static/resource-manager/img/cloud-hierarchy.svg</a></p></figcaption></figure>

## **Migration de Projets**

Il est possible de **migrer un projet sans organisation** vers une organisation avec les permissions `roles/resourcemanager.projectCreator` et `roles/resourcemanager.projectMover`. Si le projet se trouve dans une autre organisation, il est n√©cessaire de contacter le support GCP pour **les d√©placer hors de l'organisation d'abord**. Pour plus d'infos, consultez [**ceci**](https://medium.com/google-cloud/migrating-a-project-from-one-organization-to-another-gcp-4b37a86dd9e6).

## **Politiques d'Organisation**

Permettent de centraliser le contr√¥le sur les ressources cloud de votre organisation :

* Centraliser le contr√¥le pour **configurer des restrictions** sur la fa√ßon dont les ressources de votre organisation peuvent √™tre utilis√©es.
* D√©finir et √©tablir des **garde-fous** pour que vos √©quipes de d√©veloppement restent dans les limites de conformit√©.
* Aider les propri√©taires de projets et leurs √©quipes √† avancer rapidement sans craindre de violer la conformit√©.

Ces politiques peuvent √™tre cr√©√©es pour **affecter l'ensemble de l'organisation, le(s) dossier(s) ou le(s) projet(s)**. Les descendants du n≈ìud de hi√©rarchie de ressources cibl√© **h√©ritent de la politique d'organisation**.

Pour **d√©finir** une politique d'organisation, **vous choisissez un** [**contrainte**](https://cloud.google.com/resource-manager/docs/organization-policy/overview#constraints), qui est un type particulier de restriction contre un service Google Cloud ou un groupe de services Google Cloud. Vous **configurez cette contrainte avec vos restrictions souhait√©es**.

<figure><img src="../../../.gitbook/assets/image (217).png" alt=""><figcaption><p><a href="https://cloud.google.com/resource-manager/img/org-policy-concepts.svg">https://cloud.google.com/resource-manager/img/org-policy-concepts.svg</a></p></figcaption></figure>

#### Cas d'utilisation courants <a href="#common_use_cases" id="common_use_cases"></a>

* Limiter le partage de ressources en fonction du domaine.
* Limiter l'utilisation des comptes de service Identity and Access Management.
* Restreindre l'emplacement physique des ressources nouvellement cr√©√©es.
* D√©sactiver la cr√©ation de comptes de service.

<figure><img src="../../../.gitbook/assets/image (172).png" alt=""><figcaption></figcaption></figure>

Il existe de nombreuses autres contraintes qui vous donnent un contr√¥le granulaire sur les ressources de votre organisation. Pour **plus d'informations, consultez la** [**liste de toutes les contraintes du Service de Politique d'Organisation**](https://cloud.google.com/resource-manager/docs/organization-policy/org-policy-constraints)**.**

### **Politiques d'Organisation par D√©faut**

<details>

<summary>Voici les politiques que Google ajoutera par d√©faut lors de la configuration de votre organisation GCP :</summary>

**Politiques de Gestion des Acc√®s**

* **Contacts restreints par domaine :** Emp√™che l'ajout d'utilisateurs aux Contacts Essentiels en dehors de vos domaines sp√©cifi√©s. Cela limite les Contacts Essentiels √† n'autoriser que les identit√©s d'utilisateur g√©r√©es dans vos domaines s√©lectionn√©s √† recevoir des notifications de la plateforme.
* **Partage restreint par domaine :** Emp√™che l'ajout d'utilisateurs aux politiques IAM en dehors de vos domaines sp√©cifi√©s. Cela limite les politiques IAM √† n'autoriser que les identit√©s d'utilisateur g√©r√©es dans vos domaines s√©lectionn√©s √† acc√©der aux ressources de cette organisation.
* **Pr√©vention de l'acc√®s public :** Emp√™che les buckets Cloud Storage d'√™tre expos√©s au public. Cela garantit qu'un d√©veloppeur ne peut pas configurer des buckets Cloud Storage pour avoir un acc√®s Internet non authentifi√©.
* **Acc√®s uniforme au niveau des buckets :** Emp√™che les listes de contr√¥le d'acc√®s (ACL) au niveau des objets dans les buckets Cloud Storage. Cela simplifie votre gestion des acc√®s en appliquant les politiques IAM de mani√®re coh√©rente √† tous les objets dans les buckets Cloud Storage.
* **Exiger la connexion OS :** Les VM cr√©√©es dans de nouveaux projets auront la connexion OS activ√©e. Cela vous permet de g√©rer l'acc√®s SSH √† vos instances en utilisant IAM sans avoir besoin de cr√©er et de g√©rer des cl√©s SSH individuelles.

**Politiques de s√©curit√© suppl√©mentaires pour les comptes de service**

* **D√©sactiver les attributions IAM automatiques :** Emp√™che les comptes de service par d√©faut App Engine et Compute Engine d'obtenir automatiquement le r√¥le IAM √âditeur lors de la cr√©ation d'un projet. Cela garantit que les comptes de service ne re√ßoivent pas de r√¥les IAM trop permissifs lors de leur cr√©ation.
* **D√©sactiver la cr√©ation de cl√©s de compte de service :** Emp√™che la cr√©ation de cl√©s de compte de service publiques. Cela aide √† r√©duire le risque d'exposition de credentials persistants.
* **D√©sactiver le t√©l√©chargement de cl√©s de compte de service :** Emp√™che le t√©l√©chargement de cl√©s de compte de service publiques. Cela aide √† r√©duire le risque de fuite ou de r√©utilisation de mat√©riel de cl√©.

**Politiques de configuration s√©curis√©e du r√©seau VPC**

* **D√©finir les IP externes autoris√©es pour les instances VM :** Emp√™che la cr√©ation d'instances de calcul avec une IP publique, ce qui peut les exposer au trafic Internet.

<!---->

* **D√©sactiver la virtualisation imbriqu√©e des VM :** Emp√™che la cr√©ation de VM imbriqu√©es sur les VM Compute Engine. Cela diminue le risque de s√©curit√© d'avoir des VM imbriqu√©es non surveill√©es.

<!---->

* **D√©sactiver le port s√©rie des VM :** Emp√™che l'acc√®s au port s√©rie des VM Compute Engine. Cela emp√™che l'entr√©e dans le port s√©rie d'un serveur en utilisant l'API Compute Engine.

<!---->

* **Restreindre les r√©seaux autoris√©s sur les instances Cloud SQL :** Emp√™che les plages de r√©seaux publics ou non internes d'acc√©der √† vos bases de donn√©es Cloud SQL.

<!---->

* **Restreindre le transfert de protocole en fonction du type d'adresse IP :** Emp√™che le transfert de protocole VM pour les adresses IP externes.

<!---->

* **Restreindre l'acc√®s IP public sur les instances Cloud SQL :** Emp√™che la cr√©ation d'instances Cloud SQL avec une IP publique, ce qui peut les exposer au trafic Internet.

<!---->

* **Restreindre la suppression de la charge de projet VPC partag√© :** Emp√™che la suppression accidentelle des projets h√¥tes VPC partag√©s.

<!---->

* **D√©finit le param√®tre DNS interne pour les nouveaux projets √† DNS Zonal uniquement :** Emp√™che l'utilisation d'un param√®tre DNS h√©rit√© qui a r√©duit la disponibilit√© du service.

<!---->

* **Ignorer la cr√©ation de r√©seau par d√©faut :** Emp√™che la cr√©ation automatique du r√©seau VPC par d√©faut et des ressources associ√©es. Cela √©vite des r√®gles de pare-feu par d√©faut trop permissives.

<!---->

* **D√©sactiver l'utilisation IPv6 externe VPC :** Emp√™che la cr√©ation de sous-r√©seaux IPv6 externes, qui peuvent √™tre expos√©s √† un acc√®s Internet non autoris√©.

</details>

## **R√¥les IAM**

Ce sont comme des politiques IAM dans AWS car **chaque r√¥le contient un ensemble de permissions.**

Cependant, contrairement √† AWS, il n'y a **pas de d√©p√¥t centralis√©** de r√¥les. Au lieu de cela, **les ressources donnent X r√¥les d'acc√®s √† Y principaux**, et le seul moyen de savoir qui a acc√®s √† une ressource est d'utiliser la **m√©thode `get-iam-policy` sur cette ressource**.\
Cela pourrait poser un probl√®me car cela signifie que le seul moyen de savoir **quelles permissions un principal a est de demander √† chaque ressource √† qui elle accorde des permissions**, et un utilisateur pourrait ne pas avoir les permissions n√©cessaires pour obtenir les permissions de toutes les ressources.

Il existe **trois types** de r√¥les dans IAM :

* **R√¥les de base/primitive**, qui incluent les r√¥les **Propri√©taire**, **√âditeur** et **Visionneuse** qui existaient avant l'introduction de l'IAM.
* **R√¥les pr√©d√©finis**, qui fournissent un acc√®s granulaire pour un service sp√©cifique et sont g√©r√©s par Google Cloud. Il existe de nombreux r√¥les pr√©d√©finis, vous pouvez **voir tous ceux-ci avec les privil√®ges qu'ils ont** [**ici**](https://cloud.google.com/iam/docs/understanding-roles#predefined\_roles).
* **R√¥les personnalis√©s**, qui fournissent un acc√®s granulaire selon une liste de permissions sp√©cifi√©e par l'utilisateur.

Il existe des milliers de permissions dans GCP. Pour v√©rifier si un r√¥le a une permission, vous pouvez [**chercher la permission ici**](https://cloud.google.com/iam/docs/permissions-reference) et voir quels r√¥les l'ont.

Vous pouvez √©galement [**chercher ici les r√¥les pr√©d√©finis**](https://cloud.google.com/iam/docs/understanding-roles#product\_specific\_documentation) **offerts par chaque produit.** Notez que certains **r√¥les** ne peuvent pas √™tre attach√©s √† des utilisateurs et **uniquement √† des SAs en raison de certaines permissions** qu'ils contiennent.\
De plus, notez que les **permissions** ne **prendront effet** que si elles sont **attach√©es au service pertinent.**

Ou v√©rifiez si un **r√¥le personnalis√© peut utiliser une** [**permission sp√©cifique ici**](https://cloud.google.com/iam/docs/custom-roles-permissions-support)**.**

{% content-ref url="../gcp-services/gcp-iam-and-org-policies-enum.md" %}
[gcp-iam-and-org-policies-enum.md](../gcp-services/gcp-iam-and-org-policies-enum.md)
{% endcontent-ref %}

## Utilisateurs <a href="#default-credentials" id="default-credentials"></a>

Dans la **console GCP**, il **n'y a pas de gestion des Utilisateurs ou Groupes**, cela se fait dans **Google Workspace**. Bien que vous puissiez synchroniser un autre fournisseur d'identit√© dans Google Workspace.

Vous pouvez acc√©der aux **utilisateurs et groupes de Workspaces** √† [**https://admin.google.com**](https://admin.google.com/).

**MFA** peut √™tre **forc√©e** pour les utilisateurs de Workspaces, cependant, un **attaquant** pourrait utiliser un jeton pour acc√©der √† GCP **via cli qui ne sera pas prot√©g√© par MFA** (il sera prot√©g√© par MFA uniquement lorsque l'utilisateur se connecte pour le g√©n√©rer : `gcloud auth login`).

## Groupes

Lorsqu'une organisation est cr√©√©e, plusieurs groupes sont **fortement sugg√©r√©s √† √™tre cr√©√©s.** Si vous g√©rez l'un d'eux, vous pourriez avoir compromis tout ou une partie importante de l'organisation :

<table data-header-hidden><thead><tr><th width="299.3076923076923"></th><th></th></tr></thead><tbody><tr><td><strong>Groupe</strong></td><td><strong>Fonction</strong></td></tr><tr><td><strong><code>gcp-organization-admins</code></strong><br><em>(groupes ou comptes individuels requis pour la liste de contr√¥le)</em></td><td>Administrer toute ressource appartenant √† l'organisation. Attribuez ce r√¥le avec parcimonie ; les administrateurs d'organisation ont acc√®s √† toutes vos ressources Google Cloud. Alternativement, comme cette fonction est hautement privil√©gi√©e, envisagez d'utiliser des comptes individuels au lieu de cr√©er un groupe.</td></tr><tr><td><strong><code>gcp-network-admins</code></strong><br><em>(requis pour la liste de contr√¥le)</em></td><td>Cr√©er des r√©seaux, sous-r√©seaux, r√®gles de pare-feu et dispositifs r√©seau tels que Cloud Router, Cloud VPN et √©quilibreurs de charge cloud.</td></tr><tr><td><strong><code>gcp-billing-admins</code></strong><br><em>(requis pour la liste de contr√¥le)</em></td><td>Configurer des comptes de facturation et surveiller leur utilisation.</td></tr><tr><td><strong><code>gcp-developers</code></strong><br><em>(requis pour la liste de contr√¥le)</em></td><td>Concevoir, coder et tester des applications.</td></tr><tr><td><strong><code>gcp-security-admins</code></strong><br></td><td>√âtablir et g√©rer des politiques de s√©curit√© pour l'ensemble de l'organisation, y compris la gestion des acc√®s et les <a href="https://cloud.google.com/resource-manager/docs/organization-policy/org-policy-constraints">politiques de contraintes d'organisation</a>. Consultez le <a href="https://cloud.google.com/architecture/security-foundations/authentication-authorization#users_and_groups">guide des fondations de s√©curit√© Google Cloud</a> pour plus d'informations sur la planification de votre infrastructure de s√©curit√© Google Cloud.</td></tr><tr><td><strong><code>gcp-devops</code></strong></td><td>Cr√©er ou g√©rer des pipelines de bout en bout qui soutiennent l'int√©gration et la livraison continues, la surveillance et la provision de syst√®mes.</td></tr><tr><td><strong><code>gcp-logging-admins</code></strong></td><td></td></tr><tr><td><strong><code>gcp-logging-viewers</code></strong></td><td></td></tr><tr><td><strong><code>gcp-monitor-admins</code></strong></td><td></td></tr><tr><td><strong><code>gcp-billing-viewer</code></strong><br><em>(plus par d√©faut)</em></td><td>Surveiller les d√©penses sur les projets. Les membres typiques font partie de l'√©quipe financi√®re.</td></tr><tr><td><strong><code>gcp-platform-viewer</code></strong><br><em>(plus par d√©faut)</em></td><td>Examiner les informations sur les ressources √† travers l'organisation Google Cloud.</td></tr><tr><td><strong><code>gcp-security-reviewer</code></strong><br><em>(plus par d√©faut)</em></td><td>Examiner la s√©curit√© cloud.</td></tr><tr><td><strong><code>gcp-network-viewer</code></strong><br><em>(plus par d√©faut)</em></td><td>Examiner les configurations r√©seau.</td></tr><tr><td><strong><code>grp-gcp-audit-viewer</code></strong><br><em>(plus par d√©faut)</em></td><td>Voir les journaux d'audit.</td></tr><tr><td><strong><code>gcp-scc-admin</code></strong><br><em>(plus par d√©faut)</em></td><td>Administrer le Security Command Center.</td></tr><tr><td><strong><code>gcp-secrets-admin</code></strong><br><em>(plus par d√©faut)</em></td><td>G√©rer les secrets dans Secret Manager.</td></tr></tbody></table>

## **Politique de Mot de Passe par D√©faut**

* Appliquer des mots de passe forts
* Entre 8 et 100 caract√®res
* Pas de r√©utilisation
* Pas d'expiration
* Si des personnes acc√®dent √† Workspace via un fournisseur tiers, ces exigences ne s'appliquent pas.

<figure><img src="../../../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

## **Comptes de service**

Ce sont les principaux que **les ressources** peuvent **avoir** **attach√©s** et acc√©der pour interagir facilement avec GCP. Par exemple, il est possible d'acc√©der au **jeton d'authentification** d'un compte de service **attach√© √† une VM** dans les m√©tadonn√©es.\
Il est possible de rencontrer certains **conflits** lors de l'utilisation √† la fois de **l'IAM et des port√©es d'acc√®s**. Par exemple, votre compte de service peut avoir le r√¥le IAM de `compute.instanceAdmin`, mais l'instance que vous avez compromise a √©t√© limit√©e par la restriction de port√©e de `https://www.googleapis.com/auth/compute.readonly`. Cela vous emp√™cherait d'apporter des modifications en utilisant le jeton OAuth qui est automatiquement attribu√© √† votre instance.

C'est similaire aux **r√¥les IAM d'AWS**. Mais contrairement √† AWS, **tout** compte de service peut √™tre **attach√© √† n'importe quel service** (il n'est pas n√©cessaire de l'autoriser via une politique).

Plusieurs des comptes de service que vous trouverez sont en fait **g√©n√©r√©s automatiquement par GCP** lorsque vous commencez √† utiliser un service, comme :
```
PROJECT_NUMBER-compute@developer.gserviceaccount.com
PROJECT_ID@appspot.gserviceaccount.com
```
Cependant, il est √©galement possible de cr√©er et d'attacher des **comptes de service personnalis√©s** aux ressources, qui ressembleront √† ceci :
```
SERVICE_ACCOUNT_NAME@PROJECT_NAME.iam.gserviceaccount.com
```
### **Cl√©s & Jetons**

Il existe 2 principales fa√ßons d'acc√©der √† GCP en tant que compte de service :

* **Via des jetons OAuth** : Ce sont des jetons que vous obtiendrez √† partir d'endroits comme les points de terminaison de m√©tadonn√©es ou en volant des requ√™tes http et ils sont limit√©s par les **port√©es d'acc√®s**.
* **Cl√©s** : Ce sont des paires de cl√©s publiques et priv√©es qui vous permettront de signer des requ√™tes en tant que compte de service et m√™me de g√©n√©rer des jetons OAuth pour effectuer des actions en tant que compte de service. Ces cl√©s sont dangereuses car elles sont plus compliqu√©es √† limiter et √† contr√¥ler, c'est pourquoi GCP recommande de ne pas les g√©n√©rer.
* Notez que chaque fois qu'un SA est cr√©√©, **GCP g√©n√®re une cl√© pour le compte de service** √† laquelle l'utilisateur n'a pas acc√®s (et qui ne sera pas list√©e dans l'application web). Selon [**ce fil**](https://www.reddit.com/r/googlecloud/comments/f0ospy/service\_account\_keys\_observations/), cette cl√© est **utilis√©e en interne par GCP** pour donner acc√®s aux points de terminaison de m√©tadonn√©es afin de g√©n√©rer les jetons OAuth accessibles.

### **Port√©es d'acc√®s**

Les port√©es d'acc√®s sont **attach√©es aux jetons OAuth g√©n√©r√©s** pour acc√©der aux points de terminaison de l'API GCP. Elles **restreignent les permissions** du jeton OAuth.\
Cela signifie que si un jeton appartient √† un propri√©taire d'une ressource mais n'a pas la port√©e dans le jeton pour acc√©der √† cette ressource, le jeton **ne peut pas √™tre utilis√© pour (ab)user de ces privil√®ges**.

Google recommande en fait [de ne pas utiliser](https://cloud.google.com/compute/docs/access/service-accounts#service\_account\_permissions) les **port√©es d'acc√®s et de se fier totalement √† IAM**. Le portail de gestion web impose en fait cela, mais les port√©es d'acc√®s peuvent toujours √™tre appliqu√©es aux instances en utilisant des comptes de service personnalis√©s de mani√®re programmatique.

Vous pouvez voir quelles **port√©es** sont **assign√©es** en **interrogeant :**

{% code overflow="wrap" %}
```bash
curl 'https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=<access_token>'

{
"issued_to": "223044615559.apps.googleusercontent.com",
"audience": "223044615559.apps.googleusercontent.com",
"user_id": "139746512919298469201",
"scope": "openid https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/appengine.admin https://www.googleapis.com/auth/sqlservice.login https://www.googleapis.com/auth/compute https://www.googleapis.com/auth/accounts.reauth",
"expires_in": 2253,
"email": "username@testing.com",
"verified_email": true,
"access_type": "offline"
}
```
{% endcode %}

Les **port√©es** pr√©c√©dentes sont celles g√©n√©r√©es par **d√©faut** en utilisant **`gcloud`** pour acc√©der aux donn√©es. Cela est d√ª au fait que lorsque vous utilisez **`gcloud`**, vous cr√©ez d'abord un jeton OAuth, puis l'utilisez pour contacter les points de terminaison.

La port√©e la plus importante de celles-ci est **`cloud-platform`**, ce qui signifie essentiellement qu'il est possible d'**acc√©der √† n'importe quel service dans GCP**.

Vous pouvez **trouver une liste de** [**toutes les port√©es possibles ici**](https://developers.google.com/identity/protocols/googlescopes)**.**

Si vous avez des identifiants de navigateur **`gcloud`**, il est possible d'**obtenir un jeton avec d'autres port√©es,** en faisant quelque chose comme :

{% code overflow="wrap" %}
```bash
# Maybe you can get a user token with other scopes changing the scopes array from ~/.config/gcloud/credentials.db

# Set new scopes for SDKs credentials
gcloud auth application-default login --scopes=https://www.googleapis.com/auth/userinfo.email,https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/sqlservice.login,https://www.googleapis.com/auth/appengine.admin,https://www.googleapis.com/auth/compute,https://www.googleapis.com/auth/accounts.reauth,https://www.googleapis.com/auth/admin.directory.user,https://www.googleapis.com/auth/admin.directory.group,https://www.googleapis.com/auth/admin.directory.domain,https://www.googleapis.com/auth/admin.directory.user

# Print new token
gcloud auth application-default print-access-token

# To use this token with some API you might need to use curl to indicate the project header with --header "X-Goog-User-Project: <project-name>"
```
{% endcode %}

## **Politiques IAM Terraform, Liens et Adh√©sions**

Comme d√©fini par terraform dans [https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google\_project\_iam](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google\_project\_iam), en utilisant terraform avec GCP, il existe diff√©rentes mani√®res d'accorder √† un principal l'acc√®s √† une ressource :

* **Adh√©sions** : Vous d√©finissez **des principaux comme membres de r√¥les** **sans restrictions** sur le r√¥le ou les principaux. Vous pouvez mettre un utilisateur comme membre d'un r√¥le, puis mettre un groupe comme membre du m√™me r√¥le et √©galement d√©finir ces principaux (utilisateur et groupe) comme membres d'autres r√¥les.
* **Liens** : Plusieurs **principaux peuvent √™tre li√©s √† un r√¥le**. Ces **principaux peuvent toujours √™tre li√©s ou √™tre membres d'autres r√¥les**. Cependant, si un principal qui n'est pas li√© au r√¥le est d√©fini comme **membre d'un r√¥le li√©**, la prochaine fois que le **lien est appliqu√©, l'adh√©sion dispara√Ætra**.
* **Politiques** : Une politique est **autoritaire**, elle indique des r√¥les et des principaux et ensuite, **ces principaux ne peuvent pas avoir plus de r√¥les et ces r√¥les ne peuvent pas avoir plus de principaux** √† moins que cette politique ne soit modifi√©e (pas m√™me dans d'autres politiques, liens ou adh√©sions). Par cons√©quent, lorsqu'un r√¥le ou un principal est sp√©cifi√© dans la politique, tous ses privil√®ges sont **limit√©s par cette politique**. √âvidemment, cela peut √™tre contourn√© si le principal a la possibilit√© de modifier la politique ou des permissions d'escalade de privil√®ges (comme cr√©er un nouveau principal et le lier √† un nouveau r√¥le).

## R√©f√©rences

* [https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/](https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/)
* [https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
