# GCP - Informa√ß√µes B√°sicas

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte ao HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## **Hierarquia de recursos**

O Google Cloud usa uma [Hierarquia de recursos](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy) que √© semelhante, conceitualmente, √† de um sistema de arquivos tradicional. Isso fornece um fluxo de trabalho l√≥gico de pai/filho com pontos de anexo espec√≠ficos para pol√≠ticas e permiss√µes.

Em um n√≠vel alto, parece assim:
```
Organization
--> Folders
--> Projects
--> Resources
```
Uma m√°quina virtual (chamada de Inst√¢ncia de Computa√ß√£o) √© um recurso. Um recurso reside em um projeto, provavelmente ao lado de outras Inst√¢ncias de Computa√ß√£o, buckets de armazenamento, etc.

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1).png" alt=""><figcaption><p><a href="https://cloud.google.com/static/resource-manager/img/cloud-hierarchy.svg">https://cloud.google.com/static/resource-manager/img/cloud-hierarchy.svg</a></p></figcaption></figure>

## **Migra√ß√£o de Projetos**

√â poss√≠vel **migrar um projeto sem nenhuma organiza√ß√£o** para uma organiza√ß√£o com as permiss√µes `roles/resourcemanager.projectCreator` e `roles/resourcemanager.projectMover`. Se o projeto estiver dentro de outra organiza√ß√£o, √© necess√°rio entrar em contato com o suporte do GCP para **mov√™-lo para fora da organiza√ß√£o primeiro**. Para mais informa√ß√µes, consulte [**isso**](https://medium.com/google-cloud/migrating-a-project-from-one-organization-to-another-gcp-4b37a86dd9e6).

## **Pol√≠ticas de Organiza√ß√£o**

Permitem centralizar o controle sobre os recursos em nuvem da sua organiza√ß√£o:

* Centralizar o controle para **configurar restri√ß√µes** sobre como os recursos da sua organiza√ß√£o podem ser usados.
* Definir e estabelecer **diretrizes** para que suas equipes de desenvolvimento permane√ßam dentro dos limites de conformidade.
* Ajudar os propriet√°rios de projetos e suas equipes a se moverem rapidamente sem se preocupar em quebrar a conformidade.

Essas pol√≠ticas podem ser criadas para **afetar a organiza√ß√£o completa, pasta(s) ou projeto(s)**. Os descendentes do n√≥ da hierarquia de recursos alvo **herdam a pol√≠tica da organiza√ß√£o**.

Para **definir** uma pol√≠tica de organiza√ß√£o, **voc√™ escolhe uma** [**restri√ß√£o**](https://cloud.google.com/resource-manager/docs/organization-policy/overview#constraints), que √© um tipo particular de restri√ß√£o contra um servi√ßo do Google Cloud ou um grupo de servi√ßos do Google Cloud. Voc√™ **configura essa restri√ß√£o com suas restri√ß√µes desejadas**.

<figure><img src="../../../.gitbook/assets/image (217).png" alt=""><figcaption><p><a href="https://cloud.google.com/resource-manager/img/org-policy-concepts.svg">https://cloud.google.com/resource-manager/img/org-policy-concepts.svg</a></p></figcaption></figure>

#### Casos de uso comuns <a href="#common_use_cases" id="common_use_cases"></a>

* Limitar o compartilhamento de recursos com base no dom√≠nio.
* Limitar o uso de contas de servi√ßo do Identity and Access Management.
* Restringir a localiza√ß√£o f√≠sica de recursos rec√©m-criados.
* Desabilitar a cria√ß√£o de contas de servi√ßo.

<figure><img src="../../../.gitbook/assets/image (172).png" alt=""><figcaption></figcaption></figure>

Existem muitas outras restri√ß√µes que oferecem controle detalhado sobre os recursos da sua organiza√ß√£o. Para **mais informa√ß√µes, veja a** [**lista de todas as restri√ß√µes do Servi√ßo de Pol√≠tica de Organiza√ß√£o**](https://cloud.google.com/resource-manager/docs/organization-policy/org-policy-constraints)**.**

### **Pol√≠ticas de Organiza√ß√£o Padr√£o**

<details>

<summary>Estas s√£o as pol√≠ticas que o Google adicionar√° por padr√£o ao configurar sua organiza√ß√£o GCP:</summary>

**Pol√≠ticas de Gerenciamento de Acesso**

* **Contatos restritos por dom√≠nio:** Impede a adi√ß√£o de usu√°rios a Contatos Essenciais fora dos dom√≠nios especificados. Isso limita os Contatos Essenciais a permitir apenas identidades de usu√°rios gerenciados em seus dom√≠nios selecionados para receber notifica√ß√µes da plataforma.
* **Compartilhamento restrito por dom√≠nio:** Impede a adi√ß√£o de usu√°rios a pol√≠ticas IAM fora dos dom√≠nios especificados. Isso limita as pol√≠ticas IAM a permitir apenas identidades de usu√°rios gerenciados em seus dom√≠nios selecionados para acessar recursos dentro desta organiza√ß√£o.
* **Preven√ß√£o de acesso p√∫blico:** Impede que buckets do Cloud Storage sejam expostos ao p√∫blico. Isso garante que um desenvolvedor n√£o possa configurar buckets do Cloud Storage para ter acesso √† internet n√£o autenticado.
* **Acesso uniforme ao n√≠vel do bucket:** Impede listas de controle de acesso (ACLs) em n√≠vel de objeto em buckets do Cloud Storage. Isso simplifica seu gerenciamento de acesso aplicando pol√≠ticas IAM de forma consistente em todos os objetos nos buckets do Cloud Storage.
* **Exigir login do SO:** VMs criadas em novos projetos ter√£o o Login do SO habilitado. Isso permite gerenciar o acesso SSH √†s suas inst√¢ncias usando IAM sem precisar criar e gerenciar chaves SSH individuais.

**Pol√≠ticas de seguran√ßa adicionais para contas de servi√ßo**

* **Desabilitar concess√µes autom√°ticas de IAM:** Impede que as contas de servi√ßo padr√£o do App Engine e do Compute Engine sejam automaticamente concedidas o papel de Editor IAM em um projeto na cria√ß√£o. Isso garante que as contas de servi√ßo n√£o recebam pap√©is IAM excessivamente permissivos ao serem criadas.
* **Desabilitar a cria√ß√£o de chaves de conta de servi√ßo:** Impede a cria√ß√£o de chaves de conta de servi√ßo p√∫blicas. Isso ajuda a reduzir o risco de expor credenciais persistentes.
* **Desabilitar o upload de chaves de conta de servi√ßo:** Impede o upload de chaves de conta de servi√ßo p√∫blicas. Isso ajuda a reduzir o risco de vazamento ou reutiliza√ß√£o de material de chave.

**Pol√≠ticas de configura√ß√£o de rede VPC seguras**

* **Definir IPs externos permitidos para inst√¢ncias de VM:** Impede a cria√ß√£o de inst√¢ncias de Computa√ß√£o com um IP p√∫blico, o que pode exp√¥-las ao tr√°fego da internet.

<!---->

* **Desabilitar virtualiza√ß√£o aninhada de VM:** Impede a cria√ß√£o de VMs aninhadas em VMs do Compute Engine. Isso diminui o risco de seguran√ßa de ter VMs aninhadas n√£o monitoradas.

<!---->

* **Desabilitar porta serial de VM:** Impede o acesso √† porta serial das VMs do Compute Engine. Isso impede a entrada na porta serial de um servidor usando a API do Compute Engine.

<!---->

* **Restringir redes autorizadas em inst√¢ncias do Cloud SQL:** Impede que intervalos de rede p√∫blicos ou n√£o internos acessem seus bancos de dados do Cloud SQL.

<!---->

* **Restringir o encaminhamento de protocolo com base no tipo de endere√ßo IP:** Impede o encaminhamento de protocolo de VM para endere√ßos IP externos.

<!---->

* **Restringir acesso IP p√∫blico em inst√¢ncias do Cloud SQL:** Impede a cria√ß√£o de inst√¢ncias do Cloud SQL com um IP p√∫blico, o que pode exp√¥-las ao tr√°fego da internet.

<!---->

* **Restringir a remo√ß√£o de √¥nus de projeto VPC compartilhado:** Impede a exclus√£o acidental de projetos host VPC compartilhados.

<!---->

* **Define a configura√ß√£o de DNS interno para novos projetos como Apenas DNS Zonal:** Impede o uso de uma configura√ß√£o de DNS legada que reduziu a disponibilidade do servi√ßo.

<!---->

* **Pular a cria√ß√£o de rede padr√£o:** Impede a cria√ß√£o autom√°tica da rede VPC padr√£o e recursos relacionados. Isso evita regras de firewall padr√£o excessivamente permissivas.

<!---->

* **Desabilitar uso de IPv6 externo VPC:** Impede a cria√ß√£o de sub-redes IPv6 externas, que podem ser expostas a acesso n√£o autorizado √† internet.

</details>

## **Pap√©is IAM**

Estes s√£o como pol√≠ticas IAM na AWS, pois **cada papel cont√©m um conjunto de permiss√µes.**

No entanto, ao contr√°rio da AWS, n√£o h√° **um reposit√≥rio centralizado** de pap√©is. Em vez disso, **recursos d√£o X pap√©is de acesso a Y principais**, e a √∫nica maneira de descobrir quem tem acesso a um recurso √© usar o **m√©todo `get-iam-policy` sobre esse recurso**.\
Isso pode ser um problema porque isso significa que a √∫nica maneira de descobrir **quais permiss√µes um principal tem √© perguntar a cada recurso a quem ele est√° concedendo permiss√µes**, e um usu√°rio pode n√£o ter permiss√µes para obter permiss√µes de todos os recursos.

Existem **tr√™s tipos** de pap√©is no IAM:

* **Pap√©is B√°sicos/Primitivos**, que incluem os pap√©is de **Propriet√°rio**, **Editor** e **Visualizador** que existiam antes da introdu√ß√£o do IAM.
* **Pap√©is Predefinidos**, que fornecem acesso granular para um servi√ßo espec√≠fico e s√£o gerenciados pelo Google Cloud. Existem muitos pap√©is predefinidos, voc√™ pode **ver todos eles com os privil√©gios que possuem** [**aqui**](https://cloud.google.com/iam/docs/understanding-roles#predefined\_roles).
* **Pap√©is Personalizados**, que fornecem acesso granular de acordo com uma lista de permiss√µes especificada pelo usu√°rio.

Existem milhares de permiss√µes no GCP. Para verificar se um papel tem uma permiss√£o, voc√™ pode [**pesquisar a permiss√£o aqui**](https://cloud.google.com/iam/docs/permissions-reference) e ver quais pap√©is a possuem.

Voc√™ tamb√©m pode [**pesquisar aqui pap√©is predefinidos**](https://cloud.google.com/iam/docs/understanding-roles#product\_specific\_documentation) **oferecidos por cada produto.** Note que alguns **pap√©is** n√£o podem ser anexados a usu√°rios e **apenas a SAs devido a algumas permiss√µes** que cont√™m.\
Al√©m disso, note que **as permiss√µes** s√≥ **ter√£o efeito** se estiverem **anexadas ao servi√ßo relevante.**

Ou verifique se um **papel personalizado pode usar uma** [**permiss√£o espec√≠fica aqui**](https://cloud.google.com/iam/docs/custom-roles-permissions-support)**.**

{% content-ref url="../gcp-services/gcp-iam-and-org-policies-enum.md" %}
[gcp-iam-and-org-policies-enum.md](../gcp-services/gcp-iam-and-org-policies-enum.md)
{% endcontent-ref %}

## Usu√°rios <a href="#default-credentials" id="default-credentials"></a>

Na **console do GCP** n√£o h√° gerenciamento de Usu√°rios ou Grupos, isso √© feito no **Google Workspace**. Embora voc√™ possa sincronizar um provedor de identidade diferente no Google Workspace.

Voc√™ pode acessar os **usu√°rios e grupos do Workspaces em** [**https://admin.google.com**](https://admin.google.com/).

**MFA** pode ser **for√ßada** para usu√°rios do Workspaces, no entanto, um **atacante** pode usar um token para acessar o GCP **via cli que n√£o estar√° protegido por MFA** (ele ser√° protegido por MFA apenas quando o usu√°rio fizer login para ger√°-lo: `gcloud auth login`).

## Grupos

Quando uma organiza√ß√£o √© criada, v√°rios grupos s√£o **fortemente sugeridos para serem criados.** Se voc√™ gerenciar algum deles, pode ter comprometido toda ou uma parte importante da organiza√ß√£o:

<table data-header-hidden><thead><tr><th width="299.3076923076923"></th><th></th></tr></thead><tbody><tr><td><strong>Grupo</strong></td><td><strong>Fun√ß√£o</strong></td></tr><tr><td><strong><code>gcp-organization-admins</code></strong><br><em>(grupo ou contas individuais necess√°rias para a lista de verifica√ß√£o)</em></td><td>Administrar qualquer recurso que perten√ßa √† organiza√ß√£o. Atribua este papel com modera√ß√£o; os administradores da organiza√ß√£o t√™m acesso a todos os seus recursos do Google Cloud. Como alternativa, devido a essa fun√ß√£o ser altamente privilegiada, considere usar contas individuais em vez de criar um grupo.</td></tr><tr><td><strong><code>gcp-network-admins</code></strong><br><em>(necess√°rio para a lista de verifica√ß√£o)</em></td><td>Criar redes, sub-redes, regras de firewall e dispositivos de rede, como Cloud Router, Cloud VPN e balanceadores de carga em nuvem.</td></tr><tr><td><strong><code>gcp-billing-admins</code></strong><br><em>(necess√°rio para a lista de verifica√ß√£o)</em></td><td>Configurar contas de faturamento e monitorar seu uso.</td></tr><tr><td><strong><code>gcp-developers</code></strong><br><em>(necess√°rio para a lista de verifica√ß√£o)</em></td><td>Projetar, codificar e testar aplicativos.</td></tr><tr><td><strong><code>gcp-security-admins</code></strong><br></td><td>Estabelecer e gerenciar pol√≠ticas de seguran√ßa para toda a organiza√ß√£o, incluindo gerenciamento de acesso e <a href="https://cloud.google.com/resource-manager/docs/organization-policy/org-policy-constraints">pol√≠ticas de restri√ß√£o da organiza√ß√£o</a>. Consulte o <a href="https://cloud.google.com/architecture/security-foundations/authentication-authorization#users_and_groups">guia de fundamentos de seguran√ßa do Google Cloud</a> para mais informa√ß√µes sobre como planejar sua infraestrutura de seguran√ßa do Google Cloud.</td></tr><tr><td><strong><code>gcp-devops</code></strong></td><td>Criar ou gerenciar pipelines de ponta a ponta que suportam integra√ß√£o e entrega cont√≠nuas, monitoramento e provisionamento de sistemas.</td></tr><tr><td><strong><code>gcp-logging-admins</code></strong></td><td></td></tr><tr><td><strong><code>gcp-logging-viewers</code></strong></td><td></td></tr><tr><td><strong><code>gcp-monitor-admins</code></strong></td><td></td></tr><tr><td><strong><code>gcp-billing-viewer</code></strong><br><em>(n√£o mais por padr√£o)</em></td><td>Monitorar os gastos em projetos. Membros t√≠picos fazem parte da equipe financeira.</td></tr><tr><td><strong><code>gcp-platform-viewer</code></strong><br><em>(n√£o mais por padr√£o)</em></td><td>Revisar informa√ß√µes de recursos em toda a organiza√ß√£o do Google Cloud.</td></tr><tr><td><strong><code>gcp-security-reviewer</code></strong><br><em>(n√£o mais por padr√£o)</em></td><td>Revisar a seguran√ßa em nuvem.</td></tr><tr><td><strong><code>gcp-network-viewer</code></strong><br><em>(n√£o mais por padr√£o)</em></td><td>Revisar configura√ß√µes de rede.</td></tr><tr><td><strong><code>grp-gcp-audit-viewer</code></strong><br><em>(n√£o mais por padr√£o)</em></td><td>Visualizar logs de auditoria.</td></tr><tr><td><strong><code>gcp-scc-admin</code></strong><br><em>(n√£o mais por padr√£o)</em></td><td>Administrar o Security Command Center.</td></tr><tr><td><strong><code>gcp-secrets-admin</code></strong><br><em>(n√£o mais por padr√£o)</em></td><td>Gerenciar segredos no Secret Manager.</td></tr></tbody></table>

## **Pol√≠tica de Senhas Padr√£o**

* Impor senhas fortes
* Entre 8 e 100 caracteres
* Sem reutiliza√ß√£o
* Sem expira√ß√£o
* Se as pessoas estiverem acessando o Workspace atrav√©s de um provedor de terceiros, esses requisitos n√£o s√£o aplicados.

<figure><img src="../../../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

## **Contas de servi√ßo**

Estas s√£o os principais que **recursos** podem **ter** **anexados** e acesso para interagir facilmente com o GCP. Por exemplo, √© poss√≠vel acessar o **token de autentica√ß√£o** de uma Conta de Servi√ßo **anexada a uma VM** nos metadados.\
√â poss√≠vel encontrar alguns **conflitos** ao usar tanto **IAM quanto escopos de acesso**. Por exemplo, sua conta de servi√ßo pode ter o papel IAM de `compute.instanceAdmin`, mas a inst√¢ncia que voc√™ invadiu foi limitada com a restri√ß√£o de escopo de `https://www.googleapis.com/auth/compute.readonly`. Isso impediria que voc√™ fizesse quaisquer altera√ß√µes usando o token OAuth que √© automaticamente atribu√≠do √† sua inst√¢ncia.

√â semelhante aos **pap√©is IAM da AWS**. Mas, ao contr√°rio da AWS, **qualquer** conta de servi√ßo pode ser **anexada a qualquer servi√ßo** (n√£o precisa permitir isso por meio de uma pol√≠tica).

V√°rias das contas de servi√ßo que voc√™ encontrar√° s√£o, na verdade, **geradas automaticamente pelo GCP** quando voc√™ come√ßa a usar um servi√ßo, como:
```
PROJECT_NUMBER-compute@developer.gserviceaccount.com
PROJECT_ID@appspot.gserviceaccount.com
```
No entanto, tamb√©m √© poss√≠vel criar e anexar a recursos **contas de servi√ßo personalizadas**, que ter√£o a seguinte apar√™ncia:
```
SERVICE_ACCOUNT_NAME@PROJECT_NAME.iam.gserviceaccount.com
```
### **Chaves e Tokens**

Existem 2 maneiras principais de acessar o GCP como uma conta de servi√ßo:

* **Via tokens OAuth**: Esses s√£o tokens que voc√™ obter√° de lugares como endpoints de metadados ou roubando requisi√ß√µes http e s√£o limitados pelos **escopos de acesso**.
* **Chaves**: Esses s√£o pares de chaves p√∫blicas e privadas que permitir√£o que voc√™ assine requisi√ß√µes como a conta de servi√ßo e at√© mesmo gere tokens OAuth para realizar a√ß√µes como a conta de servi√ßo. Essas chaves s√£o perigosas porque s√£o mais complicadas de limitar e controlar, por isso o GCP recomenda n√£o ger√°-las.
* Note que toda vez que uma SA √© criada, **o GCP gera uma chave para a conta de servi√ßo** que o usu√°rio n√£o pode acessar (e n√£o ser√° listada na aplica√ß√£o web). De acordo com [**este t√≥pico**](https://www.reddit.com/r/googlecloud/comments/f0ospy/service\_account\_keys\_observations/), essa chave √© **usada internamente pelo GCP** para dar acesso aos endpoints de metadados para gerar os tokens OAuth acess√≠veis.

### **Escopos de Acesso**

Os escopos de acesso s√£o **anexados aos tokens OAuth gerados** para acessar os endpoints da API do GCP. Eles **restrigem as permiss√µes** do token OAuth.\
Isso significa que se um token pertence a um Propriet√°rio de um recurso, mas n√£o tem no escopo do token acesso a esse recurso, o token **n√£o pode ser usado para (ab)usar esses privil√©gios**.

O Google na verdade [recomenda](https://cloud.google.com/compute/docs/access/service-accounts#service\_account\_permissions) que **os escopos de acesso n√£o sejam usados e que se confie totalmente no IAM**. O portal de gerenciamento web realmente imp√µe isso, mas os escopos de acesso ainda podem ser aplicados a inst√¢ncias usando contas de servi√ßo personalizadas programaticamente.

Voc√™ pode ver quais **escopos** est√£o **atribu√≠dos** consultando:

{% code overflow="wrap" %}
```bash
curl 'https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=<access_token>'

{
"issued_to": "223044615559.apps.googleusercontent.com",
"audience": "223044615559.apps.googleusercontent.com",
"user_id": "139746512919298469201",
"scope": "openid https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/appengine.admin https://www.googleapis.com/auth/sqlservice.login https://www.googleapis.com/auth/compute https://www.googleapis.com/auth/accounts.reauth",
"expires_in": 2253,
"email": "username@testing.com",
"verified_email": true,
"access_type": "offline"
}
```
{% endcode %}

Os **escopos** anteriores s√£o os gerados por **padr√£o** usando **`gcloud`** para acessar dados. Isso ocorre porque, ao usar **`gcloud`**, voc√™ primeiro cria um token OAuth e, em seguida, o utiliza para contatar os endpoints.

O escopo mais importante entre eles √© **`cloud-platform`**, que basicamente significa que √© poss√≠vel **acessar qualquer servi√ßo no GCP**.

Voc√™ pode **encontrar uma lista de** [**todos os escopos poss√≠veis aqui**](https://developers.google.com/identity/protocols/googlescopes)**.**

Se voc√™ tiver credenciais de navegador **`gcloud`**, √© poss√≠vel **obter um token com outros escopos,** fazendo algo como:

{% code overflow="wrap" %}
```bash
# Maybe you can get a user token with other scopes changing the scopes array from ~/.config/gcloud/credentials.db

# Set new scopes for SDKs credentials
gcloud auth application-default login --scopes=https://www.googleapis.com/auth/userinfo.email,https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/sqlservice.login,https://www.googleapis.com/auth/appengine.admin,https://www.googleapis.com/auth/compute,https://www.googleapis.com/auth/accounts.reauth,https://www.googleapis.com/auth/admin.directory.user,https://www.googleapis.com/auth/admin.directory.group,https://www.googleapis.com/auth/admin.directory.domain,https://www.googleapis.com/auth/admin.directory.user

# Print new token
gcloud auth application-default print-access-token

# To use this token with some API you might need to use curl to indicate the project header with --header "X-Goog-User-Project: <project-name>"
```
{% endcode %}

## **Pol√≠ticas, V√≠nculos e Membros IAM do Terraform**

Como definido pelo terraform em [https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google\_project\_iam](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google\_project\_iam), usando terraform com GCP, existem diferentes maneiras de conceder a um principal acesso a um recurso:

* **Membros**: Voc√™ define **principais como membros de pap√©is** **sem restri√ß√µes** sobre o papel ou os principais. Voc√™ pode colocar um usu√°rio como membro de um papel e, em seguida, colocar um grupo como membro do mesmo papel e tamb√©m definir esses principais (usu√°rio e grupo) como membros de outros pap√©is.
* **V√≠nculos**: V√°rios **principais podem ser vinculados a um papel**. Esses **principais ainda podem ser vinculados ou ser membros de outros pap√©is**. No entanto, se um principal que n√£o est√° vinculado ao papel for definido como **membro de um papel vinculado**, na pr√≥xima vez que o **v√≠nculo for aplicado, a associa√ß√£o desaparecer√°**.
* **Pol√≠ticas**: Uma pol√≠tica √© **autoritativa**, indica pap√©is e principais e, ent√£o, **esses principais n√£o podem ter mais pap√©is e esses pap√©is n√£o podem ter mais principais** a menos que essa pol√≠tica seja modificada (nem mesmo em outras pol√≠ticas, v√≠nculos ou membros). Portanto, quando um papel ou principal √© especificado na pol√≠tica, todos os seus privil√©gios s√£o **limitados por essa pol√≠tica**. Obviamente, isso pode ser contornado caso o principal tenha a op√ß√£o de modificar a pol√≠tica ou permiss√µes de escalonamento de privil√©gios (como criar um novo principal e vincul√°-lo a um novo papel).

## Refer√™ncias

* [https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/](https://about.gitlab.com/blog/2020/02/12/plundering-gcp-escalating-privileges-in-google-cloud-platform/)
* [https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy)

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
