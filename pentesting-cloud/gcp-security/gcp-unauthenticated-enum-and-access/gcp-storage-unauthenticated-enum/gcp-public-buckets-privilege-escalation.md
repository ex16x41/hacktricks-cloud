# GCP - Kamu Bucket'ları Yetki Yükseltme

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Ekip Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Ekip Uzmanı (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## Bucket'larda Yetki Yükseltme

Eğer bucket politikası “allUsers” veya “allAuthenticatedUsers”'ın **bucket politikasını yazmasına** (**storage.buckets.setIamPolicy** izni)** izin veriyorsa,** o zaman herkes bucket politikasını değiştirebilir ve kendisine tam erişim verebilir.

### İzinleri Kontrol Etme

Bir bucket üzerindeki izinleri kontrol etmenin 2 yolu vardır. Birincisi, `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam` adresine bir istek yaparak ya da `gsutil iam get gs://BUCKET_NAME` komutunu çalıştırarak istemektir.

Ancak, eğer kullanıcınız (potansiyel olarak allUsers veya allAuthenticatedUsers'a ait) bucket'ın iam politikasını okumak için izinlere sahip değilse (storage.buckets.getIamPolicy), bu işe yaramaz.

Her zaman işe yarayacak diğer seçenek, bucket'ın testPermissions uç noktasını kullanarak belirli bir izne sahip olup olmadığınızı kontrol etmektir. Örneğin, şu adresi ziyaret ederek: `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam/testPermissions?permissions=storage.buckets.delete&permissions=storage.buckets.get&permissions=storage.buckets.getIamPolicy&permissions=storage.buckets.setIamPolicy&permissions=storage.buckets.update&permissions=storage.objects.create&permissions=storage.objects.delete&permissions=storage.objects.get&permissions=storage.objects.list&permissions=storage.objects.update`

### Yükseltme

`Storage Admin` yetkisini `allAuthenticatedUsers`'a vermek için şu komut çalıştırılabilir:
```bash
gsutil iam ch allAuthenticatedUsers:admin gs://BUCKET_NAME
```
Başka bir saldırı, **bucket'ı kaldırmak ve onu kendi hesabınızda yeniden oluşturmak, böylece sahipliği çalmaktır**.

## Referanslar

* [https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/](https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
