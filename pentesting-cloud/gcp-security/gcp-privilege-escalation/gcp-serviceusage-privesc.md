# GCP - Serviceusage Privesc

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## serviceusage

æ¬¡ã®æ¨©é™ã¯APIã‚­ãƒ¼ã‚’ä½œæˆã—ã€ç›—ã‚€ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰ã®æ³¨æ„ç‚¹: _APIã‚­ãƒ¼ã¯ã€**ãƒ—ãƒªãƒ³ã‚·ãƒ‘ãƒ«ãªã—ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è­˜åˆ¥ã™ã‚‹**ã‚·ãƒ³ãƒ—ãƒ«ãªæš—å·åŒ–ã•ã‚ŒãŸæ–‡å­—åˆ—ã§ã™ã€‚ã“ã‚Œã‚‰ã¯ã€**å…¬å…±ãƒ‡ãƒ¼ã‚¿ã«åŒ¿åã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹**ãŸã‚ã«ä¾¿åˆ©ã§ã‚ã‚Šã€**ã‚¯ã‚©ãƒ¼ã‚¿**ã¨**è«‹æ±‚**ã®ãŸã‚ã«APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«**é–¢é€£ä»˜ã‘ã‚‹**ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚_

ã—ãŸãŒã£ã¦ã€APIã‚­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãã®ä¼šç¤¾ã«APIã®ä½¿ç”¨æ–™ã‚’æ”¯æ‰•ã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€æ¨©é™ã‚’æ˜‡æ ¼ã•ã›ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

ä»–ã®æ¨©é™ã‚„APIã‚­ãƒ¼ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€æ¬¡ã‚’ç¢ºèªã—ã¦ãã ã•ã„:

{% content-ref url="gcp-apikeys-privesc.md" %}
[gcp-apikeys-privesc.md](gcp-apikeys-privesc.md)
{% endcontent-ref %}

### `serviceusage.apiKeys.create`

APIã‚­ãƒ¼ã‚’**ä½œæˆã™ã‚‹**ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹æ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ãªã„APIãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:

{% code overflow="wrap" %}
```bash
curl -XPOST "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
{% endcode %}

### `serviceusage.apiKeys.list`

æ—¢å­˜ã®APIã‚­ãƒ¼ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ãŸã‚ã®åˆ¥ã®æ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ãªã„APIãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼ˆAPIã‚­ãƒ¼ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰ï¼š

{% code overflow="wrap" %}
```bash
curl "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
{% endcode %}

### **`serviceusage.services.enable`** , **`serviceusage.services.use`**

ã“ã‚Œã‚‰ã®æ¨©é™ã‚’æŒã¤æ”»æ’ƒè€…ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹ã«ã—ã€ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€**æ”»æ’ƒè€…ã¯adminã‚„cloudidentityã®ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹ã«ã—ã¦Workspaceæƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã—ãŸã‚Šã€èˆˆå‘³æ·±ã„ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚**

## **References**

* [https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/](https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/)

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

ã‚ãªãŸã¯**ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿã‚ãªãŸã®**ä¼šç¤¾ã‚’HackTricksã§å®£ä¼ã—ãŸã„ã§ã™ã‹**ï¼Ÿãã‚Œã¨ã‚‚**æœ€æ–°ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„ã§ã™ã‹**ï¼Ÿ[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

[**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¦ãã ã•ã„ã€‚ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

[**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

**å‚åŠ ã—ã¦ãã ã•ã„** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«ã€ã¾ãŸã¯**ç§ã‚’** **Twitter**ã§ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

**ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã€** [**hacktricks github repo**](https://github.com/carlospolop/hacktricks)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„\*\*\*\*

**.**

</details>
