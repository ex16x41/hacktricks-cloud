# GCP - Serviceusage Privesc

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## serviceusage

次の権限はAPIキーを作成し、盗むのに役立ちます。ドキュメントからの注意点: _APIキーは、**プリンシパルなしでアプリケーションを識別する**シンプルな暗号化された文字列です。これらは、**公共データに匿名でアクセスする**ために便利であり、**クォータ**と**請求**のためにAPIリクエストをプロジェクトに**関連付ける**ために使用されます。_

したがって、APIキーを使用すると、その会社にAPIの使用料を支払わせることができますが、権限を昇格させることはできません。

他の権限やAPIキーを生成する方法については、次を確認してください:

{% content-ref url="gcp-apikeys-privesc.md" %}
[gcp-apikeys-privesc.md](gcp-apikeys-privesc.md)
{% endcontent-ref %}

### `serviceusage.apiKeys.create`

APIキーを**作成する**ために使用できる文書化されていないAPIが見つかりました:

{% code overflow="wrap" %}
```bash
curl -XPOST "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
{% endcode %}

### `serviceusage.apiKeys.list`

既存のAPIキーをリストするための別の文書化されていないAPIが見つかりました（APIキーはレスポンスに表示されます）：

{% code overflow="wrap" %}
```bash
curl "https://apikeys.clients6.google.com/v1/projects/<project-uniq-name>/apiKeys?access_token=$(gcloud auth print-access-token)"
```
{% endcode %}

### **`serviceusage.services.enable`** , **`serviceusage.services.use`**

これらの権限を持つ攻撃者は、プロジェクト内で新しいサービスを有効にし、使用することができます。これにより、**攻撃者はadminやcloudidentityのようなサービスを有効にしてWorkspace情報にアクセスしようとしたり、興味深いデータにアクセスするための他のサービスを使用したりすることができます。**

## **References**

* [https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/](https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/)

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

あなたは**サイバーセキュリティ会社**で働いていますか？あなたの**会社をHackTricksで宣伝したいですか**？それとも**最新のPEASSにアクセスしたり、HackTricksをPDFでダウンロードしたいですか**？[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！

[**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見してください。私たちの独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションです。

[**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。

**参加してください** [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に、または**私を** **Twitter**でフォローしてください [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

**あなたのハッキングトリックを共有し、** [**hacktricks github repo**](https://github.com/carlospolop/hacktricks)にPRを提出してください\*\*\*\*

**.**

</details>
