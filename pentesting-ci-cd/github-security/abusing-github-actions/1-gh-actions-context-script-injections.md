# Gh Actions - Context Script Injections

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

è¦è¿è¡Œ GitHub Action ç®¡é“ï¼Œç³»ç»Ÿä¸­å¿…é¡»å‘ç”Ÿç‰¹å®šçš„è§¦å‘å™¨ï¼ˆäº‹ä»¶ï¼‰ã€‚è¿™äº›è§¦å‘å™¨ä¸­çš„ä¸€äº›å¯ä»¥ç”± GitHub ä¸Šçš„ä»»ä½•ç”¨æˆ·å‘èµ·ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿæ§åˆ¶ç®¡é“å°†ä½¿ç”¨çš„æŸäº›å‚æ•°ã€‚è¿™äº›å‚æ•°è¢«ç§°ä¸º [**ä¸Šä¸‹æ–‡**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context)ã€‚å¦‚æœè¿™äº›å€¼åœ¨ç®¡é“ä¸­ç”¨äºå‘½ä»¤æ‰§è¡Œè€Œæ²¡æœ‰å¯¹ç”¨æˆ·æ§åˆ¶çš„è¾“å…¥è¿›è¡Œé€‚å½“çš„æ¸…ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´ **ä»»æ„ä»£ç æ‰§è¡Œ**ã€‚

ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸ªåœ¨åˆ›å»ºæ‹‰å–è¯·æ±‚æ—¶è§¦å‘çš„ GitHub Actionã€‚è¯¥æ“ä½œåŒ…å«ä¸€ä¸ª Bash å‘½ä»¤ï¼Œä½¿ç”¨åˆ†æ”¯åç§°å¹¶é€šè¿‡ `echo` å‘½ä»¤è®°å½•å®ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ›å»ºæ‹‰å–è¯·æ±‚çš„ç”¨æˆ·å¯ä»¥æ§åˆ¶åˆ†æ”¯åç§°ï¼Œå¹¶å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„åˆ†æ”¯åç§°ä»¥é€ƒé¿ `echo` å‘½ä»¤çš„ä¸Šä¸‹æ–‡ã€‚è¿™ç§æ“æ§å¯èƒ½å¯¼è‡´é€šè¿‡ Bash æ³¨å…¥è¿›è¡Œ **ä»»æ„ä»£ç æ‰§è¡Œ**ã€‚

ä»¥ä¸‹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ä¸Šä¸‹æ–‡åˆ—è¡¨ã€‚å¦‚æœç®¡é“ä¸å®‰å…¨åœ°ä½¿ç”¨å®ƒä»¬ï¼ŒGitHub ä¸Šçš„ä»»ä½•ç”¨æˆ·éƒ½å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´åœ¨ç®¡é“ä¸­è¿è¡Œä»£ç ã€‚æ­¤åˆ—è¡¨æ¥æºäº [**Raven**](https://github.com/CycodeLabs/raven)ï¼Œä¸€ä¸ªå¼€æºçš„ GitHub Actions æ¼æ´æ‰«æå™¨ï¼š

* `github.event.issue.title`
* `github.event.issue.body`
* `github.event.pull_request.title`
* `github.event.pull_request.body`
* `github.event.comment.body`
* `github.event.review.body`
* `github.event.review_comment.body`
* `github.event.pages.*.page_name`
* `github.event.commits.*.message`
* `github.event.head_commit.message`
* `github.event.head_commit.author.email`
* `github.event.head_commit.author.name`
* `github.event.commits.*.author.email`
* `github.event.commits.*.author.name`
* `github.event.pull_request.head.ref`
* `github.event.pull_request.head.label`
* `github.event.pull_request.head.repo.default_branch`
* `github.head_ref`


### è„šæœ¬æ³¨å…¥æ”»å‡»ç¤ºä¾‹ <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

è„šæœ¬æ³¨å…¥æ”»å‡»å¯ä»¥ç›´æ¥å‘ç”Ÿåœ¨å·¥ä½œæµçš„å†…è”è„šæœ¬ä¸­ã€‚åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œä¸€ä¸ªæ“ä½œä½¿ç”¨ **è¡¨è¾¾å¼æ¥æµ‹è¯•æ‹‰å–è¯·æ±‚æ ‡é¢˜çš„æœ‰æ•ˆæ€§**ï¼Œä½†ä¹Ÿå¢åŠ äº†è„šæœ¬æ³¨å…¥çš„é£é™©ï¼š
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
åœ¨è¿è¡Œ shell è„šæœ¬ä¹‹å‰ï¼Œ`${{ }}` å†…çš„è¡¨è¾¾å¼ä¼šè¢« **è¯„ä¼°**ï¼Œç„¶åç”¨ç»“æœå€¼æ›¿æ¢ï¼Œè¿™å¯èƒ½ä½¿å…¶ **å®¹æ˜“å—åˆ° shell å‘½ä»¤æ³¨å…¥**ã€‚

ä¸ºäº†å°†å‘½ä»¤æ³¨å…¥åˆ°æ­¤å·¥ä½œæµä¸­ï¼Œæ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªæ ‡é¢˜ä¸º **`a"; ls $GITHUB_WORKSPACE"`** çš„æ‹‰å–è¯·æ±‚ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ**`"`** å­—ç¬¦ç”¨äºä¸­æ–­ `title=`**`"${{ github.event.pull_request.title }}"`** è¯­å¥ï¼Œä»è€Œå…è®¸åœ¨è¿è¡Œå™¨ä¸Šæ‰§è¡Œ `ls` å‘½ä»¤ã€‚

### Github Actions æ‰«æå·¥å…·
- [Raven](https://github.com/CycodeLabs/raven) - [å‘å¸ƒåšå®¢](https://cycode.com/blog/introducing-raven/)
- [Gato](https://github.com/praetorian-inc/gato)
- [Gato-X](https://github.com/AdnaneKhan/Gato-X)
- [PurplePanda](https://github.com/carlospolop/PurplePanda)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
