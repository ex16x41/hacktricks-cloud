# Gh Actions - Context Script Injections

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PR's in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basiese Inligting

Om 'n GitHub Action-pyplyn te laat loop, moet 'n spesifieke trigger (geleentheid) in die stelsel plaasvind. Sommige van hierdie triggers kan deur enige gebruiker op GitHub geaktiveer word, wat hulle in staat stel om sekere parameters te beheer wat die pyplyn sal gebruik. Hierdie parameters word verwys na as [**kontexte**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context). In die geval dat hierdie waardes gebruik word vir opdraguitvoering in die pyplyn sonder behoorlike sanitasie van gebruiker-beheerde insette, kan dit lei tot **arbitraire kode-uitvoering**.

Byvoorbeeld, stel jou voor 'n GitHub Action wat geaktiveer word wanneer 'n pull request geskep word. Hierdie aksie sluit 'n Bash-opdrag in wat die taknaam gebruik en dit met die `echo`-opdrag log. In hierdie geval het die gebruiker wat die pull request skep beheer oor die taknaam en kan 'n kwaadwillige taknaam saamstel om die konteks van die `echo`-opdrag te ontsnap. Hierdie manipulasie kan lei tot **arbitraire kode-uitvoering** via Bash-inspuiting.

Hier is 'n lys van kontekste wat 'n gebruiker kan beheer. As 'n pyplyn hulle onveilig gebruik, kan enige gebruiker op GitHub hierdie kwesbaarheid benut om kode binne die pyplyn te laat loop. Hierdie lys is afgelei van [**Raven**](https://github.com/CycodeLabs/raven), 'n oopbron GitHub Actions kwesbaarheid skandeerder:

* `github.event.issue.title`
* `github.event.issue.body`
* `github.event.pull_request.title`
* `github.event.pull_request.body`
* `github.event.comment.body`
* `github.event.review.body`
* `github.event.review_comment.body`
* `github.event.pages.*.page_name`
* `github.event.commits.*.message`
* `github.event.head_commit.message`
* `github.event.head_commit.author.email`
* `github.event.head_commit.author.name`
* `github.event.commits.*.author.email`
* `github.event.commits.*.author.name`
* `github.event.pull_request.head.ref`
* `github.event.pull_request.head.label`
* `github.event.pull_request.head.repo.default_branch`
* `github.head_ref`


### Voorbeeld van 'n skripinspuiting aanval <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

'n Skripinspuiting aanval kan direk binne 'n werksvloei se inline skrip plaasvind. In die volgende voorbeeld gebruik 'n aksie 'n **uitdrukking om die geldigheid van 'n pull request titel te toets**, maar voeg ook die risiko van skripinspuiting by:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Voordat die shell script uitgevoer word, word die uitdrukkings binne `${{ }}` **ge√´valueer** en dan vervang met die resulterende waardes, wat dit **kwulnerbaar kan maak vir shell opdrag inspuiting**.

Om opdragte in hierdie werksvloei in te spuit, kan die aanvaller 'n pull request met 'n titel van **`a"; ls $GITHUB_WORKSPACE"`** skep.

In hierdie voorbeeld word die **`"`** karakter gebruik om die `title=`**`"${{ github.event.pull_request.title }}"`** verklaring te onderbreek, wat die `ls` opdrag toelaat om op die runner uitgevoer te word.

### Github Actions Scanning Tools
- [Raven](https://github.com/CycodeLabs/raven) - [Release blog](https://cycode.com/blog/introducing-raven/)
- [Gato](https://github.com/praetorian-inc/gato)
- [Gato-X](https://github.com/AdnaneKhan/Gato-X)
- [PurplePanda](https://github.com/carlospolop/PurplePanda)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
