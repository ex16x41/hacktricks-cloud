# Gh Actions - Context Script Injections

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Ili kuendesha pipeline ya GitHub Action, lazima kutokee kichocheo maalum (tukio) katika mfumo. Baadhi ya vichocheo hivi vinaweza kuanzishwa na mtumiaji yeyote kwenye GitHub, na kuwapa uwezo wa kudhibiti vigezo fulani ambavyo pipeline itatumia. Vigezo hivi vinajulikana kama [**contexts**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context). Katika hali ambapo thamani hizi zinatumika kwa ajili ya utekelezaji wa amri katika pipeline bila kusafishwa ipasavyo kwa pembejeo zinazodhibitiwa na mtumiaji, inaweza kusababisha **utekelezaji wa msimbo wa kiholela**.

Kwa mfano, fikiria GitHub Action ambayo inachochewa wakati ombi la kuvuta linapotengenezwa. Hatua hii inajumuisha amri ya Bash inayotumia jina la tawi na kuandika kwa kutumia amri ya `echo`. Katika kesi hii, mtumiaji anayekunda ombi la kuvuta ana udhibiti juu ya jina la tawi na anaweza kuunda jina la tawi la uhalifu ili kutoroka muktadha wa amri ya `echo`. Manipulation hii inaweza kusababisha **utekelezaji wa msimbo wa kiholela** kupitia Bash Injection.

Hapa kuna orodha ya muktadha ambayo mtumiaji anaweza kudhibiti. Ikiwa pipeline inazitumia kwa njia isiyo salama, mtumiaji yeyote kwenye GitHub anaweza kutumia udhaifu huu kuendesha msimbo ndani ya pipeline. Orodha hii imetokana na [**Raven**](https://github.com/CycodeLabs/raven), skana ya udhaifu wa GitHub Actions ya chanzo wazi:

* `github.event.issue.title`
* `github.event.issue.body`
* `github.event.pull_request.title`
* `github.event.pull_request.body`
* `github.event.comment.body`
* `github.event.review.body`
* `github.event.review_comment.body`
* `github.event.pages.*.page_name`
* `github.event.commits.*.message`
* `github.event.head_commit.message`
* `github.event.head_commit.author.email`
* `github.event.head_commit.author.name`
* `github.event.commits.*.author.email`
* `github.event.commits.*.author.name`
* `github.event.pull_request.head.ref`
* `github.event.pull_request.head.label`
* `github.event.pull_request.head.repo.default_branch`
* `github.head_ref`


### Example of a script injection attack <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

Shambulio la kuingiza skripti linaweza kutokea moja kwa moja ndani ya skripti ya ndani ya workflow. Katika mfano ufuatao, hatua inatumia **expression kuthibitisha uhalali wa jina la ombi la kuvuta**, lakini pia inaongeza hatari ya kuingiza skripti:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Kabla ya kuendesha script ya shell, maelezo ndani ya `${{ }}` yanapimwa na kisha kubadilishwa na thamani zinazotokana, ambayo inaweza kufanya iwe **hatari kwa kuingizwa kwa amri za shell**.

Ili kuingiza amri katika mchakato huu, mshambuliaji anaweza kuunda ombi la kuvuta lenye kichwa cha **`a"; ls $GITHUB_WORKSPACE"`**

Katika mfano huu, herufi **`"`** inatumika kukatiza taarifa ya `title=`**`"${{ github.event.pull_request.title }}"`**, ikiruhusu amri ya `ls` kutekelezwa kwenye runner.

### Github Actions Scanning Tools
- [Raven](https://github.com/CycodeLabs/raven) - [Release blog](https://cycode.com/blog/introducing-raven/)
- [Gato](https://github.com/praetorian-inc/gato)
- [Gato-X](https://github.com/AdnaneKhan/Gato-X)
- [PurplePanda](https://github.com/carlospolop/PurplePanda)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
