# Gh Actions - Context Script Injections

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Temel Bilgiler

Bir GitHub Action pipeline'ını çalıştırmak için sistemde belirli bir tetikleyici (olay) gerçekleşmelidir. Bu tetikleyicilerden bazıları GitHub'daki herhangi bir kullanıcı tarafından başlatılabilir ve bu da onlara pipeline'ın kullanacağı belirli parametreleri kontrol etme imkanı tanır. Bu parametreler [**context**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context) olarak adlandırılır. Bu değerler, kullanıcı kontrolündeki girdilerin uygun şekilde temizlenmeden pipeline'da komut yürütmek için kullanılırsa, **keyfi kod yürütmesine** yol açabilir.

Örneğin, bir pull request oluşturulduğunda tetiklenen bir GitHub Action'ı hayal edin. Bu action, dal adını kullanan ve bunu `echo` komutuyla kaydeden bir Bash komutu içerir. Bu durumda, pull request'i oluşturan kullanıcı dal adı üzerinde kontrol sahibidir ve `echo` komutunun bağlamından kaçmak için kötü niyetli bir dal adı oluşturabilir. Bu manipülasyon, Bash Injection yoluyla **keyfi kod yürütmesine** neden olabilir.

Bir kullanıcının kontrol edebileceği context'lerin bir listesi burada. Eğer bir pipeline bunları güvensiz bir şekilde kullanıyorsa, GitHub'daki herhangi bir kullanıcı bu açığı kullanarak pipeline içinde kod çalıştırabilir. Bu liste, açık kaynaklı bir GitHub Actions güvenlik tarayıcısı olan [**Raven**](https://github.com/CycodeLabs/raven)'dan alınmıştır:

* `github.event.issue.title`
* `github.event.issue.body`
* `github.event.pull_request.title`
* `github.event.pull_request.body`
* `github.event.comment.body`
* `github.event.review.body`
* `github.event.review_comment.body`
* `github.event.pages.*.page_name`
* `github.event.commits.*.message`
* `github.event.head_commit.message`
* `github.event.head_commit.author.email`
* `github.event.head_commit.author.name`
* `github.event.commits.*.author.email`
* `github.event.commits.*.author.name`
* `github.event.pull_request.head.ref`
* `github.event.pull_request.head.label`
* `github.event.pull_request.head.repo.default_branch`
* `github.head_ref`


### Script injection saldırısı örneği <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

Bir script injection saldırısı, bir iş akışının satır içi script'inde doğrudan gerçekleşebilir. Aşağıdaki örnekte, bir action **pull request başlığının geçerliliğini test etmek için bir ifade kullanır**, ancak aynı zamanda script injection riski de ekler:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Shell script çalıştırılmadan önce, `${{ }}` içindeki ifadeler **değerlendirilir** ve ardından sonuç değerleri ile değiştirilir, bu da **shell komut enjeksiyonuna karşı savunmasız hale getirebilir**.

Bu iş akışına komut enjekte etmek için, saldırgan **`a"; ls $GITHUB_WORKSPACE"`** başlıklı bir pull request oluşturabilir.

Bu örnekte, **`"`** karakteri `title=`**`"${{ github.event.pull_request.title }}"`** ifadesini kesmek için kullanılır ve `ls` komutunun çalıştırılmasına izin verir.

### Github Actions Tarama Araçları
- [Raven](https://github.com/CycodeLabs/raven) - [Yayın blogu](https://cycode.com/blog/introducing-raven/)
- [Gato](https://github.com/praetorian-inc/gato)
- [Gato-X](https://github.com/AdnaneKhan/Gato-X)
- [PurplePanda](https://github.com/carlospolop/PurplePanda)

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.**

</details>
{% endhint %}
