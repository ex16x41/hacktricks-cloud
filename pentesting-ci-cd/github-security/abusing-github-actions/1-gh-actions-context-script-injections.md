# Gh Actions - Context Script Injections

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

GitHub Action íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•˜ë ¤ë©´ ì‹œìŠ¤í…œì—ì„œ íŠ¹ì • íŠ¸ë¦¬ê±°(ì´ë²¤íŠ¸)ê°€ ë°œìƒí•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ íŠ¸ë¦¬ê±° ì¤‘ ì¼ë¶€ëŠ” GitHubì˜ ëª¨ë“  ì‚¬ìš©ìê°€ ì‹œì‘í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ íŒŒì´í”„ë¼ì¸ì´ ì‚¬ìš©í•  íŠ¹ì • ë§¤ê°œë³€ìˆ˜ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë§¤ê°œë³€ìˆ˜ëŠ” [**contexts**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context)ë¼ê³  í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê°’ì´ ì‚¬ìš©ì ì œì–´ ì…ë ¥ì˜ ì ì ˆí•œ ì •í™” ì—†ì´ íŒŒì´í”„ë¼ì¸ì—ì„œ ëª…ë ¹ ì‹¤í–‰ì— ì‚¬ìš©ë  ê²½ìš°, **ì„ì˜ ì½”ë“œ ì‹¤í–‰**ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, í’€ ë¦¬í€˜ìŠ¤íŠ¸ê°€ ìƒì„±ë  ë•Œ íŠ¸ë¦¬ê±°ë˜ëŠ” GitHub Actionì„ ìƒìƒí•´ ë³´ì‹­ì‹œì˜¤. ì´ ì•¡ì…˜ì€ ë¸Œëœì¹˜ ì´ë¦„ì„ ì‚¬ìš©í•˜ê³  `echo` ëª…ë ¹ìœ¼ë¡œ ë¡œê·¸ë¥¼ ë‚¨ê¸°ëŠ” Bash ëª…ë ¹ì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ ê²½ìš°, í’€ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ì‚¬ìš©ìëŠ” ë¸Œëœì¹˜ ì´ë¦„ì„ ì œì–´í•  ìˆ˜ ìˆìœ¼ë©°, ì•…ì˜ì ì¸ ë¸Œëœì¹˜ ì´ë¦„ì„ ë§Œë“¤ì–´ `echo` ëª…ë ¹ì˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ íƒˆì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì¡°ì‘ì€ Bash Injectionì„ í†µí•´ **ì„ì˜ ì½”ë“œ ì‹¤í–‰**ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‚¬ìš©ìê°€ ì œì–´í•  ìˆ˜ ìˆëŠ” ì»¨í…ìŠ¤íŠ¸ ëª©ë¡ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. íŒŒì´í”„ë¼ì¸ì´ ì´ë¥¼ ì•ˆì „í•˜ì§€ ì•Šê²Œ ì‚¬ìš©í•  ê²½ìš°, GitHubì˜ ëª¨ë“  ì‚¬ìš©ìê°€ ì´ ì·¨ì•½ì ì„ ì•…ìš©í•˜ì—¬ íŒŒì´í”„ë¼ì¸ ë‚´ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ëª©ë¡ì€ ì˜¤í”ˆ ì†ŒìŠ¤ GitHub Actions ì·¨ì•½ì  ìŠ¤ìºë„ˆì¸ [**Raven**](https://github.com/CycodeLabs/raven)ì—ì„œ íŒŒìƒë˜ì—ˆìŠµë‹ˆë‹¤:

* `github.event.issue.title`
* `github.event.issue.body`
* `github.event.pull_request.title`
* `github.event.pull_request.body`
* `github.event.comment.body`
* `github.event.review.body`
* `github.event.review_comment.body`
* `github.event.pages.*.page_name`
* `github.event.commits.*.message`
* `github.event.head_commit.message`
* `github.event.head_commit.author.email`
* `github.event.head_commit.author.name`
* `github.event.commits.*.author.email`
* `github.event.commits.*.author.name`
* `github.event.pull_request.head.ref`
* `github.event.pull_request.head.label`
* `github.event.pull_request.head.repo.default_branch`
* `github.head_ref`


### Example of a script injection attack <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

ìŠ¤í¬ë¦½íŠ¸ ì£¼ì… ê³µê²©ì€ ì›Œí¬í”Œë¡œì˜ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ë‚´ì—ì„œ ì§ì ‘ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì˜ˆì œì—ì„œ ì•¡ì…˜ì€ **í’€ ë¦¬í€˜ìŠ¤íŠ¸ ì œëª©ì˜ ìœ íš¨ì„±ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ìŠ¤í¬ë¦½íŠ¸ ì£¼ì…ì˜ ìœ„í—˜ë„ ì¶”ê°€í•©ë‹ˆë‹¤:**
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Before the shell script is run, the expressions inside `${{ }}` are **evaluated** and then substituted with the resulting values, which can make it **vulnerable to shell command injection**.

ì´ ì›Œí¬í”Œë¡œì— ëª…ë ¹ì„ ì£¼ì…í•˜ê¸° ìœ„í•´ ê³µê²©ìëŠ” **`a"; ls $GITHUB_WORKSPACE"`**ë¼ëŠ” ì œëª©ì˜ í’€ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ì˜ˆì œì—ì„œ **`"`** ë¬¸ìëŠ” `title=`**`"${{ github.event.pull_request.title }}"`** ë¬¸ì¥ì„ ì¤‘ë‹¨ì‹œí‚¤ëŠ” ë° ì‚¬ìš©ë˜ì–´ `ls` ëª…ë ¹ì´ ëŸ¬ë„ˆì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

### Github Actions Scanning Tools
- [Raven](https://github.com/CycodeLabs/raven) - [Release blog](https://cycode.com/blog/introducing-raven/)
- [Gato](https://github.com/praetorian-inc/gato)
- [Gato-X](https://github.com/AdnaneKhan/Gato-X)
- [PurplePanda](https://github.com/carlospolop/PurplePanda)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
