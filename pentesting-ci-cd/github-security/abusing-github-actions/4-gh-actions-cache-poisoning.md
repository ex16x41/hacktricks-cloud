# GH Actions - Cache Poisoning

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

For further details check the original post [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)

## Cache Poisoning

Kitendo cha Git [**action/cache**](https://github.com/actions/cache) kinatoa mfumo wa kuhifadhi data katika mchakato wa Continuous Integration (CI), ukijumuisha hatua mbili muhimu:

1. **Run Action**: Hatua hii inahusisha kutafuta na kupata data iliyohifadhiwa wakati wa kuendesha CI. Utafutaji unatumia funguo za kipekee za cache, ukileta matokeo mawili:
* **Cache-hit**: Data iliyohitajika inapatikana katika cache na hivyo inapatikana kwa matumizi ya haraka.
* **Cache-miss**: Hakuna data inayolingana inayopatikana katika cache, ikichochea upakuaji mpya wa faili na saraka zinazohitajika, kama ombi la mara ya kwanza.
2. **Post Workflow Action**: Hatua hii inajitolea kwa kuhifadhi data baada ya mchakato wa CI. Kwa hakika, ikiwa cache-miss inatokea wakati wa hatua ya kuendesha, hali ya sasa ya saraka zilizotajwa inahifadhiwa kwa kutumia funguo iliyotolewa. Mchakato huu unafanywa kiotomatiki na hauhitaji mwito wa wazi.

#### Security Measures: Cache Isolation and Access Restrictions

Ili kudumisha usalama na kuhakikisha kutengwa kwa cache, vizuizi vya ufikiaji vinatekelezwa, kuunda mgawanyiko wa kimantiki kati ya matawi tofauti. Kwa mfano, cache iliyoundwa kwa tawi **Feature-A** (ikiwa na msingi katika tawi kuu) haitapatikana kwa ombi la kuvuta kwa tawi **Feature-B** (pia ikiwa na msingi katika tawi kuu).

Kitendo cha cache kinafuata mpangilio maalum wa utafutaji:

* Kwanza kinatafuta cache hits ndani ya tawi sawa na mchakato wa kazi.
* Ikiwa hakufanikiwa, kinapanua utafutaji hadi tawi la mzazi na matawi mengine ya juu.

Kwa umuhimu, ufikiaji wa cache unategemea tawi, ukipanuka katika mchakato wote na kuendesha kazi za tawi maalum. Zaidi ya hayo, GitHub inatekeleza sera ya kusoma pekee kwa entries za cache mara tu zinapoundwa, ikizuia mabadiliko yoyote.

#### Real-World Implication: From Low to High-Permission Workflow Attack

Mfano wa hali halisi ya CI unaonyesha jinsi mshambuliaji anaweza kutumia kuharibu cache ili kupandisha mamlaka kutoka kwa mchakato wa kazi wa ruhusa ya chini hadi wa juu:

* Mchakato wa **Unit-test**, unaohusika na kuendesha majaribio ya kitengo na zana za kufunika msimbo, unadhaniwa kutumia zana iliyovunjika au dhaifu. Mchakato huu unatumia kitendo cha **action/cache** cha Git, na kufanya cache ipatikane kwa mchakato wowote.
* Mchakato wa **Release**, unaohusika na kujenga na kutoa kipande cha programu, unaboresha shughuli zake kwa kuhifadhi utegemezi wa Golang.

Katika hali hii, mchakato wa unit-test unaleta entry ya cache mbaya kwa kubadilisha maktaba halali ya kuandika ya Golang (\`go
