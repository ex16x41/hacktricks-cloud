# GH Actions - Cache Poisoning

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

For further details check the original post [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)

## Cache Poisoning

Git akcija [**action/cache**](https://github.com/actions/cache) uvodi mehanizam ke코iranja u procesu Kontinuirane Integracije (CI), obuhvataju캖i dve klju캜ne faze:

1. **Pokreni Akciju**: Ova faza uklju캜uje pretra쬴vanje i preuzimanje ke코iranih podataka tokom CI izvr코enja. Pretraga koristi jedinstveni ke코 klju캜, daju캖i dva ishoda:
* **Ke코-hit**: Tra쬰ni podaci su prona캠eni u ke코u i stoga su preuzeti za trenutnu upotrebu.
* **Ke코-miss**: Nema podataka koji odgovaraju u ke코u, 코to dovodi do novog preuzimanja potrebnih datoteka i direktorijuma, sli캜no kao kod prvog zahteva.
2. **Post Workflow Akcija**: Ova faza je posve캖ena ke코iranju podataka nakon CI radnog toka. Konkretno, ako do캠e do ke코-miss tokom pokretanja akcije, trenutna stanja odre캠enih direktorijuma se ke코iraju koriste캖i dati klju캜. Ovaj proces je automatizovan i ne zahteva eksplicitno pozivanje.

#### Bezbednosne Mere: Izolacija Ke코a i Ograni캜enja Pristupa

Da bi se odr쬬la bezbednost i osigurala izolacija ke코a, primenjuju se ograni캜enja pristupa, stvaraju캖i logi캜ku separaciju izme캠u razli캜itih grana. Na primer, ke코 kreiran za granu **Feature-A** (sa osnovom u glavnoj grani) bi캖e nedostupan za pull request za granu **Feature-B** (tako캠e zasnovanu na glavnoj grani).

Akcija ke코a se pridr쬬va specifi캜nog reda pretrage:

* Prvo tra쬴 ke코 hitove unutar iste grane kao 코to je radni tok.
* Ako nije uspe코na, pro코iruje pretragu na roditeljsku granu i druge uzvodne grane.

Va쬹o je napomenuti da je pristup ke코u ograni캜en na granu, prote쬿캖i se kroz sve radne tokove i izvr코enja odre캠ene grane. Pored toga, GitHub primenjuje politiku samo za 캜itanje za unose u ke코 nakon 코to su kreirani, zabranjuju캖i bilo kakve izmene.

#### Real-World Implication: Od Napada na Radni Tok sa Niskim Dozvolama do Visokih Dozvola

Ilustrativni CI scenario pokazuje kako napada캜 mo쬰 iskoristiti trovanje ke코a da bi eskalirao privilegije sa radnog toka sa niskim dozvolama na radni tok sa visokim dozvolama:

* **Unit-test** radni tok, odgovoran za pokretanje unit testova i alata za pokrivenost koda, pretpostavlja se da koristi kompromitovani ili ranjiv alat. Ovaj radni tok koristi **action/cache** Git akciju, 캜ine캖i ke코 dostupnim bilo kojem radnom toku.
* **Release** radni tok, zadu쬰n za izgradnju i objavljivanje artefakta aplikacije, optimizuje svoje operacije ke코iranjem Golang zavisnosti.

U ovom scenariju, unit-test radni tok uvodi zlonamerni unos u ke코 zamenjuju캖i legitimnu Golang biblioteku za logovanje (\`go
