# GH Actions - Cache Poisoning

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

For further details check the original post [https://scribesecurity.com/blog/github-cache-poisoning/](https://scribesecurity.com/blog/github-cache-poisoning/)

## Cache Poisoning

Die Git aksie [**action/cache**](https://github.com/actions/cache) stel 'n caching meganisme in die Continuous Integration (CI) proses in, wat twee kritieke fases insluit:

1. **Run Action**: Hierdie fase behels die soek en verkryging van gecacheerde data tydens die CI run. Die soektog gebruik 'n unieke cache sleutel, wat twee uitkomste lewer:
* **Cache-hit**: Die versoekte data word in die cache gevind en word gevolglik vir onmiddellike gebruik verkry.
* **Cache-miss**: Geen ooreenstemmende data word in die cache gevind nie, wat 'n vars aflaai van die vereiste l√™ers en gidse aanmoedig, soortgelyk aan 'n eerste keer versoek.
2. **Post Workflow Action**: Hierdie fase is toegewy aan die caching van data na die CI workflow. Spesifiek, as 'n cache-miss tydens die run aksie voorkom, word die huidige toestand van die gespesifiseerde gidse gecache met behulp van die verskafde sleutel. Hierdie proses is geoutomatiseer en vereis nie eksplisiete aanroep nie.

#### Security Measures: Cache Isolation and Access Restrictions

Om sekuriteit te handhaaf en cache-isolasie te verseker, word toegangbeperkings afgedwing, wat 'n logiese skeiding tussen verskillende takke skep. Byvoorbeeld, 'n cache geskep vir tak **Feature-A** (met sy basis in die hoof tak) sal ontoeganklik wees vir 'n pull request vir tak **Feature-B** (ook gebaseer in die hoof tak).

Die cache aksie hou by 'n spesifieke soekorde:

* Dit soek eers cache hits binne dieselfde tak as die workflow run.
* As dit onsuksesvol is, brei dit die soektog uit na die ouertak en ander opwaartse takke.

Belangrik, cache toegang is tak-geskepte, wat oor alle workflows en runs van 'n spesifieke tak strek. Boonop afdwing GitHub 'n lees-slegs beleid vir cache inskrywings sodra hulle geskep is, wat enige wysigings verbied.

#### Real-World Implication: From Low to High-Permission Workflow Attack

'n Illustreerende CI-scenario demonstreer hoe 'n aanvaller cache vergiftiging kan benut om bevoegdhede van 'n lae-bevoegdheid workflow na 'n ho√´-bevoegdheid een te eskaleer:

* Die **Unit-test** workflow, verantwoordelik vir die uitvoering van eenheidstoetsen en kode dekking gereedskap, word veronderstel om 'n gecompromitteerde of kwesbare gereedskap te gebruik. Hierdie workflow gebruik die **action/cache** Git aksie, wat die cache toeganklik maak vir enige workflow.
* Die **Release** workflow, wat verantwoordelik is vir die bou en vrystelling van die toepassingsartefak, optimaliseer sy bedrywighede deur Golang afhanklikhede te cache.

In hierdie scenario, die unit-test workflow stel 'n kwaadwillige cache inskrywing in deur 'n wettige Golang logging biblioteek (\`go
