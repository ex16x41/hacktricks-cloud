# Gh Actions - Context Script Injections

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PR's in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basiese Inligting

Let daarop dat daar sekere [**github kontekste**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context) is waarvan die waardes **beheer** word deur die **gebruiker** wat die PR skep. As die github aksie daardie **data gebruik om enigiets uit te voer**, kan dit lei tot **arbitraire kode-uitvoering**. Hierdie kontekste eindig tipies met `body`, `default_branch`, `email`, `head_ref`, `label`, `message`, `name`, `page_name`,`ref`, en `title`. Byvoorbeeld (lys van hierdie [**skrywe**](https://medium.com/tinder/exploiting-github-actions-on-open-source-projects-5d93936d189f)):

* github.event.comment.body
* github.event.issue.body
* github.event.issue.title
* github.head\_ref
* github.pull\_request.\*
* github.\*.\*.authors.name
* github.\*.\*.authors.email

Let daarop dat daar **minder voor die hand liggende bronne** van potensieel onbetroubare invoer is, soos takname en e-pos adresse, wat **redelik buigsaam kan wees in terme van hul toegelate inhoud**. Byvoorbeeld, `zzz";echo${IFS}"hello";#` sou 'n geldige taknaam wees en sou 'n moontlike aanvalsvlak vir 'n teikenrepo wees.

### Voorbeeld van 'n skripinvoeraanval <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

'n Skripinvoeraanval kan direk binne 'n werksvloei se inline skrip voorkom. In die volgende voorbeeld gebruik 'n aksie 'n **uitdrukking om die geldigheid van 'n pull request titel te toets**, maar voeg ook die risiko van skripinvoer by:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Voordat die shell-skripte uitgevoer word, word die uitdrukkings binne `${{ }}` **ge√´valueer** en dan vervang met die resulterende waardes, wat dit **kwulnerbaar maak vir shell-opdrag-inspuiting**.

Om opdragte in hierdie werksvloei in te spuit, kan die aanvaller 'n pull-aanvraag skep met 'n titel van **`a"; ls $GITHUB_WORKSPACE"`**

In hierdie voorbeeld word die **`"`** karakter gebruik om die `title=`**`"${{ github.event.pull_request.title }}"`** verklaring te onderbreek, wat die `ls` opdrag toelaat om op die runner uitgevoer te word.
