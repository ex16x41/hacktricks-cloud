# Gh Actions - Context Script Injections

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## Temel Bilgiler

Belirli [**github context'leri**](https://docs.github.com/en/actions/reference/context-and-expression-syntax-for-github-actions#github-context) vardır ki bunların değerleri **PR'yi** oluşturan **kullanıcı** tarafından **kontrol edilir**. Eğer github action bu **verileri bir şey yürütmek için kullanıyorsa**, bu **keyfi kod yürütmesine** yol açabilir. Bu context'ler genellikle `body`, `default_branch`, `email`, `head_ref`, `label`, `message`, `name`, `page_name`,`ref` ve `title` ile biter. Örneğin (bu [**yazıdan**](https://medium.com/tinder/exploiting-github-actions-on-open-source-projects-5d93936d189f) liste):

* github.event.comment.body
* github.event.issue.body
* github.event.issue.title
* github.head\_ref
* github.pull\_request.\*
* github.\*.\*.authors.name
* github.\*.\*.authors.email

Burada, **potansiyel olarak güvensiz girdi** kaynakları olarak daha az belirgin olanlar, dal isimleri ve e-posta adresleri gibi, **izin verilen içerik açısından oldukça esnek** olabilir. Örneğin, `zzz";echo${IFS}"hello";#` geçerli bir dal adı olur ve hedef bir depo için olası bir saldırı vektörü olabilir.

### Script Enjeksiyon Saldırısı Örneği <a href="#example-of-a-script-injection-attack" id="example-of-a-script-injection-attack"></a>

Bir script enjeksiyon saldırısı, bir iş akışının satır içi scripti içinde doğrudan gerçekleşebilir. Aşağıdaki örnekte, bir action **bir pull request başlığının geçerliliğini test etmek için bir ifade kullanır**, ancak aynı zamanda script enjeksiyonu riski de ekler:
```yaml
- name: Check PR title
run: |
title="${{ github.event.pull_request.title }}"
if [[ $title =~ ^octocat ]]; then
echo "PR title starts with 'octocat'"
exit 0
else
echo "PR title did not start with 'octocat'"
exit 1
fi
```
Shell script çalıştırılmadan önce, `${{ }}` içindeki ifadeler **değerlendirilir** ve ardından elde edilen değerlerle değiştirilir, bu da **shell komut enjeksiyonuna karşı savunmasız hale getirebilir**.

Bu iş akışına komut enjekte etmek için, saldırgan **`a"; ls $GITHUB_WORKSPACE"`** başlıklı bir pull request oluşturabilir.

Bu örnekte, **`"`** karakteri `title=`**`"${{ github.event.pull_request.title }}"`** ifadesini kesmek için kullanılır ve `ls` komutunun çalıştırılmasına izin verir.

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.**

</details>
{% endhint %}
