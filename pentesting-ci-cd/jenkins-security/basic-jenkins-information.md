# Osnovne informacije o Jenkins-u

{% hint style="success" %}
NauÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
NauÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitter-u** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

## Pristup

### KorisniÄko ime + Lozinka

NajÄeÅ¡Ä‡i naÄin prijavljivanja u Jenkins je sa korisniÄkim imenom ili lozinkom.

### KolaÄiÄ‡

Ako se **ovlaÅ¡Ä‡eni kolaÄiÄ‡ ukrade**, moÅ¾e se koristiti za pristup sesiji korisnika. KolaÄiÄ‡ se obiÄno zove `JSESSIONID.*`. (Korisnik moÅ¾e prekinuti sve svoje sesije, ali prvo mora saznati da je kolaÄiÄ‡ ukraden).

### SSO/Pluginovi

Jenkins moÅ¾e biti konfigurisan pomoÄ‡u pluginova da bude **dostupan putem treÄ‡e strane SSO**.

### Tokeni

**Korisnici mogu generisati tokene** kako bi omoguÄ‡ili aplikacijama da ih imitiraju putem CLI ili REST API.

### SSH KljuÄevi

Ova komponenta pruÅ¾a ugraÄ‘eni SSH server za Jenkins. To je alternativni interfejs za [Jenkins CLI](https://www.jenkins.io/doc/book/managing/cli/), i komande se mogu pozivati na ovaj naÄin koristeÄ‡i bilo koji SSH klijent. (Iz [dokumentacije](https://plugins.jenkins.io/sshd/))

## Autorizacija

U `/configureSecurity` je moguÄ‡e **konfigurisati metod autorizacije Jenkins-a**. Postoji nekoliko opcija:

* **Svi mogu raditi bilo Å¡ta**: ÄŒak i anonimni pristup moÅ¾e administrirati server
* **Legacy mode**: Isto kao Jenkins <1.164. Ako imate **"admin" ulogu**, biÄ‡e vam dodeljena **puna kontrola** nad sistemom, a **inaÄe** (ukljuÄujuÄ‡i **anonimne** korisnike) imaÄ‡ete **pristup za Äitanje**.
* **Prijavljeni korisnici mogu raditi bilo Å¡ta**: U ovom reÅ¾imu, svaki **prijavljeni korisnik dobija punu kontrolu** nad Jenkins-om. Jedini korisnik koji neÄ‡e imati punu kontrolu je **anonimni korisnik**, koji dobija samo **pristup za Äitanje**.
* **Matrix-based security**: MoÅ¾ete konfigurisati **ko moÅ¾e raditi Å¡ta** u tabeli. Svaka **kolona** predstavlja **dozvolu**. Svaki **red** **predstavlja** **korisnika ili grupu/ulogu.** Ovo ukljuÄuje posebnog korisnika '**anonimni**', koji predstavlja **neautentifikovane korisnike**, kao i '**autentifikovani**', koji predstavlja **sve autentifikovane korisnike**.

![](<../../.gitbook/assets/image (149).png>)

* **Project-based Matrix Authorization Strategy:** Ovaj reÅ¾im je **proÅ¡irenje** na "**Matrix-based security**" koje omoguÄ‡ava dodatnu ACL matricu da bude **definisana za svaki projekat posebno.**
* **Role-Based Strategy:** OmoguÄ‡ava definisanje autorizacija koristeÄ‡i **strategiju zasnovanu na ulogama**. Upravljajte ulogama u `/role-strategy`.

## **Security Realm**

U `/configureSecurity` je moguÄ‡e **konfigurisati sigurnosnu oblast.** Podrazumevano Jenkins ukljuÄuje podrÅ¡ku za nekoliko razliÄitih sigurnosnih oblasti:

* **Delegate to servlet container**: Za **delegiranje autentifikacije servlet kontejneru koji pokreÄ‡e Jenkins kontroler**, kao Å¡to je [Jetty](https://www.eclipse.org/jetty/).
* **Jenkinsâ€™ own user database:** Koristite **Jenkins-ovu ugraÄ‘enu bazu podataka korisnika** za autentifikaciju umesto delegiranja na eksterni sistem. Ovo je podrazumevano omoguÄ‡eno.
* **LDAP**: Delegirajte svu autentifikaciju na konfigurisani LDAP server, ukljuÄujuÄ‡i i korisnike i grupe.
* **Unix user/group database**: **Delegira autentifikaciju na osnovnu Unix** OS-nivo bazu podataka korisnika na Jenkins kontroleru. Ovaj reÅ¾im Ä‡e takoÄ‘e omoguÄ‡iti ponovnu upotrebu Unix grupa za autorizaciju.

Pluginovi mogu pruÅ¾iti dodatne sigurnosne oblasti koje mogu biti korisne za integraciju Jenkins-a u postojeÄ‡e identitetske sisteme, kao Å¡to su:

* [Active Directory](https://plugins.jenkins.io/active-directory)
* [GitHub Authentication](https://plugins.jenkins.io/github-oauth)
* [Atlassian Crowd 2](https://plugins.jenkins.io/crowd2)

## Jenkins Nodes, Agents & Executors

Definicije iz [dokumentacije](https://www.jenkins.io/doc/book/managing/nodes/):

**Nodes** su **maÅ¡ine** na kojima se pokreÄ‡u **agenti za izgradnju**. Jenkins prati svaki prikljuÄeni node za prostor na disku, slobodan privremeni prostor, slobodan swap, vreme/sinhronizaciju sata i vreme odziva. Node se iskljuÄuje ako bilo koja od ovih vrednosti preÄ‘e konfigurisan prag.

**Agents** **upravljaju** **izvrÅ¡avanjem zadataka** u ime Jenkins kontrolera koristeÄ‡i **izvrÅ¡itelje**. Agent moÅ¾e koristiti bilo koji operativni sistem koji podrÅ¾ava Java. Alati potrebni za izgradnju i testiranje su instalirani na node-u gde agent radi; mogu **biti instalirani direktno ili u kontejneru** (Docker ili Kubernetes). Svaki **agent je zapravo proces sa svojim PID-om** na host maÅ¡ini.

**Executor** je **slot za izvrÅ¡avanje zadataka**; zapravo, to je **nit u agentu**. **Broj izvrÅ¡itelja** na node-u definiÅ¡e broj **istovremenih zadataka** koji mogu biti izvrÅ¡eni na tom node-u u jednom trenutku. Drugim reÄima, ovo odreÄ‘uje **broj istovremenih Pipeline `stages`** koji mogu biti izvrÅ¡eni na tom node-u u jednom trenutku.

## Jenkins Secrets

### Enkripcija tajni i kredencijala

Definicija iz [dokumentacije](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials): Jenkins koristi **AES za enkripciju i zaÅ¡titu tajni**, kredencijala i njihovih odgovarajuÄ‡ih enkripcijskih kljuÄeva. Ovi enkripcijski kljuÄevi su pohranjeni u `$JENKINS_HOME/secrets/` zajedno sa glavnim kljuÄem koji se koristi za zaÅ¡titu tih kljuÄeva. Ovaj direktorijum treba biti konfigurisan tako da samo operativni sistem korisnik pod kojim Jenkins kontroler radi ima pristup za Äitanje i pisanje u ovaj direktorijum (tj. `chmod` vrednost `0700` ili koriÅ¡Ä‡enjem odgovarajuÄ‡ih atributa datoteka). **Glavni kljuÄ** (ponekad nazvan "kljuÄ za enkripciju kljuÄeva" u kriptoÅ¾argonu) je **pohranjen \_nekriptovan**\_ na Jenkins kontroler fajl sistemu u **`$JENKINS_HOME/secrets/master.key`** Å¡to ne Å¡titi od napadaÄa sa direktnim pristupom toj datoteci. VeÄ‡ina korisnika i programera Ä‡e koristiti ove enkripcijske kljuÄeve indirektno putem ili [Secret](https://javadoc.jenkins.io/byShortName/Secret) API za enkripciju generiÄkih tajnih podataka ili putem kredencijala API. Za kriptokuriozne, Jenkins koristi AES u cipher block chaining (CBC) reÅ¾imu sa PKCS#5 padding-om i sluÄajnim IV-ovima za enkripciju instanci [CryptoConfidentialKey](https://javadoc.jenkins.io/byShortName/CryptoConfidentialKey) koje su pohranjene u `$JENKINS_HOME/secrets/` sa imenom datoteke koje odgovara njihovom `CryptoConfidentialKey` id-u. UobiÄajeni id-evi kljuÄeva ukljuÄuju:

* `hudson.util.Secret`: koristi se za generiÄke tajne;
* `com.cloudbees.plugins.credentials.SecretBytes.KEY`: koristi se za neke tipove kredencijala;
* `jenkins.model.Jenkins.crumbSalt`: koristi se od strane [CSRF mehanizma zaÅ¡tite](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery); i

### Pristup kredencijalima

Kredencijali mogu biti **opseg globalnim provajderima** (`/credentials/`) koji mogu biti pristupni bilo kojem konfigurisanom projektu, ili mogu biti opseg **specifiÄnim projektima** (`/job/<project-name>/configure`) i stoga dostupni samo iz specifiÄnog projekta.

Prema [**dokumentaciji**](https://www.jenkins.io/blog/2019/02/21/credentials-masking/): Kredencijali koji su u opsegu su dostupni pipeline-u bez ograniÄenja. Da bi se **spreÄilo sluÄajno izlaganje u logu izgradnje**, kredencijali su **maskirani** iz redovnog izlaza, tako da pozivanje `env` (Linux) ili `set` (Windows), ili programi koji ispisuju svoje okruÅ¾enje ili parametre **ne bi otkrili ih u logu izgradnje** korisnicima koji inaÄe ne bi imali pristup kredencijalima.

**Zato, da bi izveo kredencijale, napadaÄ treba, na primer, da ih base64 kodira.**

## Reference

* [https://www.jenkins.io/doc/book/security/managing-security/](https://www.jenkins.io/doc/book/security/managing-security/)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)
* [https://www.jenkins.io/doc/developer/security/secrets/](https://www.jenkins.io/doc/developer/security/secrets/)
* [https://www.jenkins.io/blog/2019/02/21/credentials-masking/](https://www.jenkins.io/blog/2019/02/21/credentials-masking/)
* [https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery](https://www.jenkins.io/doc/book/managing/security/#cross-site-request-forgery)
* [https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials](https://www.jenkins.io/doc/developer/security/secrets/#encryption-of-secrets-and-credentials)
* [https://www.jenkins.io/doc/book/managing/nodes/](https://www.jenkins.io/doc/book/managing/nodes/)

{% hint style="success" %}
NauÄite i veÅ¾bajte AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
NauÄite i veÅ¾bajte GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Pogledajte [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitter-u** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Delite hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
