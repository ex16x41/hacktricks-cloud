# Cloudflare Security

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) ya da **Twitter'da** bizi takip edin ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **HackTricks'e** [**PR gÃ¶ndererek**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n**.

</details>
{% endhint %}

Bir Cloudflare hesabÄ±nda yapÄ±landÄ±rÄ±labilecek bazÄ± **genel ayarlar ve hizmetler** vardÄ±r. Bu sayfada her bÃ¶lÃ¼mÃ¼n **gÃ¼venlikle ilgili ayarlarÄ±nÄ± analiz edeceÄŸiz:**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Websites

Her birini gÃ¶zden geÃ§irin:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Domain Registration

* [ ] **`Transfer Domains`** bÃ¶lÃ¼mÃ¼nde herhangi bir domainin transfer edilemediÄŸini kontrol edin.

Her birini gÃ¶zden geÃ§irin:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analytics

_KonfigÃ¼rasyon gÃ¼venlik incelemesi iÃ§in kontrol edilecek bir ÅŸey bulamadÄ±m._

## Pages

Her Cloudflare sayfasÄ±nda:

* [ ] **`Build log`** iÃ§inde **hassas bilgi** kontrol edin.
* [ ] Sayfalara atanan **Github deposunda** **hassas bilgi** kontrol edin.
* [ ] **workflow command injection** veya `pull_request_target` zafiyeti yoluyla potansiyel github repo ele geÃ§irilmesini kontrol edin. Daha fazla bilgi iÃ§in [**Github Security sayfasÄ±na**](../github-security/) bakÄ±n.
* [ ] `/fuctions` dizininde (varsa) **zafiyetli fonksiyonlarÄ±**, `_redirects` dosyasÄ±ndaki (varsa) **yÃ¶nlendirmeleri** ve `_headers` dosyasÄ±ndaki (varsa) **yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ baÅŸlÄ±klarÄ±** kontrol edin.
* [ ] **Kodu eriÅŸebiliyorsanÄ±z** **blackbox** veya **whitebox** ile **web sayfasÄ±ndaki** **zafiyetleri** kontrol edin.
* [ ] Her sayfanÄ±n `/<page_id>/pages/view/blocklist/settings/functions` detaylarÄ±nda **`Environment variables`** iÃ§inde **hassas bilgi** kontrol edin.
* [ ] Detay sayfasÄ±nda ayrÄ±ca **build command** ve **root directory** iÃ§inde **potansiyel enjeksiyonlarÄ±** kontrol edin.

## **Workers**

Her Cloudflare worker'Ä±nda kontrol edin:

* [ ] Tetikleyiciler: Worker'Ä± ne tetikliyor? Bir **kullanÄ±cÄ± veri gÃ¶nderebilir mi** ve bu veri worker tarafÄ±ndan **kullanÄ±labilir mi**?
* [ ] **`Settings`** iÃ§inde **hassas bilgi** iÃ§eren **`Variables`** kontrol edin.
* [ ] **Worker kodunu** kontrol edin ve **zafiyetleri** arayÄ±n (Ã¶zellikle kullanÄ±cÄ±nÄ±n giriÅŸi yÃ¶netebileceÄŸi yerlerde)
* Kontrol edebileceÄŸiniz sayfayÄ± dÃ¶ndÃ¼ren SSRF'leri kontrol edin.
* Bir svg gÃ¶rÃ¼ntÃ¼sÃ¼ iÃ§inde JS Ã§alÄ±ÅŸtÄ±ran XSS'leri kontrol edin.
* Worker'Ä±n diÄŸer iÃ§ hizmetlerle etkileÅŸime girmesi mÃ¼mkÃ¼ndÃ¼r. Ã–rneÄŸin, bir worker bir R2 bucket ile etkileÅŸime girip, giriÅŸten elde edilen bilgileri orada depolayabilir. Bu durumda, worker'Ä±n R2 bucket Ã¼zerindeki yeteneklerini ve kullanÄ±cÄ± giriÅŸinden nasÄ±l kÃ¶tÃ¼ye kullanÄ±labileceÄŸini kontrol etmek gerekecektir.

{% hint style="warning" %}
VarsayÄ±lan olarak bir **Worker'a bir URL** verildiÄŸini unutmayÄ±n, Ã¶rneÄŸin `<worker-name>.<account>.workers.dev`. KullanÄ±cÄ± bunu bir **alt alan adÄ±** olarak ayarlayabilir, ancak bu **orijinal URL** ile her zaman eriÅŸebilirsiniz.
{% endhint %}

## R2

Her R2 bucket'Ä±nda kontrol edin:

* [ ] **CORS Policy** yapÄ±landÄ±rÄ±n.

## Stream

TODO

## Images

TODO

## Security Center

* [ ] MÃ¼mkÃ¼nse, bir **`Security Insights`** **tarama** ve bir **`Infrastructure`** **tarama** Ã§alÄ±ÅŸtÄ±rÄ±n, Ã§Ã¼nkÃ¼ bunlar **gÃ¼venlik** aÃ§Ä±sÄ±ndan ilginÃ§ bilgileri **vurgulayacaktÄ±r**.
* [ ] Bu bilgileri gÃ¼venlik yanlÄ±ÅŸ yapÄ±landÄ±rmalarÄ± ve ilginÃ§ bilgiler iÃ§in **kontrol edin**.

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Bulk Redirects

{% hint style="info" %}
[Dynamic Redirects](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/) aksine, [**Bulk Redirects**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) esasen statiktir â€” **herhangi bir dize deÄŸiÅŸtirme** iÅŸlemi veya dÃ¼zenli ifadeleri desteklemezler. Ancak, URL eÅŸleÅŸtirme davranÄ±ÅŸlarÄ±nÄ± ve Ã§alÄ±ÅŸma zamanÄ±ndaki davranÄ±ÅŸlarÄ±nÄ± etkileyen URL yÃ¶nlendirme parametrelerini yapÄ±landÄ±rabilirsiniz.
{% endhint %}

* [ ] YÃ¶nlendirmeler iÃ§in **ifadelerin** ve **gereksinimlerin** **mantÄ±klÄ±** olup olmadÄ±ÄŸÄ±nÄ± kontrol edin.
* [ ] AyrÄ±ca **ilginÃ§ bilgi iÃ§eren hassas gizli uÃ§ noktalarÄ±** kontrol edin.

## Notifications

* [ ] **Bildirimleri** kontrol edin. Bu bildirimler gÃ¼venlik iÃ§in Ã¶nerilir:
* `Usage Based Billing`
* `HTTP DDoS Attack Alert`
* `Layer 3/4 DDoS Attack Alert`
* `Advanced HTTP DDoS Attack Alert`
* `Advanced Layer 3/4 DDoS Attack Alert`
* `Flow-based Monitoring: Volumetric Attack`
* `Route Leak Detection Alert`
* `Access mTLS Certificate Expiration Alert`
* `SSL for SaaS Custom Hostnames Alert`
* `Universal SSL Alert`
* `Script Monitor New Code Change Detection Alert`
* `Script Monitor New Domain Alert`
* `Script Monitor New Malicious Domain Alert`
* `Script Monitor New Malicious Script Alert`
* `Script Monitor New Malicious URL Alert`
* `Script Monitor New Scripts Alert`
* `Script Monitor New Script Exceeds Max URL Length Alert`
* `Advanced Security Events Alert`
* `Security Events Alert`
* [ ] TÃ¼m **hedefleri** kontrol edin, Ã§Ã¼nkÃ¼ webhook url'lerinde **hassas bilgi** (temel http auth) olabilir. AyrÄ±ca webhook url'lerinin **HTTPS** kullandÄ±ÄŸÄ±ndan emin olun.
* [ ] Ekstra kontrol olarak, bir **cloudflare bildirimini** Ã¼Ã§Ã¼ncÃ¼ bir tarafa **taklit etmeyi** deneyebilirsiniz, belki bir ÅŸekilde **tehlikeli bir ÅŸey enjekte edebilirsiniz**.

## Manage Account

* [ ] **`Billing` -> `Payment info`** bÃ¶lÃ¼mÃ¼nde kredi kartÄ±nÄ±n **son 4 hanesini**, **son kullanma** tarihini ve **fatura adresini** gÃ¶rmek mÃ¼mkÃ¼ndÃ¼r.
* [ ] **`Billing` -> `Subscriptions`** bÃ¶lÃ¼mÃ¼nde hesapta kullanÄ±lan **plan tÃ¼rÃ¼nÃ¼** gÃ¶rmek mÃ¼mkÃ¼ndÃ¼r.
* [ ] **`Members`** bÃ¶lÃ¼mÃ¼nde hesabÄ±n tÃ¼m Ã¼yelerini ve **rollerini** gÃ¶rmek mÃ¼mkÃ¼ndÃ¼r. Plan tÃ¼rÃ¼ Enterprise deÄŸilse, yalnÄ±zca 2 rol vardÄ±r: Administrator ve Super Administrator. Ancak kullanÄ±lan **plan Enterprise ise**, [**daha fazla rol**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) en az ayrÄ±calÄ±k ilkesine uymak iÃ§in kullanÄ±labilir.
* Bu nedenle, mÃ¼mkÃ¼n olduÄŸunda **Enterprise planÄ±** kullanÄ±lmasÄ± **Ã¶nerilir**.
* [ ] Members bÃ¶lÃ¼mÃ¼nde hangi **Ã¼yelerin** **2FA etkinleÅŸtirdiÄŸini** kontrol etmek mÃ¼mkÃ¼ndÃ¼r. **Her** kullanÄ±cÄ±nÄ±n bunu etkinleÅŸtirmesi gerekmektedir.

{% hint style="info" %}
Neyse ki **`Administrator`** rolÃ¼nÃ¼n Ã¼yelikleri yÃ¶netme yetkisi vermediÄŸini (**yetkileri yÃ¼kseltemez veya yeni Ã¼yeler davet edemez**) unutmayÄ±n.
{% endhint %}

## DDoS Investigation

[Bu bÃ¶lÃ¼mÃ¼ kontrol edin](cloudflare-domains.md#cloudflare-ddos-protection).

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **KatÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) ya da **Twitter'da** bizi takip edin ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **HackTricks'e** [**PR gÃ¶ndererek**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarÄ±na **hacking ipuÃ§larÄ±nÄ± paylaÅŸÄ±n**.

</details>
{% endhint %}
