# Cloudflare Security

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite **vaÅ¡u kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

U Cloudflare nalogu postoje neka **opÅ¡ta podeÅ¡avanja i usluge** koje se mogu konfigurisati. Na ovoj stranici Ä‡emo **analizirati sigurnosna podeÅ¡avanja u vezi sa svakom sekcijom:**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Veb sajtovi

Pregledajte svaki sa:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Registracija domena

* [ ] U **`Transfer Domains`** proverite da nije moguÄ‡e preneti bilo koju domenu.

Pregledajte svaki sa:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analitika

_Nisam mogao pronaÄ‡i niÅ¡ta za proveru sigurnosne konfiguracije._

## Stranice

Na svakoj Cloudflare stranici:

* [ ] Proverite da li postoji **osetljive informacije** u **`Build log`**.
* [ ] Proverite da li postoji **osetljive informacije** u **Github repozitorijumu** dodeljenom stranicama.
* [ ] Proverite moguÄ‡nost kompromitovanja github repozitorijuma putem **workflow command injection** ili kompromitovanja `pull_request_target`. ViÅ¡e informacija na [**Github Security stranici**](../github-security/).
* [ ] Proverite da li postoje **ranjive funkcije** u `/fuctions` direktorijumu (ako postoje), proverite **preusmere** u `_redirects` fajlu (ako postoje) i **neispravljene zaglavlja** u `_headers` fajlu (ako postoje).
* [ ] Proverite **ranjivosti** na **veb stranici** putem **blackbox** ili **whitebox** ako moÅ¾ete **pristupiti kodu**
* [ ] U detaljima svake stranice `/<page_id>/pages/view/blocklist/settings/functions`. Proverite da li postoje **osetljive informacije** u **`Environment variables`**.
* [ ] Na stranici sa detaljima proverite takoÄ‘e **build command** i **root directory** za **potencijalne injekcije** radi kompromitovanja stranice.

## **Workers**

Na svakom Cloudflare-ovom worker-u proverite:

* [ ] OkidaÄe: Å ta pokreÄ‡e worker? Da li **korisnik moÅ¾e poslati podatke** koji Ä‡e biti **koriÅ¡Ä‡eni** od strane workera?
* [ ] U **`PodeÅ¡avanjima`**, proverite **`Variables`** koji sadrÅ¾e **osetljive informacije**
* Proverite kod workera i potraÅ¾ite **ranjivosti** (posebno na mestima gde korisnik moÅ¾e upravljati unosom)
* Proverite SSRF-ove koji vraÄ‡aju naznaÄenu stranicu kojom moÅ¾ete upravljati
* Proverite XSS-ove koji izvrÅ¡avaju JS unutar svg slike
* MoguÄ‡e je da worker interaguje sa drugim internim uslugama. Na primer, worker moÅ¾e da interaguje sa R2 bucket-om koji skladiÅ¡ti informacije dobijene iz unosa. U tom sluÄaju, bilo bi potrebno proveriti koje moguÄ‡nosti ima worker nad R2 bucket-om i kako bi se to moglo zloupotrebiti iz korisniÄkog unosa.

{% hint style="warning" %}
Imajte na umu da je podrazumevano **Workeru dodeljen URL** kao Å¡to je `<ime-workera>.<nalog>.workers.dev`. Korisnik moÅ¾e postaviti poddomen, ali uvek moÅ¾ete pristupiti sa **originalnim URL-om** ako ga znate.
{% endhint %}

## R2

Na svakom R2 bucket-u proverite:

* [ ] KonfiguriÅ¡ite **CORS politiku**.

## Stream

TODO

## Slike

TODO

## Centar za sigurnost

* [ ] Ako je moguÄ‡e, pokrenite **`Security Insights`** **skeniranje** i **`Infrastruktura`** **skeniranje**, jer Ä‡e **istaknuti** zanimljive informacije u vezi sa **sigurnoÅ¡Ä‡u**.
* [ ] Samo **proverite ove informacije** za sigurnosne greÅ¡ke u konfiguraciji i zanimljive informacije

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Masovna preusmeravanja

{% hint style="info" %}
Za razliku od [DinamiÄnih preusmeravanja](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/), [**Masovna preusmeravanja**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) su suÅ¡tinski statiÄna â€” ne podrÅ¾avaju nikakve operacije zamene nizova ili regularne izraze. MeÄ‘utim, moÅ¾ete konfigurisati parametre preusmeravanja URL-a koji utiÄu na njihovo ponaÅ¡anje pri podudaranju URL-a i njihovo ponaÅ¡anje u toku izvrÅ¡avanja.
{% endhint %}

* [ ] Proverite da li **izrazi** i **uslovi** za preusmeravanja **imaju smisla**.
* [ ] Proverite takoÄ‘e da li postoje **osetljive skrivene taÄke zavrÅ¡etka** koje sadrÅ¾e zanimljive informacije.

## ObaveÅ¡tenja

* [ ] Proverite **obaveÅ¡tenja**. Ova obaveÅ¡tenja se preporuÄuju za sigurnost:
* `ObaveÅ¡tenje o naplati na osnovu koriÅ¡Ä‡enja`
* `ObaveÅ¡tenje o napadu HTTP DDoS`
* `ObaveÅ¡tenje o napadu Layer 3/4 DDoS`
* `Napredno obaveÅ¡tenje o napadu HTTP DDoS`
* `Napredno obaveÅ¡tenje o napadu Layer 3/4 DDoS`
* `Monitoring zasnovan na protoku: Volumetrijski napad`
* `ObaveÅ¡tenje o otkrivanju curenja rute`
* `ObaveÅ¡tenje o isteku pristupnih mTLS sertifikata`
* `ObaveÅ¡tenje o SSL za SaaS prilagoÄ‘ene hostove`
* `Univerzalno SSL obaveÅ¡tenje`
* `ObaveÅ¡tenje o detekciji promene koda u novom monitoru skripti`
* `ObaveÅ¡tenje o novom domenu u novom monitoru skripti`
* `ObaveÅ¡tenje o novom zlonamernom domenu u novom monitoru skripti`
* `ObaveÅ¡tenje o novom zlonamernom skriptu u novom monitoru skripti`
* `ObaveÅ¡tenje o novom zlonamernom URL-u u novom monitoru skripti`
* `ObaveÅ¡tenje o novim skriptama u novom monitoru skripti`
* `ObaveÅ¡tenje o novom skriptu u novom monitoru skripti koji premaÅ¡uje maksimalnu duÅ¾inu URL-a`
* `Napredna obaveÅ¡tenja o sigurnosnim dogaÄ‘ajima`
* `ObaveÅ¡tenja o sigurnosnim dogaÄ‘ajima`
* [ ] Proverite sve **destinacije**, jer mogu postojati **osetljive informacije** (osnovna http autentikacija) u webhook URL-ovima. TakoÄ‘e se uverite da webhook URL-ovi koriste **HTTPS**
* [ ] Kao dodatnu proveru, moÅ¾ete pokuÅ¡ati da **se predstavite kao obaveÅ¡tenje od Cloudflare-a** treÄ‡oj strani, moÅ¾da na neki naÄin moÅ¾ete **ubaciti neÅ¡to opasno**

## Upravljanje nalogom

* [ ] MoguÄ‡e je videti **poslednje 4 cifre kreditne kartice**, **datum isteka** i **adresu za naplatu** u **`Billing` -> `Payment info`**.
* [ ] MoguÄ‡e je videti **tip plana** koji se koristi u nalogu u **`Billing` -> `Subscriptions`**.
* U **`Members`** je moguÄ‡e videti sve Älanove naloga i njihovu **ulogu**. Imajte na umu da ako tip plana nije Enterprise, postoje samo 2 uloge: Administrator i Super Administrator. Ali ako se koristi **Enterprise plan**, [**viÅ¡e uloga**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) moÅ¾e se koristiti kako bi se pratilo naÄelo najmanjih privilegija.
* Stoga, kad god je moguÄ‡e, **preporuÄljivo je koristiti** **Enterprise plan**.
* [ ] U Älanovima je moguÄ‡e proveriti koji **Älanovi** imaju omoguÄ‡eno **2FA**. **Svaki** korisnik bi trebalo da ga ima omoguÄ‡enog.

{% hint style="info" %}
Imajte na umu da sreÄ‡om uloga **`Administrator`** ne daje dozvole za upravljanje Älanstvima (**ne moÅ¾e eskalirati privilegije ili pozvati** nove Älanove)
{% endhint %}
## Istraga DDoS napada

[Pogledajte ovaj deo](cloudflare-domains.md#cloudflare-ddos-protection).

<details>

<summary><strong>NauÄite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naÄini podrÅ¡ke HackTricks-u:

* Ako Å¾elite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniÄni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), naÅ¡u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
