# Cloudflare Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** π’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Cloudflare κ³„μ •μ—λ” κµ¬μ„±ν•  μ μλ” **μΌλ° μ„¤μ • λ° μ„λΉ„μ¤**κ°€ μμµλ‹λ‹¤. μ΄ νμ΄μ§€μ—μ„λ” κ° μ„Ήμ…μ **λ³΄μ• κ΄€λ ¨ μ„¤μ •**μ„ **λ¶„μ„**ν•  κ²ƒμ…λ‹λ‹¤:

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Websites

κ° ν•­λ©μ„ κ²€ν† ν•μ‹­μ‹μ¤:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Domain Registration

* [ ] **`Transfer Domains`**μ—μ„ μ–΄λ–¤ λ„λ©”μΈλ„ μ „μ†΅ν•  μ μ—†λ”μ§€ ν™•μΈν•μ‹­μ‹μ¤.

κ° ν•­λ©μ„ κ²€ν† ν•μ‹­μ‹μ¤:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analytics

_κµ¬μ„± λ³΄μ• κ²€ν† λ¥Ό μ„ν• ν™•μΈν•  μ‚¬ν•­μ„ μ°Ύμ„ μ μ—†μ—μµλ‹λ‹¤._

## Pages

κ° Cloudflare νμ΄μ§€μ—μ„:

* [ ] **`Build log`**μ—μ„ **λ―Όκ°ν• μ •λ³΄**λ¥Ό ν™•μΈν•μ‹­μ‹μ¤.
* [ ] νμ΄μ§€μ— ν• λ‹Ήλ **Github repository**μ—μ„ **λ―Όκ°ν• μ •λ³΄**λ¥Ό ν™•μΈν•μ‹­μ‹μ¤.
* [ ] **workflow command injection** λλ” `pull_request_target` μ†μƒμ„ ν†µν• μ μ¬μ μΈ github repo μ†μƒμ„ ν™•μΈν•μ‹­μ‹μ¤. μμ„Έν• λ‚΄μ©μ€ [**Github Security page**](../github-security/)μ—μ„ ν™•μΈν•μ‹­μ‹μ¤.
* [ ] `/fuctions` λ””λ ‰ν† λ¦¬(μλ” κ²½μ°)μ—μ„ **μ·¨μ•½ν• ν•¨μ**λ¥Ό ν™•μΈν•κ³ , `_redirects` νμΌ(μλ” κ²½μ°)μ—μ„ **λ¦¬λ””λ ‰μ…**μ„ ν™•μΈν•λ©°, `_headers` νμΌ(μλ” κ²½μ°)μ—μ„ **μλ» κµ¬μ„±λ ν—¤λ”**λ¥Ό ν™•μΈν•μ‹­μ‹μ¤.
* [ ] **μ½”λ“μ— μ ‘κ·Όν•  μ μλ” κ²½μ°** **blackbox** λλ” **whitebox**λ¥Ό ν†µν•΄ **μ›Ή νμ΄μ§€**μ **μ·¨μ•½μ **μ„ ν™•μΈν•μ‹­μ‹μ¤.
* [ ] κ° νμ΄μ§€μ μ„Έλ¶€μ •λ³΄ `/<page_id>/pages/view/blocklist/settings/functions`μ—μ„ **`Environment variables`**μ— **λ―Όκ°ν• μ •λ³΄**κ°€ μλ”μ§€ ν™•μΈν•μ‹­μ‹μ¤.
* [ ] μ„Έλ¶€μ •λ³΄ νμ΄μ§€μ—μ„ **build command**μ™€ **root directory**λ¥Ό ν™•μΈν•μ—¬ νμ΄μ§€λ¥Ό μ†μƒμ‹ν‚¬ μ μλ” **μ μ¬μ  μ£Όμ…**μ„ ν™•μΈν•μ‹­μ‹μ¤.

## **Workers**

κ° Cloudflare workerμ—μ„ ν™•μΈν•μ‹­μ‹μ¤:

* [ ] νΈλ¦¬κ±°: λ¬΄μ—‡μ΄ workerλ¥Ό νΈλ¦¬κ±°ν•©λ‹κΉ? **μ‚¬μ©μκ°€ λ°μ΄ν„°λ¥Ό λ³΄λ‚Ό μ** μμµλ‹κΉ? μ΄ λ°μ΄ν„°λ” workerμ— μν•΄ **μ‚¬μ©**λ©λ‹κΉ?
* [ ] **`Settings`**μ—μ„ **λ―Όκ°ν• μ •λ³΄**λ¥Ό ν¬ν•¨ν•λ” **`Variables`**λ¥Ό ν™•μΈν•μ‹­μ‹μ¤.
* [ ] **workerμ μ½”λ“**λ¥Ό ν™•μΈν•κ³  **μ·¨μ•½μ **μ„ κ²€μƒ‰ν•μ‹­μ‹μ¤(νΉν μ‚¬μ©μκ°€ μ…λ ¥μ„ κ΄€λ¦¬ν•  μ μλ” κ³³μ—μ„).
* μ μ–΄ν•  μ μλ” νμ΄μ§€λ¥Ό λ°ν™ν•λ” SSRFλ¥Ό ν™•μΈν•μ‹­μ‹μ¤.
* svg μ΄λ―Έμ§€ λ‚΄μ—μ„ JSλ¥Ό μ‹¤ν–‰ν•λ” XSSλ¥Ό ν™•μΈν•μ‹­μ‹μ¤.
* workerκ°€ λ‚΄λ¶€ μ„λΉ„μ¤μ™€ μƒνΈμ‘μ©ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, workerλ” μ…λ ¥μ—μ„ μ–»μ€ μ •λ³΄λ¥Ό μ €μ¥ν•λ” R2 λ²„ν‚·κ³Ό μƒνΈμ‘μ©ν•  μ μμµλ‹λ‹¤. μ΄ κ²½μ°, workerκ°€ R2 λ²„ν‚·μ— λ€ν•΄ μ–΄λ–¤ κ¶ν•μ„ κ°€μ§€κ³  μμΌλ©° μ‚¬μ©μμ μ…λ ¥μΌλ΅λ¶€ν„° μ–΄λ–»κ² λ‚¨μ©λ  μ μλ”μ§€ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤.

{% hint style="warning" %}
κΈ°λ³Έμ μΌλ΅ **Workerλ”** `<worker-name>.<account>.workers.dev`μ™€ κ°™μ€ URLμ΄ μ κ³µλ©λ‹λ‹¤. μ‚¬μ©μλ” μ΄λ¥Ό **μ„λΈλ„λ©”μΈ**μΌλ΅ μ„¤μ •ν•  μ μμ§€λ§, μ•κ³  μλ‹¤λ©΄ ν•­μƒ κ·Έ **μ›λ URL**λ΅ μ ‘κ·Όν•  μ μμµλ‹λ‹¤.
{% endhint %}

## R2

κ° R2 λ²„ν‚·μ—μ„ ν™•μΈν•μ‹­μ‹μ¤:

* [ ] **CORS Policy**λ¥Ό κµ¬μ„±ν•μ‹­μ‹μ¤.

## Stream

TODO

## Images

TODO

## Security Center

* [ ] κ°€λ¥ν•λ‹¤λ©΄ **`Security Insights`** **μ¤μΊ”**κ³Ό **`Infrastructure`** **μ¤μΊ”**μ„ μ‹¤ν–‰ν•μ‹­μ‹μ¤. μ΄λ“¤μ€ **λ³΄μ•** μΈ΅λ©΄μ—μ„ ν¥λ―Έλ΅μ΄ μ •λ³΄λ¥Ό **κ°•μ΅°**ν•  κ²ƒμ…λ‹λ‹¤.
* [ ] λ³΄μ• μλ» κµ¬μ„± λ° ν¥λ―Έλ΅μ΄ μ •λ³΄λ¥Ό μ„ν•΄ **μ΄ μ •λ³΄λ¥Ό ν™•μΈν•μ‹­μ‹μ¤**.

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Bulk Redirects

{% hint style="info" %}
[Dynamic Redirects](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/)μ™€ λ‹¬λ¦¬, [**Bulk Redirects**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/)λ” λ³Έμ§μ μΌλ΅ μ •μ μ…λ‹λ‹¤ β€” λ¬Έμμ—΄ λ€μ²΄ μ‘μ—…μ΄λ‚ μ •κ· ν‘ν„μ‹μ„ μ§€μ›ν•μ§€ μ•μµλ‹λ‹¤. κ·Έλ¬λ‚ URL μΌμΉ λ™μ‘ λ° λ°νƒ€μ„ λ™μ‘μ— μν–¥μ„ λ―ΈμΉλ” URL λ¦¬λ””λ ‰μ… λ§¤κ°λ³€μλ¥Ό κµ¬μ„±ν•  μ μμµλ‹λ‹¤.
{% endhint %}

* [ ] **λ¦¬λ””λ ‰μ…**μ— λ€ν• **ν‘ν„μ‹**κ³Ό **μ”κµ¬ μ‚¬ν•­**μ΄ **μλ―Έκ°€ μλ”μ§€** ν™•μΈν•μ‹­μ‹μ¤.
* [ ] λν• **ν¥λ―Έλ΅μ΄ μ •λ³΄**λ¥Ό ν¬ν•¨ν•λ” **λ―Όκ°ν• μ¨κ²¨μ§„ μ—”λ“ν¬μΈνΈ**λ¥Ό ν™•μΈν•μ‹­μ‹μ¤.

## Notifications

* [ ] **μ•λ¦Ό**μ„ ν™•μΈν•μ‹­μ‹μ¤. μ΄λ¬ν• μ•λ¦Όμ€ λ³΄μ•μ„ μ„ν•΄ κ¶μ¥λ©λ‹λ‹¤:
* `Usage Based Billing`
* `HTTP DDoS Attack Alert`
* `Layer 3/4 DDoS Attack Alert`
* `Advanced HTTP DDoS Attack Alert`
* `Advanced Layer 3/4 DDoS Attack Alert`
* `Flow-based Monitoring: Volumetric Attack`
* `Route Leak Detection Alert`
* `Access mTLS Certificate Expiration Alert`
* `SSL for SaaS Custom Hostnames Alert`
* `Universal SSL Alert`
* `Script Monitor New Code Change Detection Alert`
* `Script Monitor New Domain Alert`
* `Script Monitor New Malicious Domain Alert`
* `Script Monitor New Malicious Script Alert`
* `Script Monitor New Malicious URL Alert`
* `Script Monitor New Scripts Alert`
* `Script Monitor New Script Exceeds Max URL Length Alert`
* `Advanced Security Events Alert`
* `Security Events Alert`
* [ ] λ¨λ“  **λ€μƒ**μ„ ν™•μΈν•μ‹­μ‹μ¤. μ›Ήν›… URLμ— **λ―Όκ°ν• μ •λ³΄**(κΈ°λ³Έ http μΈμ¦)κ°€ μμ„ μ μμµλ‹λ‹¤. μ›Ήν›… URLμ΄ **HTTPS**λ¥Ό μ‚¬μ©ν•λ”μ§€ ν™•μΈν•μ‹­μ‹μ¤.
* [ ] μ¶”κ°€ ν™•μΈμΌλ΅, **Cloudflare μ•λ¦Ό**μ„ μ 3μμ—κ² **κ°€μ¥**ν•΄ λ³΄μ‹­μ‹μ¤. μ–΄μ©λ©΄ **μ„ν—ν• κ²ƒμ„ μ£Όμ…**ν•  μ μμ„μ§€λ„ λ¨λ¦…λ‹λ‹¤.

## Manage Account

* [ ] **`Billing` -> `Payment info`**μ—μ„ **μ‹ μ© μΉ΄λ“μ λ§μ§€λ§‰ 4μλ¦¬**, **λ§λ£** μ‹κ°„ λ° **μ²­κµ¬ μ£Όμ†**λ¥Ό λ³Ό μ μμµλ‹λ‹¤.
* [ ] **`Billing` -> `Subscriptions`**μ—μ„ κ³„μ •μ— μ‚¬μ©λ **μ”κΈμ  μ ν•**μ„ λ³Ό μ μμµλ‹λ‹¤.
* [ ] **`Members`**μ—μ„ κ³„μ •μ λ¨λ“  κµ¬μ„±μ›κ³Ό κ·Έλ“¤μ **μ—­ν• **μ„ λ³Ό μ μμµλ‹λ‹¤. μ”κΈμ  μ ν•μ΄ Enterpriseκ°€ μ•„λ‹ κ²½μ°, λ‘ κ°€μ§€ μ—­ν• λ§ μ΅΄μ¬ν•©λ‹λ‹¤: Administratorμ™€ Super Administrator. κ·Έλ¬λ‚ μ‚¬μ©λ **μ”κΈμ κ°€ Enterprise**μΈ κ²½μ°, [**λ” λ§μ€ μ—­ν• **](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/)μ„ μ‚¬μ©ν•μ—¬ μµμ† κ¶ν• μ›μΉ™μ„ λ”°λ¥Ό μ μμµλ‹λ‹¤.
* λ”°λΌμ„ κ°€λ¥ν•  λ•λ§λ‹¤ **Enterprise μ”κΈμ **λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ **κ¶μ¥**λ©λ‹λ‹¤.
* [ ] Membersμ—μ„ **2FAκ°€ ν™μ„±ν™”λ** **κµ¬μ„±μ›**μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. **λ¨λ“ ** μ‚¬μ©μλ” μ΄λ¥Ό ν™μ„±ν™”ν•΄μ•Ό ν•©λ‹λ‹¤.

{% hint style="info" %}
λ‹¤ν–‰νλ„ μ—­ν•  **`Administrator`**λ” λ©¤λ²„μ‹­μ„ κ΄€λ¦¬ν•  μ μλ” κ¶ν•μ„ λ¶€μ—¬ν•μ§€ μ•μµλ‹λ‹¤ (**κ¶ν• μƒμΉμ΄λ‚** μƒλ΅μ΄ κµ¬μ„±μ› μ΄λ€ λ¶κ°€).
{% endhint %}

## DDoS Investigation

[μ΄ λ¶€λ¶„μ„ ν™•μΈν•μ‹­μ‹μ¤](cloudflare-domains.md#cloudflare-ddos-protection).

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** π’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
