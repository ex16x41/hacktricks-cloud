# Cloudflare Security

{% hint style="success" %}
AWS ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°:<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks μ§€μ›ν•κΈ°</summary>

* [**κµ¬λ… κ³„ν**](https://github.com/sponsors/carlospolop) ν™•μΈν•κΈ°!
* **π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— μ°Έμ—¬ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**λ¥Ό ν”λ΅μ°ν•μ„Έμ”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) λ° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) κΉƒν—λΈ λ¦¬ν¬μ§€ν† λ¦¬μ— PRμ„ μ μ¶ν•μ—¬ ν•΄ν‚Ή νμ„ κ³µμ ν•μ„Έμ”.**

</details>
{% endhint %}

Cloudflare κ³„μ •μ—λ” κµ¬μ„±ν•  μ μλ” **μΌλ° μ„¤μ • λ° μ„λΉ„μ¤**κ°€ μμµλ‹λ‹¤. μ΄ νμ΄μ§€μ—μ„λ” κ° μ„Ήμ…μ **λ³΄μ• κ΄€λ ¨ μ„¤μ •μ„ λ¶„μ„ν•  κ²ƒμ…λ‹λ‹¤:**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## μ›Ήμ‚¬μ΄νΈ

κ° ν•­λ©μ„ κ²€ν† ν•μ„Έμ”:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### λ„λ©”μΈ λ“±λ΅

* [ ] **`λ„λ©”μΈ μ „μ†΅`**μ—μ„ μ–΄λ–¤ λ„λ©”μΈλ„ μ „μ†΅ν•  μ μ—†λ”μ§€ ν™•μΈν•μ„Έμ”.

κ° ν•­λ©μ„ κ²€ν† ν•μ„Έμ”:

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## λ¶„μ„

_κµ¬μ„± λ³΄μ• κ²€ν† λ¥Ό μ„ν• ν™•μΈν•  μ‚¬ν•­μ„ μ°Ύμ„ μ μ—†μ—μµλ‹λ‹¤._

## νμ΄μ§€

κ° Cloudflare νμ΄μ§€μ—μ„:

* [ ] **`λΉλ“ λ΅κ·Έ`**μ—μ„ **λ―Όκ°ν• μ •λ³΄**λ¥Ό ν™•μΈν•μ„Έμ”.
* [ ] νμ΄μ§€μ— ν• λ‹Ήλ **Github λ¦¬ν¬μ§€ν† λ¦¬**μ—μ„ **λ―Όκ°ν• μ •λ³΄**λ¥Ό ν™•μΈν•μ„Έμ”.
* [ ] **μ›ν¬ν”λ΅μ° λ…λ Ή μ£Όμ…** λλ” `pull_request_target` μ†μƒμ„ ν†µν• μ μ¬μ μΈ github λ¦¬ν¬μ§€ν† λ¦¬ μ†μƒμ„ ν™•μΈν•μ„Έμ”. μμ„Έν• λ‚΄μ©μ€ [**Github λ³΄μ• νμ΄μ§€**](../github-security/)λ¥Ό μ°Έμ΅°ν•μ„Έμ”.
* [ ] `/fuctions` λ””λ ‰ν† λ¦¬(μλ” κ²½μ°)μ—μ„ **μ·¨μ•½ν• ν•¨μ**λ¥Ό ν™•μΈν•κ³ , `_redirects` νμΌ(μλ” κ²½μ°)μ—μ„ **λ¦¬λ””λ ‰μ…**μ„ ν™•μΈν•κ³ , `_headers` νμΌ(μλ” κ²½μ°)μ—μ„ **μλ» κµ¬μ„±λ ν—¤λ”**λ¥Ό ν™•μΈν•μ„Έμ”.
* [ ] **μ½”λ“μ— μ ‘κ·Όν•  μ μλ” κ²½μ°** **λΈ”λ™λ°•μ¤** λλ” **ν™”μ΄νΈλ°•μ¤**λ¥Ό ν†µν•΄ **μ›Ή νμ΄μ§€**μ **μ·¨μ•½μ **μ„ ν™•μΈν•μ„Έμ”.
* [ ] κ° νμ΄μ§€μ μ„Έλ¶€μ •λ³΄ `/<page_id>/pages/view/blocklist/settings/functions`μ—μ„ **`ν™κ²½ λ³€μ`**μ— **λ―Όκ°ν• μ •λ³΄**κ°€ μλ”μ§€ ν™•μΈν•μ„Έμ”.
* [ ] μ„Έλ¶€μ •λ³΄ νμ΄μ§€μ—μ„ **λΉλ“ λ…λ Ή** λ° **λ£¨νΈ λ””λ ‰ν† λ¦¬**λ¥Ό ν™•μΈν•μ—¬ νμ΄μ§€λ¥Ό μ†μƒμ‹ν‚¬ μ μλ” **μ μ¬μ  μ£Όμ…**μ„ ν™•μΈν•μ„Έμ”.

## **μ›μ»¤**

κ° Cloudflare μ›μ»¤μ—μ„ ν™•μΈν•μ„Έμ”:

* [ ] νΈλ¦¬κ±°: μ›μ»¤λ¥Ό νΈλ¦¬κ±°ν•λ” κ²ƒμ€ λ¬΄μ—‡μΈκ°€μ”? **μ‚¬μ©μκ°€ λ°μ΄ν„°λ¥Ό μ „μ†΅**ν•  μ μλ‚μ”? μ΄ λ°μ΄ν„°λ” μ›μ»¤μ— μν•΄ **μ‚¬μ©**λ  μ μλ‚μ”?
* [ ] **`μ„¤μ •`**μ—μ„ **λ―Όκ°ν• μ •λ³΄**λ¥Ό ν¬ν•¨ν•λ” **`λ³€μ`**λ¥Ό ν™•μΈν•μ„Έμ”.
* [ ] **μ›μ»¤μ μ½”λ“**λ¥Ό ν™•μΈν•κ³  **μ·¨μ•½μ **μ„ κ²€μƒ‰ν•μ„Έμ”(νΉν μ‚¬μ©μκ°€ μ…λ ¥μ„ κ΄€λ¦¬ν•  μ μλ” κ³³μ—μ„).
* μ μ–΄ν•  μ μλ” νμ΄μ§€λ¥Ό λ°ν™ν•λ” SSRFλ¥Ό ν™•μΈν•μ„Έμ”.
* SVG μ΄λ―Έμ§€ λ‚΄μ—μ„ JSλ¥Ό μ‹¤ν–‰ν•λ” XSSλ¥Ό ν™•μΈν•μ„Έμ”.
* μ›μ»¤κ°€ λ‚΄λ¶€ μ„λΉ„μ¤μ™€ μƒνΈμ‘μ©ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, μ›μ»¤λ” μ…λ ¥μ—μ„ μ–»μ€ μ •λ³΄λ¥Ό μ €μ¥ν•λ” R2 λ²„ν‚·κ³Ό μƒνΈμ‘μ©ν•  μ μμµλ‹λ‹¤. μ΄ κ²½μ°, μ›μ»¤κ°€ R2 λ²„ν‚·μ— λ€ν•΄ μ–΄λ–¤ κΈ°λ¥μ„ κ°€μ§€κ³  μλ”μ§€, κ·Έλ¦¬κ³  μ‚¬μ©μμ μ…λ ¥μΌλ΅λ¶€ν„° μ–΄λ–»κ² λ‚¨μ©λ  μ μλ”μ§€ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤.

{% hint style="warning" %}
κΈ°λ³Έμ μΌλ΅ **μ›μ»¤λ”** `<worker-name>.<account>.workers.dev`μ™€ κ°™μ€ URLμ΄ λ¶€μ—¬λ©λ‹λ‹¤. μ‚¬μ©μλ” μ΄λ¥Ό **μ„λΈλ„λ©”μΈ**μΌλ΅ μ„¤μ •ν•  μ μμ§€λ§, μ•κ³  μλ‹¤λ©΄ ν•­μƒ κ·Έ **μ›λ URL**λ΅ μ ‘κ·Όν•  μ μμµλ‹λ‹¤.
{% endhint %}

## R2

κ° R2 λ²„ν‚·μ—μ„ ν™•μΈν•μ„Έμ”:

* [ ] **CORS μ •μ±…**μ„ κµ¬μ„±ν•μ„Έμ”.

## μ¤νΈλ¦Ό

TODO

## μ΄λ―Έμ§€

TODO

## λ³΄μ• μ„Όν„°

* [ ] κ°€λ¥ν•λ‹¤λ©΄ **`λ³΄μ• ν†µμ°°λ ¥`** **μ¤μΊ”**κ³Ό **`μΈν”„λΌ`** **μ¤μΊ”**μ„ μ‹¤ν–‰ν•μ„Έμ”. μ΄λ“¤μ€ **λ³΄μ•** μΈ΅λ©΄μ—μ„ ν¥λ―Έλ΅μ΄ μ •λ³΄λ¥Ό **κ°•μ΅°**ν•  κ²ƒμ…λ‹λ‹¤.
* [ ] λ³΄μ• μλ» κµ¬μ„±λ μ •λ³΄μ™€ ν¥λ―Έλ΅μ΄ μ •λ³΄λ¥Ό ν™•μΈν•μ„Έμ”.

## ν„΄μ¤νƒ€μΌ

TODO

## **μ λ΅ νΈλ¬μ¤νΈ**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## λ€λ‰ λ¦¬λ””λ ‰μ…

{% hint style="info" %}
[λ™μ  λ¦¬λ””λ ‰μ…](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/)κ³Ό λ‹¬λ¦¬, [**λ€λ‰ λ¦¬λ””λ ‰μ…**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/)μ€ λ³Έμ§μ μΌλ΅ μ •μ μ…λ‹λ‹¤ β€” λ¬Έμμ—΄ λ€μ²΄ μ‘μ—…μ΄λ‚ μ •κ· ν‘ν„μ‹μ„ μ§€μ›ν•μ§€ μ•μµλ‹λ‹¤. κ·Έλ¬λ‚ URL μΌμΉ λ™μ‘ λ° λ°νƒ€μ„ λ™μ‘μ— μν–¥μ„ λ―ΈμΉλ” URL λ¦¬λ””λ ‰μ… λ§¤κ°λ³€μλ¥Ό κµ¬μ„±ν•  μ μμµλ‹λ‹¤.
{% endhint %}

* [ ] **ν‘ν„μ‹** λ° λ¦¬λ””λ ‰μ…μ— λ€ν• **μ”κµ¬ μ‚¬ν•­**μ΄ **ν•©λ¦¬μ μΈμ§€** ν™•μΈν•μ„Έμ”.
* [ ] λν• **ν¥λ―Έλ΅μ΄ μ •λ³΄**λ¥Ό ν¬ν•¨ν•λ” **λ―Όκ°ν• μ¨κ²¨μ§„ μ—”λ“ν¬μΈνΈ**λ¥Ό ν™•μΈν•μ„Έμ”.

## μ•λ¦Ό

* [ ] **μ•λ¦Ό**μ„ ν™•μΈν•μ„Έμ”. μ΄λ¬ν• μ•λ¦Όμ€ λ³΄μ•μ„ μ„ν•΄ κ¶μ¥λ©λ‹λ‹¤:
* `μ‚¬μ© κΈ°λ° μ²­κµ¬`
* `HTTP DDoS κ³µκ²© κ²½κ³ `
* `Layer 3/4 DDoS κ³µκ²© κ²½κ³ `
* `κ³ κΈ‰ HTTP DDoS κ³µκ²© κ²½κ³ `
* `κ³ κΈ‰ Layer 3/4 DDoS κ³µκ²© κ²½κ³ `
* `νλ¦„ κΈ°λ° λ¨λ‹ν„°λ§: λ³Όλ¥¨ κ³µκ²©`
* `λΌμ°νΈ λ„μ κ°μ§€ κ²½κ³ `
* `mTLS μΈμ¦μ„ λ§λ£ κ²½κ³ `
* `SaaS λ§μ¶¤ νΈμ¤νΈ μ΄λ¦„μ— λ€ν• SSL κ²½κ³ `
* `μ λ‹λ²„μ„¤ SSL κ²½κ³ `
* `μ¤ν¬λ¦½νΈ λ¨λ‹ν„° μƒ μ½”λ“ λ³€κ²½ κ°μ§€ κ²½κ³ `
* `μ¤ν¬λ¦½νΈ λ¨λ‹ν„° μƒ λ„λ©”μΈ κ²½κ³ `
* `μ¤ν¬λ¦½νΈ λ¨λ‹ν„° μƒ μ•…μ„± λ„λ©”μΈ κ²½κ³ `
* `μ¤ν¬λ¦½νΈ λ¨λ‹ν„° μƒ μ•…μ„± μ¤ν¬λ¦½νΈ κ²½κ³ `
* `μ¤ν¬λ¦½νΈ λ¨λ‹ν„° μƒ μ•…μ„± URL κ²½κ³ `
* `μ¤ν¬λ¦½νΈ λ¨λ‹ν„° μƒ μ¤ν¬λ¦½νΈ κ²½κ³ `
* `μ¤ν¬λ¦½νΈ λ¨λ‹ν„° μƒ μ¤ν¬λ¦½νΈκ°€ μµλ€ URL κΈΈμ΄λ¥Ό μ΄κ³Όν•λ” κ²½κ³ `
* `κ³ κΈ‰ λ³΄μ• μ΄λ²¤νΈ κ²½κ³ `
* `λ³΄μ• μ΄λ²¤νΈ κ²½κ³ `
* [ ] λ¨λ“  **λ€μƒ**μ„ ν™•μΈν•μ„Έμ”. μ›Ήν›… URLμ— **λ―Όκ°ν• μ •λ³΄**(κΈ°λ³Έ http μΈμ¦)κ°€ μμ„ μ μμµλ‹λ‹¤. μ›Ήν›… URLμ΄ **HTTPS**λ¥Ό μ‚¬μ©ν•λ”μ§€ ν™•μΈν•μ„Έμ”.
* [ ] μ¶”κ°€ ν™•μΈμΌλ΅, **Cloudflare μ•λ¦Ό**μ„ μ 3μμ—κ² **κ°€μ¥**ν•΄λ³΄μ„Έμ”. μ•„λ§λ„ **μ„ν—ν• κ²ƒμ„ μ£Όμ…**ν•  μ μμ„ κ²ƒμ…λ‹λ‹¤.

## κ³„μ • κ΄€λ¦¬

* [ ] **`μ²­κµ¬` -> `κ²°μ  μ •λ³΄`**μ—μ„ **μ‹ μ© μΉ΄λ“μ λ§μ§€λ§‰ 4μλ¦¬**, **λ§λ£** μ‹κ°„ λ° **μ²­κµ¬ μ£Όμ†**λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.
* [ ] **`μ²­κµ¬` -> `κµ¬λ…`**μ—μ„ κ³„μ •μ—μ„ μ‚¬μ© μ¤‘μΈ **μ”κΈμ  μ ν•**μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
* [ ] **`νμ›`**μ—μ„ κ³„μ •μ λ¨λ“  νμ›κ³Ό κ·Έλ“¤μ **μ—­ν• **μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. μ”κΈμ  μ ν•μ΄ μ—”ν„°ν”„λΌμ΄μ¦κ°€ μ•„λ‹ κ²½μ°, λ‘ κ°€μ§€ μ—­ν• λ§ μ΅΄μ¬ν•©λ‹λ‹¤: κ΄€λ¦¬μ λ° μνΌ κ΄€λ¦¬μ. κ·Έλ¬λ‚ μ‚¬μ© μ¤‘μΈ **μ”κΈμ κ°€ μ—”ν„°ν”„λΌμ΄μ¦**μΈ κ²½μ°, [**λ” λ§μ€ μ—­ν• **](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/)μ„ μ‚¬μ©ν•μ—¬ μµμ† κ¶ν• μ›μΉ™μ„ λ”°λ¥Ό μ μμµλ‹λ‹¤.
* λ”°λΌμ„ κ°€λ¥ν•  λ•λ§λ‹¤ **μ—”ν„°ν”„λΌμ΄μ¦ μ”κΈμ **λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ **κ¶μ¥λ©λ‹λ‹¤**.
* [ ] νμ›μ—μ„ **2FAκ°€ ν™μ„±ν™”λ** **νμ›**μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. **λ¨λ“ ** μ‚¬μ©μλ” μ΄λ¥Ό ν™μ„±ν™”ν•΄μ•Ό ν•©λ‹λ‹¤.

{% hint style="info" %}
λ‹¤ν–‰νλ„ μ—­ν•  **`κ΄€λ¦¬μ`**λ” λ©¤λ²„μ‹­μ„ κ΄€λ¦¬ν•  μ μλ” κ¶ν•μ„ λ¶€μ—¬ν•μ§€ μ•μµλ‹λ‹¤ (**κ¶ν• μƒμΉμ΄λ‚** μƒλ΅μ΄ νμ› μ΄λ€ λ¶κ°€).
{% endhint %}

## DDoS μ΅°μ‚¬

[μ΄ λ¶€λ¶„μ„ ν™•μΈν•μ„Έμ”](cloudflare-domains.md#cloudflare-ddos-protection).

{% hint style="success" %}
AWS ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°:<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
GCP ν•΄ν‚Ή λ°°μ°κΈ° λ° μ—°μµν•κΈ°: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks μ§€μ›ν•κΈ°</summary>

* [**κµ¬λ… κ³„ν**](https://github.com/sponsors/carlospolop) ν™•μΈν•κΈ°!
* **π’¬ [**Discord κ·Έλ£Ή**](https://discord.gg/hRep4RUj7f) λλ” [**ν…”λ κ·Έλ¨ κ·Έλ£Ή**](https://t.me/peass)μ— μ°Έμ—¬ν•κ±°λ‚ **Twitter** π¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**λ¥Ό ν”λ΅μ°ν•μ„Έμ”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) λ° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) κΉƒν—λΈ λ¦¬ν¬μ§€ν† λ¦¬μ— PRμ„ μ μ¶ν•μ—¬ ν•΄ν‚Ή νμ„ κ³µμ ν•μ„Έμ”.**

</details>
{% endhint %}
