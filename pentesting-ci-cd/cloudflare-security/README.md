# Cloudflare Security

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PRs åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}

åœ¨ä¸€ä¸ª Cloudflare è´¦æˆ·ä¸­ï¼Œæœ‰ä¸€äº›**é€šç”¨è®¾ç½®å’ŒæœåŠ¡**å¯ä»¥é…ç½®ã€‚åœ¨æœ¬é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å°†**åˆ†ææ¯ä¸ªéƒ¨åˆ†çš„å®‰å…¨ç›¸å…³è®¾ç½®ï¼š**

<figure><img src="../../.gitbook/assets/image (117).png" alt=""><figcaption></figcaption></figure>

## Websites

æ£€æŸ¥æ¯ä¸ªï¼š

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

### Domain Registration

* [ ] åœ¨ **`Transfer Domains`** ä¸­æ£€æŸ¥æ˜¯å¦æ— æ³•è½¬ç§»ä»»ä½•åŸŸåã€‚

æ£€æŸ¥æ¯ä¸ªï¼š

{% content-ref url="cloudflare-domains.md" %}
[cloudflare-domains.md](cloudflare-domains.md)
{% endcontent-ref %}

## Analytics

_æˆ‘æ‰¾ä¸åˆ°ä»»ä½•éœ€è¦æ£€æŸ¥çš„é…ç½®å®‰å…¨å®¡æŸ¥ã€‚_

## Pages

åœ¨æ¯ä¸ª Cloudflare çš„é¡µé¢ä¸Šï¼š

* [ ] æ£€æŸ¥ **`Build log`** ä¸­çš„**æ•æ„Ÿä¿¡æ¯**ã€‚
* [ ] æ£€æŸ¥åˆ†é…ç»™é¡µé¢çš„ **Github ä»“åº“**ä¸­çš„**æ•æ„Ÿä¿¡æ¯**ã€‚
* [ ] æ£€æŸ¥é€šè¿‡ **workflow command injection** æˆ– `pull_request_target` æ”»å‡»æ½œåœ¨çš„ github ä»“åº“æ³„éœ²ã€‚æ›´å¤šä¿¡æ¯è¯·å‚è§ [**Github Security page**](../github-security/)ã€‚
* [ ] æ£€æŸ¥ `/fuctions` ç›®å½•ï¼ˆå¦‚æœæœ‰ï¼‰ä¸­çš„**æ¼æ´å‡½æ•°**ï¼Œæ£€æŸ¥ `_redirects` æ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰ä¸­çš„**é‡å®šå‘**å’Œ `_headers` æ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰ä¸­çš„**é…ç½®é”™è¯¯çš„å¤´**ã€‚
* [ ] é€šè¿‡ **blackbox** æˆ– **whitebox** æ£€æŸ¥ **web é¡µé¢**ä¸­çš„**æ¼æ´**ï¼Œå¦‚æœä½ å¯ä»¥**è®¿é—®ä»£ç **ã€‚
* [ ] åœ¨æ¯ä¸ªé¡µé¢çš„è¯¦ç»†ä¿¡æ¯ `/<page_id>/pages/view/blocklist/settings/functions` ä¸­ã€‚æ£€æŸ¥ **`Environment variables`** ä¸­çš„**æ•æ„Ÿä¿¡æ¯**ã€‚
* [ ] åœ¨è¯¦ç»†ä¿¡æ¯é¡µé¢ä¸­è¿˜è¦æ£€æŸ¥ **build command** å’Œ **root directory** ä¸­çš„**æ½œåœ¨æ³¨å…¥**ï¼Œä»¥ä¾¿ç ´åé¡µé¢ã€‚

## **Workers**

åœ¨æ¯ä¸ª Cloudflare çš„ worker ä¸Šæ£€æŸ¥ï¼š

* [ ] è§¦å‘å™¨ï¼šæ˜¯ä»€ä¹ˆè§¦å‘äº† workerï¼Ÿç”¨æˆ·æ˜¯å¦å¯ä»¥å‘é€æ•°æ®ç»™ worker ä½¿ç”¨ï¼Ÿ
* [ ] åœ¨ **`Settings`** ä¸­ï¼Œæ£€æŸ¥ **`Variables`** ä¸­æ˜¯å¦åŒ…å«**æ•æ„Ÿä¿¡æ¯**ã€‚
* [ ] æ£€æŸ¥ **worker çš„ä»£ç **å¹¶æœç´¢**æ¼æ´**ï¼ˆç‰¹åˆ«æ˜¯åœ¨ç”¨æˆ·å¯ä»¥ç®¡ç†è¾“å…¥çš„åœ°æ–¹ï¼‰ã€‚
* æ£€æŸ¥è¿”å›ä½ å¯ä»¥æ§åˆ¶çš„é¡µé¢çš„ SSRFsã€‚
* æ£€æŸ¥åœ¨ svg å›¾åƒä¸­æ‰§è¡Œ JS çš„ XSSsã€‚
* å¯èƒ½ worker ä¼šä¸å…¶ä»–å†…éƒ¨æœåŠ¡äº¤äº’ã€‚ä¾‹å¦‚ï¼Œworker å¯èƒ½ä¼šä¸å­˜å‚¨ä»è¾“å…¥ä¸­è·å–ä¿¡æ¯çš„ R2 bucket äº¤äº’ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦æ£€æŸ¥ worker å¯¹ R2 bucket çš„èƒ½åŠ›ä»¥åŠå¦‚ä½•ä»ç”¨æˆ·è¾“å…¥ä¸­æ»¥ç”¨è¿™äº›èƒ½åŠ›ã€‚

{% hint style="warning" %}
è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ**Worker ä¼šè¢«èµ‹äºˆä¸€ä¸ª URL**ï¼Œä¾‹å¦‚ `<worker-name>.<account>.workers.dev`ã€‚ç”¨æˆ·å¯ä»¥å°†å…¶è®¾ç½®ä¸º**å­åŸŸ**ï¼Œä½†å¦‚æœä½ çŸ¥é“å®ƒï¼Œä½ æ€»æ˜¯å¯ä»¥ä½¿ç”¨è¯¥**åŸå§‹ URL** è®¿é—®å®ƒã€‚
{% endhint %}

## R2

åœ¨æ¯ä¸ª R2 bucket ä¸Šæ£€æŸ¥ï¼š

* [ ] é…ç½® **CORS Policy**ã€‚

## Stream

TODO

## Images

TODO

## Security Center

* [ ] å¦‚æœå¯èƒ½ï¼Œè¿è¡Œ **`Security Insights`** **æ‰«æ**å’Œ **`Infrastructure`** **æ‰«æ**ï¼Œå› ä¸ºå®ƒä»¬ä¼š**çªå‡ºæ˜¾ç¤º**å®‰å…¨æ–¹é¢çš„æœ‰è¶£ä¿¡æ¯ã€‚
* [ ] åªéœ€**æ£€æŸ¥è¿™äº›ä¿¡æ¯**ä»¥æŸ¥æ‰¾å®‰å…¨é…ç½®é”™è¯¯å’Œæœ‰è¶£çš„ä¿¡æ¯ã€‚

## Turnstile

TODO

## **Zero Trust**

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Bulk Redirects

{% hint style="info" %}
ä¸ [Dynamic Redirects](https://developers.cloudflare.com/rules/url-forwarding/dynamic-redirects/) ä¸åŒï¼Œ[**Bulk Redirects**](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) æœ¬è´¨ä¸Šæ˜¯é™æ€çš„â€”â€”å®ƒä»¬**ä¸æ”¯æŒä»»ä½•å­—ç¬¦ä¸²æ›¿æ¢**æ“ä½œæˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚ç„¶è€Œï¼Œä½ å¯ä»¥é…ç½®å½±å“å…¶ URL åŒ¹é…è¡Œä¸ºå’Œè¿è¡Œæ—¶è¡Œä¸ºçš„ URL é‡å®šå‘å‚æ•°ã€‚
{% endhint %}

* [ ] æ£€æŸ¥é‡å®šå‘çš„**è¡¨è¾¾å¼**å’Œ**è¦æ±‚**æ˜¯å¦**åˆç†**ã€‚
* [ ] è¿˜è¦æ£€æŸ¥æ˜¯å¦æœ‰**åŒ…å«æœ‰è¶£ä¿¡æ¯çš„æ•æ„Ÿéšè—ç«¯ç‚¹**ã€‚

## Notifications

* [ ] æ£€æŸ¥ **notifications**ã€‚è¿™äº›é€šçŸ¥æ¨èç”¨äºå®‰å…¨ï¼š
* `Usage Based Billing`
* `HTTP DDoS Attack Alert`
* `Layer 3/4 DDoS Attack Alert`
* `Advanced HTTP DDoS Attack Alert`
* `Advanced Layer 3/4 DDoS Attack Alert`
* `Flow-based Monitoring: Volumetric Attack`
* `Route Leak Detection Alert`
* `Access mTLS Certificate Expiration Alert`
* `SSL for SaaS Custom Hostnames Alert`
* `Universal SSL Alert`
* `Script Monitor New Code Change Detection Alert`
* `Script Monitor New Domain Alert`
* `Script Monitor New Malicious Domain Alert`
* `Script Monitor New Malicious Script Alert`
* `Script Monitor New Malicious URL Alert`
* `Script Monitor New Scripts Alert`
* `Script Monitor New Script Exceeds Max URL Length Alert`
* `Advanced Security Events Alert`
* `Security Events Alert`
* [ ] æ£€æŸ¥æ‰€æœ‰çš„**destinations**ï¼Œå› ä¸º webhook urls ä¸­å¯èƒ½æœ‰**æ•æ„Ÿä¿¡æ¯**ï¼ˆåŸºæœ¬ http è®¤è¯ï¼‰ã€‚è¿˜è¦ç¡®ä¿ webhook urls ä½¿ç”¨ **HTTPS**ã€‚
* [ ] ä½œä¸ºé¢å¤–æ£€æŸ¥ï¼Œä½ å¯ä»¥å°è¯•**å†’å…… cloudflare é€šçŸ¥**ç»™ç¬¬ä¸‰æ–¹ï¼Œä¹Ÿè®¸ä½ å¯ä»¥ä»¥æŸç§æ–¹å¼**æ³¨å…¥ä¸€äº›å±é™©çš„ä¸œè¥¿**ã€‚

## Manage Account

* [ ] åœ¨ **`Billing` -> `Payment info`** ä¸­å¯ä»¥çœ‹åˆ°**ä¿¡ç”¨å¡çš„æœ€å 4 ä½æ•°å­—**ã€**åˆ°æœŸæ—¶é—´**å’Œ**è´¦å•åœ°å€**ã€‚
* [ ] åœ¨ **`Billing` -> `Subscriptions`** ä¸­å¯ä»¥çœ‹åˆ°è´¦æˆ·ä½¿ç”¨çš„**è®¡åˆ’ç±»å‹**ã€‚
* [ ] åœ¨ **`Members`** ä¸­å¯ä»¥çœ‹åˆ°è´¦æˆ·çš„æ‰€æœ‰æˆå‘˜åŠå…¶**è§’è‰²**ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœè®¡åˆ’ç±»å‹ä¸æ˜¯ Enterpriseï¼Œåˆ™åªæœ‰ 2 ä¸ªè§’è‰²ï¼šAdministrator å’Œ Super Administratorã€‚ä½†å¦‚æœä½¿ç”¨çš„**è®¡åˆ’æ˜¯ Enterprise**ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ [**æ›´å¤šè§’è‰²**](https://developers.cloudflare.com/fundamentals/account-and-billing/account-setup/account-roles/) æ¥éµå¾ªæœ€å°ç‰¹æƒåŸåˆ™ã€‚
* å› æ­¤ï¼Œå°½å¯èƒ½ä½¿ç”¨**Enterprise è®¡åˆ’**æ˜¯**æ¨èçš„**ã€‚
* [ ] åœ¨ Members ä¸­å¯ä»¥æ£€æŸ¥å“ªäº›**æˆå‘˜**å¯ç”¨äº† **2FA**ã€‚**æ¯ä¸ª**ç”¨æˆ·éƒ½åº”è¯¥å¯ç”¨å®ƒã€‚

{% hint style="info" %}
è¯·æ³¨æ„ï¼Œå¹¸è¿çš„æ˜¯ï¼Œè§’è‰² **`Administrator`** æ²¡æœ‰æƒé™ç®¡ç†æˆå‘˜ï¼ˆ**ä¸èƒ½æå‡æƒé™æˆ–é‚€è¯·**æ–°æˆå‘˜ï¼‰ã€‚
{% endhint %}

## DDoS Investigation

[æ£€æŸ¥æ­¤éƒ¨åˆ†](cloudflare-domains.md#cloudflare-ddos-protection)ã€‚

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PRs åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}
