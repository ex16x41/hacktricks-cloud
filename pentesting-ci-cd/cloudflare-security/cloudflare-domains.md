# Cloudflare Domains

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

In jeder TLD, die in Cloudflare konfiguriert ist, gibt es einige **allgemeine Einstellungen und Dienste**, die konfiguriert werden k√∂nnen. Auf dieser Seite werden wir die **sicherheitsrelevanten Einstellungen jeder Sektion analysieren:**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

### √úbersicht

* [ ] Bekomme ein Gef√ºhl daf√ºr, **wie viel** die Dienste des Kontos **genutzt** werden
* [ ] Finde auch die **Zone-ID** und die **Kontonummer**

### Analytik

* [ ] √úberpr√ºfe in **`Sicherheit`**, ob es eine **Ratenbegrenzung** gibt

### DNS

* [ ] √úberpr√ºfe **interessante** (sensible?) Daten in den DNS **Eintr√§gen**
* [ ] √úberpr√ºfe auf **Subdomains**, die **sensible Informationen** nur basierend auf dem **Namen** enthalten k√∂nnten (wie admin173865324.domin.com)
* [ ] √úberpr√ºfe auf Webseiten, die **nicht** **proxied** sind
* [ ] √úberpr√ºfe auf **proxifizierte Webseiten**, die direkt √ºber CNAME oder IP-Adresse **zug√§nglich** sind
* [ ] √úberpr√ºfe, dass **DNSSEC** **aktiviert** ist
* [ ] √úberpr√ºfe, dass **CNAME Flattening** in **allen CNAMEs** **verwendet** wird
* Dies k√∂nnte n√ºtzlich sein, um **Subdomain-√úbernahmeanf√§lligkeiten** zu **verbergen** und die Ladezeiten zu verbessern
* [ ] √úberpr√ºfe, dass die Domains [**nicht anf√§llig f√ºr Spoofing sind**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

### **E-Mail**

TODO

### Spectrum

TODO

### SSL/TLS

#### **√úbersicht**

* [ ] Die **SSL/TLS-Verschl√ºsselung** sollte **Voll** oder **Voll (Streng)** sein. Jede andere wird zu einem bestimmten Zeitpunkt **Klartextverkehr** senden.
* [ ] Der **SSL/TLS-Empfehlungsdienst** sollte aktiviert sein

#### Edge-Zertifikate

* [ ] **Immer HTTPS verwenden** sollte **aktiviert** sein
* [ ] **HTTP Strict Transport Security (HSTS)** sollte **aktiviert** sein
* [ ] **Minimale TLS-Version sollte 1.2 sein**
* [ ] **TLS 1.3 sollte aktiviert sein**
* [ ] **Automatische HTTPS-Umschreibungen** sollten **aktiviert** sein
* [ ] **Zertifikatstransparenz√ºberwachung** sollte **aktiviert** sein

### **Sicherheit**

* [ ] Im **`WAF`**-Bereich ist es interessant zu √ºberpr√ºfen, dass **Firewall**- und **Ratenbegrenzungsregeln verwendet werden**, um Missbrauch zu verhindern.
* Die **`Bypass`**-Aktion wird die **Cloudflare-Sicherheits**-Funktionen f√ºr eine Anfrage **deaktivieren**. Sie sollte nicht verwendet werden.
* [ ] Im **`Page Shield`**-Bereich wird empfohlen zu √ºberpr√ºfen, dass es **aktiviert** ist, wenn eine Seite verwendet wird
* [ ] Im **`API Shield`**-Bereich wird empfohlen zu √ºberpr√ºfen, dass es **aktiviert** ist, wenn eine API in Cloudflare exponiert ist
* [ ] Im **`DDoS`**-Bereich wird empfohlen, die **DDoS-Schutzma√ünahmen** zu aktivieren
* [ ] Im **`Einstellungen`**-Bereich:
* [ ] √úberpr√ºfe, dass das **`Sicherheitsniveau`** **mittel** oder h√∂her ist
* [ ] √úberpr√ºfe, dass die **`Challenge Passage`** maximal 1 Stunde betr√§gt
* [ ] √úberpr√ºfe, dass die **`Browser-Integrit√§tspr√ºfung`** **aktiviert** ist
* [ ] √úberpr√ºfe, dass die **`Privacy Pass Unterst√ºtzung`** **aktiviert** ist

#### **CloudFlare DDoS-Schutz**

* Wenn m√∂glich, aktiviere den **Bot Fight Mode** oder den **Super Bot Fight Mode**. Wenn du eine API sch√ºtzt, die programmgesteuert (z. B. von einer JS-Frontend-Seite) aufgerufen wird, kannst du dies m√∂glicherweise nicht aktivieren, ohne diesen Zugriff zu unterbrechen.
* In **WAF**: Du kannst **Ratenlimits nach URL-Pfad** oder f√ºr **verifizierte Bots** (Ratenbegrenzungsregeln) erstellen oder den **Zugriff** basierend auf IP, Cookie, Referrer... **blockieren**. So k√∂nntest du Anfragen blockieren, die nicht von einer Webseite stammen oder kein Cookie haben.
* Wenn der Angriff von einem **verifizierten Bot** kommt, f√ºge mindestens ein **Ratenlimit** f√ºr Bots hinzu.
* Wenn der Angriff auf einen **bestimmten Pfad** abzielt, f√ºge als Pr√§ventionsmechanismus ein **Ratenlimit** in diesem Pfad hinzu.
* Du kannst auch IP-Adressen, IP-Bereiche, L√§nder oder ASNs √ºber die **Tools** in WAF **whitelisten**.
* √úberpr√ºfe, ob **verwaltete Regeln** auch helfen k√∂nnten, um die Ausnutzung von Schwachstellen zu verhindern.
* Im **Tools**-Bereich kannst du **bestimmte IPs** und **Benutzeragenten blockieren oder eine Herausforderung stellen.**
* Bei DDoS k√∂nntest du **einige Regeln √ºberschreiben, um sie restriktiver zu gestalten**.
* **Einstellungen**: Setze das **Sicherheitsniveau** auf **Hoch** und auf **Unter Angriff**, wenn du unter Angriff stehst und die **Browser-Integrit√§tspr√ºfung aktiviert ist**.
* In Cloudflare Domains -> Analytik -> Sicherheit -> √úberpr√ºfe, ob die **Ratenbegrenzung** aktiviert ist
* In Cloudflare Domains -> Sicherheit -> Ereignisse -> √úberpr√ºfe auf **erfasste b√∂sartige Ereignisse**

### Zugriff

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

### Geschwindigkeit

_Ich konnte keine Option finden, die mit Sicherheit zu tun hat_

### Caching

* [ ] Im **`Konfiguration`**-Bereich ziehe in Betracht, das **CSAM-Scanning-Tool** zu aktivieren

### **Workers-Routen**

_Du solltest bereits_ [_cloudflare workers_](./#workers) _√ºberpr√ºft haben_

### Regeln

TODO

### Netzwerk

* [ ] Wenn **`HTTP/2`** **aktiviert** ist, sollte **`HTTP/2 zu Origin`** **aktiviert** sein
* [ ] **`HTTP/3 (mit QUIC)`** sollte **aktiviert** sein
* [ ] Wenn die **Privatsph√§re** deiner **Nutzer** wichtig ist, stelle sicher, dass **`Onion Routing`** **aktiviert** ist

### **Verkehr**

TODO

### Benutzerdefinierte Seiten

* [ ] Es ist optional, benutzerdefinierte Seiten zu konfigurieren, wenn ein sicherheitsbezogenes Problem auftritt (wie eine Blockierung, Ratenbegrenzung oder Ich bin im Angriffsmodus)

### Apps

TODO

### Scrape Shield

* [ ] √úberpr√ºfe, ob die **E-Mail-Adressen-Verschleierung** **aktiviert** ist
* [ ] √úberpr√ºfe, ob die **Server-seitigen Ausschl√ºsse** **aktiviert** sind

### **Zaraz**

TODO

### **Web3**

TODO

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
