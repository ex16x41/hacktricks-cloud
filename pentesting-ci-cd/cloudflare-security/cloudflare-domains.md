# Domaines Cloudflare

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

Dans chaque TLD configur√© dans Cloudflare, il y a quelques **param√®tres g√©n√©raux et services** qui peuvent √™tre configur√©s. Sur cette page, nous allons **analyser les param√®tres li√©s √† la s√©curit√© de chaque section :**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

### Aper√ßu

* [ ] Avoir une id√©e de **combien** les services du compte sont **utilis√©s**
* [ ] Trouver √©galement le **zone ID** et le **compte ID**

### Analytique

* [ ] Dans **`S√©curit√©`**, v√©rifiez s'il y a une **limitation de taux**

### DNS

* [ ] V√©rifiez les donn√©es **int√©ressantes** (sensibles ?) dans les **enregistrements DNS**
* [ ] V√©rifiez les **sous-domaines** qui pourraient contenir des **informations sensibles** juste en fonction du **nom** (comme admin173865324.domin.com)
* [ ] V√©rifiez les pages web qui **ne sont pas** **proxy√©es**
* [ ] V√©rifiez les **pages web proxy√©es** qui peuvent √™tre **accessibles directement** par CNAME ou adresse IP
* [ ] V√©rifiez que **DNSSEC** est **activ√©**
* [ ] V√©rifiez que **CNAME Flattening** est **utilis√©** dans **tous les CNAMEs**
* Cela pourrait √™tre utile pour **cacher les vuln√©rabilit√©s de prise de contr√¥le de sous-domaine** et am√©liorer les temps de chargement
* [ ] V√©rifiez que les domaines [**ne sont pas vuln√©rables au spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

### **Email**

TODO

### Spectrum

TODO

### SSL/TLS

#### **Aper√ßu**

* [ ] Le **chiffrement SSL/TLS** doit √™tre **Complet** ou **Complet (Strict)**. Tout autre enverra du **trafic en clair** √† un moment donn√©.
* [ ] Le **Recommander SSL/TLS** doit √™tre activ√©

#### Certificats Edge

* [ ] **Toujours utiliser HTTPS** doit √™tre **activ√©**
* [ ] **HTTP Strict Transport Security (HSTS)** doit √™tre **activ√©**
* [ ] **La version minimale de TLS doit √™tre 1.2**
* [ ] **TLS 1.3 doit √™tre activ√©**
* [ ] **R√©√©critures automatiques HTTPS** doivent √™tre **activ√©es**
* [ ] **Surveillance de la transparence des certificats** doit √™tre **activ√©e**

### **S√©curit√©**

* [ ] Dans la section **`WAF`**, il est int√©ressant de v√©rifier que les **r√®gles de pare-feu** et de **limitation de taux sont utilis√©es** pour pr√©venir les abus.
* L'action **`Bypass`** d√©sactivera les fonctionnalit√©s de s√©curit√© de Cloudflare pour une requ√™te. Elle ne devrait pas √™tre utilis√©e.
* [ ] Dans la section **`Page Shield`**, il est recommand√© de v√©rifier qu'elle est **activ√©e** si une page est utilis√©e
* [ ] Dans la section **`API Shield`**, il est recommand√© de v√©rifier qu'elle est **activ√©e** si une API est expos√©e dans Cloudflare
* [ ] Dans la section **`DDoS`**, il est recommand√© d'activer les **protections DDoS**
* [ ] Dans la section **`Param√®tres`** :
* [ ] V√©rifiez que le **`Niveau de s√©curit√©`** est **moyen** ou sup√©rieur
* [ ] V√©rifiez que le **`D√©lai de d√©fi`** est de 1 heure au maximum
* [ ] V√©rifiez que le **`V√©rification de l'int√©grit√© du navigateur`** est **activ√©e**
* [ ] V√©rifiez que le **`Support Privacy Pass`** est **activ√©**

#### **Protection DDoS CloudFlare**

* Si vous le pouvez, activez le **Mode de combat contre les bots** ou le **Mode de combat contre les super bots**. Si vous prot√©gez une API accessible de mani√®re programmatique (depuis une page frontale JS par exemple). Vous pourriez ne pas √™tre en mesure d'activer cela sans rompre cet acc√®s.
* Dans **WAF** : Vous pouvez cr√©er des **limites de taux par chemin URL** ou pour des **bots v√©rifi√©s** (r√®gles de limitation de taux), ou pour **bloquer l'acc√®s** bas√© sur l'IP, le cookie, le r√©f√©rent...). Ainsi, vous pourriez bloquer les requ√™tes qui ne proviennent pas d'une page web ou qui n'ont pas de cookie.
* Si l'attaque provient d'un **bot v√©rifi√©**, au moins **ajoutez une limite de taux** aux bots.
* Si l'attaque est dirig√©e vers un **chemin sp√©cifique**, comme m√©canisme de pr√©vention, ajoutez une **limite de taux** dans ce chemin.
* Vous pouvez √©galement **mettre sur liste blanche** des adresses IP, des plages IP, des pays ou des ASN dans les **Outils** de WAF.
* V√©rifiez si les **r√®gles g√©r√©es** pourraient √©galement aider √† pr√©venir les exploitations de vuln√©rabilit√©s.
* Dans la section **Outils**, vous pouvez **bloquer ou donner un d√©fi √† des IP sp√©cifiques** et **agents utilisateurs.**
* Dans DDoS, vous pourriez **remplacer certaines r√®gles pour les rendre plus restrictives**.
* **Param√®tres** : R√©glez le **Niveau de s√©curit√©** sur **√âlev√©** et sur **Sous attaque** si vous √™tes sous attaque et que la **V√©rification de l'int√©grit√© du navigateur est activ√©e**.
* Dans Domaines Cloudflare -> Analytique -> S√©curit√© -> V√©rifiez si la **limite de taux** est activ√©e
* Dans Domaines Cloudflare -> S√©curit√© -> √âv√©nements -> V√©rifiez les **√©v√©nements malveillants d√©tect√©s**

### Acc√®s

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

### Vitesse

_Je n'ai pas trouv√© d'option li√©e √† la s√©curit√©_

### Mise en cache

* [ ] Dans la section **`Configuration`**, envisagez d'activer l'**outil de scan CSAM**

### **Routes des Workers**

_Vous devriez d√©j√† avoir v√©rifi√©_ [_cloudflare workers_](./#workers)

### R√®gles

TODO

### R√©seau

* [ ] Si **`HTTP/2`** est **activ√©**, **`HTTP/2 vers l'origine`** doit √™tre **activ√©**
* [ ] **`HTTP/3 (avec QUIC)`** doit √™tre **activ√©**
* [ ] Si la **vie priv√©e** de vos **utilisateurs** est importante, assurez-vous que **`Onion Routing`** est **activ√©**

### **Trafic**

TODO

### Pages personnalis√©es

* [ ] Il est optionnel de configurer des pages personnalis√©es lorsqu'une erreur li√©e √† la s√©curit√© est d√©clench√©e (comme un blocage, une limitation de taux ou le mode je suis sous attaque)

### Applications

TODO

### Scrape Shield

* [ ] V√©rifiez que l'**Obfuscation des adresses email** est **activ√©e**
* [ ] V√©rifiez que les **Exclusions c√¥t√© serveur** sont **activ√©es**

### **Zaraz**

TODO

### **Web3**

TODO

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
