# Dom√≠nios Cloudflare

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

Em cada TLD configurado no Cloudflare, existem algumas **configura√ß√µes e servi√ßos gerais** que podem ser configurados. Nesta p√°gina, vamos **analisar as configura√ß√µes relacionadas √† seguran√ßa de cada se√ß√£o:**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

### Vis√£o Geral

* [ ] Tenha uma no√ß√£o de **quanto** os servi√ßos da conta **s√£o utilizados**
* [ ] Encontre tamb√©m o **ID da zona** e o **ID da conta**

### An√°lise

* [ ] Em **`Seguran√ßa`**, verifique se h√° alguma **Limita√ß√£o de Taxa**

### DNS

* [ ] Verifique dados **interessantes** (sens√≠veis?) nos **registros DNS**
* [ ] Verifique por **subdom√≠nios** que possam conter **informa√ß√µes sens√≠veis** apenas com base no **nome** (como admin173865324.domin.com)
* [ ] Verifique por p√°ginas da web que **n√£o est√£o** **protegidas**
* [ ] Verifique por **p√°ginas da web protegidas** que podem ser **acessadas diretamente** por CNAME ou endere√ßo IP
* [ ] Verifique se o **DNSSEC** est√° **ativado**
* [ ] Verifique se o **CNAME Flattening** est√° **usado** em **todos os CNAMEs**
* Isso pode ser √∫til para **ocultar vulnerabilidades de takeover de subdom√≠nio** e melhorar os tempos de carregamento
* [ ] Verifique se os dom√≠nios [**n√£o s√£o vulner√°veis a spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

### **Email**

TODO

### Spectrum

TODO

### SSL/TLS

#### **Vis√£o Geral**

* [ ] A **criptografia SSL/TLS** deve ser **Completa** ou **Completa (Estrita)**. Qualquer outra op√ß√£o enviar√° **tr√°fego em texto claro** em algum momento.
* [ ] O **Recomendador SSL/TLS** deve estar ativado

#### Certificados de Edge

* [ ] **Sempre Usar HTTPS** deve estar **ativado**
* [ ] **HTTP Strict Transport Security (HSTS)** deve estar **ativado**
* [ ] **A vers√£o m√≠nima do TLS deve ser 1.2**
* [ ] **TLS 1.3 deve estar ativado**
* [ ] **Reescritas Autom√°ticas de HTTPS** devem estar **ativadas**
* [ ] **Monitoramento de Transpar√™ncia de Certificado** deve estar **ativado**

### **Seguran√ßa**

* [ ] Na se√ß√£o **`WAF`**, √© interessante verificar se as **regras de Firewall** e **limita√ß√£o de taxa est√£o sendo usadas** para prevenir abusos.
* A a√ß√£o **`Bypass`** ir√° **desativar as funcionalidades de seguran√ßa** do Cloudflare para uma solicita√ß√£o. N√£o deve ser usada.
* [ ] Na se√ß√£o **`Page Shield`**, √© recomendado verificar se est√° **ativado** se alguma p√°gina estiver em uso
* [ ] Na se√ß√£o **`API Shield`**, √© recomendado verificar se est√° **ativado** se alguma API estiver exposta no Cloudflare
* [ ] Na se√ß√£o **`DDoS`**, √© recomendado ativar as **prote√ß√µes DDoS**
* [ ] Na se√ß√£o **`Configura√ß√µes`**:
* [ ] Verifique se o **`N√≠vel de Seguran√ßa`** est√° **m√©dio** ou maior
* [ ] Verifique se o **`Tempo de Desafio`** √© de 1 hora no m√°ximo
* [ ] Verifique se a **`Verifica√ß√£o de Integridade do Navegador`** est√° **ativada**
* [ ] Verifique se o **`Suporte ao Privacy Pass`** est√° **ativado**

#### **Prote√ß√£o DDoS do CloudFlare**

* Se puder, ative o **Modo de Luta contra Bots** ou **Modo de Luta contra Super Bots**. Se voc√™ estiver protegendo alguma API acessada programaticamente (de uma p√°gina de front-end JS, por exemplo). Voc√™ pode n√£o conseguir ativar isso sem quebrar esse acesso.
* Em **WAF**: Voc√™ pode criar **limites de taxa por caminho de URL** ou para **bots verificados** (regras de limita√ß√£o de taxa), ou **bloquear acesso** com base em IP, Cookie, referenciador...). Assim, voc√™ poderia bloquear solicita√ß√µes que n√£o v√™m de uma p√°gina da web ou que n√£o t√™m um cookie.
* Se o ataque for de um **bot verificado**, pelo menos **adicione um limite de taxa** para bots.
* Se o ataque for a um **caminho espec√≠fico**, como mecanismo de preven√ß√£o, adicione um **limite de taxa** nesse caminho.
* Voc√™ tamb√©m pode **colocar na lista branca** endere√ßos IP, intervalos de IP, pa√≠ses ou ASNs nas **Ferramentas** no WAF.
* Verifique se as **Regras Gerenciadas** tamb√©m podem ajudar a prevenir explora√ß√µes de vulnerabilidades.
* Na se√ß√£o **Ferramentas**, voc√™ pode **bloquear ou desafiar IPs espec√≠ficos** e **agentes de usu√°rio.**
* Em DDoS, voc√™ pode **substituir algumas regras para torn√°-las mais restritivas**.
* **Configura√ß√µes**: Defina o **N√≠vel de Seguran√ßa** como **Alto** e para **Sob Ataque** se voc√™ estiver Sob Ataque e que a **Verifica√ß√£o de Integridade do Navegador esteja ativada**.
* Em Dom√≠nios Cloudflare -> An√°lise -> Seguran√ßa -> Verifique se a **limita√ß√£o de taxa** est√° ativada
* Em Dom√≠nios Cloudflare -> Seguran√ßa -> Eventos -> Verifique se h√° **Eventos maliciosos detectados**

### Acesso

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

### Velocidade

_N√£o consegui encontrar nenhuma op√ß√£o relacionada √† seguran√ßa_

### Cache

* [ ] Na se√ß√£o **`Configura√ß√£o`**, considere ativar a **Ferramenta de Escaneamento CSAM**

### **Rotas de Workers**

_Voc√™ j√° deve ter verificado_ [_cloudflare workers_](./#workers)

### Regras

TODO

### Rede

* [ ] Se **`HTTP/2`** estiver **ativado**, **`HTTP/2 para Origem`** deve estar **ativado**
* [ ] **`HTTP/3 (com QUIC)`** deve estar **ativado**
* [ ] Se a **privacidade** dos seus **usu√°rios** √© importante, certifique-se de que **`Onion Routing`** est√° **ativado**

### **Tr√°fego**

TODO

### P√°ginas Personalizadas

* [ ] √â opcional configurar p√°ginas personalizadas quando um erro relacionado √† seguran√ßa √© acionado (como um bloqueio, limita√ß√£o de taxa ou estou no modo sob ataque)

### Aplicativos

TODO

### Scrape Shield

* [ ] Verifique se a **Obfusca√ß√£o de Endere√ßo de Email** est√° **ativada**
* [ ] Verifique se os **Exclu√≠dos do Lado do Servidor** est√£o **ativados**

### **Zaraz**

TODO

### **Web3**

TODO

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
