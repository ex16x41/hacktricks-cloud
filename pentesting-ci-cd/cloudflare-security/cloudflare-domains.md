# Cloudflare Domains

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

W kaÅ¼dej TLD skonfigurowanej w Cloudflare znajdujÄ… siÄ™ **ogÃ³lne ustawienia i usÅ‚ugi**, ktÃ³re moÅ¼na skonfigurowaÄ‡. Na tej stronie zamierzamy **analizowaÄ‡ ustawienia zwiÄ…zane z bezpieczeÅ„stwem w kaÅ¼dej sekcji:**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

### PrzeglÄ…d

* [ ] ZdobÄ…dÅº poczucie **jak duÅ¼o** usÅ‚ugi konta **sÄ… uÅ¼ywane**
* [ ] ZnajdÅº rÃ³wnieÅ¼ **ID strefy** i **ID konta**

### Analiza

* [ ] W **`Security`** sprawdÅº, czy istnieje jakiekolwiek **ograniczenie liczby poÅ‚Ä…czeÅ„**

### DNS

* [ ] SprawdÅº **interesujÄ…ce** (wraÅ¼liwe?) dane w rekordach DNS
* [ ] SprawdÅº **subdomeny**, ktÃ³re mogÄ… zawieraÄ‡ **wraÅ¼liwe informacje** tylko na podstawie **nazwa** (jak admin173865324.domin.com)
* [ ] SprawdÅº strony internetowe, ktÃ³re **nie sÄ…** **proxy**
* [ ] SprawdÅº **proxyowane strony internetowe**, ktÃ³re moÅ¼na **uzyskaÄ‡ bezpoÅ›rednio** przez CNAME lub adres IP
* [ ] SprawdÅº, czy **DNSSEC** jest **wÅ‚Ä…czony**
* [ ] SprawdÅº, czy **CNAME Flattening** jest **uÅ¼ywane** we **wszystkich CNAME**
* MoÅ¼e to byÄ‡ przydatne do **ukrycia podatnoÅ›ci na przejÄ™cie subdomen** i poprawy czasÃ³w Å‚adowania
* [ ] SprawdÅº, czy domeny [**nie sÄ… podatne na spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

### **Email**

TODO

### Spectrum

TODO

### SSL/TLS

#### **PrzeglÄ…d**

* [ ] **Szyfrowanie SSL/TLS** powinno byÄ‡ **PeÅ‚ne** lub **PeÅ‚ne (ÅšcisÅ‚e)**. Jakiekolwiek inne spowoduje wysyÅ‚anie **ruchu w postaci czystego tekstu** w pewnym momencie.
* [ ] **Rekomendator SSL/TLS** powinien byÄ‡ wÅ‚Ä…czony

#### Certyfikaty krawÄ™dziowe

* [ ] **Zawsze uÅ¼ywaj HTTPS** powinno byÄ‡ **wÅ‚Ä…czone**
* [ ] **HTTP Strict Transport Security (HSTS)** powinno byÄ‡ **wÅ‚Ä…czone**
* [ ] **Minimalna wersja TLS powinna wynosiÄ‡ 1.2**
* [ ] **TLS 1.3 powinno byÄ‡ wÅ‚Ä…czone**
* [ ] **Automatyczne przepisywanie HTTPS** powinno byÄ‡ **wÅ‚Ä…czone**
* [ ] **Monitorowanie przejrzystoÅ›ci certyfikatÃ³w** powinno byÄ‡ **wÅ‚Ä…czone**

### **BezpieczeÅ„stwo**

* [ ] W sekcji **`WAF`** interesujÄ…ce jest sprawdzenie, czy **zasady zapory** i **ograniczenia liczby poÅ‚Ä…czeÅ„ sÄ… uÅ¼ywane** w celu zapobiegania naduÅ¼yciom.
* Akcja **`Bypass`** **wyÅ‚Ä…czy funkcje bezpieczeÅ„stwa Cloudflare** dla Å¼Ä…dania. Nie powinna byÄ‡ uÅ¼ywana.
* [ ] W sekcji **`Page Shield`** zaleca siÄ™ sprawdzenie, czy jest **wÅ‚Ä…czona**, jeÅ›li jakakolwiek strona jest uÅ¼ywana
* [ ] W sekcji **`API Shield`** zaleca siÄ™ sprawdzenie, czy jest **wÅ‚Ä…czona**, jeÅ›li jakiekolwiek API jest wystawione w Cloudflare
* [ ] W sekcji **`DDoS`** zaleca siÄ™ wÅ‚Ä…czenie **ochron DDoS**
* [ ] W sekcji **`Settings`**:
* [ ] SprawdÅº, czy **`Poziom bezpieczeÅ„stwa`** jest **Å›redni** lub wyÅ¼szy
* [ ] SprawdÅº, czy **`Czas wyzwania`** wynosi maksymalnie 1 godzinÄ™
* [ ] SprawdÅº, czy **`Sprawdzanie integralnoÅ›ci przeglÄ…darki`** jest **wÅ‚Ä…czone**
* [ ] SprawdÅº, czy **`Wsparcie dla Privacy Pass`** jest **wÅ‚Ä…czone**

#### **Ochrona DDoS CloudFlare**

* JeÅ›li moÅ¼esz, wÅ‚Ä…cz **Tryb walki z botami** lub **Super Tryb walki z botami**. JeÅ›li chronisz jakieÅ› API dostÄ™pne programowo (na przykÅ‚ad z strony frontowej JS). MoÅ¼esz nie byÄ‡ w stanie wÅ‚Ä…czyÄ‡ tego bez przerwania tego dostÄ™pu.
* W **WAF**: MoÅ¼esz tworzyÄ‡ **ograniczenia liczby poÅ‚Ä…czeÅ„ wedÅ‚ug Å›cieÅ¼ki URL** lub dla **zweryfikowanych botÃ³w** (zasady ograniczenia liczby poÅ‚Ä…czeÅ„), lub **blokowaÄ‡ dostÄ™p** na podstawie IP, ciasteczka, referera...). MoÅ¼esz wiÄ™c blokowaÄ‡ Å¼Ä…dania, ktÃ³re nie pochodzÄ… z strony internetowej lub nie majÄ… ciasteczka.
* JeÅ›li atak pochodzi od **zweryfikowanego bota**, przynajmniej **dodaj ograniczenie liczby poÅ‚Ä…czeÅ„** dla botÃ³w.
* JeÅ›li atak dotyczy **konkretnej Å›cieÅ¼ki**, jako mechanizm zapobiegawczy, dodaj **ograniczenie liczby poÅ‚Ä…czeÅ„** w tej Å›cieÅ¼ce.
* MoÅ¼esz rÃ³wnieÅ¼ **dodaÄ‡ do biaÅ‚ej listy** adresy IP, zakresy IP, kraje lub ASN z **NarzÄ™dzi** w WAF.
* SprawdÅº, czy **ZarzÄ…dzane zasady** mogÄ… rÃ³wnieÅ¼ pomÃ³c w zapobieganiu wykorzystaniu podatnoÅ›ci.
* W sekcji **NarzÄ™dzia** moÅ¼esz **blokowaÄ‡ lub stawiaÄ‡ wyzwanie dla konkretnych IP** i **agentÃ³w uÅ¼ytkownika.**
* W DDoS moÅ¼esz **nadpisaÄ‡ niektÃ³re zasady, aby byÅ‚y bardziej restrykcyjne**.
* **Ustawienia**: Ustaw **Poziom bezpieczeÅ„stwa** na **Wysoki** i na **Pod atakiem**, jeÅ›li jesteÅ› pod atakiem i **Sprawdzanie integralnoÅ›ci przeglÄ…darki jest wÅ‚Ä…czone**.
* W Cloudflare Domains -> Analiza -> BezpieczeÅ„stwo -> SprawdÅº, czy **ograniczenie liczby poÅ‚Ä…czeÅ„** jest wÅ‚Ä…czone
* W Cloudflare Domains -> BezpieczeÅ„stwo -> Wydarzenia -> SprawdÅº, czy sÄ… **wykryte zÅ‚oÅ›liwe wydarzenia**

### DostÄ™p

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

### SzybkoÅ›Ä‡

_Nie mogÅ‚em znaleÅºÄ‡ Å¼adnej opcji zwiÄ…zanej z bezpieczeÅ„stwem_

### Caching

* [ ] W sekcji **`Configuration`** rozwaÅ¼ wÅ‚Ä…czenie **NarzÄ™dzia skanowania CSAM**

### **Trasy pracownikÃ³w**

_PowinieneÅ› juÅ¼ sprawdziÄ‡_ [_cloudflare workers_](./#workers)

### Zasady

TODO

### SieÄ‡

* [ ] JeÅ›li **`HTTP/2`** jest **wÅ‚Ä…czone**, **`HTTP/2 do Origin`** powinno byÄ‡ **wÅ‚Ä…czone**
* [ ] **`HTTP/3 (z QUIC)`** powinno byÄ‡ **wÅ‚Ä…czone**
* [ ] JeÅ›li **prywatnoÅ›Ä‡** twoich **uÅ¼ytkownikÃ³w** jest waÅ¼na, upewnij siÄ™, Å¼e **`Onion Routing`** jest **wÅ‚Ä…czone**

### **Ruch**

TODO

### Strony niestandardowe

* [ ] Opcjonalnie moÅ¼na skonfigurowaÄ‡ strony niestandardowe, gdy wystÄ…pi bÅ‚Ä…d zwiÄ…zany z bezpieczeÅ„stwem (jak blokada, ograniczenie liczby poÅ‚Ä…czeÅ„ lub tryb pod atakiem)

### Aplikacje

TODO

### Scrape Shield

* [ ] SprawdÅº, czy **Obfuskacja adresu e-mail** jest **wÅ‚Ä…czona**
* [ ] SprawdÅº, czy **Wykluczenia po stronie serwera** sÄ… **wÅ‚Ä…czone**

### **Zaraz**

TODO

### **Web3**

TODO

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
