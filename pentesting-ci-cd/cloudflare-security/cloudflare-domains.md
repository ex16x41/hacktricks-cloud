# Cloudflare Domains

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

U svakom TLD-u konfigurisanom u Cloudflare postoje neka **opšta podešavanja i usluge** koje se mogu konfigurisati. Na ovoj stranici ćemo **analizirati podešavanja vezana za sigurnost svake sekcije:**

<figure><img src="../../.gitbook/assets/image (101).png" alt=""><figcaption></figcaption></figure>

### Pregled

* [ ] Steknite osećaj o **koliko** su usluge naloga **korišćene**
* [ ] Takođe pronađite **zone ID** i **nalog ID**

### Analitika

* [ ] U **`Security`** proverite da li postoji **ograničenje brzine**

### DNS

* [ ] Proverite **zanimljive** (osetljive?) podatke u DNS **rekordima**
* [ ] Proverite **poddomene** koje bi mogle sadržati **osetljive informacije** samo na osnovu **imena** (kao admin173865324.domin.com)
* [ ] Proverite web stranice koje **nisu** **proksirane**
* [ ] Proverite **proksirane web stranice** koje se mogu **direktno pristupiti** putem CNAME-a ili IP adrese
* [ ] Proverite da li je **DNSSEC** **omogućen**
* [ ] Proverite da li se **CNAME Flattening** **koristi** u **svim CNAME-ima**
* Ovo može biti korisno za **sakrivanje ranjivosti preuzimanja poddomena** i poboljšanje vremena učitavanja
* [ ] Proverite da li domene [**nisu ranjive na spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)

### **Email**

TODO

### Spectrum

TODO

### SSL/TLS

#### **Pregled**

* [ ] **SSL/TLS enkripcija** treba da bude **Full** ili **Full (Strict)**. Svaka druga će slati **saobraćaj u čistom tekstu** u nekom trenutku.
* [ ] **SSL/TLS Preporučivač** treba da bude omogućen

#### Edge Sertifikati

* [ ] **Always Use HTTPS** treba da bude **omogućeno**
* [ ] **HTTP Strict Transport Security (HSTS)** treba da bude **omogućeno**
* [ ] **Minimalna TLS verzija treba da bude 1.2**
* [ ] **TLS 1.3 treba da bude omogućen**
* [ ] **Automatska HTTPS prepravka** treba da bude **omogućena**
* [ ] **Praćenje transparentnosti sertifikata** treba da bude **omogućeno**

### **Sigurnost**

* [ ] U sekciji **`WAF`** zanimljivo je proveriti da li se koriste **Firewall** i **pravila ograničenja brzine** za sprečavanje zloupotreba.
* Akcija **`Bypass`** će **onemogućiti Cloudflare sigurnosne** funkcije za zahtev. Ne bi trebala da se koristi.
* [ ] U sekciji **`Page Shield`** preporučuje se da proverite da li je **omogućeno** ako se koristi neka stranica
* [ ] U sekciji **`API Shield`** preporučuje se da proverite da li je **omogućeno** ako je neki API izložen u Cloudflare
* [ ] U sekciji **`DDoS`** preporučuje se omogućiti **DDoS zaštitu**
* [ ] U sekciji **`Settings`**:
* [ ] Proverite da li je **`Security Level`** **srednji** ili veći
* [ ] Proverite da li je **`Challenge Passage`** 1 sat maksimalno
* [ ] Proverite da li je **`Browser Integrity Check`** **omogućen**
* [ ] Proverite da li je **`Privacy Pass Support`** **omogućen**

#### **CloudFlare DDoS Zaštita**

* Ako možete, omogućite **Bot Fight Mode** ili **Super Bot Fight Mode**. Ako štitite neki API koji se pristupa programatski (na primer, sa JS front-end stranice). Možda nećete moći da omogućite ovo bez prekidanja tog pristupa.
* U **WAF**: Možete kreirati **ograničenja brzine po URL putanji** ili za **verifikovane botove** (pravila ograničenja brzine), ili da **blokirate pristup** na osnovu IP adrese, kolačića, referera...). Tako možete blokirati zahteve koji ne dolaze sa web stranice ili nemaju kolačić.
* Ako je napad od **verifikovanog bota**, barem **dodajte ograničenje brzine** za botove.
* Ako je napad na **specifičnu putanju**, kao mehanizam prevencije, dodajte **ograničenje brzine** na ovoj putanji.
* Takođe možete **dodati na belu listu** IP adrese, IP opsege, zemlje ili ASN-ove iz **Alata** u WAF-u.
* Proverite da li **Upravljana pravila** takođe mogu pomoći u sprečavanju eksploatacije ranjivosti.
* U sekciji **Alati** možete **blokirati ili dati izazov specifičnim IP-ovima** i **korisničkim agentima.**
* U DDoS-u možete **prepraviti neka pravila da ih učinite restriktivnijim**.
* **Podešavanja**: Postavite **Security Level** na **High** i na **Under Attack** ako ste pod napadom i da je **Browser Integrity Check omogućen**.
* U Cloudflare Domains -> Analitika -> Sigurnost -> Proverite da li je **ograničenje brzine** omogućeno
* U Cloudflare Domains -> Sigurnost -> Događaji -> Proverite za **otkrivene zlonamerne događaje**

### Pristup

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

### Brzina

_Nisam mogao pronaći nijednu opciju vezanu za sigurnost_

### Keširanje

* [ ] U sekciji **`Configuration`** razmotrite omogućavanje **CSAM Scanning Tool**

### **Workers Rute**

_Već ste trebali proveriti_ [_cloudflare workers_](./#workers)

### Pravila

TODO

### Mreža

* [ ] Ako je **`HTTP/2`** **omogućen**, **`HTTP/2 to Origin`** treba da bude **omogućen**
* [ ] **`HTTP/3 (with QUIC)`** treba da bude **omogućen**
* [ ] Ako je **privatnost** vaših **korisnika** važna, uverite se da je **`Onion Routing`** **omogućen**

### **Saobraćaj**

TODO

### Prilagođene stranice

* [ ] Opcionalno je konfigurisati prilagođene stranice kada se aktivira greška vezana za sigurnost (kao što su blokada, ograničenje brzine ili sam pod napadom)

### Aplikacije

TODO

### Scrape Shield

* [ ] Proverite da li je **Obfuscation Email Adresa** **omogućena**
* [ ] Proverite da li su **Server-side Excludes** **omogućene**

### **Zaraz**

TODO

### **Web3**

TODO

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
