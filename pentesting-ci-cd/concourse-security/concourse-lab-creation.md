# Concourse Lab Creation

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Test OrtamÄ±

### Concourse'u Ã‡alÄ±ÅŸtÄ±rma

#### Docker-Compose ile

Bu docker-compose dosyasÄ±, concourse ile bazÄ± testler yapmak iÃ§in kurulumu basitleÅŸtirir:
```bash
wget https://raw.githubusercontent.com/starkandwayne/concourse-tutorial/master/docker-compose.yml
docker-compose up -d
```
`fly` komut satÄ±rÄ±nÄ± iÅŸletim sisteminiz iÃ§in `127.0.0.1:8080` adresinden indirebilirsiniz.

#### Kubernetes ile (Tavsiye Edilir)

**Kubernetes** (Ã¶rneÄŸin **minikube** iÃ§inde) kullanarak concourse'u kolayca daÄŸÄ±tabilirsiniz: [**concourse-chart**](https://github.com/concourse/concourse-chart).
```bash
brew install helm
helm repo add concourse https://concourse-charts.storage.googleapis.com/
helm install concourse-release concourse/concourse
# concourse-release will be the prefix name for the concourse elements in k8s
# After the installation you will find the indications to connect to it in the console

# If you need to delete it
helm delete concourse-release
```
Concourse ortamÄ±nÄ± oluÅŸturduktan sonra, bir gizli anahtar oluÅŸturabilir ve concourse web'de Ã§alÄ±ÅŸan SA'ya K8s gizli anahtarlarÄ±na eriÅŸim verebilirsiniz:
```yaml
echo 'apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
name: read-secrets
rules:
- apiGroups: [""]
resources: ["secrets"]
verbs: ["get"]

---

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
name: read-secrets-concourse
roleRef:
apiGroup: rbac.authorization.k8s.io
kind: ClusterRole
name: read-secrets
subjects:
- kind: ServiceAccount
name: concourse-release-web
namespace: default

---

apiVersion: v1
kind: Secret
metadata:
name: super
namespace: concourse-release-main
type: Opaque
data:
secret: MWYyZDFlMmU2N2Rm

' | kubectl apply -f -
```
### Pipeline OluÅŸtur

Bir pipeline, sÄ±ralÄ± bir [AdÄ±mlar](https://concourse-ci.org/steps.html) listesi iÃ§eren bir [Ä°ÅŸler](https://concourse-ci.org/jobs.html) listesinden oluÅŸur.

### AdÄ±mlar

BirÃ§ok farklÄ± tÃ¼rde adÄ±m kullanÄ±labilir:

* **`task` adÄ±mÄ±** [**`task`**](https://concourse-ci.org/tasks.html) **Ã§alÄ±ÅŸtÄ±rÄ±r**
* [`get` adÄ±mÄ±](https://concourse-ci.org/get-step.html) bir [kaynaÄŸÄ±](https://concourse-ci.org/resources.html) alÄ±r
* [`put` adÄ±mÄ±](https://concourse-ci.org/put-step.html) bir [kaynaÄŸÄ±](https://concourse-ci.org/resources.html) gÃ¼nceller
* [`set_pipeline` adÄ±mÄ±](https://concourse-ci.org/set-pipeline-step.html) bir [pipeline](https://concourse-ci.org/pipelines.html) yapÄ±landÄ±rÄ±r
* [`load_var` adÄ±mÄ±](https://concourse-ci.org/load-var-step.html) bir deÄŸeri [yerel deÄŸiÅŸkene](https://concourse-ci.org/vars.html#local-vars) yÃ¼kler
* [`in_parallel` adÄ±mÄ±](https://concourse-ci.org/in-parallel-step.html) adÄ±mlarÄ± paralel olarak Ã§alÄ±ÅŸtÄ±rÄ±r
* [`do` adÄ±mÄ±](https://concourse-ci.org/do-step.html) adÄ±mlarÄ± sÄ±rayla Ã§alÄ±ÅŸtÄ±rÄ±r
* [`across` adÄ±m deÄŸiÅŸtiricisi](https://concourse-ci.org/across-step.html#schema.across) bir adÄ±mÄ± birden fazla kez Ã§alÄ±ÅŸtÄ±rÄ±r; her bir deÄŸiÅŸken deÄŸeri kombinasyonu iÃ§in bir kez
* [`try` adÄ±mÄ±](https://concourse-ci.org/try-step.html) bir adÄ±mÄ± Ã§alÄ±ÅŸtÄ±rmayÄ± dener ve adÄ±m baÅŸarÄ±sÄ±z olsa bile baÅŸarÄ±lÄ± olur

Her [adÄ±m](https://concourse-ci.org/steps.html) bir [iÅŸ planÄ±nda](https://concourse-ci.org/jobs.html#schema.job.plan) **kendi konteynerinde** Ã§alÄ±ÅŸÄ±r. Konteynerin iÃ§inde istediÄŸiniz her ÅŸeyi Ã§alÄ±ÅŸtÄ±rabilirsiniz _(yani testlerimi Ã§alÄ±ÅŸtÄ±r, bu bash betiÄŸini Ã§alÄ±ÅŸtÄ±r, bu gÃ¶rÃ¼ntÃ¼yÃ¼ oluÅŸtur, vb.)_. DolayÄ±sÄ±yla, beÅŸ adÄ±mÄ± olan bir iÅŸiniz varsa, Concourse her adÄ±m iÃ§in bir tane olmak Ã¼zere beÅŸ konteyner oluÅŸturacaktÄ±r.

Bu nedenle, her adÄ±mÄ±n Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± gereken konteyner tÃ¼rÃ¼nÃ¼ belirtmek mÃ¼mkÃ¼ndÃ¼r.

### Basit Pipeline Ã–rneÄŸi
```yaml
jobs:
- name: simple
plan:
- task: simple-task
privileged: true
config:
# Tells Concourse which type of worker this task should run on
platform: linux
image_resource:
type: registry-image
source:
repository: busybox # images are pulled from docker hub by default
run:
path: sh
args:
- -cx
- |
sleep 1000
echo "$SUPER_SECRET"
params:
SUPER_SECRET: ((super.secret))
```

```bash
fly -t tutorial set-pipeline -p pipe-name -c hello-world.yml
# pipelines are paused when first created
fly -t tutorial unpause-pipeline -p pipe-name
# trigger the job and watch it run to completion
fly -t tutorial trigger-job --job pipe-name/simple --watch
# From another console
fly -t tutorial intercept --job pipe-name/simple
```
Check **127.0.0.1:8080** to see the pipeline flow.

### Bash script with output/input pipeline

Bir gÃ¶revin sonuÃ§larÄ±nÄ± bir dosyada **kaydetmek** ve bunun bir Ã§Ä±ktÄ± olduÄŸunu belirtmek, ardÄ±ndan bir sonraki gÃ¶revin giriÅŸini Ã¶nceki gÃ¶revin Ã§Ä±ktÄ±sÄ± olarak belirtmek mÃ¼mkÃ¼ndÃ¼r. Concourse'un yaptÄ±ÄŸÄ± ÅŸey, **Ã¶nceki gÃ¶revin dizinini yeni gÃ¶revde monte etmek ve Ã¶nceki gÃ¶rev tarafÄ±ndan oluÅŸturulan dosyalara eriÅŸmektir**.

### Triggers

Her seferinde iÅŸleri manuel olarak tetiklemek zorunda deÄŸilsiniz, her seferinde Ã§alÄ±ÅŸacak ÅŸekilde programlayabilirsiniz:

* Bir sÃ¼re geÃ§tikten sonra: [Time resource](https://github.com/concourse/time-resource/)
* Ana dalda yeni commitler olduÄŸunda: [Git resource](https://github.com/concourse/git-resource)
* Yeni PR'ler: [Github-PR resource](https://github.com/telia-oss/github-pr-resource)
* UygulamanÄ±zÄ±n en son gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ almak veya gÃ¶ndermek: [Registry-image resource](https://github.com/concourse/registry-image-resource/)

Ana dalda yeni commitler tetikleyen bir YAML pipeline Ã¶rneÄŸini [https://concourse-ci.org/tutorial-resources.html](https://concourse-ci.org/tutorial-resources.html) adresinde kontrol edin.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
