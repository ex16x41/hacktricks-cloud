# Concourse Lab Creation

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Testing Environment

### Running Concourse

#### With Docker-Compose

–¶–µ–π —Ñ–∞–π–ª docker-compose —Å–ø—Ä–æ—â—É—î —É—Å—Ç–∞–Ω–æ–≤–∫—É –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –¥–µ—è–∫–∏—Ö —Ç–µ—Å—Ç—ñ–≤ –∑ concourse:
```bash
wget https://raw.githubusercontent.com/starkandwayne/concourse-tutorial/master/docker-compose.yml
docker-compose up -d
```
–í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫ `fly` –¥–ª—è –≤–∞—à–æ—ó –û–° –∑ –≤–µ–±—É –∑–∞ –∞–¥—Ä–µ—Å–æ—é `127.0.0.1:8080`

#### –ó Kubernetes (–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è)

–í–∏ –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ concourse –≤ **Kubernetes** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ **minikube**) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é helm-chart: [**concourse-chart**](https://github.com/concourse/concourse-chart).
```bash
brew install helm
helm repo add concourse https://concourse-charts.storage.googleapis.com/
helm install concourse-release concourse/concourse
# concourse-release will be the prefix name for the concourse elements in k8s
# After the installation you will find the indications to connect to it in the console

# If you need to delete it
helm delete concourse-release
```
–ü—ñ—Å–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ concourse, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç —ñ –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø SA, —â–æ –ø—Ä–∞—Ü—é—î –≤ concourse web, –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ K8s —Å–µ–∫—Ä–µ—Ç—ñ–≤:
```yaml
echo 'apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
name: read-secrets
rules:
- apiGroups: [""]
resources: ["secrets"]
verbs: ["get"]

---

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
name: read-secrets-concourse
roleRef:
apiGroup: rbac.authorization.k8s.io
kind: ClusterRole
name: read-secrets
subjects:
- kind: ServiceAccount
name: concourse-release-web
namespace: default

---

apiVersion: v1
kind: Secret
metadata:
name: super
namespace: concourse-release-main
type: Opaque
data:
secret: MWYyZDFlMmU2N2Rm

' | kubectl apply -f -
```
### –°—Ç–≤–æ—Ä–∏—Ç–∏ Pipeline

Pipeline —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑—ñ —Å–ø–∏—Å–∫—É [Jobs](https://concourse-ci.org/jobs.html), —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –≤–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ [Steps](https://concourse-ci.org/steps.html).

### Steps

–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –∫—Ä–æ–∫—ñ–≤:

* **–∫—Ä–æ–∫** [**`task` step**](https://concourse-ci.org/task-step.html) **–≤–∏–∫–æ–Ω—É—î** [**task**](https://concourse-ci.org/tasks.html)
* –∫—Ä–æ–∫ [`get` step](https://concourse-ci.org/get-step.html) –æ—Ç—Ä–∏–º—É—î [resource](https://concourse-ci.org/resources.html)
* –∫—Ä–æ–∫ [`put` step](https://concourse-ci.org/put-step.html) –æ–Ω–æ–≤–ª—é—î [resource](https://concourse-ci.org/resources.html)
* –∫—Ä–æ–∫ [`set_pipeline` step](https://concourse-ci.org/set-pipeline-step.html) –Ω–∞–ª–∞—à—Ç–æ–≤—É—î [pipeline](https://concourse-ci.org/pipelines.html)
* –∫—Ä–æ–∫ [`load_var` step](https://concourse-ci.org/load-var-step.html) –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –≤ [local var](https://concourse-ci.org/vars.html#local-vars)
* –∫—Ä–æ–∫ [`in_parallel` step](https://concourse-ci.org/in-parallel-step.html) –≤–∏–∫–æ–Ω—É—î –∫—Ä–æ–∫–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ
* –∫—Ä–æ–∫ [`do` step](https://concourse-ci.org/do-step.html) –≤–∏–∫–æ–Ω—É—î –∫—Ä–æ–∫–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ
* –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫—Ä–æ–∫—É [`across` step](https://concourse-ci.org/across-step.html#schema.across) –≤–∏–∫–æ–Ω—É—î –∫—Ä–æ–∫ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤; –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –∫–æ–∂–Ω–æ—ó –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –∑–Ω–∞—á–µ–Ω—å –∑–º—ñ–Ω–Ω–∏—Ö
* –∫—Ä–æ–∫ [`try` step](https://concourse-ci.org/try-step.html) –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫—Ä–æ–∫ —ñ –≤–≤–∞–∂–∞—î—Ç—å—Å—è —É—Å–ø—ñ—à–Ω–∏–º, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∫—Ä–æ–∫ –Ω–µ –≤–¥–∞—î—Ç—å—Å—è

–ö–æ–∂–µ–Ω [step](https://concourse-ci.org/steps.html) —É [job plan](https://concourse-ci.org/jobs.html#schema.job.plan) –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —É **—Å–≤–æ—î–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ**. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –≤—Å–µ, —â–æ —Ö–æ—á–µ—Ç–µ, –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ _(—Ç–æ–±—Ç–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –º–æ—ó —Ç–µ—Å—Ç–∏, –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ü–µ–π bash-—Å–∫—Ä–∏–ø—Ç, –∑—ñ–±—Ä–∞—Ç–∏ —Ü–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–æ—â–æ)_. –¢–æ–º—É, —è–∫—â–æ —É –≤–∞—Å —î job –∑ –ø'—è—Ç—å–º–∞ –∫—Ä–æ–∫–∞–º–∏, Concourse —Å—Ç–≤–æ—Ä–∏—Ç—å –ø'—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤, –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É.

–û—Ç–∂–µ, –º–æ–∂–ª–∏–≤–æ –≤–∫–∞–∑–∞—Ç–∏ —Ç–∏–ø –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –≤ —è–∫–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–∂–µ–Ω –∫—Ä–æ–∫.

### –ü—Ä–æ—Å—Ç–∏–π –ø—Ä–∏–∫–ª–∞–¥ Pipeline
```yaml
jobs:
- name: simple
plan:
- task: simple-task
privileged: true
config:
# Tells Concourse which type of worker this task should run on
platform: linux
image_resource:
type: registry-image
source:
repository: busybox # images are pulled from docker hub by default
run:
path: sh
args:
- -cx
- |
sleep 1000
echo "$SUPER_SECRET"
params:
SUPER_SECRET: ((super.secret))
```

```bash
fly -t tutorial set-pipeline -p pipe-name -c hello-world.yml
# pipelines are paused when first created
fly -t tutorial unpause-pipeline -p pipe-name
# trigger the job and watch it run to completion
fly -t tutorial trigger-job --job pipe-name/simple --watch
# From another console
fly -t tutorial intercept --job pipe-name/simple
```
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ **127.0.0.1:8080**, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –ø–æ—Ç—ñ–∫ –∫–æ–Ω–≤–µ—î—Ä–∞.

### Bash —Å–∫—Ä–∏–ø—Ç –∑ –≤–∏—Ö—ñ–¥–Ω–∏–º/–≤—Ö—ñ–¥–Ω–∏–º –∫–æ–Ω–≤–µ—î—Ä–æ–º

–ú–æ–∂–ª–∏–≤–æ **–∑–±–µ—Ä–µ–≥—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –æ–¥–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è —É —Ñ–∞–π–ª** —ñ –≤–∫–∞–∑–∞—Ç–∏, —â–æ —Ü–µ –≤–∏—Ö—ñ–¥, –∞ –ø–æ—Ç—ñ–º –≤–∫–∞–∑–∞—Ç–∏ –≤—Ö—ñ–¥ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è —è–∫ –≤–∏—Ö—ñ–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è. –©–æ —Ä–æ–±–∏—Ç—å concourse, —Ç–∞–∫ —Ü–µ **–º–æ–Ω—Ç—É—î –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ –Ω–æ–≤–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ, –¥–µ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—ñ–≤, —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –∑–∞–≤–¥–∞–Ω–Ω—è–º**.

### –¢—Ä–∏–≥–µ—Ä–∏

–í–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Ä—É—á–Ω—É –∑–∞–ø—É—Å–∫–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —ó—Ö –≤–∏–∫–æ–Ω–∞—Ç–∏, –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞—Ç–∏ —ó—Ö –Ω–∞ –∑–∞–ø—É—Å–∫ —â–æ—Ä–∞–∑—É:

* –ü—Ä–æ–π—à–æ–≤ –¥–µ—è–∫–∏–π —á–∞—Å: [Time resource](https://github.com/concourse/time-resource/)
* –ü—Ä–∏ –Ω–æ–≤–∏—Ö –∫–æ–º—ñ—Ç–∞—Ö –¥–æ –æ—Å–Ω–æ–≤–Ω–æ—ó –≥—ñ–ª–∫–∏: [Git resource](https://github.com/concourse/git-resource)
* –ù–æ–≤—ñ PR: [Github-PR resource](https://github.com/telia-oss/github-pr-resource)
* –û—Ç—Ä–∏–º–∞—Ç–∏ –∞–±–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –æ–±—Ä–∞–∑ –≤–∞—à–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É: [Registry-image resource](https://github.com/concourse/registry-image-resource/)

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∏–∫–ª–∞–¥ YAML –∫–æ–Ω–≤–µ—î—Ä–∞, —è–∫–∏–π —Å–ø—Ä–∞—Ü—å–æ–≤—É—î –Ω–∞ –Ω–æ–≤—ñ –∫–æ–º—ñ—Ç–∏ –≤ master –Ω–∞ [https://concourse-ci.org/tutorial-resources.html](https://concourse-ci.org/tutorial-resources.html)

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1) (1).png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
