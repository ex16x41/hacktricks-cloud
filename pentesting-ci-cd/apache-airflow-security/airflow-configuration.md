# Airflow Configuration

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Configuration File

**Apache Airflow** рд╕рднреА рдПрдпрд░рдлреНрд▓реЛ рдорд╢реАрдиреЛрдВ рдореЗрдВ рдПрдХ **config file** рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ **`airflow.cfg`** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдпрд░рдлреНрд▓реЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╣реЛрдо рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ config file рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИ рдФрд░ **рджрд┐рд▓рдЪрд╕реНрдк рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред**

**рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ: рдХрд┐рд╕реА рдПрдпрд░рдлреНрд▓реЛ рдорд╢реАрди рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░рдХреЗ, рдпрд╛ рд╡реЗрдм рдХрдВрд╕реЛрд▓ рддрдХ рдкрд╣реБрдБрдЪрдХрд░ред**

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **config file рдХреЗ рдЕрдВрджрд░ рдХреЗ рдорд╛рди** **рд╡реЗ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ** рдЬреЛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'` рдЬреИрд╕реЗ env рд╡реЗрд░рд┐рдПрдмрд▓ рд╕реЗрдЯ рдХрд░рдХреЗ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╡реЗрдм рд╕рд░реНрд╡рд░ рдореЗрдВ config file рддрдХ рдкрд╣реБрдБрдЪ рд╣реИ**, рддреЛ рдЖрдк рдЙрд╕реА рдкреГрд╖реНрда рдкрд░ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЪрд▓ рд░рд╣реА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд╣рд╛рдБ config рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИред\
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдПрдпрд░рдлреНрд▓реЛ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рдЕрдВрджрд░ рдХрд┐рд╕реА рдорд╢реАрди рддрдХ рдкрд╣реБрдБрдЪ рд╣реИ**, рддреЛ **рдкрд░реНрдпрд╛рд╡рд░рдг** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

config file рдкрдврд╝рддреЗ рд╕рдордп рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдорд╛рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

### \[api]

* **`access_control_allow_headers`**: рдпрд╣ **CORS** рдХреЗ рд▓рд┐рдП **рдЕрдиреБрдордд** **рд╣реЗрдбрд░** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ
* **`access_control_allow_methods`**: рдпрд╣ **CORS** рдХреЗ рд▓рд┐рдП **рдЕрдиреБрдордд рд╡рд┐рдзрд┐рдпреЛрдВ** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ
* **`access_control_allow_origins`**: рдпрд╣ **CORS** рдХреЗ рд▓рд┐рдП **рдЕрдиреБрдордд рдореВрд▓** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ
* **`auth_backend`**: [**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html) рдХреБрдЫ рд╡рд┐рдХрд▓реНрдк рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди API рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддрд╛ рд╣реИ:
* `airflow.api.auth.backend.deny_all`: **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреЛрдИ рднреА** API рддрдХ рдкрд╣реБрдБрдЪ рдирд╣реАрдВ рд╕рдХрддрд╛
* `airflow.api.auth.backend.default`: **рд╕рднреА** рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* `airflow.api.auth.backend.kerberos_auth`: **рдХреЗрд░реНрдмреЗрд░реЛрд╕ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП
* `airflow.api.auth.backend.basic_auth`: **рдмреБрдирд┐рдпрд╛рджреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЗ рд▓рд┐рдП
* `airflow.composer.api.backend.composer_auth`: рдХрдВрдкреЛрдЬрд╝рд░реНрд╕ рдкреНрд░рдорд╛рдгреАрдХрд░рдг (GCP) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ ( [**рдпрд╣рд╛рдБ рд╕реЗ**](https://cloud.google.com/composer/docs/access-airflow-api) )ред
* `composer_auth_user_registration_role`: рдпрд╣ **рднреВрдорд┐рдХрд╛** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рдХрдВрдкреЛрдЬрд╝рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЛ **рдПрдпрд░рдлреНрд▓реЛ** рдХреЗ рдЕрдВрджрд░ рдорд┐рд▓реЗрдЧреА (**Op** рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ)ред
* рдЖрдк **рдкрд╛рдпрдерди** рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдзрд┐ рднреА **рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред
* **`google_key_path`:** **GCP рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдХреБрдВрдЬреА** рдХрд╛ рдкрде

### **\[atlas]**

* **`password`**: рдПрдЯрд▓рд╕ рдкрд╛рд╕рд╡рд░реНрдб
* **`username`**: рдПрдЯрд▓рд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо

### \[celery]

* **`flower_basic_auth`** : рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ (_user1:password1,user2:password2_)
* **`result_backend`**: рдкреЛрд╕реНрдЯрдЧреНрд░реЗрд╕ рдпреВрдЖрд░рдПрд▓ рдЬрд┐рд╕рдореЗрдВ **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
* **`ssl_cacert`**: cacert рдХрд╛ рдкрде
* **`ssl_cert`**: рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдкрде
* **`ssl_key`**: рдХреБрдВрдЬреА рдХрд╛ рдкрде

### \[core]

* **`dag_discovery_safe_mode`**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдоред DAGs рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╕рдордп, рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ `DAG` рдФрд░ `airflow` рд╢рдмреНрдж рдирд╣реАрдВ рд╣реИрдВред
* **`fernet_key`**: рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдВрдЬреА (рд╕рдВрдкреВрд░реНрдг)
* **`hide_sensitive_var_conn_fields`**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо, рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЫрд┐рдкрд╛рдПрдБред
* **`security`**: рдХрд┐рд╕ рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдХреЗрд░реНрдмреЗрд░реЛрд╕)

### \[dask]

* **`tls_ca`**: ca рдХрд╛ рдкрде
* **`tls_cert`**: рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рднрд╛рдЧ
* **`tls_key`**: tls рдХреБрдВрдЬреА рдХрд╛ рднрд╛рдЧ

### \[kerberos]

* **`ccache`**: ccache рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде
* **`forwardable`**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо

### \[logging]

* **`google_key_path`**: GCP JSON рдХреНрд░реЗрдбреНрд╕ рдХрд╛ рдкрдеред

### \[secrets]

* **`backend`**: рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░рд╣рд╕реНрдпреЛрдВ рдХреЗ рдмреИрдХрдПрдВрдб рдХрд╛ рдкреВрд░рд╛ рд╡рд░реНрдЧ рдирд╛рдо
* **`backend_kwargs`**: backend_kwargs рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд░рд╣рд╕реНрдпреЛрдВ рдХреЗ рдмреИрдХрдПрдВрдб рд╡рд░реНрдЧ рдХреЗ **init** рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### \[smtp]

* **`smtp_password`**: SMTP рдкрд╛рд╕рд╡рд░реНрдб
* **`smtp_user`**: SMTP рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛

### \[webserver]

* **`cookie_samesite`**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ **Lax** рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдмрд╕реЗ рдХрдордЬреЛрд░ рд╕рдВрднрд╡ рдорд╛рди рд╣реИ
* **`cookie_secure`**: рд╕рддреНрд░ рдХреБрдХреА рдкрд░ **рд╕реБрд░рдХреНрд╖рд┐рдд рдзреНрд╡рдЬ** рд╕реЗрдЯ рдХрд░реЗрдВ
* **`expose_config`**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ False рд╣реИ, рдпрджрд┐ рд╕рддреНрдп рд╣реИ, рддреЛ **config** рдХреЛ рд╡реЗрдм **рдХрдВрд╕реЛрд▓** рд╕реЗ **рдкрдврд╝рд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ
* **`expose_stacktrace`**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рд╕рддреНрдп рд╣реИ, рдпрд╣ **рдкрд╛рдпрдерди рдЯреНрд░реЗрд╕рдмреИрдХ** рджрд┐рдЦрд╛рдПрдЧрд╛ (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА)
* **`secret_key`**: рдпрд╣ **рдХреБрдВрдЬреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдлреНрд▓рд╛рд╕реНрдХ рдХреБрдХреАрдЬрд╝ рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** (рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдпрд╣ рд╣реИ рддреЛ рдЖрдк **рдПрдпрд░рдлреНрд▓реЛ рдореЗрдВ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**)
* **`web_server_ssl_cert`**: **SSL** **рдкреНрд░рдорд╛рдгрдкрддреНрд░** рдХрд╛ **рдкрде**
* **`web_server_ssl_key`**: **SSL** **рдХреБрдВрдЬреА** рдХрд╛ **рдкрде**
* **`x_frame_enabled`**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ **рд╕рддреНрдп** рд╣реИ, рдЗрд╕рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ

### Web Authentication

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рд╡реЗрдм рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдлрд╝рд╛рдЗрд▓ **`webserver_config.py`** рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ
```bash
AUTH_TYPE = AUTH_DB
```
рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЦрд┐рд▓рд╛рдл рдЬрд╛рдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрднрд╡ рд╣реИрдВ рдЬреИрд╕реЗ
```bash
AUTH_TYPE = AUTH_OAUTH
```
**рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреА рд╕реЗрд╡рд╛рдУрдВ** рдХреЛ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдЫреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдПред

рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдЧреБрдордирд╛рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдПрдХреНрд╕реЗрд╕** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХрд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рднреА рд╣реИ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **рдЪрд╛рд╣реЗ рдЧрдП рднреВрдорд┐рдХрд╛** рдкрд░ рд╕реЗрдЯ рдХрд░рдирд╛:
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
