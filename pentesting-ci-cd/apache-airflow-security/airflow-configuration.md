# Airflow Configuration

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Configuration File

**Apache Airflow**ëŠ” **airflow ì‚¬ìš©ì**ì˜ í™ˆì— **`airflow.cfg`**ë¼ëŠ” **config file**ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ config fileì€ êµ¬ì„± ì •ë³´ë¥¼ í¬í•¨í•˜ë©° **í¥ë¯¸ë¡­ê³  ë¯¼ê°í•œ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

**ì´ íŒŒì¼ì— ì ‘ê·¼í•˜ëŠ” ë°©ë²•ì€ ë‘ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤: airflow ë¨¸ì‹ ì„ ì†ìƒì‹œí‚¤ê±°ë‚˜ ì›¹ ì½˜ì†”ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.**

**config fileì˜ ê°’**ì€ **ì‚¬ìš©ë˜ëŠ” ê°’ì´ ì•„ë‹ ìˆ˜ ìˆìŠµë‹ˆë‹¤**, í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ì—¬ ë®ì–´ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆ: `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'`.

**ì›¹ ì„œë²„ì˜ config fileì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤ë©´**, configê°€ í‘œì‹œë˜ëŠ” ë™ì¼í•œ í˜ì´ì§€ì—ì„œ **ì‹¤ì œ ì‹¤í–‰ êµ¬ì„±**ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
**airflow í™˜ê²½ ë‚´ì˜ ì–´ë–¤ ë¨¸ì‹ ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤ë©´**, **í™˜ê²½**ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤.

config fileì„ ì½ì„ ë•Œ í™•ì¸í•  ë§Œí•œ ëª‡ ê°€ì§€ í¥ë¯¸ë¡œìš´ ê°’:

### \[api]

* **`access_control_allow_headers`**: ì´ëŠ” **CORS**ì— ëŒ€í•œ **í—ˆìš©ëœ** **í—¤ë”**ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
* **`access_control_allow_methods`**: ì´ëŠ” **CORS**ì— ëŒ€í•œ **í—ˆìš©ëœ ë©”ì„œë“œ**ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
* **`access_control_allow_origins`**: ì´ëŠ” **CORS**ì— ëŒ€í•œ **í—ˆìš©ëœ ì¶œì²˜**ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
* **`auth_backend`**: [**ë¬¸ì„œì— ë”°ë¥´ë©´**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html) APIì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì„ êµ¬ì„±í•˜ê¸° ìœ„í•œ ëª‡ ê°€ì§€ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤:
* `airflow.api.auth.backend.deny_all`: **ê¸°ë³¸ì ìœ¼ë¡œ ì•„ë¬´ë„** APIì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
* `airflow.api.auth.backend.default`: **ëª¨ë‘ê°€** ì¸ì¦ ì—†ì´ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* `airflow.api.auth.backend.kerberos_auth`: **kerberos ì¸ì¦**ì„ êµ¬ì„±í•©ë‹ˆë‹¤.
* `airflow.api.auth.backend.basic_auth`: **ê¸°ë³¸ ì¸ì¦**ì„ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.
* `airflow.composer.api.backend.composer_auth`: ì‘ê³¡ê°€ ì¸ì¦(GCP)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤ (ì—¬ê¸°ì„œ [**ë”ë³´ê¸°**](https://cloud.google.com/composer/docs/access-airflow-api)).
* `composer_auth_user_registration_role`: ì´ëŠ” **airflow** ë‚´ì—ì„œ **ì‘ê³¡ê°€ ì‚¬ìš©ì**ê°€ ê°€ì§ˆ **ì—­í• **ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤ (**Op**ê°€ ê¸°ë³¸ê°’ì…ë‹ˆë‹¤).
* ë˜í•œ **ìì‹ ë§Œì˜ ì¸ì¦** ë°©ë²•ì„ íŒŒì´ì¬ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **`google_key_path`:** GCP ì„œë¹„ìŠ¤ ê³„ì • í‚¤ì˜ ê²½ë¡œì…ë‹ˆë‹¤.

### **\[atlas]**

* **`password`**: ì•„í‹€ë¼ìŠ¤ ë¹„ë°€ë²ˆí˜¸
* **`username`**: ì•„í‹€ë¼ìŠ¤ ì‚¬ìš©ì ì´ë¦„

### \[celery]

* **`flower_basic_auth`** : ìê²© ì¦ëª… (_user1:password1,user2:password2_)
* **`result_backend`**: **ìê²© ì¦ëª…**ì´ í¬í•¨ë  ìˆ˜ ìˆëŠ” Postgres URLì…ë‹ˆë‹¤.
* **`ssl_cacert`**: cacertì˜ ê²½ë¡œì…ë‹ˆë‹¤.
* **`ssl_cert`**: ì¸ì¦ì„œì˜ ê²½ë¡œì…ë‹ˆë‹¤.
* **`ssl_key`**: í‚¤ì˜ ê²½ë¡œì…ë‹ˆë‹¤.

### \[core]

* **`dag_discovery_safe_mode`**: ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. DAGë¥¼ ë°œê²¬í•  ë•Œ `DAG` ë° `airflow` ë¬¸ìì—´ì´ í¬í•¨ë˜ì§€ ì•Šì€ íŒŒì¼ì€ ë¬´ì‹œí•©ë‹ˆë‹¤.
* **`fernet_key`**: ì•”í˜¸í™”ëœ ë³€ìˆ˜ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ í‚¤(ëŒ€ì¹­).
* **`hide_sensitive_var_conn_fields`**: ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©°, ì—°ê²°ì˜ ë¯¼ê°í•œ ì •ë³´ë¥¼ ìˆ¨ê¹ë‹ˆë‹¤.
* **`security`**: ì‚¬ìš©í•  ë³´ì•ˆ ëª¨ë“ˆ(ì˜ˆ: kerberos).

### \[dask]

* **`tls_ca`**: caì˜ ê²½ë¡œì…ë‹ˆë‹¤.
* **`tls_cert`**: ì¸ì¦ì„œì˜ ê²½ë¡œì…ë‹ˆë‹¤.
* **`tls_key`**: tls í‚¤ì˜ ê²½ë¡œì…ë‹ˆë‹¤.

### \[kerberos]

* **`ccache`**: ccache íŒŒì¼ì˜ ê²½ë¡œì…ë‹ˆë‹¤.
* **`forwardable`**: ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### \[logging]

* **`google_key_path`**: GCP JSON ìê²© ì¦ëª…ì˜ ê²½ë¡œì…ë‹ˆë‹¤.

### \[secrets]

* **`backend`**: í™œì„±í™”í•  ë¹„ë°€ ë°±ì—”ë“œì˜ ì „ì²´ í´ë˜ìŠ¤ ì´ë¦„ì…ë‹ˆë‹¤.
* **`backend_kwargs`**: backend\_kwargs ë§¤ê°œë³€ìˆ˜ëŠ” ì‚¬ì „ìœ¼ë¡œ ë¡œë“œë˜ì–´ ë¹„ë°€ ë°±ì—”ë“œ í´ë˜ìŠ¤ì˜ **init**ì— ì „ë‹¬ë©ë‹ˆë‹¤.

### \[smtp]

* **`smtp_password`**: SMTP ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.
* **`smtp_user`**: SMTP ì‚¬ìš©ìì…ë‹ˆë‹¤.

### \[webserver]

* **`cookie_samesite`**: ê¸°ë³¸ì ìœ¼ë¡œ **Lax**ì´ë©°, ë”°ë¼ì„œ ì´ë¯¸ ê°€ëŠ¥í•œ ê°€ì¥ ì•½í•œ ê°’ì…ë‹ˆë‹¤.
* **`cookie_secure`**: ì„¸ì…˜ ì¿ í‚¤ì— **ë³´ì•ˆ í”Œë˜ê·¸**ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
* **`expose_config`**: ê¸°ë³¸ê°’ì€ Falseì´ë©°, trueì¼ ê²½ìš° **config**ë¥¼ ì›¹ **ì½˜ì†”**ì—ì„œ **ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤**.
* **`expose_stacktrace`**: ê¸°ë³¸ê°’ì€ Trueì´ë©°, **íŒŒì´ì¬ ì¶”ì **ì„ í‘œì‹œí•©ë‹ˆë‹¤(ê³µê²©ìì—ê²Œ ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).
* **`secret_key`**: ì´ëŠ” ì¿ í‚¤ì— ì„œëª…í•˜ê¸° ìœ„í•´ flaskê°€ ì‚¬ìš©í•˜ëŠ” **í‚¤**ì…ë‹ˆë‹¤(ì´ í‚¤ê°€ ìˆìœ¼ë©´ **Airflowì˜ ëª¨ë“  ì‚¬ìš©ìë¥¼ ê°€ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**).
* **`web_server_ssl_cert`**: **SSL** **ì¸ì¦ì„œ**ì˜ **ê²½ë¡œ**ì…ë‹ˆë‹¤.
* **`web_server_ssl_key`**: **SSL** **í‚¤**ì˜ **ê²½ë¡œ**ì…ë‹ˆë‹¤.
* **`x_frame_enabled`**: ê¸°ë³¸ê°’ì€ **True**ì´ë©°, ë”°ë¼ì„œ ê¸°ë³¸ì ìœ¼ë¡œ í´ë¦­ì¬í‚¹ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

### Web Authentication

ê¸°ë³¸ì ìœ¼ë¡œ **ì›¹ ì¸ì¦**ì€ **`webserver_config.py`** íŒŒì¼ì— ì§€ì •ë˜ì–´ ìˆìœ¼ë©° ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë©ë‹ˆë‹¤.
```bash
AUTH_TYPE = AUTH_DB
```
ì¦‰, **ì¸ì¦ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•´ í™•ì¸ë©ë‹ˆë‹¤**. ê·¸ëŸ¬ë‚˜ ë‹¤ë¥¸ êµ¬ì„±ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.
```bash
AUTH_TYPE = AUTH_OAUTH
```
**ì œ3ì ì„œë¹„ìŠ¤ì— ì¸ì¦ì„ ë§¡ê¸°ê¸° ìœ„í•´.**

ê·¸ëŸ¬ë‚˜ **ìµëª… ì‚¬ìš©ì ì ‘ê·¼ì„ í—ˆìš©í•˜ëŠ”** ì˜µì…˜ë„ ìˆìœ¼ë©°, ë‹¤ìŒ ë§¤ê°œë³€ìˆ˜ë¥¼ **ì›í•˜ëŠ” ì—­í• **ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
