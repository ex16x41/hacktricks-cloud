# Airflow Configuration

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Configuration File

**Apache Airflow**, airflow kullanıcısının ana dizininde **`airflow.cfg`** adında bir **config dosyası** oluşturur. Bu config dosyası yapılandırma bilgilerini içerir ve **ilginç ve hassas bilgiler içerebilir.**

**Bu dosyaya erişmenin iki yolu vardır: bazı airflow makinelerini ele geçirerek veya web konsoluna erişerek.**

**Config dosyasındaki değerlerin** **kullanılanlar olmayabileceğini** unutmayın, çünkü `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'` gibi ortam değişkenleri ayarlayarak bunları geçersiz kılabilirsiniz.

**Web sunucusundaki config dosyasına erişiminiz varsa**, config'in görüntülendiği aynı sayfada **gerçek çalışan yapılandırmayı** kontrol edebilirsiniz.\
**Airflow ortamındaki bazı makinelere erişiminiz varsa**, **ortamı** kontrol edin.

Config dosyasını okurken kontrol edilecek bazı ilginç değerler:

### \[api]

* **`access_control_allow_headers`**: Bu, **CORS** için **izin verilen** **başlıkları** gösterir.
* **`access_control_allow_methods`**: Bu, **CORS** için **izin verilen yöntemleri** gösterir.
* **`access_control_allow_origins`**: Bu, **CORS** için **izin verilen kökenleri** gösterir.
* **`auth_backend`**: [**Belgelerde belirtildiği gibi**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html) API'ye kimlerin erişebileceğini yapılandırmak için birkaç seçenek olabilir:
* `airflow.api.auth.backend.deny_all`: **Varsayılan olarak kimse** API'ye erişemez.
* `airflow.api.auth.backend.default`: **Herkes** kimlik doğrulaması olmadan erişebilir.
* `airflow.api.auth.backend.kerberos_auth`: **Kerberos kimlik doğrulamasını** yapılandırmak için.
* `airflow.api.auth.backend.basic_auth`: **Temel kimlik doğrulaması** için.
* `airflow.composer.api.backend.composer_auth`: Bestecilerin kimlik doğrulamasını kullanır (GCP) ( [**buradan**](https://cloud.google.com/composer/docs/access-airflow-api)).
* `composer_auth_user_registration_role`: Bu, **besteci kullanıcısının** **airflow** içindeki **rolünü** gösterir (**Op** varsayılan olarak).
* Ayrıca **kendi kimlik doğrulama** yöntemlerinizi Python ile oluşturabilirsiniz.
* **`google_key_path`:** **GCP hizmet hesabı anahtarının** yolu.

### **\[atlas]**

* **`password`**: Atlas şifresi.
* **`username`**: Atlas kullanıcı adı.

### \[celery]

* **`flower_basic_auth`** : Kimlik bilgileri (_user1:password1,user2:password2_)
* **`result_backend`**: **Kimlik bilgilerini** içerebilecek Postgres URL'si.
* **`ssl_cacert`**: cacert'in yolu.
* **`ssl_cert`**: sertifikanın yolu.
* **`ssl_key`**: anahtarın yolu.

### \[core]

* **`dag_discovery_safe_mode`**: Varsayılan olarak etkin. DAG'leri keşfederken, `DAG` ve `airflow` dizelerini içermeyen dosyaları yoksayın.
* **`fernet_key`**: Şifrelenmiş değişkenleri saklamak için anahtar (simetrik).
* **`hide_sensitive_var_conn_fields`**: Varsayılan olarak etkin, bağlantıların hassas bilgilerini gizler.
* **`security`**: Hangi güvenlik modülünün kullanılacağı (örneğin kerberos).

### \[dask]

* **`tls_ca`**: ca'nın yolu.
* **`tls_cert`**: sertifikanın yolu.
* **`tls_key`**: tls anahtarının yolu.

### \[kerberos]

* **`ccache`**: ccache dosyasının yolu.
* **`forwardable`**: Varsayılan olarak etkin.

### \[logging]

* **`google_key_path`**: GCP JSON kimlik bilgilerine giden yol.

### \[secrets]

* **`backend`**: Etkinleştirilecek gizli arka uç sınıfının tam adı.
* **`backend_kwargs`**: backend\_kwargs parametresi bir sözlüğe yüklenir ve gizli arka uç sınıfının **init**'ine geçirilir.

### \[smtp]

* **`smtp_password`**: SMTP şifresi.
* **`smtp_user`**: SMTP kullanıcısı.

### \[webserver]

* **`cookie_samesite`**: Varsayılan olarak **Lax**'dır, bu nedenle zaten mümkün olan en zayıf değerdir.
* **`cookie_secure`**: oturum çerezi üzerinde **güvenli bayrağı** ayarlayın.
* **`expose_config`**: Varsayılan olarak False'dur, eğer true ise, **config** web **konsolundan** **okunabilir**.
* **`expose_stacktrace`**: Varsayılan olarak True'dur, **python traceback'lerini** gösterecektir (bir saldırgan için potansiyel olarak yararlı).
* **`secret_key`**: Bu, çerezleri imzalamak için flask tarafından kullanılan **anahtardır** (buna sahipseniz, **Airflow'daki herhangi bir kullanıcıyı taklit edebilirsiniz**).
* **`web_server_ssl_cert`**: **SSL** **sertifikasının** **yolu**.
* **`web_server_ssl_key`**: **SSL** **Anahtarının** **yolu**.
* **`x_frame_enabled`**: Varsayılan **True**'dur, bu nedenle varsayılan olarak clickjacking mümkün değildir.

### Web Authentication

Varsayılan olarak **web authentication**, **`webserver_config.py`** dosyasında belirtilmiştir ve şu şekilde yapılandırılmıştır:
```bash
AUTH_TYPE = AUTH_DB
```
Bu, **kimlik doğrulamanın veritabanına karşı kontrol edildiği** anlamına gelir. Ancak, diğer yapılandırmalar da mümkündür, örneğin
```bash
AUTH_TYPE = AUTH_OAUTH
```
**Üçüncü taraf hizmetlere** **kimlik doğrulamasını** bırakmak için.

Ancak, **anonim kullanıcıların erişimine** izin vermek için de bir seçenek vardır, aşağıdaki parametreyi **istenen role** ayarlayarak:
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
