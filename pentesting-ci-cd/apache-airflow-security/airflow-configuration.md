# Airflow Configuration

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Configuration File

**Apache Airflow**, airflow kullanÄ±cÄ±sÄ±nÄ±n ana dizininde **`airflow.cfg`** adÄ±nda bir **config dosyasÄ±** oluÅŸturur. Bu config dosyasÄ± yapÄ±landÄ±rma bilgilerini iÃ§erir ve **ilginÃ§ ve hassas bilgiler iÃ§erebilir.**

**Bu dosyaya eriÅŸmenin iki yolu vardÄ±r: bazÄ± airflow makinelerini ele geÃ§irerek veya web konsoluna eriÅŸerek.**

**Config dosyasÄ±ndaki deÄŸerlerin** **kullanÄ±lanlar olmayabileceÄŸini** unutmayÄ±n, Ã§Ã¼nkÃ¼ `AIRFLOW__WEBSERVER__EXPOSE_CONFIG: 'true'` gibi ortam deÄŸiÅŸkenleri ayarlayarak bunlarÄ± geÃ§ersiz kÄ±labilirsiniz.

**Web sunucusundaki config dosyasÄ±na eriÅŸiminiz varsa**, config'in gÃ¶rÃ¼ntÃ¼lendiÄŸi aynÄ± sayfada **gerÃ§ek Ã§alÄ±ÅŸan yapÄ±landÄ±rmayÄ±** kontrol edebilirsiniz.\
**Airflow ortamÄ±ndaki bazÄ± makinelere eriÅŸiminiz varsa**, **ortamÄ±** kontrol edin.

Config dosyasÄ±nÄ± okurken kontrol edilecek bazÄ± ilginÃ§ deÄŸerler:

### \[api]

* **`access_control_allow_headers`**: Bu, **CORS** iÃ§in **izin verilen** **baÅŸlÄ±klarÄ±** gÃ¶sterir.
* **`access_control_allow_methods`**: Bu, **CORS** iÃ§in **izin verilen yÃ¶ntemleri** gÃ¶sterir.
* **`access_control_allow_origins`**: Bu, **CORS** iÃ§in **izin verilen kÃ¶kenleri** gÃ¶sterir.
* **`auth_backend`**: [**Belgelerde belirtildiÄŸi gibi**](https://airflow.apache.org/docs/apache-airflow/stable/security/api.html) API'ye kimlerin eriÅŸebileceÄŸini yapÄ±landÄ±rmak iÃ§in birkaÃ§ seÃ§enek olabilir:
* `airflow.api.auth.backend.deny_all`: **VarsayÄ±lan olarak kimse** API'ye eriÅŸemez.
* `airflow.api.auth.backend.default`: **Herkes** kimlik doÄŸrulamasÄ± olmadan eriÅŸebilir.
* `airflow.api.auth.backend.kerberos_auth`: **Kerberos kimlik doÄŸrulamasÄ±nÄ±** yapÄ±landÄ±rmak iÃ§in.
* `airflow.api.auth.backend.basic_auth`: **Temel kimlik doÄŸrulamasÄ±** iÃ§in.
* `airflow.composer.api.backend.composer_auth`: Bestecilerin kimlik doÄŸrulamasÄ±nÄ± kullanÄ±r (GCP) ( [**buradan**](https://cloud.google.com/composer/docs/access-airflow-api)).
* `composer_auth_user_registration_role`: Bu, **besteci kullanÄ±cÄ±sÄ±nÄ±n** **airflow** iÃ§indeki **rolÃ¼nÃ¼** gÃ¶sterir (**Op** varsayÄ±lan olarak).
* AyrÄ±ca **kendi kimlik doÄŸrulama** yÃ¶ntemlerinizi Python ile oluÅŸturabilirsiniz.
* **`google_key_path`:** **GCP hizmet hesabÄ± anahtarÄ±nÄ±n** yolu.

### **\[atlas]**

* **`password`**: Atlas ÅŸifresi.
* **`username`**: Atlas kullanÄ±cÄ± adÄ±.

### \[celery]

* **`flower_basic_auth`** : Kimlik bilgileri (_user1:password1,user2:password2_)
* **`result_backend`**: **Kimlik bilgilerini** iÃ§erebilecek Postgres URL'si.
* **`ssl_cacert`**: cacert'in yolu.
* **`ssl_cert`**: sertifikanÄ±n yolu.
* **`ssl_key`**: anahtarÄ±n yolu.

### \[core]

* **`dag_discovery_safe_mode`**: VarsayÄ±lan olarak etkin. DAG'leri keÅŸfederken, `DAG` ve `airflow` dizelerini iÃ§ermeyen dosyalarÄ± yoksayÄ±n.
* **`fernet_key`**: ÅifrelenmiÅŸ deÄŸiÅŸkenleri saklamak iÃ§in anahtar (simetrik).
* **`hide_sensitive_var_conn_fields`**: VarsayÄ±lan olarak etkin, baÄŸlantÄ±larÄ±n hassas bilgilerini gizler.
* **`security`**: Hangi gÃ¼venlik modÃ¼lÃ¼nÃ¼n kullanÄ±lacaÄŸÄ± (Ã¶rneÄŸin kerberos).

### \[dask]

* **`tls_ca`**: ca'nÄ±n yolu.
* **`tls_cert`**: sertifikanÄ±n yolu.
* **`tls_key`**: tls anahtarÄ±nÄ±n yolu.

### \[kerberos]

* **`ccache`**: ccache dosyasÄ±nÄ±n yolu.
* **`forwardable`**: VarsayÄ±lan olarak etkin.

### \[logging]

* **`google_key_path`**: GCP JSON kimlik bilgilerine giden yol.

### \[secrets]

* **`backend`**: EtkinleÅŸtirilecek gizli arka uÃ§ sÄ±nÄ±fÄ±nÄ±n tam adÄ±.
* **`backend_kwargs`**: backend\_kwargs parametresi bir sÃ¶zlÃ¼ÄŸe yÃ¼klenir ve gizli arka uÃ§ sÄ±nÄ±fÄ±nÄ±n **init**'ine geÃ§irilir.

### \[smtp]

* **`smtp_password`**: SMTP ÅŸifresi.
* **`smtp_user`**: SMTP kullanÄ±cÄ±sÄ±.

### \[webserver]

* **`cookie_samesite`**: VarsayÄ±lan olarak **Lax**'dÄ±r, bu nedenle zaten mÃ¼mkÃ¼n olan en zayÄ±f deÄŸerdir.
* **`cookie_secure`**: oturum Ã§erezi Ã¼zerinde **gÃ¼venli bayraÄŸÄ±** ayarlayÄ±n.
* **`expose_config`**: VarsayÄ±lan olarak False'dur, eÄŸer true ise, **config** web **konsolundan** **okunabilir**.
* **`expose_stacktrace`**: VarsayÄ±lan olarak True'dur, **python traceback'lerini** gÃ¶sterecektir (bir saldÄ±rgan iÃ§in potansiyel olarak yararlÄ±).
* **`secret_key`**: Bu, Ã§erezleri imzalamak iÃ§in flask tarafÄ±ndan kullanÄ±lan **anahtardÄ±r** (buna sahipseniz, **Airflow'daki herhangi bir kullanÄ±cÄ±yÄ± taklit edebilirsiniz**).
* **`web_server_ssl_cert`**: **SSL** **sertifikasÄ±nÄ±n** **yolu**.
* **`web_server_ssl_key`**: **SSL** **AnahtarÄ±nÄ±n** **yolu**.
* **`x_frame_enabled`**: VarsayÄ±lan **True**'dur, bu nedenle varsayÄ±lan olarak clickjacking mÃ¼mkÃ¼n deÄŸildir.

### Web Authentication

VarsayÄ±lan olarak **web authentication**, **`webserver_config.py`** dosyasÄ±nda belirtilmiÅŸtir ve ÅŸu ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r:
```bash
AUTH_TYPE = AUTH_DB
```
Bu, **kimlik doÄŸrulamanÄ±n veritabanÄ±na karÅŸÄ± kontrol edildiÄŸi** anlamÄ±na gelir. Ancak, diÄŸer yapÄ±landÄ±rmalar da mÃ¼mkÃ¼ndÃ¼r, Ã¶rneÄŸin
```bash
AUTH_TYPE = AUTH_OAUTH
```
**ÃœÃ§Ã¼ncÃ¼ taraf hizmetlere** **kimlik doÄŸrulamasÄ±nÄ±** bÄ±rakmak iÃ§in.

Ancak, **anonim kullanÄ±cÄ±larÄ±n eriÅŸimine** izin vermek iÃ§in de bir seÃ§enek vardÄ±r, aÅŸaÄŸÄ±daki parametreyi **istenen role** ayarlayarak:
```bash
AUTH_ROLE_PUBLIC = 'Admin'
```
{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
