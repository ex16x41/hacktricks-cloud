# TravisCI Security

{% hint style="success" %}
Ucz si i wicz Hacking AWS:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Ucz si i wicz Hacking GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si sztuczkami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
{% endhint %}

## Czym jest TravisCI

**Travis CI** to **hostowana** lub na **lokalnych** serwerach usuga **cigej integracji** u偶ywana do budowania i testowania projekt贸w oprogramowania hostowanych na kilku **r贸偶nych platformach git**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Ataki

### Wyzwalacze

Aby przeprowadzi atak, najpierw musisz wiedzie, jak wyzwoli budow. Domylnie TravisCI **wyzwala budow przy pushach i pull requestach**:

![](<../../.gitbook/assets/image (145).png>)

#### Zadania Cron

Jeli masz dostp do aplikacji internetowej, mo偶esz **ustawi zadania cron do uruchamiania budowy**, co mo偶e by przydatne do utrzymania lub wyzwolenia budowy:

![](<../../.gitbook/assets/image (243).png>)

{% hint style="info" %}
Wyglda na to, 偶e nie mo偶na ustawi zada cron w pliku `.travis.yml` zgodnie z [tym](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### PR zewntrznych podmiot贸w

TravisCI domylnie wycza udostpnianie zmiennych rodowiskowych z PR-贸w pochodzcych od zewntrznych podmiot贸w, ale kto mo偶e to wczy, a wtedy mo偶esz stworzy PR-y do repozytorium i wyeksfiltrowa sekrety:

![](<../../.gitbook/assets/image (208).png>)

### Zrzucanie sekret贸w

Jak wyjaniono na stronie [**podstawowe informacje**](basic-travisci-information.md), istniej 2 typy sekret贸w. **Sekrety zmiennych rodowiskowych** (kt贸re s wymienione na stronie internetowej) oraz **niestandardowe zaszyfrowane sekrety**, kt贸re s przechowywane w pliku `.travis.yml` jako base64 (zauwa偶, 偶e oba, jako przechowywane zaszyfrowane, bd koczy jako zmienne rodowiskowe na kocowych maszynach).

* Aby **wyliczy sekrety** skonfigurowane jako **zmienne rodowiskowe**, przejd藕 do **ustawie** projektu i sprawd藕 list. Zauwa偶 jednak, 偶e wszystkie zmienne rodowiskowe projektu ustawione tutaj pojawi si przy wyzwalaniu budowy.
* Aby wyliczy **niestandardowe zaszyfrowane sekrety**, najlepiej jest **sprawdzi plik `.travis.yml`**.
* Aby **wyliczy zaszyfrowane pliki**, mo偶esz sprawdzi, czy w repozytorium znajduj si **pliki `.enc`**, linie podobne do `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` w pliku konfiguracyjnym, lub **zaszyfrowane iv i klucze** w **zmiennych rodowiskowych**, takich jak:

![](<../../.gitbook/assets/image (81).png>)

### TODO:

* Przykad budowy z dziaajcym reverse shellem na Windows/Mac/Linux
* Przykad budowy wyciekajcej zmienn rodowiskow zakodowan w base64 w logach

### TravisCI Enterprise

Jeli atakujcy znajdzie si w rodowisku, kt贸re u偶ywa **TravisCI enterprise** (wicej informacji na ten temat w [**podstawowych informacjach**](basic-travisci-information.md#travisci-enterprise)), bdzie m贸g **wyzwala budowy w Workerze.** Oznacza to, 偶e atakujcy bdzie m贸g porusza si lateralnie do tego serwera, z kt贸rego m贸gby:

* uciec do hosta?
* skompromitowa kubernetes?
* skompromitowa inne maszyny dziaajce w tej samej sieci?
* skompromitowa nowe powiadczenia chmurowe?

## Referencje

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

{% hint style="success" %}
Ucz si i wicz Hacking AWS:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Ucz si i wicz Hacking GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* Sprawd藕 [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Docz do**  [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **led藕** nas na **Twitterze**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel si sztuczkami hackingowymi, przesyajc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori贸w github.

</details>
{% endhint %}
