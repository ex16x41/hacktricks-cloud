# TravisCI Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Τι είναι το TravisCI

**Travis CI** είναι μια **φιλοξενούμενη** ή σε **τοπικό** **υπηρεσία συνεχούς ολοκλήρωσης** που χρησιμοποιείται για την κατασκευή και δοκιμή λογισμικού έργων που φιλοξενούνται σε πολλές **διαφορετικές πλατφόρμες git**.

{% content-ref url="basic-travisci-information.md" %}
[basic-travisci-information.md](basic-travisci-information.md)
{% endcontent-ref %}

## Επιθέσεις

### Ενεργοποιήσεις

Για να ξεκινήσετε μια επίθεση, πρέπει πρώτα να γνωρίζετε πώς να ενεργοποιήσετε μια κατασκευή. Από προεπιλογή, το TravisCI θα **ενεργοποιήσει μια κατασκευή σε pushes και pull requests**:

![](<../../.gitbook/assets/image (145).png>)

#### Cron Jobs

Αν έχετε πρόσβαση στην εφαρμογή ιστού, μπορείτε να **ρυθμίσετε cron για να εκτελούν την κατασκευή**, αυτό μπορεί να είναι χρήσιμο για επιμονή ή για να ενεργοποιήσετε μια κατασκευή:

![](<../../.gitbook/assets/image (243).png>)

{% hint style="info" %}
Φαίνεται ότι δεν είναι δυνατό να ρυθμίσετε cron μέσα στο `.travis.yml` σύμφωνα με [αυτό](https://github.com/travis-ci/travis-ci/issues/9162).
{% endhint %}

### Τρίτοι PR

Το TravisCI από προεπιλογή απενεργοποιεί την κοινή χρήση μεταβλητών περιβάλλοντος με PR που προέρχονται από τρίτους, αλλά κάποιος μπορεί να το ενεργοποιήσει και τότε θα μπορούσατε να δημιουργήσετε PR στο repo και να εξάγετε τα μυστικά:

![](<../../.gitbook/assets/image (208).png>)

### Εκχύλιση Μυστικών

Όπως εξηγείται στη σελίδα [**βασικές πληροφορίες**](basic-travisci-information.md), υπάρχουν 2 τύποι μυστικών. **Μυστικά Μεταβλητών Περιβάλλοντος** (τα οποία αναφέρονται στη σελίδα ιστού) και **προσαρμοσμένα κρυπτογραφημένα μυστικά**, τα οποία αποθηκεύονται μέσα στο αρχείο `.travis.yml` ως base64 (σημειώστε ότι και τα δύο, καθώς αποθηκεύονται κρυπτογραφημένα, θα καταλήξουν ως μεταβλητές περιβάλλοντος στις τελικές μηχανές).

* Για να **καταγράψετε μυστικά** που έχουν ρυθμιστεί ως **Μεταβλητές Περιβάλλοντος**, μεταβείτε στις **ρυθμίσεις** του **έργου** και ελέγξτε τη λίστα. Ωστόσο, σημειώστε ότι όλες οι μεταβλητές περιβάλλοντος του έργου που έχουν ρυθμιστεί εδώ θα εμφανιστούν κατά την ενεργοποίηση μιας κατασκευής.
* Για να καταγράψετε τα **προσαρμοσμένα κρυπτογραφημένα μυστικά**, το καλύτερο που μπορείτε να κάνετε είναι να **ελέγξετε το αρχείο `.travis.yml`**.
* Για να **καταγράψετε κρυπτογραφημένα αρχεία**, μπορείτε να ελέγξετε για **αρχεία `.enc`** στο repo, για γραμμές παρόμοιες με `openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d` στο αρχείο ρύθμισης, ή για **κρυπτογραφημένα iv και κλειδιά** στις **Μεταβλητές Περιβάλλοντος** όπως:

![](<../../.gitbook/assets/image (81).png>)

### TODO:

* Παράδειγμα κατασκευής με reverse shell που εκτελείται σε Windows/Mac/Linux
* Παράδειγμα κατασκευής που διαρρέει τη μεταβλητή περιβάλλοντος κωδικοποιημένη σε base64 στα logs

### TravisCI Enterprise

Αν ένας επιτιθέμενος βρεθεί σε ένα περιβάλλον που χρησιμοποιεί **TravisCI enterprise** (περισσότερες πληροφορίες για το τι είναι αυτό στη [**βασικές πληροφορίες**](basic-travisci-information.md#travisci-enterprise)), θα είναι σε θέση να **ενεργοποιήσει κατασκευές στον Εργάτη.** Αυτό σημαίνει ότι ένας επιτιθέμενος θα είναι σε θέση να κινηθεί οριζόντια σε αυτόν τον διακομιστή από τον οποίο θα μπορούσε να είναι σε θέση να:

* διαφύγει στον κεντρικό υπολογιστή;
* συμβιβάσει το kubernetes;
* συμβιβάσει άλλες μηχανές που εκτελούνται στο ίδιο δίκτυο;
* συμβιβάσει νέες πιστοποιήσεις cloud;

## Αναφορές

* [https://docs.travis-ci.com/user/encrypting-files/](https://docs.travis-ci.com/user/encrypting-files/)
* [https://docs.travis-ci.com/user/best-practices-security](https://docs.travis-ci.com/user/best-practices-security)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1) (1).png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
