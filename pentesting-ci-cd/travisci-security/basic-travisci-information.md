# Informaci√≥n B√°sica de TravisCI

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}

## Acceso

TravisCI se integra directamente con diferentes plataformas de git como Github, Bitbucket, Assembla y Gitlab. Pedir√° al usuario que le d√© permisos a TravisCI para acceder a los repos que desea integrar con TravisCI.

Por ejemplo, en Github pedir√° los siguientes permisos:

* `user:email` (solo lectura)
* `read:org` (solo lectura)
* `repo`: Concede acceso de lectura y escritura al c√≥digo, estados de commit, colaboradores y estados de despliegue para repositorios y organizaciones p√∫blicas y privadas.

## Secretos Encriptados

### Variables de Entorno

En TravisCI, al igual que en otras plataformas de CI, es posible **guardar secretos a nivel de repositorio** que se guardar√°n encriptados y ser√°n **desencriptados y enviados en la variable de entorno** de la m√°quina que ejecuta la construcci√≥n.

![](<../../.gitbook/assets/image (203).png>)

Es posible indicar las **ramas a las que los secretos estar√°n disponibles** (por defecto todas) y tambi√©n si TravisCI **deber√≠a ocultar su valor** si aparece **en los registros** (por defecto lo har√°).

### Secretos Encriptados Personalizados

Para **cada repositorio** TravisCI genera un **par de claves RSA**, **mantiene** la **privada**, y hace disponible la **clave p√∫blica** del repositorio a aquellos que tienen **acceso** al repositorio.

Puedes acceder a la clave p√∫blica de un repositorio con:
```
travis pubkey -r <owner>/<repo_name>
travis pubkey -r carlospolop/t-ci-test
```
Luego, puedes usar esta configuraci√≥n para **encriptar secretos y agregarlos a tu `.travis.yaml`**. Los secretos ser√°n **desencriptados cuando se ejecute la construcci√≥n** y accesibles en las **variables de entorno**.

![](<../../.gitbook/assets/image (139).png>)

Ten en cuenta que los secretos encriptados de esta manera no aparecer√°n listados en las variables de entorno de la configuraci√≥n.

### Archivos Encriptados Personalizados

De la misma manera que antes, TravisCI tambi√©n permite **encriptar archivos y luego desencriptarlos durante la construcci√≥n**:
```
travis encrypt-file super_secret.txt -r carlospolop/t-ci-test

encrypting super_secret.txt for carlospolop/t-ci-test
storing result as super_secret.txt.enc
storing secure env variables for decryption

Please add the following to your build script (before_install stage in your .travis.yml, for instance):

openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d

Pro Tip: You can add it automatically by running with --add.

Make sure to add super_secret.txt.enc to the git repository.
Make sure not to add super_secret.txt to the git repository.
Commit all changes to your .travis.yml.
```
Note que al encriptar un archivo se configurar√°n 2 variables de entorno dentro del repositorio, tales como:

![](<../../.gitbook/assets/image (170).png>)

## TravisCI Enterprise

Travis CI Enterprise es una **versi√≥n on-prem de Travis CI**, que puedes desplegar **en tu infraestructura**. Piensa en la versi√≥n ‚Äòservidor‚Äô de Travis CI. Usar Travis CI te permite habilitar un sistema de Integraci√≥n Continua/Despliegue Continuo (CI/CD) f√°cil de usar en un entorno, que puedes configurar y asegurar como desees.

**Travis CI Enterprise consta de dos partes principales:**

1. Servicios TCI **(o Servicios Centrales TCI)**, responsables de la integraci√≥n con sistemas de control de versiones, autorizaci√≥n de compilaciones, programaci√≥n de trabajos de compilaci√≥n, etc.
2. TCI **Worker** e im√°genes de entorno de compilaci√≥n (tambi√©n llamadas im√°genes de SO).

**Los servicios centrales de TCI requieren lo siguiente:**

1. Una base de datos **PostgreSQL11** (o posterior).
2. Una infraestructura para desplegar un cl√∫ster de Kubernetes; puede ser desplegado en un cl√∫ster de servidores o en una sola m√°quina si es necesario.
3. Dependiendo de tu configuraci√≥n, es posible que desees desplegar y configurar algunos de los componentes por tu cuenta, por ejemplo, RabbitMQ - consulta la [Configuraci√≥n de Travis CI Enterprise](https://docs.travis-ci.com/user/enterprise/tcie-3.x-setting-up-travis-ci-enterprise/) para m√°s detalles.

**El Worker de TCI requiere lo siguiente:**

1. Una infraestructura donde se pueda desplegar una imagen de docker que contenga el **Worker y una imagen de compilaci√≥n vinculada**.
2. Conectividad a ciertos componentes de los Servicios Centrales de Travis CI - consulta la [Configuraci√≥n del Worker](https://docs.travis-ci.com/user/enterprise/setting-up-worker/) para m√°s detalles.

La cantidad de Workers de TCI desplegados y las im√°genes de entorno de compilaci√≥n de SO determinar√°n la capacidad total concurrente del despliegue de Travis CI Enterprise en tu infraestructura.

![](<../../.gitbook/assets/image (199).png>)

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Consulta los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
