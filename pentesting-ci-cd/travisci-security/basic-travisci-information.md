# Informations de base sur TravisCI

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Formation Expert Red Team AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Formation Expert Red Team GCP (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## Acc√®s

TravisCI s'int√®gre directement avec diff√©rentes plateformes git telles que Github, Bitbucket, Assembla et Gitlab. Il demandera √† l'utilisateur de donner √† TravisCI les permissions d'acc√©der aux d√©p√¥ts qu'il souhaite int√©grer avec TravisCI.

Par exemple, dans Github, il demandera les permissions suivantes :

* `user:email` (lecture seule)
* `read:org` (lecture seule)
* `repo` : Accorde un acc√®s en lecture et en √©criture au code, aux statuts de commit, aux collaborateurs et aux statuts de d√©ploiement pour les d√©p√¥ts et organisations publics et priv√©s.

## Secrets Chiffr√©s

### Variables d'Environnement

Dans TravisCI, comme dans d'autres plateformes CI, il est possible de **sauvegarder au niveau du d√©p√¥t des secrets** qui seront sauvegard√©s chiffr√©s et seront **d√©crypt√©s et pouss√©s dans la variable d'environnement** de la machine ex√©cutant la construction.

![](<../../.gitbook/assets/image (203).png>)

Il est possible d'indiquer les **branches auxquelles les secrets seront disponibles** (par d√©faut toutes) et aussi si TravisCI **doit cacher sa valeur** si elle appara√Æt **dans les journaux** (par d√©faut, il le fera).

### Secrets Chiffr√©s Personnalis√©s

Pour **chaque d√©p√¥t**, TravisCI g√©n√®re une **paire de cl√©s RSA**, **garde** la **cl√© priv√©e**, et rend la **cl√© publique du d√©p√¥t disponible** pour ceux qui ont **acc√®s** au d√©p√¥t.

Vous pouvez acc√©der √† la cl√© publique d'un d√©p√¥t avec :
```
travis pubkey -r <owner>/<repo_name>
travis pubkey -r carlospolop/t-ci-test
```
Ensuite, vous pouvez utiliser cette configuration pour **chiffrer des secrets et les ajouter √† votre `.travis.yaml`**. Les secrets seront **d√©chiffr√©s lorsque la construction sera ex√©cut√©e** et accessibles dans les **variables d'environnement**.

![](<../../.gitbook/assets/image (139).png>)

Notez que les secrets chiffr√©s de cette mani√®re n'appara√Ætront pas dans la liste des variables d'environnement des param√®tres.

### Fichiers Chiffr√©s Personnalis√©s

De la m√™me mani√®re que pr√©c√©demment, TravisCI permet √©galement de **chiffrer des fichiers puis de les d√©chiffrer pendant la construction** :
```
travis encrypt-file super_secret.txt -r carlospolop/t-ci-test

encrypting super_secret.txt for carlospolop/t-ci-test
storing result as super_secret.txt.enc
storing secure env variables for decryption

Please add the following to your build script (before_install stage in your .travis.yml, for instance):

openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d

Pro Tip: You can add it automatically by running with --add.

Make sure to add super_secret.txt.enc to the git repository.
Make sure not to add super_secret.txt to the git repository.
Commit all changes to your .travis.yml.
```
Notez que lors du chiffrement d'un fichier, 2 variables d'environnement seront configur√©es dans le d√©p√¥t, telles que :

![](<../../.gitbook/assets/image (170).png>)

## TravisCI Enterprise

Travis CI Enterprise est une **version sur site de Travis CI**, que vous pouvez d√©ployer **dans votre infrastructure**. Pensez √† la version ‚Äòserveur‚Äô de Travis CI. L'utilisation de Travis CI vous permet d'activer un syst√®me d'int√©gration continue/d√©ploiement continu (CI/CD) facile √† utiliser dans un environnement que vous pouvez configurer et s√©curiser comme vous le souhaitez.

**Travis CI Enterprise se compose de deux parties principales :**

1. Les **services TCI** (ou services de base TCI), responsables de l'int√©gration avec les syst√®mes de contr√¥le de version, de l'autorisation des builds, de la planification des t√¢ches de build, etc.
2. Le **Worker TCI** et les images d'environnement de build (√©galement appel√©es images OS).

**Les services de base TCI n√©cessitent les √©l√©ments suivants :**

1. Une base de donn√©es **PostgreSQL11** (ou ult√©rieure).
2. Une infrastructure pour d√©ployer un cluster Kubernetes ; il peut √™tre d√©ploy√© dans un cluster de serveurs ou sur une seule machine si n√©cessaire.
3. En fonction de votre configuration, vous souhaiterez peut-√™tre d√©ployer et configurer certains des composants vous-m√™me, par exemple, RabbitMQ - consultez le [Configuration de Travis CI Enterprise](https://docs.travis-ci.com/user/enterprise/tcie-3.x-setting-up-travis-ci-enterprise/) pour plus de d√©tails.

**Le Worker TCI n√©cessite les √©l√©ments suivants :**

1. Une infrastructure o√π une image docker contenant le **Worker et une image de build li√©e peuvent √™tre d√©ploy√©es**.
2. Connectivit√© √† certains composants des services de base Travis CI - consultez le [Configuration du Worker](https://docs.travis-ci.com/user/enterprise/setting-up-worker/) pour plus de d√©tails.

Le nombre d'images OS de Worker TCI et d'environnement de build d√©ploy√©es d√©terminera la capacit√© totale concurrente du d√©ploiement de Travis CI Enterprise dans votre infrastructure.

![](<../../.gitbook/assets/image (199).png>)

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux d√©p√¥ts github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
