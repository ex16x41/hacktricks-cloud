# åŸºæœ¬çš„ TravisCI ä¿¡æ¯

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}

## è®¿é—®

TravisCI ç›´æ¥é›†æˆäº†ä¸åŒçš„ git å¹³å°ï¼Œå¦‚ Githubã€Bitbucketã€Assembla å’Œ Gitlabã€‚å®ƒä¼šè¦æ±‚ç”¨æˆ·æˆäºˆ TravisCI è®¿é—®ä»–æƒ³è¦é›†æˆçš„ä»“åº“çš„æƒé™ã€‚

ä¾‹å¦‚ï¼Œåœ¨ Github ä¸­ï¼Œå®ƒä¼šè¯·æ±‚ä»¥ä¸‹æƒé™ï¼š

* `user:email` (åªè¯»)
* `read:org` (åªè¯»)
* `repo`: æˆäºˆå¯¹å…¬å…±å’Œç§æœ‰ä»“åº“åŠç»„ç»‡çš„ä»£ç ã€æäº¤çŠ¶æ€ã€åä½œè€…å’Œéƒ¨ç½²çŠ¶æ€çš„è¯»å†™è®¿é—®æƒé™ã€‚

## åŠ å¯†çš„ Secrets

### ç¯å¢ƒå˜é‡

åœ¨ TravisCI ä¸­ï¼Œä¸å…¶ä»– CI å¹³å°ä¸€æ ·ï¼Œå¯ä»¥åœ¨ **ä»“åº“çº§åˆ«ä¿å­˜ secrets**ï¼Œè¿™äº› secrets å°†è¢«åŠ å¯†ä¿å­˜ï¼Œå¹¶åœ¨æ‰§è¡Œæ„å»ºçš„æœºå™¨çš„ **ç¯å¢ƒå˜é‡ä¸­è§£å¯†å¹¶æ¨é€**ã€‚

![](<../../.gitbook/assets/image (203).png>)

å¯ä»¥æŒ‡ç¤º **secrets å°†å¯ç”¨çš„åˆ†æ”¯**ï¼ˆé»˜è®¤æ˜¯æ‰€æœ‰åˆ†æ”¯ï¼‰ï¼Œè¿˜å¯ä»¥æŒ‡ç¤º TravisCI **æ˜¯å¦åº”éšè—å…¶å€¼** å¦‚æœå®ƒå‡ºç°åœ¨ **æ—¥å¿—ä¸­**ï¼ˆé»˜è®¤ä¼šéšè—ï¼‰ã€‚

### è‡ªå®šä¹‰åŠ å¯†çš„ Secrets

å¯¹äº **æ¯ä¸ªä»“åº“**ï¼ŒTravisCI ä¼šç”Ÿæˆä¸€ä¸ª **RSA å¯†é’¥å¯¹**ï¼Œ**ä¿ç•™** ç§é’¥ï¼Œå¹¶å°†ä»“åº“çš„ **å…¬é’¥æä¾›** ç»™æœ‰ **è®¿é—®æƒé™** çš„äººã€‚

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ä¸€ä¸ªä»“åº“çš„å…¬é’¥ï¼š
```
travis pubkey -r <owner>/<repo_name>
travis pubkey -r carlospolop/t-ci-test
```
ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤è®¾ç½®æ¥**åŠ å¯†ç§˜å¯†å¹¶å°†å…¶æ·»åŠ åˆ° `.travis.yaml` ä¸­**ã€‚è¿™äº›ç§˜å¯†å°†åœ¨**æ„å»ºè¿è¡Œæ—¶è§£å¯†**å¹¶åœ¨**ç¯å¢ƒå˜é‡**ä¸­å¯è®¿é—®ã€‚

![](<../../.gitbook/assets/image (139).png>)

è¯·æ³¨æ„ï¼Œä»¥è¿™ç§æ–¹å¼åŠ å¯†çš„ç§˜å¯†ä¸ä¼šå‡ºç°åœ¨è®¾ç½®çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ä¸­ã€‚

### è‡ªå®šä¹‰åŠ å¯†æ–‡ä»¶

ä¸ä¹‹å‰ç›¸åŒï¼ŒTravisCI ä¹Ÿå…è®¸**åŠ å¯†æ–‡ä»¶å¹¶åœ¨æ„å»ºæœŸé—´è§£å¯†å®ƒä»¬**ï¼š
```
travis encrypt-file super_secret.txt -r carlospolop/t-ci-test

encrypting super_secret.txt for carlospolop/t-ci-test
storing result as super_secret.txt.enc
storing secure env variables for decryption

Please add the following to your build script (before_install stage in your .travis.yml, for instance):

openssl aes-256-cbc -K $encrypted_355e94ba1091_key -iv $encrypted_355e94ba1091_iv -in super_secret.txt.enc -out super_secret.txt -d

Pro Tip: You can add it automatically by running with --add.

Make sure to add super_secret.txt.enc to the git repository.
Make sure not to add super_secret.txt to the git repository.
Commit all changes to your .travis.yml.
```
æ³¨æ„ï¼Œå½“åŠ å¯†ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œ2ä¸ªç¯å¢ƒå˜é‡å°†ä¼šåœ¨ä»“åº“ä¸­é…ç½®ï¼Œä¾‹å¦‚ï¼š

![](<../../.gitbook/assets/image (170).png>)

## TravisCI Enterprise

Travis CI Enterprise æ˜¯ **Travis CI çš„æœ¬åœ°ç‰ˆæœ¬**ï¼Œä½ å¯ä»¥åœ¨**ä½ çš„åŸºç¡€è®¾æ–½ä¸­**éƒ¨ç½²ã€‚å¯ä»¥å°†å…¶è§†ä¸º Travis CI çš„â€œæœåŠ¡å™¨â€ç‰ˆæœ¬ã€‚ä½¿ç”¨ Travis CI å¯ä»¥åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å¯ç”¨æ˜“äºä½¿ç”¨çš„æŒç»­é›†æˆ/æŒç»­éƒ¨ç½² (CI/CD) ç³»ç»Ÿï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œé…ç½®å’Œå®‰å…¨è®¾ç½®ã€‚

**Travis CI Enterprise ç”±ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼š**

1. TCI **æœåŠ¡**ï¼ˆæˆ– TCI æ ¸å¿ƒæœåŠ¡ï¼‰ï¼Œè´Ÿè´£ä¸ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿé›†æˆã€æˆæƒæ„å»ºã€è°ƒåº¦æ„å»ºä½œä¸šç­‰ã€‚
2. TCI **Worker** å’Œæ„å»ºç¯å¢ƒé•œåƒï¼ˆä¹Ÿç§°ä¸ºæ“ä½œç³»ç»Ÿé•œåƒï¼‰ã€‚

**TCI æ ¸å¿ƒæœåŠ¡éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š**

1. ä¸€ä¸ª **PostgreSQL11**ï¼ˆæˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰æ•°æ®åº“ã€‚
2. éƒ¨ç½² Kubernetes é›†ç¾¤çš„åŸºç¡€è®¾æ–½ï¼›å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨é›†ç¾¤æˆ–å•å°æœºå™¨ä¸Šéƒ¨ç½²ã€‚
3. æ ¹æ®ä½ çš„è®¾ç½®ï¼Œä½ å¯èƒ½éœ€è¦è‡ªè¡Œéƒ¨ç½²å’Œé…ç½®æŸäº›ç»„ä»¶ï¼Œä¾‹å¦‚ RabbitMQ - è¯¦è§ [Setting up Travis CI Enterprise](https://docs.travis-ci.com/user/enterprise/tcie-3.x-setting-up-travis-ci-enterprise/)ã€‚

**TCI Worker éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š**

1. ä¸€ä¸ªå¯ä»¥éƒ¨ç½²åŒ…å« **Worker å’Œé“¾æ¥çš„æ„å»ºé•œåƒ** çš„ docker é•œåƒçš„åŸºç¡€è®¾æ–½ã€‚
2. ä¸æŸäº› Travis CI æ ¸å¿ƒæœåŠ¡ç»„ä»¶çš„è¿æ¥ - è¯¦è§ [Setting Up Worker](https://docs.travis-ci.com/user/enterprise/setting-up-worker/)ã€‚

éƒ¨ç½²çš„ TCI Worker å’Œæ„å»ºç¯å¢ƒæ“ä½œç³»ç»Ÿé•œåƒçš„æ•°é‡å°†å†³å®šä½ åŸºç¡€è®¾æ–½ä¸­ Travis CI Enterprise éƒ¨ç½²çš„æ€»å¹¶å‘å®¹é‡ã€‚

![](<../../.gitbook/assets/image (199).png>)

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hackingï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hackingï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ–åœ¨ **Twitter** ğŸ¦ ä¸Šå…³æ³¨æˆ‘ä»¬ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡æäº¤ PRs åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}
