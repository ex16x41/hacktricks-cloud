# Gitea GÃ¼venliÄŸi

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Gitea Nedir

**Gitea**, Go dilinde yazÄ±lmÄ±ÅŸ **kendinize ait, topluluk tarafÄ±ndan yÃ¶netilen hafif bir kod barÄ±ndÄ±rma** Ã§Ã¶zÃ¼mÃ¼dÃ¼r.

![](<../../.gitbook/assets/image (160).png>)

### Temel Bilgiler

{% content-ref url="basic-gitea-information.md" %}
[basic-gitea-information.md](basic-gitea-information.md)
{% endcontent-ref %}

## Laboratuvar

Yerel olarak bir Gitea Ã¶rneÄŸi Ã§alÄ±ÅŸtÄ±rmak iÃ§in sadece bir docker konteyneri Ã§alÄ±ÅŸtÄ±rabilirsiniz:
```bash
docker run -p 3000:3000 gitea/gitea
```
BaÄŸlantÄ± kurmak iÃ§in 3000 numaralÄ± porta eriÅŸin.

AyrÄ±ca bunu kubernetes ile Ã§alÄ±ÅŸtÄ±rabilirsiniz:
```
helm repo add gitea-charts https://dl.gitea.io/charts/
helm install gitea gitea-charts/gitea
```
## Kimlik DoÄŸrulamasÄ± Olmadan SayÄ±m

* Kamu reposu: [http://localhost:3000/explore/repos](http://localhost:3000/explore/repos)
* KayÄ±tlÄ± kullanÄ±cÄ±lar: [http://localhost:3000/explore/users](http://localhost:3000/explore/users)
* KayÄ±tlÄ± Organizasyonlar: [http://localhost:3000/explore/organizations](http://localhost:3000/explore/organizations)

**VarsayÄ±lan olarak Gitea yeni kullanÄ±cÄ±larÄ±n kayÄ±t olmasÄ±na izin verir.** Bu, yeni kullanÄ±cÄ±lara diÄŸer organizasyonlar/kullanÄ±cÄ±lar reposu Ã¼zerinde Ã¶zel bir eriÅŸim saÄŸlamaz, ancak **giriÅŸ yapmÄ±ÅŸ bir kullanÄ±cÄ±** daha fazla **repo veya organizasyonu gÃ¶rÃ¼ntÃ¼leyebilir.**

## Dahili SÃ¶mÃ¼rÃ¼

Bu senaryo iÃ§in bir github hesabÄ±na eriÅŸim saÄŸladÄ±ÄŸÄ±nÄ±zÄ± varsayacaÄŸÄ±z.

### KullanÄ±cÄ± Kimlik Bilgileri/Web Ã‡erezi ile

EÄŸer bir ÅŸekilde bir organizasyondaki bir kullanÄ±cÄ± iÃ§in kimlik bilgilerine sahipseniz (veya bir oturum Ã§erezini Ã§aldÄ±ysanÄ±z) **sadece giriÅŸ yapabilir** ve hangi **repo'lar Ã¼zerinde hangi izinlere sahip olduÄŸunuzu**, **hangi takÄ±mlarda olduÄŸunuzu**, **diÄŸer kullanÄ±cÄ±larÄ± listeleyebilir** ve **repo'larÄ±n nasÄ±l korunduÄŸunu kontrol edebilirsiniz.**

**2FA kullanÄ±labileceÄŸini** unutmayÄ±n, bu nedenle bu bilgilere eriÅŸebilmek iÃ§in bu kontrolÃ¼ de **geÃ§meniz gerekecek.**

{% hint style="info" %}
EÄŸer **`i_like_gitea` Ã§erezini Ã§almayÄ± baÅŸarÄ±rsanÄ±z** (ÅŸu anda SameSite: Lax ile yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r) kimlik bilgilerine veya 2FA'ya ihtiyaÃ§ duymadan **kullanÄ±cÄ±yÄ± tamamen taklit edebilirsiniz.**
{% endhint %}

### KullanÄ±cÄ± SSH AnahtarÄ± ile

Gitea, **kullanÄ±cÄ±larÄ±n** kendi adlarÄ±na kod daÄŸÄ±tmak iÃ§in **kimlik doÄŸrulama yÃ¶ntemi olarak kullanÄ±lacak SSH anahtarlarÄ±** ayarlamalarÄ±na izin verir (2FA uygulanmaz).

Bu anahtar ile kullanÄ±cÄ±nÄ±n bazÄ± ayrÄ±calÄ±klara sahip olduÄŸu **repo'larda deÄŸiÅŸiklikler yapabilirsiniz**, ancak bunu gitea api'sine eriÅŸmek iÃ§in kullanamazsÄ±nÄ±z. Ancak, eriÅŸiminiz olan repo ve kullanÄ±cÄ± hakkÄ±nda bilgi almak iÃ§in **yerel ayarlarÄ± sayabilirsiniz:**
```bash
# Go to the the repository folder
# Get repo config and current user name and email
git config --list
```
EÄŸer kullanÄ±cÄ± adÄ±nÄ± gitea kullanÄ±cÄ± adÄ± olarak yapÄ±landÄ±rmÄ±ÅŸsa, hesabÄ±nda ayarladÄ±ÄŸÄ± **aÃ§Ä±k anahtarlarÄ±** _https://github.com/\<gitea\_username>.keys_ adresinden eriÅŸebilirsiniz, bulduÄŸunuz Ã¶zel anahtarÄ±n kullanÄ±labilir olduÄŸunu doÄŸrulamak iÃ§in bunu kontrol edebilirsiniz.

**SSH anahtarlarÄ±** ayrÄ±ca **daÄŸÄ±tÄ±m anahtarlarÄ±** olarak depolarda ayarlanabilir. Bu anahtara eriÅŸimi olan herkes **bir depodan projeleri baÅŸlatabilecektir**. Genellikle farklÄ± daÄŸÄ±tÄ±m anahtarlarÄ±na sahip bir sunucuda, yerel dosya **`~/.ssh/config`** hangi anahtarÄ±n ilgili olduÄŸu hakkÄ±nda bilgi verecektir.

#### GPG AnahtarlarÄ±

AÃ§Ä±klandÄ±ÄŸÄ± gibi [**burada**](https://github.com/carlospolop/hacktricks-cloud/blob/master/pentesting-ci-cd/gitea-security/broken-reference/README.md) bazen taahhÃ¼tleri imzalamak gerekebilir yoksa keÅŸfedilebilirsiniz.

Mevcut kullanÄ±cÄ±nÄ±n herhangi bir anahtara sahip olup olmadÄ±ÄŸÄ±nÄ± yerel olarak kontrol edin:
```shell
gpg --list-secret-keys --keyid-format=long
```
### KullanÄ±cÄ± Tokeni ile

[**KullanÄ±cÄ± Tokenleri hakkÄ±nda temel bilgileri kontrol edin**](basic-gitea-information.md#personal-access-tokens) iÃ§in bir giriÅŸ.

Bir kullanÄ±cÄ± tokeni, Gitea sunucusuna **ÅŸifre yerine** **kimlik doÄŸrulamak** iÃ§in kullanÄ±labilir [**API aracÄ±lÄ±ÄŸÄ±yla**](https://try.gitea.io/api/swagger#/). KullanÄ±cÄ± Ã¼zerinde **tam eriÅŸim** saÄŸlar.

### Oauth UygulamasÄ± ile

[**Gitea Oauth UygulamalarÄ± hakkÄ±nda temel bilgileri kontrol edin**](./#with-oauth-application) iÃ§in bir giriÅŸ.

Bir saldÄ±rgan, kullanÄ±cÄ±larÄ±n muhtemelen bir kimlik avÄ± kampanyasÄ±nÄ±n parÃ§asÄ± olarak kabul ettiÄŸi ayrÄ±calÄ±klÄ± verilere/iÅŸlemlere eriÅŸmek iÃ§in **kÃ¶tÃ¼ niyetli bir Oauth UygulamasÄ±** oluÅŸturabilir.

Temel bilgilerde aÃ§Ä±klandÄ±ÄŸÄ± gibi, uygulama **kullanÄ±cÄ± hesabÄ± Ã¼zerinde tam eriÅŸime** sahip olacaktÄ±r.

### Dal Koruma Atlatma

Github'da, varsayÄ±lan olarak repo Ã¼zerinde **yazma eriÅŸimi olan bir token** alan **github actions** bulunmaktadÄ±r. Bu, **dal korumalarÄ±nÄ± atlatmak** iÃ§in kullanÄ±labilir. Bu durumda **mevcut deÄŸil**, bu nedenle atlatmalar daha sÄ±nÄ±rlÄ±dÄ±r. Ancak neler yapÄ±labileceÄŸine bir gÃ¶z atalÄ±m:

* **Push'u EtkinleÅŸtir**: Yazma eriÅŸimi olan herhangi biri dalÄ±na push yapabiliyorsa, sadece push yapÄ±n.
* **KÄ±sÄ±tlÄ± Push'u Beyaz Listeye Al**: AynÄ± ÅŸekilde, bu listeye dahil iseniz dalÄ±na push yapÄ±n.
* **BirleÅŸtirme Beyaz Listesini EtkinleÅŸtir**: EÄŸer birleÅŸtirme beyaz listesi varsa, onun iÃ§inde olmalÄ±sÄ±nÄ±z.
* **Onay gereksinimi 0'dan bÃ¼yÃ¼k**: O zaman... baÅŸka bir kullanÄ±cÄ±yÄ± tehlikeye atmanÄ±z gerekir.
* **OnaylarÄ± beyaz listeye kÄ±sÄ±tla**: EÄŸer yalnÄ±zca beyaz listeye alÄ±nmÄ±ÅŸ kullanÄ±cÄ±lar onay verebiliyorsa... o liste iÃ§inde olan baÅŸka bir kullanÄ±cÄ±yÄ± tehlikeye atmanÄ±z gerekir.
* **Eski onaylarÄ± geÃ§ersiz kÄ±l**: EÄŸer onaylar yeni commitlerle kaldÄ±rÄ±lmÄ±yorsa, onaylanmÄ±ÅŸ bir PR'yi ele geÃ§irip kodunuzu ekleyebilir ve PR'yi birleÅŸtirebilirsiniz.

**EÄŸer bir org/repo yÃ¶neticisiyseniz** korumalarÄ± atlatabileceÄŸinizi unutmayÄ±n.

### Webhook'larÄ± Sayma

**Webhook'lar**, **belirli gitea bilgilerini bazÄ± yerlere gÃ¶nderebilir**. Bu iletiÅŸimi **istismar edebilirsiniz**.\
Ancak genellikle, **geri alÄ±namaz** bir **gizli anahtar** **webhook** iÃ§inde ayarlanÄ±r ve bu, URL'sini bilen ancak gizli anahtarÄ± bilmeyen dÄ±ÅŸ kullanÄ±cÄ±larÄ±n **o webhook'u istismar etmesini engeller**.\
Ancak bazÄ± durumlarda, insanlar **gizli anahtarÄ±** yerine **URL'ye** bir parametre olarak ayarlayabilir, bu nedenle **URL'leri kontrol etmek** size **gizli anahtarlarÄ± bulma** ve daha fazla istismar edebileceÄŸiniz diÄŸer yerleri bulma imkanÄ± verebilir.

Webhook'lar **repo ve org seviyesinde** ayarlanabilir.

## Ä°stismar SonrasÄ±

### Sunucu Ä°Ã§inde

EÄŸer bir ÅŸekilde gitea'nÄ±n Ã§alÄ±ÅŸtÄ±ÄŸÄ± sunucuya girmeyi baÅŸardÄ±ysanÄ±z, gitea yapÄ±landÄ±rma dosyasÄ±nÄ± aramalÄ±sÄ±nÄ±z. VarsayÄ±lan olarak `/data/gitea/conf/app.ini` konumundadÄ±r.

Bu dosyada **anahtarlar** ve **ÅŸifreler** bulabilirsiniz.

Gitea yolunda (varsayÄ±lan: /data/gitea) ayrÄ±ca ilginÃ§ bilgiler bulabilirsiniz:

* **sqlite** DB: Gitea harici bir db kullanmÄ±yorsa, bir sqlite db kullanacaktÄ±r.
* **oturumlar** oturumlar klasÃ¶rÃ¼ iÃ§inde: `cat sessions/*/*/*` komutunu Ã§alÄ±ÅŸtÄ±rarak oturum aÃ§mÄ±ÅŸ kullanÄ±cÄ±larÄ±n kullanÄ±cÄ± adlarÄ±nÄ± gÃ¶rebilirsiniz (gitea ayrÄ±ca oturumlarÄ± DB iÃ§inde de saklayabilir).
* **jwt Ã¶zel anahtarÄ±** jwt klasÃ¶rÃ¼ iÃ§inde.
* Bu klasÃ¶rde daha fazla **hassas bilgi** bulunabilir.

EÄŸer sunucu iÃ§indeyseniz, bilgileri eriÅŸmek/deÄŸiÅŸtirmek iÃ§in **`gitea` ikili dosyasÄ±nÄ±** da kullanabilirsiniz:

* `gitea dump` gitea'yÄ± dÃ¶kecek ve bir .zip dosyasÄ± oluÅŸturacaktÄ±r.
* `gitea generate secret INTERNAL_TOKEN/JWT_SECRET/SECRET_KEY/LFS_JWT_SECRET` belirtilen tÃ¼rde bir token oluÅŸturacaktÄ±r (kalÄ±cÄ±lÄ±k).
* `gitea admin user change-password --username admin --password newpassword` Åifreyi deÄŸiÅŸtirir.
* `gitea admin user create --username newuser --password superpassword --email user@user.user --admin --access-token` Yeni bir yÃ¶netici kullanÄ±cÄ± oluÅŸturur ve bir eriÅŸim tokeni alÄ±r.

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
