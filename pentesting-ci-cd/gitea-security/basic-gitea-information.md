# Informaci칩n B치sica de Gitea

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}

## Estructura B치sica

La estructura b치sica del entorno de Gitea es agrupar repos por **organizaci칩n(es),** cada una de ellas puede contener **varios repositorios** y **varios equipos.** Sin embargo, ten en cuenta que al igual que en github, los usuarios pueden tener repos fuera de la organizaci칩n.

Adem치s, un **usuario** puede ser **miembro** de **diferentes organizaciones**. Dentro de la organizaci칩n, el usuario puede tener **diferentes permisos sobre cada repositorio**.

Un usuario tambi칠n puede ser **parte de diferentes equipos** con diferentes permisos sobre diferentes repos.

Y finalmente, **los repositorios pueden tener mecanismos de protecci칩n especiales**.

## Permisos

### Organizaciones

Cuando se **crea una organizaci칩n**, se crea un equipo llamado **Owners** y el usuario se coloca dentro de 칠l. Este equipo dar치 **acceso de administrador** sobre la **organizaci칩n**, esos **permisos** y el **nombre** del equipo **no pueden ser modificados**.

**Los administradores de la organizaci칩n** (propietarios) pueden seleccionar la **visibilidad** de la organizaci칩n:

* P칰blico
* Limitado (solo usuarios registrados)
* Privado (solo miembros)

**Los administradores de la organizaci칩n** tambi칠n pueden indicar si los **administradores de repos** pueden **agregar o eliminar acceso** para equipos. Tambi칠n pueden indicar el n칰mero m치ximo de repos.

Al crear un nuevo equipo, se seleccionan varias configuraciones importantes:

* Se indica los **repos de la org a los que los miembros del equipo podr치n acceder**: repos espec칤ficos (repos donde se a침ade el equipo) o todos.
* Tambi칠n se indica **si los miembros pueden crear nuevos repos** (el creador obtendr치 acceso de administrador a 칠l)
* Los **permisos** que los **miembros** del repos **tendr치n**:
* Acceso de **Administrador**
* Acceso **Espec칤fico**:

![](<../../.gitbook/assets/image (118).png>)

### Equipos y Usuarios

En un repositorio, el **administrador de la org** y los **administradores de repos** (si lo permite la org) pueden **gestionar los roles** otorgados a colaboradores (otros usuarios) y equipos. Hay **3** posibles **roles**:

* Administrador
* Escribir
* Leer

## Autenticaci칩n en Gitea

### Acceso Web

Usando **nombre de usuario + contrase침a** y potencialmente (y recomendado) un 2FA.

### **Claves SSH**

Puedes configurar tu cuenta con una o varias claves p칰blicas que permiten que la clave **privada relacionada realice acciones en tu nombre.** [http://localhost:3000/user/settings/keys](http://localhost:3000/user/settings/keys)

#### **Claves GPG**

No **puedes suplantar al usuario con estas claves** pero si no las usas, podr칤a ser posible que **se descubra que env칤as commits sin una firma**.

### **Tokens de Acceso Personal**

Puedes generar un token de acceso personal para **dar acceso a una aplicaci칩n a tu cuenta**. Un token de acceso personal da acceso completo a tu cuenta: [http://localhost:3000/user/settings/applications](http://localhost:3000/user/settings/applications)

### Aplicaciones Oauth

Al igual que los tokens de acceso personal, las **aplicaciones Oauth** tendr치n **acceso completo** a tu cuenta y a los lugares a los que tu cuenta tiene acceso porque, como se indica en la [documentaci칩n](https://docs.gitea.io/en-us/oauth2-provider/#scopes), los scopes a칰n no son compatibles:

![](<../../.gitbook/assets/image (194).png>)

### Claves de Despliegue

Las claves de despliegue pueden tener acceso de solo lectura o de escritura al repositorio, por lo que pueden ser interesantes para comprometer repos espec칤ficos.

## Protecciones de Ramas

Las protecciones de ramas est치n dise침adas para **no dar control completo de un repositorio** a los usuarios. El objetivo es **implementar varios m칠todos de protecci칩n antes de poder escribir c칩digo dentro de alguna rama**.

Las **protecciones de ramas de un repositorio** se pueden encontrar en _https://localhost:3000/\<orgname>/\<reponame>/settings/branches_

{% hint style="info" %}
No es **posible establecer una protecci칩n de rama a nivel de organizaci칩n**. Por lo tanto, todas deben ser declaradas en cada repositorio.
{% endhint %}

Se pueden aplicar diferentes protecciones a una rama (como a master):

* **Deshabilitar Push**: Nadie puede hacer push a esta rama
* **Habilitar Push**: Cualquiera con acceso puede hacer push, pero no forzar push.
* **Lista blanca de Push Restringido**: Solo usuarios/equipos seleccionados pueden hacer push a esta rama (pero no forzar push)
* **Habilitar lista blanca de Merge**: Solo usuarios/equipos en la lista blanca pueden fusionar PRs.
* **Habilitar verificaciones de estado:** Requiere que las verificaciones de estado pasen antes de fusionar.
* **Requerir aprobaciones**: Indica el n칰mero de aprobaciones requeridas antes de que un PR pueda ser fusionado.
* **Restringir aprobaciones a los de la lista blanca**: Indica usuarios/equipos que pueden aprobar PRs.
* **Bloquear fusi칩n en revisiones rechazadas**: Si se solicitan cambios, no se puede fusionar (incluso si las otras verificaciones pasan)
* **Bloquear fusi칩n en solicitudes de revisi칩n oficiales**: Si hay solicitudes de revisi칩n oficiales, no se puede fusionar
* **Desestimar aprobaciones obsoletas**: Cuando hay nuevos commits, las aprobaciones antiguas ser치n desestimadas.
* **Requerir Commits Firmados**: Los commits deben estar firmados.
* **Bloquear fusi칩n si la solicitud de extracci칩n est치 desactualizada**
* **Patrones de archivos protegidos/no protegidos**: Indica patrones de archivos para proteger/no proteger contra cambios

{% hint style="info" %}
Como puedes ver, incluso si lograste obtener algunas credenciales de un usuario, **los repos pueden estar protegidos evitando que puedas hacer push de c칩digo a master** por ejemplo para comprometer el pipeline de CI/CD.
{% endhint %}

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/image (1).png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de github.

</details>
{% endhint %}
