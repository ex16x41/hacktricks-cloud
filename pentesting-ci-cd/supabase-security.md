# Supabase GÃ¼venliÄŸi

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± Ekip UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± Ekip UzmanÄ± (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Temel Bilgiler

[**ana sayfalarÄ±na**](https://supabase.com/) gÃ¶re: Supabase, aÃ§Ä±k kaynaklÄ± bir Firebase alternatifidir. Projenize bir Postgres veritabanÄ±, Kimlik DoÄŸrulama, anlÄ±k API'ler, Edge FonksiyonlarÄ±, GerÃ§ek ZamanlÄ± abonelikler, Depolama ve VektÃ¶r gÃ¶mme ile baÅŸlayÄ±n.

### Alt Alan AdÄ±

Temelde bir proje oluÅŸturulduÄŸunda, kullanÄ±cÄ± **`jnanozjdybtpqgcwhdiz.supabase.co`** gibi bir supabase.co alt alan adÄ± alacaktÄ±r.

## **VeritabanÄ± yapÄ±landÄ±rmasÄ±**

{% hint style="success" %}
**Bu verilere `https://supabase.com/dashboard/project/<project-id>/settings/database` gibi bir baÄŸlantÄ±dan eriÅŸilebilir.**
{% endhint %}

Bu **veritabanÄ±**, bazÄ± AWS bÃ¶lgelerinde daÄŸÄ±tÄ±lacak ve ona baÄŸlanmak iÃ§in ÅŸu ÅŸekilde baÄŸlanmak mÃ¼mkÃ¼n olacaktÄ±r: `postgres://postgres.jnanozjdybtpqgcwhdiz:[YOUR-PASSWORD]@aws-0-us-west-1.pooler.supabase.com:5432/postgres` (bu us-west-1'de oluÅŸturuldu).\
Åifre, kullanÄ±cÄ±nÄ±n daha Ã¶nce koyduÄŸu bir **ÅŸifredir**.

Bu nedenle, alt alan adÄ± bilinen bir alan adÄ± olduÄŸundan ve kullanÄ±cÄ± adÄ± olarak kullanÄ±ldÄ±ÄŸÄ±ndan ve AWS bÃ¶lgeleri sÄ±nÄ±rlÄ± olduÄŸundan, **ÅŸifreyi brute force denemek** mÃ¼mkÃ¼n olabilir.

Bu bÃ¶lÃ¼m ayrÄ±ca ÅŸunlarÄ± iÃ§ermektedir:

* VeritabanÄ± ÅŸifresini sÄ±fÄ±rlama
* BaÄŸlantÄ± havuzlamasÄ±nÄ± yapÄ±landÄ±rma
* SSL yapÄ±landÄ±rma: DÃ¼z metin baÄŸlantÄ±larÄ±nÄ± reddetme (varsayÄ±lan olarak etkin)
* Disk boyutunu yapÄ±landÄ±rma
* AÄŸ kÄ±sÄ±tlamalarÄ± ve yasaklar uygulama

## API YapÄ±landÄ±rmasÄ±

{% hint style="success" %}
**Bu verilere `https://supabase.com/dashboard/project/<project-id>/settings/api` gibi bir baÄŸlantÄ±dan eriÅŸilebilir.**
{% endhint %}

Projenizdeki supabase API'sine eriÅŸim URL'si ÅŸÃ¶yle olacak: `https://jnanozjdybtpqgcwhdiz.supabase.co`.

### anon api anahtarlarÄ±

AyrÄ±ca bir **anon API anahtarÄ±** (`role: "anon"`) oluÅŸturacaktÄ±r, Ã¶rneÄŸin: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk` uygulamanÄ±n API anahtarÄ±nÄ± kullanabilmesi iÃ§in gereklidir.

Bu API'ye eriÅŸmek iÃ§in API REST'ini [**belgelerde**](https://supabase.com/docs/reference/self-hosting-auth/returns-the-configuration-settings-for-the-gotrue-server) bulmak mÃ¼mkÃ¼ndÃ¼r, ancak en ilginÃ§ uÃ§ noktalar ÅŸunlardÄ±r:

<details>

<summary>Kaydol (/auth/v1/signup)</summary>
```
POST /auth/v1/signup HTTP/2
Host: id.io.net
Content-Length: 90
X-Client-Info: supabase-js-web/2.39.2
Sec-Ch-Ua: "Not-A.Brand";v="99", "Chromium";v="124"
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.60 Safari/537.36
Content-Type: application/json;charset=UTF-8
Apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Origin: https://cloud.io.net
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://cloud.io.net/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Priority: u=1, i

{"email":"test@exmaple.com","password":"SomeCOmplexPwd239."}
```
</details>

<details>

<summary>GiriÅŸ (/auth/v1/token?grant_type=password)</summary>
```
POST /auth/v1/token?grant_type=password HTTP/2
Host: hypzbtgspjkludjcnjxl.supabase.co
Content-Length: 80
X-Client-Info: supabase-js-web/2.39.2
Sec-Ch-Ua: "Not-A.Brand";v="99", "Chromium";v="124"
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.60 Safari/537.36
Content-Type: application/json;charset=UTF-8
Apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Origin: https://cloud.io.net
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://cloud.io.net/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Priority: u=1, i

{"email":"test@exmaple.com","password":"SomeCOmplexPwd239."}
```
</details>

Yani, bir mÃ¼ÅŸterinin kendilerine verilen alt alan adÄ±yla supabase kullandÄ±ÄŸÄ±nÄ± keÅŸfettiÄŸinizde (ÅŸirketin bir alt alan adÄ±nÄ±n supabase alt alan adlarÄ±na CNAME yÃ¶nlendirmesi yapmasÄ± mÃ¼mkÃ¼ndÃ¼r), **supabase API'sini kullanarak platformda yeni bir hesap oluÅŸturmayÄ±** deneyebilirsiniz.

### gizli / service\_role api anahtarlarÄ±

**`role: "service_role"`** ile bir gizli API anahtarÄ± da oluÅŸturulacaktÄ±r. Bu API anahtarÄ± gizli olmalÄ±dÄ±r Ã§Ã¼nkÃ¼ **SatÄ±r Seviyesi GÃ¼venliÄŸi**'ni atlatabilecektir.

API anahtarÄ± ÅŸu ÅŸekilde gÃ¶rÃ¼nÃ¼r: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxNDk5MjcxOSwiZXhwIjoyMDMwNTY4NzE5fQ.0a8fHGp3N_GiPq0y0dwfs06ywd-zhTwsm486Tha7354`

### JWT Gizli AnahtarÄ±

UygulamanÄ±n **Ã¶zel JWT token'larÄ± oluÅŸturup imzalayabilmesi** iÃ§in bir **JWT Gizli AnahtarÄ±** da oluÅŸturulacaktÄ±r.

## Kimlik DoÄŸrulama

### KayÄ±tlar

{% hint style="success" %}
**VarsayÄ±lan olarak** supabase, daha Ã¶nce bahsedilen API uÃ§ noktalarÄ±nÄ± kullanarak **yeni kullanÄ±cÄ±larÄ±n hesap oluÅŸturmasÄ±na** izin verecektir.
{% endhint %}

Ancak, bu yeni hesaplar varsayÄ±lan olarak, **giriÅŸ yapabilmek iÃ§in e-posta adreslerini doÄŸrulamalarÄ±** gerekecektir. Ä°nsanlarÄ±n e-posta adreslerini doÄŸrulamadan giriÅŸ yapabilmesi iÃ§in **"Anonim giriÅŸlere izin ver"** seÃ§eneÄŸini etkinleÅŸtirmek mÃ¼mkÃ¼ndÃ¼r. Bu, **beklenmedik verilere** eriÅŸim saÄŸlayabilir (kullanÄ±cÄ±lar `public` ve `authenticated` rollerini alÄ±r).\
Bu Ã§ok kÃ¶tÃ¼ bir fikirdir Ã§Ã¼nkÃ¼ supabase, aktif kullanÄ±cÄ± baÅŸÄ±na Ã¼cret alÄ±r, bu nedenle insanlar kullanÄ±cÄ± oluÅŸturup giriÅŸ yapabilir ve supabase bu kullanÄ±cÄ±lar iÃ§in Ã¼cret alÄ±r:

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Åifreler ve oturumlar

Minimum ÅŸifre uzunluÄŸunu belirtmek (varsayÄ±lan olarak), gereksinimleri (varsayÄ±lan olarak yok) ve sÄ±zdÄ±rÄ±lmÄ±ÅŸ ÅŸifrelerin kullanÄ±lmasÄ±nÄ± engellemek mÃ¼mkÃ¼ndÃ¼r.\
**VarsayÄ±lan gereksinimlerin zayÄ±f olduÄŸu iÃ§in gereksinimleri geliÅŸtirmek** Ã¶nerilir.

* KullanÄ±cÄ± OturumlarÄ±: KullanÄ±cÄ± oturumlarÄ±nÄ±n nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± yapÄ±landÄ±rmak mÃ¼mkÃ¼ndÃ¼r (zaman aÅŸÄ±mÄ±, kullanÄ±cÄ± baÅŸÄ±na 1 oturum...)
* Bot ve KÃ¶tÃ¼ye KullanÄ±m KorumasÄ±: Captcha etkinleÅŸtirmek mÃ¼mkÃ¼ndÃ¼r.

### SMTP AyarlarÄ±

E-postalarÄ± gÃ¶ndermek iÃ§in bir SMTP ayarlamak mÃ¼mkÃ¼ndÃ¼r.

### GeliÅŸmiÅŸ Ayarlar

* EriÅŸim token'larÄ± iÃ§in sonlanma sÃ¼resini ayarlayÄ±n (varsayÄ±lan 3600)
* Potansiyel olarak tehlikeye atÄ±lmÄ±ÅŸ yenileme token'larÄ±nÄ± tespit etmek ve iptal etmek iÃ§in ayarlayÄ±n
* MFA: KullanÄ±cÄ± baÅŸÄ±na bir kerede kaÃ§ MFA faktÃ¶rÃ¼nÃ¼n kaydedilebileceÄŸini belirtin (varsayÄ±lan 10)
* Maksimum DoÄŸrudan VeritabanÄ± BaÄŸlantÄ±larÄ±: Kimlik doÄŸrulama iÃ§in kullanÄ±lan maksimum baÄŸlantÄ± sayÄ±sÄ± (varsayÄ±lan 10)
* Maksimum Ä°stek SÃ¼resi: Bir Kimlik doÄŸrulama isteÄŸinin sÃ¼resinin ne kadar olabileceÄŸi (varsayÄ±lan 10s)

## Depolama

{% hint style="success" %}
Supabase, **dosyalarÄ± depolamaya** ve bunlarÄ± bir URL Ã¼zerinden eriÅŸilebilir hale getirmeye izin verir (S3 bucket'larÄ± kullanÄ±r).
{% endhint %}

* YÃ¼kleme dosyasÄ± boyut sÄ±nÄ±rÄ±nÄ± ayarlayÄ±n (varsayÄ±lan 50MB)
* S3 baÄŸlantÄ±sÄ± ÅŸu ÅŸekilde bir URL ile verilir: `https://jnanozjdybtpqgcwhdiz.supabase.co/storage/v1/s3`
* `access key ID` (Ã¶rneÄŸin, `a37d96544d82ba90057e0e06131d0a7b`) ve `secret access key` (Ã¶rneÄŸin, `58420818223133077c2cec6712a4f909aec93b4daeedae205aa8e30d5a860628`) ile oluÅŸturulan **S3 eriÅŸim anahtarÄ±** talep etmek mÃ¼mkÃ¼ndÃ¼r.

## Edge FonksiyonlarÄ±

Supabase'te **gizli bilgileri** depolamak da mÃ¼mkÃ¼ndÃ¼r ve bu bilgiler **edge fonksiyonlarÄ± tarafÄ±ndan eriÅŸilebilir** (web Ã¼zerinden oluÅŸturulup silinebilir, ancak deÄŸerlerine doÄŸrudan eriÅŸmek mÃ¼mkÃ¼n deÄŸildir).

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
