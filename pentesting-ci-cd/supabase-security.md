# Supabase Security

{% hint style="success" %}
å­¦ä¹ å’Œç»ƒä¹  AWS Hacking:<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œç»ƒä¹  GCP Hacking: <img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡æäº¤ PRs åˆ†äº«é»‘å®¢æŠ€å·§åˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“ã€‚

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

æ ¹æ®ä»–ä»¬çš„ [**ä¸»é¡µ**](https://supabase.com/): Supabase æ˜¯ä¸€ä¸ªå¼€æºçš„ Firebase æ›¿ä»£å“ã€‚ä½¿ç”¨ Postgres æ•°æ®åº“ã€è®¤è¯ã€å³æ—¶ APIã€è¾¹ç¼˜å‡½æ•°ã€å®æ—¶è®¢é˜…ã€å­˜å‚¨å’Œå‘é‡åµŒå…¥å¼€å§‹ä½ çš„é¡¹ç›®ã€‚

### å­åŸŸå

åŸºæœ¬ä¸Šï¼Œå½“ä¸€ä¸ªé¡¹ç›®è¢«åˆ›å»ºæ—¶ï¼Œç”¨æˆ·å°†ä¼šæ”¶åˆ°ä¸€ä¸ª supabase.co å­åŸŸåï¼Œå¦‚ï¼š**`jnanozjdybtpqgcwhdiz.supabase.co`**

## **æ•°æ®åº“é…ç½®**

{% hint style="success" %}
**è¿™äº›æ•°æ®å¯ä»¥ä»ç±»ä¼¼ `https://supabase.com/dashboard/project/<project-id>/settings/database` çš„é“¾æ¥è®¿é—®**
{% endhint %}

è¿™ä¸ª **æ•°æ®åº“** å°†ä¼šéƒ¨ç½²åœ¨æŸä¸ª AWS åŒºåŸŸï¼Œä¸ºäº†è¿æ¥åˆ°å®ƒï¼Œå¯ä»¥è¿æ¥åˆ°ï¼š`postgres://postgres.jnanozjdybtpqgcwhdiz:[YOUR-PASSWORD]@aws-0-us-west-1.pooler.supabase.com:5432/postgres`ï¼ˆè¿™æ˜¯åœ¨ us-west-1 åˆ›å»ºçš„ï¼‰ã€‚\
å¯†ç æ˜¯ç”¨æˆ·ä¹‹å‰è®¾ç½®çš„ **å¯†ç **ã€‚

å› æ­¤ï¼Œç”±äºå­åŸŸåæ˜¯å·²çŸ¥çš„ï¼Œå¹¶ä¸”å®ƒè¢«ç”¨ä½œç”¨æˆ·åï¼Œè€Œ AWS åŒºåŸŸæ˜¯æœ‰é™çš„ï¼Œå¯èƒ½å¯ä»¥å°è¯• **æš´åŠ›ç ´è§£å¯†ç **ã€‚

æ­¤éƒ¨åˆ†è¿˜åŒ…å«ä»¥ä¸‹é€‰é¡¹ï¼š

* é‡ç½®æ•°æ®åº“å¯†ç 
* é…ç½®è¿æ¥æ± 
* é…ç½® SSLï¼šæ‹’ç»æ˜æ–‡è¿æ¥ï¼ˆé»˜è®¤æƒ…å†µä¸‹å¯ç”¨ï¼‰
* é…ç½®ç£ç›˜å¤§å°
* åº”ç”¨ç½‘ç»œé™åˆ¶å’Œç¦ä»¤

## API é…ç½®

{% hint style="success" %}
**è¿™äº›æ•°æ®å¯ä»¥ä»ç±»ä¼¼ `https://supabase.com/dashboard/project/<project-id>/settings/api` çš„é“¾æ¥è®¿é—®**
{% endhint %}

è®¿é—®é¡¹ç›®ä¸­ supabase API çš„ URL å°†ä¼šæ˜¯ç±»ä¼¼ï¼š`https://jnanozjdybtpqgcwhdiz.supabase.co`ã€‚

### åŒ¿å API å¯†é’¥

å®ƒè¿˜ä¼šç”Ÿæˆä¸€ä¸ª **åŒ¿å API å¯†é’¥** (`role: "anon"`)ï¼Œå¦‚ï¼š`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk`ï¼Œåº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨å®ƒæ¥è”ç³» API å¯†é’¥æš´éœ²åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ã€‚

å¯ä»¥åœ¨ [**æ–‡æ¡£**](https://supabase.com/docs/reference/self-hosting-auth/returns-the-configuration-settings-for-the-gotrue-server) ä¸­æ‰¾åˆ°è”ç³»æ­¤ API çš„ API RESTï¼Œä½†æœ€æœ‰è¶£çš„ç«¯ç‚¹æ˜¯ï¼š

<details>

<summary>æ³¨å†Œ (/auth/v1/signup)</summary>
```
POST /auth/v1/signup HTTP/2
Host: id.io.net
Content-Length: 90
X-Client-Info: supabase-js-web/2.39.2
Sec-Ch-Ua: "Not-A.Brand";v="99", "Chromium";v="124"
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.60 Safari/537.36
Content-Type: application/json;charset=UTF-8
Apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Origin: https://cloud.io.net
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://cloud.io.net/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Priority: u=1, i

{"email":"test@exmaple.com","password":"SomeCOmplexPwd239."}
```
</details>

<details>

<summary>Login (/auth/v1/token?grant_type=password)</summary>
```
POST /auth/v1/token?grant_type=password HTTP/2
Host: hypzbtgspjkludjcnjxl.supabase.co
Content-Length: 80
X-Client-Info: supabase-js-web/2.39.2
Sec-Ch-Ua: "Not-A.Brand";v="99", "Chromium";v="124"
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.60 Safari/537.36
Content-Type: application/json;charset=UTF-8
Apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTQ5OTI3MTksImV4cCI6MjAzMDU2ODcxOX0.sRN0iMGM5J741pXav7UxeChyqBE9_Z-T0tLA9Zehvqk
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Origin: https://cloud.io.net
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://cloud.io.net/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Priority: u=1, i

{"email":"test@exmaple.com","password":"SomeCOmplexPwd239."}
```
</details>

æ‰€ä»¥ï¼Œæ¯å½“ä½ å‘ç°ä¸€ä¸ªå®¢æˆ·ä½¿ç”¨supabaseå¹¶ä¸”ä½¿ç”¨äº†ä»–ä»¬è¢«æˆäºˆçš„å­åŸŸåï¼ˆæœ‰å¯èƒ½å…¬å¸çš„ä¸€ä¸ªå­åŸŸååœ¨ä»–ä»¬çš„supabaseå­åŸŸåä¸Šæœ‰ä¸€ä¸ªCNAMEï¼‰ï¼Œä½ å¯ä»¥å°è¯•**ä½¿ç”¨supabase APIåœ¨å¹³å°ä¸Šåˆ›å»ºä¸€ä¸ªæ–°è´¦æˆ·**ã€‚

### secret / service\_role api keys

ä¸€ä¸ªå¸¦æœ‰**`role: "service_role"`**çš„secret API keyä¹Ÿä¼šè¢«ç”Ÿæˆã€‚è¿™ä¸ªAPI keyåº”è¯¥æ˜¯ä¿å¯†çš„ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿç»•è¿‡**è¡Œçº§å®‰å…¨**ã€‚

API keyçœ‹èµ·æ¥åƒè¿™æ ·ï¼š`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpuYW5vemRyb2J0cHFnY3doZGl6Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxNDk5MjcxOSwiZXhwIjoyMDMwNTY4NzE5fQ.0a8fHGp3N_GiPq0y0dwfs06ywd-zhTwsm486Tha7354`

### JWT Secret

ä¸€ä¸ª**JWT Secret**ä¹Ÿä¼šè¢«ç”Ÿæˆï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºå¯ä»¥**åˆ›å»ºå’Œç­¾ç½²è‡ªå®šä¹‰JWTä»¤ç‰Œ**ã€‚

## Authentication

### Signups

{% hint style="success" %}
é»˜è®¤æƒ…å†µä¸‹ï¼Œsupabaseå°†å…è®¸**æ–°ç”¨æˆ·é€šè¿‡ä½¿ç”¨å‰é¢æåˆ°çš„APIç«¯ç‚¹åœ¨ä½ çš„é¡¹ç›®ä¸­åˆ›å»ºè´¦æˆ·**ã€‚
{% endhint %}

ç„¶è€Œï¼Œè¿™äº›æ–°è´¦æˆ·é»˜è®¤æƒ…å†µä¸‹**éœ€è¦éªŒè¯ä»–ä»¬çš„ç”µå­é‚®ä»¶åœ°å€**æ‰èƒ½ç™»å½•è´¦æˆ·ã€‚å¯ä»¥å¯ç”¨**â€œå…è®¸åŒ¿åç™»å½•â€**ï¼Œä»¥å…è®¸äººä»¬åœ¨ä¸éªŒè¯ç”µå­é‚®ä»¶åœ°å€çš„æƒ…å†µä¸‹ç™»å½•ã€‚è¿™å¯èƒ½ä¼šæˆäºˆè®¿é—®**æ„å¤–æ•°æ®**çš„æƒé™ï¼ˆä»–ä»¬è·å¾—`public`å’Œ`authenticated`è§’è‰²ï¼‰ã€‚\
è¿™æ˜¯ä¸€ä¸ªéå¸¸ç³Ÿç³•çš„ä¸»æ„ï¼Œå› ä¸ºsupabaseæŒ‰æ´»è·ƒç”¨æˆ·æ”¶è´¹ï¼Œæ‰€ä»¥äººä»¬å¯ä»¥åˆ›å»ºç”¨æˆ·å¹¶ç™»å½•ï¼Œsupabaseä¼šä¸ºè¿™äº›ç”¨æˆ·æ”¶è´¹ï¼š

<figure><img src="../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

### Passwords & sessions

å¯ä»¥æŒ‡ç¤ºæœ€å°å¯†ç é•¿åº¦ï¼ˆé»˜è®¤ï¼‰ï¼Œè¦æ±‚ï¼ˆé»˜è®¤æ²¡æœ‰ï¼‰å¹¶ç¦æ­¢ä½¿ç”¨æ³„éœ²çš„å¯†ç ã€‚\
å»ºè®®**æé«˜è¦æ±‚ï¼Œå› ä¸ºé»˜è®¤è¦æ±‚å¾ˆå¼±**ã€‚

* ç”¨æˆ·ä¼šè¯ï¼šå¯ä»¥é…ç½®ç”¨æˆ·ä¼šè¯çš„å·¥ä½œæ–¹å¼ï¼ˆè¶…æ—¶ï¼Œæ¯ä¸ªç”¨æˆ·ä¸€ä¸ªä¼šè¯...ï¼‰
* æœºå™¨äººå’Œæ»¥ç”¨ä¿æŠ¤ï¼šå¯ä»¥å¯ç”¨Captchaã€‚

### SMTP Settings

å¯ä»¥è®¾ç½®SMTPæ¥å‘é€ç”µå­é‚®ä»¶ã€‚

### Advanced Settings

* è®¾ç½®è®¿é—®ä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤3600ç§’ï¼‰
* è®¾ç½®æ£€æµ‹å’Œæ’¤é”€å¯èƒ½è¢«æ³„éœ²çš„åˆ·æ–°ä»¤ç‰Œå’Œè¶…æ—¶
* MFAï¼šæŒ‡ç¤ºæ¯ä¸ªç”¨æˆ·ä¸€æ¬¡å¯ä»¥æ³¨å†Œå¤šå°‘ä¸ªMFAå› ç´ ï¼ˆé»˜è®¤10ä¸ªï¼‰
* æœ€å¤§ç›´æ¥æ•°æ®åº“è¿æ¥æ•°ï¼šç”¨äºè®¤è¯çš„æœ€å¤§è¿æ¥æ•°ï¼ˆé»˜è®¤10ä¸ªï¼‰
* æœ€å¤§è¯·æ±‚æŒç»­æ—¶é—´ï¼šå…è®¸çš„Authè¯·æ±‚æŒç»­çš„æœ€é•¿æ—¶é—´ï¼ˆé»˜è®¤10ç§’ï¼‰

## Storage

{% hint style="success" %}
Supabaseå…è®¸**å­˜å‚¨æ–‡ä»¶**å¹¶é€šè¿‡URLä½¿å…¶å¯è®¿é—®ï¼ˆå®ƒä½¿ç”¨S3æ¡¶ï¼‰ã€‚
{% endhint %}

* è®¾ç½®ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆé»˜è®¤æ˜¯50MBï¼‰
* S3è¿æ¥é€šè¿‡ä¸€ä¸ªURLæä¾›ï¼Œä¾‹å¦‚ï¼š`https://jnanozjdybtpqgcwhdiz.supabase.co/storage/v1/s3`
* å¯ä»¥**è¯·æ±‚S3è®¿é—®å¯†é’¥**ï¼Œç”±ä¸€ä¸ª`access key ID`ï¼ˆä¾‹å¦‚`a37d96544d82ba90057e0e06131d0a7b`ï¼‰å’Œä¸€ä¸ª`secret access key`ï¼ˆä¾‹å¦‚`58420818223133077c2cec6712a4f909aec93b4daeedae205aa8e30d5a860628`ï¼‰ç»„æˆ

## Edge Functions

ä¹Ÿå¯ä»¥åœ¨supabaseä¸­**å­˜å‚¨ç§˜å¯†**ï¼Œè¿™äº›ç§˜å¯†å°†**ç”±edge functionsè®¿é—®**ï¼ˆå¯ä»¥ä»ç½‘é¡µåˆ›å»ºå’Œåˆ é™¤ï¼Œä½†ä¸èƒ½ç›´æ¥è®¿é—®å®ƒä»¬çš„å€¼ï¼‰ã€‚

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWS Hackingï¼š<img src="/.gitbook/assets/image.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/image.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCP Hackingï¼š<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)ï¼
* **åŠ å…¥** ğŸ’¬ [**Discordç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**telegramç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* **é€šè¿‡æäº¤PRåˆ°** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubä»“åº“æ¥åˆ†äº«é»‘å®¢æŠ€å·§**ã€‚

</details>
{% endhint %}
