# Ansible Tower / AWX / Automation controller GÃ¼venliÄŸi

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## Temel Bilgiler

**Ansible Tower** veya aÃ§Ä±k kaynak versiyonu [**AWX**](https://github.com/ansible/awx), **Ansibleâ€™Ä±n kullanÄ±cÄ± arayÃ¼zÃ¼, kontrol paneli ve REST API** olarak da bilinir. **Rol tabanlÄ± eriÅŸim kontrolÃ¼**, iÅŸ zamanlamasÄ± ve grafik envanter yÃ¶netimi ile Ansible altyapÄ±nÄ±zÄ± modern bir UI'den yÃ¶netebilirsiniz. Towerâ€™Ä±n REST API'si ve komut satÄ±rÄ± arayÃ¼zÃ¼, mevcut araÃ§lar ve iÅŸ akÄ±ÅŸlarÄ±yla entegrasyonu basit hale getirir.

**Automation Controller, Ansible Tower'Ä±n daha fazla yeteneÄŸe sahip** daha yeni bir versiyonudur.

### Farklar

[**bu**](https://blog.devops.dev/ansible-tower-vs-awx-under-the-hood-65cfec78db00) kaynaÄŸÄ±na gÃ¶re, Ansible Tower ile AWX arasÄ±ndaki ana farklar alÄ±nan destek ve Ansible Tower'Ä±n rol tabanlÄ± eriÅŸim kontrolÃ¼, Ã¶zel API'ler iÃ§in destek ve kullanÄ±cÄ± tanÄ±mlÄ± iÅŸ akÄ±ÅŸlarÄ± gibi ek Ã¶zelliklere sahip olmasÄ±dÄ±r.

### Teknoloji YÄ±ÄŸÄ±nÄ±

* **Web ArayÃ¼zÃ¼**: KullanÄ±cÄ±larÄ±n envanterleri, kimlik bilgilerini, ÅŸablonlarÄ± ve iÅŸleri yÃ¶netebileceÄŸi grafik arayÃ¼zdÃ¼r. AnlaÅŸÄ±lÄ±r olmasÄ± iÃ§in tasarlanmÄ±ÅŸtÄ±r ve otomasyon iÅŸlerinin durumu ve sonuÃ§larÄ±nÄ± anlamaya yardÄ±mcÄ± olacak gÃ¶rselleÅŸtirmeler saÄŸlar.
* **REST API**: Web arayÃ¼zÃ¼nde yapabileceÄŸiniz her ÅŸeyi REST API aracÄ±lÄ±ÄŸÄ±yla da yapabilirsiniz. Bu, AWX/Tower'Ä± diÄŸer sistemlerle entegre etmenizi veya arayÃ¼zde genellikle gerÃ§ekleÅŸtireceÄŸiniz eylemleri betik haline getirmenizi saÄŸlar.
* **VeritabanÄ±**: AWX/Tower, yapÄ±landÄ±rmasÄ±nÄ±, iÅŸ sonuÃ§larÄ±nÄ± ve diÄŸer gerekli operasyonel verileri depolamak iÃ§in bir veritabanÄ± (genellikle PostgreSQL) kullanÄ±r.
* **RabbitMQ**: Bu, AWX/Tower'Ä±n farklÄ± bileÅŸenler arasÄ±nda, Ã¶zellikle web hizmeti ile gÃ¶rev Ã§alÄ±ÅŸtÄ±rÄ±cÄ±larÄ± arasÄ±nda iletiÅŸim kurmak iÃ§in kullandÄ±ÄŸÄ± mesajlaÅŸma sistemidir.
* **Redis**: Redis, gÃ¶rev kuyruÄŸu iÃ§in bir Ã¶nbellek ve arka uÃ§ olarak hizmet eder.

### MantÄ±ksal BileÅŸenler

* **Envanterler**: Envanter, **iÅŸlerin** (Ansible playbook'larÄ±) **Ã§alÄ±ÅŸtÄ±rÄ±labileceÄŸi** **hostlar (veya dÃ¼ÄŸÃ¼mler)** koleksiyonudur. AWX/Tower, envanterlerinizi tanÄ±mlamanÄ±za ve gruplamanÄ±za olanak tanÄ±r ve ayrÄ±ca AWS, Azure gibi diÄŸer sistemlerden **host listelerini alabilen** dinamik envanterleri destekler.
* **Projeler**: Bir proje, esasen bir **versiyon kontrol sistemi** (Git gibi) kaynaklÄ± **Ansible playbook'larÄ±** koleksiyonudur ve gerektiÄŸinde en son playbook'larÄ± Ã§ekmek iÃ§in kullanÄ±lÄ±r.
* **Åablonlar**: Ä°ÅŸ ÅŸablonlarÄ±, **belirli bir playbook'un nasÄ±l Ã§alÄ±ÅŸtÄ±rÄ±lacaÄŸÄ±nÄ±** tanÄ±mlar, **envanter**, **kimlik bilgileri** ve iÅŸ iÃ§in diÄŸer **parametreleri** belirtir.
* **Kimlik Bilgileri**: AWX/Tower, **SSH anahtarlarÄ±, ÅŸifreler ve API jetonlarÄ±** gibi gizli bilgileri **yÃ¶netmek ve depolamak iÃ§in gÃ¼venli bir yol** saÄŸlar. Bu kimlik bilgileri, playbook'larÄ±n Ã§alÄ±ÅŸtÄ±ÄŸÄ±nda gerekli eriÅŸime sahip olabilmesi iÃ§in iÅŸ ÅŸablonlarÄ±yla iliÅŸkilendirilebilir.
* **GÃ¶rev Motoru**: BurasÄ± sihrin gerÃ§ekleÅŸtiÄŸi yerdir. GÃ¶rev motoru, Ansible Ã¼zerine inÅŸa edilmiÅŸtir ve **playbook'larÄ± Ã§alÄ±ÅŸtÄ±rmaktan** sorumludur. Ä°ÅŸler, gÃ¶rev motoruna yÃ¶nlendirilir ve ardÄ±ndan belirtilen envanter Ã¼zerinde belirtilen kimlik bilgileri kullanÄ±larak Ansible playbook'larÄ± Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r.
* **ZamanlayÄ±cÄ±lar ve Geri Aramalar**: Bunlar, AWX/Tower'da **iÅŸlerin belirli zamanlarda Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±nÄ±** veya dÄ±ÅŸ olaylar tarafÄ±ndan tetiklenmesini saÄŸlayan geliÅŸmiÅŸ Ã¶zelliklerdir.
* **Bildirimler**: AWX/Tower, iÅŸlerin baÅŸarÄ±sÄ±na veya baÅŸarÄ±sÄ±zlÄ±ÄŸÄ±na dayalÄ± olarak bildirimler gÃ¶nderebilir. E-posta, Slack mesajlarÄ±, webhook'lar gibi Ã§eÅŸitli bildirim yÃ¶ntemlerini destekler.
* **Ansible Playbook'larÄ±**: Ansible playbook'larÄ±, yapÄ±landÄ±rma, daÄŸÄ±tÄ±m ve orkestrasyon araÃ§larÄ±dÄ±r. Sistemlerin istenen durumunu otomatik, tekrarlanabilir bir ÅŸekilde tanÄ±mlar. YAML ile yazÄ±lmÄ±ÅŸtÄ±r, playbook'lar Ansible'Ä±n deklaratif otomasyon dilini kullanarak yapÄ±landÄ±rmalarÄ±, gÃ¶revleri ve yÃ¼rÃ¼tÃ¼lmesi gereken adÄ±mlarÄ± tanÄ±mlar.

### Ä°ÅŸ YÃ¼rÃ¼tme AkÄ±ÅŸÄ±

1. **KullanÄ±cÄ± EtkileÅŸimi**: Bir kullanÄ±cÄ±, AWX/Tower ile **Web ArayÃ¼zÃ¼** veya **REST API** aracÄ±lÄ±ÄŸÄ±yla etkileÅŸimde bulunabilir. Bu, AWX/Tower tarafÄ±ndan sunulan tÃ¼m iÅŸlevselliklere Ã¶n uÃ§ eriÅŸimi saÄŸlar.
2. **Ä°ÅŸ BaÅŸlatma**:
* KullanÄ±cÄ±, Web ArayÃ¼zÃ¼ veya API aracÄ±lÄ±ÄŸÄ±yla bir **Ä°ÅŸ Åablonu** temelinde bir iÅŸ baÅŸlatÄ±r.
* Ä°ÅŸ Åablonu, **EnvantÃ¶r**, **Proje** (playbook'u iÃ§eren) ve **Kimlik Bilgileri** referanslarÄ±nÄ± iÃ§erir.
* Ä°ÅŸ baÅŸlatÄ±ldÄ±ÄŸÄ±nda, iÅŸin yÃ¼rÃ¼tÃ¼lmesi iÃ§in AWX/Tower arka ucuna bir istek gÃ¶nderilir.
3. **Ä°ÅŸ KuyruÄŸa Alma**:
* **RabbitMQ**, web bileÅŸeni ile gÃ¶rev Ã§alÄ±ÅŸtÄ±rÄ±cÄ±larÄ± arasÄ±ndaki mesajlaÅŸmayÄ± yÃ¶netir. Bir iÅŸ baÅŸlatÄ±ldÄ±ÄŸÄ±nda, RabbitMQ kullanÄ±larak gÃ¶rev motoruna bir mesaj gÃ¶nderilir.
* **Redis**, yÃ¼rÃ¼tÃ¼lmeyi bekleyen kuyrukta bekleyen iÅŸleri yÃ¶neterek gÃ¶rev kuyruÄŸu iÃ§in arka uÃ§ olarak hizmet eder.
4. **Ä°ÅŸin YÃ¼rÃ¼tÃ¼lmesi**:
* **GÃ¶rev Motoru**, kuyrukta bekleyen iÅŸi alÄ±r. Ä°lgili **VeritabanÄ±**'ndan iÅŸin iliÅŸkili playbook'u, envanteri ve kimlik bilgileri hakkÄ±nda gerekli bilgileri alÄ±r.
* Ä°lgili **Proje**'den alÄ±nan Ansible playbook'unu kullanarak, GÃ¶rev Motoru belirtilen **EnvantÃ¶r** dÃ¼ÄŸÃ¼mleri Ã¼zerinde saÄŸlanan **Kimlik Bilgileri** ile playbook'u Ã§alÄ±ÅŸtÄ±rÄ±r.
* Playbook Ã§alÄ±ÅŸÄ±rken, yÃ¼rÃ¼tme Ã§Ä±ktÄ±sÄ± (loglar, bilgiler vb.) yakalanÄ±r ve **VeritabanÄ±**'na kaydedilir.
5. **Ä°ÅŸ SonuÃ§larÄ±**:
* Playbook Ã§alÄ±ÅŸmayÄ± bitirdiÄŸinde, sonuÃ§lar (baÅŸarÄ±, baÅŸarÄ±sÄ±zlÄ±k, loglar) **VeritabanÄ±**'na kaydedilir.
* KullanÄ±cÄ±lar, sonuÃ§larÄ± Web ArayÃ¼zÃ¼ aracÄ±lÄ±ÄŸÄ±yla gÃ¶rÃ¼ntÃ¼leyebilir veya REST API aracÄ±lÄ±ÄŸÄ±yla sorgulayabilir.
* Ä°ÅŸ sonuÃ§larÄ±na baÄŸlÄ± olarak, **Bildirimler** kullanÄ±cÄ±larÄ± veya dÄ±ÅŸ sistemleri iÅŸin durumu hakkÄ±nda bilgilendirmek iÃ§in gÃ¶nderilebilir. Bildirimler e-posta, Slack mesajlarÄ±, webhook'lar vb. olabilir.
6. **DÄ±ÅŸ Sistem Entegrasyonu**:
* **Envanterler**, dÄ±ÅŸ sistemlerden dinamik olarak kaynaklanabilir, bu da AWX/Tower'Ä±n AWS, Azure, VMware gibi kaynaklardan hostlarÄ± Ã§ekmesine olanak tanÄ±r.
* **Projeler** (playbook'lar), versiyon kontrol sistemlerinden alÄ±nabilir, bu da iÅŸ yÃ¼rÃ¼tÃ¼lmesi sÄ±rasÄ±nda gÃ¼ncel playbook'larÄ±n kullanÄ±lmasÄ±nÄ± saÄŸlar.
* **ZamanlayÄ±cÄ±lar ve Geri Aramalar**, diÄŸer sistemler veya araÃ§larla entegrasyon iÃ§in kullanÄ±labilir, bu da AWX/Tower'Ä±n dÄ±ÅŸ tetikleyicilere tepki vermesini veya iÅŸleri Ã¶nceden belirlenmiÅŸ zamanlarda Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± saÄŸlar.

### Test iÃ§in AWX laboratuvarÄ± oluÅŸturma

[**Belgeleri takip ederek**](https://github.com/ansible/awx/blob/devel/tools/docker-compose/README.md) AWX'Ä± Ã§alÄ±ÅŸtÄ±rmak iÃ§in docker-compose kullanmak mÃ¼mkÃ¼ndÃ¼r:

{% code overflow="wrap" %}
```bash
git clone -b x.y.z https://github.com/ansible/awx.git # Get in x.y.z the latest release version

cd awx

# Build
make docker-compose-build

# Run
make docker-compose

# Or to create a more complex env
MAIN_NODE_TYPE=control EXECUTION_NODE_COUNT=2 COMPOSE_TAG=devel make docker-compose

# Clean and build the UI
docker exec tools_awx_1 make clean-ui ui-devel

# Once migrations are completed and the UI is built, you can begin using AWX. The UI can be reached in your browser at https://localhost:8043/#/home, and the API can be found at https://localhost:8043/api/v2.

# Create an admin user
docker exec -ti tools_awx_1 awx-manage createsuperuser

# Load demo data
docker exec tools_awx_1 awx-manage create_preload_data
```
{% endcode %}

## RBAC

### Desteklenen roller

En yetkili rol **Sistem YÃ¶neticisi** olarak adlandÄ±rÄ±lÄ±r. Bu role sahip olan herkes **her ÅŸeyi deÄŸiÅŸtirebilir**.

Bir **beyaz kutu gÃ¼venliÄŸi** incelemesi iÃ§in, **Sistem DenetÃ§isi rolÃ¼ne** ihtiyacÄ±nÄ±z olacak, bu rol **tÃ¼m sistem verilerini gÃ¶rÃ¼ntÃ¼lemenizi** saÄŸlar ancak herhangi bir deÄŸiÅŸiklik yapmanÄ±za izin vermez. DiÄŸer bir seÃ§enek **Organizasyon DenetÃ§isi rolÃ¼nÃ¼** almak olacaktÄ±r, ancak diÄŸerini almak daha iyi olur.

<details>

<summary>Mevcut rollerin ayrÄ±ntÄ±lÄ± aÃ§Ä±klamasÄ±nÄ± almak iÃ§in geniÅŸletin</summary>

1. **Sistem YÃ¶neticisi**:
* Bu, sistemdeki herhangi bir kaynaÄŸa eriÅŸim ve deÄŸiÅŸtirme izinlerine sahip sÃ¼per kullanÄ±cÄ± rolÃ¼dÃ¼r.
* TÃ¼m organizasyonlarÄ±, takÄ±mlarÄ±, projeleri, envanterleri, iÅŸ ÅŸablonlarÄ±nÄ± vb. yÃ¶netebilirler.
2. **Sistem DenetÃ§isi**:
* Bu role sahip kullanÄ±cÄ±lar tÃ¼m sistem verilerini gÃ¶rÃ¼ntÃ¼leyebilir ancak herhangi bir deÄŸiÅŸiklik yapamazlar.
* Bu rol, uyum ve denetim iÃ§in tasarlanmÄ±ÅŸtÄ±r.
3. **Organizasyon Roller**:
* **YÃ¶netici**: Organizasyonun kaynaklarÄ± Ã¼zerinde tam kontrol.
* **DenetÃ§i**: Organizasyonun kaynaklarÄ±na yalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
* **Ãœye**: Belirli izinleri olmayan bir organizasyonda temel Ã¼yelik.
* **Ã‡alÄ±ÅŸtÄ±r**: Organizasyon iÃ§inde iÅŸ ÅŸablonlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rabilir.
* **Oku**: Organizasyonun kaynaklarÄ±nÄ± gÃ¶rÃ¼ntÃ¼leyebilir.
4. **Proje Roller**:
* **YÃ¶netici**: Projeyi yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Kullan**: Projeyi bir iÅŸ ÅŸablonunda kullanabilir.
* **GÃ¼ncelle**: Projeyi SCM (kaynak kontrolÃ¼) kullanarak gÃ¼ncelleyebilir.
5. **Envanter Roller**:
* **YÃ¶netici**: Envanteri yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Ad Hoc**: Envanter Ã¼zerinde ad hoc komutlarÄ± Ã§alÄ±ÅŸtÄ±rabilir.
* **GÃ¼ncelle**: Envanter kaynaÄŸÄ±nÄ± gÃ¼ncelleyebilir.
* **Kullan**: Envanteri bir iÅŸ ÅŸablonunda kullanabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
6. **Ä°ÅŸ Åablonu Roller**:
* **YÃ¶netici**: Ä°ÅŸ ÅŸablonunu yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Ã‡alÄ±ÅŸtÄ±r**: Ä°ÅŸi Ã§alÄ±ÅŸtÄ±rabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
7. **Kimlik Bilgisi Roller**:
* **YÃ¶netici**: Kimlik bilgilerini yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Kullan**: Kimlik bilgilerini iÅŸ ÅŸablonlarÄ±nda veya diÄŸer ilgili kaynaklarda kullanabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.
8. **TakÄ±m Roller**:
* **Ãœye**: TakÄ±mÄ±n bir parÃ§asÄ± ancak belirli izinleri yok.
* **YÃ¶netici**: TakÄ±mÄ±n Ã¼yelerini ve ilgili kaynaklarÄ± yÃ¶netebilir.
9. **Ä°ÅŸ AkÄ±ÅŸÄ± Roller**:
* **YÃ¶netici**: Ä°ÅŸ akÄ±ÅŸÄ±nÄ± yÃ¶netebilir ve deÄŸiÅŸtirebilir.
* **Ã‡alÄ±ÅŸtÄ±r**: Ä°ÅŸ akÄ±ÅŸÄ±nÄ± Ã§alÄ±ÅŸtÄ±rabilir.
* **Oku**: YalnÄ±zca gÃ¶rÃ¼ntÃ¼leme eriÅŸimi.

</details>

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/image (1).png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/image (2).png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/image (2).png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
